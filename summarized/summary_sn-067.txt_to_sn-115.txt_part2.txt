GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#67

DATE:		November 23, 2006

TITLE:		Kernel Patch Protection

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-067.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo first discuss errata from previous episodes, correcting, among other things, Steve's first poor impression of Vista's performance. Then they discuss the results of Steve's in-depth research into the inner workings of Vista's Kernel Patch Protection (aka PatchGuard) to uncover its limitations, benefits, and real purpose.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 67 for November 23, 2006:  The Problem With PatchGuard.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Dell.  For this week�s specials, visit TWiT.tv/dell.



Well, the turkey dinner�s over, the football game�s done.  Maybe it�s time to turn on a podcast or two.  And you�ve made the right choice, my friend, because it�s time for Security Now! with Steve Gibson.  Hello, Steve.  Happy Thanksgiving Day.



STEVE GIBSON:  Hey, Leo.  Great to be here.  This is our Thanksgiving Day edition.  On Thursday.



LEO:  Yeah.  I always think of the big, you know, football game, and the snows were coming down at Lambeau Field when the � you know.  And I really feel like this is it.  This is a � we have to have some dramatic music [singing].  Or maybe not.  You know, and it�s only in the United States.  And they�ve already had Thanksgiving a month ago in Canada, and the rest of the world they�re going, Thankswhating?



STEVE:  Yeah, yeah.



LEO:  So we must go on.  We must soldier on because we are�an international podcast.  No U.S. holidays for us, my�friend.



STEVE:  Yup.



LEO:  What is our topic of the moment?



STEVE:  Well, we got � I want to talk about, well, that we�ve got a bunch of errata stuff.  And I want to talk about, in general, I want to really focus this week on Vista�s Kernel Patch Protection.



LEO:  Okay.



STEVE:  Because believe it or not, it�s already been hacked, and it doesn�t work.



LEO:  Oh, boy.  All right.  Well, we�ll get to that in a�second.



STEVE:  Yeah.



LEO:  But let�s start by clearing up any issues from previous episodes here.



STEVE:  Yeah, a bunch of stuff.  One thing that happened was last week I mentioned � or maybe it was the week before � that very cool little freeware utility, allSnap.  Unfort-...



LEO:  Which we killed.



STEVE:  Which we completely killed.  Unfortunately there�s a��  most of the Google links point to an old site, which is on GeoCities.  And almost immediately we � our mention of allSnap burned up the bandwidth, and they shut down the site.  You know, they got slashdotted, essentially.  I wrote to the author.  I started serving the file myself so that we wouldn�t zap GeoCities.  Bunch of people downloaded it.  And he explained, the author explained that he�d actually moved it.  He�s Canadian, I can�t � I think at, like, University of Toronto or somewhere.



LEO:  Oh, neat.



STEVE:  I don�t remember exactly where now.  But anyway, so it�s back up and around.  And I just wanted to mention to anybody who might have tried to go there following the podcast and not been able to get it that I will on this week�s show notes continue the link to the most recent version myself, and also put a link to the original site.  Because it is just a really cool little gizmo.



LEO:  I was amazed because to me it�s like, okay, fine.  But obviously you are not alone in your love for this program.



STEVE:  It�s just cool to have the windows lock themselves to the screen borders.  I just really like that.



LEO:  Okay.



STEVE:  Also I misspoke � again, it was either last week or the week before.  Because we recorded two together, I�m sort of muddy in my mind which one was which.  But I mentioned that�� confirmed that accessing Gmail remotely over a secure SSL connection worked, and you could set up an email client that way.  The problem was, I stumbled over the issue of anonymity.  And it�s really dumb, too, because you may remember, Leo, that I � one of my trips to Toronto I talked about the three main browser-based email systems, Yahoo!, Hotmail, and Gmail; and that only Google mail, when you accessed them through a web browser, was anonymous; that if you sent email using either Hotmail or Yahoo!, in the headers of the received mail was the IP address from which the user was accessing Hotmail or Yahoo!�s website, making it not anonymous in that sense.



LEO:  It puts that in the headers.  Wow.



STEVE:  Yes.



LEO:  Wow.



STEVE:  Just sort of embeds it gratuitously.  Now, Gmail doesn�t.  And so I got that backwards because I said that using a remote SSL connection you still had the benefit of that anonymity, and you don�t.  So if you are using an email, a regular email client � Outlook, Eudora, you know, whatever � and accessing Gmail and assuming that you are maintaining that IP-level anonymity, that�s not the case.  In order to get that with Google Mail, and it�s the only one of those three that does, you need to access it through a web browser and do your work there, if you don�t want the recipient to be able to easily see what IP address you were at when you sent the mail.  So I wanted to correct that.



LEO:  It�s really � it is counterintuitive because you�d think, if you�re not using a browser, why would it do that?  If you�re using a standard POP client, why would it embed the IP address?  But...



STEVE:  Ah.  Well, actually the reason is it has to.  And the whole reason these IP addresses are embedded is that headers are appended as mail moves from one SMTP server to the next.  And you need to prevent routing loops, or email forwarding loops.  So, and when mail arrives at an SMTP server, it checks all of the received headers which are appended as the mail is moved from one server to the next to see if it has already received that mail.  So it is necessary as a precaution for Gmail to do that, so it makes sense.  I just wanted to make sure, you know, that I corrected that because I wouldn�t want people to think that they were more safe than they are.  They�re not as safe using Gmail through a remote client as they are from an anonymity standpoint of masking their actual connection IP when they use Gmail through the web browser.



LEO:  And you�d need to use HTTPS through the web browser, and not just HTTP.



STEVE:  Well, yeah.  That won�t affect your anonymity.  But of course you�d just as soon have a secure connection so nobody could be, you know, eavesdropping on you, your connection to Gmail.



LEO:  So it doesn�t embed the IP even if you�re using the standard nonsecure Gmail.



STEVE:  Correct.



LEO:  Okay.



STEVE:  Also we talked several weeks ago about that new exploit and vulnerability which was being exploited in the XML, the Windows XML core services.  I did want to confirm to people that that was patched in Microsoft�s Second Tuesday of November patch cycle because we were telling people, you know, if they were at high risk of that kind of exploit, to, you know, you might want to set that kill bit.  So people could go back now and remove it.  On the other hand, you know, invoking this particular ActiveX control through a web browser is a purely exploitive thing to do.  It�s not functionality that you could conceivably even need through your web browser.  So you could probably just leave it there if you wanted to.



LEO:  Harmless to leave the change.



STEVE:  But what�s interesting is there�s a new exploit, not in a Microsoft ActiveX control.  And this is sort of � this is a scary sort of thing to come in the future.  Get this.  The WinZip FileView ActiveX control has a vulnerability, and in the same way that this non-browser-oriented XML core services ActiveX control which was exploited a few weeks ago and we talked about, in the same way that it can be invoked through the browser, so can WinZip�s vulnerable FileView ActiveX control.



LEO:  Don�t you get a certificate, though, a permissions�request?



STEVE:  Not that I�ve heard of.  Apparently it...



LEO:  I thought that was what was supposed to protect you against these ActiveX controls, is if you go to a website with an active � embedded ActiveX control, it asks permission before running.



STEVE:  Ah, but that�s where it�s providing you the control.��Here...



LEO:  Ah, the control�s not coming from the website, it�s coming from your system.



STEVE:  Exactly.  And that�s a problem.  And that�s a problem with widely deployed third-party software like WinZip.  I mean, WinZip is very popular.  I�ve got it on all my machines.  And so, you know, here�s WinZip bringing along an ActiveX control which has a vulnerability.  So, I mean, this is really sort of the next generation of problems we�re going to be facing is, you know, once Microsoft gets themselves all battened down, unfortunately the technology Microsoft has created is so powerful that now websites are able to reach through your browser into � literally into the guts of Windows and invoke other components of Windows that were never intended to be used through the Internet.



LEO:  Wow.  Oh, so this file browser wasn�t intended to be used that way.



STEVE:  No.



LEO:  Oh, interesting.



STEVE:  No, it�s just a random ActiveX component that someone found a vulnerability in, which you can ask Internet Explorer to invoke for you.



LEO:  Just launch that for me.  Do we still have this bit that we can set to prevent that?



STEVE:  Yes, there is a kill bit.  And in fact, it�s any version of WinZip 10.0 prior to build 7245.  It�s important to note that they�ve already fixed this.  So the best thing to do is just to update yourself.  Anyone using WinZip, update to the latest version of WinZip, and a build from 7245 or later, and you�ll be okay.



LEO:  Got it.  Great.  Okay.



STEVE:  Now, another thing is that we were talking last week about 32- and 64-bit stuff.  And many people wrote to both you and me...



LEO:  I got a lot of email, a lot of email.  Holy cow.



STEVE:  Yeah, well, I listened to TWiT on Sunday, Leo.  And so I heard you, you know, early in the show you talked about, oh, yeah, I�m going to have to talk about this.  And then you got around to it later on.



LEO:  Yeah.



STEVE:  What I wanted to make clear to people was that it�s not just these Xeon, you know, the high-end, server-level processors that have support for 64-bit technology.



LEO:  Pretty much it�s any modern processor now; right?



STEVE:  Yes, for a number of years many of the � the Pentium�4, the Celeron�D, the Pentium�D processors have included this technology.  Intel calls it EM64T, which stands for Extended Memory 64 Technology.  And so basically it�s, you know, it is full 64-bit technology running inside of the chip that can be turned on.  And in fact, you know, 64-bit Windows, 64-bit operating systems are now able to use that.  And of course Vista, the 64-bit version of Vista, if you happen to have one of these late-model Pentium 4, Pentium D, or Celeron Ds, and it�s not all of them, it�s only some of them...



LEO:  Also the AMD chips, the Turions, many...



STEVE:  Yes.



LEO:  In fact, I have � I�m sitting right next to an AMD�FX64, which I knew was a 64-bit chip.  I don�t know what�� I was just having a brain seizure.



STEVE:  Well, I mean...



LEO:  I mean, I�ve had this 64-bit chip for a year.  Really the point, though, of compatibility is not so much the chip.  I mean, yes, you have to have a 64-bit chip.  But then everything else has to be compatible.  It�s not enough just to say, well, does it have a 64-bit chip.



STEVE:  Well, actually you also have to have a 64-bit-aware BIOS.  And so if you took an older BIOS and put a newer chip in it, that is, you happened to have a chip with this EM64T technology, if the BIOS wasn�t aware, then you still, you know, Vista would still not be able to work on that.  So, you know, and exactly as you said, it�s � I mean, the real thing that�s slowing down the adoption of this, and the reason people aren�t just turning on the 64-bit emulation instruction set within their chips, is that there�s a real dearth still of 64-bit drivers...



LEO:  It�s all about drivers, yeah.



STEVE:  ...for, like, you know, all the hardware.  It really�is.



LEO:  Yeah, okay.  Well, thank you.  I was a fool.  I was a fool.  And I learned very quickly.  I was told many times.



STEVE:  Well, I was first going to call this episode �Embracing Vista,� before I really took a look closer at kernel patch protection.  But we also need to revisit � and this is still in the errata category � the performance of Windows Vista.



LEO:  Because you were saying you had terrible performance.



STEVE:  Well, and I did have terrible performance on RC2, which was the � as I mentioned at the time, I wasn�t sure if it was RC2-ness or if it was the fact that I was using an MSDN download that was just loaded with...



LEO:  The debugger download.



STEVE:  ...the debugging code.



LEO:  Yeah.



STEVE:  It turned � okay.  So I wanted to absolutely and officially correct the record.  Vista flies on this machine.



LEO:  Okay.



STEVE:  I mean, it is...



LEO:  Faster than XP?



STEVE:  Probably not faster than XP.  It is bigger.  But, I mean, it is fast enough on that machine that I built, that, you know, the Pentium 4, 3-gig, with the NVIDIA display, the machine I described a couple weeks ago, where I was just  moaning and groaning and saying, well, who cares if it even works, it�s so slow you can�t even use it.  All of that was due to RC2 and the fact that I was using the so-called �checked build,� a debugging build.



LEO:  Yeah.



STEVE:  I mean, it runs absolutely acceptably fast.



LEO:  Good.



STEVE:  I am, I�m completely pleased with it.  I even installed it, because I knew I was going to be, you know, correcting this presumption and this whole notion that it was so slow on this show, I installed it on my older HP Compaq TC1100 tablet.  And it runs fine there.  I don�t get the fancy blurry interface, which, you know, the UI which I really dislike anyway.  But, I mean, it runs at full speed.  And even they do a bunch of really cool things for tablet PCs where, like, it gives you this little twinkly star cursor since you really don�t need a cursor because you�re using a stylus on the tablet.  And when you touch it, a little ripple kind of comes out from the point.



LEO:  Oooh.



STEVE:  Oh, I mean, it�s just wonderful.  So I don�t know, I�m really happy with it from that standpoint.  And as I laid the groundwork, I�m very happy with the security-related things Microsoft has done.  So I want to talk about�that.



But in my last little bit of errata, we got a really neat piece of email that talked not only � it was from a Security Now! listener � that talked not only about SpinRite, but believe it or not about Astaro.  He said, �I subscribed to the Security Now! podcast a while back, and some of the information I�ve received as a result has been fantastic.  Like many others, I have purchased a copy of SpinRite as a way of saying thank you for the real information you and Leo impart every week.  Shortly thereafter I found myself in a situation where I had a dead system on my hands.�  He says, �I popped in the SpinRite CD, and 45 minutes later the system was back to its old self.�



LEO:  Yay.



STEVE:  Then he said, �I immediately purchased an additional three licenses to bring my office up to site-license status,� which of course allows, you know, his whole office to use SpinRite whenever something like this happens.  And he says, �Any product that can deliver that well is a must-have resource in my opinion.�  Then in his next paragraph he says, �I�d also like to thank you for allowing Astaro to sponsor your podcast.  I have approximately 30 small satellite offices...�



LEO:  Wow.



STEVE:  �...and was at my wit�s end trying to gain control of inappropriate web surfing, as well as providing some form of firewall IDS solution,� you know, intrusion detection solution, �I could manage from one location.  After hearing their name over several episodes of Security Now!, I contacted Astaro and arranged for a demo box.  Within a couple of weeks I had all the evidence I needed to make a case for their product.�



LEO:  Oh, good.



STEVE:  �We have 13 of the devices deployed already and will be rolling out an additional 18 over the next few weeks.  Had I not heard their name on Security Now!, they would likely have never come to my attention, and we would have missed out on a great product.  Thanks again for all the hard work.�



LEO:  Two great products, I�ve got to say.



STEVE:  Isn�t that great?



LEO:  So more at SpinRite.info.  And of course SpinRite�s available through Steve�s site, GRC.com.  It�s a disk recovery and maintenance utility.  Did I say �a,� it really is �the� disk recovery and maintenance utility and is a must-have for anybody who wants to update their hard drive, keep an eye on it, maintain it, or very often recover it when the worst happens.  As long as we�re mentioning Astaro, let me do the Astaro ad, and then we�ll get into our Vista kernel patch protection and how hacked it is.  Oh, you scare me when you say that.



But we do want to thank Astaro for supporting the show.  The Astaro Security Gateway is their product.  If your small or medium business network needs superior protection from spam, from viruses, from hackers, complete VPN capabilities � which is how I use it, that�s fantastic � you�ve got intrusion protection, you get content filtering, as you heard, and an industrial-strength firewall, all in a very easy-to-use, high-performance appliance, contact Astaro, that�s Astaro.com, or call 877-4AS-TARO to schedule a free trial of an Astaro Security Gateway appliance in your business.  There is, by the way � and I really do want to emphasize this, in fact I should put the link in the show notes because I think people have said it�s kind of hard to find � a free download for non-business users.  So you could put it on your � actually, if you go to freshmeat or SourceForge, I think it�s on there, too � you could put it on your, you know, beat-up PC, you know, and use that as a firewall, and it does all the same thing.  In fact, if you pay the subscription, you even get the antivirus and the antispam and all the other commercial features.  So, and it�s a very reasonable deal, I think.  The yearly price is very, very affordable.  Astaro.com.  We thank them for their support of the podcast.



So now let�s talk about the Vista kernel patch protection.  This is the thing that�s been controversial up to now.  Isn�t this the thing that Symantec...



STEVE:  Yup.



LEO:  ...and Adobe and others were complaining that they didn�t have access to the kernel?



STEVE:  Yup.  Now, I want to make sure people understand that I am pro Vista from a security standpoint.  I mean, I�m worried about the fact that apparently they rewrote the network stack from scratch.  We�ve talked about that, you know, in our episode called Vista�s Virgin Stack, because it�s so easy to recreate errors which have been resolved years before and to reintroduce these old problems.  But the thing that encourages me about Vista, and we�re going to be talking about it I�m sure, you know, off and on here now because, you know, it�s important, is Microsoft has done a number of things which are policy-wise really pro security.  You know, the best example of that that we�ve seen is when they finally turned on XP Service Pack 2�s firewall by default.  The moment that happened, the world changed.  Because, you know, even though XP was out and XP had a firewall, and there were even third-party providers of firewalls, you still had all those worms.  And the way the worms worked was having access to open incoming ports.



LEO:  It�s really becoming obvious that, in the Windows world, that inexperienced novice users are the real threat.  If you�re sophisticated, you know how to protect yourself.  So having something be on by default is so important because it�s not the experts we�re worried about.



STEVE:  Yes.  And so, for example, that�s why I think it will clearly make a huge difference that Windows Defender is built into Vista, that is, that Windows will have a malware scanner built in.  It�ll update itself.  It�ll scan by itself.  I mean, all that�s turned on when anybody buys one of these new Vista machines in �07.  So, I mean, it�s really a good thing.  Now, what�s always been the case, unfortunately, since the very first version of Windows, is that Microsoft themselves used undocumented APIs that existed in their operating system that only they knew about.  The developer community figured that out and started doing the same thing.  And in the case of even later operating systems, for example...



LEO:  You mean using Microsoft�s undocumented APIs, not creating their own undocumented APIs.



STEVE:  Yes, correct.  Yeah.  Thank you for the clarification.  Yes.  Using Microsoft�s � doing the same thing Microsoft was and using their undocumented APIs.



LEO:  Which Microsoft said don�t do.



STEVE:  They said don�t do.



LEO:  Don�t do what we do.



STEVE:  Well, and they said, you know, we know what we�re doing.  So if we were to change the operating system so that those things went away, then...



LEO:  We�d know.



STEVE:  We would know, so we would change what we were doing.  Anyway, what has happened is there�s been this � over the years a culture of the kernel has developed which just shows the kernel no respect at all.  And...



LEO:  Do you want to explain what the kernel is, how important the kernel is?



STEVE:  Well, I think we�ve really talked about that a lot.



LEO:  Oh, okay.



STEVE:  And I want to � there�s a lot of ground I want to cover here.  So I don�t want to diverge too much.



LEO:  Suffice to say it�s the basic part of the operating system, the most important part of the operating system.



STEVE:  Well, yeah, I mean, exactly.  It is, you know, if you were to divide the operating system into the actual OS and then a lot of applications that come along with it.  And then, of course, device drivers that are � that sort of become part of the OS.  You know, this is what you get from Microsoft before you start adding applications.  The problem is � and it provides all the fundamental services that make the computer go.



Well, the kernel has never gotten much respect because it hasn�t protected itself from change.  And even though Microsoft has said do not change, do not hack the kernel, Symantec and McAfee and Zone Labs and Kerio and literally everybody, you cannot build a personal firewall without breaking those rules.  Because Microsoft until Vista has never given us the ability to hook into the operating system deeply to allow us to implement our own firewalls.  So, for example, the only way to do a personal firewall has been to break the rule, break the official rules, and ignore Microsoft�s admonishments about not hooking the kernel.



Now, the problem is that it�s not just good software that hooks the kernel.  It�s, as we know, malware, you know, formerly known as rootkits.  The famous now Sony DRM rootkit disaster, where they were installing � where Sony was secretly installing a rootkit when someone just played a Sony-published audio CD in order to enforce their DRM, that was doing the same thing.  It was...



LEO:  You had to modify the kernel to do that.



STEVE:  Yes, it was hiding itself by essentially hooking into the kernel and filtering, that is, you know, like looking at every single action that the OS was doing.  And, for example, if you tried to do a directory listing, it would skip over the listing of itself.  Well, the problem is, first of all, not only can this stuff be malicious, rootkits use this technology to hide themselves; but, if not properly implemented, they really can destabilize the operating system.  You know, the classic case was, you know, the spyware that I first found, the [Aureate] spyware.  It was badly written, and it hooked into Internet Explorer.  And it damaged Internet Explorer.  That is, Internet Explorer � it was so poorly written that it broke the OS.  But because it was installed secretly, no one knew what had happened to their computer.  It just, you know, Windows sort of started having a hard time.



And so I never expected that when I produced OptOut, my little free program to remove it, that we�d be getting mail back saying, well, you just fixed my computer.  It was like, what?  That�s not what it was supposed to do.  But it turned out that by removing this spyware which was secretly damaging their computer, their computer got better.



So what Microsoft has done with the 64-bit version of Vista, as we talked about before, is they have implemented something that they call their kernel patch protection, which has the nickname of PatchGuard.  Now, they would desperately love to give this technology to the 32-bit platform, that is, to the Windows, you know, XP and Vista that runs on 32-bit hardware, but they can�t.  Because, exactly as I was saying, there is such pervasive use of this rule-breaking, kernel-modifying behavior that it would just, I mean, it would just scrap, I mean, even, you know, not even device drivers from Symantec and McAfee, but random printer drivers.  I mean, obscure things you would never think would have any reason to modify the kernel turn out to have, just because the kernel has had no respect at all, they just go in and make little changes here and there.  And, you know, mostly this stuff works.  But it turns out it is implicated in destabilizing Windows.



LEO:  Well, you could see what a mess this would make.



STEVE:  Well, and, I mean, it�s phenomenal actually that it has worked as well as it has because, you know, people want their machines to work, and you put something in, and it breaks it, you take it out, and it fixes it.  So it�s like, okay, well, I�m not putting that in again.  So what Microsoft has decided to do is they have said enough is enough.  We are, with our 64-bit version, since that requires brand new kernel mode drivers, device drivers and code anyway, we are going to proactively enforce our statement that no one can modify the kernel.  And that�s...



LEO:  We�re going to keep you from doing it.



STEVE:  That�s the difference, yes.  We are going to proactively enforce it.  Now, here�s the problem with doing that.  And this bears on a lot of the things we�ve talked about before.  The kernel itself is trying to protect itself.  That is, it�s running at the same level of protection, the same protection domain, as the code which it�s trying to protect against.  This is fundamentally impossible to do.



LEO:  Oh, no.



STEVE:  You can�t � yes.  You know, we...



LEO:  That sounds bad.  I don�t know what that means, but it sounds bad.



STEVE:  Well, and a perfect example is, you know, like SSL, the Secure Sockets Layer, it�s a public spec.  Everybody can know exactly how it works.  And knowing how it works doesn�t allow an attacker to circumvent it.  Okay?  Knowing how PatchGuard works, that is, the Vista kernel patch protection, knowing how it works allows it to be circumvented.  And so what � and again, Microsoft knows this.  And so they�ve gone to extremes to obfuscate and to misdirect.  They�ve got deliberately misnamed labels that are labeled something innocuous looking.  They�ve got routines that do � that say they do one thing and actually do another.  They create � they have a pseudorandom number generator that they initialize from something called the RDTSC, The Read Time Stamp Counter.  That�s a very high-resolution timer.  Basically it counts every single clock cycle the processor had.  So it creates a nice source of randomness.  They use that to randomly scramble the PatchGuard data structures so that they can�t easily be found in memory.  But all of this exists in memory, and there are already white papers on the �Net with sample code which circumvents PatchGuard.



LEO:  This is what they call �security through obscurity.���And...



STEVE:  Well, it is exactly security through obscurity.



LEO:  And when you�re a prime target like Windows, you can�t expect that to hold very long.



STEVE:  Well, so here�s what this means.  And I want to � again, this is a tricky conceptual issue that I want to make sure I get really clear.  The fact that it can be circumvented means a few things.  But the fact that it�s there at all means something else.



Okay.  So first of all, Microsoft is proactively enforcing to publishers of commercial software like Symantec, like McAfee, like Zone Labs, like, I mean, anybody who in the past has been a deliberate kernel modifier, Microsoft is saying no, no more, it stops here at the 64-bit kernel, as we, you know, we wish we had done this when we went from 16 bits to 32 bits.  We didn�t.  Well, we�re doing it now.  And so it�s just like no more, we are going to proactively prevent this.  Essentially what this means is anybody who does deliberately circumvent the PatchGuard does so truly at their own peril.  And...



LEO:  And you could presume that Symantec�s not going to do this, McAfee�s not going to do this, Zone Lab�s not going to do it.



STEVE:  Exactly.  I mean, what I like...



LEO:  But guess who is going to do it?



STEVE:  Yes.  But what I like about this is that it raises the bar to a point where the good guys really won�t do this.  The reason this is important is that this is not the end of kernel protection.  What Microsoft will next do, and this is just sort of a stepping stone, is they will implement their own Blue Pill.  We�ve talked about the Blue Pill before, how it essentially slips in a hypervisor that runs underneath the kernel in order to be, you know, like be a super rootkit.  The next thing Microsoft will do is they will add hypervisor technology into some future version of Vista, which will finally then make this kludge which is PatchGuard unnecessary.  The reason PatchGuard is a kludge is it isn�t actually kernel patch prevention.  It�s kernel modification detection.  What it does is it runs every five to ten minutes, randomly timed off of a timer in the kernel.  One of the attacks of that is just to turn off the timer.  And it turns out you can.



LEO:  Oh. 



STEVE:  You can find the timer...



LEO:  You just in one sentence blew the whole thing, Steve.



STEVE:  ...and you can just turn it off.  And there�s...



LEO:  Well, that�s pathetic.



STEVE:  There�s sample code on the �Net for doing that.



LEO:  And that works?



STEVE:  It works.  It�s been proven.  It�s been tested.  It just turns off PatchGuard.  Thank you very much.  One of the other things that happens...



LEO:  So it�s very clear Microsoft must have known that this is not in any way secure.



STEVE:  Oh, absolutely.



LEO:  This is just a way of saying to the good guys, you can�t do this anymore.



STEVE:  It�s a way of saying...



LEO:  You�d have to be a bad guy to do it.



STEVE:  Yes.  It�s a way of saying to the good guys, we are really, really, really, really, really serious about thou shalt not touch the kernel.  And so, from this position, Microsoft is now free to make kernel changes.  See, they�ve been locked up in the past because everybody was going digging into the kernel, doing their own thing down there.  Microsoft in the name of compatibility could never make any changes.  Even though they said, please don�t mess with the kernel, we want to be able to make changes, Microsoft couldn�t.  Because nothing is more important to Microsoft, bless their hearts, than keeping compatibility as they move forward.  So now by doing this, by being proactive this way, they�re able to say, you know, if you do anything like this, don�t come crying to us because we guarantee you we will break things in the future.  So what they�ve done is they�ve really created a boundary, and they�ve enforced it in a way that, yes, it can be defeated, it has been defeated.



Now, the other problem is that we really can�t look at this today as really strong malware prevention.  We can look at it as really strong good guy prevention, that is, it�s going to prevent the commercial guys from making changes.



LEO:  It�s like putting a fence around a new lawn, saying �Keep Off the Grass.�



STEVE:  Yes.  And so...



LEO:  And if you get on the grass, you�re breaking that law.  You can do it, but that makes you a bad guy.



STEVE:  And ultimately Microsoft will be able to leverage the hardware.  See, again, we�ve got � we�ve talked about, like, ring 0 and ring 3, ring 0 being very privileged, ring 3 being where the user mode code runs.  Code in a different privilege ring can be controlled.  But we�re talking about code, you know, device drivers modifying the kernel when the device driver is in the kernel.  So by using, in the future, by using hypervisor technology, you know, virtual machine technology to supervise the kernel, it will be possible to lock down the kernel.  But you could only do that if you knew the kernel had never before been modified.  Because locking it down, if somebody were depending upon it being modified, that would render their software useless.  So Microsoft is saying...



LEO:  So baby steps.  We�re taking baby steps.



STEVE:  We�re going to make it really, really, really hard to modify the kernel so that, if you do, you know, you have at your own peril.  And then in the future we�re going to really lock it down using hardware technology we have not yet deployed, which will not allow it to be modified.  And that�s where we�ll get real malware prevention.  We don�t quite have it yet, but we�re on our way.  This is like an incremental step towards that.  And again, I salute Microsoft.  This is a really good thing they have done.



LEO:  Kernel PatchGuard is not in 32-bit, though.  It�s only in 64-bit?  Or is...



STEVE:  It�s even been in � you�re correct.  It�s even been in the 64-bit version of XP.



LEO:  Oh, okay.



STEVE:  And so it�s been running there.  And in fact the...



LEO:  That�s why we know how it works, probably, yeah.



STEVE:  That�s why it�s been, exactly, so carefully looked at.  And I�m sure, I mean, this is literally � it�s cat and mouse.  I�m sure when these papers came out Microsoft said, oh, let�s work around those workarounds.



LEO:  Right.



STEVE:  And then, you know, these guys just re-reverse engineer it and work around the workaround workarounds.



LEO:  But let�s not get around to that because this is only an hour-long podcast.  We�re not going to go on forever.



STEVE:  As a matter of � and our hour�s up, Leo.



LEO:  Hey, well, that�s a really great explanation.  And it does give me hope that not only is Microsoft, you know, understand the problem, but they�re, you know, it doesn�t happen overnight, but they�re making progress.



STEVE:  Yeah.  I thought it was important not to oversell what PatchGuard does because I felt like I did that a couple weeks ago.  I told people, oh, this prevents the kernel from being modified.  I did a lot more research, and it�s like, well, okay, no...



LEO:  Only by the good guys.



STEVE:  Exactly.  I mean, it really raises the bar.  And it does allow Microsoft to alter the kernel as they really need and ought to have the right to do for our own sake in the�future.



LEO:  Well, I know that I am actually now looking at Vista-capable hardware because it�s really time.  And that�s why I�m going to Dell.  And I encourage you to do the same.  I�ve got my XPS 700.  We got that for Call For Help.  And now I�m looking for laptops.  Almost all the Dell stuff now has that Vista Capable and Vista Premium Ready sticker, so you know what you�re getting.  And the Vista Express Upgrade means you can upgrade to Vista the minute it�s available, January 30th.  We encourage you, if you�re looking for a Windows machine, to go to TWiT.tv/dell to Leo�s Picks Page, click the links there.  Whatever you buy once you go through that page we get credit for.  And we do appreciate that.  And we also appreciate the support of Dell for this program.  That�s TWiT.tv/dell.



Steve Gibson�s website is GRC.com.  That�s where of course you�ll find SpinRite, as we�ve mentioned.  But not just SpinRite.  Also the show notes, the 16KB versions of each episode for the bandwidth impaired, transcripts thanks to Elaine, a lot of useful information, and of course Steve�s wide-ranging list of free programs for your security.  It�s GRC.com.



Steve, have a great Turkey Day.



STEVE:  Yes, Leo.  I may have a surprise for people next week, speaking of my list of free programs.



LEO:  Oh, he�s been working.



STEVE:  I�m really bad about pre-announcing things, so I�m not going to say anything.  We�ll see what happens next�week.



LEO:  Steve�s been in the lab.  We�ll find out what he�s got next week.  We�ll see you next Thursday on Security Now!.





Copyright (c) 2006 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#68

DATE:		November 30, 2006

TITLE:		Listener Feedback Q&A #13

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-068.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 68 for November 30, 2006:  Q&A #[13].



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Dell.  For this week�s specials, visit TWiT.tv/dell.



Time for Security Now! with Steve Gibson, where we talk about the latest security news and explain security issues.  We talk about all kinds of things, everything from VPN to virtualization to encryption and security.  And this time it�s our Mod 4 episode.  Hi, Steve.



STEVE GIBSON:  Hi, Leo, good to see you.  Or good to hear your voice.



LEO:  I�m seeing you.  I�m imagining you.  I can see you in your Security Now! lair, surrounded by security devices.



STEVE:  Next month we will be together again in Toronto, and so we�ll...



LEO:  I think your last time in Toronto.  You�re not coming up in January, are you?



STEVE:  Exactly, it�ll be my last time.



LEO:  Yeah.  Then we�re moving to Vancouver.  And we�ve got to find Steve a direct flight or he�ll never come up.



STEVE:  Yeah, you know, I did look at even the direct LAX to Vancouver.  And there�s enough flying time that there isn�t time for me to get up there � oh, and there aren�t any super early flights.  And so there�s just no way for me to get up in time.  But I�ve got some friends in Vancouver, so I can come up the night before and hang out.



LEO:  There you go.  Come visit your friends.  There you go.  We�re your friends.  Come visit your friends.



STEVE:  Well, I was listening to � I�ve really been listening to Windows Weekly with you and Paul because clearly Vista is very much on my mind; it�s very much on the minds of our listeners.



LEO:  Well, and today is the launch date for business.  In fact, I�m doing a bunch of interviews.  I�ll be doing �All Things Considered� this afternoon.  Everybody wants to cover it right now.  Even though in fact it�s not available for months for consumers.



STEVE:  Well, I know.  It�s sort of interesting and frustrating.  I got email from someone who has, through his corporate volume purchase agreement, they just got access to it.  And it�s funny because he was explaining that his experience exactly echoed mine.  He initially set up Vista on a machine, and it was just, like, doggy slow.  I mean, it was really lagging.  And his graphics had a 2.0 rating.  It turns out that he updated to the newest NVIDIA beta drivers.  And his graphics performance jumped to 3.6.  He got whatever the heck that � what is that translucency called?  Is it...



LEO:  Aero Glass.



STEVE:  Aero Glass, yeah.  Which to my mind, you know, I�ll be really interested to see what people think after they�ve had an experience with it.



LEO:  It�s pretty.



STEVE:  It just bugs me.  It�s like my contact lenses are fogged up or something.



LEO:  You�re a Windows 2000 guy.



STEVE:  Yes, I am.  But I�ll tell you, Vista really looks nice.  And he also turned off the glass and then saw, as he said, and this has been my experience, it performs every bit as well as XP does.  I don�t see any...



LEO:  And there are some enhancements that will, I think, make it faster, things like this hybrid drive support.



STEVE:  Well, it�s funny you mention that because that�s where I was going with this.  I wanted to mention that the hybrid drives are not for performance.  They are for battery�life.



LEO:  Well, but there is some performance benefit.  For instance, it wakes up faster, things like that.



STEVE:  Yes.  So there are some benefits from caching.  But the reason it�s on on small drives first and on laptop drives first, as you and Paul were mentioning in last Friday�s Windows Weekly, is the whole idea is that laptop drives, or really any drives, really spend most of their time spinning and doing nothing.  But that�s burning power.  So what the hybrid drive, the whole concept of the hybrid drive is that the spindle will be stopped most of the time; and that as the OS writes things to the drive, it fills up this non-volatile buffer with stuff eventually to be written.  And only as that buffer gets near full does the drive then autonomously say, whoops, looks like I�ve got to get this buffer cleared.  So it spins the drive up.  It then flushes this non-volatile cache from inside itself, which is where this non-volatile cache is, out to the actual magnetic media.  It then erases the cache and shuts the spindle down again.  So it completely changes the model of how a laptop drive works.  So that instead of mostly spinning, it�s rarely spinning.  And the whole motivation for this was battery life on portable drives.



LEO:  But wouldn�t there be some performance benefit because of this cache at all?



STEVE:  Well, you mentioned at some point, I don�t know if it was last Friday or before, that EEPROM technology does not write very fast.



LEO:  And that was my concern, is how are we speeding things up by using flash memory?



STEVE:  Exactly.  And in fact we�re really not that much.  I mean, this USB boost, that�s the technology which can be used to enhance the booting of XP.  And the reason that the hybrid drive can�t be used that way is its buffer is all about not requiring the spindle to be spinning all the time.  So it isn�t actually saving quick boot stuff.  That�s what the USB boosts do.



LEO:  So you might want to use both.



STEVE:  I think you probably will.  And in fact I�ll be experimenting with it here shortly so I can begin � and doing some benchmarks to tell people, you know, like how this thing performs either way.



LEO:  Now, you can�t get a hybrid drive yet, so it�s moot.  But can you do the USB boot, the ReadyBoost, right now?



STEVE:  Yes, all that technology is available.



LEO:  Okay.  I just ordered a laptop from Dell for Vista, an M1210, that has a good video card, lots of RAM, core 2 processors.  And so I�ll try that.  I guess we have to find some thumb drives that are ReadyBoost ready, I guess.  I don�t know if they�re selling such things yet.



STEVE:  I haven�t looked at it, so I don�t know one way or�the other.  My guess would be that that�s not necessary�because...



LEO:  Any relatively fast USB would be fine.



STEVE:  I would think so.  And then the idea would be that XP would write to it a bunch of stuff that it knows it�s going to need when it�s booting, that enough of XP would boot to get the USB drivers going, at which point it would suck in everything from the USB that it would normally get from the disk.  But again, Leo, yes, everyone�s annoyed that Windows takes so long to start up.  But I want people to understand that, from my perspective, Vista boots as quickly as XP.  It runs as quickly as XP.  I want to really make sure I back out fully from that first perception I had, which was entirely due to the fact that I was using debugging version and the prerelease version.  And it was clearly not happy with my hardware.  Whereas the final one really got happy.



The other thing is that I wanted to mention I also installed it on, I think I said last week, on a tablet.  And one of the things, I mean, they�ve done some things for the tablet which is so cool.  But when it first installed � and this relates to something that Paul mentioned last Windows Weekly�� when it first installed it didn�t have the Wacom drivers for the tablet technology.  It went out to Windows Update, got the drivers, and suddenly enabled all of the tablet stuff.  And the cursor, when you�re using the tablet, since you�re using a stylus you really don�t need a cursor under the stylus.  So it�s always sort of annoyed me a little bit that I�m dragging this standard Windows cursor around when I already know where I�m pointing.  They changed that so that the stylus with the tablet is this little tiny sort of twinkly star, I mean, very subtle.  And when you tap the surface of the tablet, this little ripple comes out.  It�s just gorgeous.



LEO:  That�s Aero Glass, Steve.  It is, because it�s alpha transparencies.  That�s got to be Aero Glass.



STEVE:  Except that it doesn�t give me the glass UI because�I�ve got a relatively low performance graphics.  So�this is just an animated cursor.  I think it just uses cursor animation.



LEO:  Oh, it�s not rippling the desktop.



STEVE:  No, no.  But, I mean, it�s just a little ping sort of, like, echoes outwards from where I tap the stylus.  I mean, it�s just little touches like that that make me think, well, I�ll be running Vista on my tablet here as soon as it�s fully supported.



LEO:  Are you talking tablet PC, or are you talking a Wacom tablet on a regular PC?



STEVE:  In this case it�s one of the HP Compaq � it�s the same tablet that Jen is using because I really was admiring it when I was up at Call For Help, so I got one.  HP doesn�t sell them anymore, but you can get them on eBay.  It was the�TC1100.



LEO:  Yeah, I had a 4200, actually.



STEVE:  I really like it.



LEO:  So they haven�t yet shipped the Windows Vista Tablet�Edition.



STEVE:  Correct.



LEO:  Or you just don�t have a copy of it.



STEVE:  Well, it�s interesting.  I don�t have that specifically, but there is all of the apparent tablet support is in Vista.



LEO:  It�s in there.  Okay.



STEVE:  I�m guessing that there is no more a tablet edition of Vista; but in fact that Vista will just have that, and it�ll work when it�s on a tablet.



LEO:  Very good.  I�m looking forward to it, I have to say.  The jury�s still out, as you said, on security and reliability and so forth.  And it�s not really a target yet.  Hackers haven�t had a chance to really bang on it.  But it can�t be any worse.  Well, maybe it could.  I take that back after hearing the Vista Virgin Stack episode.  It could be�worse.



STEVE:  I think there will be some problems.  We�re still suffering stack overflow sorts of buffer overrun stuff.  I don�t see anything that�s going to fix that until we get the data execution prevention, the DEP technology, ubiquitously present in users� machines.



LEO:  But any new machine will support that.  And I would hope Vista has that turned on by default.



STEVE:  Well, that was exactly what I was going to say.  All of the lessons we have learned have told us that technology that�s not on by default might as well not be there at all.  It has to be on, like Service Pack 2�s firewall.  That�s what finally shut down all of the worms.  And so Vista will be better than XP was in the beginning because it�ll have the firewall turned on by default.  But the question will be, does it have DEP turned on by default?  You could certainly imagine that the 64-bit version may, although that�s user-mode protection, and that�s very different than kernel-mode protection.  Actually we�ve got a couple questions in today�s Q&A that are going to be addressing that.  So we�ll be covering that.



The last thing I wanted to mention was something�s just happened that I thought was very significant, and that is that SANS, the SANS Internet Storm Center, the ISC honeypot has found recently, out of 12 malware specimens, three of those were virtual machine aware.



LEO:  Oh, boy.  You mean Blue Pill-style attacks?



STEVE:  Well, no.  What it was, this was malware that was deliberately detecting if it was being run in a virtual machine and being benign, if so.



LEO:  Oh, interesting.



STEVE:  Yes.  It would see that it was in a VM, and it would not do its bad stuff.



LEO:  Why not?



STEVE:  Because they want to thwart researchers who are trying to use virtual machines as containers...



LEO:  As do most of these honeypots.  In fact, we learned this in Episode 1 of Security Now!.



STEVE:  Exactly.  Exactly.  So the idea was that, you know, the malware will not misbehave if it�s in a virtual machine container so that researchers have a problem.  And the other insidious thing is that, if end users were using, like if security-aware, high-end tech users were using a virtual machine to test software for its containing anything malicious, and they were putting it in a virtual machine as a test environment, deciding that, oh, look, this is not doing anything bad, it hasn�t hooked the kernel, it hasn�t modified any system files, blah blah blah, then they take it out of that container to install it on their native machine�platform.



LEO:  And then, boom.  Gotcha.



STEVE:  Exactly.  Only then would the malware launch itself and hook itself into their system.



LEO:  These guys are amazing, these guys writing this stuff.  I may not want to give them a lot of credit, but they really do work hard to keep up with what�s going on.



STEVE:  Well, and this is the nature of any sort of a cat-and-mouse scenario where we don�t really have robust protection.  All we�ve got is the good guys battling the bad guys in a more or less level playing ground.  And when the playing ground or playing field is level, and the bad guys are able to do as much, they have the same resources as the good guys, I mean, that�s always been the virus/antivirus, spyware/antispyware battle is this back-and-forth thing.  And so it�s the reason, for example, that I salute Microsoft for being so determined not to allow the kernel to be modified under the 64-bit version of XP and Vista, and because this will eventually, even though as we saw last week that the Windows kernel protection doesn�t really solve the problem, it�s a stepping stone to them introducing a hypervisor that will lock down the kernel eventually and finally really prevent rootkits from ever being able to get a hold.  So, neat stuff.



LEO:  Good.  I�m wondering if I should � I guess I will try to install the 64-bit version of Vista first on this new laptop, just to see if it runs.



STEVE:  I�m definitely going to be doing experiments, too.  I downloaded the 64-bit version.  The ISO for the 32-bit version, I think it was 2.687 gigs.  The 64 is 3.6 or something.  So it�s an extra gig of stuff.  So it�s a bigger ISO.  Still fits on one DVD.  It�s a substantial download.  But it�s definitely something that needs to be taken a look at.  And I want to see what drivers are available because right now Vista had all the drivers built in that I needed for the two machines that I�ve run it on, which are not new machines.  And so why wouldn�t the 64-bit version, since all these drivers are coming from Microsoft, why wouldn�t the 64-bit version also know about all the same hardware?



LEO:  You have to have 64-bit drivers, as you pointed out.  And I guess they haven�t gotten around to writing all of those drivers yet.



STEVE:  Well, it�s the third parties who have wacky hardware that isn�t...



LEO:  I guess if Microsoft has the support, if it�s a Microsoft driver, why wouldn�t they?



STEVE:  That�s my point.



LEO:  That�s your point?  Yeah.



STEVE:  Yeah.  And Vista, as Paul said on Friday and as my experience has been, Vista already has known about a much wider range of hardware right out of the box than XP or certainly any earlier operating systems have.



LEO:  You�ve got to get something for five years of work.  I�m looking forward to trying it on this, I mean, it�s a brand new Dell laptop.  It should have all of the, I mean, shouldn�t be anything weirdo in it.  I mean, certainly Microsoft knows about every bit and piece of that laptop.  So you�d think 64 would install right out of the box.



STEVE:  I have a feeling.



LEO:  We�ll see.  I�ll let you know.  Shall we get to our questions?  We�ve got a lot of them.  This is, as I said, Episode 68 means it�s divisible by four, and it�s Question-and-Answer #[13].  We�ve got a dozen excellent questions from you, our esteemed listeners.



Oh, I want to say before we do that � we�ll get to the questions in a second.  But I do want to mention Dell, since I already did, give them a little plug and remind you that the laptop I just bought, the big desktop that we just bought for Call For Help, and I put one affordable system in there, too, are all available at the Leo�s Picks Page, TWiT.tv/dell.  If you�re buying a new computer, looking for a computer for Vista, may I recommend Dell.  We�ve had such good results with them over a decade now, using them on TV, where it really is a challenging environment, and we�re constantly banging on these things, installing new stuff, really working it harder than you ever would at home.  And they just stand up and work and work and work and work.  TWiT.tv/dell.  Any Dell you buy through that page, any Dell at all will benefit the TWiT.tv network.  So we thank you and Dell for their support.



Now let us � do you want to quickly mention SpinRite before we go to these questions, or should we save that for later?



STEVE:  We�ll talk about it next week, actually.  I�ve got another couple cool stories about SpinRite for next week.



LEO:  All right.  Because I do want to make sure everybody knows about SpinRite.  And you have some neat new software coming up on GRC.com, too.  We�ll talk about that when it�s ready.  I know you�re working on it.  I�ve seen a picture.



STEVE:  I mentioned it last week.  I wasn�t sure I was going to do it.  Now I�m in the middle of it.  And so next week we will be announcing the first piece of security software to come directly from the content in Security Now!.  It�s been my talking about this stuff in the last couple weeks that I thought, you know, I�ve got an idea for something I want to write.  So it�s a new piece of GRC freeware we will announce, and it�ll be available next week.



LEO:  Good.  Just in time for Christmas.  GRC.com.  All right.  Question 1 from J. Sisco of Seattle, Washington:  You were talking about the BitLocker technology in the forthcoming Windows Vista, its full disk encryption.  I work at a company that�s considering rolling out the technology to all of their laptop and desktop machines.  Good idea on the laptops, I think.  You see people like the Veterans Administration losing laptops with private data on there.  He says:  Since you�re intimately aware of how a hard drive functions for data, what are the reliability implications of using full disk encryption?  For example, if a non-encrypted hard drive were suddenly to get a bad sector, well, only the files sitting in that particular sector would be unreadable.  Does full disk encryption fail if there are errors on reading a sector?  In other words, am I going to lose a whole lot?  Does the entire volume fail over one bad sector?  And how would data recovery tools deal with the randomized data?  Very good question.



STEVE:  Really good question.  First of all, the good news is the encryption is only at the sector or cluster level, depending upon what type of encryption you�re using.  So the granularity of loss is no larger for encrypted drives than it is for non-encrypted drives.  As for data recovery software, I can�t speak to any other applications, but I know that SpinRite will work just fine.  It won�t care that it�s being asked to recover the data and the sectors on an encrypted volume because SpinRite deals with the drive at the hardware level, underneath the encryption, underneath the file system.  So it will recover the data on a sector, even one that it can�t understand.  It still does data�recovery.



LEO:  And I would imagine that even a recovery system that works at the file system level, if what you�re saying is true, that the encryption is sector by sector, so the FAT 32 or whatever the file allocation table, that�s going to be the same, right, that�s still going to work.



STEVE:  Well, except that the software would have to be viewing through the encryption.  So you�d have to have something running first...



LEO:  So it couldn�t recover an encrypted file.  It couldn�t say, oh, well, here�s the FAT, and here�s where the things are, let�s recover those sectors.



STEVE:  Again, it�s impossible to be accurate.  You�d have to know exactly how the software was working, and what the nature of the damage was, to know whether it was going to be able to help you.



LEO:  Okay.  But a qualified yes, it�s okay.



STEVE:  Yes.  And certainly in the case of SpinRite, I know how SpinRite works, and it will have no problem at all.  But definitely there is no greater loss potential.  It�s not like you lose, as this guy asks, the entire encrypted volume�if you do lose a sector, any more than if it were non-encrypted.



LEO:  On something like TrueCrypt, where it�s making a big blob of encrypted data, that�s risky, yes?



STEVE:  Well, except that internally it�s going to � individual file sectors are being encrypted standalone.  I guess the point is no sector depends upon any other sector.  And so there�s no...



LEO:  I see what you�re saying.



STEVE:  ...blanket problem that is being increased by just encrypting individual sectors because each one stands alone.



LEO:  You may not know where a file begins and ends, but each sector stands alone.  So if you lose a sector, you�ve�only lost whatever that sector belongs to, not everything�else.



STEVE:  Right.



LEO:  No interdependency.  Okay, that makes sense.  Joe Rodricks in Massachusetts asks:  I�m over my head here, but I�m curious.  Why can�t a kernel be more like a man?  Oh, no, no.  Why can�t a kernel � Colonel Pickering.  Why can�t a kernel � this is inspired by the Vista kernel lockdown talk we had earlier.  Why can�t a kernel have an MD5 or other hash on a non-writeable medium, say a burned CD of a kernel hash that could be installed so at least the kernel can be aware it�s been modified?  Oh, that�s interesting.  So you�ve got an MD5 checksum on it.  You�ve put it somewhere that can�t be modified.  Then you could validate whether that kernel�s been changed or not?  He says:  I�m sure something along these lines could be helpful.  Is he�right?



STEVE:  No.



LEO:  And that�s because...



STEVE:  But it�s a great question, which is why it�s here.  It�s because the kernel is the thing that would be doing the testing of itself.



LEO:  Right.  You�d have to use an external operating system to check the kernel.



STEVE:  Well, exactly.



LEO:  You could do that, I guess.



STEVE:  Well, and we talked a long time ago about the idea of using an external, in the case of rootkit detection, using something outside to look in and check for modifications that a rootkit had made to the OS.



LEO:  That�s how RootkitRevealer works.  It�s its own operating system, essentially.



STEVE:  Exactly.  So the problem here is that if the kernel could be � and the reason I wanted to bring this up is that it makes it more clear, I think, that nothing can protect itself at the same level of capability.  Malware and antimalware are fighting on a level playing field.  Rootkits and kernels are fighting in the kernel space on a level playing field.  Anything the kernel can do, a rootkit running at the same privilege level can undo.  So that the first thing a rootkit might do is neuter the kernel�s check of itself.  And there�s no way the kernel could know that it had been neutered because it could be prevented from knowing that by the software which has been designed to prevent it.  I mean, it�s literally, it�s just not possible.



The only way we�re going to get this problem resolved is eventually when we have a hypervisor running at a level above the kernel, or below, depending upon how you want to look at it, you know, more protected than the kernel, which is then able to enforce protection on the kernel.  This is very much the way the kernel is able to enforce protection on user applications.  And so it�s sort of a hierarchy.  And�at the moment, the current Windows technology doesn�t have anything running at a level that is more protected than�the kernel.  That�s what we need.  And only then will we actually have anything that can be verifiably and usefully bulletproof.



And this is exactly why, as we said last week, kernel patch protection, while a good thing, doesn�t actually provide rootkit protection because rootkits already exist that are able to defeat it.  The idea is, this prevents, as we said, good guys from modifying the kernel, which will finally allow Microsoft the flexibility of locking down the kernel at some point in the future.  They just haven�t gotten there�yet.



LEO:  From Sweden, Simon Lingh is worried about the future of third-party firewalls and A/V.  He writes:  It seems like Microsoft wanted to prevent all third-party kernel modification; which means, as I understand it, there won�t be any, for example, personal firewalls in the future.  Or did I miss something?



STEVE:  Great question.  It�s certainly the case, as we were just saying, that Microsoft is determined on the 64-bit platforms to draw a line in the sand and say, no more kernel modification.  What they have done to compensate � and I believe this fully, that they really don�t intend to prevent Symantec and McAfee and the other personal firewall and A/V vendors from being able to develop products.  They just need to develop products that don�t modify the kernel.  To make that more possible � and first of all, it has been possible, so they say.  I mean, there�s a lot of dispute about that.  I�m on the side of believing that it has not been possible to do the sorts of things McAfee, Symantec, ZoneAlarm and so forth are doing without reaching down and modifying the kernel because Microsoft has non-published APIs and just hasn�t provided the hooks to allow that.  Microsoft was � the operating system was hostile to things mucking around in the kernel.  So there�s a huge amount of reverse engineering that was needed to be done in order to make this possible.



What Microsoft has done with the next generation of Windows, that is, in Vista, they have published APIs that will allow third-party vendors to do what they want to do without needing to modify the kernel.  There are some advanced API technologies, for example, one that allows software drivers in the kernel to filter and monitor all of the network traffic coming and going through the machine without needing to modify the network stack.  That�s never been possible before.  It is now possible in Vista because Microsoft has added that functionality.  So there are now ways in Vista for third parties to successfully do what they want to do without needing the kernel to be modified.



LEO:  And I guess it also comes down to the question of should you let Microsoft and only Microsoft control what goes on at the kernel level.  I mean, I think about Linux, for instance, where the kernel is open source.  It�s published.  There�s no kernel protection.  You can do anything you want.  I mean, you can�t modify a running systems kernel necessarily, but you could write your own kernel with all sorts of hacks in it.



STEVE:  Sure.



LEO:  Which is more secure?  The closed, only Microsoft has access in here, clean room environment; or the open, everybody understands what�s going on environment?  Right now it�s the open environment.



STEVE:  Certainly we need to remember that rootkits were invented on UNIX.



LEO:  That�s true.



STEVE:  That�s where they came from.



LEO:  Good point.  It�s actually fairly easy to put a rootkit on a Linux system, come to think of it.



STEVE:  Well, exactly.  And the documentation, the open source-ness of it makes it that much easier.  So at the same time we have the issue of doesn�t having the open source mean that lots of people can look at the code and scrutinize it and work on ways to tighten it up more than Microsoft has with their closed source approach?



LEO:  The difference is we�re not at the application level, or even the kind of the OS user interface level.  We�re at the kernel level.



STEVE:  Right.  And there are two different issues that we�re sort of commingling here.  There�s the issue of open source/closed source and hypervisor kernel protection versus the PatchGuard approach, which is just trying to detect modifications to the kernel, as opposed to absolutely preventing modifications to the kernel.  So it gets complex.  I believe that when Microsoft for their 64-bit systems has added a hypervisor, we�re going to see a new era of security because applications will not be able to muck with the kernel at all.



Now, it is the case, though, that mischief could be performed by using the new APIs, that is, if now you don�t need to modify the kernel, yet you can hook the stack, and anybody who wants to can hook the stack, then nothing prevents malware from creating a driver which they arrange to sign somehow.  And driver signing is another thing that�s been enforced in the 64-bit kernel.  So malware gets a signed driver that hooks the stack.  Now it can talk out through the network and potentially bypass the firewall.



LEO:  I guess it�s what you�ve been saying all along, and I guess I�ve learned this lesson, is there is no such thing as�perfect security.  It�s a process.  And there�s always�something.



STEVE:  Yes.  And doing the best job we can of keeping this stuff out of our machines in the first place is absolutely what you want to shoot for.  You don�t want to let stuff get into your system.  Once it has, you just can�t trust it.



LEO:  A subject we don�t talk a lot about, spam, is on Paul�s mind.  He�s fed up with spam.  He writes from the U.K.:  Spam, spam, spam, spam, spam.  Security Now! is preaching to the converted on firewalls, bots, spyware, et cetera.  I doubt any of Security Now�s listeners� PCs are sources of spam.  I hope not.  The fact is that there are millions of PCs out there that are vulnerable to being sources of spam, and there always will be because they don�t listen to Security Now!.  Leo said recently that his email filters catch a million spam emails a month.  True.  As effective as spam filtering might be, the long-term solution to this problem has got to be applied at source, otherwise the pipes will stay clogged.  The solution has got to involve security.  Hmm, I�m not sure I�d agree with him on this.  I would like to hear your views on how it could be done.  Should SMTP, the mail transport protocol, be replaced over time?  Should we adopt the proprietary email authentication as proposed by Microsoft?  There are others, by the way, that are not proprietary.  Should LSPs limit users to 1,000 messages a month?  Should all email be certificated?  Or has the horse already bolted through the open stable door?  He asks a lot of questions.



STEVE:  Well, yeah.  And I liked it because he sort of painted a picture of the way things are today.



LEO:  Bill Gates thought, and he announced, that spam would be conquered.  He announced this two years ago, and it�s long past the deadline.  But he thought authentication was a solution.



STEVE:  Well, and I actually am a fan of that.  In that famous TWiT that I participated in a long time ago which generated Dvorak�s �I get no spam� comment, where he was complaining that my email gateway was rejecting his email because it used HTML.  And what I had found was that by blocking HTML email, 99 percent of the spam GRC was receiving was blocked.  And I was bouncing a message back saying, I�m sorry, we don�t accept HTML email, please send text-only email, we�d love to hear from you.  And Dvorak style, it made for some great comedy on TWiT.



LEO:  I�m wondering if that still works, by the way, your HTML filter.  Because a lot of my spam now is just embedded GIFs.  It�s not HTML, it�s just a picture.



STEVE:  Yeah.  Well, what I did, as you know, Leo, is I finally gave up my original email address.  I was just steve@grc.com for, well, forever, for 20 years.  And as happens, and you know this because your email address is well known publicly, and what I have seen, because I�ve looked at remote servers connecting to my server, I�ve watched the traffic, I see them just guessing names, people who never had accounts at GRC ever.



LEO:  Oh, yeah, most of my spam is that.



STEVE:  Doing dictionary attacks, just going through a list of first names and second names, everything that they can come up with, trying to get something, to find a legitimate account.  What I did was I changed my email address, finally after all that time, basically after giving up, to something not in any dictionary that is no longer guessable.  And bang, problem solved.  So I then removed the HTML filter.  Now people can send anything that they want to to us, as long as they have our addresses.  And this was important also for sales and support because I wanted people...



LEO:  You don�t want to block customers� emails.



STEVE:  Exactly.



LEO:  Now, I have to say there is an issue because they have to know what your new address is.  You change it regularly.  I don�t want to say too much because I don�t want to give away your algorithm.



STEVE:  Right.  And we do have the addresses for sales and support are on our web page.  And the current address is in every receipt that they receive after they purchase SpinRite, blah blah blah.  So we basically closed the loop so that nobody is inconvenienced and dodged all of this flood of spam.



LEO:  But nobody can guess your email address.



STEVE:  Correct.  And so the idea is...



LEO:  And I can�t do this because � I can�t do it.



STEVE:  You�re too dependent upon that.  And it is painful to change one�s email address after you�ve had it for a long time.  I really understand that.



LEO:  Everything we�ve talked about so far really is filtering.  Even that is a form of filtering.



STEVE:  Correct.  So the first thing I would tell people is, if you finally give up � and I talk to people more and more who have given up trying to fight this.  They�re like me, who were really annoyed that this was happening, and just filtering it.  And basically, Leo, that�s exactly what you�re doing is using antispam filters to stem the flood and try to find the good email from the bad.  And in fact you and I had a problem communicating because yours was false positiving on email from me, so you had to explicitly allow�me.



LEO:  You were getting through the primary server-side filtering.  It was the secondary, actually it was the secondary filtering that was catching you, Spam Assassin.  I use three-step filtering.  But he makes a good point, which is that doesn�t solve the root cause.



STEVE:  Correct.  So the one thing I wanted to say was that if anyone finally does give up and change email addresses, do something that is not going to be in a dictionary.  Because if you just use your same, like your first name or whatever you use that might be in a dictionary, could be guessed, you�ll find yourself immediately getting more spam.



LEO:  If you�re joe@earthlink.net, you�re screwed.



STEVE:  Basically, yes.



LEO:  Give up.  That is not � joe537499 would be fine.



STEVE:  Right.  It�s very cool, Joe, that you got that name at EarthLink.  But unfortunately it�s pretty much useless to you now.



LEO:  In fact, I think I got some email from � it was joe@aol.com, saying, yeah, this is my email address, but I can�t use it.  So please don�t try to send me mail at this address.  The reason I got it was because a spam message was bounced back to him from, I guess, my address.



STEVE:  Well, now, I wanted to address the second part of this, and that is this issue of authentication.  The technology, which I really like, and I�m using it, and it�s becoming more and more pervasive, is this notion of authenticating the source of email.  It�s this SPF technology, which is Microsoft tried to sort of adopt it and then, what was that old expression, �extend and enhance� or something, which basically means...



LEO:  Embrace and extend was the original idea, but then extend and devour is what we ended up calling it.



STEVE:  Exactly.  And they were unable to because it turns out that this was bigger than they were.



LEO:  Unembraceable and unextendable.



STEVE:  Well, they wanted to patent it and license it, and people said no, we�re not going to adopt some Microsoft thing that is not in the open domain.  The good news is that this Sender Policy Framework, SPF, is a really cool and simple addition to an existing system because all it requires is that some special DNS records be added to the DNS server of anyone who wants to generate email.



So, for example, GRC has a text record which has been added to our DNS server that says the addresses of the servers, either by domain name or IP address or IP range, that are valid originators of GRC mail.  So any incoming mail to a third party, like say EarthLink, that is using SPF, Yahoo! is, Gmail is.  So some email comes in, apparently from me at GRC.com, for example, to EarthLink server.  It performs a DNS query asking for the text records of GRC.com.  Our DNS, over which we have absolute control, our DNS sends back these text records, among which is one that says GRC email will only be originated from these IP addresses.  And what happens is EarthLink knows the IP address from � it has a connection to.  And as we know, IP addresses of valid TCP connections cannot be spoofed because you have to have traffic succeed in that three-way handshake in order to get a TCP connection.  And SMTP, which is the transport for email, uses TCP as its transport.  So EarthLink absolutely knows the IP address of the server that�s trying to send it mail ostensibly from GRC.  It does a DNS query to see whether that IP address we are saying, that is, GRC is saying this is a valid source of GRC email.  That allows it to authenticate my GRC server as being the only source of GRC mail.  And if it works, it allows it.  If not, it drops�it.



And it really is a great solution.  It prevents these spambots running in botnets from originating email from other sources.  Now, unfortunately this hasn�t been adopted widely yet.  But it is picking up and spreading because it is a simple thing to do.



LEO:  You said that Hotmail does it, EarthLink.  Does AOL do it?  I don�t think they do.  As I remember, yeah, they had their own form.  That�s the problem.



STEVE:  There is a domain keys technology, which is another approach.  In fact, I think that�s the one that Yahoo! adopted was domain keys.  And I don�t know for sure whether Yahoo! is also doing SPF.  There�s nothing to prevent servers from doing both.  And it just checks to see which ones you�re using.  I think Gmail is doing both.  Because I know that I�ve looked at my headers, and I�ve seen that GRC server has been authenticated by Gmail.  So anyway, there are things moving forward that just take time to adopt which ultimately are going to help, although it�s not clear that anything is a complete solution.  And boy, doing something like dropping SMTP and switching to a different protocol, we�re talking about obsoleting the entire email structure of the Internet in order to do that.



LEO:  I have to think basically spam is like cockroaches.  We�ve tried to fight them for a long time, roughly 40,000 years, with no success.  And I think it�s going to take us that long, if not longer.



STEVE:  Yeah.  I�ve got to say, changing your address and protecting it...



LEO:  It works for a year, though; right?  You change it regularly.  Because it doesn�t work forever.



STEVE:  I do change it regularly.



LEO:  Because after a while you start getting spam.



STEVE:  Yup.  But I just talked to Mark Thompson, my buddy at AnalogX this morning, who said that he�s starting to get some on his current address, and he�s looking forward to making a change next month, essentially, and switching over to a new address next year.



LEO:  He does it about every year.



STEVE:  He does the same thing I do.



LEO:  Yeah.  So that�s interesting.  Have you started seeing spam?  Because we�re getting towards the end of the year.



STEVE:  No, I haven�t.  Although I�m very careful, as you know, because I�ve said, Leo, you know, please be careful...



LEO:  Oh, I don�t give out your address to anybody.



STEVE:  ...about letting this thing escape.



LEO:  Yeah.  No, I don�t give your address to anybody.  I always ask permission.  I have to say that, to be honest with you, I think there are larger problems with email.  Even with all the filtering I do, I still get too many emails to respond to.  It�s rapidly getting to the level where I get too many emails to read without spending hours a day on email.  It�s just too easy to send an email.  When you�re a public figure, you get too much.  And I�m not � Amber and I were talking about this.  We�re public enough to get a lot of mail, but not successful enough to hire somebody to do it.  So we�re stuck.  We�re in that middle thing.  I�m sure President Bush has plenty of people answering his email.



STEVE:  Well, and speaking of that, I love the fact that these questions that we�re discussing are from Security Now! listeners.  And they go to the Security Now! page.  Down at the bottom of the page that allows them to submit questions.



LEO:  But it doesn�t come in your email.



STEVE:  It doesn�t come in my email.  Well, no, actually it is a form submitted.  It is emailed to me.  But the problem is the same as you, Leo.  I mean, I love that I get these.  But I get so many of them that, for example, if I were to read them, let alone answer them, I could not be developing this new freeware that I�m excited about that I�ll be announcing next week.  So like you I�ve had to make that tradeoff.  So I really appreciate people writing.  I just have to apologize if we�re not able � if I�m not able to respond, and we�re not even able to answer your question because there�s just so much.



LEO:  And I say the same thing.  And it�s sad because I get a lot � I love my email.  I get a lot of great stuff.  And I do so far still read it all.  But I just can�t respond to it all.  And I think the time will rapidly come where I can�t even read it all.  It�s so easy to send email.  Anybody can do it.  And it�s just a push of a button.  And if you get a thousand emails a day, you�re just not going to read it all.  And so I think ultimately the problem may not be spam.  The problem may be email.  It�s a larger problem here.  But let�s not get philosophical.



STEVE:  Well, basically we�re talking about developing larger communities of communicating users.  And I�ve got to say that the newsgroup solution that GRC has is fantastic because we have a Security Now! newsgroup at GRC, a forum there.  And even that I can�t keep up with.  But I dip in from time to time and see what�s going on.  And here we�ve got our Security Now! listeners talking to each other, answering each other�s questions and discussing things.  And�it�s fantastic to be able to create that kind of an online community.



LEO:  Absolutely.  Greg Rudd in Seattle gets it.  He writes:  If a computer becomes infected with malware, is running an antispyware program installed on the infected machine a reliable method to delete the malware?  How can any program running on an infected machine be trusted?  That�s kind of the bottom line, isn�t it.



STEVE:  And that�s why I said that he �gets it.�  It is the�golden rule that, if your machine is ever compromised, you can never trust it again because we don�t know what has�happened.



LEO:  Increasingly I�ve been telling people that on Call For Help.  In the past we would talk about how to disinfect, how to get rid of viruses.  But these things have gotten so nasty, so adept at burrowing into your system, that...



STEVE:  Oh, and tenacious.  You just can�t take them out.  You can�t delete the files because then other things break because they�ve inserted themselves as a filter in between some other things.  And you take that chunk out in the middle, and you break the communication flow.



LEO:  You�re killing the patient.



STEVE:  So, yes, if all you can do is run a malware remover, then that�s what you have to do.  The better solution is to think about the structure of your machine.  The best thing you can do is to set up a C partition which is big enough for the OS and your applications.  And that only needs to be maybe, you know, maybe 15 gigs, depending upon what you�re doing.  Then have a D partition or, you know, D, E, F, G.  It�s funny, I run across people sometimes from the old DOS days who�ve got the whole alphabet covered.  �On my Q drive I�ve got this.�



LEO:  Removable drives I always make be W, X, Y, Z, like CDROMs and so forth, because then if I install something it won�t screw up anything I�ve installed on the CD-ROM.  It�s going to stay at the end of the alphabet.



STEVE:  Well, the advantage to me of keeping my system partitions small is that it can be imaged relatively practically.  That is, I�m able to do an image onto a couple DVDs or onto an external spinning Firewire or USB drive.  And so my point is that, if malware infects you, it�s infecting not your entire drive, but it�s infecting your system partition.  It�s not like you�re going to have...



LEO:  It wouldn�t spread to a data partition?  Sometimes they do, viruses will install themselves into...



STEVE:  Well, and we�ve seen instances, for example, where JPGs are carrying malware.  But you have to ask yourself, what are people doing with 250GB drives doing with the drive?  That can�t be 250GB of programs.  Certainly most of it is music and movies and media files that are massive.  So my point is that, if you were to deliberately keep your system partitions small, only as big as it needs to be, I mean, I�ve got a 17GB partition on my main workstation that is still only half full.  And this is everything I use is in half of a 17GB partition.  I don�t even know where I came up with 17, but it made sense once.



LEO:  Magic number.



STEVE:  And so my point is that I can make images.  It�s practical to make an image of my C drive because I kept it small.  It�s not practical to make an image of a 250GB C�drive.  Okay, you could do it by using an external drive, but it�s going to take a long time, and you�re imaging all your media, which is much more transient and probably doesn�t need to be � well, basically it doesn�t need to be saved in the event of a malware incursion.



LEO:  Do you still use Drive Snapshot to do your images? 



STEVE:  Yup.



LEO:  I�m going to get that.



STEVE:  I love Drive Snapshot.  It runs in Windows.  You don�t need to leave Windows.  You�re able just to run it, for example, against the C drive.  It makes a snapshot.  And what�s cool is they�re mountable snapshots.  So you�re able to mount that as a drive letter if you want to poke around and get something...



LEO:  Just get a file or something.



STEVE:  Exactly, from a prior snapshot.  And so my point is that, if you then got infected, if your data is separate from your operating system, you can restore your operating system from a recent snapshot and not lose the data that you�ve been working on since.  So increasingly I think it really makes sense not to have everything as just one big blob in a C drive.



LEO:  I think as I�m getting ready to create this Vista machine it�s an opportunity to kind of sit down and think about these strategies.  And I think that that�s exactly what I�m going to do.  I�m going to put it on the network, back up the partition � create a good Windows 64, Vista 64 partition, back it up as an image.  And that way, if I should get spyware � I don�t anticipate it, but if I get spyware or a virus infection, I could quickly restore to the way it was.  Backing up is now becoming the best strategy of all.  There is no interim, in-between thing to do.



STEVE:  It really is true.  As I said, if all you can do is run antimalware, that�s all you can do.  But if you�ve got an image, it�s much better to restore an image.  And you just know, you have the peace of mind that you�ve stepped back in time to a point when your system was clean.



LEO:  Best time to do it, when you get a new system.  And then I guess, you know, this is what we always did on the TV show, we�d create a couple of images.  First an image of just the installed OS.  Then an image of the installed OS and applications.  And then what is key is that you know that that�s good because you haven�t even gone online yet.  And when you want to build a new image, perhaps with new applications or new drivers or, more likely, all the Windows updates, you actually go back to the known good image, restore that, add the applications at that time...



STEVE:  And then move forward again.



LEO:  And then move forward from that point so that you�re always moving from a known good spot.  Otherwise...



STEVE:  That�s exactly my approach, too, Leo.



LEO:  Otherwise you could be restoring a compromised system.  That�s the point nowadays, you can�t tell.



STEVE:  Well, and it�s funny, too, because here we�ve only been talking about malware.  But as we know, something about Windows just kind of goes a little wonky over time.



LEO:  Yeah, it�s a good thing to do anyway.  I reinstall all the time.



STEVE:  Exactly.  So backing up to a known good point and then installing a few more apps and then moving forward, or installing a few more apps and then making an updated snapshot, it does allow you to sort of reset your Windows system to like an almost new condition.



LEO:  This is where a gigabit Ethernet and a big terabyte mass backup system is really helpful because anything that I put on my network I could snapshot out to that terabyte storage.  And I have a number of good images.  But they�re not even on the system.  But as long as I can get on the network, I can do it.



Eric in San Jose is in the market for a powerful new machine:  I�m interested to know your opinion and maybe have some explanation on computer hardware.  Oh, good, this is fun.  I was looking for the most advanced systems on Dell and found only the servers have the option for dual quad core processors.  I think he�s looking at Xeons.  It seems to me any enthusiast would want that.  Is it better to buy a server to get the latest in performance?  They definitely cost more.  Is the difference between computers designed for home versus business versus servers in terms of performance and quality?  I know the business-level tech support is better, but do these systems offer higher levels of performance and quality control as well?  I can answer one thing.  A lot of this comes down to Intel and the fact that they won�t let you sell a Xeon-based computer as a computer, as a desktop.  It�s sold as a workstation or a server.  That�s just a branding thing.  They tell Dell you can�t call it a desktop computer.



STEVE:  Interesting.



LEO:  So they�re always at least a workstation.



STEVE:  Yeah, I�ve been looking at that, too, as a matter of fact, because as I think I mentioned, I�m still running Windows 2000 on an aging hardware platform.



LEO:  Time for a Dell, dude.



STEVE:  I�ve got a pair of 866 MHz Pentium 2 or 3, I think Pentium 3.



LEO:  Oh, dear.  What are you using that for?



STEVE:  Well, the problem is it�s so hard to move.  I mean, I�ve got this fantastic mature environment.



LEO:  Mature?  Belongs in an old-age home.



STEVE:  Actually it does.  And as a matter of fact it�s a mixed blessing.  I look at all the crud that I�ve installed�on this thing over the years, and it�s amazing it still runs.



LEO:  I think it�s time for a new system, Steve.



STEVE:  And so my point is that obviously I don�t change hardware often because, I mean, this is proof of it because here I am running on an old dual P3 866.  And so my point is, since I don�t change hardware...



LEO:  I have one of those for a doorstop, actually.



STEVE:  Right.  So my point is, since I don�t update my hardware often, when I do go through the pain of switching to a new platform, I want to reach far ahead, beyond what I need now, knowing that I�ll probably be stuck with it for the next five or ten years.



LEO:  That�s kind of what I did when I bought the Mac Pro.  What we�re working on right now is a quad processor.  It�s dual Xeons.



STEVE:  Dual dual core.



LEO:  Dual dual cores.



STEVE:  Right.



LEO:  And I�ll tell you, I feel like I�m reaching into the future.  I can�t get this thing more than 10 or 20 percent�usage.



STEVE:  Well, that is where I�m going to go.  I�m going to go to a dual dual core.  I think dual quad core may be a little overkill.



LEO:  I think that�s one reason, to answer this guy specifically, that�s an awful lot.  That�s what I have, but that�s just because I�m silly.  I think dual core is plenty.



STEVE:  What I have found, doing some research, and I was just looking at all the Intel motherboards available, is that you want to look at what kind of audio, what kind of video, how many of what type of PCI slots you�ve got, and then what the maximum amount of memory is and what type of processors and how many you�re able to put on the motherboard.  So those are sort of the things that, completely aside from branding and what you�re going to call it, whether it�s called a workstation or a server, blah blah blah, Intel does make high-end workstation motherboards that are dual processor, dual core, so you can go to the high end of the workstation or the low end of the server and sort of get basically what you want.



I like to run a lot of displays.  I�ve got three in front of me.  I will definitely go to a system that allows me to run three displays because I�m hooked on the idea of being able to have that much screen real estate.  I can�t imagine going back to a single display now for my main system.  So I need to be able to have enough PCI slots to put graphics cards in, in order to run LCD panels.  So that�s a consideration for me.  I don�t care about audio for my workstation.  It�s not a media machine.  And having integrated RAID is, I think, now that RAID is on motherboards to a greater and greater degree, just having it built onto the motherboard so you can run three drives in RAID 5 and just know that, no matter what happens, you�re going to be okay, for any next-generation system I think at least running a mirror and maybe even a RAID 5 makes a lot of sense, too.



LEO:  On the computer or as an external system?



STEVE:  Lots of motherboards build it in.  I know that Intel�has...



LEO:  Let me ask you about this, though, because this actually is an important question to me.  My impression of most of the motherboard RAID controllers is that they were software.  They�re BIOS-based RAID controllers, not hardware RAID controllers.



STEVE:  Yes, that�s the case.



LEO:  But RAID 5 would require hardware.  Is that correct?



STEVE:  I know that Intel�s motherboard says they support RAID 5.



LEO:  See, I have some questions about how good the RAID 5 implementation would be.



STEVE:  Well, you�re right.  Although I have seen, when you boot FreeBSD, for example, or maybe it�s Linux, I think it�s Linux in fact, where it runs through a bunch of tests to determine what the optimal RAID strategy would be using different approaches for generating RAID checksums and RAID images.  And the performance is really getting pretty far up there.  And you need something for one of those extra cores to be doing.



LEO:  True, you have enough processor now that you could � software RAID isn�t such a bad thing.  So RAID 0 is striping, which speeds up the writes and reads.  Although, again, in our tests on BIOS-based software motherboard RAIDs, we haven�t seen much improvement.  There�s RAID 1, which is mirroring, and that�s for redundancy.  I have some issues with that, frankly, too, because in my experience you shouldn�t count on that as a backup by any means.  And then RAID 5, which is using three drives; right?  Don�t you have to have three drives for RAID 5?



STEVE:  A minimum of three, yes.  You�re able to use more.



LEO:  So you�re doing both striping and mirroring.  Or is it only mirroring?



STEVE:  It�s actually neither.  It�s a very sophisticated approach where basically...



LEO:  It�s a redundancy approach, though.



STEVE:  It�s a redundancy approach, but it�s much better.  Striping is zero redundancy.  Mirroring is 100 percent redundancy.  RAID 5 you get an extra drive of sort of checksum information.  And so if any one of the three dies, the system is able to rebuilt the dead drive from the data in the other two.



LEO:  You just swap a new drive in.  And that�s how my NAS storage works.  It�s three drives, RAID 5.



STEVE:  Now, in my case, for a personal workstation, I�m not at all concerned about drive performance because drive performance is already so far beyond what a workstation needs that it�s just not a concern for me.



LEO:  I�m not sure I�d agree with you, though, Steve.  I think especially, well for instance on this quad core, I think you�re I/O bound.  You have so much processor performance that you are I/O bound now.



STEVE:  My point, though, is that for workstation, that is, for me sitting here doing email...



LEO:  You could go back to that P3, and you�d be fine.



STEVE:  That�s why I�m so happy right now with my P3.



LEO:  But not everybody � but if you�re doing anything demanding, editing video or ripping CDs or anything like that, hard drive performance does become important.  I put a Raptor in almost everything I do, a 10,000 RPM drive.



STEVE:  Then I certainly agree.  And I agree, then, that not�only do you want to get off the motherboard so that you�re not doing software-based RAID, but you probably want�some caching on a separate RAID adapter so that the OS�is able to dump data onto the RAID and move on, and then�the RAID uses its on-card cache and writes stuff out to�the RAID�asynchronously.  You really want that additional�overlapping.



LEO:  I believe I have that in my in-front terabyte NAS.



STEVE:  So did we answer Eric�s question?



LEO:  I don�t remember what his question was.  Let me go back and look.  I have it written down here.  He�s just basically asking all about hardware.  He wanted to know quad, dual quad core, which I think we�re both saying is not necessary for most applications.  You�d get more benefit from, say, a faster video card or a faster hard drive than you would from having four cores.



STEVE:  I can�t imagine anything other than a compute-bound,�high-end server, or somebody who�s doing tons of media compression.



LEO:  Or 3D rendering or something like that.



STEVE:  Yeah, exactly, 3D rendering or media compression.  I mean, I pin my processors, when I�m compressing media, and the hard drive just kind of flickers, flickers, flickers, flickers because all of the time is spent by the processor doing MPEG-2, MPEG-4 compression.



LEO:  So you should come over here and use my Mac Pro because this thing is fast.



STEVE:  Or get one of my own.



LEO:  Yeah, this thing is fast.  On that kind of stuff it�s as fast as I�ve ever seen.



STEVE:  That�s very cool because it�s a pain.  My solution is having multiple machines just running in the background.  It�s funny, too, because I keep wanting to write � you know I have my little Window gizmo called Wizmo that is, like, all kinds of little features that I�ve added.  I want to add to it the ability to monitor a system for how busy it is and to start ringing a bell, playing a media file as soon as its level of busyness changes.  Because I�ll start a compression on a computer and forget that it�s running, and come back hours later when it�s been done for a long time and wish that I had something that notified me when it was through.



LEO:  I guess to answer his question most specifically, he�s asking should I get a server or a computer.  There are really three choices.  There�s computer, workstation, or server.  Servers are really tuned for being servers.  You don�t need a server.  If you want quad core, you can get a�workstation.  But I think Steve and I agree, even though I�bought one, I don�t think most people need a quad core�workstation.



STEVE:  I completely agree.  And Leo, talk about expense going exponential.



LEO:  Yeah, it goes up pretty quick.



STEVE:  Oh, those things are just so expensive.



LEO:  But, see, I was buying for the future.  I shouldn�t have to buy another computer for quite some time now.



STEVE:  That�s the plan.



LEO:  Which will be sad because that�s part of the joy of life.  So that�s why I got this laptop; right?  Matt Carroll of Milwaukee, Wisconsin wants a bit of clarification:  In Episode 65 you discussed configuring your regular mail client, Outlook for instance, to access Gmail via POP and SMTP with an SSL connection.  Does that mean, if my PC is connected to an unencrypted open WiFi connection, and I send or receive email using an email client configured to use SSL, that messages cannot be intercepted by someone sniffing the connection?  In other words, is it safe to transmit email using Outlook or a similar client via an open WiFi connection if I�m using SSL?



STEVE:  Yes.



LEO:  It is.  I thought you were going to say no.



STEVE:  Absolutely.



LEO:  Because sometimes it opens up the connection in SSL, but then reverts back to unencrypted; doesn�t it?



STEVE:  Not POP and SMTP.  It�s exactly like using a secure website where the SSL connection is established first.  It cannot be sniffed.  It cannot be spoofed.  And you then have�an encrypted tunnel through which all of your email traffic goes.



LEO:  We should point out that on web-based servers, however, this is not the case necessarily.



STEVE:  You need to be careful.  With Gmail, as long as you go to it with https://mail.google.com, as long as your initial contact with the server is secure, after you log in you stay secure.  Whereas if you go http://, that is, you first go to it nonsecure, then only your log-in is secure, and Gmail reverts to insecure afterwards.



LEO:  Yeah, and I think people get fooled by that.



STEVE:  But in his case, yes, if you�re using SSL with POP and SMTP, you can absolutely not be sniffed.  Now, if you�re using open WiFi unencrypted blah blah blah, of course there are other concerns that you would need to be aware of.  But certainly at least your email would be safe.



LEO:  Yes.  Yes.  In fact, that�s what I do.  I still use VPN, but I do do that at least; so if I forget to turn on the VPN or whatever, my email is safe.  I mean, the first thing you want to protect is your email password.  But then it�s nice to protect your email, too.



Eric Sarratt of Asheville, North Carolina, catching up on back podcasts.  He had a question about drive capacity:  I know Steve mentions getting the smallest drives he can find.  Is there an ideal size?  I mean, you can get 500GB drives now.  Is it better to get a 160 or a 100GB drive?  He said:  I can actually get drives down to 1 or 2GB.  Obviously that�s too small.  By the way, I usually get the old PATA drives as anything faster is usually a waste of money for my computing needs.  But if you recommend SCSI � ugh � or SATA, I would be open to this, given a reason.  Is PATA IDE?



STEVE:  Yes, PATA is the original IDE style.  I thought this was an interesting question.



LEO:  Parallel ATA, I get it, okay.



STEVE:  Exactly, parallel versus serial.  I thought it was an interesting question because I did talk about deliberately asking my computer supplier guy, when I�m buying drives just for random use here, what�s the smallest drive I can still get.  These are applications, though, for example GRC�s server, I think I�m running a pair of 40GB drives in a mirror on one of my servers.  This is not the main GRC server.  There I�ve got a SCSI RAID 5.  But there are many applications where I just don�t need � I just know I�m not going to have lots of media files, and I don�t need that much space.  So given that I don�t need that much space in that application, I�ll get the smallest drive I can, just because I like them better.  I trust them more.  But most end-users, I think, are now obviously going for the 160s and the 200s and so forth.  You�ll get a kick out of this, Leo.  I just increased the 80GB drive in my MacBook Pro to 160.



LEO:  Why?



STEVE:  Because I�m doing more with it now.



LEO:  You�re putting music on it and stuff.



STEVE:  And media stuff.  And it turned out that 80 gigs was just � it was cramping me.  So there�s an example where Mr.�Get the Smallest Drive You Can has just gotten the biggest drive he could.



LEO:  So what�s the optimum?  That�s the biggest laptop drive.  What�s the optimum � there is no magic number, is there?



STEVE:  No.



LEO:  There�s no point beyond which � your problem is aerial density gets so high, so much data on a square inch, that you�re concerned about reliability.



STEVE:  Yes, in fact, the drive I bought, I bought a 160GB Seagate SATA, which is what goes in the MacBook Pro.  And it�s Seagate�s first vertical recording drive, which is storing the bits standing up instead of laying down, which is technology we�ve been hearing about for a decade now, and it�s finally beginning to make it out of the lab into production.  What I would say the other concerns, other than just cost and size, is power consumption and heat.  And this is really the other reason I wanted to put this question in here is that bigger, faster, larger drives do tend to generate more heat and burn more power.  Certainly the case with your 10K RPM drives, Leo.  I�m sure those guys are running a lot hotter.



LEO:  Oh, yeah.



STEVE:  So you want to make sure that your power supply has enough oomph to run all the drives and the super-speed processor and all that stuff.  This stuff all ends up consuming a lot of power.  A lot of that power is translated into heat.  So your system also needs to be able to get rid of the heat.  There have been some interesting cases where you�ll see computer furniture that�s got a really nice enclosure for your computer that�s not ventilated.  And it�s like, what are these people thinking?  You put any computer in there and close the door, and this thing�s just going to cook inside.



LEO:  Well, your Pentium 3 might run fine, but nowadays you�re right.  You know, it�s funny because this new laptop I got for Vista, the choice was a bigger, 5400 RPM drive, or a smaller 7200 RPM drive.  And even though I know there�s lower battery life, more heat, and now I�ll have less capacity, it�s only an 80GB drive, I still ordered the 7200.  Because this machine won�t be a main primary machine for me.  So speed is what I�m looking for on this.



STEVE:  I completely agree.



LEO:  And 80GB, that�s enough unless you start putting media files on there, which I�m not planning to.  It is Windows, after all.  Let�s see here.  Rodney writes from Trinidad in the West Indies.  Nice to have you listening in the West Indies, Rodney.  You�re probably having better weather than we are.  Regarding network firewalls, can you guys bypass a network firewall to use a downloading program?  He wants to use a peer-to-peer program like Soulseek, Limewire.  He says:  Is that possible, to bypass a network firewall DSL connection?  I�m thinking this guy�s got an ISP that�s blocking peer-to-peer networks.



STEVE:  Well, to me, saying �network firewall,� I was sort of thinking he was inside a corporation.



LEO:  Well, but I think, as I remember, in the Caribbean a lot of the ISPs act this way, as well.



STEVE:  Okay.  In that case, this is where some sort of VPN is your friend.  The only way to really bypass a network firewall is to create a true VPN tunnel, that is, a virtual private network.  And I would suggest that Rodney go back and listen to our VPN episodes where we cover this topic extensively, and basically use a supplier � this is not somewhere that Hamachi would work because Hamachi is sort of a peer-to-peer VPN that�s used to create a tunnel between machines.  What Rodney wants is a tunnel out to a VPN supplier, somebody who�s selling a VPN service.  So the peer-to-peer network would actually be connecting to that service and then tunneling the peer-to-peer traffic through the tunnel, through the corporate firewall or the ISP firewall, into his machine.  So I can�t even remember now the name of the VPN service that we liked and have used,�Leo.



LEO:  HotspotVPN.com.



STEVE:  Exactly, HotSpotVPN would be a perfect example of someone who could do that.  It would allow you to use a peer-to-peer network.  And he mentioned Soulseek and Limewire and so forth as a couple.  But basically all of your ports would then be available, even if your local network were filtering them and preventing that kind of�behavior.



LEO:  That�s about it, huh?  An ISP couldn�t block a VPN, could it?



STEVE:  Well, sure.  They could block � and this is typical of, for example, PPTP and L2TP and all those crazy acronyms when we were talking about VPNs.  The good news is that modern VPNs are using SSL technology in order to use nontraditional VPN ports, and then an ISP is not going to be able to block you.



LEO:  Okay, because it won�t know what to look for.



STEVE:  Right.



LEO:  Brian Voeller writes from Ashland, Oregon, USA, Earth�� did he write that?



STEVE:  Yeah, he did.



LEO:  We�re glad to know what planet you�re listening on,�Brian.



STEVE:  Put down as his location.



LEO:  And a big shout-out to all of our listeners in other parts of the galaxy.  You have mentioned several times how 64-bit Vista will not allow unsigned kernel drivers, thus breaking some devices that require them.  It�s not that they require them, they just haven�t written them yet.  I�m wondering how much of a problem this will be with old hardware.  I understand why antivirus software needs to be deep in the kernel; but what about things like printers, webcams, video, TV tuner cards that should have no need to modify the kernel in the first place?  I find it hard to believe that something as delicate as kernel modification has become so commonplace that it�s used instead of regular APIs.  Unless, of course, this is poetic justice for Microsoft for hoarding all the good APIs.  All the good APIs are taken.  Would it be possible for Vista to allow old unsigned 32-bit kernel drivers to run in some kind of protected or isolated mode, like DOS and Windows 98?



STEVE:  Well.



LEO:  Where do we begin?



STEVE:  The kernel is a different dog from applications.  So it�s certainly the case, for example, that DOS apps are able to be hosted in a so-called DOS box and not know that they�re not just running on old 16-bit DOS.  Similarly, 32bit apps we know will be compatible with 64-bit � well, they are compatible with 64-bit XP, and they will be compatible with 64-bit Vista.  The 64-bit OSes expose a completely compatible 32-bit API for those applications to use.  The problem is that kernel drivers are actually a part of the kernel.  There�s no way that you could run a 32-bit driver which has not been recompiled for 64 bits.  There�s no way you could run that driver in a 64-bit kernel.



LEO:  So they just have to write a new driver, that�s all.



STEVE:  Yes.  Now, you could imagine...



LEO:  There�s no protected mode?  Because isn�t that how we ran 16-bit drivers in 32-bit?



STEVE:  Right.  Well, in fact, the way to think of it is that the driver is underneath that protected mode level.  It�s participating with the operating system.  It�s not being served by the operating system.  Now, it happens that Windows I/O architecture in the kernel sort of has a client-server approach.  So I could imagine that somebody could write an emulation layer that would allow 32-bit well-behaved drivers to be hosted in a 64-bit environment.  For example, FreeBSD, the latest version of FreeBSD, runs Windows drivers.  So you could literally use Windows drivers on FreeBSD.  It�s done that by emulating the whole device driver interface to a Windows driver.  The problem is that a Windows driver that then also tried to make kernel modifications, well, you can imagine, there�s no Windows kernel on FreeBSD.  So that would just explode completely.  And similarly, if a 32-bit driver that was being hosted by this hypothetical 64-bit/32-bit driver compatibility thing, if it tried to make any modifications to the kernel, that would explode, too.  So you could imagine that a well-behaved 32-bit driver could theoretically be hosted by some special, really cool layer...



LEO:  An envelope thing.



STEVE:  An envelope that sort of encapsulated it and pretended to be 32-bit Windows when it really wasn�t.  Still, if that was an ill-behaved driver, there�s no way that would work.



LEO:  And we don�t want it.  We don�t want it.  The point of�having 64-bit, if you�re going to have 64-bit, is running�64-bit drivers.  Don�t be silly.  Don�t try to run 32bit�drivers.



STEVE:  It seems to me that this really does make a nice sort of a cut point where older hardware that has to have older drivers is just going to be stuck with 32 bits.  And it�s going to only be the currently supported drivers.  It�s not like converting these things from 32 bits to 64 is a huge problem.  You have a 64-bit C compiler.



LEO:  You just recompile?



STEVE:  You recompile.  You need to change some things.  But it�s not like, I mean, basically the whole I/O architecture has pretty much stayed the same in Vista.  So it�s not like you�re having to write the driver from scratch.  You just need to expand it to 64 bits and then run...



LEO:  And the compiler should do most of that; right?  Unless you�ve got some sort of dependency on register size.



STEVE:  The compiler does most of it, and then you run it�through various driver certification suites that Microsoft provides...



LEO:  That�s the problem, because that�s expensive.



STEVE:  ...to verify that it all works.



LEO:  And that�s why a lot of people won�t do this, because they don�t want to spend the money.  Until there seems to be a big market for this, they�re not going to do it.



STEVE:  We definitely have the chicken and egg.  The good news is that my Vista had all the drivers for my hardware out of the box.  And it may very well be that Microsoft, recognizing this chicken-and-egg problem, has got so many drivers built into Vista now, both 32 and 64-bit, that this is not going to be as big a problem as some of us fear.  We really won�t know until we start playing with it.



LEO:  And I think to really underscore, you shouldn�t be using 64-bit and trying to get 32-bit things to work on it.  If you�ve got 32-bit drivers that you need, then stay with 32-bit Windows.



STEVE:  It�s just time to say goodbye to those.



LEO:  Or get rid of them, that�s right.  But to try to make them work under 64-bit is misguided, to say the least.



STEVE:  I think so.



LEO:  Sheldon Smith in Minneapolis has been thinking about security.  He writes:  I�ve been listening to the Security Now! podcasts since the very first day.  Just finished 65 � he�s a couple behind.  Listening to the discussions of security makes me wonder why Windows has so many holes.  Back in the early �80s, before DOS, Digital Equipment Corp. created a 32-bit operating system called VMS.  It was designed to be secure from the start.  Since then it�s been evolved first to use DEC�s Alpha so that now HP�s OpenVMS runs on the Itanium, which is Alpha-based.  In 20-some years there have been no viruses � mostly because I don�t think there are very many people running it.



STEVE:  That�s where we�re headed here.



LEO:  And only a handful of worms or trojans.  The stack grows up instead of down, just as you often say would be a good idea.  Also there are no problems from buffer overflows.  And the hardware has always supported hardware address protection, so even if data were to overflow, the hardware has �stone walls� to prevent the data from overwriting regions of code or having an executable stack.  And customers have systems with uptime measured in years, and clusters with uptime measured in over a decade.  And new systems are still being installed.  Of course I like my Windows XP notebook, it�s great for writing documents and playing games.  This is a common kind of thing we hear from people who run BigIron.  Why doesn�t BigIron have the same problems computers have?



STEVE:  I wanted to mention this because it does touch on the Mac.  And the reason that the Mac doesn�t have as many problems as Windows is partially that it doesn�t represent the same size of target that Windows does.  And so certainly the reason that DEC�s VMS hasn�t had virus problems is as you said, Leo.  I mean, it�s just not being used to the same level, and it�s not being used by the same type of people.  Remember that virus writers are often, not always, but often younger programmers.  And they are writing viruses for the systems they have.



LEO:  They don�t have a PDP in the basement.



STEVE:  Right, exactly.  You cannot write a virus for an operating system you don�t have because inherently you need to know it intimately.  And so we�re already beginning to see more growth in Mac problems as the Macintosh becomes...



LEO:  I will dispute that.  I haven�t seen any growth in Mac�problems.



STEVE:  Really.



LEO:  What Mac problems are you talking about?



STEVE:  Well, I don�t know.  Seems to me...



LEO:  There�s press all the time about, quote, �Mac problems never in the wild.�



STEVE:  Okay.



LEO:  They�re all hypothetical.



STEVE:  Okay.  Well, that�s good.  Let�s hope it...



LEO:  And in fact, I agree with you that a lot of the reason why the Mac is protected is because what you just said.  But there�s also a fundamental difference in the way it�s written that provides more protection, I think.



STEVE:  We�ll see.



LEO:  We�ll see.  I think there�s incentive to attack the Mac right now, just to prove it could be done.  I think people are trying it all the time.



STEVE:  The fact that Windows has these problems is really not Microsoft�s fault.  I don�t mean, you know, I�m no apologist for Microsoft.  I�ve been on them since day one for policy things.  It is just so hard to catch all these sorts of problems.  And I really have to believe that, if the Mac were scrutinized to the same degree that Windows is, there would be problems there.  On the other hand, having said that, things like ActiveX, which is inherently a bad idea, I mean, the Mac doesn�t have those architectural mistakes.  There�s nothing you could call ActiveX other than architectural mistake.



LEO:  It has a real security model.



STEVE:  The idea that IE can invoke non-IE ActiveX controls rumbling around loose in the system and invoke overflows in those, I mean, that�s just insanity.  And so we�re telling people to set the kill bit to prevent IE from having access to this ActiveX...



LEO:  That�s crazy.



STEVE:  Those are structural faults in Microsoft that now I�m sure they wish they hadn�t done, just like they probably wish they had never allowed people to modify the 32-bit kernel.  We see that Microsoft will never break compatibility.  They�ll just wait long enough to find some point where they can start things fresh.  ActiveX was a clever componentized idea that they went too far with.  So,  yes, this is what�s making Windows very vulnerable today.  I have to believe, though, that there are unknown problems in the Mac which people may discover ultimately, although I doubt they will nearly be as significant as Windows.



LEO:  I think it�s very clear that there are application-level issues, especially with some of the older UNIX applications that are just kind of lying there on the Mac OS.  We know of those.  The thing that I think protects us a little bit on the Mac is just � unless you�re running as an admin.  But even then there�s a little protection.  Nobody really runs as root on OS X.  And it�s a lot harder for somebody from the outside to get into your system and modify it, even given these exploits and these holes.  Unless you�re running BIND on OS X.



STEVE:  Yes, well, and there�s another feature in Vista that we haven�t yet covered because it�s extensive, and that�s called User Account Control, UAC.



LEO:  Right.  They�re trying to duplicate what�s in the Mac.



STEVE:  Yes, they are.  And so, again, it�s so extensive we�re going to do an entire episode on UAC in Vista because it is extensive and it is, well, it�s wonderful, but it�s also a mixed blessing because you�re being hounded by this thing all the time, even if you�re running as an admin.



LEO:  They turned off � it did for a while.  You had to enter the password a bunch of times.  Now you just get a � and I don�t know if this was a good idea.  They made it simpler for the user.



STEVE:  Yeah, it keeps popping up �are you sure� dialogs.



LEO:  Yeah, but you can just click OK now.



STEVE:  Or, I should say, �is this you� dialogs.



LEO:  A little warning.  But you don�t have to enter a password anymore.  And I�ll be interested.  I think the most vulnerable novice users just click OK all the time.  And that�s the problem.



Jonathan Green, a listener from London, asks:  I�m running mostly Macs and a PC behind a Netgear wireless router at home.  The last question, by the way.  This might be the longest Security Now! ever.  I might have to divide this into two parts.  I�m running mostly Macs and a PC behind Netgear wireless router at home and have set it up to be what I believe as fairly secure.  However, when I take my laptop out on the road or connect it to a corporate router, how can I be sure that I�m secure?  What steps can I take within my laptop, rather than the router, to be more safe?  I noticed when doing a ShieldsUP test at home, everything is�stealthed.  When I try the same test connected wirelessly to a work router away from home, some ports are open.  Is it�possible to make any security provisions on the laptop�itself?



STEVE:  Well, what�s happening in this case is that Jonathan is confusing the local security of his laptop and the security of the router.  When he�s at home, as he says, behind his Netgear wireless router, and he uses Security Now, we are testing the public IP, which is that IP of his router.  And as we know, NAT is very good security as long as you have Universal Plug & Play disabled.  So he�s seeing stealth at home, not because his laptop is secure.  He could have no firewall, for example, running on his laptop, and he would still see stealth at home because we�re testing, and any hacker is attempting to penetrate, through the public IP, that is, the IP of the router, and it just blocks it�cold.



Now, if in his corporate environment he runs ShieldsUP and he sees open ports, again, if this is a router and not just some sort of a non-routing gateway, then, again, the router�s IP is what�s being tested.  So it means that the machine on the border in his corporate network has some ports open.  Now, it�s very likely that it has ports open, for example, it probably needs port 25 open in order for the corporate network to be able to receive incoming SMTP email.  They may have port 80 open if there�s a corporate web server running on the network.  So corporate routers, corporate NAT routers which are connecting the corporation to the �Net, they�re inherently going to be offering services to the public which your typical home user is not doing.  So a home user will be stealth; a corporate router will probably not be.  But in both cases his laptop behind that router is probably safe.



What you definitely want to do, though, again in both cases, is be running your local firewall on your laptop.  And this really goes for all users.  It�s nice to have the router protecting you.  But it�s still a good thing to run the firewall on your local machine.  I know that you and I do, Leo.  On my Macs I�ve got the Mac firewall turned on all the�time.



LEO:  And of course then there�s also the HotSpotVPN that we talked about, which would be another way to secure it.  That wouldn�t change how your ShieldsUP is responding, though.



STEVE:  Well, exactly.  ShieldsUP would then be testing the HotSpot server, and they�ve got a bunch of ports open.  I remember because I was doing that at one point.  I was interested in seeing what ports the VPN server had open.  And also running a VPN wouldn�t necessarily protect you from other access of your laptop by local people who are accessing your laptop�s IP.  The tunnel would only be allowing you to get a tunneled connection to the Internet.  So really, you know, the short answer to Jonathan�s question is, make sure you�ve got your software firewall up and running on your laptop.



LEO:  All right.  And with that we conclude this marathon episode, holy camoli, of Security Now!.  We thank our sponsor, Astaro Corporation, makers of the great Astaro Security Gateway, for their support.  I�m very pleased to say that they�re going to stick with us through 2007.  We just got word from them, and that�s great.  We�re happy to have them as a sponsor from very early on, not day one, but very early on of Security Now!.  And we�re glad that they�re continuing forward with us into the new year.



STEVE:  Well, you know, Leo, we�re doing a good job for them, and we know that they�re doing a good job for our listeners because we get email from people saying, hey, I tried Astaro because we know that they�re sponsoring Security Now!, and people really like it.



LEO:  Well, it�s nice because you can try it for free.  Now, if you�re a home user, of course, you can just download the software and put it on any old beater PC.  Maybe that Pentium 3 you�ve got lying around would make a great Astaro Security Gateway.  And then I think it�s 79 euros a year if you decide that you want to subscribe to all the additional updates � the antivirus and the antispam and all that stuff.  But the free software is very, very capable.  Now, if you�re a business, and you want superior protection from spam, from viruses, from hackers, complete VPN capabilities, you get intrusion protection, content filtering, and an industrial-strength firewall, I mean, this appliance is amazing, you can try it absolutely free by contacting Astaro at www.astaro.com, or call 877-4AS-TARO.  I know a number of people have tried this and then gone on to become customers because they�re so impressed.  You can get a free trial of the Astaro Security Gateway appliance right there in your business.  That�s 1-877-4AS-TARO.  And we thank them for their support and their ongoing support of Security Now!.  It�s really nice to have a sponsor that believes in the product so much.



Steve Gibson�s website is GRC.com.  That�s where you�ll find the 16KB versions of this podcast for the bandwidth impaired and full transcripts, too, if you�d like to read along.  This will be a long one, I�m sorry, Elaine.  Oh, she�s going to be typing today.  And it�s mostly my fault because I kept interrupting.  Let�s see, what else?  Oh, and that�s where you�ll find SpinRite, which is Steve�s great product for hard drive recovery and maintenance.  There is nothing better.  I�m just going to say that.  There is nothing better.  It�s the granddaddy of these applications and still the best.  Version 6 now?



STEVE:  Pays all my bills, yes, SpinRite 6.



LEO:  SpinRite 6, GRC...



STEVE:  Supports my coffee habit.



LEO:  Something�s got to.  He�s up to quenti venti lattes.  If you want to hear Steve talk about that a little bit with Amber and me, he was on net@nite, which is up on the TWiT Network, last Sunday.  It was really fun.  Really great to have you on.  Thanks for joining us.



STEVE:  It was fun with you and Amber again.



LEO:  Yeah, I miss Amber.  She�s doing great at CityTV,�though.





Copyright (c) 2006 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#69

DATE:		December 7, 2006

TITLE:		The Social Implications of Internet Anonymity

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-069.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  To create some background for next week's discussion about the significant technical challenges involved in creating true anonymity on the Internet, this week Steve and Leo discuss the consequences of use and abuse of the extreme power afforded by many different forms of Internet anonymity, privacy, and freedom of speech.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 69 for December 7, 2006:  Internet Anonymity, Part 1.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Dell.  For this week�s specials, visit TWiT.tv/dell.



Well, after that marathon edition last week of Security Now!, a whole, what was it, almost an hour and a half...



STEVE GIBSON:  Actually it was more than that, it was 97�minutes.



LEO:  I�m exhausted.  But, you know, I should say Steve Gibson is here, and he�s our security guru.  And people loved it.



STEVE:  They really did.  I got some positive feedback in our Security Now! newsgroup at GRC from people saying, I mean, I had one comment, someone said they thought it might have been the best Security Now! ever.  And they liked the fact that we took our time, we thoroughly covered the topics.  I think more by coincidence than anything else we had a really good selection of questions, you know, they were complimenting me on the questions.  But it�s like, well, I didn�t really do anything different this time than I�have before.  I just read through a bunch of questions and�found good ones.  But I guess we just hit the sweet spot�somehow.



LEO:  I like the Q&As because of the variety.  It�s not just one topic.  And often the questions � and I think this was the case last time � are ones that I myself go, hmm, I wonder.  And so it�s good.  That�s why I do call-in talk shows and call-in TV shows, because I think people ask the questions.  Sometimes we as experts don�t always ask the right questions.  We know too much, maybe.



STEVE:  And of course doing that really keeps you on your toes, too�, because as I listen to you on KFI I�m thinking, my God, this guy knows so much.  No, really.



LEO:  I fake it well.



STEVE:  The breadth of your knowledge is phenomenal.



LEO:  It is, it�s good training for that.  I�m probably leaving that KFI show at the end of the month because I�ve been working seven days a week for three years, and it�s finally taken its toll.  My hair is falling out.



STEVE:  Your family�s forgot � well, I think that...



LEO:  Family?  What family?



STEVE:  The birthday you may have recently had might be responsible for some of that hair loss, too, Leo.



LEO:  And it�s hard to choose any one of the many projects I have to let go.  But because the radio show consumes both Saturday and Sunday, it really eats my weekends.  I think that�s probably the one that�s going to go.  And that�s the thing, you know what, that�s the thing that will suffer is that forced training every week on 20 or 30 topics is great.  It keeps my mind going.  If I seem dumber next year, you�ll know why.



So this week we�re going to talk about something I think is very important:  Internet anonymity.



STEVE:  There�s been a lot of interest from people posting their own questions on the Security Now! page at GRC.  For example, people want to have a presentation about this network called TOR, which stands for The Onion Router, which is an anonymity-enhancing network.  And so I�ve begun to do a lot of research onto the specifics of that so we could talk about it.



But in getting involved in this, I realized that there�s a social issue, like a moral and ethical issue that sort of comes up when you talk about, well, when you talk about any powerful technology.  And the Internet and the anonymity that it provides is a powerful technology.  Famously, Einstein was very concerned about the uses to which his contribution to the development of the atom bomb would be put.  And I think, as I remember, later in life he became really sort of a peace nut, really worried that this armament he had created was so powerful and so potentially susceptible to misuse and abuse that he partially regretted his role in that.



LEO:  It�s always a mixed bag.  I think if you accept the notion that there are times when anonymity is important, if you�re a whistle-blower, if you are in a repressive regime and you need to fight against it, there are lots of reasons that anonymity would be important.  I�ve had this conversation with Phil Zimmerman, the guy who created PGP, and that�s what he says.  He says, unfortunately you don�t get to choose.  You either allow anonymity or not.  And there are pluses and minuses to both, I guess.



STEVE:  Well, for example, it�s certainly arguable that you cannot have free speech without anonymity.  Because people will simply be...



LEO:  Intimidated.



STEVE:  They will be less � yes, intimated, exactly, and less willing to speak freely if they know that there are consequences to what they could say.  I have to say, Leo, I have been self-conscious sending some political email, like post 9/11, knowing that the United States government has become much more aggressive about scanning email.  When I use hot terms and keywords and things, I find myself thinking, literally, my behavior is modified because I don�t want a false-positive.  I�m no terrorist.  I�m a patriot and all that.  But still it�s just like you just get a little twitchy when you think that what you�re saying could be triggering some automated system somewhere.



LEO:  That�s why I use PGP.  One of these days we�re going�to get you using it because that�s the point.  But it�also raises the specter of terrorists themselves using�encryption.



STEVE:  Well, yes.  And in fact, you know, sort of on the issue of the benefit of it, GRC maintains newsgroups.  And we don�t require anyone to authenticate themselves in any way.  So most of the people there use handles, typical Internet handles, some random combination of words and letters and things that identify them.  And that�s the only way they�re identified.



Now, we implemented the technology to essentially create a hash of their log-in, which is not in any way associated to their name or any other information, but it�s a unique token which cannot be spoofed.  And so the idea is that posters at GRC have a handle which is anonymous, but they also have a tag which every posting they make is stamped with that tag, which is just � it�s literally � it�s the result of a cryptographic hash.  And what it means is that nobody is able to impersonate somebody else, even though everyone is able to remain anonymous.



And actually the other cool thing is that this allows people to securely delete their own postings if something happens and they regret what they posted, they were upset at the time.  It�s been a traditional problem with newsgroups is that you either could not delete, or anyone could delete, in which case you have specious deleters who are deleting other people�s postings.  So we didn�t want that.  But we also wanted people to be able to amend their own postings.  And so this allows them to do that.  But the point is that I�m really an advocate of allowing people to be anonymous if that�s what they want because I think it gets the truth.  I really think people feel much more free to say what they really think if they�re anonymous.



Now, even in my own little microcosm, speaking about this just for a minute, there has been a downside to that.  Back when I was being very vocal about raw sockets on Windows XP and created a huge furor in the industry, the newsgroups drew a lot of attention from what you could only call trolls, I mean, people who were trolling the group...



LEO:  Awful, yeah.



STEVE:  It was really awful.  Now, I refused to delete those postings.  I have, you know, it�s my server, my bandwidth, and my storage.  And people there were saying, Steve, why are you allowing these people to badmouth you like this and just leave this content on the server?  And my feeling was, well, that�s their opinion.  And who am I to say that they don�t have as much right to post something negative about Steve Gibson and GRC as somebody else has to post something positive.  I ended up being vindicated in that issue with Microsoft and raw sockets, which are now removed from XP after Service Pack 2.  But it was a rough time.  And it was about me sticking to the principle that people could post whatever they wanted to and do so anonymously.  Arguably, if these people had to be identified, then they would probably not have posted that way.  One of the things that we see on the Internet is much more outrageous behavior than you normally see in the physical world, where people are inherently more accountable for their actions.



LEO:  Oh, yeah, BuggyBear2937 is very easily annoyed.  And lets us all know it.  I�m making that up, of course.



STEVE:  Oh, of course.



LEO:  But that�s the real problem is that it doesn�t feel like a face-to-face.  You are somewhat anonymous.  And on sites where people use real names, you don�t see that kind of problem.  It�s just tough because there are pros and cons to both sides.



STEVE:  I have to say, too, that if somebody uses an anonymous handle over time, and we have the ability to prevent that from being spoofed, as we do, what ends up developing over time is a trust in that person.



LEO:  That�s true, that�s true.



STEVE:  I mean, that is, in that anonymous handle.  That is, I�ll never know who many of the valued contributors on our newsgroups are.



LEO:  But they have identity.  They�ve built an identity, even though it doesn�t match their real name.



STEVE:  Exactly.



LEO:  Now, and that�s why � and maybe this is the answer.  That�s why a lot of message boards have an Ignore feature.  So if, conversely, somebody proves their identity to be a complete butthead, you just press the Ignore button, and you don�t see their stuff anymore.  Maybe that�s the kind of solution we need.  Instead of saying, no, you�ve got to use your real name, we need maybe to do it some other way, more�innovatively.



STEVE:  And of course in the press there�s this whole notion�� and even in law enforcement there is this notion of an anonymous informant.  The famous Deep Throat, who was participating in the whole Watergate issue and informing Bob Woodward of what was going on.  This was a person who over time built up a relationship with this person in the press and so � and the same thing, of course, happens in law enforcement where somebody will have a confidential informant that over time has proven their integrity, may always need for whatever reason to remain anonymous, but feels that by providing certain information, more better is being done than harm.  And that�s sort of the way that decision gets made.



So the other thing that�s interesting is, for example, there�s a network called Freenet which is really a perfect example of very powerful technology where you�re taking the good with the bad.  Freenet allows the creation of private encrypted networks for storage of content.  Now, that�s something very different, for example, than other anonymizing services like the famous Anonymizer.com that�s been around for a decade.  They will allow you to anonymously acquire information, that is, for example, anonymously surfing the Internet so that you go to sites that have no idea who you are.



Now, as we�re going to discuss next week, it turns out that unless this is done with much greater care than most people assume, that level of anonymity can be penetrated.  So it turns out that really true anonymity on the �Net is much harder to get than is normally believed.  But Freenet is a different approach.  They�re very pro anonymity, pro privacy, pro free speech.  So their system basically allocates a chunk of hard drive space from everyone participating in the network.  And the content of Freenet is encrypted and stored in this big distributed database made up of all these different computers.  Well, it�s valuable certainly for people to be able to post and share their own content.  Whereas, for example, as I said, with Anonymizer you�re only browsing websites, and they specifically don�t allow you to create content.  In Freenet you can.



But it does mean that, as a participant in this network, you have no idea how your hard drive is being used.  It could literally be, sure, it could be uplifting free speech articles about what�s really going on with a government or actions somewhere in the world.  But at the same time it could be really distasteful child pornography or something.  And the point is, you are enabling that to be stored on your computer by availing yourself of this system.  So it�s a real mixed bag.



And the other issue is one of copyright.  And it�s interesting how copyright comes into this because the enforcement of copyright, that is, the actual enforcement of it, requires monitoring communications.  That�s how copyright is enforced is you�re monitoring communication.  But free speech, as we have said, cannot be guaranteed in an environment where there is monitored communications.  So just logically that demonstrates that you cannot simultaneously have both freedom of speech and the enforcement of copyright.



LEO:  You�re right.  QED, QED.



STEVE:  Exactly.  And so many people have said, well, what if Freenet is used for sharing of copyrighted movies and files and music and content?  And it�s like, well, yes, that�s a violation of copyright law.  And so it�s against the law for the system to be used in that way.  But a system which robustly enforces freedom of speech � and we�ve already seen that freedom of speech requires anonymity, otherwise speech is really not unencumbered and not free, so you�re going to have anonymity.  And inherently that means that the anonymity creates free speech, and free speech means that copyright cannot be enforced.



So I guess the real point I wanted to make was that we�re talking about potentially very powerful technologies which can be abused.  As you were saying earlier, Leo, there is, for example, an issue with terrorists using networks like this to securely communicate among themselves.  It�s absolutely possible.



LEO:  Of course when you�re just encrypting the email, you can still tell who�s sending a message to whom; right?



STEVE:  So, for example, with PGP there is the knowledge that we�ve got endpoints that are communicating.  And one of the differences with a system like Freenet, which is a rich network of interconnected systems which are encrypted, is that there isn�t any way to demonstrate a point-to-point connection.  Data can be deposited in this distributed, shared database, and it can be retrieved.



LEO:  So if I use PGP to encrypt email to you, everybody knows, who�s snooping on us, anyway, that you and I are having a conversation.



STEVE:  Exactly.



LEO:  If I were to do it over Freenet, nobody�d know who I was talking to.



STEVE:  Exactly.  And in fact, Freenet, I think it�s currently at 0.7 is the current release.  They have just added some technology to allow standard Internet-style bulletin board communications where people are able to have threaded discussions with complete assured anonymity and an inherent database, which is what any kind of a discussion board requires, and absolute encryption, and no ability to trace who sees what.



LEO:  Do you want to talk a little bit about how Freenet�works?



STEVE:  I�m going to get into the technology of this stuff  next week because it is complicated.  It turns out that, for example, Anonymizer, that is basically essentially just a proxy, Anonymizer is � well, any simple anonymizing proxy has the problem that, if communications is monitored upstream and downstream of it, that is, on either side of it, it�s possible to associate the traffic pattern coming and going and determine the IP of someone visiting a given website.  And that�s something that people don�t typically appreciate, the idea being that packet sizes vary, packet timing varies.  And so if somebody � for example, the government � had the ability of monitoring the network traffic to and from Anonymizer, they would be able to see packets coming into Anonymizer and leaving, and basically penetrate that anonymizing proxy effect because the traffic would allow them to associate connections through the proxy and basically punch a hole in the entire thing.



So it turns out that obtaining this level of real anonymity is substantially more difficult than most people assume.  It�s just not a matter of running through a proxy which is going to reissue your HTTP communications from its IP rather than from yours.  In fact, the TOR project says TOR only minimally hides such correlations between incoming and outgoing traffic.  It says even TOR, which is a multi-hop, multilayered system, it says an attacker watching patterns of traffic at the initiator and at the responder will be able to confirm the correspondence with high probability.



LEO:  The correspondence between you and me, let�s say.



STEVE:  Well, yes, for example, if we were connecting through there.  But normally TOR is used for robust anonymous surfing.  It turns out, though, that it is not that robust.



LEO:  Ain�t so anonymous either, apparently.



STEVE:  Exactly.  And that�s the problem is they had to � and they deliberately, I mean, they understand the problem.  The only way to really enhance this is to introduce much greater latency, that is, for the routers in the TOR network to hold the packets for a long period of time and then release them.  Well, now, this is the kind of thing that you could do, for example, if you wanted to anonymously download files, where you�re not trying to do real-time activities.  But things like VoIP obviously require real-time responses.  And to practically surf the web, to go from website to website clicking on links and downloading content, there�s a tremendous amount of real-time interaction between your browser and the remote server as all of the various components of a web page are assembled.



So this notion of real-time anonymity turns out to be specious.  It is almost impossible to get that.  One way you can is if the anonymizer also is a big cache.  Because if it�s caching, then many of the things you need, the assets and resources and even the pages you go to, may already be in the cache.  For example, people who use Google are probably aware that sometimes you�ll click on a link in Google that is a link that Google has returned as a result of a search.  And the site�ll be down or offline or really slow, and you go okay, so you hit Stop on your browser, and instead you use Google�s cached copy.  So in that scenario you�re never making your request outside of Google.  It�s going to Google, and you�re taking advantage of Google�s massive cache of the entire Internet in order to prevent actually going out to that server and getting the content.  So there�s an example where no one could detect, if they weren�t looking inside Google, no one could detect from the outside, over for example an HTTPS, an SSL-secured connection to Google�s cache, what it was you were looking at because Google would be the central repository of all these external sites.  But that�s exactly analogous to what Freenet does because Freenet creates this encrypted, secured database of discussion groups and massive amounts of content which is completely opaque from the outside.  And due to the way it�s set up, no one is able to determine what it is you�re putting into this database and what it is you�re pulling out.



LEO:  So we don�t want to get into details on how this�works.



STEVE:  I want to do that next week because it�s really interesting what the TOR guys did in order to create really robust security with their network.



LEO:  So there�s Freenet, there�s TOR, and then of course there�s local encryption, which doesn�t eliminate the locale of where it�s coming from or where it�s going, but at least encrypts the content, like PGP or the new privacy guard, GPG, which I use.



STEVE:  Right.  And I�m glad you brought that up because the�point is, what�s significant about that is that it�s not�anonymous.



LEO:  Right.  In the sense that you know who it is, yes,�right.



STEVE:  Exactly.  The content may be opaque and securely encrypted, but there�s no anonymity provided by the people who are communicating at the endpoints.  And very often that�s something that people really need or want for various purposes.  And again, the problem is there are many, many good reasons and beneficial reasons for having and enforcing and allowing anonymity on the �Net.  The flipside is, as with any really powerful technology, it can be used for nefarious purposes, as well.



LEO:  There were for many years, and I don�t know if they�re still around, anonymous remailers, where you would use kind of � similar to a TOR or Anonymizer.  You�d use multiproxies, and it would eventually hide who sent the email and where it was going.  Unfortunately, I have to say, at least some of these have been subpoenaed by governmental agencies, and I guess it wasn�t hidden enough.



STEVE:  Yes, in fact there was a case there, something called the Java Anonymous Proxy Project, which spreads anonymous proxies around the globe.  It turns out that the state of Germany did not want these anonymous proxies functioning within their domain, literally, I mean their dominion, and generated legal action against these anonymizers.  They legally required that a backdoor be installed in order for them to have access to what was going�on.  I mean, this kind of anonymity makes governments very uncomfortable.



LEO:  And others, like the Church of Scientology, who compromised the Penet mailer.  It�s a fascinating subject.  And we�ve just started, basically, as you have in the past, with kind of a roundup of the high-level issues.  We�ll talk about the technologies in the next episodes.



STEVE:  You know, we could have ignored the whole question of the value and benefit and importance and responsibility that comes with anonymity on the Internet because it�s very significant because the Internet is such a powerful opportunity for giving people the freedom of speech and freedom of anonymity.  But with that comes some responsibility.  And there�s a dark side, which I didn�t want to not talk about that.



LEO:  You can�t ignore it.  Although I am certainly a believer ultimately in free speech, and I think you�ve got�to do it, despite the negatives, the downside.  The alternative of completely no anonymity at all is just far�worse.



STEVE:  And it seems to be � I don�t mean to impose democratic politics on the world.  Certainly the...



LEO:  Lowercase �d,� by the way, not uppercase �D� when you say �democratic.�



STEVE:  Right, exactly, lowercase �d.�  Certainly the rulers of China have a different philosophy about the way they think a state should operate.  But to the degree that a democracy is a valuable thing for people to have, we understand that that requires that the citizens of the democracy be informed of what the government is doing and that there be good communications in order for this state to be managed.  And governments have historically fought that kind of really good communication.  Governments would like to have more control.  And it�s the lack of control that makes the system work in the long term.



LEO:  Steve, as usual, sometimes technology verges on politics.  And this is a case where it does, and I think you�ve done a great job of synopsizing both sides.  Next week the ins and outs, the technology behind Freenet and...



STEVE:  And why anonymity, why and exactly how technically obtaining real anonymity is a much more difficult thing to do on the �Net than most people are aware.



LEO:  It�s hard to do.  Thank you, Steve Gibson.  Of course we want to remind everybody that Steve�s site is the home, not only to this podcast, GRC.com, and the 16KB versions and�the transcripts, but also to SpinRite, which is his daily bread.  And if you ever have trouble with your hard drive, there�s no question at all, SpinRite is a must.  It�s�in my kit.  When I go around and work on people�s computers, it�s one of the first programs I�ll run.  It�s the ultimate disk recovery and maintenance utility, and it�s highly recommended.



STEVE:  I got a neat piece of mail from someone who recently purchased a Dell Latitude notebook.  He said:  I purchased a brand new Dell Latitude notebook a couple of weeks ago and was very happy with the core duo, gig of RAM machine.  He said:  It started to boot really slowly, and programs would crash every so often.  So I ran SpinRite, and what do you know, it started finding problems about halfway through the scan.  So I emailed Dell and told them that SpinRite was used on the drive, and that I would require a new one.  With no questions asked, they sent out a brand new hard drive the next day with prepaid return shipping.



LEO:  That�s great.  That�s great.



STEVE:  He said:  The respect from Dell to the SpinRite product was phenomenal.  They didn�t even want me to run any other software to confirm the diagnosis.



LEO:  They do.



STEVE:  He said:  Thanks, Steve, you saved a brand new Dell from an untimely death.



LEO:  Isn�t that great.



STEVE:  That was really neat.  And of course, you know, Dell can�t control how the UPS driver may have been drop-kicking this guy�s poor laptop...



LEO:  Well, don�t even blame UPS.  Sometimes the hard drives just come out of the factory bad.



STEVE:  Exactly.  It could pass initial tests and just have an infant mortality problem.  But this guy ran SpinRite, it confirmed a problem, and Dell said, okay, that�s all we need to know.



LEO:  I love it.  That�s kind of a joint plug, really, for  SpinRite and our sponsor.  I like it.  Very nicely done.



STEVE:  True story.



LEO:  I actually just bought a Dell laptop, an M1210, which is a dual core 2 with two gigs of RAM.  I loaded this sucker up.  Actually I was amazed because the price for really absolute top-of-the-line laptop was about $2,000.  And that�s so much less than it used to be.  In fact, we used to say the computer you want is always at least $2,500, and the dream computer�s like 3 or $4,000.



STEVE:  It was always a moving target.



LEO:  Yeah.  Core 2 duo, 2GHz processors, two gigs of RAM.  I got a 7200 RPM hard drive because I wanted to � this is going to be my Vista machine, so I really wanted to trick it out, knowing that Vista is going to be demanding.  They don�t have hybrid hard drives yet, unfortunately.  But everything else, I just loaded that sucker up.  I was very pleased.  If you want a link to that or to other Leo�s Picks, including the XPS that we bought for Call For Help, that you�ll find at TWiT.tv/dell.  That�s the Leo�s Picks page.  Dell does provide us with financial support for this podcast and a number of the other TWiT podcasts.  They�ve been a really great sponsor.  In fact, I think our contract runs out in the next couple of weeks, and I�m hoping that we can get them to come back.  But I do appreciate their support, and your support, too.  When you buy any Dell product by going through one of the links on the TWiT.tv/dell page, we get credit for it.  And so thanks to Dell for their support.



Oh, also want to mention Astaro because they have been here since practically day one.  I can�t remember exactly what episode they joined us on, but early on.  They�ve been big supporters of the show.



STEVE:  And they were our first sponsor.



LEO:  They were our first sponsor.  They were the first sponsor on the TWiT network.  And they�ve decided to come back for another year.  And that�s � we love them.  And there�s good reason.  It�s an open-source, high-quality security gateway.  If you have a small or medium business, and you need superior protection from spam, from viruses, from hackers, you get a complete VPN, intrusion protection, content filtering, and of course an industry-strength firewall, all in a very easy to use, high-performance appliance.  I�ve got one, and I just love it.  It�s the Astaro Security Gateway.  Contact them, they�ll give you a free trial � www.astaro.com, or call 877-4AS-TARO.  You can schedule a free trial.  And home users, non-business users, can download the software version of ASG free for home use also.  Astaro.com.  Thanks to them.



STEVE:  So next week is talking about the technical challenges of Internet anonymity.  I did mention last week that I would have a new piece of security-oriented freeware to announce.  Unfortunately, we�re recording this and next episode early.



LEO:  Ahead of time, yeah.



STEVE:  Yes.  And I�ve got myself tangled up in some tricky details with it.  It�s going to end up being, I think, even cooler and more valuable than I originally expected; but it�s also turning out to be a lot more challenging.  So I�m going to delay the announcement until I actually have the thing running and bulletproof and tested.  So it�ll be a couple weeks, and then we�ll talk about what that is.



LEO:  No problem at all.  You�re in heaven, though, aren�t you, when you get to code on a new project.



STEVE:  Oh, finally, Leo, I�m back to writing some code.



LEO:  Does that make you feel good?  That�s neat, I can tell.  Are you running this in Assembly?



STEVE:  Of course.



LEO:  Oh, Steve.  You�re so old-fashioned.



STEVE:  That�s my language.



LEO:  I love it.



STEVE:  Well, it turns out that it�s exactly the right language for this application because I�m dealing with, down in the registers of Intel processors, dealing with literally setting bits on and off and protected mode and privileged instructions and that kind of stuff.  So it�s a...



LEO:  Will this work on Vista as well as XP?



STEVE:  Yes.



LEO:  Really.  How do you know that?  Did you test it in�Vista?



STEVE:  Yeah.  I�ve got it running on Vista.  In fact, I have a new MacBook with the Intel core 2 duo because I needed some more recent chips in order to see it running there.  And Leo, I�ve got to tell you, I�m going to disabuse you of this notion that Vista requires a lot of power.  I am really happily running it on my little HP TC1100 notebook, I mean, my little...



LEO:  That thing is low power.  That�s the old tablet, yeah, that�s not very fancy.  I mean, that�s Pentium M, right?



STEVE:  Yes.  The 1000 was a Transmeta, and they realized, whoops, that was a mistake.  And so they went to the 1100, which is a Pentium M, I think it�s 1.2GHz or something.  But it is completely usable.



LEO:  That�s good news.



STEVE:  And I�ll tell you, I don�t have the � my God, I�m never going to remember the name of this UI.  The Glass?  Is it Glass?



LEO:  Aero Glass.



STEVE:  Aero Glass.  I don�t have that, but...



LEO:  You don�t need that.



STEVE:  I really don�t need it.  And Leo, there are so many little touches.  There�s now stroke recognition on the tablet.  So you�re able to scroll a browser page just by stroking up or down.  You�re able to copy, paste, cut, and delete using stylus strokes.  Anyway, I�m seriously considering maybe just skipping over XP and going to Vista because I really think this is...



LEO:  I think you should.



STEVE:  You and Paul were talking on Windows Weekly on Friday, saying that in his opinion, because he�s of course been really exposed to it, he thinks it�s like Microsoft really got it right.



LEO:  I�m excited about it.  I�m totally excited about it.



STEVE:  And here I am saying � Mr. Skeptic, Mr. Oh Don�t Touch It for a Couple Years, blah blah blah.  It�s like, well, there�s a lot to like about it.



LEO:  In fact, I have to say, on this M1210, it�s running XP�because I haven�t yet got my MSDN subscription.  And I don�t�� it�s like I don�t even want to try it.  I know XP.  I�m not interested.  I want Vista.  I want Vista.  And I�m sure everybody else is saying the same thing.



All right, well, we�re just going to say good bye, and see you next week.  And thank you, Steve.  All right.  And we�ll�see you all back here, same time, same place, for Security Now!.





Copyright (c) 2006 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#70

DATE:		December 14, 2006

TITLE:		Achieving Internet Anonymity

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-070.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Last week Steve and Leo discussed the social implications and the social power of Internet Anonymity.  This week they discuss the technology of Freenet and TOR (Onion Router) networks, and Steve describes the detailed technical operation of both systems.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 70 for December 14, 2006:  Freenet and TOR.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Dell.  For this week�s specials, visit TWiT.tv/dell.



Time for Security Now! with Steve Gibson, the security guru from GRC.com.  And we are so glad to get you back on every Thursday, Steve.  We have not missed an episode.



STEVE GIBSON:  We�re never going to, Leo.  We recorded last week�s actually yesterday, which was three days early for last week�s episode, and now we�re recording this one on the following day, on Tuesday...



LEO:  A week early.



STEVE:  A week and two days early because you and I are going to be together in Toronto next week, so.



LEO:  But I appreciate your doing that, and your willingness.  While much of the TWiT network is going to go to sleep for the two weeks of Christmas and New Year�s, you continue on.  There�ll always be a Security Now! if you�re getting desperate.



STEVE:  And you know, Leo, I�m very competitive, and I�m watching the fact that our episode numbers are creeping up on TWiT because every time TWiT takes a pause or a little hiatus, it�s like, oh, good, I get a couple numbers closer.



LEO:  You are going to beat them.  Let�s see, you�re at 70.  TWiT�s at 79, 80.  Oh, it won�t take much longer.  I think we�ll take a week or so off because I�m going to Mexico for Christmas.  So I think we�ll take a week or so off for TWiT.



STEVE:  Well, that�ll only lose you one or two episodes.



LEO:  Yeah.  I�ll lose a few more just for you.



STEVE:  Okay.



LEO:  So last week we talked a little bit about anonymity on the Internet, how difficult it is to achieve, first of all, but also the political ramifications.  And, you know, there are pros and cons.  But I think we concluded ultimately that if you believe in free speech, you have to support anonymity of some kind.



STEVE:  Right.  I felt a little concerned that last week�s episode might have been a bit of a fluff episode, that is, you know, not deep security technology.  We�re going to make up for that today.  But I really wanted just to take the time to talk about the issue, like the social side of this, because, you know, it is important, and we�re talking about very, very significant technologies, that powerful entities like the RIAA and the government with the DMCA copyright stuff and foreign governments that want to regulate free speech don�t take this issue of anonymity and privacy with a grain of salt.  They�ve got organizations that are all about preventing people from being able to speak freely.  And as we know, our own U.S. government has now disclosed that they�re recording and wiretapping as much of our country�s telecommunications as they�re able to.



LEO:  And from a nonpolitical point of view, we just learned that the government is going to start requiring businesses to save all emails and instant messages for three years.  So even at work you don�t have any privacy, especially at work perhaps, not even �even.�  So I think it�s important that we did talk about that, mainly because we often in this business talk about the technology, but don�t talk so much about the ramifications.  I know when I sit down with Phil Zimmerman of PGP, and we did a number of times on the Screen  Savers, I always try to bring up this issue.  And he�s good about talking about it.  But frankly, as most engineers are, he�d rather talk about the technology.  So I think, yes, it was fluffy, but we needed to do it.



STEVE:  Well, that�s behind us now.



LEO:  So get ready.



STEVE:  Exactly.  And in fact we�re going to be using a lot of the foundation that we established, I guess it was either early this year or late last year, all of that crypto stuff.  We spent a number of episodes talking about public key, asymmetric, and also so-called private key, or symmetric cryptography.  We�re going to need that foundation.  And remember at the time that I wanted to lay that foundation so we would be able to have then conversations that assumed people understood that stuff so that we could talk about all the fascinating ways that this kind of crypto is able to be assembled and put together in different � well, essentially to achieve different sorts of goals.



LEO:  We�re going to get to our subject in just a moment.  But first a short commercial break for Astaro and Dell.  As always, this episode of Security Now! is brought to you by the good folks at Astaro Corporation, makers of the Astaro Security Gateway.  If your small or medium business network needs a superior device to protect you from spam, from viruses, from hackers, as well as complete VPN capabilities and intrusion protection and content filtering and an industrial-strength firewall, all in a very easy-to-use, high-performance appliance, you want to check out the Astaro Security Gateway, Astaro.com.  Or you can call 877-4AS-TARO and schedule a free trial of an Astaro Security Gateway appliance in your business, really see what it can do for you.  They know once you try it out you�re going to want one.  And by the way, non-business users, you can use their software absolutely free.  It�s open source and available at�Astaro.com.  We thank them for their support of Security�Now!.



Also we want to thank Dell for supporting us.  Dell�s been advertising for the last three months with great success, and we really thank the TWiT audience, the TWiT Army, for making it so.  We�ve used Dell for so long on the TV shows, and I own Dell computers.  In fact, my new laptop�s a Dell.  What I�ve done is put some links to the newest Dells we just got, both for the TV show and me personally, on our Leo�s Picks Page.  That�s TWiT.tv/dell.  Just go there, visit, take a look, click the links.  If you want to buy something else, let�s say one of those great Dell 24� monitors � I love those, Steve has a bunch of them � just click the link at the top there that says �Go to Dell.�  And anything you buy after that point is credited to TWiT, so we do appreciate that.  That�s TWiT.tv/dell.



And now back to Steve Gibson and Security Now!.  Is crypto always the foundation of anonymity?  It has to be scrambled, I guess, to be anonymous.



STEVE:  Well, I guess.  I mean, if you look at a real world example, where somebody just writes something on a piece of paper, if they wrote it with the other hand than they normally use, and they passed it through three or four people, none of whom knew the person before the one that they�d received it from, and so no one knew who they were going to be giving it to, I mean, you could invent real-world anonymizing solutions which are non-crypto oriented.  So I would say that in general crypto is not necessary.  But it turns out that in order to make it, certainly on the Internet, in order to achieve the goals of not being able to associate the sender and the receiver of information, crypto really does play a strong role because it allows you to have provable enforceability of these things.



So let�s step back a little bit and just notice that one of the reasons anonymity is so difficult � and one of the first things I said last week was Internet anonymity is much harder to achieve than most people appreciate.  The reason Internet anonymity is so difficult is essentially, like so many things the Internet was not designed to provide, it was never designed to provide anonymity to people.  That just wasn�t in the design specs.  It wasn�t part of the plan.  And the most perfect example of that fact is that IP addresses are the way packets route from one end to the other.  So as we know, all Internet endpoint systems � machines, routers, whatever � are identified uniquely on the �Net by an IP address.  Well, I mean, technically it�s anonymous inasmuch as it doesn�t tell you the name of the company or the name of the person with the IP.  But it is a tag that can be used to uniquely identify every sender and receiver of traffic on the �Net.



LEO:  So it�s the first thing you want to get rid of in�anonymity.



STEVE:  Yes, exactly.  It is the way the �Net is structured and the way data moves is there�s never been a notion on the �Net of the Internet being about anonymity.  So the point is, anything we do to add that is a layer on top of the existing structure, which was just never designed to be anonymous.  So it�s a hard thing to do.



Another example from things we�ve discussed before is SMTP headers.  We�ve been talking about, for example, if I send email through Google but from my own system�s email client, rather than from a web page at the Google server, there are headers which are added that identify my IP as the originating IP.  And in fact, that�s the case even if you use Hotmail or Yahoo! and you use their browser interface.  The IP you sent from is there.  And in fact the SMTP protocol, the protocol for routing email across the Internet, in order to avoid the potential for routing loops, that is, where email is sent from one SMTP server to another, it sends it to a third, and due to some misconfiguration, the third server sends it back to the first.  Well, if there wasn�t some way to record the path the email had taken so far, then it would be possible for the email to get stuck forever being forwarded through multiple SMTP servers in some sort of a routing loop.



LEO:  So the very structure of the Internet requires real�identification.



STEVE:  Exactly, exactly.  Many things about the �Net are assuming that you�re going to create some sort of a record of the path that the data took or certainly the IP that originated the data so that you�re able to send something back.  So as a consequence, all of the technology we�ve got in place is about being non-anonymous.  Not necessarily identifiable to an individual or a corporation, but certainly back-trackable to the physical, sort of the electrical source of the data.



So two technologies we talked about last week are different in what they achieve.  I want to talk about Freenet only briefly because there isn�t that much to say about it.  And then we�ll sort of finish out by talking in detail about how TOR works.



As I mentioned also last week, many anonymizing systems deliberately don�t allow people to anonymously create content.  That�s not what they�re about, you know, the famous Anonymizer.com system which has been around for a decade, they�re about allowing users of their service to anonymously visit websites.  And so those users are pulling existing public content, but their own identity, their IP address, and presumably cookies and other bits of debris that might be part of the HTTP transaction, those are being deliberately cleansed and filtered by this anonymizing proxy, and their actual address is being hidden.



We remember also that, by default, a proxy will include the IP of the user for whom it is performing the proxy service.  For example, cable modem companies use a caching proxy in order to minimize their use of bandwidth for all their consumers who are, for example, going to the same page or wanting to download the same GIFs and so forth from web servers.  If the caching proxy has the data, it doesn�t need to ask the server for it again.  That minimizes the ISP�s transit bandwidth and allows the ISP to keep the bandwidth within its own organization, for which it pays a much lower cost because it�s using its own infrastructure.  But when requests leave that ISP, almost always there will be a tag in there saying, I am making this request on behalf of the following IP.  So again, that proxy is not helping anonymity at all.  And it�s very possible, then, for the website to see where the request really came from.



So an anonymizing proxy, that is, a proxy that is deliberately designed to hide the identify of someone for whom it is making the request, it will not add sort of those optional headers, which really don�t have to be there anyway, and it will make the request just as if it was making it on its own behalf, and then turn around and send the response back.  So there�s anonymity being provided there.  But as we also mentioned last week, it�s not very good because it really wasn�t meant to be ultra robust.



LEO:  Well, doesn�t the server know where it came from?  And�that�s part of the problem.  The server can keep track of that.



STEVE:  Well, yes.  Certainly their own records � if they were maintaining records they could.  But imagine an external agency, for example, a government that wants to know who is making...



LEO:  Who�s doing bad stuff.



STEVE:  Yeah, exactly.  Who is using an anonymizing proxy in order to hide their identity?  All that person would have to do is analyze the traffic patterns coming to and from.  Well, okay.  In the simplest case, imagine that only one user was using the proxy.  Well, if one user was using the proxy, packets would go to the proxy, they would come out the other end, go to a web server, the responses would come back from the web server, and they would go back out of the other end of the proxy, back to the user.  So obviously anyone looking at the traffic could determine which user was visiting.  They would know the IP...



LEO:  But that�s the trivial case.  There�s a lot more than one person using these things.



STEVE:  I wanted to point out, though, that that�s the level of, I mean, that�s the way this can be busted is not only using timing, but using packet sizing.  Because another way to associate incoming and outgoing traffic is to look at the packet sizes which, you know, may or may not be changing dramatically in size.  So my point is that, yes, when many users are using a single focal point, then it�s more difficult.  But more difficult still being way, way short of being impossible by doing traffic analysis.  So traffic analysis is something that the people who built the TOR network, for example, and to a somewhat lesser degree the Freenet network, that�s something they recognized as an Achilles heel for anonymity busting.  And they�ve gone to substantial lengths to get around that.  And that�s what we�ll be talking about when we talk about TOR.



But Freenet differs from many of these other anonymizing systems because it is all about storage.  That�s what it�s about.  It�s about basically creating dark networks, as they call them, of storage.  Users of Freenet give up � they basically share unused hard drive space to participate in this Freenet database, sort of in the same way that the people who run the SETI screensaver are contributing their unused CPU cycles, and sort of the way that users of traditional peer-to-peer filesharing like Kazaa and Limewire and all those, they�re basically allowing their unused bandwidth and also their storage in some cases to be used.



Similarly, Freenet users are saying, okay, I want to participate in this distributed database, so I�m going to give up a chunk of my hard drive in return for being able to use chunks of everybody else�s hard drive in this network.  The way the system works is � and probably since so many people are probably familiar, at least in passing, with Kazaa, for example, or any of the traditional peer-to-peer filesharing systems, those systems have a number of problems.  First of all, and probably mostly, the data being sent back and forth is not powerfully encrypted, so it�s possible for someone to create a sort of a pseudo user and obtain known copyrighted files from somebody else.  And you know who has them.  The files stored on people�s hard drives are not encrypted, they�re just the regular file.  And they bear their regular filename.  So it�s very easy for the RIAA to issue subpoenas, cause the police or FBI or whatever law enforcement to visit someone�s home, grab their computer, do a directory listing, and see all of the copyrighted material these people have.



So what Freenet has done is they have completely solved all of that problem.  That is, as we were saying last week, it�s a fact that you cannot have enforceable copyright if you have freedom of speech.  And I want to make very clear that I�m not advocating any breaking of copyright.  I�m just talking about the technology.  We covered the social and political aspects last week.  So I�m just wanting to explain how this works rather than running around cheering it on.  That�s not what I�m here for.  What the system does is, someone who wants to submit a file, whatever kind of file, could be political agenda, it could be anything, I mean, Freenet basically is a very secure, anonymizing, distributed database.  Somebody submitting the file generates a hash of whatever they want to call it.  So they could call it Batman_Begins_DVD.iso, I mean, that�s what they can call it�if they want to.  But it is hashed using 160-bit SHA1�hashing.



And we know from prior Security Now! episodes where we�ve talked about that, what that does is a cryptographic hash takes a string of plain text, that is to say, the name of the file, and converts it to a very likely to be unique hash, that is, 160-bit, that looks just like random data.  If you change any character in the name, the hash ends up having, if it�s a good hash, about half of its bits will get flipped, and it�ll just look like it�s a random flipping of bits.  There�s no way � and this is the key � there�s no way to go backwards, that is, you put the filename, you know, Batman_Begins_DVD.iso, into this hashing function, out the other end comes 160 bits.



Well, every time you put the same name in, you�re going to get the same 160 bits out.  But there is no way of having the 160 bits to reverse that process.  You can do what�s called a �dictionary attack,� that is to say, you could guess that something was this name and put it in and see if the 160 bits matched.  And if you got a collision, there�s a high probability that the same string was used, but it�s not provable.  That is, even then, even when you get what�s called a �hash collision,� meaning that you put something in and you got the same result out, there�s never a way to prove that there � well, because in fact mathematically we know there are a great many strings in theory that can generate the same 160 bits.  So you have provable deniability there.



Well, through this process of encryption and hashing of descriptive keys, Freenet is able to provide anonymous storage of anything people want to store.  There�s a problem with what�s called a �flat name space,� meaning that all people who were using Freenet were using sort of like the same hash.  So what they�ve done is they�ve created this notion of private name spaces, meaning that an individual user will have their own handle, and so their own handle is used along with the file name or file description that they want to submit to create a hash.  And that prevents somebody�else with their own handle who submits a file that happens to collide in terms of hashing, it prevents that collision from happening because individual users have distinct handles.



There�s also, I mean, it�s such a complex protocol.  I�ve looked at it.  I�ve understood what they�re doing.  But it�s really not necessary to get into the minutiae of the details of how they perform encryption.  But I do have a link on our show notes for a PDF that completely describes this, if this description ends up interesting someone who wants to really get into it, because these guys have worked out the system such that a Freenet system of these nodes, all nodes are peers.  They�re identical.  They don�t have knowledge of each other beyond their own local neighbors.  And that�s a deliberate measure to increase anonymity.



So the idea is, when someone inserts a document, a file of any type and description, into the system, it just gets absorbed by this distributed network.  There are indexes running on nodes that index based on the proximity of the hash.  So the system self-organizes.  And it means that, if you were to tell somebody else, go get this file from Freenet, they are able, from no matter where they are geographically, to � into their own node to say, I would like to retrieve this file.  They do it using the plain text strings they were given, meaning the user�s name, or the user handle and the file description.  The Freenet hashes that into these indexes.  From that and from other material, they�re able to generate cryptographic keys which are able to decrypt the file because all the contents is stored encrypted in a way that is really secure.  So there isn�t a way, if someone did bust down someone�s door and say, hey, we know you�re running a Freenet node, we want what�s on your drive.  Well, all that�s there is a bunch of random�bits.



LEO:  I have to say, I mean, this all sounds really good.  And I guess we talked about this last episode.  I just want to kind of underscore this because I know people are thinking this as they listen.  Okay, so I�m allowing people to store pirated movies on my hard drive?  Why is that a good thing?



STEVE:  And now, Leo, now that I�ve sort of better explained the power of this, now you can understand why I wanted to spend some time last week and say, well, you know � and this is also why I just said I�m not advocating this.



LEO:  I bet there�s a lot more pirated stuff, or maybe illegal stuff, than there is dissent and, you know, documents from whistleblowers and things like that.



STEVE:  I think that�s probably the case.



LEO:  Like 99.99 percent.



STEVE:  It is a powerful archiving system for trading and posting anything.  And again, as I said last week, and this comes from the Freenet papers, if you have � in order to get free speech, you must have anonymity because speech is not going to be truly free if it�s not anonymous, or if you at least don�t have the option of it being anonymous.  And similarly, copyright requires enforcement, but enforcement requires a lack of anonymity.  Otherwise there�s no one to enforce against.  Which means that, if you�re going to have free speech, you are not going to have copyright enforcement.  And so...



LEO:  Ah ha.  You did say that last week.  Now I understand�why.



STEVE:  Right.  And so the point is, these Freenet guys, the people who have designed this and put it together, they�re adamant about the necessity for free speech.  Free speech means anonymity.  Anonymity means non-enforceability of copyrights.  And there just isn�t a way around it.  It is a legal, social, political dilemma.  But our society has lots of those.  And so here�s one more.  But I�m glad you reinforced the idea that what this really means is people who participate in Freenet who want the option of accessing this data and who are contributing a chunk of their hard drive, their hard drive is probably storing really bad stuff.  Because just in general, bad stuff is the stuff that has to hide.  And this is all about hiding.  You know, it�s about anonymity and hiding.  Okay.  So...



LEO:  After we talked about it last time, I went and I looked at the site, and I thought, I�ll download this, install it, because I want to support freedom.  But I decided not to for that very reason.  I thought, but I don�t know if I want to support storing other stuff.  It�s a very tough choice.



STEVE:  And as we talked about anonymity, even anonymity by itself is a double-edged sword.  In my own newsgroups, I know that the anonymity I freely offer people who post helps them to say what they want to say.  And I want to know what they really want to say.  I don�t want to hold them accountable.  I don�t want anyone to be able to hold them accountable.  So it�s completely cool with me if unknown people are posting things because it�s a good thing.  At the same time, in the past, as I�ve mentioned, we�ve had trouble being trolled by people who were, in everyone�s opinion there, abusing that anonymity and causing problems as a consequence of posting content they wouldn�t have posted if their identity was enforceably known, which it isn�t.  So it is a mixed blessing, but it is a powerful technology that exists, and I wanted to talk about it.



LEO:  And I�m glad you did.  And it�s a tough one.  I just don�t know what the answer is, yeah.



STEVE:  I know.  Okay, so TOR.  Let�s talk about TOR�because...



LEO:  So that was Freenet, all right.



STEVE:  That was Freenet, Freenet being a distributed, anonymizing, encrypting database that runs on Freenet nodes scattered far and wide, designed to allow people to anonymously, securely share any content of any kind whatsoever.  And they�ve achieved it.



Okay, TOR is different.  And TOR is something that interests a lot of people.  We talked about the vulnerability of using a single proxy as an anonymizer because in fact traffic analysis, while complicated, like in cryptographic terms it�s trivial.  If you take the case of one user using a proxy, it�s obvious who they are and what sites they�re visiting because anything they do is being done on their behalf by the proxy.  Okay, so now that�s easy.  Now two users are using the proxy.  Well, it�s a little more difficult.  But by looking at the timing of the arrival and departure of packets and the relative sizes of the packets, you could still probably disambiguate the actions of two users across a single proxy.  So now we increase it to four and five and six and so forth.



Well, okay.  Clearly the more active it is, the more difficult it is to disambiguate queries.  But it�s not difficult on, like, a really, really, really hard scale.  Also you have the ability of storing the traffic and doing an analysis of it after the fact.  So you could just capture a huge blob of traffic and then take your time analyzing it to any level of detail needed in order to make your determinations about who was making queries where.  The point is that using a single proxy is just not sufficiently anonymous.  There isn�t a way to make it work well enough.



So knowing that, this notion of a network of proxies was created.  And that�s what TOR is.  TOR stands for The Onion Router.  And as I got into this, I realized, okay, I really have to explain how this works because it is so cool.  I mean, it is very clever.  At the moment there are nearly a thousand onion routers operating in a network.  The EFF, the Electronic Frontier Foundation, has been a major sponsor and funder of this because they want to promote this notion of anonymity and actually promote the actual execution, the availability of anonymity on the Internet because they believe in free speech and think that this is something that is worth making sure we don�t lose.



So we start with a massive network of onion router nodes.  Somebody wants to create a connection through this network to a remote server.  They want to use it for web surfing, they want to use it for sending messages, for email or whatever.  The TOR system, which is in its second generation now, is a general purpose TCP conduit.  So instead of being protocol-specific, for example like a proxy might be an HTTP�web proxy and proxying web requests, the onion router system is a general purpose TCP transmission system, so you�re able to potentially run any protocols through it that you want to.  The originator of a connection chooses at random some number of onion routers that are in the network.  And these things, since there�s nearly a thousand of them, they�re scattered far and wide all over the globe.  Now, the more you choose, the more hops your traffic will have to go through, so the greater latency you�ll have in your communication.  So...



LEO:  That�s a complaint people always have with Anonymizer,�too, which works in a similar fashion, that it slows you down.



STEVE:  Right, well, and there�s just no way around the fact that it�s going to slow you down.  One of the really important features of this system is that, by going from hop to hop, where these hops between routers have been carefully designed � and that�s what I�m going to talk about next is exactly how this works.  By going from hop to hop with this protocol, this onion routing protocol, that�s where you get the power of real anonymity.  And the system is robust, even in the face of many routers being compromised.  I mean, bad people, governments, anybody who was not acting in the best interests of the people using the system, could set up a malicious onion router.  This system, however, still functions robustly, even in the presence of malicious onion routers that are deliberately being run in order to try to break the system.



LEO:  I suppose there�s no way that they could prevent that.  I mean, people are going to set up malicious onion routers.



STEVE:  Well, yes.  And in fact...



LEO:  Or spying onion routers.



STEVE:  That�s one of the attractive things about this is that, because you�ve got nearly a thousand of these, and they�re in all kinds of different countries, they�re being run by, you know, many of them by really trustworthy organizations where, you just, like, okay, I trust the EFF to be � really to be on my side.  But, for example, a company like Anonymizer � and I don�t mean anything against them.  It�s a great service they provide.  But if the government issued them a subpoena, and they�re the sole controller of their anonymizing service, they could be forced legally to do something they would rather not do.  The beauty of this massive network of nodes controlled by all kinds of distributed entities all over the globe and foreign countries, and the need not to trust individual nodes, it really is the perfect solution.  So the way this works is, somebody who wants to create a circuit through multiple onion routers chooses the routers they want to use and the order in which their traffic is going to move from router to router.



LEO:  There�s probably a default setting, right?  I mean, you don�t have to go through this every time.



STEVE:  I don�t mean that the user manually chooses.  I mean that the system chooses for you.  But I�m sort of operating down at the protocol level.  The way the system works is, a random set of routers is chosen.  All routers have a public key pair, that is, they have their own private key that only they know, and they have a public key.  And as we remember, the way this functions is something can be encrypted using their publicly available key which everyone can know.  And once encrypted, that data can only be decrypted using the matching private key that that router never divulges.  That�s its secret key that matches its public key.  So all routers have these asymmetric or public key pairs.  What happens is, the user starts at the far router.  The user is going to build what�s called an �onion.�  And the term �onion� is used because we�re used to onions being created in layers.



LEO:  Having skins, yeah.



STEVE:  Exactly, having skins, and you successively peel off the layers of the onion.



LEO:  An ogre is like an onion.



STEVE:  So conceptually...



LEO:  You didn�t see �Shrek,� so you wouldn�t...



STEVE:  I did not see �Shrek.�  He�s a big green thing is all I know.



LEO:  But he says ogres are like onions, they�ve got many layers.



STEVE:  Okay.  So...



LEO:  And so are TOR routers.



STEVE:  So are TOR routers, yes.  So the user preparing the onion takes the...



LEO:  I really threw you with that, didn�t I.  I�m sorry.  I won�t say anything more about ogres and onions.



STEVE:  This is really complicated, so I want people to pay attention.  It�s really complicated, but really good.  So the user takes the public key of the last router in the chain that they�ve chosen.  And they take a randomly generated symmetric key, which is going to be used to decrypt the traffic it receives.  And they encrypt that symmetric key with that last router�s public key.  So now they have a blob that contains an encrypted symmetric key that only the last router is able to decrypt using its private key.



LEO:  That makes sense, okay.



STEVE:  Now they take that blob, they come up with another � they just randomly generate another symmetric key which the second to the last router is going to use to decrypt the traffic it receives and the symmetric key they gave � I�m sorry, yeah � to decrypt the traffic it receives and the identity of the next router that is the last router in the chain, which is the one to which the second to the last router will send its traffic.  So there�s another symmetric key, and the routing information for the second to the last router, and the blob, which we have from our first encryption.  We encrypt this entire thing using that second�to the last router�s public key.  Now our onion has two layers.



Now we step back to the third router.  We randomly create another symmetric key which it will use to decrypt the traffic it receives, and we give it the routing instructions for the router second to last, meaning the one it will forward its traffic to, and that entire blob we had before, that two-layer onion, and we encrypt the whole thing using that third to the last router�s public key.  Now our onion has three layers.  And we continually step backwards, building this onion, this nested multilayer encryption, each layer encrypted with a successive router�s public key, which only that router knows how to decrypt, and each layer containing a symmetric key which was generated randomly by us at our end.  When we�re finally done, we have this � we�ve stepped back through the whole chain, back to the onion router that we will be using to inject our traffic.



And so now we�ve got this thing called an �onion.�  We give it to that first router.  It uses its private key to decrypt the outer layer of the onion.  Only it is able to do so.  Nobody listening in on the traffic is able to see that happen.  Only it internally knows how to use its private key to take the wrapper off of the onion.  When it does so, it has an opaque blob that it cannot decrypt because only the next router in the chain has the matching private key to decrypt the next layer.  But when it decrypts it, it finds a symmetric key which it will use for decrypting traffic it receives and the routing instructions for the next router.  So even somebody � there�s no way to even know by looking at the onion what the path will be.  Only the router that decrypts its layer knows the identity of the next router in the chain.  It knows nothing about any other routers in the chain.  It doesn�t even know how many other routers there are.  It knows nothing except its own local, I�m going to receive data, decrypt it with a...



LEO:  Very clever.



STEVE:  ...and where do I send the result.



LEO:  That�s very slick.  That�s so slick.



STEVE:  Oh, it�s so cool.  So of course this thing then, it now knows where to send the remaining blob.  It knows which router to send the remaining blob to, the so-called onion.  It sends it to that router.  That router receives it, uses its private key, which is the only key which can be used to take the next layer off the onion.  From that it gets its symmetric key for this connection and the routing instructions for the next router, and it forwards this thing down.  So this onion, which was built once in the beginning, it then moves through the network, basically informing each node of the onion router system, only the information it has to have, I mean literally only the information it has to have, how to decrypt what you receive, who to send it to.  And each onion router only knows one step in the chain and no more.



LEO:  That seems impervious to any kind of � including a corrupt router.



STEVE:  It is just deliciously robust, Leo.  I just love it.



LEO:  However, it seems like there�s also a lot of overhead.  You�ve got a lot of encrypting and decrypting going on.



STEVE:  Well, now, that�s the other beauty of this, is remember that asymmetric encryption is very slow.  Public key crypto is on the order of a hundred times slower than symmetric.  So all of that work only needs to be done once.  What we just did was we established a circuit.  We have not sent any data yet.



LEO:  Oh, I get it, okay.



STEVE:  The onion is not a data carrier.  It�s just a circuit creator.



LEO:  It�s a route, basically.



STEVE:  Exactly.  It is an incredibly cool, secure route that also manages to supply symmetric keys to every router along the way.



Now we want to send data.  To send data, we take the actual data we want to send.  The first thing we do is pad it out to a fixed size.  That�s one of the other cool things these guys did.  They recognized that traffic analysis could use the packet size for disambiguation, as we saw in the simple single-proxy case.  So they�ve completely solved that, so that no matter how big the packets actually are, we�re going to pad them out to full size so that all packets moving among the routers within the onion router system are the same size.  You can no longer use size to give you any clues because they�re all the same.



LEO:  PGP does that, too.  That�s a great technique.



STEVE:  Yes.  So the next thing we do then is we take the data we want to send, we use symmetric encryption � remember, that�s very fast.  Symmetric encryption is very, I mean, it�s like not a concern anymore, it�s so fast.  We first encrypt it with the last symmetric key, that is, with actually the first symmetric key we generated, which we gave to the last onion router in the chain.  Then we encrypt that with the second to the last symmetric key.  We encrypt that with the third to the last symmetric key, and so on, working our self back up the chain.  So we have something still the same size, that is, because symmetric encryption doesn�t change the size.  Remember, it just flips the bits.  So we�ve got something which has been encrypted N number of times where N is the number of routers in our onion routing�chain.



We then give this blob to the first onion router.  The last encryption we did was with its symmetric key, so it�s able to decrypt it.  But remember, all it�s doing is decrypting a layer of encryption.  It�s still a blob, that is, it�s still encrypted N minus one times, using keys it has no knowledge of because those keys were buried in layers of the onion which were encrypted using the public keys of the other routers that can only be decrypted using their private keys that no one has any way of knowing.  So it takes this and simply � so it runs a very fast symmetric decryption on what it receives and forwards it to the next router in the circuit because it�s maintained a circuit awareness of what its next router is.  Remember, it knows nothing other than the next router.  That router receives it, sees what circuit ID it is, looks it up in its table.  It uses its symmetric key to again perform the same decryption on this data packet, which it then forwards to the next router.



The beauty of this is there is no way for anyone looking at an onion router to have any clue what�s going on.  Not only are the packets all the same size, but because a symmetric decryption occurs between incoming and outgoing data, and we know that state-of-the-art encryption just looks like randomness, there is no correlation between the data of the packets coming in and going out.  It�s just, you know, you get � it looks like...



LEO:  It�s just noise.



STEVE:  ...packets of random, yes, packets of noise came in; packets of noise went out.  And because this is a richly interconnected system, packets are coming in from all these onion routers all over and going out to all these onion routers all over.  But there�s nothing to help you determine which one is which, I mean, like where the circuits are.  There�s just no way to figure that out.  So when this data packet finally gets all the way through its multiple hops, it is finally decrypted with the last symmetric key by the�last node, and that is again the text or the data that you originally put in at the front end.  And baby, that is�anonymous.



LEO:  Wait a minute.  That�s the title of this show:  �Baby, That�s Anonymous.�  And by the way, you�ve more than made up for � if anybody thought last show was fluffy, you�ve more than made up for it with this one.  But once again it�s very�elegant to see this really nifty solution to a complex�problem.



STEVE:  Oh.  I just, I mean, it�s one of these things where�� and I promised our listeners this a year ago, that once we had the foundations of symmetric and asymmetric crypto under our belts so we could talk about the things you could do with it, this is the kind of stuff you can do.  I mean, it is so neat.  And there�s thousands, well, not thousands, there are � it�s more than many hundred.  It�s, I think, nearly a thousand of these onion router nodes.  The system is called TOR, The Onion Router.  It is slow.  I mean, it�s not like going to Microsoft.com or Yahoo! or Google, where you�re making a point-to-point connection.  But they know everything they care to know about who you are.  The tradeoff is you need to go through multiple hops.  We�ve seen why multiple hops are necessary, why just running through a single proxy server doesn�t really give you robust anonymity.  But this onion routing system does.  And it is just elegant.



LEO:  Yes.  Tor.eff.org is a good place to go to find out more and actually to start using the TOR system.



Well, now I feel � the thing about TOR, unlike Freenet, you�re not really volunteering, unless you volunteer to be a TOR system, you�re not volunteering for anything you might not be comfortable with.



STEVE:  Well, yes, you�re right.



LEO:  And you can use TOR completely freely and safely.



STEVE:  Yes.  You can certainly be an onion router, in which case you would be offering your node to enrich the network.  You�d be offering your bandwidth also.



LEO:  But you don�t have to to use it.



STEVE:  That is correct.  You are able just to be a user of the network.  You would also � I was going to say, you would be offering your bandwidth.  You would be offering your node to enhance the anonymity-creating ability of the network.  But you would not be offering any storage space.



LEO:  You don�t store anything.



STEVE:  Exactly.



LEO:  Hey, I want to thank you, Steve, for clarifying this�and for talking about it because I think it�s very important.  And I�m a big believer in freedom of speech and privacy, and I think these two technologies are very important to preserving that.



STEVE:  I guess my position is, if somebody needs it or wants it...



LEO:  There it is.



STEVE:  ...it�s cool that it is available to them, yes.



LEO:  That�s exactly right.  What else is available?  GRC.com, a great place to go to protect your system, whether it�s with ShieldsUP, the free tester that�ll test your router or your firewall, or many of his free programs � Shoot The Messenger, DCOMbobulator, UnPlug n� Pray, and on and on and on, and a new one coming up any day now.



STEVE:  I get to work on it now.



LEO:  GRC.  You�ve got a couple weeks to work on it, yeah.  GRC.com.  That�s where you�ll also find the show notes with the 16KB versions for the bandwidth impaired and the transcriptions by Elaine so you can read along.  This is one you probably will want to read along to, I have a feeling.  And SpinRite�s there, too.  That�s Steve�s daily bread and butter.  He has been writing that, wrote that program about 15 years ago now?  You�re at version 6?  And it�s still going strong.  Still the best, I think there is no question, the best disk recovery and maintenance utility on the market today.  If you have a hard drive, you need SpinRite.  Any good letters lately from SpinRite?



STEVE:  I got one cool one.  It�s from a guy who said, �I�d like to thank you for SpinRite 6.  I was handed a computer with a completely dead hard drive from a Catholic parish.�  He says, �I tried two other tools which ran in Windows.  Both locked up at about 60 percent into the test.�  He said, �I then put these aside and bought SpinRite.  I had been meaning to buy it for myself anyway, since I�m the one people seem to come begging to around here.



LEO:  And that�s who should have it, the people � you know, that�s why I have it.



STEVE:  Yeah, yeah.  He said, �It took SpinRite a long time to complete.  But when it was done, I was able to get the data off the drive.  There were some corrupted files, but the parish said I had the most valuable ones.�  He said, �This may sound strange, but I was also able to prove to them that, even though we were able to get the data back, the drive should be replaced.  Watching SpinRite work on the drive also helped me to convince them to take the time to back up.�



LEO:  Well, there you go.  Well, that was worth it, then.



STEVE:  So it was a win for everybody.



LEO:  Well, Steve, I thank you so much.  We will adjourn and then restore, return to our regular security meeting in a week, on Thursdays, as always, by hook or by...





Copyright (c) 2006 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#71

DATE:		December 21, 2006

TITLE:		SecurAble

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-071.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  This week Steve takes the wraps off his forthcoming security freeware utility:  SecurAble.  Although he's still working to get it finished, tested, and ready for initial release, Steve describes what SecurAble will do and some of the unexpected hurdles he�s encountered with the application and with details of Windows operation along the�way.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 71 for December 21, 2006:  SecurAble.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Dell.  For this week�s specials, visit TWiT.tv/dell.



Time to talk about security.  And even though the holidays are fast approaching, Steve Gibson insists that he�s going to catch TWiT.  And so when TWiT�s off, Steve goes crazy and says, �Let�s do another one.�  So we�ll do two today.



STEVE GIBSON:  I think we�re only 10 weeks behind; right?  Did you just do #80?



LEO:  Just did #80.



STEVE:  Yeah.  In fact, I participated in #80.



LEO:  That�s right.  It was very nice to have you.



STEVE:  It was fun.



LEO:  Yeah.  You�re great to have on TWiT.  And I think you and Dvorak are just fun to have together, so thank you.



STEVE:  And we do have, you know, we have a different approach because I generally � I infatuate with things.  I love technology.  I�m a little bit of a sucker that way.  And John is, I mean, exact...



LEO:  He hates everything.



STEVE:  Exactly.  So I think he and I do have a sort of nice counterpoint against each other.



LEO:  I agree, yeah, it�s very good.  It was a fun show.  And if you haven�t heard TWiT 80, please download that.  We are going to take a couple of weeks off for Windows Weekly because I�m going to Mexico pretty much as soon as we finish taping this.  And then I�ll be back � Daily Giz Wiz is going to shut down for a couple of weeks after this week and so forth.  We�re going to take a little time off.  I call it �podcast catch-up weeks,� so you can catch up with the ones you�ve missed.  And there are a lot of old issues you can go back and look through.



STEVE:  That�s very good, Leo.



LEO:  I doubt very many people have heard every Security Now!, for instance.



STEVE:  It�s also interesting that I was thinking how much Vista is in every, well, is in our minds.  I mean, you and I are talking about it.  We�re using it.  Certainly you and Paul are talking about it with Windows Weekly.  Yet it�s got to be a little frustrating for so many of our listeners who are hearing about something that they don�t yet have and cannot yet get.  So on the other hand, you know, from a security standpoint we want to lay down the foundation of what I think is going to be a very important enhancement to the Windows workstation desktop platform with Vista.



LEO:  I completely agree.  So what is our topic for the day�today?



STEVE:  Well, today I want to talk about something that I�ve alluded to over the last few weeks, that I�ve been now working on for many weeks, which has turned into, as many of my things do, a much larger project than I imagined.  It�s this piece of freeware that I will be releasing.  It�s not yet finished.  But I want to talk about what I�m learning along the way because I think people will really find it interesting and because what I�m learning is significant, even though I�m not yet really sure what it means.  So I�ll explain all that.



LEO:  Okay.  That�s coming up.  But first some errata, I think, yeah.  Or follow-ups.



STEVE:  Yeah.  Well, of course, last week, right, last week we talked about TOR, the Onion Router network, which generated a ton of feedback.  And you mentioned that you even had some callers on your weekend show.



LEO:  On the radio show, yeah.



STEVE:  Now, most of the concern � well, there was some issue about the TOR technology.  And in fact we�re going to cover those questions in next week�s Q&A because we have a Q&A coming up next week.  So those I�m going to hold off on.  But the interesting ones, I just wanted to acknowledge them, were more the issue of sort of Episode #69 where we were talking about the policy, the social implications of anonymity.  For example � and I�m just going to read one person�s note because it�s sort of representative of this sort of issue that people had.



He says:  �Free speech does NOT require anonymity!  In the United States you can say just about whatever you want without anonymity, and you won�t get dragged away by the police.  There are only a few areas that aren�t protected, such as criminally threatening somebody or inciting a riot, which aren�t protected because these types of speech violate other citizens� civil rights in the process.  Conversely, a person speaking under anonymity in an oppressive country does not have the freedom of speech.  He is simply avoiding persecution from his government, but he never truly had that freedom.  I almost stopped listening to Episode 69 and 70.�



I think he meant he almost stopped listening to Security Now! forever.  He says:  �After hearing your argument and only later realized that you were parroting the bad logic from the Freenet Project website.  They�ve written software with the sole purpose of violating copyright laws and trying to justify it by boiling down a series of bad logical arguments to �You either choose between freedom of speech or copyright laws.�  Given the choice, who in their right mind would choose the latter?  I guess that�s what they�re banking on if they ever go to trial over this.  Freedom of speech does not require anonymity.  Lack of accountability for your speech or actions requires anonymity.�



So, you know, I got a bunch of postings like that.  And I wanted to acknowledge that I understand that argument.  And what we were talking about, because we were talking about in Episode 70 this whole notion of sort of infinite techno anonymity, which is what the TOR network brings us, I wanted to comment, while I completely understand what that guy is saying, and I hope I have buffered some of the absolutism of that in Episode 69 when we were talking about the fact that, for example, I have no need for anonymity.  As you know, Leo, I�ve gotten involved, for example, in my local homeowners association, and I�ve sent a number of letters out to all of the people in the association, 309 homeowners here, signing my name and putting my address on it.  Other people, because it�s gotten sort of political, have been leaving anonymous flyers on people�s doorsteps.  And my fellow homeowners have come up to me and really thanked me for my involvement and noted specifically how much they appreciated I put my name and address on my communication.  I was taking responsibility for what I was saying, which I think makes it much more effective.



But at the same time we�ve got people saying, wait a minute, you don�t need to be anonymous to have free speech, except there is that counterargument, which is, okay, there are people maybe who are shy, or who don�t feel that they have the freedom to say what they want for fear of their neighbors being upset with them.  Even that, not necessarily your government, we�re not talking about being dragged away by the police, but for whatever reason they don�t want to set their name to their feelings, yet they still want their feelings to be known.  So there are two sides to it.  I know that we sort of ventured into political territory with Episode 69...



LEO:  And obviously upset that guy.  But believe me, all you have to do is say, in an election, one of the fundamental tenets of elections is the anonymity of your vote.



STEVE:  It�s a very good point, Leo.



LEO:  And that�s all you need to say.  It�s something that�s been built into our Constitution.  It�s something that�s part of our society.  Anonymity is very important.  Otherwise, if you don�t have secret ballots � yeah.  And I hate it when people say, �But it�s safe here now.�  Well, true.  But it�s not necessarily always that way.  You�ve got to be vigilant of freedom.  You don�t just assume we�ve got free speech, we don�t have to do anything about it.



STEVE:  In fact, it�s safe here now because we have had that freedom of an anonymous ballot, where people were able to vote without any concern that...



LEO:  And it hasn�t always been that way.  There are many times in our own national history where there weren�t secret ballots, and it was an issue, things like the poll taxes.  We�ve got to fight for these things.  They don�t come automatically.  So for somebody to say, well, it�s safe to be, you know, you could say anything you want here in this country right now.  That may be true right now.  Doesn�t mean you shouldn�t continually monitor this stuff.  And when technology provides you ways to do it, you should do it.



Now, I�m uncomfortable with Freenet, as well.  I�m not running Freenet for a lot of reasons.  But I don�t think that there�s a problem with the TOR router.  I think that this is the kind of thing we�ve got to have so that we can preserve our own freedoms.  Period.  And so if the guy doesn�t like it, you don�t have to listen to Security Now!.  That�s fine.  Go listen to Rush Limbaugh.  I�m perfectly happy with that.



STEVE:  Well, and I also want to acknowledge that there are levels and shades of gray, and that...



LEO:  Absolutely.  It�s not black and white, yeah.



STEVE:  Right.  I can really appreciate that there are people, for example, very active people in GRC�s newsgroups.  I have no idea who they are.  I don�t care who they are.  They�ve established an identity.  They are completely anonymous.  And that�s just fine because over time I�ve learned who these people are based on their handles.  We have provided the ability to prevent handles from being spoofed.  GRC prevents that from happening, as I mentioned in Episode 69.  So it�s like they�re entirely effective.  And if they would rather not use their name, I�d rather hear from good people who take the option that the Internet provides in all kinds of ways of being unknown.



LEO:  Let me ask you the question that our caller on the radio show asked because I thought it was kind of an interesting question.  He listened to the TOR router show and clearly understood it.  And he said, but one thing bothers me is, let�s say a governmental agency wanted to infiltrate the TOR router, put lots of TOR routers online, and then hoped to, at least from time to time, make their router the last router on the TOR routing.  Wouldn�t they be able to see your message in the clear?



STEVE:  Yes, that�s absolutely the case.  They would be able to see the final decryption of your TCP traffic as it was leaving and returning from that last router in the anonymizing network.  So it�s not providing encryption.  Now, of course you could create an HTTPS, that is, an SSL end-to-end encryption, so you�re encrypting everything yourself so that � between you and the remote site.  So that would create an encrypted tunnel that was then being anonymized by the TOR network.  But there has been � people have noticed a couple things about TOR, and we�ll be covering it in some more detail next week.  For example, if you had a malicious TOR router as, as you said, the last router in the onion chain.  Then there are different things it could do.  It could even use cookies and JavaScript and inject stuff back into your browser, which could potentially then, for example, if it was able to inject JavaScript in pages you were retrieving, JavaScript could run in your browser and reveal your IP back through that connection.  So there are potentially bad things that could be done.  But the technology of encapsulating encryption, as we discussed last week, in this onion, it�s very effective for anonymity.  A high percentage of routers could be compromised, and still anonymity would be protected.



LEO:  So the thing to understand is that TOR is not about encryption.  It�s about protecting anonymity.  And the way it does � and people have to understand that, even if you use encryption, very sophisticated traffic analysis programs exist that can deduce a lot about what�s going on just by watching who�s talking to whom when.  So that�s what the TOR does.  It doesn�t encrypt your data.  It hides who�s sending what to whom.



STEVE:  Correct.  And in fact one of the things that � there�s a really neat page on the TOR site which talks about the problems that they acknowledge the network still has.  We talked about how, for example, all the packets being exchanged are padded out to a fixed length so that you cannot use packet length analysis in seeing traffic coming in and going out of a single TOR node in order to associate them.  But because TOR is a relatively low-latency network, that is, they want the thing to still be functional and useful, the routers do not introduce random delays, that is, in how long they hold the packet before routing it.  If routers sucked in packets and waited random lengths of time before sending it on, then you would not be able to use timing analysis with any � essentially it would really render timing analysis fruitless.  On the other hand, it would introduced tremendous end-to-end delays as the traffic moves through the network.  And so that would be a different problem because it would then drop the usability of the TOR network.  And it turns out that their feeling is, okay, we need some tradeoffs here.  And keeping the network fast enough to use, rather than it just being useless because it�s too slow, is better than not having people use it at�all.



LEO:  Right.  All right, any other past items we want to�cover?



STEVE:  I think we�re ready to go on to talk about what I�ve been doing for the last month, essentially.



LEO:  Before we do that, I just want to acknowledge some of our fine sponsors.  I think this may be the last week we�ll hear a Dell ad.  Maybe there�ll be one more.  They�ve been so good and so supportive to us.  It�s been a great three-month run, and we do hope they�ll come back.  And I also want to thank all the folks who bought Dell equipment through our links on the TWiT page because we got credit for each and every one of them.



All you�ve got to do is go to TWiT.tv/dell.  Even if you don�t see something on the Leo�s Picks Page you want � the Picks Page is just stuff that I�ve recently bought � you can click any of the links there, go to Dell.  If you�re in the U.S.  And I get a number of emails saying, oh, I�d like to support you from Canada or Australia, or Dell�s all over the world.  They only count U.S. purchasers.  So go ahead and buy your Dell equipment, but you don�t need to go through our site if you�re outside the U.S.  If you�re in the U.S., I�d appreciate it if you�d go through that site.  TWiT.tv/dell.  Thanks to you and to Dell for supporting the TWiT network.



Also thanks to our long-term sponsor, Astaro Corporation.  We�re so glad to welcome them back for yet another year of support of Security Now!.  They really � they were the first advertiser on the TWiT network.  And signing another year-long deal really shows their commitment to Security Now!.  And I just am so grateful to them.  And it�s a good relationship.  They make one of the best security gateways out there, the Astaro Security Gateway.  Open source-based, powerful.  If your small or medium business network needs superior protection from � listen to what it does � spam, from viruses, from hackers, complete VPN capabilities, intrusion detection, content filtering, and an industrial-strength firewall, and it�s all in one single easy-to-use high-performance appliance, this is it for you.  Contact Astaro, Astaro.com, or call 877-4AS-TARO to schedule a free trial of an Astaro Security Gateway appliance in your business.  They�re great.  It�s a great product.  We�re glad to have them on the Security Now! show, and we thank them for their support.



So what is this program you�re working on?



STEVE:  Well, this is an outgrowth of a discussion you and I had about a month ago, I guess, when we were talking about 32- versus 64-bit security in the forthcoming Windows Vista kernel.  You may remember that we made the mistake briefly of saying, well, you know, nobody has 64-bit systems.  Those are big iron server platforms.  And so the whole notion of the enhanced security that Vista offers users of the 64-bit kernel, which is significant and can be significant, we sort of saw that as being off in the distance.



Well, you got a bunch of mail; I got a bunch of mail.  People were saying, wait a minute, I�ve got 64 bits now.  Certainly there�s lots of AMD 64 users who have personal workstations that are already 64 bits.  Now, they may be still running, and they probably are in most cases, the 32-bit Windows XP kernel because, as we know, compatibility of hardware device drivers has been a problem historically.  A 64-bit XP kernel has existed for years, yet its adoption rate has been very low because there just hasn�t been a demand for it.  There�s the same sort of chicken-and-egg thing.  The manufacturers aren�t doing 64-bit drivers because the users are not demanding them because they�re not running 64-bit XP, but they�re not running 64-bit XP because there aren�t 64-bit drivers for the things they want to do.



So certainly this is going to be solved moving forward because 64 bits really does begin, as we have seen, to give us substantially better kernel protection.  As we�ve said before, Microsoft has been forced, in the name of backward compatibility, to not fix a lot of things they could fix in the 32-bit version even of Vista because it would break things that are coming forward from XP.  Instead they�ve said, okay, we�re going to make the really robust security enhancements that we wish we could make over on the 32-bit platform, we�re going to make those on the 64-bit platform.



So the point was, after all that, I poked around and did some research, wondering, okay, how prevalent, how pervasive is 64-bit support?  And what I learned was that, in fact, as people who wrote to us were correct in saying, not only are the obviously AMD 64 chips 64-bit capable, but Intel has a technology they call EM64T, which is full 64-bit support, which they�ve been shipping for years � not 10 years, but two or three...



LEO:  Some time.  I remember talking with Andy Grove, and he was so mad that Microsoft wasn�t supporting the 64-bit capabilities of their processors.



STEVE:  Well, exactly.  So what I realized was many people who�ve been purchasing computers recently, in the last few years, may in fact have 64-bit support and not know it.



So, okay, so there was that.  Then there�s this whole issue of software versus hardware DEP.  DEP is the Data Execution Prevention technology which � and this is where I�m going to spend most of our time today, talking about the significance and the quirky details of that, which are beginning to be revealed as I�m actually messing around with this stuff, and through a whole bunch of our great newsgroup posters over in GRC who have been messing with a couple of the early releases of this software already and sort of getting themselves revved up and finding out what�s going on.  So there�s an issue of hardware versus software support for preventing buffer overruns.  And that�s certainly a very important security feature.  And then finally we�ve talked about the VMX, or as AMD calls it � no, wait.  Is it VMX?  It�s something like that.



LEO:  I can never keep track of all these acronyms.



STEVE:  I know.  Intel calls it VT.  But in either case, they are compatible � these are the virtual machine extensions which are now being supported, just now being supported, I mean, Parallels now supports it.  I heard that Virtual PC, Microsoft�s product, now supports it.  Essentially, this allows virtual machines to run at identical performance as the host OS is.  It�s a tremendous performance boost.  And Microsoft has made noises � as far as I know these are unofficial noises � that they will be able to use the virtual machine enhancements in a future version of probably, and I�m assuming only, the 64-bit version of Windows Vista, maybe 32, I just don�t know.  But they�re talking about introducing a hypervisor technology to further lock down the kernel.



Because as we have talked about recently, Microsoft�s Kernel Patch Prevention, the KPP, or also known as PatchGuard, it doesn�t actually prevent patches.  As we�ve seen, every five to 10 minutes it checks to see if there have been any.  And if so, it just shuts Windows down.  So it turns out that that�s what Microsoft is doing now.  Ultimately they should be able to literally lock the kernel using a hypervisor, that is to say, something running at a level even lower than the kernel.  Well, that�s got to be the hardware, which is now becoming available.



So what I realized, pushing back from this, is there are three things which are really important security hardware features: whether your chip has 64 bits; whether it supports hardware Data Execution Prevention, DEP; and whether it has the virtual machine extensions.  And so I started to write a program called SecurAble, which is how securable is your system based on the hardware capabilities?  And so what SecurAble does is it�s going to be a piece of freeware, probably available in a couple of weeks.  It�s running.  Newsgroup people have been using it.  I�m pursuing the final details.  As is often the case, it�s ended up being more interesting than I expected because of how much I�m learning about what�s going on inside of these chips in order to really make this be a really cool little turnkey robust utility, like I like all my little freeware stuff to be.



So what SecurAble does, it�s, I don�t know, it�s like 26K or something, all in Assembly language, of course, although it�s going to be bigger because I�m digitally signing it.  And as it turns out, I have had to write a kernel driver for this also, which will be digitally signed.  I did verify, by the way, Leo, we were talking actually last week in Toronto about whether Microsoft�s requirement that Windows 64 � oh, no, it�s all Vista.  It�s Vista drivers, all Vista drivers � no.  It can�t be all the...



LEO:  We were talking about the issue on 64, whether Microsoft had to sign the drivers or just anybody sign the�drivers.



STEVE:  Exactly.  And it�s not 32 bits because that would break everything.  It�s just 64-bit.  So Microsoft in Windows Vista, and I think it�s also the case in 64-bit XP, is that only signed drivers will be loaded by the kernel.



LEO:  But signed by whom is the question?



STEVE:  I did verify Microsoft has a certificate that you can freely download from them which knows about your existing Authenticode certificates.  For example, I have a digital certificate, cost me about $500, which I get from VeriSign.  And that allows me to sign my EXEs so that they�re recognized by Windows.  One of the things that Microsoft has been doing is they�re beginning to raise the bar in cautioning users about running code they�ve downloaded from the Internet.  And my older freeware, if you�download it and run it, it�ll always pop up a dialogue because it...



LEO:  I�ve seen it, yeah.



STEVE:  Well, I mean, on anyone�s software, typically any freeware that you download, Microsoft tags it that it�s from the Internet and so pops up a dialogue saying, hey, this is an unknown publisher, are you sure you want to run this?



LEO:  You see that a lot.  And this is in 32-bit as well as�64-bit.



STEVE:  Yes.  And again, so we�re seeing this now in current versions of XP, for example.  So signing this means that, when you download the software, you still get the dialogue.  But instead of saying �Unknown Software Publisher,� it says you�ve downloaded something from Gibson Research Corporation.  And so it authenticates that that�s where the software is from.  It�s also doing a full cryptographic verification to confirm that there�s been no modification to that executable from the time I signed it until it was checked in the user�s machine.  So it really does provide good authentication and integrity checking for that.  And I think you�re able to say, �Always trust software from this publisher.�  You can certainly say �Don�t ask me about this specific program every time I run it.�  And so you�re able to say, okay, yeah yeah yeah, we know who Steve is, we like his stuff, we�re going to run it without any questions.  Or you can say, well, ask me, but only ask me the first time I run stuff that we download from GRC or whomever.



So the point is that that authentication is extendable using another certificate which is freely downloadable by Microsoft.  You sort of double sign this with Microsoft�s certificate and with the one that you get from VeriSign or any of the other people who provide this Authenticode certification, and then without any further involvement of Microsoft you can sign drivers.  And so, and I�ll know all about this firsthand because this is what I�ll be doing here very shortly.  So SecurAble...



LEO:  So it�s free, is the key, though.  You don�t have to pay Microsoft a bunch of money.



STEVE:  Well, yes.  There is that...



LEO:  Do you have to get an Authenticode license?



STEVE:  Yes, so it�s not free.  And this is being controversial out in the open source community...



LEO:  Yeah, because if I�m a free program, I have to � how much is the Authenticode certificate?



STEVE:  It�s $500.



LEO:  Hey, hey.  Geez, Louise.



STEVE:  And in fact it might even be more.  I might have paid $799.  But I think I got it for many years.



LEO:  That�s dumb because that�s going to discourage shareware authors, I have to say, and certainly open source�authors.



STEVE:  Well, here we are faced with a tradeoff.  First of all, the 32-bit systems will continue to work as before.  So it�s only the 64-bit systems that have the burden of requiring signed drivers.  The flipside is that certainly � I mean, it�s raising the bar.  What�s annoying, it�s sort of like airport security now.  It�s not clear that you are absolutely secure after putting up with all this because you could imagine that somehow credentials are going to get loose in the world, and there will be malware which will be signed.  You can imagine that the malware authors are going to find a way to get their junk signed if that becomes important in order for them to be able to make this happen.  And you could argue then that � and this is the argument that�s being made, is that, as you say, it�s the open source, the free source guys who are going to be inconvenienced because the whole idea is they want this to be a free and inexpensive platform.  And in fact I think that�s one of the points that�s being made by � you mentioned it yesterday on TWiT, Leo, or in last Sunday�s TWiT, that the Free Software Foundation had launched a campaign against Vista.



LEO:  BadVista.org, yeah.  Bad Vista.



STEVE:  BadVista.org.  And this is one of the issues they�raise is that it�s becoming more and more hostile to free�software.



LEO:  You shouldn�t have to pay a Microsoft tax to be a software developer.  It�s going to backfire on Microsoft.  I don�t think they understand how important � it certainly is on the Mac side, and Linux � these independent, you know, people like you who want to develop good, free software.  And, now, you can afford to buy an Authenticode certificate, but not everybody can.  That�s going to kill that entire ecology.  And that�s important.



STEVE:  Well, you�ll get a kick out of this, Leo.  For the longest time, I mean, I�ve had Authenticode certificates for years.  And I�ve never been able to get myself to use them because they increase the size of my code by 4K.



LEO:  They double it.  Oh, okay, 4K.  So from 26 to 30K.



STEVE:  It just bugged me.  It�s like, okay, it�s another chunk of bloatware.  It doesn�t have to be � there�s nothing that needs to be 4K.  It doesn�t have to be a big thing because there�s nothing large...



LEO:  It�s probably a GUID, probably not much in there.



STEVE:  Well, there was some discussion of this in our newsgroups recently.  And I mentioned that, when you put in a minimal PGP signature on a piece of email, that�s not a 4K blob.  It�s a couple lines of little cryptic-looking stuff.  That�s all you need in order to have a publicly signed hash of some content.  So anyway, it�s people who don�t care about size end up with big things.  And so that�s what Authenticode is.  So...



LEO:  Anyway, that�s BadVista.org, if you want to read more�about that.  And I�m kind of in their ball- you know what�ll happen is just people won�t do open source software�for Vista.



STEVE:  Well, arguably, though, to take the flipside, because I think it�s important we look at both sides, it will increase security.



LEO:  Yeah, and I understand that.



STEVE:  Requiring signed drivers, requiring that somebody�s name be on this...



LEO:  So give away Authenticode.  Have a free Authenticode certificate for free and open source developers.



STEVE:  You could imagine that, like, SourceForge would have something like that.



LEO:  Maybe that�s what they�ll do, yeah.



STEVE:  But the problem is, as soon as you do that, as soon as SourceForge gets together and does a single certificate that everyone uses, well, then it�s completely available to the hackers.



LEO:  That�s a good point, yeah.



STEVE:  This is, for me, my Authenticode certificate is my private key.  It is a private key that is associated with Gibson Research Corporation.  I protect it dearly.  I would never want to lose control of this because it would allow bad people to claim that their software was from me.  So it is something that I keep locked up tight.  It is in its own�encrypted location, and protected, and I treat it very�seriously.



LEO:  As you should.



STEVE:  So the problem is, if we end up with Authenticode credentials which are floating around freely � and we know it�s going to happen, a couple years from now when it becomes important that�ll happen � then people are going to have to start looking at who it is that signed this, not assume that anything signed is good, and then we�re going to�have to have revocation lists that say these are the known bad keys which have gotten away and which malware is being signed with.  So again, it raises the bar.  It�s an inconvenience for people.  It�s not a black-and-white perfect solution because there isn�t one.  But it�s probably a good thing to do.  Oh, and you can disable this administratively, and you can enable it on 32-bit systems�administratively.



LEO:  Oh, you can.



STEVE:  Yes.



LEO:  Oh, I�m going to make a note of that.  So you don�t have to run 64-bit Windows to have the benefit of this signed code.



STEVE:  And now I have to back off from that because I�m not sure if that�s only developer � if that might be the development build.  You can imagine that developers don�t want to have to be continually signing their code while they�re debugging it.  So it may be that the debugging build�is...



LEO:  Well, I�m more interested in the ability to turn it on than the ability to turn it off.  I could see why they�d want to turn it off, but turning it on is great.



STEVE:  It�s absolutely the case that 32-bit XP and 32-bit Vista, XP and Vista can require all drivers be signed.



LEO:  I think that�s great.  We need to publish the code required to do that.  I think that�s fantastic.  For 32-bit, turn it on in 32-bit, you�ll be much safer; right?



STEVE:  Well, the problem is, since it�s never been on by default, no drivers are signed.



LEO:  Oh, that�s true.  So you�ll have the same compatibility issues that you�re going to have in 64bit�anyway.



STEVE:  Yeah.  Now, it�s interesting, though, because the signing technology is not a big deal.  You know, if I were really uptight about this, I could sign other people�s drivers just so that they have a signature, then turn that on in XP.  And then if anything else, if any hostile junk tried to get itself installed, it would be blocked.  And then I could say, wait a minute, what�s this that I have not�signed?



LEO:  So an advanced user could have his own certificate.  Would he have to have the Authenticode, or could he just use the free one from Microsoft?



STEVE:  No no no.  The free one from Microsoft goes hand in hand with...



LEO:  You still need Authenticode.



STEVE:  Yes, with a commercially purchased certificate.



LEO:  But a business � here�s a good use for it.  A business, the IT department could purchase one certificate, sign acceptable stuff, turn this feature on in 32-bit, and then nothing else will run.



STEVE:  Yeah.  And that�s something that you are able to do at the � what�s the name in Windows for the whole bunch of extra settings that IT can control?  It�s not...



LEO:  Oh, Policy Editor.



STEVE:  Yes, it�s in Group Policy Editor.  That�s where you�re able to set a policy.  And it could be pushed out corporate wide.



LEO:  I think that�s good.  That is a very smart thing to do if you�re in an IT department.



STEVE:  It�s a cool trick.  It�s worth mentioning, though, you were talking about how I can afford Authenticode because, you know, this is what I�m doing, because for me certainly as GRC, having my stuff signed is important.



LEO:  You�re a business.



STEVE:  But it�s not like it�s really that free even now to develop for Windows.  It�s like, well, yes, you can write code.  But I pay Microsoft $2500 a month...



LEO:  A month?  A year.



STEVE:  I mean, I�m sorry, a year...



LEO:  Oh, boy.



STEVE:  ...a year for the MSDN package, which is a big blob of DVDs which they are constantly revving...



LEO:  Do you have to have that?  Couldn�t you just buy Visual Studio?  Do you have to have the full MSDN library?  Is there that much new stuff that you need to have?



STEVE:  No, you�re right.  What I�m getting � you�re exactly correct.  What I�m getting is, like, all the OSes and all the versions of everything and the developer tools.  You�re right.  You could get a just...



LEO:  Just buy Visual Studio.  But that�s still...



STEVE:  Their development stuff.



LEO:  That�s still expensive.  I mean, it�s not cheap.



STEVE:  No.  In fact, they�re increasing the price, and they�re, like, changing the way it works.  It�s many hundreds of dollars for that.  So...



LEO:  I may be wrong, but I just think that an operating system relies quite a bit on these independent, third-party, sometimes very small developers, including open source and free software developers.  Those are important.



STEVE:  Well, and the developer community has got all these tools that are available, too.  So there are free compilers; there are free libraries.  You can definitely do it on the cheap.  But if you go the normal sanctioned route, it�s already not free to write software for Windows.



LEO:  You�re right.  Good point.



STEVE:  So anyway...



LEO:  Which, then, by the way, the complete opposite on the Mac platform.  They give you all that stuff.



STEVE:  No kidding.



LEO:  Yeah.



STEVE:  Oh, very cool.



LEO:  It comes on your install disk.



STEVE:  Well, and for example, there have been other compilers than Visual Studio.  Watcom was available; certainly Symantec has made a compiler for years.



LEO:  But they�re all dead now because everybody uses Visual Studio.  I know AnalogX still uses � Mark still uses Watcom.  But still, most people...



STEVE:  He�s off blazing his own trail.



LEO:  Does he still use Watcom?



STEVE:  As far as I know.  I can�t imagine him changing.



LEO:  Because it hasn�t been updated in ages.



STEVE:  Yeah, but it works.



LEO:  And he�s got all the macros and the libraries and everything.  He just doesn�t need anything new.  All right.��So...



STEVE:  So what SecurAble does is � and this will be the forthcoming freebie from me.  It�s only a couple weeks away.  I�m just nailing down details at this point, and there�s some issues of chip identification because I wanted to tell people exactly what kind of processor they�ve got running in their system.  What it does when you run it is it shows you three things about your system, about the system it�s running on:  whether it does have 64-bit emulation technology, which Intel calls EM64T; or whether it�s a 64bit AMD system that might be running in 32-bit mode so you didn�t know it.  So that would tell you whether, at your choice, you had the option of running either 64-bit version of XP or the forthcoming 64-bit version of Vista that will definitely give you much more security.  I know that you said in TWiT last week, Leo, and we talked about it also up in Toronto, you�ve got the 64-bit Vista, and you�re rubbing your hands together, getting ready to load it and see how it�goes.



LEO:  That�s my project today.  In fact, I�m just, right now, as we speak, Drive Snapshot is making an image of my Vista 32-bit off the laptop so if it really is a horrendous experience I can quickly go back to 32-bit.  And I�ve got the Vista 64 disk sitting right in front of me.  Huge, though, by the way.  You need a DVD.  It�s almost 4 gigs.



STEVE:  Yes, it is a lot big- well, and even 32-bit is 2.678�gigs or something, so...



LEO:  Is the 64-bit code inherently bigger?



STEVE:  What I�ve heard, and this is just anecdotal, I�ve heard that the 64-bit system for whatever reason also includes 32-bit versions of all of the apps in addition to 64.  So you�re getting double the trouble, essentially.  You may get there before I do.  I very much want to be running this.  In fact, I probably will have to before I�m able to put the 1.0 version stamp on SecurAble.  My supposition, though, is that Microsoft has accumulated so many drivers for existing PC hardware that certainly Vista 32 knows all about the hardware that I�ve exposed it to so far.  It�s running on all kinds of stuff.  Even an old tablet PC, my old HP TC1100 is running it perfectly.  So I would imagine that Microsoft has taken all of those drivers, compiled them in 64-bit version, and that the 64-bit Vista may be very hardware compatible, which would really help it a lot.



LEO:  Wow, very interesting.



STEVE:  So SecurAble will tell you when you run it whether you�ve got 64 bits hiding in your chip that you may not know, that would allow you to run the more secure 64-bit version of Vista, or for that matter the current 64-bit version of XP.  It�ll tell you whether you�ve got hardware DEP.  Now, DEP is, I think, the single most important security feature to happen in a decade.  I�m not kidding.



LEO:  Data Execution Prevention.



STEVE:  Yes.  What this is � and we�ve talked about it in passing, in fact you and Paul talked about it, it was one of the title acronyms in last Windows Weekly a couple weeks ago�� what this does is essentially it allows the system to stop virtually all buffer overruns.  And that�s big.  I mean, all the security problems that we encounter with incredibly small exception are buffer overrun attacks.  Anyone who�s been listening to Security Now! for the last 71�weeks has heard buffer overrun, buffer overrun, over and�over and over.  These are the kinds of problems which catch programmers.



And we�ve talked about how the stack works.  And as a consequence of the way it works, if somehow it�s possible to inject a longer string of data or a longer response into some sort of control that isn�t expecting that, that doesn�t specifically limit it and clip it off � and more often than not it�s something the programmers have to deliberately do � if something�s able to do that, it�s possible to cause the computer to be remotely compromised.  And every second Tuesday, I mean literally every second Tuesday of the month, Microsoft is patching multiple buffer overrun problems.  They�re just all over the place.



So the idea is, the architecture of our computers is based on 4 Kbyte, what�s called �pages� of memory.  And the idea is that this system deals with memory in these 4K pages.  It�s 4 Kbyte pages which are swapped out to the virtual memory partition as the system is shuffling its memory around.  Everything is done in these 4K pages.  These pages are controlled by the system�s memory management system, which knows which pages are swapped and which ones are out, where they�re physically located in memory.



Traditionally pages have had bits associated with them that sort of governed what the system could do.  There were read permission and write permission bits which individually allowed, on a 4K page granularity, it allowed a 4K page to be marked as readable and/or writeable.  So it was possible for the system to protect pages from being written and make them read-only, or to protect them from being read, for example, and make them write-only, although that�s not commonly done.  And essentially, whenever any code � and this is enforced at the hardware level, that is, in the chip�s silicon, which is what makes it so powerful � any code that violated the rules that had been set by those bits governing that page would generate a hardware exception, as it�s called, that would yank control instantly away from the program that had misbehaved and transfer control to the operating system along with information about what exactly it was that had just happened.



LEO:  So it doesn�t shut the system down.



STEVE:  No.



LEO:  It just takes control away.



STEVE:  Yes, it just says �bad code.�



LEO:  Bad code.



STEVE:  Bad code.  So what has happened is, recently, and this is only in the last couple years, Intel and AMD have added another bit to the page management system.  In addition to read and write permission, there is now execute permission.  And this is huge.  I mean, it is such an obvious thing.  It�s the kind of thing, it�s like why didn�t we have that 20 years ago?  I mean, it would have been trivial to put in, just didn�t occur to anyone.



LEO:  Well, there wasn�t a problem 20 years ago.



STEVE:  Okay.



LEO:  Or was there?



STEVE:  Well, there was 15 years ago.  Yeah, there�s always been a problem.



LEO:  I guess.  It�s just bad code.  If it�s not a hacker problem, it�s just a problem.



STEVE:  UNIX predates Windows.  It�s 20 years old.  It�s had rootkit problems from day one.  And those have been buffer overrun exploits.  So it�s always been a problem.



LEO:  It�s bad programming.  It�s things like using STR copy instead of STRN copy.  There�s no range checking.  It�s sloppy programming.  That�s what gets me.



STEVE:  Well, I don�t mean to disagree with you.  But as a programmer, I can tell you that, I mean, nothing...



LEO:  Well, you�re in Assembly code.  You�ve got no range checking unless you write it by hand.



STEVE:  Well, yes.  But I live in fear that I�m going to screw up.  My point is that it is so easy to take your eye off the ball for just a minute.  And the idea, when we talked about several weeks ago why is security so hard, it�s that the programmer�s, the developer�s mindset is �get this thing to work.�  Now, I have a heavy layer of � and it better not have any security flaws in it.�  And certainly any conscientious programmer who�s writing Internet code today has got to be aware of security.  That�s going to be in the forefront of their mind.  That�s going to be a focus for them.  So certainly they�re aware of that.  But it is easy to make a mistake.



LEO:  All right.  I�ll be charitable.



STEVE:  So here�s what�s cool is that when the system supports DEP, all of the pages which the system does not�expect to have code executing in can be marked as nonexecutable.  So...



LEO:  That would be the stack, for one thing.



STEVE:  It�d be the stack.  It would be something called the��heap.�  A heap is something we�ve never really talked about, but it�s the way the system makes memory freely available for allocation by program.  So, for example, if I need a 4K buffer, I�ll allocate a buffer.  I can allocate it from the stack, or I can allocate it from the heap.



LEO:  Now, unfortunately, a lot of programmers put executable code in the heap.  It�s not an unusual technique.



STEVE:  Well, I wouldn�t say �a lot.�  I mean, it certainly is the case that it can be done.  And...



LEO:  Even in the stack, I mean, there are some.  And that�s why those programs break when you use DEP.



STEVE:  Well, yes.  And historically, in fact, the very early Windows GUI, when processors were 4.77 MHz, and we were trying, it was just painful to drag a window around the screen � in fact, you didn�t drag the whole window.  You just dragged a little dotted outline because you couldn�t drag the whole window.  It would have just been really excruciatingly slow.  Back then, Microsoft�s clever � there was a thing called a bitblit instruction, or the blitter is the thing in old GUI terminology that moves rectangles of pixels around the screen.  The blitter was actually written on the stack on the fly in order to make it as fast as possible.  So old Windows actually, by policy and by technology, used the stack as an executable scratchpad.



So it turns out, though, that many programs no longer do that.  And as you said, Leo, it�s true that some do.  It�s certainly the case that virtually all exploits are buffer overrun mistakes, which all would be caught if the system had hardware data execution prevention.  So, and it turns out that many of the chips introduced in the last few years have it.



Now, what we�re learned, however, is a couple things.  Many of the BIOSes that the people in our newsgroups have, on systems that have hardware data execution prevention, they�ve got an option in the BIOS for turning it off.  And in fact, I bought a little HP Pavilion here not long ago, it has the option for turning it off.  At least mine was on by default.  Many people are finding that theirs is off by default, meaning that at boot time the BIOS disables the hardware data execution prevention option in the chip, such�that when the computer looks at it, it believes it�s not present.



So anyway, it turns out that there�s something called model-specific registers, MSRs, which is what the BIOS uses for turning this off.  User mode code, that is, like my program SecurAble, is unable to access the model-specific registers from user mode without blowing up.  It generates a data exception error, and it will shut down the program.  So I�m unable to see from user mode whether this bit has been set or not.  Thus I�ve written a kernel mode driver which SecurAble brings along with it.  It�s still a single EXE, it�s still small, it just drops it out of the bottom of itself, briefly loads it in the kernel and checks the model-specific registers, sends that information back up to my little SecurAble app, and then removes the driver.  So it�s just installed in the kernel briefly.  In a blink it�s removed.  And that allows me not only to tell users whether the system can see whether they�ve got data execution prevention, but also whether they might actually have it, if they think they don�t, but their BIOS is one of those which defaults to having it disabled by default.  So anyway, I�ve rolled my sleeves up...



LEO:  No kidding.  This sounds like sleeve-rolling time.



STEVE:  Yeah, it�s been sleeve-rolling time.  So basically it�s going to be a complete presentation of these three security features:  whether you�ve got 64 bits, whether you actually have hardware DEP support, and whether your system supports the virtual technology extensions.  And it turns out, though, that this has also sprung into a second piece of software, which will be called � I think it�s going to be called "inDEPth", and that�s going to be something that�s going to verify all these DEP things for users.  That is, it�s one thing to know your system has the capability.  It turns out, though, that this DEP has many different modes of operation, and some of this is very mysterious.  For example, you can run it, as you mentioned about opting in and opting out, there are opt-in and opt-out modes.  The opt-in is the normal case, and no things are opted in except some of Windows binary, some of Windows code...



LEO:  That they know won�t run unless you turn it off.



STEVE:  Well, no, that they know will run...



LEO:  Oh, by default, I see.



STEVE:  Yeah.  So their binary, some of theirs are enabled for DEP because they know they�re safe, and they would like any buffer overruns that occurred in them to be caught.  But, for example, rest of the applications, lots of applications and ActiveX controls are where these problems are.  It turns out that you can then use a mode called OptOut, where Microsoft says that everything not opted out of will be checked for any buffer overruns, which would lead you to believe that everything would be checked, except there�s a third mode called Always On.  And it turns out � get this � that you would think that Always On would be the same as Opt-Out, if nothing had opted out.  It�s not.  Many people have discovered that there are programs they use which work fine with Opt-Out but do not work with Always On.



LEO:  Why not?  So they�re not checking those programs?



STEVE:  It�s a mystery.  My hypothesis is that the optin/opt-out might only be checking the user mode buffer overruns and not device drivers.  But when you use Always On, it�s checking everything system-wide, and there are device drivers where there are problems.  For example, the�current build of Ad-Aware fails this.  Users in our newsgroups are posting their findings as we�re experimenting with this.  I will have a complete comprehensive presentation to offer our Security Now! listeners a few weeks from now, once I�ve unraveled all these mysteries.  But what�s interesting is there is zero documentation of this on Microsoft�s site.  I mean, we have been scouring, looking for any explanation, for example, for why Always On is different from Opt-Out, where nothing opts out.  And Microsoft says nothing about it.  So it�s going to end up being, okay, do a bunch of experiments, figure it out the hard way.  And that�s what I�m going to do.  So anyway, I�m having a ball writing some new free software that arose from Security Now!, and it�ll be made available to everyone, and certainly to all of our Security Now! listeners.



LEO:  Excellent, excellent, excellent.  Absolutely free, as always.  And a lot of nice features, it sounds like.  In fact, it sounds like the kind of program you�d want to run just to kind of know what�s going on in your system.



STEVE:  Well, and one other thing, too, is that people have mentioned, hey, you know, they could send this to someone whose computer they were going to purchase, or you might be able to get a dealer to run it.  Or if some...



LEO:  Tell me what I�m buying here.  That�s a great idea,�yeah.



STEVE:  Exactly.  If a friend of yours said, hey, I just got a really cool system, you know, from Dell, for example.  Someone could say, hey, well, run OptOut � OptOut is a long time ago.  Run SecurAble from GRC, tell me what it says.  Because, I mean, it�s a very simple display.  It says 

�64, yes, yes� if you�ve got everything, or �64, yes, no� if you�ve got DEP but not the virtual technology extensions.  So it�s be a very super quick way of telling you some things you care about, about the security of the system you�re on.



LEO:  Right.  And we�ll look for that in the next couple of weeks.  But you�re going to take some time off for the holidays, I hope.  Please don�t work on...



STEVE:  No no no.  I�m right in the middle of this.  I�m having a ball.



LEO:  Oh, Steve, Steve, Steve.  What are you doing for Christmas, anything?



STEVE:  I�m just going home for a couple days, up to see my family in San Mateo.



LEO:  All right.  Well, Steve, as always, what a great pleasure having you on.  And I just can�t thank you enough for doing the work you do to secure us all.  I mean, it�s little things like SecurAble that really � you give them away.  And it makes a big difference, I think.  You probably don�t even know the kind of impact you have made.  But I do, and I thank you for it, and...



STEVE:  Oh, I love doing it.



LEO:  It�s been a great year of shows.  We have one more before the end of the year.  What are we going to talk about next time?



STEVE:  Well, it�s #72.



LEO:  Oh, we�re going to Q&A it.



STEVE:  It�s our Q&A #14 next week.



LEO:  We�ll do that next week.  Unlike all the other TWiT podcasts, Steve is sticking around.  And so is SpinRite.  And, you know, people have hard drive problems even on the holidays, don�t they, Steve.



STEVE:  Maybe even more so when the kids come home from�school.



LEO:  Or they get a new computer and it�s just dead on arrival.  SpinRite is the solution.  It�s the ultimate disk recovery and maintenance utility.  It�s Steve�s day job, and he works just as hard on it as he does on all the security stuff.  SpinRite.info if you want to know more.  A lot of good testimonials in there.  And of course GRC.com is Steve�s site, where you�ll find the 16KB versions of this show for the bandwidth impaired, the transcripts thanks to Elaine, and more information, as well.  GRC.com.



Copyright (c) 2006 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#72

DATE:		December 28, 2006

TITLE:		Listener Feedback Q&A #14

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-072.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 72 for December 28, 2006:  Your questions, Steve�s answers, #14.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Dell.  For this week�s specials, visit TWiT.tv/dell.



There is no rest for the security-conscious, and that�s Steve Gibson, even though here we are, just a few days after�Christmas, a few days before New Year�s, the week that almost everybody in the world takes off, much of TWiT has taken off.  No, Steve says, we must soldier on.  A Security Now! every week, whether you want one or not.  Hey, Steve�Gibson.



STEVE GIBSON:  Whether they want one or not.



LEO:  Whether you want it or not, you�re getting it.



STEVE:  Okay.  Well, I�ve got to tell you, Leo, I don�t know what it was about the last Q&A, but I�ve never had such positive feedback from people.  I think it was a � now I�m a little nervous about, oh my god, I wonder if this Q&A will be as good as the last one.



LEO:  We can�t possibly be as good.



STEVE:  People loved the mixture of questions.  They were giving me credit with selecting them.  It�s like, well, I just select them like I always do.  I don�t know why those ones turned out so good.  Actually this time we�ve got a bunch of TOR-related stuff, so there won�t be quite the diversity that we had last time.  I think that�s one thing�people liked was that there was just a really wide-ranging mix of questions.  I think they also liked that you and I just sort of hung out and took our time.  It was a 97minute episode.



LEO:  It was the longest podcast I�ve ever done, as far as I can tell.  But you know, Steve, people do, they love what you�re doing.  And so I don�t think it�s � the nice thing about a podcast, if it�s too long, just pause it or give up or whatever.



STEVE:  And I do like the way the Q&As break these episodes, you know, we have some that are highly topical, focused on just one thing.  And I think that�s good.  I got a lot of people who said, my god, I can�t believe you explained TOR with no diagrams or pictures or anything.



LEO:  That is pretty amazing.



STEVE:  Just listening, they were able to understand the�onion.



LEO:  You�re good at that.



STEVE:  Which I thought was really � it was really fun.  So certainly there is a place for that kind of focus.  And I think our Q&As do a really nice job of mixing that up and allowing people, first of all, to feed back.  I do want to remind people that the bottom of the Security Now! page at GRC.com, just GRC.com/securitynow, the bottom of that page is where there�s a form that anyone can use, giving their name and location or not � leave it anonymous in the interest of anonymity � in order to submit questions which I receive, the server sends it to me as email, they pile up, and then I go through them and pull questions for our Q&A.



LEO:  And we�ve got a lot of good ones.  Before we get to those, though, I do want to mention that SpinRite is Steve�s bread and butter, and we do always want to give it a little bit of a plug.  Not only because it�s how Steve makes his living, but frankly because it is a must-have utility if you�ve got hard drives.  It�s really useful for people who are kind of the go-to guys for your friends and family, maybe your coworkers, when there�s problems with the computer.  I always have a copy of SpinRite in my possession for those emergency house calls.  It is the ultimate drive recovery and maintenance utility, works with all kinds of drives.  You can even � I didn�t know this, but somebody sent me a note and said it works with external drives, too.



STEVE:  In fact, I�ve got a couple pieces of email from people who have USB drives that it fixed.



LEO:  That�s neat.  I didn�t know that.  I thought that you wouldn�t be able to get access, low level enough access to the drive.



STEVE:  It�s very true that I don�t have as low a level access to the drive through a USB or Firewire interface.  And so the best way is if people can remove the drive from the case and just temporarily attach it to the motherboard.  There I have a really intimate connection.  SpinRite is not only faster, but it does have access then to much more about what�s going on in the drive.  But many times that�s not possible, so SpinRite will still do the best job it can.



It�s funny, here we are between Christmas and New Year�s, and I�ve been sharing over the last weeks some of the email that we receive about SpinRite success stories.  I thought, since this is sort of a special holiday episode, I would share a wacky one that I received.  It�s literally, the subject of this email, I just recently received this, it was �Steve, your SpinRite software got me fired.�  True story.  The guys says it, hyphen hyphen true story.  And first I was a little confused.  Then I realized this was this person � I don�t see his name here.  But it�s this person who is recounting a SpinRite 2 adventure he had.  So that would make it about...



LEO:  A long time ago.



STEVE:  About 15 years ago, yeah.  Anyway, he says, �This happened in Rockville, Maryland.  As a service tech in the MFM/RLL days� � so of course that�s Modified Frequency Modulation and Run Link Limited are those acronyms.



LEO:  I remember those.



STEVE:  Yeah, remember those, MFM, yeah.  He says, �I was called to an old people�s community organization.  Their disk needed a low-level format.  The nice old lady said, �Thank God you�re here....��  And actually this guy writes really well, which is the other reason I wanted to share this.  Says, ��Thank God you�re here,� begging me to fix her computer, and told me of all the sad terrible things that would happen to the old people if their data were lost.  Being newly hired by the service company, I was accompanied by a senior tech from the same outfit.  He was happy I recognized that the drive needed a low-level reformat.  I got out my trusty personal copy of SpinRite 2.  The other tech had never heard of nondestructive low-level formatting.  �See, this reads the track before reformatting it, then it formats the track, instead of writing zeroes as sector data.  It uses the original data so they don�t lose any.  Isn�t that cool?� I said.�



LEO:  It is cool.  That was always the best thing about�SpinRite.



STEVE:  It was very cool.  And so he says, isn�t that cool, he says, wide-eyed and innocent.  Okay.  �Then the other guy, the senior tech says, �But won�t that take twice as long?��  And he says, �I looked at the old lady wringing her hands hopefully on the other side of the room.  She couldn�t hear us.  �It will take 20 minutes instead of 10, but will save their data.�  I assumed it was a no-brainer.  �No,� he said.  �This is a service contract.�  �So what,� I asked?  �So we already have their money, just format their drive, and we can bill that 10 minutes at the next job.  We�re not a charity organization.��



So this guy writes, he says, �I felt like I was in the Twilight Zone.  I thought about what to say.  I thought about my professors at college and how much I missed them.�  And he says, so our guy says, ��No, I can�t do that,� I said, and continued with SpinRite.  It took 22 minutes.�



LEO:  Good for him.



STEVE:  He says, �After rebooting, the system was back up, and the old lady was ecstatic.  �What�s your name, young man?� she asked.  �David.�  �God bless you, David,� she said.  Well, get this.  Afterward, out in the parking lot, we almost got into a fistfight over it, but agreed to take it to the company president.  The president agreed with the senior tech and fired me on the spot.�



LEO:  Unbelievable.



STEVE:  �There was no other reason, just this.  As I left, the other tech smiled smugly.�



LEO:  Wow, what a depressing story.



STEVE:  SpinRite got him fired.



LEO:  Oh my god.  And you know, I have a feeling that same kind of stupid shenanigans still goes on.



STEVE:  Well, it�s funny because I read to � prior to meeting with you last week, Leo, in Toronto, I met with the�Nerds On Site guys and hung out with them for a couple hours, and I shared this story with them.  I didn�t have it in front of me, but I remembered it because I had already put it together and posted it.  And I read it, I told them�the story, and they said, �Who is that guy?  We�ll hire�him.�



LEO:  Yay.  Now, I like Nerds On Site.  They�re going to buy some ads on TWiT, so I like them even more.  But that�s good to know, and that�s the kind of thing I want to hear.  I don�t want to recommend a company that�s going to look more toward the billable hours than toward the customer�s satisfaction.  That�s a shortsighted way of doing business.



STEVE:  And wouldn�t just reformatting the drive be faster than performing data recovery.



LEO:  I�m willing to bet that company is out of business and long out of business.  That is terrible.



STEVE:  We can hope.



LEO:  Cool.  That�s really neat.  I want to mention, by the way � and I forgot to mention this last week so I�ll mention it again � you know SCOTTEVEST; right?



STEVE:  Sure.



LEO:  They do great geekware, they call it �technology-enabled clothing,� with lots of pockets and places to run wires for your � they call it �personal area network� � for your headphones or chargers or whatever.  They�re just really great.  Jackets, pants, shirts and hats.  And they�ve offered us a holiday TWiT code.  Now, I know it�s after Christmas, but a lot of times people buy this stuff just for themselves.  So we�ll put a link in the show notes.  But if you go to SCOTTEVEST and you buy anything, use the coupon code TWiT.  That�ll save you 20 percent off, I think, or 25�percent off the cost.  Just a little gift from us and SCOTTEVEST to our listeners.  Now, shall we go on with the�questions?



STEVE:  Q&A #14.



LEO:  #14, starting with Dennis from Atlanta, Georgia:  So, he says, I listened to Episode 69 about the social implications of Internet anonymity.  Then I listened to Episode 70 about achieving Internet anonymity using TOR.  Then the next episode of �Numbers� on CBS is about a vigilante � wow, this is on CBS? � using onion router networks to anonymously stalk and kill pedophiles.  Seems like more than a coincidence.



STEVE:  It�s funny, I got so many of these notes that I thought, okay, I just have to mention this.  One guy said he was watching �Numbers� on CBS just after having listened to Episode #70 about the TOR network.  And he said to himself, please mention onion routing, please mention onion routing.  And they did.



LEO:  That�s so weird.



STEVE:  They referred to it by name as he�s using onion routing.  And apparently, I didn�t see the episode, but they used the analogy of putting envelopes inside of envelopes and then sending them.  And he said, of course that analogy only holds in the onion routing context so long as only the person to whom the envelope is addressed is able to open that envelope.  And he said, wouldn�t that be nice if paper mail actually worked that way.  But it was just � so for all those people who wrote, it was a bizarre coincidence.  We have nothing to do with the scheduling of programming on CBS or anywhere else.



LEO:  No.  In fact, they must have written that episode months before we did anything on it.  But I think what�s interesting is that this kind of advanced technology is now sneaking into mainstream programming, which just shows that people are more aware, and that mainstream media folks realize it�s not the kiss of death to talk about technology.  I like it.



Andy, listening from Spain, writes:  This may seem a bit morbid, but I�d love you and Leo to discuss the handling of private encrypted data, passwords, and computer-based private information in the event of our death.  I mean, today, while alive, I don�t want to give my sensitive stuff or passwords to anyone, including my wife.  But when I eventually die or become very ill, I need to make sure that  my family has access.  This makes a lot of sense, actually.



STEVE:  Doesn�t that?  Yes.



LEO:  They�re not stranded economically or practically.  Also to make sure they can wind up and close down my company in a safe and good way.  I�ve often wondered about this.  And my stuff isn�t even that encrypted.  But I know my wife wouldn�t be able to figure it out to save her life.  If I have TrueCrypted all of my data, have complex unguessable password schemes and so forth, how do I unwind all of that for the benefit of other people I care about in my life?



STEVE:  Isn�t that a great question?  I mean, I thought that really was.  Here we are, we spent 72 weeks now talking about privacy and encryption and uncrackable passwords and not writing them down and coming up with personal password algorithms and all this.  Imagine, you know, if any of us or our listeners who were actually using these sorts of approaches suddenly, god forbid, something happened to them, they were critically ill or they passed away, here�s their whole life that they�ve been deliberately working to keep out of the hands of bad guys.  Well, inadvertently it�s now out of the hands of good guys, I mean, their family, their friends, people whom they might wish had access to this.  It�s just no longer available.  So I don�t have an answer, but I loved the question.  And I thought it was worth...



LEO:  TrueCrypt allows, for instance, your password to be stored in an image file, let�s say.  Right?  And you can use that to decrypt.



STEVE:  Well, yes.  If we wanted to provide a solution, it would be that you would have any kind of � and, I mean, TrueCrypt might be overkill.  There are very nice little pieces of freeware where you can just take, like, a text file, and it will run it through symmetric encryption and just scramble it with full crypto strength.  So what you could do would be give to your attorney who has your will, or in a safety deposit box, something where access will be granted in the event of something bad happening to you without your taking any action.  And this is certainly not something that somebody who�s 15 and listening to this is even thinking about.  It�s like, aw, I could live forever.  But you know, you and I are...



LEO:  We�re thinking about it.



STEVE:  Exactly.  So anybody who�s preparing a will, who has a will, who�s taken actions about what would happen in the event of their death, something to really think about is, is there any information, are there passwords to your email accounts, passwords to your drives, to your data...



LEO:  Here�s what I�m thinking...



STEVE:  Well, and to your online financial accounts.



LEO:  Oh, and I�ve already done that.  Here�s what I�m thinking is that you separate the information out.  So one of the things TrueCrypt lets you do is have an image file and a password.  You need both; right?  Maybe give the attorney the password, maybe even put it in your will, and store the image file in a safety deposit box.  Separate the two, to be opened on your death or whatever.  And that way � go ahead.



STEVE:  My only concern with that is that, from a practical standpoint, this might be a file you want to be modifying from time to time, have easy access to.  The beauty of it being encrypted is that no � and you don�t even need TrueCrypt, again, I mean, some little simple encryption program that would allow you to easily decrypt it, update passwords, account information and so forth.  Basically it would be your whole life...



LEO:  Everything.



STEVE:  ...in, you know, all the log-on usernames and IDs and passwords, everything you�d want someone to access if you were unable to.  And then you lock it up again, you just reencrypt it, and you know what the password is, it�s also stored somewhere like your attorney has it, or in a safety deposit box, so that if something happened, the directions there would be turn on my computer, run this program.  And again, TrueCrypt can be a little confusing, I mean, it is a techie tool.  So I was thinking in terms of a simple little simple encryption utility that will just decrypt a single file.  And so the instructions could be run this program, enter this password, here�s everything you need to know about accessing my personal private financial life that I want you to have access to.



LEO:  Right.  Jared Burford, a Security Now! listener and a SpinRite user in Western Australia, asks:  On my laptop, my Hitachi 100-gig hard drive, which is a 7200 rpm hard drive, gets too hot when SpinRite is in operation.  At times it reports SpinRite cannot continue due to overheating problems, proceed at your own risk.  I took this seriously.  However, at other times, when ambient temperature outside is cold, like when the air conditioning is on, it stays around 50 degrees Centigrade, and all is okay.  I�ve read various posts and come to the conclusion drive temps vary with every drive, depending on size, capacity, et cetera.  So my question, is 50 degrees Centigrade too high for a laptop drive to function?



STEVE:  That�s interesting.  SpinRite 6 is the first version of SpinRite where I made SpinRite aware of smart stuff.  And one of the parameters that most drives make available, I think probably all of them being produced now, is their current operating temperature.  What we learned during the development of SpinRite � and again I have my fantastic group in the newsgroups, we created a SpinRite Dev newsgroup where we all hung out, and I got a ton of testers � it turns out that laptops, to a much greater degree than desktop systems, really have a problem with heat.



LEO:  Yeah, they�ve got nowhere to dissipate it.



STEVE:  Well, that�s the problem, is that there is no space.  And their super-small enclosure � any user of a modern laptop knows that, I mean, I�m impressed with battery technology because these things are generating an amazing amount of heat.  Literally, you burn your lap.  There are even some things for keeping your lap cool while your laptop is on top of them because it generates such a problem.



Anyway, what we learned was that, because SpinRite is using the drive continuously, that is, it�s moving through the drive, and basically seeking is what generates a lot of heat because you are accelerating and decelerating the head very quickly, well, that requires a lot of energy, as anyone knows from their old days in physics is in order to accelerate something you need to apply a force, and then to decelerate it you need to apply the reverse force.  So that ends up generating heat in the drive.  So what SpinRite does is, if it sees that a drive, whether it�s in your laptop or your desktop, is becoming too hot, it will bring up a dialogue box and say, hey, just wanted to let you know, SpinRite�s going to stop now until things cool off.  You can ignore this...



LEO:  Oh, so that�s a SpinRite error.



STEVE:  Yes.  Well, not an error.  It�s like a SpinRite notification, yes.  And so people can let things cool off, then proceed.  I really like it, though, because many people have increased the size of their hard drives even in their desktop machines; and they didn�t take account of the fact that now that they�re running a 7200 rpm drive, it is drawing more power, it�s generating more heat, and their system may not be designed to just move cold air through fast enough to keep the drive cold.  The reason this is important is the number one killer of hard drives is over temperature.  It is the number one cause of premature hard drive failure is drives running too hot, and no one�s ever been keeping an eye on them.  So...



LEO:  So is 50 degrees Celsius too hot?



STEVE:  No.



LEO:  That�s not hot at all, really.



STEVE:  No, it�s not.  And I think SpinRite limits it at 75, if I remember.  What I did was, I looked at all the manufacturer specs in the industry.  And I was surprised, they were all in pretty much uniform agreement about the maximum operating temperature of the drive.  And I just have SpinRite let people know if they�re exceeding that.



LEO:  Damon in Oklahoma writes:  A previous Q&A topic of spam left me wanting more.  Please talk more about what mail servers do to limit spam.  Something to consider talking about in relation to these SPF records � we talked about that a little bit, the authentication records.  ISPs are now filtering SMTP traffic.  For example, create an SPF record for domain.com that states that SMTP traffic � that�s the mail protocol, sending mail protocol � comes from, you know, 192.1.1 whatever, or mail.domain.com.  This would work fine as long as your ISP allowed you to send mail over port 25 to your server.  Sure, you could add the ISP�s SMTP to the allowed list, but what happens when you or, more importantly, your less savvy users go on the road, you can�t possibly add each mail record for all the potential addresses, the IP protocols that are blocking SMTP traffic, or all the ISPs.  Nor would you want to.  Doesn�t this make the SPF idea almost useless?  I�m not really following this, Steve.  You�ll have to explain.  Super show, I�ll buy the Dells from your link � thank you � I�ll add cash to the donation bucket � thank you � whatever, keep them coming.  Do both.  Thank you.



STEVE:  Okay.  So, yes.  This is an interesting question.



LEO:  I don�t understand at all, so you�d better explain it.



STEVE:  Okay.  And it�s a perfect place for us to talk about what ISPs are doing about spam.  We talked about SPF, the sender provider � oh, now I have an acronym loss.



LEO:  I�ll Google it while you talk.



STEVE:  It�s funny, I�m just blanking on that...



LEO:  Framework.  I want to say framework.  Sender something�framework.



STEVE:  Policy framework, yes.



LEO:  That�s it, okay.



STEVE:  Yes.  And it�s funny, too, because they�ve changed what the acronym stands for several times.  It�s gone through a bunch of mutations which left everybody confused.  So, okay.  But it�s a very cool concept.  The idea is that we understand, we�ve talked extensively in the past about DNS, where anyone is able to make a DNS query saying what is the IP of this domain.  Well, what SPF does is it adds another type of query that you can ask for.  For example, you can ask for a so-called MX query and ask, what is the mail server for this domain?  What SPF does is adds a query that says, what are the allowed IPs or machine names that you authorize as originating mail from your domain?



So for example, GRC does have an SPF record.  So when my mail server sends something to somebody else�s mail server � say I�m sending mail to Google.  Google has a TCP connection to me, so it knows my IP address because we know TCP connections cannot be spoofed, they have to be a real IP address.  It makes a DNS query saying to � it notices that the mail is apparently coming from GRC.com.  It makes a query of GRC.com asking for the SPF record, which is a text record in DNS with a specified format.  The DNS server returns a text record.  In there is my specification, that is, I put this in my own, in GRC�s DNS, saying email from GRC will only come from this one IP.



And so what happens is, it allows the recipient to authenticate the identity of the server.  That is, if anybody else is spoofing GRC, some other non-GRC server is trying to send mail to Google Mail saying, hey, this is from steve@grc.com.  Then what happens is Gmail asks GRC, could this be a valid IP for mail from GRC?  Well, since I control my own mail servers, I know my IPs.  That�s what�s in the DNS record.  So, I mean, it is a really cool antispam�feature.



Here�s the problem.  The problem is � there are a couple.  First of all, and we got hit by this actually just a couple days ago, Greg, my tech support guy, sent me a piece of email that he had been unable to send to somebody else.  The�SPF system only works for point-to-point connections.  That is...



LEO:  Of course that makes sense, yeah.



STEVE:  It does.  It does.  Because any relay, relays of course have traditionally...



LEO:  Everything changes.



STEVE:  Well, and relays have been a huge spam problem, so-called �open relays� where anyone...



LEO:  We don�t want those to exist, yeah.



STEVE:  Exactly, where anyone is able to drop email on an arbitrary server, and it will forward it on their behalf.  Well, that�s called an open relay, which is what spammers have traditionally used.  So notice in my model it had to be a direct connection, a single TCP connection between my server and Google Mail in order for Google to trust that this mail was really coming from me.



So Greg happened to send email to someone who, for whatever reason, that email server relayed it to a third.  That third server used SPF to verify that that relaying server was authenticated by GRC, and of course it was not.  So it bounced the mail back to Greg saying this is an unauthorized server.  Greg tried it a few times, sent the mail to me saying what�s going on?  I said, well, this is typical.  This is what you have when security tightens things up.  You have problems.  Like last week, Leo, we were talking about all of the controversy of digitally signing device drivers.  Well, yes, more security; but, yes, it�s got some problems.



LEO:  So what�s the solution for Greg?



STEVE:  Well, there is no solution.  SPF has this problem. It will not tolerate the use of relays because relays are so�prone to abuse.  Basically we were unable to send email to this guy whose email was configured with an intermediary�server.



LEO:  You could have sent it directly from GRC; right?



STEVE:  No.



LEO:  No, because of the way he was configured.



STEVE:  Yes.  At his end, he was configured with a relay.  And so it�s not just us, but anyone who is using SPF.  And there are hundreds of thousands of servers now.  Anyone who�s broadcasting these records, or is making these records available through DNS, they�re not going to be able to get mail to that guy.  So ultimately he�ll figure out, gee, you�know...



LEO:  I�m not getting mail.



STEVE:  I�m not hearing from people that I send email to.



LEO:  And is it his Internet service provider that�s caused this, or is he doing it, or we don�t know?



STEVE:  I didn�t pursue it beyond seeing what the problem was.  But it was very clear that there was a relay.  So something�s going on.  Now, the related problem is another problem that Greg has had because Greg sometimes travels around and wants to keep doing Security Now! � Security Now!.  SpinRite support is what I pay him for.  He does tech support for SpinRite.  And sometimes he�s out on the road.  Well, he wants to be able to send and receive GRC mail.  The problem is that his ISP is blocking port 25, and many ISPs are now because this is what trojans are getting compromised.  We�ve talked about this a lot.  Trojan machines are generating a ton of spam.  They�re doing so by using port 25 outbound...



LEO:  They set up their own servers on the zombie machine.



STEVE:  Essentially.  And what an SMTP server does is use port 25 outbound to another SMTP server�s port 25 in order to transfer the mail.  So ISPs are starting to block, and many of them now do, block port 25.  You are able to connect to their SMTP server.  So for example my cable modem has me use smtp.west.cox.net as my SMTP server that Cox provides.  So I�m able to send mail to them, but I�m not able to send mail to another SMTP server.  And Greg is unable to send email as being from GRC through his Cox server because then that creates a relay.  Again, there�s not a misconfigured relay.  The only way he can send port 25 email is sending it to Cox.  But when he deposits mail from GRC, from his GRC identity within his ISP, he puts it on their server, they try to send it somewhere, now it�s being relayed.  The recipient checks with GRC and sees that it�s not valid.



LEO:  Not the same address, yeah.



STEVE:  Right.  Now what I could do is not what I did, but I�ll present this because I know that lots of people are having problems like this.  I could add Greg�s ISP�s server to the list of authenticated sources of GRC mail.  It would open up a tiny vulnerability because then anybody using Greg�s ISP�s server could spoof email from GRC.  But the likelihood of that is very low.  Anyway, it�s not what I did.  What I did was, because I�m controlling our email, I just made up another port.  We chose some random port up in high port land.  And it�s another entry to our email server.  So Greg has configured his Eudora client, which we�re all still using, he configured Eudora not to send email on port 25, to send it on XYZ, whatever port we chose.  And so his ISP is not blocking that.  So mail from greg@grc.com goes directly to our server, which then doesn�t have this relay problem.  So it is a tricky � you can see it was a complex question and not a simple answer.  But it is going a long way to solve this problem of finally creating some authenticatability in the email system.



LEO:  Brad Beyenhof of San Diego, California is wondering about onions.  More TOR.  With the TOR network, can�t the various routers know who sent them the onion package?  In other words, wouldn�t it be possible to use such a record to�backtrack the packets� paths and find out where they were�originated?



STEVE:  Nope, you can�t.  Essentially the given router receives the onion package from one other router.  That is, it receives it.  Now, only it can decrypt the envelope.  It didn�t see the prior envelopes.  Remember that we build the onion, which is fully nested as it starts down the path of onion routers.  Each router uses its private key to decrypt one shell of the onion � or an envelope, to use CBS�s term for this, their analogy.  And so when any router receives the onion, they�re only receiving what�s left of it.  That is, the outer shells have been already removed by the earlier stages down the route.



LEO:  So there�s no way to backtrack.



STEVE:  That information is gone.  Not only that, you cannot forward track because after...



LEO:  That�s encrypted.



STEVE:  Exactly.  It�s encrypted with, you know, the remaining shell is encrypted with the next router�s private key that only the next router can decrypt using � I�m sorry, it�s encrypted with its public key, which only the next router can decrypt using its private key.  So basically, any router that receives the onion gets � and this is what�s so cool about this notion of these onion shells � receives only the information it needs to do its one little piece.  It gets the symmetric key for the upstream link, the symmetric key for the downstream link to each of its adjacent routers, and the information it needs.  Then it gets this opaque blob that it forwards to the next downstream router in order to continue making this routing path.  So it�s just � it really does work.  It�s very cool.



LEO:  Very elegant.  Carlos J. Restrepo in Houston, Texas, is seeking some assurance about crypto.  He writes:  I was wondering about crypto and the protection of privacy.  If I use a program like FileVault in the Mac � that�s the OS X�s built-in encryption, it�s kind of like the encryption now that�s part of Vista � or some other program to encrypt your�data, can the government or some other agency order the�developers of these programs, in this case Apple, help them decrypt your data?  And in this case are the developers�able to decrypt your data based on the algorithm they used to create the program, or is your password absolutely necessary?



STEVE:  Well, I would tell Carlos, if he has not gone back and listened to the series we did on crypto, we did much earlier in Security Now! a really, I would almost say, sort of a landmark series in really explaining all of the ins and outs of cryptography and how this technology works.  To answer the question, any properly implemented crypto, and certainly I�m sure that Apple�s is, TrueCrypt�s is, you know, as it�s one of the reasons, Leo, that you like open source solutions so much is because they�re transparent.  The technology itself has no backdoor.  So while it�s possible that someone could, for example, be writing your crypto key somewhere secretly on the system, that�s not the way these systems work.  That would be a breach of their operation, not a breach of the crypto.  Crypto itself does not have a backdoor, that is, the type of crypto we�ve been talking about where you have public key that is asymmetric keys with sufficient length or symmetric keys with sufficient length, they�re just elegantly beautiful mathematical solutions.  And while no crypto expert will ever say that it cannot be broken, as we know, security comes over time from many, many people scrutinizing it and trying to break it and never finding a solution.  Well, that�s the case with the mature crypto we have today.  Everything we believe leads us to trust that there is no quick, simple solution for cracking crypto.  So...



LEO:  And just because they know how it was done doesn�t mean they can reverse the process because they know how it was done.  It doesn�t work that way at all.



STEVE:  Exactly.  That is the heart of the elegance is you can, and everyone does, publicly disclose, publish, write it on blackboards, talk about it in Security Now!, you know, complete disclosure of how it works.  There is no obscurity because, as we know, security is not generally found in obscurity.  It�s completely unobscured, and it is absolutely bulletproof.  So I think what Carlos wanted to know was just sort of a make sure that, you know, he could trust this to keep his secret safe.  And as long as he uses a trustworthy solution, he absolutely can.



LEO:  And again, that�s why I say open source because somebody can verify it.  I�d trust Apple and Microsoft, but those are closed source solutions, so you just don�t know.  The only way to be sure is if you have something like TrueCrypt, which everybody can look at the code of.  Somebody pointed out that you can�t always assure that the code has been vetted because, you know, especially small projects, people may not be looking at the code.  But I think with TrueCrypt it�s pretty safe to assume that that�s been heavily vetted.



Bert Keates of Sun City West, Arizona is worried about being fully stealthed or not fully stealthed with Windows 98:  I was occasionally using two Windows 98SE machines in my home office LAN.  I disconnected both from the network last July.  There�s a Netgear router between the modem and my four computers.  The other two systems run XP SP2 and IE7, though I browse with Firefox most of the time.  Good man.  I just hooked up one of the older Win98 machines and checked it with ShieldsUP.  It�s all stealthed except port 113 that�s closed.  Since my LAN is not true stealthed, should I be worried about those two older Windows 98 machines?  I want to be able to print to three printers and share files across the network.  Thanks from a long-time SpinRite user.



STEVE:  Well, there were a couple interesting things that Bert brought up.  First of all, true stealth is just the term I made up for ShieldsUP, when you do a ShieldsUP test and it absolutely never hears anything back from the remote end.  I do a bunch of funky things.  I send TCP packets to port 0 that doesn�t exist.  I send ICMP to 0 and 1.  I play with different bits.  Basically I send a bunch of stuff, trying to get anything back.  And only if nothing comes back�do I then in the ShieldsUP display say �You have true�stealth.�



So what Bert is seeing is he�s seeing something that�s very common, which is the other reason I selected this question to talk about, and that is port 113.  Port 113 is the so-called �IDENT� port.  It�s an old technology that has not been used for years.  So it isn�t normally necessary to provide any information.  The idea would be, when you were connecting to a remote computer, the remote computer would send you back an IDENT query looking for a server running on your machine that was listening for incoming queries on port 113.  Your machine would then send back some confirming identification information which would just sort of be a way for the remote server to check in with you, get whatever information you were making available.  Some old FTP servers are apparently still configured to do this.  And some, I think it�s IRC servers also do, too.  Anyway, it�s sort of old technology.



The problem is, if port 113 is stealthed, that is, if it�s not closed, if it�s stealthed, then the remote side will try to open up a connection.  It�ll send a TCP SYN packet and wait for that to time out.  Then it sends another one.  Then it doubles the wait time and sends another one.  Then it doubles that wait time and sends another one.  It can take, like, a minute before the server finally decides either, A, you don�t exist, and so it won�t accept your incoming connection to it; or it�ll finally allow that.  But in any event, if it�s configured this way, it can delay your connections by a minute.  So what the Netgear router is doing is it is stealthing everything but deliberately leaving port 113 closed so that, if a SYN packet comes to it on port 113, rather than dropping it and sending nothing back, thus being stealthed, it�ll at least send back a reset ACK saying, I�m here, but this port is closed.  And that will cause any of those types of servers to say, to immediately say okay, no server running there, but at least we can move on.  And the last thing I want to point out is that Bert talks about firing up his Windows 98 machine, which is behind a router, then using ShieldsUP to test that�machine.



LEO:  He�s not testing that machine.



STEVE:  Exactly.  He�s testing the router.  It�s important to remember that his little LAN will be on a private network.  It�ll be 192.168.0.whatever, or .1.whatever.  It�ll be using the private network space.  So he�s testing � any remote access is testing the IP of his public-facing connection to his ISP, which is his routers.  So he�s actually testing his router, not Windows 98.  And just so Bert knows, behind a router you can do filesharing, you can pretty much do sharing printers and so forth without any concern because the router is working as a very good hardware firewall.



LEO:  And you might want to look at your router and turn � if you don�t ever use IDENT, turn off that IDENT, stealth it; right?



STEVE:  Yes, you are often able to configure that and shut that down.



LEO:  Most routers do that now.



STEVE:  And most people do that now, too, yes.



LEO:  More TOR.  Jim in Victoria, BC wonders:  Would using TOR�s anonymity and encrypted connection protect you on an open Wi-Fi network?



STEVE:  Well, that�s an interesting question because the problem with open Wi-Fi, and this is something I wanted to reiterate, is that there are two problems, and they�re very different.  There is the problem of someone monitoring your traffic, which is the one we generally focus on.  And so any time you are using an encrypted connection, that aspect will be safe.



The other problem, though, is your computer is probably � it may be behind its own firewall.  Hopefully it�s behind its own firewall, running in the laptop.  Certainly I would hope all Security Now! listeners know that in any scenario they need to have their local software firewall running, and that a lot of security is coming from that.  So but if they did not have a local firewall running, then in an open Wi-Fi environment their machine is completely exposed.  It would exactly be like allowing someone to just come along and plug a network into their computer and have access to their computer.  Generally lots of ports are still open behind someone�s personal firewall.  And we�re now trusting the firewall to keep us safe, or we�re trusting our NAT routers.  Many people will take a laptop from behind a NAT router out into a public Wi-Fi and have a problem if they�re not running security locally on that laptop.



So I just wanted to make the point that it�s not just the traffic which needs to be secured, but the actual presence of the machine.  It�s on the wireless LAN with everybody else.  And this has been a source of continuing security problems for Windows and other OSes in the past.



LEO:  So to make it clear, TOR does anonymity, not encryption.



STEVE:  Correct.  And I address that actually in the next question, which is why I wasn�t trying to go any further with Jim�s question.



LEO:  Well, then let�s go to Vaylor Trucks of Lawrenceville, Georgia.  He says:  Why not use TOR instead of VPN in a hotspot?  I just listened to Episode 70 in which TOR and Freenet were discussed.  In discussing how TOR worked as a TCP-level redirector, which uses multilevel encryption � he said that well in a very terse form � it occurred to me that turning on TOR might serve as an alternative to using a VPN connection when using a public Internet hotspot.  Aside from the issue of performance, is there any reason why I shouldn�t use TOR for encrypting data going over the first�hop?



STEVE:  I need to determine for sure, Leo, whether running a TOR client does provide encryption between you and the first onion router.



LEO:  And that�s what you care about, by the way, with an open Wi-Fi hotspot is you want to � you can�t be encrypted the whole way because once you get to where you�re going it has to be open.  But you want to encrypt it at least while it�s in the Wi-Fi.



STEVE:  Exactly.  And, now, many people asked this question.  So I will have an answer by the time we are next speaking for our next Security Now!  And it�s very clever because you could imagine using a single onion router on TOR.



LEO:  Right.  Then it wouldn�t be so slow.  It would be�fast.



STEVE:  Exactly.  It wouldn�t be so slow if you�re not frantic about anonymity � as most of us generally are not because we don�t normally have it in the sense of what TOR provides.  If you�re not frantic, you could use a single hop, a single-node TOR onion router, just to use encryption to it and take advantage of it, much like any of these publicly available proxies.  But, you know, here�s the whole TOR network.  So exactly as you say, Leo, you wouldn�t have a slowdown of an extensive multi-hop TOR network.  If it encrypts that first hop from the client to the router, then it really would be an interesting alternative.



Now, there�s one caveat, and this is something that I did not mention two weeks ago when we talked about TOR.  But it�s a glitch in the issue, well, not really of anonymity, but of privacy.  And that is, the only thing the TOR network handles is TCP.  I did mention that before, that is, that it�s a generally TCP transport.  But it doesn�t handle UDP, and DNS uses UDP.  Which means somebody listening to you, someone watching your traffic while you were using TOR, would still see the DNS queries your system was making.  They would know what IPs your system was looking up and, obviously by inference, where you were going.



LEO:  Well, that�s why you use Proxify.



STEVE:  Exactly.  You want to encrypt and proxy all of your data until it gets away from your computer and outside of your computer.



LEO:  And most TOR installations, when you read the docs, they say install Proxify for this kind of protection.



STEVE:  Exactly.



LEO:  Very interesting.  We�ll have to find out � I�m looking at the TOR, its documentation.  It�s not clear.  But you will be able to figure it out.



STEVE:  I�m going to figure it out, and I�ll have a definitive answer for everyone.  Because if it turns out that that works, and you could use a single onion router as a free and always available VPN, that would be a really great solution.



LEO:  Yeah.  And I can�t see any reason why they wouldn�t encrypt that first leg unless it�s overhead that they don�t�want.



STEVE:  As far as I know, they use SOX Proxy.  And SOX is not encrypted by default.  So need to find out about that.



LEO:  Joe Campana of Ontario, California was wondering about the three- or four-digit security codes on credit cards.  This always drives me crazy, too.  I�m glad you asked, Joe.  I know I�m a bit late for the holiday shopping season, but I was hoping you might take a moment to talk about the three- or four-digit security numbers on our MasterCard, Vista, and American Express cards.  They�re still very misunderstood by most consumers, and a potential major security concern.  Why are they there?  How do they provide an extra layer of protection against fraud?



STEVE:  Well, it�s interesting.  I actually learned more than I expected to because as you know, Leo, and as I think I may have mentioned, I wrote � from scratch, in Assembly language � my own ecommerce system for GRC a year or two before getting SpinRite 6 ready to go.  I didn�t want to buy anything off the shelf.  I didn�t trust anybody else.  Nobody else, you know, there were constant security problems in people�s shopping carts.  My model for GRC wasn�t a shopping cart model.  I don�t have a hundred things people can buy.  I have a hundred things people can download, but only one thing people can buy.  So it just didn�t make any sense to me.  I wanted it to work exactly the way I wanted it to, so I wanted to write my own.



What I learned is that, by law, any credit card has to have a phone number on the back that a consumer � this is like consumer protection law � that a consumer can use to call the issuing company for help, and that it�s called the CSC, the Card Security Code.  It�s also called a CVV or a CVV2 within the industry.  And the idea is that that is a security number which has a couple special characteristics.  It never is written on the mag stripe, and it is never embossed on the card.  So it will never be picked up by the old-style credit card embossing deals where they stick your card in the machine with carbons and run the roller over it.  And it will never be picked up by a card swipe technology.



LEO:  So the theory is you have to have physical access to the card to know that number.



STEVE:  Yes.  And it turns out that some people, sometimes that number is written in the signature area, which is a coded area of the card that can become scratched off over time, so you can lose that number.  And the reason I mention the phone number is that you�re always able, given that you can prove your identity to the person on the other end of the line, you�re always able to get them to tell you what your code is.  And it�s better not to record it on the card.  It�s better to move that number further from the card, maybe to a secret corner of your wallet where you keep the card, just so that the two don�t go hand in hand.  So essentially it is another level of authentication.  Also by agreement, that code, even if provided, is never � it never appears in receipts, it never appears on printed receipts, and it is never stored in a database.  So essentially it is, as you said, Leo, it is a completely separate, external, non-associated token that allows something � it�s like some additional level of authentication.



LEO:  I have to say, though, the security card system is grossly insecure.



STEVE:  It�s not very long.  But they realized � but basically it�s sort of like an ATM PIN.  It�s like a PIN that goes with your credit card.



LEO:  But just credit, you know, credit cards get stolen all the time.  You give out that number, if you buy something they�ll ask you for that CSC number.  And so you�re giving it out, I mean, it�s just grossly insecure, the whole credit card system is.  And I guess until we get smartcards and bioidentification, it�s probably going to stay that way.



STEVE:  Well, and of course this is the result of the fact that credit cards predated online commerce.  But even then, remember, as we�ve talked before, you�re handing your credit card to an anonymous server in a restaurant.



LEO:  And there�s no association of that card with you,�really.



STEVE:  Right.



LEO:  And I think that�s the problem, there�s no � but I�m sure we�ll come up with better ways someday.  There�s not enough fraud, or the fraud is � as a user you don�t mind because you�re protected, if you keep an eye on things.



An appropriately anonymous sender located somewhere in Southeast England asks about TOR:  Sounds like TOR is quite a sophisticated system, but there are still a few questions.  You said there�s no need to trust any of the routers in the chain, but what about the last router?  It removes the last layer of encryption from the data packet and sends it on to the server.  So if one is corrupted, say owned by the NSA, can the originating IP address also be extracted?  I mean, there must be some way for those routers to know where to send the reply; right?  And isn�t there some way to find out where the packet�s coming from by intercepting the clear text between the last router and the server?  Or just by owning the server?



STEVE:  He asks a bunch of questions, and we sort of have already covered this and touched on it earlier in this single episode.  But I�ll just answer his question because it does amplify what we said.  If the last router were compromised, as he said it�s receiving unencrypted data both coming out of the router bound toward where you�re sending your traffic, and unencrypted coming back.  Then it encrypts it.  Well, the IP that it�s coming back to is its own, and that identifies the channel that has been set up through the onions.  So it is not the case that even a compromised last router is able to have any idea where the traffic is going.  It absolutely knows nothing about it.  It knows how to encrypt it and which next onion router to send it to.  That�s all it knows.  So it does see the clear text.  It is able to watch what you�re doing.  But remember, and you�ve amplified this point several times, Leo, TOR is not about security and privacy, it�s about anonymity.  And so it�s important that, I mean, and this question brings up the point that the last router is seeing anonymous people�s traffic coming in and out of it.  It doesn�t know who they are.  So...



LEO:  But if it�s not encrypted, they could read it.



STEVE:  They can read it.  And as I mentioned before, there are some hacks that could be performed against an unwitting user.  For example, that router returning web pages could alter the web pages, if it were malicious, and inject some JavaScript which would follow the web page back, router by router by router, to the user�s browser.  If the user�s browser is running scripting by default, then it�s going to run that JavaScript and do whatever that malicious person told it to.  Now, it�s worth noting, though, that any web server can do the same thing.  So it�s not like this is a particular vulnerability of the onion routing system.  It�s if you�ve got scripting enabled by default, which smart people don�t, then you�re safe against that kind of problem.



LEO:  There�s a lot of information on the TOR wiki on using�things like the Firefox NoScript extension to prevent that whole...



STEVE:  Exactly.  But to answer his question, isn�t there some way that the router knows who you are?  And the answer is, unless you tell it, by scripting or a cookie or something, no.  There is no way.  Because all it knows is the next hop.  And this system is now active enough, there are so many routers, there�s just a blizzard of traffic � more so, actually, after we talked about it two weeks ago � a blizzard of traffic flying among these routers.  There�s just no way to know where it�s going.



LEO:  All right.  Last question.  Fred Barlow of Atlanta, Georgia had an interesting question about cryptography:  If I generate public and private keys, and someone else generates the exact same � there�s your problem right there � public and private key with messages encrypted with the public key, one, will they be able to be decrypted by the private key; and, two, vice versa?



STEVE:  Yup.



LEO:  Yeah.  But that�s never going to happen.



STEVE:  Exactly.  As we know from our episodes on crypto, because of their nature, public keys, that is to say, asymmetric keys where you have a matching pair of public and private key, they are very long.  They are 1K, 2K, 4K in even more modern cases.  They are generally extremely long; 2 to the 1,024 is how many different possible 1KB keys there are.  Well, it�s just an astronomically large number.  I can�t even do some quick math to give people an idea.  I mean, that is just � the chance of it happening is so small that you absolutely don�t need to worry about it.  And there�s just no way you could guess it because there are too many guesses.  So even if two random people on the planet, both happen to have randomly chosen the same key, they would never know it.  So the chance of one of them trying to decrypt something the other had encrypted, well, that�s vanishingly small, too.  These things are so large...



LEO:  Don�t worry.



STEVE:  Possibility is so low.



LEO:  Don�t worry.  Calm down.  It�s okay.



Hey, a great set of 12 questions, Steve.  And you�ve done a great job explaining them all.  I do want to thank our friends at Dell for sponsoring this podcast.  I do think this is the last one.  I don�t think they run into 2007.



STEVE:  Leo, I have to interrupt you for one second.  I just picked up my calculator because I was curious.  I tried to raise 2 to the 1,024 power using my HP11C...



LEO:  It won�t do it, will it.



STEVE:  No.  9.99999 to the 99th.  Which means it just overflowed and blew the calculator�s mind.  So...



LEO:  It�s a number larger than the number of molecules in the universe.  I think you�re okay.  We�re more likely to have a positron electron explosion.



Steve, Dell is, of course, the sponsor of this podcast, their last time on the show, and we want to thank them so much for a great quarter of ads.  Your last chance to get a great deal on a Dell through the TWiT.tv/dell page, the Leo�s Pick Page, some great computers there.  But anything you click and then buy later, anything you buy on the Dell site, if you go through that link in other words, will count towards us.  And we do appreciate that, and we do appreciate Dell�s support.  I�ve always been a Dell fan.  It was just a real thrill for me to kind of get Michael Dell behind us and say, hey, we believe in what you�re doing on TWiT, and we want to help you out.



STEVE:  It�s been a good year with Dell.



LEO:  It has, it really has.  Also a good year that will continue with Astaro.  They�ve decided to sign up, they�re re-upping, our first sponsor.  And I think they�ll probably be with us as long as we�re around.  Astaro makes the Astaro Security Gateway.  If you�re in a small or medium business, and you�re looking for kind of an all-in-one solution that does everything, I mean, superior protection from spam, from viruses, it�s got hacker protection and complete VPN capabilities, intrusion detection, content filtering, and an industrial-strength firewall, and it�s all in one simple, easy-to-use appliance, not very big, about as big as a router, but it does it all.  You can get one in your business free for a trial.  Contact Astaro, Astaro.com, or call 877-4AS-TARO.  A free trial of the Astaro Gateway Appliance.  And if you�re a non-business user, you could download the Astaro version free at Astaro.com, install it on a PC, and get great protection.  In fact, for a very low subscription price you can even get all of the additional features added in and automatically updated.  It�s really kind of a neat idea.  More people should try that.  Astaro.com.



For more information about this subject, and 16KB versions of the show for the bandwidth-impaired, and transcripts, too, if you like to read along while Steve�s talking, go to GRC.com.  It�s the home of Security Now!, of SpinRite, Steve�s incredible disk maintenance utility, and of course all those great free programs.  SecurAble will be out very soon, and a ton of other ones that are a must-have.  And let�s not forget ShieldsUP, which is still, I mean, how many people have used ShieldsUP now so far?  It�s a huge number.



STEVE:  I think we�re approaching 47 million.



LEO:  That�s outrageous.  That�s great.



STEVE:  It�s wonderful.



LEO:  Steve, have a very happy New Year.  We will see you in 2007, one week hence.



STEVE:  �07, amazing.



LEO:  Amazing.  This has been such a successful podcast, entering now our third year of securing you, your friends and family.  Since 2004...



Copyright (c) 2006 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#73

DATE:		January 4, 2007

TITLE:		Digital Rights Management (DRM)

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-073.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  In preparation for next week�s look at how and why Windows Vista has incorporated the most pervasive and invasive system for digital rights management ever created, AACS, Steve and Leo first take a step back to survey the history and evolution of media property rights and the technologies used to enforce them.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 73 for January 4, 2007:  The next generation of copy protection.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



Welcome to 2007.  And you know, the great news is in 2007 there are no more security issues.  There are no more security problems.  We don�t have to worry about hacking.  We don�t have to worry about viruses or spyware.  So, Steve, we can stop doing this show.



STEVE GIBSON:  So this is our last episode.



LEO:  Because they fixed it all; right?



STEVE:  No more problems in �07.



LEO:  Oh, how far from the truth that is.  Why, it�s a brand new era of spyware, viruses, hacks, exploitation, encryption.  And of course, as always, as we�ve been doing since 2005 � is that right?  Yeah.



STEVE:  Yeah, yeah.



LEO:  We will be covering the ins and outs, Steve Gibson and GRC.com.  Hello, Steve.



STEVE:  Hey, Leo.  Great to be back.  Our first episode of the new year.  And just so everyone knows, we�re kidding about there being no more Security Now!.



LEO:  Do you think anybody believed it?



STEVE:  I don�t think so.



LEO:  I can see it on Digg, though.  I should really learn.  You�ve got to be very careful what you say these days because it�s taken out of context, it gets on Digg, and it gets a life of its own.



STEVE:  Oh, it�s true.  You mentioned once, I think you were�� I don�t know if you were just tired or...



LEO:  I was having trouble getting guests, yeah.



STEVE:  That�s right, for TWiT.  You just sort of said,�well...



LEO:  I didn�t even say I was going to kill it, I just said I�m having trouble.



STEVE:  And it was a firestorm.



LEO:  I still hear from people.  My father-in-law said, �Hey, my friend told me that you�re canceling TWiT.�  Just yesterday he said this.  I said I don�t think so.  In fact, I�m very pleased to say TWiT was named one of the top ten podcasts of the year from Time magazine, so...



STEVE:  Time magazine.



LEO:  Time magazine.  Pretty high honor.  We�re up there with all the biggies.



STEVE:  Mainstream media.



LEO:  Yeah.  And most of it is mainstream media.  Wall Street Journal and, you know, �All Things..� � or I guess �This American Life,� which is my favorite radio show.  Anyway, enough of that.  And I consider, by the way, that that�s the TWiT network more than just any one podcast.  Because really TWiT is made up of so many pieces.



We�re going to talk today about something that is really new in 2007, a new form of digital rights management.



STEVE:  Well, yeah.  What happened was, essentially over the holidays there became a great deal of attention focused on a paper written by a guy named Peter Gutmann who is a well-known security researcher � in fact, it�s funny.  When he and I were corresponding, his email was going into a different folder.  And I thought, okay, I know I just got email, where did it go?  Well, I had a folder from a dialogue I had had with Peter and one of his coworkers back in 2002 regarding a free cryptographic library that they were making available, an open source cryptographic library.  And back then I was talking to him about making use of some of the functions and wanting to get his permission to do so.  So I�ve had a dialogue going back with Peter four years, five years.



And what happened was, he wrote a really interesting paper which I was reading on the plane heading to Northern California for Christmas.  Actually it was on December 24.  By the time I got to the second page of this thing it had me in its grip.  It was fantastic.  It�s titled basically, I don�t remember the exact title [�A Cost Analysis of Windows Vista Content Protection�], but it talks about the effective costs of the new digital rights management technology which Microsoft has put into Vista.  And this is something that we�ve never talked about before.  Peter has a very progressive, open source, free speech sort of take on this.  But it was really interesting.



So it got me focused on this issue of, wait a minute, I mean, you and I deal with media a lot, Leo.  DRM is an issue.  We�ve glanced on issues of digital rights management of the Digital Millennium Copyright Act, DMCA, and so forth, but have never really focused on it.  I decided, though, that Vista is � I wanted to do an episode responding and talking, not only about Peter�s paper, but with Peter.  So he�s going to join us in next week�s episode about Vista and DRM to talk about the things he said.  And also I think it will be fascinating to hear about the reactions to his paper.  In the email that he and I have had, in our correspondence, he�s just been in a firestorm.  Many bloggers have jumped on the things he said, saying that he�s wrong.  Bob Cringely � remember the old InfoWorld guy, Cringely � basically didn�t agree with some of the things he�said.



So anyway, it sent me into a research mode for most of the last week to understand what this AACS content protection system is.  I wanted to understand the technology of it and basically to do a fact check of what Peter wrote and also to be able to bring sort of a comprehensive view of what this means to our listeners.



LEO:  So we�ll set that up this week, and then next week we�ll talk with Peter, having kind of a foundation for understanding what he�s talking about. 



STEVE:  Well, yes.  And in fact the reason I want to talk about this, first of all, I think it will be interesting to all of our listeners.  And although technically we�re about security, no base of listeners more than ours has the foundation to understand this stuff because this is all about crypto and the technologies that we�ve been talking about, as you said, since 2005.



LEO:  Well, and I think DRM falls within our purview, absolutely.  Hey, before we get started on understanding AACS, what it is and what it�s going to mean going forward, let me just mention, as always, that this podcast starts a brand new year with Astaro.  They�ve sponsored us most of last year, and they�ve decided to come back for all of 2007.  We�re really thrilled.  It�s a good match for us.  Astaro makes the Astaro Security Gateway.  Now, if you�re a small or a medium business, and you�re looking for superior protection from spam, from viruses, from hackers, you get a complete VPN, you get intrusion protection, you get content filtering and an industrial-strength firewall, all in a box, a little, affordable, high-performance appliance, it�s really neat.  You can contact Astaro to get a free trial, Astaro.com, or call 877-4AS-TARO.  You can schedule a free trial of an Astaro Security Gateway appliance in your business.  And home users, non-commercial users can download the software from ASG for home use for free, which is pretty neat.  It�s open source and very, very powerful.  Astaro Corporation, Astaro.com.  We thank them for their support.



So AACS.  What does that stand for?



STEVE:  Well, it stands for Advanced Access � this has been an acronym soup week for me also.  Advanced Access Content System is what it stands for.



LEO:  Is it a replacement for CSS, which was...



STEVE:  Well, it�s sort of a replacement...



LEO:  That�s the DVD encryption.



STEVE:  Right, a sort of replacement for CSS, although really it�s an evolution forward.  That�s one of the things that I learned during this research is that this is not a completely brand new system.  There�s been a constant evolution in content protection ever since, well, since the beginning of digital tape stuff happened.  You may remember that the audio industry, the recording industry just had a spasm when � it was back in 1987 DAT tape was introduced.  Because here was going to be a consumer digital audio tape recording format that would potentially allow consumers to make perfect copies of recordings.  And so when we moved into this digital era from the older analog era, things that were already sort of set up to be a problem for the content producers got a lot worse because now there was not this notion of a recording of a recording of a recording.  You may remember in elementary school when we had cassette tape recorders, kids would get two cassette tape recorders, hook their connections together, set one to play and the other to record.  Remember those old days, Leo?



LEO:  Right, yeah.



STEVE:  And you�d make a copy of some...



LEO:  And it would get hissier and hissier with each copy.



STEVE:  Exactly.  And so, yes, that was a violation of copyrights.  And so even back way...



LEO:  I think there was a loophole, though, wasn�t there?  I think there was the Home Recording Act, which allowed you to do that.



STEVE:  Actually that didn�t come until after DAT tape.  It was, like, four years later.  It was in 1992.  And actually it was in response to the problem of DAT tape that the Home Recording Act was created.  And basically what it did was it required � it by law ordered all digital audio recorders to be equipped with Serial Copy Management System, something called SCMS.  And the reason that that happened was, well, first of all what SCMS was, was it allowed you to make one first-generation copy, but the copy could not be copied.  And the reason that happened was that even later, back in �72, the recording industry was worried about consumer tape recorders, as we were talking about, and wanted to tighten up the regulations.  But due to the sort of the historical nature of copyrights, the Congress was concerned about just banning all copying.  So they put in what was called a �fair use exemption� which allowed individual citizens, like for personal use and for academic use, to make copies, the idea being that those would not be causing economic harm on the content producers.



So essentially what�s been going on is, over time this notion of who owns the material really has evolved.  The original copyright provision, back in 1788, of the Constitution, it allowed for 28-year protection on books, maps, and charts.  And basically it stood that way for about a century, after which time that 28 years was doubled to 56 years.  And the notion of printing, which is what they were talking about then, turned into copying because we were beginning to have phonographs and player piano, remember sheet roll music stuff.



But what�s happened is, well, the idea was that the overall goal was that the public interest was going to be served, that is, the formal law says that what�s good for the public is what we want.  So the idea was that allowing anyone to copy anything was not good for the public because that would disincentivize content producers.  So the idea was, let�s give content producers some length of time in order to have exclusive rights, after which the content will revert to the public domain.  And of course that�s very much like the patent system that we still have today, where you file a patent that publicly discloses your invention, so for example it�s no longer a trade secret, it will be made public, but in doing so you�re guaranteed 17 years of exclusivity to that invention in return for making it public, the idea being that that allows other people to build off of your invention during that time, although they have to pay licensing rights and royalties to you if they use it.  So originally copyright was a very similar sort of�thing.



But what�s happened over time, and really unfortunately it looks like it�s a direct consequence of the increasing lobbying strength of the content producing industry, they�ve been lobbying for and succeeding in getting increasingly strong legislation from Congress to create laws which are making this � basically tightening down on individual users��rights.



Now, the flipside of that is, look how the world has changed in, for example, the last 30 years, where back in elementary school kids were plugging two tape recorders together.  Now we have hard drives, gigabytes of storage; we have Internet; we have fantastic communications technologies.  All of these things, of course, work to make the proliferation of copyrighted material far easier.  So those people who are trying to say, wait, you know, we need greater protections today because the world is nothing like it was envisioned back when these original laws were created, I mean, you could argue that they�ve got a good point.  So essentially this is � over the years the legislation has tightened up until, of course, we finally got to the World Intellectual Property Organization, the WIPO treaties.



LEO:  Oh, boy.



STEVE:  Yes.  And of course when we signed those treaties we had to have a law to � basically a law on our books to make legal what the treaties were saying.  And that�s where we got this DMCA, the Digital Millennium Copyright Act, which basically criminalizes and makes much greater the fines involved with basically touching in any way content which has ever been encrypted.  And so essentially, technically there�s still this fair use provision in the law, but it�s gone for encrypted content.



Look at CDs.  Now, CDs are non-encrypted, and nobody thinks twice about ripping a CD and sticking it in your MP3 player for your own personal use.  And fair use law allows that to be done.  You�re certainly not supposed to copy the CDs and hand out perfect digital copies to your friends.  But unfortunately for the content producers, it�s entirely possible to do that because the CD technology was never produced with any encryption.  That is, there�s nothing there to prevent that from happening.



So the way the laws have come down is, okay, the DMCA criminalizes the circumvention, even the exploration actually of circumvention into any technology used to thwart copying.  So DVDs, even original, first-generation DVDs that are being protected by the very broken CSS, the Content Scrambling System, DVDs cannot legally be ripped and decrypted at all because doing so violates the DMCA, since you are having to defeat content protection which is on the DVD, which is not the case over on the CD side.



So essentially what�s happened is, over time the world has changed, computers are becoming powerful, and from the standpoint of content producers, I mean, the creation of the PC is the worst thing that ever happened.  These are like little piracy studios that have dropped in price, that you can buy for $500, that all have DVD-ROM burners in them now.  So you can stick DVDs in.  With the proper software you�re able to rip them, decrypt them, and burn copies.  This has been a nightmare for content producers.  And while they have succeeded in lobbying strongly and passing laws to increase the length of their ownership of properties and to basically make increasingly onerous the threat of breaking these rules, they recognize that laws are one thing, but preventing the copying is what they have to do if it�s not going to happen.



I mean, look at filesharing.  It�s funny, I was talking to Mark Thompson, AnalogX, about this.  And I�m not that much into the industry.  He�s got a friend who is a song author.  And in response to my question of, �Mark, has peer-to-peer filesharing and music trading really hurt the industry?,� he said, �Without a question.�  He said he�s got a friend who�s been watching his royalties dropping year by year because people no longer need to purchase CDs from the store.  They can get pretty much anything they want for free in the CD�area.



So what�s happened is, sort of quietly and behind the scenes, there has been a continuous march of technology moving forward.  You mentioned CSS.  CSS is the Content Scrambling System which was put onto DVDs from the beginning.  It had a number of problems.  One is that, due to the export restrictions which we had at the time � you may remember that export restrictions classified cryptography as munitions, and so it was illegal to export anything protected by a key longer than 40 bits.  Well, that directly impacted the design � some would say thankfully, those who liked the freedom of doing with DVD media what they want to � it impacted the design of DVD cryptography, limiting it to 40 bits.  Also back then the available processing power in players was far lower, so you could argue that players wouldn�t have been able to really manage much heavier crypto anyway.  So CSS uses a 40-bit key, and analyses of it have shown that only 25 bits of the 40 turned out to be mathematically significant.



LEO:  Oh, that�s terrible.



STEVE:  Yes.  Well, it�s very reminiscent, remember, of the 40-bit...



LEO:  WEP.



STEVE:  ...WEP encryption.  You know, it�s like, oh, 40 bits is a lot.



LEO:  It�s enough.



STEVE:  And it turned out that weaknesses in the encryption caused it to have real problems, as we�ve covered in the past talking about Wi-Fi stuff.  So bottom line is that CSS was protection against casual copying, but it allowed the technology to be cracked and to the point now where people who want to copy commercial DVDs are pretty much able to do so.  So naturally the MPAA, the Motion Picture Association, was not happy about the fact that this protection on DVDs was cracked so badly.  On the other hand, the DMCA absolutely guarantees that, since it was encrypted, their intent to protect it is in place.



Now, the problem is, it really does block fair use because individuals by law should be able, were it not for this DMCA ban on copying anything that is encrypted, individuals should be able to copy for their own use.  And one of the things that I found really interesting, you may remember this, it was a report that came out maybe about a year ago, and that is that pressed CDs and DVDs are not nearly as archival as was believed.  It turns out that there�s an oxidization problem that occurs over time.  And so our large collections of CDs and DVDs are degrading and have a lifetime that some have measured of maybe 10, maybe 15 years, but not 100.  Whereas it turns out that recordable technology, because it doesn�t use the same materials at all, CD-R and DVD-R material, has much longer archival shelf storage life.  So I have a huge collection of DVDs, commercial purchased DVDs and CDs.  And I buy them because I love movies, and I would like to be able to watch these in 30 years.  So basically the fact that I�m unable to make personal use copies is a problem that can cause them to basically � for me to lose the value that I had in buying something that I thought was going to last forever.  Turns out we don�t have that freedom anymore to do so legally.



So over time there�s been a series of evolutions in CSS.  Informally there�s something called CSS2 that never really existed.  But there was something called CPPM, which is the Content Protection for Pre-recorded Media.  That is what protects DVD audio disks, which I have a few of those, although they never really got off the ground, the idea being that you could take the incredible, never-compressed 7.1 surround sound, basically make a very high-resolution, stunning-sounding, multi-channel recording, which you cannot deliver on a CD because it doesn�t have the data rate or the capacity, but you could deliver it on a DVD.



Then there was CPRM, which got a lot more press.  It stands for Content Protection for Recordable Media, and it got a lot of attention because the spec when it came out included hard drives, regular ATA hard drives.  And people in the industry went nuts because it looked like, if this were implemented in hard drives, then we could start having hard drive content locked.  And the CPPM and the CPRM give you protection on a sector-by-sector basis.  So the idea would be that we could have arbitrary blocks of sectors locked and encrypted inside the drive in a way that would prevent us, literally, from backing them up.  And so there was such a fury that resulted from that that the body that licenses CPRM promised, they vowed never to license any hard drives to incorporate this technology.



And it�s worth mentioning now, at this point, that all of this technology is available only under license.  It�s all protected by intellectual property rights, both patents and trade secrets.  Sometimes you can find more information by looking at patents that have been issued to these various companies.  But a lot of the stuff is kept also trade secret, where only if you�re a licensor do you get the specific crypto algorithms that these things are using, not to mention have keys that are issued to your devices that allow them to participate in these systems.



So sort of quietly in the background this technology has been evolving.  There�s also something called DTCP, which is Digital Transmission Content Protection, which protects Firewire, the 1394 interface, and USB connections.  When protected content is passing over those serial buses, this DTCP comes into effect, and it also has this notion of serial copy protection.  There�s two bits in there that say you can copy this freely, you can never copy this, you can copy it once, or you can copy it no more.  So those are the four combinations that two bits gives you that allows you to govern, or allows the content producers to completely control what rights you have to use this technology.



And then finally there�s something called HDCP, which is � actually it�s an intellectual property of Intel�s.  It�s High-bandwidth Digital Content Protection, and that�s what current-generation consumer TVs and home theater projectors are using, among other applications, but primarily that, the idea being that our content producers have really been extending their reach so that they�re protecting the entire channel all the way from the disk, which is heavily encrypted, through the player, and then even the player�s outputs from the player to the screen.  There are policies which are bound into the content which allow the content providers to declare whether, for example, they will allow their content to be played over component connections.  For years the predecessor to HDCP connections, this digital link to consumer display devices, was component video, so-called RGB video, that many existing home theater systems use.  The problem is, it is not a digital technology.  It is not digitally protectable.  And so, although it isn�t being done yet, and no one knows if or when it will be done, anything that is able to deliver this content is able to literally shut down your component video outputs and in some cases deliberately degrade the resolution coming through, if that�s what the content owner requests.  So they can control whether you get it at all, whether you literally get a fuzzy picture, or whether you get the full resolution that the spec is able to provide.  It�s just phenomenal how much of this has sort of been creeping along without us really paying much attention to it.



LEO:  Seems like they�ve always wanted the ability to kind of reach into your computer and change how it behaves.



STEVE:  Well, yes.



LEO:  Or even retract stuff if they could.



STEVE:  Well, that leads us to AACS.  AACS...



LEO:  Even better.



STEVE:  Oh, boy.  Wait till you hear about this.



LEO:  So, now, AACS will be used on what?



STEVE:  AACS is sort of the end result so far of this constant march towards the content providers obtaining more technological grip on what users can actually do.  With the DMCA they got legal grip.  I mean, the DMCA has serious teeth in it.  The EFF and many free speech activist organizations are very unhappy with it because they really feel that it goes too far.  One of the things that has always strengthened our technologies is having them open and able to be examined and discussed within academia.  So the DMCA prevents that.  You see people saying I can�t talk about this because it would be a violation of the DMCA.  So it really does go against free speech rights in many ways, like extending itself way beyond just the protection of content.  It�s protecting anyone talking about the protection of content.  So it�s a problem.  But so AACS is the new system which is part of every next-generation DVD, that is, the so-called high-definition DVD formats, both HDDVD and the Blu-ray DVD.



LEO:  Oh, so they both use the same method.  They don�t have their own methods.



STEVE:  Yes, they both use the same.  All of this comes from a very powerful licensing body.  Blu-ray has one step more of encryption, which is one of the things that Sony is trying to sell the content industry in believing because Blu-ray, well, first of all, due to the fact that it�s a format which is not compatible with existing DVD production, whereas HD-DVD you�re able to retool your DVD production line in order to produce HD-DVDs, Blu-ray requires brand new equipment from scratch.  I mean, you�ve just got to create a completely new production facility.  In return for that, you do get more storage.  I believe it�s � I�m not quite sure on the least significant digit.  But it�s like 50 or 56 gigs of storage on a Blu-ray DVD, where HD is 40.



On the other hand, they�re also using the latest technology, the H.264, the so-called AVC MPEG-4 codec, which is the generation beyond MPEG-2, which is the compression used for DVD content.  That allows them to basically get higher levels of compression.  Also H.264 deals with much higher resolution images in a good way than MPEG-2 was ever designed to.  Basically MPEG-2 likes 720x480, which is the native resolution stored on DVDs; whereas H.264 can handle the highest current resolution and potentially beyond, which is 1920x1080, at the far extreme end of HD.



So anyway, as I was saying, what Blu-ray offers beyond HD is�it can actually contain a replacement copy protection scheme, if the AACS scheme were ever to be badly broken and�compromised.



LEO:  That�s, by the way, what most security and cyber experts told them to do.  They said there�s no such thing as the uncrackable system.  You�ve got to have backups.



STEVE:  Well, yes.  Now, Leo, you and I have said, I mean, this is one of my mantras on Security Now! is it is not possible to do this.  That is, it is not possible to make a system like this work perfectly.  And again, as we define security, security has to be perfect because the nature of breaching security is, for example, the weakest link problem.  All you need is one weak link somewhere, and you are able to hack the system.  Speaking of which, over the holidays there was a great deal of news caused by somebody who posted, I don�t remember if it was the Doom9 forums where he first posted.  I don�t think...



LEO:  Yeah, it�s on Doom9, yeah.



STEVE:  I know it�s there.  I don�t know if that�s where he first posted.  Someone going by the handle of muslix64 announced an HD-DVD backup tool for which he provided the full source code.  And on YouTube is a video demonstrating that he has cracked HD-DVD content protection, that is, this latest generation AACS content control system.  What he apparently did was he was using a version of Windows, and we don�t know which player, but it may have been Version 6.5 of PowerDVD player, which is able to play protected HD-DVD content.  He went into the software at some phase of its operation and grabbed the keys.  He grabbed the decryption keys and then independently decrypted the contents of the drive, which are just files stored in the standard DVD file format, the UDF format.  He took the files and did his own decryption.  Now, it�s interesting that he posts this in Java because in some of the AACS specs is their samples of this technology is in Java.  So my guess is that he read the specs, took the sample code which, you know, the AACS guys made available, basically took the decryption keys out of the PowerDVD player and applied them himself to decrypt the files.  And this YouTube video apparently shows him playing one of these files that he independently decrypted.  He�s playing it outside of the normal protection wrapper.



Well, what he did was not to break AACS at all.  What he did was he captured a deep intermediate result.  This AACS technology is phenomenal.  It involves multiple parties.  There�s sort of a licensing entity which issues device keys to devices which are licensed to play this content.  They also issue media keys to a licensed media replicator, and something called an MKB, which is this Media Key Block.  The technology is literally, it�s light years beyond CSS.  And the Media Key Block uses a very clever system which has been created recently, which forms what�s called Broadcast Encryption using something called a Subset Difference Revocation, or SDR.  If anyone listening wants to really hurt themselves, put Subset Difference Revocation into Google and then try to understand this stuff.  I mean, it is just � it�s this amazing tree of cryptographic keys.  And the idea is that it�s used for any time you want to broadcast, you want to control the broadcast of encrypted content, and you want the ability to revoke certain keys of receivers of the broadcast, but you want to minimize the overhead of basically sending all of the revoked keys, the idea being that the vast majority of receivers of the broadcast will be licensed and non-revoked.  So most of the keys are going to be valid, but some of them need to be revoked.  But maybe even a bunch.  We�re talking about huge, huge numbers.



LEO:  If a key is revoked, the player stops working.



STEVE:  Yes.  If the key is revoked, well...



LEO:  So it�s a way of kind of, if somebody figures out a way to crack it, you just revoke the key.



STEVE:  Actually it�s more than that.  It�s not that the player stops working.  What this thing does is this bizarre broadcast encryption is a way of sending out all of the keys and preventing the revoked receivers from being able to use this technology to obtain their own key.  So, but anyway, bottom line is, it�s...



LEO:  I can�t even follow this meta-discussion, let alone...



STEVE:  I know.  It is just, I mean, I�ve read the thing about three times.  I�m kind of beginning to get a handle on�it.



LEO:  But let me understand, the idea of key revocation is you can no longer play back this content.  Right?



STEVE:  That�s exactly right.  So here�s the AACS technology, and the content protection industry, they are determined not to make the same mistake they made with DVDs.  And believe me, they�ve just gone overboard with this.  So disks are licensed.  Content is licensed.  There are drive certificates and host certificates.  There�s this Media Key Block which contains this insane subset difference revocation broadcast encryption difference tree technology that allows them � it�s not only that they�re revoking the key, but because you could imagine that some device that, for example, had been compromised would use somebody else�s keys.  Anyway, the way this works cryptographically is you are unable to decrypt the content if this Media Key Block is set up in a way that you�re unable to.



So get this, Leo.  Next-generation players are so burdened down with this crypto, I mean, this stuff, first of all, no more of this 40-bit cipher nonsense.  This is AES 128.  That�s the Rijndael encryption that happened, remember, a few years back that we�ve talked about.  AES is our state-of-the-art crypto.  It�s 128-bit AES throughout the entire technology.  They use sort of AES building blocks to do hashes and for signing and other stuff.  They also use full-on public key crypto.  They use elliptic curve cryptography as the means for using a Diffie-Hellman public key key exchange between the devices.  But this stuff is so loaded down now that, when you insert a high-definition DVD into first-generation players, it takes the player more than a full minute to register the arrival of the disk because the player is sitting here trying to untangle all of this stuff.  It�s literally, you know, we don�t have super-strong processors in these little consumers players, you know, you want to buy it at Fry�s or Circuit City or wherever for a reasonable price, they�re trying to get the cost down.  Certainly we�ve got much stronger computation today than we did 30 years ago.  But still, a full minute just for the player to go through all this work.



Now, the player also has non-volatile memory.  And this Media Key Block is serialized.  So imagine that somewhere, somebody hacked a player that you owned, and the content industry was tracking this and realized that this player had been compromised, and they wanted to prevent any additional media from leaking out through the player.  They�re able to revoke, essentially remotely revoke the certificate and crypto capability from that player or all players of that family.  And it�s not clear what level of granularity there will be, whether for example a certain model of player will have all the same keys, or whether they�ll be produced in batches.  It�s up to the licensor to decide how granular they want to make their license, apparently.



And again, one of the problems we have is that even the contracts and the terms of these things are bound up in proprietary license agreements.  There�s talk of other remedies, which sound sort of onerous, against people who allow their players or their keys to become exposed.  So it�s not only that they would be subject to revocation of those assets, but also �other measures,� unquote, and nobody knows what those are.  So...



LEO:  Come knocking on your door, that�d be the measure.



STEVE:  So when you insert a new HD-DVD into an HDVD player, it goes through all this crypto literally between the drive in the player and the player.  Even the bus between the drive and the player�s motherboard is dynamically encrypted.  And there is public key exchange happening between the device and the player inside to prevent somebody from sniffing the interconnection between the HD-DVD, the physical optical reader, and the motherboard.  This thing is, I mean, just locked down.



LEO:  Well, they didn�t want a repeat of the DCSS affair.  They really didn�t want this to be cracked.



STEVE:  Like I said, it�s like � it�s sort of like, well, how we�re paying for what happened after CSS was cracked is that now we�ve just gone technology heavy.



LEO:  Well, but we may not pay if people decide that�s too onerous and don�t want to do it.



STEVE:  Well, get this.  When all of this public key crypto and an interlock has been established between the optical player and inside of your own DVD player, then the Media Key Block, which is this container of this amazing broadcast encryption subset difference revocation tree technology, it�s serialized.  The player checks the serial number of the one it has.  And after verifying the signature on this to prevent spoofing, if the disk you have inserted contains a newer version of the official Media Key Block, your player will update its copy on the fly to the latest one.  That�s how revocation is pushed out through the system.  So if you were unlucky enough to have the same player that somebody else had that had been cracked and was known to be cracked, playing a newer release of an HD-DVD could render the player�inert.



LEO:  Oh, interesting.



STEVE:  It would shut down and no longer be willing to play.  Now, in fairness, it�s not clear whether this would ever be used against a mass-produced product.



LEO:  Yeah, because you�d be putting a lot � I mean, I�d be pretty annoyed if this $1,000 or $500 player I bought stopped working.



STEVE:  Well, I think it�s more than annoyance.  I think you�d end up with class-action lawsuits because suddenly a�$500 piece of consumer electronics had been deliberately�neutered.



LEO:  I�m not surprised to hear it, though, because this is where all this stuff has been headed.  As I said at the very beginning, these companies want to reach out and get stuff off your drive, or even hurt you for pirating.  They really want to be able to reach into your computer.



STEVE:  Now, unfortunately, as always with security, we�re back to the weakest link issue, and that is this HDCP is the High-bandwidth Digital Content Protection created by Intel.  This is the way � it�s the so-called last mile.  It�s the link between your HD-DVD player and the screen that you got for Christmas last week, it�ll probably have HDMI connections.  Anything with an HDMI connector, certainly any consumer product, will have HDCP protection, meaning that it�s carrying license keys, and they are revocable.



So just as AACS has revocation � it�s funny, too, because the euphemism for this in the industry is �renewability.�  They want their protection system, their content protection system to have the characteristic of renewability, meaning that it�s able to adapt to breaches that are learned.  Anyway, the point is that HDCP turns out not to be very strong.  It is the weak link.  So after going through all of this phenomenal technology to bring the content to you, it turns out that there are known weaknesses which have been published and talked about.  But once again the DMCA has put a real pall on any ability to get specific about this as we once would have been because you�re a criminal...



LEO:  You can�t even talk about it.



STEVE:  ...if you do, exactly, if you lead to this.  So it turns out, though, that it looks like this is the weak link, and it�s the digital link.  So you could imagine that some determined pirates would come up with a crack for HDCP, use an uncracked player, and simply do a digital capture of the decompressed image back into digital form, recompress it, and remaster it.  And, I mean, I�ve got to ask myself, who is it that the content providers are trying to prohibit?  I mean, we know there will be pirated, mass-produced HD-DVDs in other places.  I have a friend who lives in the Philippines who�s visiting for the holidays.  And I was talking to him about this stuff, and he�s like, �What are you talking about?�  He says, �I walk down the street in the Philippines, and there are just racks of Hollywood movies selling for a couple dollars.�



LEO:  That�s the problem, I mean, those are the real�pirates.



STEVE:  Exactly.  That kind of piracy.  And there�s just no way that this is possible.  What Peter says � and we�ll talk to him about this next week � Peter describes it as requiring the laws of physics to be revoked.  Which is sort of his poetic way of saying what I have always been saying, is you cannot do this.  I mean, it�s not possible to protect because the devices that we have under our control do have the ability to decrypt the content and present it.  Otherwise they would be useless.  And if there isn�t perfect control all the way literally to our retinas, then there are ways to get around this.  So, I mean, it�s...



LEO:  There�s always going to be a hole.



STEVE:  It�s fascinating technology.  I thought people would find it interesting, as I have over the last week as I�ve brought myself up to speed on some of these acronyms and details, just how far the content protection industry has gone.  The fact that now you�ve got to wait a minute when you stick your disk into a player, I have heard that the second-generation players are considered very quick because it now only takes about 15 seconds.



LEO:  I have to say, on my Xbox 360 I don�t notice particularly that it�s slow, although there were a lot of complaints early on at how slow these HD-DVD, and Blu-ray particularly, players were.



STEVE:  Well, and now we understand what it�s doing.  It�s literally, I mean, this is...



LEO:  So they just put faster processors in, basically.



STEVE:  Yes.  It is a sophisticated crypto system which is sitting in little HD-DVD players to perform public key crypto on the wire linking, literally linking the optical drive to the motherboard because they just don�t want to have any exposed path that would allow people to extract this.  But again, Leo, I�ve never been a filesharing guy.  I�m proud to say that, I mean, I have a vast DVD and CD collection.  I appreciate the freedom of being able to do what I wish with content that I own.  I don�t have any pirated content here at all.  I buy things easily.  But I like being able to convert things to MP3 players or to watch TV or movies on my little Palm handheld.  It�s convenient for me, so it certainly falls within fair use.  But basically, as a consequence of the power of our digital technology, the content providers have decided the greater�the barrier they can build to limit that, the better.  And in fairness, you have to agree that there are probably people who duplicate commercial DVDs and give them to friends.



LEO:  Well, and I guess it�s the movie companies� rights to do this.  I guess the real question is will consumers put up with it.  And will they maybe not buy HD-DVD players or Bluray players because of this?  Will they maybe stay away from Vista � and this is what we�re going to talk about next time � because of all the onerous copy protection and stuff put into it?  And I have a feeling as consumers learn about this they might have something to say about it.



STEVE:  You know, I don�t think it�s going to matter, frankly.  I think, sadly, what we�re seeing is we�re seeing the end of an era, or as the content producers would say, an error, in the delivery of this media.  Now, certainly DVDs will not go away.  What we�ll see is we will see HD-DVDs and DVDs of the same movies, as we do now, being released.  And in fact I just, because I wanted to start really seeing the HD-DVD difference, I bought the �Mission Impossible III� set and of course �Tomb Raider,� the first one, because what�s not to like about Lara Croft, and Angelina Jolie in HiDef has got to be a good thing, because I want to begin to experience what consumers are going to be seeing.



LEO:  I have to say I love it.  I�ve been watching � I watched �King Kong� and �Seabiscuit,� and they just look fantastic.  In fact, it seems on a good, big plasma screen it seems better than the movie theater.  I see more detail.  Maybe it�s just because I�m closer.  I mean, it just really looks great.



STEVE:  Well, I think probably, exactly, certainly there can�t actually be more detail than, for example, on a film.  But the fact that you�re closer to the screen means you end up seeing � you have a larger frame occupying a larger percentage of your retina.  And so in terms of the resolution of your eye, with the screen being close enough, now there are enough pixels that that matches pretty well, so you actually end up seeing a lot more.  My feeling is, first of all, when I squeeze something that my TiVo has captured from TV down to 480x320, it�s certainly lower resolution than the media content providers are worried about protecting.



For example, there has been some issues about, for example, this notion of constricting resolution, which is what we�re going to be talking about next week, which is part of the solution which some players are offering media providers, saying look, rather than disabling non-encryptable outputs, how about if you reduce the resolution?  Well, that�s going to annoy people who have analog outputs like component video that are specifically, you know, that they got because they wanted to do HD content, and then have the delivery system deliberately make it fuzzy, which is what apparently is going to be possible.  But so I have to ask myself, I think most people want to buy DVDs and watch them.  Certainly there are people who are unwilling to do that, who would�prefer...



LEO:  You�re saying the people who would care are in the�minority.



STEVE:  Well, and the movies will still always be available on DVD.  I don�t think we�re going to see DVDs die anytime soon, and they�ve been cracked a long time ago by, as you said, originally by DECSS.  And now there are lots of almost push-and-click sort of solutions for that.  So...



LEO:  Yeah, but they were never easy enough that a lot of people did it.  So I think you�re right.  I think it�s a thin layer of people that care about this stuff.  And most people are just going to be cows and just say, okay, we�ll take it.



STEVE:  And Leo, what are you going to do with 40 gigs of cracked data?  So you decrypt it, and it�s 40 gigs.



LEO:  Yeah, that�s a good point.



STEVE:  I mean, even on � yeah, I mean, it�s much nicer to have it there on a little...



LEO:  Just keep it on the DVD, yeah.



STEVE:  Exactly.  Have it sitting on a little disk in the album instead of...



LEO:  I guess what I was thinking about is more with Windows and operating systems.  If operating systems become encumbered with this cruft...



STEVE:  We know what word you were going to use.



LEO:  Yeah, people are going to viscerally respond.  They may not say, oh, shoot, I can�t copy a DVD.  But they may say, boy, I don�t really like this operating system.  I�m not sure why.



STEVE:  Yes.  This is a perfect segue into our next episode because I wanted to create this foundation for next week when we talk to Peter about his paper.  I�m going to put a link, and I�m sure you will, too, a link to Peter�s paper.  He was evolving it rapidly over the first week or two.  The last copy I got was December 28.  And I looked yesterday, and it was still December 28.  So I think it sort of settled down for him.  In our correspondence he was saying that he has just been buried under email and responses.  So it�s really going to be fun to first talk to our listeners about what he has written.



I encourage people to read this paper between now and next week so that you know what we�re talking about, you know what captivated me on my plane flight to Northern California by the time I was halfway through the second page, and what motivated me to find out what is AACS.  Because what essentially Vista is, is AACS brought to Windows.  And this is what Peter analyzes and what we�re going to be talking about next week are the user side consequences of Microsoft deciding to turn Windows into a content delivery platform with this much security.  Because baby, you wouldn�t believe what they have done to Windows.



LEO:  Look what they�ve done to my Windows, Ma.  But we�ll cover that next week on this very episode, now that we have a little foundation to understand what AACS is up to and how it�s going to impact it.  And we will have Peter Gutmann join us, which is going to be fun.  We don�t do a lot of interviews, but this will be fun.



A reminder that you can find this podcast and its 16KB version along with transcripts � this might be a worthwhile one for the transcript � at Steve�s site, GRC.com.  That�s also where you�ll find SpinRite, which is the program that Steve created some years ago, now in Version 6, and it�s the ultimate hard drive maintenance and, I might add, data recovery utility.  Really a great program.  You have a letter, I think.



STEVE:  Oh, I always do.  Actually SpinRite was busy over the holidays.  This is a really quick one that I really liked, though, because it talks about sort of a different aspect of SpinRite.  He says, �Hello there.�  This is a guy named Dennis.  He says, �A few weeks back I started noticing a troublesome sector.  One file was stubbornly refusing to be read.  Sometimes it worked; most often it didn�t.  I fired up SpinRite, and once done the file was fully accessible, even though SpinRite found no errors and flew right through the troublesome area.  Yesterday it started to act up again, and this time more severe than before.  SpinRite to the rescue,� he writes.  �This time SpinRite immediately discerned that the sector had troubles, and a few seconds into DynaStatting got a perfect read, and subsequently told the drive to swap out the faulty one.  Needless to say, the file is now fully accessible.  Many thanks, Steve.  SpinRite continues to be the best $89 I ever spent.�



LEO:  So that was a case of an intermittent problem, and SpinRite didn�t catch it the first time.  But when it did � what is DynaStat?



STEVE:  What happened was, this sector was on the verge of failing.  And so when SpinRite first looked at it, it was able to get a perfect read, and the drive wasn�t concerned enough about it either.  You may remember that a while ago I talked about how ECC, Error Correction Code technology, is now always being used by drives, and that the ECC correction allows the drive to gauge the size of the error that it�s correcting.  And at a certain point the error gets so long that the drive decides, oops, I�d better remove this sector from service.  So DynaStat is the technology that I first incorporated in SpinRite 3.1.  It stands for Dynamic Statistics.  Because SpinRite is actually able to use nonstandard drive commands to read the data from unreadable sectors, which nothing else that I know of does, which is one of SpinRite�s tricks, is it performs multiple re-reads and builds a database of different data that it gets from the sector, and is able then to reverse engineer what the original data was.  So it was able to basically figure out what the data was, correct it, tell the drive, okay, you�ve got a problem here, let�s put in a spare, and then SpinRite rewrites the corrected data into the newly allocated sector.  So that�s some of the magic going on just, you know, under the hood.



LEO:  Very cool.  Well done.  SpinRite to the rescue, as he says.  GRC.com for that, and of course a lot of Steve�s free stuff.  How�s SecurAble coming along?



STEVE:  It�s done, actually.  SecurAble, the utility I talked about two weeks ago, is finished.  I looked in my newsgroup, I made a 0.99 version available to the people in our newsgroup.  They�re reading through all of the text that it encompasses to find typos, and apparently they�ve found some.  So probably in two weeks I�m going to formally release it.  I need to get a web page up now in order so that it makes sense to people.



But it has turned out so cool, Leo.  It turns out that my tablet PC, my little HP, my TC1100, has a processor that can support hardware DEP.  I never knew it because it�s turned off.  It turns out the BIOS is turning it off, and there�s no way to turn it on.  So SecurAble told me that my Pentium�M can offer me hardware DEP support, even though the hardware won�t.  So the next utility, which will be called DEPuty, it will have technology to allow you to enable things which your BIOS has disabled.



Microsoft recently got a concession from � I don�t know if concession is the right term, maybe an agreement � from all system manufacturers to stop disabling hardware DEP by default.  Many of them had been.  You had a bunch of users who were using SecurAble found out that theirs also was turned off.  In their case, they did have BIOS options they�ve never paid attention to that allowed them to turn it on.  The same thing is true of the virtualization technology.  So SecurAble is now telling people if they�ve got 64-bit capability, hardware DEP capability, and virtualization.  So anyway, we�ve got some good stuff on the�way.



LEO:  Can�t wait.  Can�t wait.  That�ll be, what, next week or so that you�ll get that out?



STEVE:  I think, well, I�m working on it now.  And so next week we�re going to talk with Peter about the consequences of the marriage of AACS and Vista; and then the following week will be our formal release and announcement, and I�ll talk about SecurAble.



LEO:  Excellent.  GRC.com.  ShieldsUP is there, too.  Lots of other free software.  It�s really a great resource.  Steve Gibson, thanks for joining us.  Happy New Year.  And we�ll see you next week with a discussion of Vista and what�s wrong with it, from the point of view of Peter Gutmann, who is a well-known security expert.



STEVE:  Right.  And I want to, again, encourage people between now and then � you�ll have a link to it, I�ll have a link...



LEO:  Homework.  Do your homework.



STEVE:  ...on the show notes.  This is a riveting paper that Peter has written.  It�s written...



LEO:  It�s not very long.



STEVE:  ...in a fun, easy-to-understand fashion.  Make sure, though, that you read all the way to the end.  When I was reading the December 28 release, it looked to me like he had removed a lot of juicy bits from the paper.  It turns out that he moved them to numbered notes at the end.  So don�t stop until you�ve read the whole thing.  There�s a bunch of really cool stuff at the end, too.



LEO:  He also responds to some criticism and so forth, so that you can see the back...



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#74

DATE:		January 11, 2007

TITLE:		Peter Gutmann on Vista DRM

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-074.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Peter Gutmann, the author of the highly controversial white paper detailing the significant cost of Windows Vista�s deeply-entrenched digital rights management (DRM) technology, joins Leo and Steve this week to discuss his paper and his findings.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 74 for January 11, 2007:  Peter Gutmann and the cost of Vista content protection.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



It�s time for Security Now! with the fabulous Steve Gibson.  And this in some ways is a part two.  Last week we were talking about some pretty tough stuff:  content protection, the new AACS content protection that�s going to be part of Vista, part of any HiDef DVD player you have.  All of this was kind of prompted by an article that just spread like wildfire over the Christmas break.



STEVE GIBSON:  Right, well, it generated a lot of controversy because it became clear from the article published by Peter Gutmann, who�s in New Zealand, a New Zealand-based, very well known, good reputation security analyst.  He took a look at the consequences of essentially putting this AACS, the Advanced Access Content System, which has been assembled by a number of hardware companies in order basically to appease the interests of Hollywood, in order to say, look, this is the way we�re going to protect the next generation of content.



As we saw last week � and the reason we spent last week�s episode was to create some historical context for both the legislative side and the technical side.  And I talked last week about basically AACS is a phenomenally complex technology that involves state-of-the-art encryption.  It involved some stuff you just can�t even get your mind around.  I mean, I will never try on Security Now! explaining the subset difference tree system for allowing keys to be revoked by keeping those specific players from being able to perform the decryption.  It�s mind-numbing, what they�ve done.



And so it�s one thing for that to be in an HD-DVD player.  And in fact we�ve already seen, consumers have seen the consequence of that when they stuck a DVD into their first-generation players, it would take up to or in some cases more than a minute for the player and the disk to negotiate all of the crypto going on just internally within the player.  And Leo, I was thinking about how you had commented that, when you stuck your HD-DVD on your Xbox 360, it didn�t take long.



LEO:  Well, it�s got a faster processor.



STEVE:  Exactly.  Well, talk faster, that�s a monster.



LEO:  It�s got three 3GHz Power PCs...



STEVE:  Exactly.  Exactly.  So it�s a very different platform there than a typical consumer drive, where they�re trying to keep the cost as low as possible.



So anyway, I�m excited.  We�re going to have Peter joining us here in a moment from New Zealand because we wanted to talk to him, get his side of this, talk about what the paper that he wrote is about.  And I just wanted to sort of give a little bit of a preface and explain that basically Microsoft has decided that they want Vista to be able to deliver this kind of content.  And what Peter�s paper is about is essentially the cost of delivering this content.  And what it means is that so many aspects of our PCs, which have been fully documented, been public domain, been anyone could develop a display card, for example, that�s no longer the case.  If you�re going to have any foot in this next-generation game, you have to sign up and apparently pay hefty license fees just to participate.  And if you don�t get certificates, which are subject to spontaneous revocation, if you then subsequently misbehave, or in fact I read one of the AACS organization documents said that you could be revoked if you failed to pay your annual dues.



LEO:  Your card would stop working in my PC.



STEVE:  Exactly.  The hardware that the consumer purchased could be shut down.



LEO:  Never buy a card from somebody who�s about to go�bankrupt.



STEVE:  That�s a very good point.



LEO:  I mean, the whole thing is nuts.  This is just nuts.  We�re going to talk to Peter in just a bit and get the details.  But I want to thank, before we get going here, I want to thank Astaro Corporation, our sponsor for Security Now!.  They really support us financially, and they make this show possible.  And so you could do us a favor.  If you�re a small or medium business looking for some real protection, not just anti-hacker or firewall, we�re talking spam, viruses, VPN and intrusion protection, content filtering, too, this is an industrial-strength firewall.  It�s a complete protective device.  It�s a simple, easy-to-use appliance.  And you can try it for free.  Just call Astaro, Astaro.com, 877-4AS-TARO, and they will set up a free trial of an Astaro Security Gateway in your business.  We�ve talked to many, many people who have done this and are very happy that they heard about Astaro on Security Now!.  And by the way, if you�re a non-business user you can also download the software for free:  www.astaro.com.  We thank them for their support.



Let�s call New Zealand, what do you say?



STEVE:  Let�s talk to Peter.  Great.



LEO:  Let�s just start off the interview by asking you about your background.  You�re a fairly well-known security researcher, I gather a computer scientist, as well.



PETER GUTMANN:  So my background is � it�s actually a bit of both academia and industry.  I have an open source security toolkit which is available under a dual license, so it�s both GPL or commercial.  It�s a Sleepycat license, if you�re familiar with that.  And people can choose what they want.  And when I�m not working on that, I get to play with any kind of security stuff that happens to interest me.  So, for example, with Vista, just before Christmas I had a bit of spare time.  And some people had been talking about this in private, and I started going out and looking at the specs and was kind of frightened at what was in there.  And so I thought I should maybe do a write-up of this, an analysis, to let people know exactly what�s hiding inside Vista.



STEVE:  In fact, it was because of Peter�s crypto toolkit that he and I first had a dialogue.  It�s funny, when I was sending email back and forth to him it was disappearing into one of my folders, and it took me back to a conversation Peter and I had had briefly back in 2002, about five years ago, and I was asking him about the licensing terms for his toolkit because I was looking around for something that I could trust to sort of use for core crypto stuff.  And so we had a dialogue back and forth.  And of course Peter�s also done some work in secure hard drive erasure.  And he has an often-quoted piece of work that talks about how to deeply erase magnetic media.  And so of course from my background with SpinRite there was another connection there.  So I�ve seen Peter�s name around a lot.



And in my case someone, I think it was in the GRC newsgroups, posted a link to Peter�s article.  And as I mentioned on our podcast last week, I printed it out, didn�t have a chance to read it before taking off to travel for the holidays.  But I was on an airplane flying home, and by the time I was on the second page I was just riveted by the content.  And of course, as we talked about last week, essentially there�s a next-generation crypto system for protecting high-value content, which is known as AACS.  And what Microsoft has done is they�ve decided they�re going to make Vista be a valid, secure delivery platform for AACS-protected content.  And so basically what Peter�s paper does so well is to open people�s eyes about the real-world consequences of turning Vista into a sort of a next-generation DRM platform.



LEO:  For those of you who haven�t read it, it�s called �A Cost Analysis of Windows Vista Content Protection.�  Let me just give you the executive summary, and then we can go point-by-point through some of these things.



STEVE:  Or the executive executive summary.



LEO:  I know, I love the short-short version.  But let�s start with the little longer version.  Windows Vista includes an extensive reworking of core OS elements in order to provide content protection.  That�s that AACS you�re talking about for premium content, typically HD data from Blu-ray and HD-DVD sources.  But here�s the gist of it.  Providing this protection incurs considerable costs in terms of system performance, system stability, technical support overhead, and hardware and software costs.  And these issues affect not only users of Vista, but the entire PC industry, since the effects of the protection measures extend to cover all hardware and software that will ever come into contact with Vista, even if it�s not used directly with Vista, for example hardware on a Macintosh or on a Linux server.  Then the executive-executive summary:  The Vista content specification could very well constitute the longest suicide note in history.  You read all of that stuff, Peter?



PETER:  Yeah.



LEO:  There�s a lot of material online from Microsoft.  I mean, they�re not keeping this a secret.



PETER:  No.  Well, the best paper is the first one I give in the references, the �Output Content Protection and Windows Vista,� which was presented at the WinHEC conference in 2005 by Dave Marsh, who is the program manager for, as far as I can tell, for DRM inside Microsoft.  And that goes into an extraordinary level of detail about all this stuff.  But, yeah, they have a number of other public papers that describe what they�re trying to do.



STEVE:  One question I had, and I�ve read the AACS specs, and I�ve got sort of, I think, a relatively good handle on what AACS is, I didn�t see in the specs anything about this notion of constriction.  And I�m wondering if that�s something that Microsoft has done to sort of try to appease the content owners while not completely disabling non-securable outputs.



PETER:  Right, well, the thing is they�re terrified about the analog hole.  Well, not so much Microsoft.  I think Hollywood is terrified of the analog hole.  And so they�re desperately trying to make sure that, you know, they can�t close it entirely, but they can at least make the quality of the content that goes through the analog hole so poor that it�s not worth copying.



STEVE:  Right.  Do you have some sense from � I know that you mention in your paper that you have other sources that have required that they remain anonymous, and in fact you went to the length of deliberately restating some of the things they told you, trying to maintain accuracy, but really to protect their identity.



PETER:  Right.



STEVE:  And so the one thing I�m wondering is, can you give us some sense for where this is coming from?  That is, how much of it is push from Hollywood and how much of it is Microsoft sort of trying to deliver something maybe that no one really wants?



PETER:  I think it�s a bit of both.  I mean, Hollywood has this huge wish list of stuff that they�ve been pushing for years and years.  And, you know, people have analyzed the technical side of things and see that what they�re trying to do is impossible, you know, in terms of closing the analog hole and making content uncopyable.  There�s a wonderful quote from Bruce Schneier saying that trying to make content uncopyable is like trying to make water not wet.



LEO:  I love that.



PETER:  And there�s a whole lot of legal CYA in there in the specifications where they say device manufacturers must demonstrate their commitment to the party line.  Rather than saying you must do this, this, and this, they say you must demonstrate that you�re strongly committed towards content protection.  And I think probably what Microsoft is doing is the same thing.  They want to demonstrate to Hollywood that they�re really, really committed towards content protection.



LEO:  That�s a lousy specification, not telling you what to do, but just saying prove it.



PETER:  Right.  But...



LEO:  Prove you care.



PETER:  Yeah.  But the problem is a lot of this, I think, is driven by legal worries.  And so if they say you must do this, and then it gets broken, they�re in trouble.



LEO:  Ah.  So they can�t be specific.



PETER:  Right, they can�t afford to be specific because, if they end up being wrong, then they�re liable.



STEVE:  And I guess one of the things that is not immediately obvious, even in � well, I guess your paper sort of began me thinking down this direction.  But then reading the AACS stuff and looking at the revocation technology which has been bundled into this, it�s very clear that, while Microsoft is bearing some responsibility, there�s a tremendous onus also put, for example, on graphics card makers.  I mean, they�re hugely incentivized to make their cards perform and their drivers perform really at a level of quality that we�ve never asked from them before.



PETER:  Right.  And that�s particularly nasty for them because they�re not given any hard and fast rules.  They�re just told that you�d better show a lot of compliance.  And if it�s not enough, you can guarantee that you�ll be in hot�water.



LEO:  Well, Paul Thurrott, who does a Windows podcast for us, made the point � I�d like to hear you address it � that the alternative for Microsoft is to be a second-class citizen in terms of supporting content.  You play by Hollywood�s rules, or you don�t play at all.  What�s your response to that?



PETER:  I think that�s very much a red herring.  And in fact I�ve been updating the document constantly to cover this, and I addressed that in a very recent release.  Microsoft owns, I don�t know what it is, 95 percent of the market or so.  And particularly for desktop OSes, they own pretty much the entire market.  They could quite easily say to Hollywood, you know, we�re not going to put this stuff into the operating system because it severely degrades the performance and reliability and stability and so on and so forth.  Take it or leave it.  You know, this is assuming that Hollywood relies entirely on Microsoft � sorry, that Microsoft relies entirely on Hollywood.  Well, Hollywood relies entirely on Microsoft.  If Microsoft said we refuse to do this, Hollywood can�t afford to ignore 95 percent of the market.  So I think that�s a bit of a red herring.



LEO:  So companies like Apple, people who make Linux distributions, could safely ignore this content protection and say, well, you know, we don�t have to do it, let Microsoft do it, we won�t do it.



PETER:  Right.  And that�s, you know, so the example you cited of the suicide note, that was actually taken, just as sort of a bit of background information, that was taken from the British Labour Party�s 1983 election manifesto, which someone said was the longest suicide note in history.  The Microsoft suicide note is a bit longer.  But the thing is, that was so bad that their opponents actually printed it out and used it as propaganda for their own cause.  And so it could well be that Apple�s going to go and point out some of these really nasty things inside Vista and say, look at how bad this is.  Buy our computers and our operating system instead.  And certainly the Linux people are going to use it for propaganda to make Linux look good.



LEO:  Right, right.  So this is a technical podcast.  So I�think we should probably, Steve, walk through these various�consequences of this copy protection scheme, especially since we�ve already talked about AACS in detail last episode.



STEVE:  Right.  I think that the point that Peter�s paper makes so well is that � and this is actually how he and I began corresponding via email � is that the PC has traditionally been an open platform.  I remember very clearly when I got my very first real IBM PC with, ooh, a big 10MB hard drive, the technical reference manuals you could get with it had the schematics of the machine and the source code of the BIOS, just provided by IBM as part of the package.  And that really sort of came from Apple because the Apple II had the same thing.



LEO:  And it really kick-started the PC revolution.



STEVE:  Oh, I mean, my first PC application was a little thing called FlickerFree which replaced a chunk of the IBM PC BIOS because it was so poor at scrolling the CGA, the color graphics adapter card.  And so I was hugely empowered by the fact that IBM had left the platform so open.  And of course everyone remembers how the PC just exploded with all this add-on software and hardware.  And of course IBM famously sort of backed away from their open stance when they created that horrible Micro Channel Architecture, which was pretty much stillborn.  But still, I mean, ever since then the PC has been fully documented.  You could get specs.  You could find sample code.  I mean, it�s just been this tremendous environment.  And what really upsets me is to do what Microsoft has decided they�re going to do requires closing down major chunks of the architecture.



LEO:  Well, let�s start with Section 1, disabling of functionality.  And you talk about how S/PDIF will no longer work with protected content.  You talk about how, if you bought a video card that supported HDMI digital video with HDCP, you�re going to have to buy another one because they didn�t really work when they first came out?



PETER:  Right.  So the problem with that is, in order to � HDMI is basically a slight variation of the standard DVI output that you have on things like LCD flat panels.  In order to protect that, you have an encryption mechanism called HDCP.  And to do that you need to put encryption keys onto your video card.  The problem is that it costs money to put these individual encryption keys onto each video card.  So to reduce costs, the card manufacturer has simply omitted them.  So if you bought a supposedly HD-ready video card...



LEO:  It won�t work.



PETER:  It won�t work because it doesn�t handle the encryption.



LEO:  If you spend money on S/PDIF, it won�t work because it has to be disabled because there is no protection on that.



PETER:  There�s no protection whatsoever, yeah.  And that�s the nasty thing with sort of audio fanatics or anybody who basically wants to produce high-quality audio from a PC or use some sort of digital interface and maybe even optical output, connected to some expensive amplifier or whatever.  And because there�s no protection involved in the audio output, that has to be disabled.



LEO:  Now, we should make that clear.  It�s disabled only when you�re playing back protected content like an HD-DVD or a Blu-ray DVD.  I mean, it�s not always disabled.



PETER:  It�s not always disabled, no.  On the other hand, it�s problematic because, if you look at the Windows specs, sorry, the Microsoft specs for the content protection, let�s say you�re playing � you�re making a Skype phone call and in the background you�re playing some protected-content music of some kind.  Because that all goes through the same sound output system, that kind of infects everything.  So the protected content infects every other content that happens to be going through the system at the time.



LEO:  We in fact wouldn�t be doing this interview now because I use optical outputs.  So they�d be shut down.



PETER:  Well, they�re not exclusively shut down.  Again, reading the specs, I think probably what most manufacturers would do is just shut it down.  But what the specs say is that, depending on how much protected content is present, you partially shut it down.  So, for example, if you�re playing protected content, and it�s very quiet, then some of it will be shut down; and as the volume increases, more of it gets shut down.



LEO:  There�s also this issue � and this is to prevent the analog hole, I gather � of disabling or really reducing quality of other outputs so that, if you don�t have HDCP, you can watch it, but it�s really only 480i.



PETER:  Right.  So Microsoft say that any display device that has a resolution of more than 520K pixels, which in practice is a resolution of about 800x600, has to have its output degraded.  Now, if you look at the Vista specs, in order to run Aero you need a resolution of 1024x768.  So�basically it means that anything connected to a Vista�machine running the Aero interface will have its output degraded.



LEO:  When will the output be degraded?



PETER:  If there�s premium content present.



LEO:  Unless you have an HDCP-enabled card?



PETER:  You need an HDCP-enabled card and an HDCP-enabled�display.



LEO:  Ah, so my display isn�t going to work.



PETER:  Right.  So it�s, well, even then � so what Microsoft just did is you have to put a piece of hardware into your video card called a �constrictor,� which basically downscales the video to some extremely low resolution and then upscales it back again.  So effectively you get a very low-quality output.  But because this requires custom hardware or custom drivers or whatever, stuff that the manufacturers haven�t actually been able to put into their cards yet, it seems that at the moment when people are trying to play HD content or premium content, they simply don�t get any output at all.



LEO:  Great.



STEVE:  So it was my feeling, and I guess this is from something I read in some forums, that in fact the current HD-DVDs would play, for example, on a consumer HD-DVD player, even out of their component outs, because the policy that goes along with the content was not yet so restrictive that the policymakers were saying we�re not going to allow analog output to happen.



PETER:  Right, yeah, because they�re so afraid of consumer rejection.  I mean, obviously, if you�ve bought an HD player and some huge plasma screen and spent thousands of dollars, and you put a disk in, it doesn�t play, you�re not going to be very happy.  So at the moment, yeah, they�re turning off this constriction.  However, how Windows handles this is another matter.  If you look at � I�ve been reading a pile of web forums about this.  And the thing you see over and over again is I bought a computer, it came with an HD drive, I put the disk in, it didn�t play.  So maybe Windows doesn�t honor that or doesn�t handle it that well.



LEO:  It�s interesting because I have an Xbox 360, also from Microsoft, with an HD-DVD drive.  It doesn�t have HDMI out, doesn�t obviously have HDCP.  It plays high-quality over component outputs and looks great.  I guess they just haven�t enabled it.  I mean, here�s a Microsoft product where they haven�t made that compromise.



PETER:  Right.



LEO:  You think that Vista will.



PETER:  From the reports from beta testers and so on, from the reports we�ve been seeing, I mean, it�s really hard to predict the future because it hasn�t been officially released yet.  But from reports from beta testers, a standard complaint is that they put the disk in the drive and it doesn�t play.



LEO:  Let�s talk about some other consequences of this copy protection.  Some of these are serious to a limited audience.  For instance, open source hardware support, it�s now going to be very difficult to write an open source driver for any of this hardware.



PETER:  Right, yeah.  So one of the things they require, one of the things they�re worried about is someone creating some emulation of a hardware device, so you emulate perhaps some software, or perhaps some hardware, a sound card or a video card or whatnot.  And then Vista sends the decrypted content to your artificial sound card, your artificial video card, and your thing got direct access to it.  The reason why they�re worried about that is because this is exactly what people have done in the past under Windows XP.  They�ve created sort of loopback devices or whatnot, and Windows has sent the content to some loopback device or some artificially created device driver that pretends to be the real thing.



LEO:  This way you could capture keys and things like that.



PETER:  Well, not so much capture keys, capture content.



LEO:  The content itself.



PETER:  Right.  And so to disable this they require something called HFS, Hardware Functionality Scan.  Which means that the device driver has to probe the hardware and try to determine whether it�s genuine hardware or not.  So it executes undocumented features or exercises some sort of undocumented functionality or pokes around inside the thing in such a way that hopefully it can�t be faked by a malicious piece of hardware.  The problem is, in order to do this you can no longer document the internals of the device because, if you did, then someone else could write an emulator for the device that pretends to be the real thing.



LEO:  So you can�t publish specs, and you can�t publish source code.



PETER:  Right.  Now, again, the language in the spec is kind of wishy-washy.  It doesn�t say you can�t publish any specs at all.  It simply says that some aspects of the device will have to be kept proprietary.  But that�s kind of nasty for anyone writing open source software because, if you�ve got a graphics card, you need to know exactly how it works in order to write the drivers for it.  And if half the thing is undocumented, it becomes very hard to support it properly.



LEO:  Isn�t it possible that just the undocumented part will be the premium content playback, and everything else will be documented; and you could still write a driver for Linux, for instance, but it just wouldn�t play back HiDef movies?



PETER:  Well, it�s not that you can partition a card into one specific premium content, but everything else is public.  What they are requiring that you do is that you exercise, and again the specs are vague, but some sort of functionality of the card, the graphics rendering engine as an example, like in several cases, and to determine whether it really is a genuine card or a copy of the thing or an emulator that someone�s created.  And leaving the whole graphics rendering engine undocumented is a pretty nasty denial of service on anyone who wants to write open source drivers for it.



STEVE:  Well, and the other thing that I think is really interesting, and Microsoft�s spec makes this very clear, is they have this notion of a user-accessible bus.  And essentially, if you have a separate graphics card � and they make a big deal about the difference between an integrated graphics subsystem on the motherboard, where you don�t have a bus exposed, and this notion of a separate graphics card.  Because again, that bus is an opportunity for someone to snoop the bus and capture content as it�s going from the motherboard up to the graphics card.  So there�s a whole �nother level of technology where essentially they�re doing a modified AES 128 encryption on the fly at high bandwidth, which turns out to be very difficult to do.



PETER:  Right.  And I think the threat model for that is, if you�ve read the book �Hacking the Xbox,� the guy who first sort of broke the security on the original Xbox...



LEO:  Bunnie Huang, yeah.



PETER:  Right, attached a FPGA-based logic analyzer to the system bus.  And so they�re trying to encrypt the system buses to stop exactly that sort of attack.  It�s kind of interesting, if you read through the specs and you think back, okay, what are they trying to defend against, here was a published attack, and presumably they�re worried about exactly this kind of attack.  And so they�re taking these very unusual and probably excessive measures to try and defend against it.  And the problem is, again from Microsoft�s own documents, the current processes simply don�t have the horsepower to do both video processing and encryption of high-bandwidth content.



STEVE:  The other thing that I found interesting was that Vista introduces this notion of a so-called �protected environment� where applications, or that is to say processes running within what Microsoft calls the �Vista protected environment,� are inaccessible to a much greater degree than existing applications, for example in XP, would be, the idea being to prevent people from sort of the outside of this protected environment from being able to snoop into other things running on the same system.



PETER:  Right.  And that�s one of the sad things about this whole Vista DRM effort.  They�ve put a huge amount of work into creating this protected environment.  Now, imagine if they�d instead used that to protect against viruses and malware and rootkits and so on and so forth.



STEVE:  Exactly.  It�s one of the things that I think I may have commented on last week was that, as you read this, you get a sense for this phenomenal amount of industry which has gone into turning Vista into this platform that can play HD-DVD and various types of other source forms of high-definition protected content.  It�s not something that it�s�clear that a majority of Vista users will even take advantage of.  Yet even so, all that work was done instead�of all these other features that we were supposed to�be getting in Longhorn that were stripped out.  And they�ve basically burdened the operating system with all this technology.



LEO:  Well, ironically, they�ve made it more susceptible to malware.  These tilt bits � talk a little bit about the tilt bits, Peter.



PETER:  Right.  So what tilt bits are is � the name�s taken from pinball machines.  We had tilt sensors to monitor physical interference with the device.



LEO:  Yeah, if you pick up the machine and get the ball in the hole, it�s tilted, and it fails.



PETER:  Right.  And so Microsoft have done or required that hardware manufacturers do pretty much exactly the same thing.  The nasty thing with this is that, well, to put it bluntly, it makes your hardware in your system a lot less reliable.  The typical PC is thrown together out of all sorts of random bits and pieces with different tolerances; and half the parts are made by the cheapest possible manufacturer, so a lot of them are cheap and nasty.  So they�re designed to have a certain amount of tolerance for voltage fluctuations and strange bus signals and bugs in device drivers that set hardware bits wrong and so on and so forth.  The problem is that, if you do get these strange voltage fluctuations or strange noise on the system bus or whatever, that could also be a sign of attack.  And so Microsoft have said that hardware has to monitor for any of these peculiarities.  And if they�re found, then it sets these tilt bits in a register somewhere.  Vista polls these tilt bits; and if any of them are set, it reacts in some vaguely specified but somewhat drastic manner.



LEO:  Will it shut down, or crash, or put up a blue screen?



PETER:  What the specs say is that � I�m just trying to find the exact quote because it�s vague enough that I�m actually going to have to quote Microsoft rather than trying to figure out what it is they mean.  Well, they say it initiates a complete reseat of the graphics system, and it also mentions it�s a restart.  Now, I don�t think that�s a restart of the PC as a whole.  Presumably it�s just a restart of the graphics subsystem.



STEVE:  Yes, and it requires a reauthentication of the whole system to be self-consistent internally.



PETER:  Right.  So I think the effect is going to be that, if any of these tilt bits get set, there will be some drastic amount of processing and change of system state going on in Vista.  And I don�t know exactly how noticeable it�s going to be, whether it takes five seconds or 10 seconds or half a second or whatever.  But whatever the case, if some slight glitch is detected, then Vista�s going to do some serious reconfiguration of system state for some fixed amount of time before anything else can happen.



LEO:  Which as you point out makes it just prime for a denial of service attack from malware.



PETER:  Right.  Well, yeah.  I mean, if you want to cause a disturbance in the system, then just trigger one of the tilt bits and watch Vista drive itself nuts with doing a restart of the subsystem.  But even then, you know, someone mentioned on a blog, and I think this is quite a neat quote, it was something like, �Tilt bits are quite clearly insane.�  And they are.  I mean, what hardware manufacturer would voluntarily make their hardware less reliable and less stable?  Which is what tilt bits are doing.



LEO:  Does all of this content protection, okay, it affects reliability.  Does it also slow the system down?



PETER:  I would imagine it does because you�ve got this huge layer of bloat sitting in there, intercepting all audio and video output and content output and processing.  This doesn�t come for free.  I mean, again, from the specs, Vista is certainly continuously polling and checking hardware and checking tilt bits and checking all sorts of other things.



STEVE:  Right.  I was just going to say that the spec does require that software drivers at every 30 milliseconds, which is essentially 30 times per second, are going out and polling the hardware in order to maintain an intimate relationship with the hardware in order to try to catch anybody playing any games.  So even when your system is not actively doing something, you�ve got drivers that are busy making sure that nothing continues to happen.



PETER:  Right.



LEO:  What you�re describing is an operating system that is essentially insanely paranoid.  It�s gone off the deep end.



PETER:  That�s true.



LEO:  30 times a second.  Is it hacking me?  I mean, that�s�crazy.



STEVE:  It really is.  Now, there�s one other aspect that has occurred to me since we last talked about this.  I�d love to get Peter�s opinion.  People listening to this so far in our last podcast might be thinking, okay, so Vista�s not going to let me watch HD, this newfangled content.  But what has also occurred to me is that Vista is sort of retroactively going to become hostile to many of the things that people used to be able to do, for example, ripping DVDs, decrypting DVDs.  Where the technology does exist for that, suddenly there�s the ability to prevent that from happening, and that does seem to be what Vista is doing.  So it�s actually backing people away from things they were able to do historically under Windows 2000 and XP, taking things�away.



PETER:  Right.  Although someone else has pointed out that the Vista content protection is so thoroughly obnoxious that it�s actually going to be a major driver towards piracy.



LEO:  You quote muslix64, the guy who came up with the crack of HD-DVD.



PETER:  Right, exactly.  I mean...



LEO:  That was his incentive.



PETER:   Yeah.  The reason why he was doing this isn�t because he�s a pirate, but because he bought a system with all the HD components in, and he couldn�t play back his video.  So if you�re an average guy, and you�ve gone out and bought a system with an HD player and high-resolution monitor and so on attached, you put in a disk and it won�t play, what are you going to do?  You�re going to go out on the internet and find some software to crack the copy protection because it�s preventing you from playing legitimately purchased content.  So it could actually be a huge incentive towards piracy and towards bypassing the copy protection because it�s so obnoxious that people just want to get it out of the way.



STEVE:  Peter, one other thing that I keep asking myself is we know, just due to the nature of physics, as you said in your white paper, it is impossible to do what Microsoft is trying to do, that is, there is no absolute control over the remote delivery platform.  So it�s going to end up one way or another being cracked.



PETER:  Right.



STEVE:  And the people who have the most incentive are more the commercial-grade pirates that are really mass-producing pirated content.  We know they�re going to come up with a way around this.  So to me this seems like a huge amount of burden to put on people�s grandmothers who are never going to pirate this content.  And they�re doing it even though it can�t be effective.



PETER:  Right.  Well, again, you�ve got the fact that you have to show a certain level of commitment to the cause.  They can now go back to Hollywood and say we�ve done the best we can towards showing that we�re on your side.  Give us the premium content.



STEVE:  So it�s really not about who are they trying to target, it�s saying to Hollywood no one to the best of our ability is going to be able to use PCs as little media piracy systems the way they have been for the last 20 years.



LEO:  So the insane paranoia really comes from Hollywood, not from Microsoft.



PETER:  It�s hard to tell what goes on inside Microsoft.  But if you read the technical specs, I think any technical person that reads those specs would say this is never going to work, and half of the stuff is nuts.  On the other hand, it could well be high-level managers inside Microsoft who don�t understand the technology and who completely agree with Hollywood and who think we should do this even though other people have told me it�s impossible, we�re going to do it anyway.



LEO:  You made such a good point, Steve, when you said that they�re doing this for a subset of PC users, far from the majority of PC users, and yet we�re all saddled with this.  In fact, Peter, you say at the end of your document a $50, cheap, Chinese-made set-top player in the long run will do a better job of playing back this HiDef content.  Why don�t we just extrude all of this extraneous material from our PC and get it out of there?  We don�t need it.



PETER:  Right, exactly.



LEO:  Why are we trying to turn the PC into a HiDef media�device?



STEVE:  So I guess the point that Peter is making overall, I mean, his paper was talking about the cost of Windows Vista content protection is that we know that Vista is going to be selling, starting next month, in February of �07.  We know that people buying new machines are going to have Vista on it.  So we know that a year later there�s going to be a huge install base of Vista.  We know that there will be people wanting to upgrade their XP systems which are strong enough to run Vista, to have the latest and greatest.  And maybe this will sort of mute that enthusiasm for upgrading to some degree, depending upon the kinds of things people do.  So this is going to happen anyway.  But in order to implement all the technologies Microsoft has, it really does insert cost throughout the entire infrastructure.  The whole Windows PC infrastructure becomes more expensive.



PETER:  Right.  Well, the scary thing is it�s not just Windows because the hardware manufacturers have to make these changes, and they don�t really care what operating system it�s going to run on.  It�s going to affect everybody.  Your graphics cards will become more expensive across the board, even if they�re never used with a Windows PC, because they still need to have these changes made only for Windows Vista.



LEO:  So really it�s interesting, I mean, you could say let�s take this out of Windows.  But in fact by just putting it in Windows it�s now in everything we use.



PETER:  Right.  Because, again, if Windows � if they own, I don�t know what, 90, 95 percent of the market, the graphics card and sound card manufacturers have to handle that.  And so they have to put this Vista-specific stuff in there, even if Mac OS X or Linux or FreeBSD completely ignores it.



LEO:  We�ll put a link to Peter�s article, of course, on our web page.  It�s a long URL, so I�m not going to give it out on the air here.  But you can go to our show notes and read it.  And I do recommend reading it.  As technical as it sounds, it�s easily read and digested, I think.



STEVE:  Leo, has John Dvorak weighed in on this issue at all yet?  Have you heard from John?



LEO:  No, in fact, we�ll probably talk about it more � we�re going to get � actually we�re trying to get a rebuttal from Microsoft on Windows Weekly and find out what they have to say.  I don�t expect anything substantive from them, but we want to at least give them a chance to say something.  And I think it�s pretty clear that the proof will be in the pudding.  I mean, as Vista comes out in the marketplace, if all of these things happen as Peter has predicted � and I see no reason why they won�t.  But if this all happens, you�re going to see rebellion.  You might be right, Peter, this might in fact be a suicide note because nobody wants their computer bricked.  That�s the new term we�re all going to have to learn.



STEVE:  And I think Peter made a real good point, too, which has been on my mind, and that is, when you look at all the effort Microsoft has gone to to protect us from Hollywood, or Hollywood from us...



LEO:  That�s protect Hollywood from us.



STEVE:  Whichever way it goes.  Imagine if instead they had�put that industry into protecting us from spyware and�malware.



LEO:  Well, they�d have done the job, I�m sure.  I think ultimately the consumers will be the voters on this one.  And they�ll vote with their dollars.  I have to think, if I�m a business guy thinking about moving to Vista, and I see this, I�m going to have some real second thoughts because there�s no benefit at all to business.  Business doesn�t want HD content on their computers.



STEVE:  Now, Peter, if you don�t have drivers � from the business model, if you had a basic PC with no HD-DVD drive and drivers, security-certificated drivers, no fancy graphics card that had all this stuff, would Vista�s content protection system just sort of never get activated?  Is it in there, but just completely passive, and there�s no tilt bits that are going to be a problem?



PETER:  I think probably the nastier aspects probably wouldn�t be activated.  Again, the specs are vague on just how much of the stuff is actually active at any one time.  Because a lot of it is so deeply built into this OS, I think�a large chunk of it is probably going to be there no matter what.  And that�s deliberate.  Obviously, if you have one version of Vista that doesn�t have the content protection active...



LEO:  I�ll use that one, yeah.



PETER:  ...and a different version of Vista that does, everyone�s going to use the unencumbered version.



LEO:  You have to put it in all of them.



STEVE:  Well, in fact I have read through the Vista Output Content Protection document.  And it�s very clear, exactly what Peter was saying from an architectural standpoint, whole huge subsystems have been completely redesigned and moved around from, like, kernel mode to user mode, and there�s this whole notion of a protected environment now to keep things from working the way they have before.  So there will certainly be side effects of those kinds of deep architectural changes that we wouldn�t have needed except that Microsoft decided they wanted to do this.



LEO:  Well, and you have to wonder if that�s why Vista took so long.  I mean, this attention to this kind of stuff didn�t happen until a few years ago.  I can imagine Microsoft sitting in 2004 saying, okay, Vista�s ready to go, and hearing from Hollywood, well, hold on there, guys.  And imagine, it would have taken a year or two to get this stuff working right.



STEVE:  Well, and in fact historically we�ve seen that a lot.  I was talking last week about how the fights over the content protection for digital audio tape, DAT tape, it delayed its introduction into the consumer market by many years.  And people who know about the industry feel that it may have been all of that that just killed it, and it just never had a chance to happen.



PETER:  But we�ve also been getting lots of complaints from people, admittedly running beta versions of drivers for Vista, that the drivers are less functional than the XP drivers, they�re less stable and so on and so forth.  Lots and lots of complaints.  And I know from sort of off-the-record comments from people working for device manufacturers that they�re putting a huge amount of effort into getting all this content protection stuff into their device drivers.  And they�re frantically trying to get drivers out in time for the Vista...



LEO:  Must be driving them crazy, yeah.



PETER:  Yeah, it�s driving them nuts.  And obviously they�re not getting any value out of this.  For some large graphics manufacturer like ATI or NVIDIA, they�re getting absolutely nothing out of putting all this crippling into their own drivers.  But they have to do it because Microsoft has said so.  And so typically with, let�s say Windows XP, it�s got a pile of built-in drivers.  Well, with Vista the release to manufacturing, a lot of the drivers weren�t ready yet at the time that was released.  So probably the first thing that happens once you install Vista is you have to go online and download drivers that actually work.



LEO:  Or support this HiDef content protection.



STEVE:  Well, and in fact I�ve been running Vista now for several months.  And I don�t use it continually.  But when I do fire it up, almost all the time it says, oops, there�s some new updates ready for your machine, go get them.



PETER:  Right.  And you can see that, even with playing back non-protected content, in online forums you see complaints about it dropping frames and audio stuttering and so on and so forth.  Maybe it�s just because it�s beta drivers.  On the other hand, it could also be because all this content protection gunk is getting in the way of simply playing back the content.



LEO:  Peter, you�re a little bit like Paul Revere.  I don�t know if you know the story of Paul Revere in the U.S. saying �The British are coming, the British are coming.�  Vista is coming.  And really it�s only until it�s out in widespread use we�ll really know what the true consequences of this decision on Microsoft�s part are.  But I have a feeling there�s a lot more to be said about this, and we�ll be hearing a lot more about it in the months to come.  We thank you so much for joining us on Security Now!.



PETER:  Okay, you�re welcome.



LEO:  Really great to talk to you.  Thank you, Peter.



STEVE:  Thanks, Peter.



PETER:  Thanks.



LEO:  Peter Gutmann, again, who is at the University of Auckland in New Zealand, a well-known security expert, and a guy who has really stirred up a hornet�s nest.  And we haven�t heard a lot from Microsoft about this.



STEVE:  These are good hornets, Leo.



LEO:  These are angry hornets, but it is really a good thing for him to talk about this.  I have some concern because, A, this is his opinion, although pretty factually backed up.  We haven�t heard from Microsoft on...



STEVE:  Leo, I have read all the Microsoft docs.  I have read all of the AACS docs.  Certainly Peter is taking the approach of this is a bad thing, an expensive thing for Microsoft to have done.  But I can independently vouch for the factual accuracy of what he has said.  This notion of them saying that the screen should be made fuzzy if it�s not protectable, that outputs need to be shut down, I mean, I have read that myself in documents directly from Microsoft�s site.  So all of this stuff is absolutely accurate.



LEO:  We�ll see.  Of course it�s accurate.  I�m not denying that in any way.  I just think we won�t really know what the price for this is for a few months.  But I think it will become clear.  The question is, what are we going to do about it?



STEVE:  Well, and Peter made some great points.  He�s been very active out in the blogosphere, and certainly he�s been the focus of this because of his paper.  And he talks about, and I have also seen separately, people saying that something seems wrong with Vista relative to its ability to robustly play media.  That is, they play back media.  So it may be it�s going to take a while for Microsoft to get this�working smoothly, and that they�ve broken it in the�meantime.



LEO:  Steve, always a great pleasure.  You can find more details, including a transcript of this great conversation, at GRC.com.  I�m going to Digg this show so that people can�� I think this is the kind of thing that people on Digg and Slashdot will want to know more about.  Peter hasn�t done a lot of interviews, so it�s a chance to really hear it directly from Peter Gutmann.  You can help us by going to Digg.com and Digging the story.  And if you want more information, as I said, transcripts, 16KB versions, notes, they�re all on Steve�s site, GRC.com.  That�s not the only thing there, though.  That�s where you also find SpinRite, which is Steve�s fantastic program for hard drive maintenance and recovery.  It was funny that you initially talked to Peter about hard drives.



STEVE:  Yeah, exactly, because our paths have crossed in many different venues.



LEO:  Lots of happy customers.  You can go to SpinRite.info to read the testimonials.  I think that will tell you more than anything Steve or I could say about the value of the program.  If you�ve got a hard drive, you really ought to get SpinRite.  GRC.com.  Okay, Steve.



STEVE:  Well, Leo, another week, another episode is in the�can.



LEO:  It is.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#75

DATE:		January 18, 2007

TITLE:		Vista DRM Wrap-Up and Announcing "SecurAble"

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-075.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Following last week�s guest appearance by Peter Gutmann, Steve and Leo wrap up the topic of Vista�s new, deep, and pervasive Digital Rights Management (DRM) system.  Steve also announces the completion and availability of his latest freeware:  �SecurAble."



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 75 for January 18, 2007:  Vista DRM.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



Steve Gibson, laboring away at his lab of security at GRC.com, has come up with...



STEVE GIBSON:  My fortress of solitude.



LEO:  Your fortress of solitude has come up with yet another great application, SecurAble.  We�re going to talk about that because it�s time, it�s time.  But before we get to that, Steve, I don�t know, I hope a lot of people heard last week�s episode.  And if you didn�t, I almost want to say pause the iPod and go back to 73 because...



STEVE:  Oh, Leo, don�t almost say.  Absolutely say it.  Because I do want to continue on the topic a little bit more.  I was sort of � I really wanted to give Peter a chance to explain things, and I really think he did.  There were some points that I was sort of trying to slip in that I want to make sure got made because there is so much hysteria now.  Even mainstream articles that I�m seeing are wrong about what they�re saying Vista DRM is.  So absolutely, let�s assume that anyone listening to this has listened to�last week�s interview with Peter because it was really�fantastic.



LEO:  I think he made such a good case.  I�ve read various critiques on the web and stuff.  And in general I think they�ve completely missed his point.  And just to recap, I think one of the most significant points is, well, you could say Hollywood required this, but nobody made Microsoft build this into all versions of Vista.  And in the last analysis, that doesn�t seem like a very good decision.  I think Linux, and I hope Apple, will say this should be separate.  This should be in a box.  And I think that�s why Apple did this Apple TV.  It should be external to the computer.  You shouldn�t hobble everyone with this premium content copy�protection.



STEVE:  And you might suggest, for example, that there would be a Vista Media Center Edition in the same way that we had that with XP.  The reason it�s not feasible is that this stuff is literally down in the kernel.  It required so much change to Vista that they weren�t practically able to do a Vista DRM.  And actually that sort of brings up another point, too, is that as I�ve been reading again, I feel like for the fifth time, the Microsoft specs...



LEO:  I�m sure it takes five readings, to be honest with you.  This stuff�s complicated.



STEVE:  And there�s a lot of interaction among these components.  But it�s another issue that�s more clear to me now is that what they�ve done is basically created a heavily DRM�d OS, that is, it�s not just for protecting HD.  It may have been driven by their interest in doing that.  But they  make a point in some of their papers that there�s been a lot of DRM that�s had to be installed by third parties on prior versions of Windows because Windows didn�t itself have a deep enough native digital content management system to satisfy everyone.  Well, that�s really been fixed in Vista.  So they didn�t want to just have, for example, a media-laden version that had all this stuff.  They really want Vista to be a digital rights management platform that other non-Hollywood, non-AACS HiDef video content users can now rely on for protecting whatever it is that they want to put DRM on.  So it brings all that along, too.



LEO:  One of the things I guess we wanted to do in this episode is kind of circle back and talk about some of the things that we either didn�t raise in 73 or maybe weren�t completely clear.



STEVE:  Exactly.  And I have actually got in my head...



LEO:  Before we do that, can I just get the commercial out?



STEVE:  Oh, yeah, please.



LEO:  All right.  I hate to tease people.  But I really do want to mention that Astaro is supporting this podcast because they�ve been so great.  They�re back again this year, and they are a wonderful product which we can really stand behind.  That�s kind of the reason that we were so glad to get them back for 2007.



STEVE:  And they�re supporting Security Now!.



LEO:  Yeah, exactly.  Steve asked me before we went on the air, now, we�re going to keep doing this for a while?  I said, hey, as long as Astaro keeps paying for it, absolutely.  This right now is the only TWiT podcast with a sponsor.  And that makes you golden, Steve.  So we thank Astaro, makes of the Astaro Security Gateway.  I have one, and I am blown away by it.  It�s great quality.  I mean, the thing is rock solid.  If you�re a small or medium business, and your network needs superior protection from spam, I mean, listen to what it does.  This is one box.  Looks like a router; about the size of a router.  But it�s so much more.  It does antispam, antivirus, content filtering.  Of course it�s an industrial-strength firewall, so it protects against hackers.  It has intrusion detection built in.  It�s a complete VPN server.  That�s what I�ve been using it for, which is fantastic.  I mean, I use all of the features.  And it�s all in one easy-to-use, high-performance appliance.  Now, you can try it absolutely free in your business.  Visit Astaro.com or call 877-4AS-TARO.  Make sure if you do that that you mention that you heard it on Security Now!.  And by the way, I also want to recommend it for noncommercial users.  You can download the software for free.  If you decide you like it, you can get all those additional subscription features like antispam and content filtering for a very low yearly cost, much less than you�re probably paying for the software versions of these programs.  Astaro.com, and we thank them for their support.



All right, I�m sorry, I didn�t mean to interrupt there.  I just wanted to get that done.  Let�s get back...



STEVE:  No problem.  Okay.  I�m holding the �Output Content Protection and Windows Vista� document written by Microsoft in my hand.  And before the show I went through, during my fifth reading of this thing, and just highlighted some sections that I want to read verbatim so that it�s sort of like on the record, and we can talk about these things.  For example, in the introduction Microsoft says, and I�m just reading from their document, �We are working actively to ensure that a Windows Vista PC supports the needs of both consumers and content owners, and that it works seamlessly across a broad range of other devices, networks, and protocols.  As we move towards the next evolution in the distribution and consumption of content, we are working on many fronts to create new experiences that drive the industry forward.  This requires the ability to respect business rules across many dimensions, including content coming into a PC from cable, satellite, over the Internet, or on a physical media such as next-generation DVDs; management of the content on the PC, including providing a robust infrastructure that allows ISVs to add value without needing to worry about supporting DRM natively in their own applications; and respecting business rules as content leaves the PC.  This paper talks about one aspect of the content protection work.  It addresses increasing the security associated with video and audio rendering on the Windows Vista PC platform.�



LEO:  That�s the key is video and audio rendering.  It doesn�t impact other stuff generally.



STEVE:  Actually it does.  And in some...



LEO:  I�m trying to put a good light on this sucker.



STEVE:  I know.  Well, no, but in some good ways.  One of the things that I�ve been distressed about over the last two weeks and our two episodes is that many people are swearing off Vista.  They�re saying, oh, I�m never going to go to that thing because I don�t want to be burdened with all this.  I don�t want all of the scary things that Peter was talking about to be in the machine I own.  I�m distressed because, as we have said in looking at Vista security previous to this, there are many good things that Vista is doing.  I mean, Paul Thurrott has become a fan of Vista by using it.  I�m running it on one of my tablet PCs.  And in fact, in last week�s episode you were asking Paul about Vista on a tablet.  They�re done beautiful things.  And it�s going to be installed on all the machines that people are buying next month.  So it�s clearly going to happen.  So I�m distressed by the fact that there is no way around the fact that Vista is also a pervasive digital rights management platform.  I mean, we�re getting a lot of good from a security standpoint, and the content providers are getting a lot of good for their own security.



LEO:  Yeah.



STEVE:  Which sometimes, exactly, which sometimes runs against the freedom and flexibility that even honest users of content would like to have.  I appreciate the fact that I can buy DVDs, and I can recompress the content and watch them on my PDA while I�m flying around the country.  It�s really useful to be able to do those things.



LEO:  I�m willing to give that up.  I just think that the content protection should be stuck in a DVD player or an external box in some way outside the computer so that we can still have our general-purpose flexible computers.  The real problem is that the content industry sees any personal computer as a threat because any personal computer can be used to crack stuff.  And they would like to make sure that all personal computers of any stripe, including Linux computers, have this kind of protection in it, to protect�them.



STEVE:  Well, speaking of which, I received last week the second-generation Toshiba HD-DVD player.  That�s the HDA2, which is their � it�s the standard...



LEO:  I had that on order until LG announced the dual format.  So I�m waiting to see what the dual format � because then I�m thinking, well, maybe I should buy � although I like HD-DVD.  But maybe I should just buy that dual format.



STEVE:  Well, and if Apple�s going to go Blu-ray, there�s another strong driver of the Blu-ray format.



LEO:  Apple and HP will.  But so you got this new standalone�player.



STEVE:  And just out of curiosity � I mean, this thing is phenomenal.  It�s got network configuration in it because there�s an Ethernet connection, and you configure it for DHCP or give it a fixed IP, just like a PC, which is for it to enable it to update its firmware in case bugs are found in it or things need to be changed.  So I was curious about what�s in this thing.  So I flipped to the back of the manual, under the license information, and get a load of the things that are covered by the license:  Linux kernel, busybox, glibc, openssl, and...



LEO:  It�s all open source software.



STEVE:  Yes.  It is completely built on Linux and open source software.



LEO:  I�m not surprised.  My Panasonic TV also has the GPL in the back of the manual because it�s got Linux and openssl and openssh in it.  That�s so funny.



STEVE:  So they�ve used a lot of open source software, but of course there are...



LEO:  But that�s fine.  Hack open source software and put it�in your box.  Just don�t modify my Linux, that�s all I care about.  I think you made a really good point last week that the success and the strength and the power of the personal computer platform has always been because it is an open platform, and you can do things like that.



STEVE:  Yes.  And get a load of this.  Again reading from Microsoft�s document, they even say that.  They say, �A consumer electronics device is a closed box.  Users can�t load software onto it or add cards to capture content.  At least that is the current perception of premium content providers, though it might not be true for future CE devices.  By contrast, the Windows-based PC is designed to be an open platform.  Anyone can load software on it.�  Unfortunately, malware authors can, too.  �It is easy to write...�  That�s not in the Microsoft document, by the way.



LEO:  Didn�t think so.  That sounded pretty parenthetical.



STEVE:  Sorry about that.  �Anyone can load software on it.  It is easy to write software for it because all the interfaces are well defined and published.  And there are many good software tools available.  The PC buses are also well defined, and anyone can design cards to plug into these buses.�  Continuing to read from the document:  �The openness of the hardware platform is essential to a vibrant PC ecosystem.  In the current world, however, the industry is also working to prevent hackers from using that openness to pirate copyrighted content.  The goal is to make the Windows-based PC a safer place for premium content, so that content providers will be happy to allow Windows-based PCs to play their content.  The term �premium content� is used in this paper to refer to valuable content that needs to be protected from stealing.  Each content type has its own particular policy that defines what the user can and cannot do with it.  The term �high-level premium content� is used to refer to the most valuable content types, such as high-definition DVD and Blu-ray DVD.  The content industry may introduce robustness rules and testing that would effectively lock out PCs from premium content by not allowing PCs a license key for the encryption system used by conditional access systems or HD-DVD and Blu-ray DVD.  These protection schemes will be very strong...� � huh, baby.  It doesn�t say that, either � �...in the future...�



LEO:  I wish it did, though, don�t you?  Oh, baby.



STEVE:  �...based on AES, Advanced Encryption Standard, RSA, and so on.  Under these future rules, a PC would only be granted a license to play the content if it is at least as secure as a consumer electronics appliance.  To make the PC safer for premium content, Microsoft...�



LEO:  Safer.



STEVE:  Safer, I know, �...has been working with members of the PC industry to solve the technical issues in hardware and software.  Our key partners in this work have been Intel, ATI, NVIDIA, S3, and Matrox.  While preserving the general openness...� � ugh.  Doesn�t say that, either � �...of the PC hardware platform, new solutions must be able to resist attacks against protected content.  These solutions must also preserve the Windows experience for legitimate users, particularly without jeopardizing their privacy.�  So that�s sort of their...



LEO:  That sounds very good, but...



STEVE:  It does.



LEO:  But really I have to say I don�t know if that goal is possible.  To me, the question comes down to what is your personal computer, an open platform or a consumer electronics device? 



STEVE:  Well, exactly.  And so then this starts getting more specific.  There�s an acronym soup, of course, once again.  They have something called PVP-OPM.  PVP stands for the Protected Video Path.  OPM stands for Output Protection Management.  And Microsoft�s document says, �Typically, PVP-OPM operates within the Windows Vista protected environment and enjoys the software protection this provides.  The protected environment checks for any unsafe situations for high-level premium content and turns off playing the content if an unsafe condition is found.�  It says, �To work with PVP-OPM, a graphics card manufacturer must provide for the following:  1.  Output protection management capability on all board outputs.  At a minimum, provide the ability to turn off every output.  2.  Device driver capability to report reliably about the board outputs and their settings.  3.  HDCP...� which we know is HiDef Content Protection.  Or no � yeah.  These acronyms are amazing.



LEO:  I know.  It�s amazing you can keep them straight.



STEVE:  �...for DVI and HDMI outputs and Macrovision and CGMS-A protection on analog TV outputs.  Otherwise outputs will be turned off by the PVP-OPM software.  And finally, the ability to pass video through a constrictor, that is, a downscaler followed by an upscaler, so that the information content of premium video can be reduced when an unprotected output such as analog VGA is present.�



So these are the things that Peter was referring to.  But to do this requires closing down to a great degree the previously open architecture.  It says, �The graphics hardware manufacturer must do whatever is appropriate to prove that the driver is talking to genuine hardware.  If a particular implementation proves to be insufficient, as highlighted by a hack or a valid complaint from content owners...�  So now content owners are able to complain.



LEO:  They get to say, yeah.



STEVE:  Get this.  This is Microsoft�s document, �...then the related driver might need to be revoked.�



LEO:  That�s the thing that bugs me.



STEVE:  Yes.



LEO:  Go ahead.



STEVE:  �And a new driver would have to be deployed with additional HFS tests.�



LEO:  So all of a sudden your computer could stop working.



STEVE:  Yes, yes.



LEO:  Your video driver could be revoked.



STEVE:  And they clearly...



LEO:  And as Peter pointed out, that could happen just because they stopped paying their fee.



STEVE:  Yes.



LEO:  It�s not merely, you know, if the company went out of business it could be revoked.



STEVE:  Right.  Here in the document, under this HFS and drivers supporting multiple chips, they talk about the risk of a single driver supporting multiple chips because, if that driver were revoked, it could affect much more than a single chip vulnerability.  And literally, again, reading from the document, it says, �The Windows Vista protected environment will, after due process, revoke any driver that is found to be leaking premium content, either itself or from the hardware it controls.  If the same driver is used for all the manufacturer�s chip designs, then a revocation could cause all of that company�s products to need a new�driver.�



LEO:  Peter pointed that out in his article, that these unified drivers are going to disappear.  It was nice.  You could go to NVIDIA, download one file, it would work on any NVIDIA card.  But that�s not going to happen anymore.



STEVE:  Right.  And that, of course, does substantially increase the cost, which ultimately gets passed on to the end user, which is of course the real reason that he was talking about the cost of Vista DRM.  On this issue of tilt bits, Microsoft�s document reads, �Tilt bits are provided in the DDI...� � that�s the Device Driver Interface � �...as the driver�s mechanism for reporting that a hacker is suspected.  If at any time the graphics driver determines that something improper has happened, then it can set the appropriate tilt bit, for example, if the hash of an output status message doesn�t match the message.  If any tilt bit gets set, then Windows Vista will initiate a full reset of the graphics subsystem so everything will restart, including reauthentication.  The tilt bits are also used by the driver in the PVP-UAB.�  That�s another one of these acronyms.  UAB is the User Accessible Bus.  That is to say, if you had a separate graphics card, rather than integrated graphics on the motherboard, where Vista goes really, well, I can�t say go overboard, but Vista�s very concerned about any non-encrypted, I mean, the whole idea is not to allow any exposed non-encrypted content anywhere, literally from soup to nuts, from original content all the way to your eyeball.  I mean, if they could encrypt somehow the...



LEO:  They�d love to put an HDMI port in your brain.



STEVE:  Exactly.



LEO:  With HDCP in there, too.



STEVE:  Because they�re worried about someone literally using a digital video camera against the screen.



LEO:  We�ll talk about that in the 2021 edition of Security�Now!.



STEVE:  So they say, �There is no requirement regarding the circumstances under which a driver should set a tilt bit.  Adopting this mechanism is another example of the hardware manufacturer showing their intent to properly protect premium content.�



LEO:  That was another thing that he talked about is this notion of intent, yeah.  That�s really what they want you to do.  It�s not merely that you�ve � in fact, the spec isn�t that clearly written.  They just want to have you prove that you care.



STEVE:  Well, and it really sounds like, as I�ve read this again and again and again, it sounds like they�re trying, Microsoft is trying to help to prevent lawsuits against content leakers.  And so the more intent a hardware provider demonstrates, the better their case will be against the industry that brings a suit against them for allowing their subsystem of Windows to leak content.  And that�s where this showing intent is coming from.  Because it actually says in this document, it talks about not doing a sufficient job and the kinds of onus that the hardware maker or software driver author could be subjected to.  And then under this issue of resolution constriction Microsoft�s document says, �In the future, some types of premium content, through its content policy, will specify that a full-resolution analog VGA output is not allowed...�



LEO:  Oh, boy.



STEVE:  Uh-huh, �...and that the resolution must be reduced.  It is not practical to change the actual scanning rate of the display, particularly because some displays are fixed resolution.  But what is important is that the information content of the signal is reduced to the resolution specified by the content owner.�



LEO:  I just want to shoot them now.  I just � that�s just�infuriating.



STEVE:  And here�s the line.  �Basically, a high-resolution picture needs to be degraded to make it soft and fuzzy.�



LEO:  Now, that�s just for premium content, although it sounds like, if they�re saying it has to happen over the VGA, does that mean if it�s just my Windows desktop it�s soft and fuzzy?



STEVE:  Well, okay now.  Let me see if I was through here because there was a great point that you�re making.  Oh, there�s one more thing here.



LEO:  Keep going.  We�ll get back to that.



STEVE:  Okay.  This is under content industry agreement hardware robustness rules.  And this just, again, for anyone who�s used to the open platform paradigm that created the PC, this reads, �Content industry agreement robustness rules refer to, among other things, how a hardware manufacturer lays out and generally implements circuit boards.  The rules are determined by the content industry in discussion with implementers and are described in, for example, the 5C, DTCP, and AACS documents, which are referred to in this paper as �content industry agreement documents.��



LEO:  Yeah, that�s the problem.  Not an engineer.  A bunch of lawyers who know nothing.



STEVE:  �The intent of the hardware robustness rules is to make it very difficult for hackers to use the graphics card or motherboard to extract video data.  Interpretation is required...� � I love this � �Interpretation is required for some of these documents, and it is sometimes difficult to determine conclusively what is allowed.�



LEO:  Interpretation.  Simultaneous translation.  For crying out loud.  It�s a foreign language.  Even they admit that.



STEVE:  Yes.  Microsoft says, �Content industry agreement hardware robustness rules must be interpreted by the graphics hardware manufacturer.  Vendors should work to ensure that their implementation will not be revoked for playback of high-level premium content as the result of a valid complaint from the content owners.



LEO:  So we can�t tell you what they might complain about, but you�d just better be sure you don�t get a complaint.



STEVE:  And finally, �If it is found, for example, reported by Hollywood, that a graphics chip manufacturer is allowing �hacker friendly� cards to be manufactured with their chips, and if that chip manufacturer is unwilling or unable to stop those cards being manufactured, then the final recourse would be the revocation of the driver for that chip.



LEO:  I want to make this clear.  That means they can reach�into a Vista PC remotely and make that video card stop�working.



STEVE:  Yes.



LEO:  I mean, it�s not like from now on all cards sold.  That means my system right now � how would they revoke that?  Is it done in Windows Update?



STEVE:  Oh, absolutely.  It would be done through Vista updating its license keys.



LEO:  Which it has to do or you can�t use it.



STEVE:  Well, that�s exactly right.  The graphics card manufacturers have keys, and they are entirely revocable basically at anyone�s whim.  Anyone who�s able to demonstrate that the card is leaking content would � now, hopefully it could be fixed in the driver.  So the idea would be Windows Update would update your driver; and again, driver updating is then no longer something you could voluntarily choose to do or not do.  You would update your driver or suffer revocation, the idea being that it would update the driver, the driver would have new keys, and the old keys would then be revoked so no one who did not update their driver would then be able to play the content.  The idea being the industry wants to retroactively be able to go out and fix any mistakes in software or hardware.  The problem, of course, is that model says we could fix it in software.  If in fact a highly popular card were found to be hackable, so that content could get out of it, digital content could be recorded from it, then at the discretion of the content providers they could require that that card, that is to say all cards of that hardware, no longer be able to play premium content.



LEO:  Oh, the card would still work on the computer, I just couldn�t play a DVD back.



STEVE:  Correct.



LEO:  Oh, okay.  I was a little scared.  I thought the card driver would stop working in its entirety.



STEVE:  No.  And that brings us that to that point that I referred to as an important segue just before we started talking about this last bit.  And that is, it is extremely important to recognize that all of this is controlled by content policy that is bound to, cryptographically signed, to the digitally protected content.  So it is a function of what the provider chooses to do.  So the idea is that...



LEO:  The idea is you�re screwed, is what the idea is.  I�m really � but I do want to underscore that because I think I misunderstood it.  It sounded like the whole thing would stop working.  I�ll still be able to use my PC in every normal respect.  But I just won�t be able to watch a HiDef�DVD.



STEVE:  Yes.  And the point I was...



LEO:  Are we sure that�s true?



STEVE:  Yes, we�re absolutely sure.  And in fact...



LEO:  I�m a little less perturbed, then.  Because I�m never going to put an HD-DVD in my computer.  I�m going to watch it on my TV.



STEVE:  And it�s why I wanted to make this point, why it was so important to make this point, is that even today, as far as we know, current versions of HD-DVDs are allowing full resolution output from component video.



LEO:  They haven�t yet kind of enabled this bit.



STEVE:  Well, yes.  The policy that is bound to the digital content is not saying disable component.  Now, for example, my HD-DVD player, this brand new Toshiba that I got last week, it�s got HDMI digital output and component video.  And component video has been around for years.  Many consumer devices, home theater projectors and so forth, have component video and may not have the newer digital interface.  So you can imagine that it would be very distressing for somebody who purchased this brand new Toshiba HD-DVD player and was watching HD-DVDs to find one that simply refused to play through their component outputs.  So it�s not clear that this is ever actually going to happen, which is one of the things I wanted to make clear.  This is where so much of the confusion has come from.  It is absolutely the case that it is possible for this to happen, but we don�t know...



LEO:  But the industry so far hasn�t decided to do that.



STEVE:  Yes.  And even revocation.  You could argue that killing off hundreds of thousands of in-the-field...



LEO:  Innocent bits.



STEVE:  ...working, yeah, video cards is really such a bad thing, you really have to wonder if the content-providing industry would choose to do so.  They absolutely have the ability, but that doesn�t mean they�re going to.



LEO:  Well, I don�t blame them for wanting to preserve the right to do so, or kind of build it into the hardware.  I just hate the fact that we�re just kind of � they can hold that over our heads.



STEVE:  Yes.



LEO:  So your point is, don�t avoid Vista merely because of this.  The security advantages are so great that you probably do want to go with Vista.



STEVE:  Yes.  Well, okay.  In laptops, for example, many people are buying laptops.  There�s an integrated system with on-card video.  It seems to me laptops are more often to be something where you could imagine in the next generation watching movies than your Vista machine in front of where you�re normally doing work.  So a laptop could make a very useful content delivery platform.  And it would be protected, it�ll be running Vista, and you can watch HD-DVD videos on it probably without any problem.  I really hope that all of this doesn�t destabilize Vista, which was a really strong point that Peter made.  We�re hearing anecdotal reports all over the place that Vista seems flaky.



LEO:  I talked to somebody yesterday who said it doesn�t play videogames very well.  He was trying to play DirectX 9 games, and they would frequently freeze or die.  Now, we still don�t know why that is.  Could be a lot of reasons.



STEVE:  And there have been reports, again, anecdotal reports from people who are having problems with Vista currently playing movies of various sorts, depending upon what type of connectors they have.  So...



LEO:  I think HiDef content a lot of times will not play.



STEVE:  Now, I want to wrap up by talking about interfaces because the so-called last mile in Vista is from the output of the box to your display device.  There are analog technologies which are not protectable, i.e., composite and�S-video...



LEO:  That�s that analog hold that they were talking about.



STEVE:  Exactly.  And even component video is an analog technology.  Now, Vista will apparently add Macrovision and various types of copy protection to that, and compliant recorders will refuse to record that content if they see those protection measures have been stuck in.  The two types of video interfaces are DVI and HDMI.  Both of those are able to carry HDCP, the HiDef Content Protection, which basically allows the authentication of your display device itself back to the computer.  So what I would urge people to do in the future is, if you are buying screens and displays that you want to be future proof, make sure they do provide HDCP, either with a DVI connector, a Digital Video Interface connector, or the HDMI.



LEO:  But even farther than that, because we�ve seen some displays that have HDMI, but don�t have HDCP.



STEVE:  That�s true.  And in fact...



LEO:  And those you will not be able to play back HiDef content.  In fact, that was part of the problem is that all of these �HDCP-capable� cards sold up to now are not.



STEVE:  Right.  Well, because � and there are about nine things I wanted to say right there.  Again, I don�t think it�s that it won�t play it.  But it won�t play it crisp.  It will deliberately run it through...



LEO:  In some cases it will not play it, but it�s supposed to downscale it.



STEVE:  It�ll run through the constrictor.  And again, the content provider in the policy that comes with the individual content is able on a...



LEO:  So some disks are not enabled.



STEVE:  Correct.



LEO:  Not all disks require this.



STEVE:  Well, and I�ve heard, again anecdotally, that no current HD content does actually do this.



LEO:  Well, I�m not sure that�s the case because I�ve heard, also anecdotally � and this is the problem, it�s all anecdotal at this point.  People have said, oh, gee, you know, I have a DVI connector to my monitor, or I have a component connector, and it won�t play at all.  So it is possible that some disks are doing this, or maybe the hardware is doing it on its own recognizance without requests from the disk.  I don�t know.



STEVE:  Well, Leo, many people who have DVI � I�m completely�DVI based.  And not a single one of my computer monitors, which is DVI, has HDCP because they were never intended to be secure content delivery screens.  They�re computer screens.



LEO:  So can you play HiDef DVDs on those screens?



STEVE:  No.



LEO:  So you�re saying that, even though the disk doesn�t require it, the hardware is.



STEVE:  Correct.



LEO:  So there you go.  I mean, that�s the problem is it�s�such an interlocking mess that there�s all sorts of�reasons why it might not work, all related to this content protection.



STEVE:  Right.  And the other scary thing is that, again, what�s happened is all aspects of this content delivery chain are now locked in licenses and proprietary intellectual property and revocable certifications.  So, I mean, it is a new day.  It is truly a big change.  But again, I do wish that all Vistas were not laden with this technology because it does seem like it�s going to make it twitchy.  We really won�t know for a while.  But again, I�m sorry that there�s been the scramble and the concern and the amount of FUD, essentially, that has come up because Vista does so many good things security-wise.  I would not like to see people avoiding it.  And you could argue, though, that the people who want the freedom of doing with their content what they will are probably the people who will stay on XP for the freedom and are less in need of the security things that random consumers who just aren�t into computers and are not listening to this podcast are going to get.  And so Vista�s things help those people more.



LEO:  Right, that�s a good point, too.  That�s right.  And those people probably are not going to stay away because in most cases they�ll just be buying a new computer with Vista.



STEVE:  Right.



LEO:  All right.  Before we wrap up, do you want to make an�announcement?



STEVE:  Well, I do want to announce that the first freeware,�the first GRC freeware to result from the Security�Now! podcast, I mean, this is a direct outgrowth of�our work here, is available for download.  It�s called �SecurAble.�  You can find a link on the homepage, or it�s just GRC.com/securable.



LEO:  Oh, I like that.



STEVE:  I knew you would, Leo.  I did that URL for you.



LEO:  You�re a good man.



STEVE:  It is a very cool app.  It has been an eye-opener for many of the people over in our newsgroup who have been pounding on it and beta testing it for me and nailing out all my little typos in the text.  The thing that is so cool about it is it will show people the security ability of their system.  Many people, it turns out, have, for example, hardware DEP-capable systems, certainly any who have purchased machines in the last couple of years, but they probably don�t know it.  The outgrowth...



LEO:  So you�ll get an output that says you could turn on DEP if you wanted.



STEVE:  Well, yes.  And in fact what�s happened is, we�ve learned so much already about DEP.  I am extremely excited about it.  My next piece of freeware is going to be called DEPuty.  We already had an outgrowth from this one because it is really the case, and I can�t stress this enough, that hardware DEP, when enabled properly � which is never the case by default because it does create problems for people � hardware DEP when enabled properly is the single greatest solution for all forms of buffer overrun attacks that has ever been seen.  I mean, most things that have happened in the last few years would have been stopped cold if hardware DEP had been enabled.  I mean, it is a massively good thing for personal security.  And the good news is it�s in XP after Service Pack 2.  So this is one thing, I think it�s the single most important security measure that can be taken.  And so certainly in the future we�ll be spending some more time talking about what hardware DEP is.  And it�s very important to recognize also that software DEP isn�t DEP at all.  It�s just virtually useless.



LEO:  Turn it on and use SecurAble to find out.  What else will SecurAble tell you?



STEVE:  It tells you whether your chip has 64-bit capability and also whether it�s got the virtual machine extensions, either from Intel or AMD, which allow you to run much faster virtual machines.  That is, the virtual machine extensions essentially make running VMs more practical because they are able to run literally at full speed by taking a whole � by essentially offloading a lot of the work that software was normally doing onto these virtual machine hardware technologies.  So it�s a very cool thing, too.  And of course virtual machines are good for security, so thus that�connection.



LEO:  Speaking of virtual machines, I just wanted to mention�I met with VMware at Macworld Expo last week, and their beta for Mac is out, and it�s impressive as heck.  And I said, �Well, how are you going to beat Parallels?  They�re a third the cost.�  They said, �Wait and see.�  The beta is free right now.  There�ll be another beta in I think they said around May, and then they should have it out about middle of the year.



STEVE:  Very cool.  We�ll certainly be looking at it.



LEO:  GRC.com/securable to get your copy of SecurAble.  And of course GRC.com is also the place to get the 16KB versions of this show for the bandwidth-impaired, and Elaine�s great transcriptions if you�d like to read along with Steve.  And of course, let�s not forget, one of the reasons Steve can do this show and write the free software is his day job, which is the great � and I�m really happy to be able to give you a plug because it�s such a good program � SpinRite.  You can go to SpinRite.info if you want to read any testimonials.  You got any good letters these days from � I�m sure you have�lots.



STEVE:  I do.  I�ve got just a really short one that I really liked because his subject was �Best Program Ever...�



LEO:  Okay, that�s a good start.



STEVE:  ...and then six exclamation points.  And he says, �I would just like to thank you for saving me hours of work with your SpinRite v6.0 program.  I had a HD [hard disk] that I could not read sectors on, and it wouldn�t even boot.  I ran your program, and it booted first try.  I was amazed.  I wanted to post this on your website for others to read, but I couldn�t get that newsgroup program to work correctly.  But anyway, thanks again.  I back this product 100 percent.  I was absolutely amazed how well it worked on my totally inaccessible hard drive.�



LEO:  Isn�t that nice.



STEVE:  So I do love to get those little success stories.  Those are terrific.



LEO:  GRC.com, SpinRite.  It is really the ultimate disk maintenance and recovery tool, if you have hard drives.  And nowadays we all have many hard drives, so it really is worthwhile.  It�s a good idea to run SpinRite on them.  How often do you recommend, maybe every few months or...



STEVE:  Yeah, about every quarter, I would say, because it actually does preventive maintenance.  I have another letter that I will get to here in a couple weeks where somebody talks about how he purchased SpinRite just to support the Security Now! podcast and all the work I do at GRC.



LEO:  That�s nice.



STEVE:  And he had it around when his system died.  And as it happens he had it on a floppy.  Well, the way you run SpinRite is you run it in Windows, and it produces bootable media.  So you can either make a bootable CD or a bootable floppy, if you�ve got a system that still has a floppy, or even a bootable USB dongle.  But the point is that, if you�re going to do this, you really do need to have SpinRite already running, that is, already moved to a bootable media when your system dies.  Otherwise you�re not able to use your system in order to make the bootable media.  At the same time, you know, we�re real good about licensing, so you could certainly run it on somebody else�s machine or on a different machine of yours in order to make the bootable media.  But in this case the guy had already gone through that and had his bootable version of SpinRite ready to go, stuck it in his computer, and it fixed it for him.



LEO:  Excellent.  Maybe run off and do that right now.  SpinRite.info, and of course GRC.com.  Steve, we�ll catch you next week.



STEVE:  Next week is a Q&A.



LEO:  I was going to say, are we coming up on that?



STEVE:  Yes, we�re on a Q&A.  I would imagine we�ll have lots of questions about Vista DRM.  And we may still talk...



LEO:  Wait a minute, that�s episode 75.  That�s not mod 4, is it?



STEVE:  Agh, wait a minute.



LEO:  No, we�ve got two weeks for that.



STEVE:  I show us on episode � maybe I miscounted.  I thought that...



LEO:  No, you�re right.



STEVE:  Peter was 74.



LEO:  You�re right, this is 75.  I�m sorry, I�m out of sync.  This is � you�re right, absolutely right.



STEVE:  Next week is 76.  So I imagine we�ll be fielding some questions from people and some experiences and have another really great episode of Security Now!.



LEO:  Somebody asked me, �How do you get your questions submitted to Steve?�  They�ve been sending them to me.  There must be a better way.



STEVE:  Oh, absolutely.  The way everyone does is they go to the Security Now! page, it�s GRC.com/securitynow.  And then just, after the page loads, hit End, or just scroll all the way down to the bottom.  And there�s a form that you can easily fill in to submit your questions, and they come right to me.



LEO:  That�s easy.  All right.  Hey, thanks, Steve Gibson.  Once again, another great show.  And really food for thought for anybody who�s moving to Vista.  But the bottom line is the security benefits of Vista outweigh these other concerns.  However, it might be prudent to wait a little bit.  I mean, it comes out January 29th.  If you�re buying a new machine, it�ll probably come with Vista.  But I�ve already upgraded to Vista, and I don�t notice any issues yet.  But I think if you were on the fence at all, hey, wait a few weeks.  It�s not going to kill you to wait a month.



STEVE:  Well, and if you were thinking maybe of making the Vista the heart of a next-generation home theater system, I would make sure that you�re going to be able to make Vista happy.  Make sure that your projector has a digital connection, not an analog one, because that is subject to being shut down or fuzzified.  So consider that.  I know that, for example, Mark Thompson loves SageTV as his, like, TiVo replacement.



LEO:  But forget HiDef content on that.



STEVE:  Well, exactly.  So although he does use it, you would never be able to use protected content unless all of your video pathway was digital and supported secure encryption with certificates and so forth.



LEO:  Or you download everything from BitTorrent.



STEVE:  There you go.



LEO:  Take that, Hollywood.  Unghhhh.  I wonder how Elaine�s going to transcribe the various grunts, groans, and moans that we�ve done in this show?  I can�t wait.  How do you spell �unghhhh�?



STEVE:  I�m sure she�ll manage, Leo.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#76

DATE:		January 25, 2007

TITLE:		Listener Feedback Q&A #15

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-076.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world �application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 76 for January 25, 2007:  Your questions, Steve�s answers, #15.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



Time for Security Now!.  My favorite security expert is here, actually one of my best buddies of all.  Steve Gibson, I always enjoy talking to you every Thursday on Security Now!.  And, you know, Steve�s so dedicated.  I have to leave town next week to go to New York to do �Regis & Kelly,� and then go on another geek cruise.  And most of the other podcasts are going to have to take a couple weeks off because I�m out of town.  But Steve said no, we will not miss an episode.  Steve, I bow my hat to you, or something like that.



STEVE GIBSON:  We�re doing three today, Leo.



LEO:  Wow.  We�ve got some good episodes ahead.  Anyway, I was looking at a device that would allow me, in theory anyway, to do these shows anywhere, even if I had just kind of lousy Wi-Fi.  And we�re going to test this out because maybe, you know, my dream is someday to be on a boat doing this show.  We�ll see.  Steve�s never giving up.  He�s never not going to do his show.



STEVE:  I love it.  And I get to catch up on our episode numbers as I listen to where TWiT and the other longstanding podcasts are, so...



LEO:  The only ones you can�t compete with are the daily one, the Giz Whiz, and the KFI show because that�s been going for three years.  And it�s going to continue on, apparently, so you�ll never catch up with that one.  But this is Episode 76.  That�s a mod-4 episode.  That means in our mod-4 speak we�ve got questions and answers, our 15th question-and-answer episode this week.  But before we do questions and answers, let�s talk about last week�s show.



STEVE:  Well, yeah.  I have some errata.  It�s sort of, in general, sort of different things.  First of all, toward the end of last week�s show we mentioned that I had finished SecurAble, which is GRC�s latest freeware, to show you what security-related features your processor, your system�s current processor, has.  What�s funny is, I was working on the web page when � and it still wasn�t public � when I went over to TWiT to check something and saw that, because you were on the East Coast, three hours ahead of me, you had already pushed out the podcast.  So...



LEO:  Oh, I�m sorry.



STEVE:  No,  it�s okay.  I mean, normally it�s sort of later in the afternoon or in the early evening.  But anyway, so I quickly got the page up.  But a couple people commented that GRC.com/securable was not present when they were listening to the podcast.  So I wanted to make sure that everyone knew that only was the case for � I don�t know actually when the podcast went up.  But anyway, as soon as I saw that it was up, I put a page up even though I wasn�t really finished with it.  Then I continued to work on it for a few more days.  So GRC.com/securable, it�s also linked to from our home page, just GRC.com.  And people will be able to grab this little bit of freeware, I think it�s about 108K, which you know, Leo, is big for me.  It�s because I signed everything.  It�s got a kernel mode device driver built into it.  It also has a whole bunch of text and some graphics.  So it�s a little larger than my normal 23K exe, but you don�t have to install it.  You just download it and run it, and it tells you what you�ve got.  And actually there�s a lot of really fun information on the Securable page that I think people will find interesting, as well.



LEO:  Excellent.  Well, that�s my fault, not your fault.  And you know what I�ve decided to do � because it is inconsistent.  In fact, sometimes I forget till, like, Friday to put the podcast out because it�s just whenever I think of it.  So what I�m going to do is shoot for a consistent time every Thursday.  Would noon Pacific on Thursday work for you, if we just say that�s our goal, to get the podcast pushed out then?



STEVE:  Whatever you want to do.  I think maybe we should be having this conversation off the air because if we commit to noon, then suddenly, for whatever reason, one of us isn�t available or something, it�s like, agh.



LEO:  It won�t always be noon.  I have some new software, and perhaps I�m relying on it a little much, but I have some new software that supposedly will publish these on a schedule.  And so I�m going to try it for these next three because I will be kind of incommunicado.  If they come out at noon...



STEVE:  That works for me.



LEO:  ...Pacific on Thursday for the next three weeks, then that�s the commitment.  If not, we�ll have to take it back to the drawing board and see.  But in theory I can enter it into this software, and come noon on Thursday it�ll push it out.  We shall see.



STEVE:  One other thing I wanted to mention, since we were talking about AACS so much � and of course we had Peter Gutmann on a couple weeks ago, and the whole Vista content protection thing, which actually is going to be our topic next week because we�re going to talk about Microsoft�s formal blog response to Peter Gutmann�s paper next week.



But I did want to mention that I just, as actually catalyzed by all of this, I purchased a Toshiba, the second-generation Toshiba HD-DVD player.  And I remember that we were talking about how it�s Linux-based and so forth, and that thankfully it takes less than a minute to recognize the DVD when you insert it.  The first-generation player apparently was a little under-powered in terms of its processing power, so it took really a substantial length of time to go through all the decryption mumbo-jumbo that any hi-def content that is all scrambled is going to require.  So I�ve been � I�ve watched a few things.  I watched �Tomb Raider,� as I was saying I was going to.  And also the first two �Mission Impossibles.�  I have the three-boxed HD �Mission Impossible� set.  And I have to say I was not that impressed with the visual look of HD.



But then last night I watched �Pitch Black,� which was the first � it�s a sci-fi with Vin Diesel where he crashes on, with a bunch of other people, on a weird planet in the middle of nowhere.  And they�re besieged with the planet�s native and not-friendly flying things.  Anyway, it was stunning.  And so I realized that not all HD-DVD is created equal, and that � it�s funny because I was talking to Mark Thompson about this.  And I was bemoaning the fact that the DVDs were all saying they were 1080P, which technically means their resolution is 1920x1080, which is substantially greater, for example, than my screen, which is sort of first-generation HD, which is 1280x720.  So I can do 720P, that is, 720 progressive, but not 1080.  Mark�s feeling is content isn�t even digitized at the higher HD resolution.  And frankly...



LEO:  It�s upscaled, yeah.



STEVE:  Yes.  And so the idea being, people who go to some�real extremes to go to 1920x1080 to get 1080P may be really disappointed.



LEO:  I�ve read a number of columns lately that suggest exactly that.  In fact, even say that, if you have a good upscaling 1080I display � and some of it does depend on the software, the DSP in the TV.  But if you have a good display that can upscale, it�s going to look almost identical to a 1080P source.



STEVE:  I�m not surprised.  And so my experience has been � I just sort of wanted to share this with everyone because all the viewing experiences were in the same sitting, same distance from the screen, same lighting conditions.  And so I was really able to do some, for me, my very first quiet analysis of is hi-def worth all of this hassle, essentially.  And I have to say that, on a properly digitized movie, it can be phenomenally better.  But so far only one movie out of four that I�ve watched has really been a discernible difference, which I really thought was interesting.



LEO:  I also have an HD-DVD player.  I use my Xbox 360.  I�ve been very impressed with the ones I�ve seen so far.  �King Kong� looks fantastic.



STEVE:  Which of course is boxed along with the 360 player.



LEO:  That�s right, that�s why I saw that one.  I have �Seabiscuit.�  That looks very good.  What else have I watched?  I�ve only watched a handful.  There aren�t that many HD-DVDs.  And ironically, I haven�t seen any of the ones that you just mentioned.



STEVE:  The one that I�m salivating over, not because of the content, but because...



LEO:  See, I choose them for the content, not for the...



STEVE:  Well, �Aeon Flux� is...



LEO:  Oh, dear, one of the worst movies ever made.  But I guess, if you like �Tomb Raider,� you�re going to love that.



STEVE:  Well, okay.  And it is apparently, I mean, the HDDVD reviews I�ve read have said it�s the best-looking disk they have ever seen.



LEO:  Okay, so that�ll be worth looking at.



STEVE:  So I really am interested in getting into seeing what the HDness of this is all about.



LEO:  Same thing happened when DVDs came out.  In fact, I remember when CDs, audio CDs came out, they were very bad transcriptions.  And then eventually people realized, hey, you can�t just take the record, play it into a microphone, and put it on a CD.  And the same thing happened with DVDs, and I expect the same will happen with HD-DVD.  Especially as discerning viewers start to become aware of this, they�re going to have to.  I mean, you see every defect on HD-DVD.



STEVE:  Right.  Well, in fact, and last night literally the pores on their skin was very visible.



LEO:  You know, we�re shooting �Call For Help� in HD now, speaking of pores on my skin.  We actually will be using, believe it or not, airbrush makeup.  We started using it in Toronto, and that�s for HD.



STEVE:  Right, very cool.



LEO:  They airbrush your face on.



STEVE:  For those listeners who are listening to TWiT and also Security Now! � and I imagine there is probably a lot of crossover.  I also listen to TWiT.  And you guys were talking a couple weeks ago about the idea of a dual-format HD and Blu-ray format player...



LEO:  And it�s out now, by the way.



STEVE:  ...that LG had announced.



LEO:  You can get it now.



STEVE:  And I don�t know whether you ever noticed the price.



LEO:  $1200.



STEVE:  Exactly.  And so it certainly is possible to get a dual format.  And frankly I had believed, and this was just from having heard it anecdotally, that there would not be dual-format players because licensing restrictions legally prevented it.  But it�s very clear that at least that�s not the case.  So there is hope that we won�t always be stuck in this which format do I need to � you know, like the old Betamax-VHS debacle.



LEO:  We�re praying.  We�ll see.  But I do like HD-DVD, AACS or not.  I have to say I think it�s a good format.



STEVE:  Well, okay.  So here I am, I already had the projector, so basically I had to run an HDMI digital cable because of all of the copy protection stuff that supports HDCP.  But once done, the good news is the HD-DVDs are not more expensive than regular DVDs.  So it�s like, okay, why would I not buy those?  Well, the only reason I would not buy them is if I really had some need to do something with the content other than just watch it.



LEO:  You�re right.



STEVE:  Because if, for example, I wanted to strip out all the annoying commercials or the menuing system, I have done that with some of the regular DVDs that I own.  I�ll reauthor them for my own use so that you put it in and it just plays the movie, rather than forcing you to sit there and watch their own previews on movies that are now no longer news because you�ve owned this disk for three years.  It�s like, you know, that�s really annoying.  And the other thing that�s interesting is that technically it�s now illegal for me to do that; but when I bought the disks with the intention and knowledge that I could decrypt them and reauthor them or compress them for watching on my Palm Pilot, it was not illegal because fair use in the law, in copyright law, was in effect.  So you wonder, wait a minute, I bought them with the intent of being able to do whatever I wanted to with the content that I felt that I had purchased.  And now along comes the DMCA that makes it illegal for me to do decryption.  It�s annoying.



And speaking of that, I don�t know if you picked up the news�that our friend muslix64 has not only cracked HD, but now Blu-ray.



LEO:  And that�s because it�s still AACS.  It makes sense;�right?



STEVE:  Well, but what�s interesting is he didn�t even have a Blu-ray disk.  Somebody who bought a Blu-ray disk was playing the Blu-ray movie in Windows using the PowerDVD player, or I think it might have been WinDVD, in fact.  That guy took a snapshot of the memory image of the process, that is, the WinDVD process, while it was playing the movie, presuming that if it was playing the movie...



LEO:  It would have the key.



STEVE:  ...the key had to be in memory.  And what muslix then did was � well, so this guy packaged up the memory image and a couple chunks of the encrypted content, which are just files, after all, on his Blu-ray disk, sent them to muslix64.  Muslix64, first of all, his decryption, he�s continued to work on this since we first talked about it around the turn of the year, around Christmastime was when this news came out that, quote, HD-DVD had been �cracked,� which is not the case.  But it is the case that it is possible to find the keys.  So what muslix did was, he did a�� and the reason I�m bringing this up is it�s some fun true crypto technology that we�ve talked about in the past.  He did a chosen plain text attack, meaning that the keys are 128 bits.  So you cannot just try every possible key.  That would be a brute-force attack where you start with all zeroes and then all zeroes and a one, all zeroes and a one zero, all zeroes and a one one, and you just go through every possibility.  Well, a 128-bit key you cannot brute force in any reasonable amount of time, as we�ve discussed in the past.  But you don�t have to try every possible key.  You just have to try every possible candidate key.  And the candidate keys are the ones that were in memory, that is, you don�t know, in the memory image, you don�t...



LEO:  So you don�t know where the key is.



STEVE:  Yeah, but it doesn�t matter because the memory image is much smaller than all the possible keys.



LEO:  Right.  So you just do a rolling slide through the�memory.



STEVE:  Yes.  And it works.



LEO:  Oh, baby.



STEVE:  It completely works.  So all you do is you take the first four bytes and assume that they�re the decryption key, try to decrypt a piece of encrypted content.  And you know what the beginning of the encrypted content looks like because it�s a standard MPEG frame.  So if that doesn�t work, you take bytes two, three, four, and five.  Then you take bytes three, four, five, and six.  Then four, five, six, and seven.  You just slide along through memory.  And our PCs are all fast enough, in a very short time basically you�ve searched the image, the software image of this thing playing, for the key.  You find it, and then you can decrypt all the content of the disk.



LEO:  Let�s put it this way.  It�s probably faster to do that than it is for the DVD player to decrypt the AACS, given the speed of your computer�s processor.



STEVE:  Yes.  And so here again I think we�re going to be seeing these kinds of things now coming out from time to time about AACS.  And what it really means is that software players are a huge vulnerability for this entire class of new encryption.  If the software is decrypting and you have access to the software, then you can�t protect it.  And this is fundamentally what I keep saying, is the reason this can�t ever work the way the content providers want it to is something in the user�s control, over which they have control, is displaying, one way or another, an unencrypted result.  Which means all the information to do the decryption has to be right there in order for it to be delivered to the end user.  So anyway...



LEO:  Sure, yeah.  That�s the flaw.  People often say � we might even have a question in our questions today.  But they often say, well, wait a minute, you say you can never crack an encrypted email.  How come you can crack a DVD?  That�s precisely the reason.  The key has to exist somewhere.  Very, very, amazing, just � I love that kind of stuff.



STEVE:  Isn�t that a perfect hack?  I mean, it�s just a beautiful hack.



LEO:  And obvious, obvious.  Let�s get to the questions, shall we?  We�ve got a good dozen from our wonderful, intelligent, perspicacious listeners, starting with Kenneth Kan of Boston, Massachusetts, who writes:  Your recent podcasts have been very inspiring.  After testing my system using SecurAble � yeah, from GRC.com, absolutely free � I had made sure that I had hardware virtualization and hardware DEP enabled.  However, it seems to be only available on the Windows platform.  Many technologies discussed on the show and some that I�ve researched in Wikipedia are apparently Windows exclusive.  For instance, I�ve never heard of my Mac OS X having this ability, to magically randomize its memory space every time it boots.  Does this mean Windows is way more advanced and secure than its counterparts on UNIX and Mac?



STEVE:  Okay, it was an interesting question.  First of all,�it�s worth noting that the Address Space Layout Randomization, ASLR, first appeared on and is most commonly known over on OpenBSD UNIX.  So that notion of randomizing the location of things actually didn�t come out on Windows first, it was in the UNIXes first.  And there actually are some utilities for even bringing this to versions of Windows.  Two weeks from now we�re going to talk about specific attacks on the hardware DEP, on the Data Execution Prevention stuff.  So I�m going to hold off a detailed discussion for then, for our podcast #78 in two weeks.  But it is not the case that Windows invented this, nor that this stuff is only available under Windows.  And certainly it�s the kind of thing that will be quickly adopted by the open source community because they�re able to move so fast.



LEO:  It�s a good idea.  Yeah, I don�t think it�s in OS X.  Now, you would think that, because OS X is running on Intel, that � I know hardware virtualization is available.  Is hardware DEP also available?



STEVE:  Well, it�s certainly available...



LEO:  Or if you flip a bit.



STEVE:  Exactly.  It�s certainly available to the operating system.  And it turns out that Sun�s Solaris, running on RISC chips, has also always had this capability.  So it has been around, it just hasn�t been a mainstream technology that a lot of attention�s been given to.  And of course, because I believe it�s so potent, I�ve done SecurAble, and I�ll be doing DEPuty afterwards in order to really help to raise awareness of this.



LEO:  Eric in Lansing, Michigan asks:  When using XP SP2, would we be safe changing IE7�s security from your recommended high to the default medium high � that is, that�s how it comes out of the box � if our computer has DEP configured properly?  In other words, would DEP prevent unsafe scripting?  Oh, good question.



STEVE:  Yeah, isn�t it, great question.  So first of all, to explain a little bit, what Eric is saying is that he knows that I believe surfing is just not safe with scripting enabled.  So my recommendation is that you convert your security, your normal Internet Zone security if you�re using IE, to highest security, which disables scripting, and then you selectively trust those domains that you have decided to trust, and you only allow those to run scripting, or to run scripting only when necessary as opposed to by default.  So he�s asking, if hardware DEP will prevent exploitation, does that make scripting completely safe?  And unfortunately it does not because, even if hardware DEP were able to completely prevent any kind of buffer overrun attack � and that�s a little bit of a gray area, it certainly is very strong in doing so � scripting is still unsafe.  Because, for example, what the hackers have now found out, and we saw this with a WinZip attack through IE recently, a couple months ago, they�re able to invoke any ActiveX control using IE and then talk to it.  So there might well be controls that you don�t want Internet Explorer to have access to which scripting enables.  So, no, I would say you really don�t want scripting, even if you knew that there would be no buffer overrun attacks on scriptable ActiveX controls.  It�s still not safe.



LEO:  It�s not just buffer overruns that are the problem.



STEVE:  Right, it�s scripting.  Scripting is a bad thing to allow websites to do to you.



LEO:  Although I was using the NoScript extension in Firefox, and I have been since we talked about this last time.  It�s such a pain in the butt.



STEVE:  I know.



LEO:  I finally just said, I�m taking my chances.  I gave up.  And so this is always the balance, isn�t it, between convenience and security.



STEVE:  It really is.  Now, of course, running in a virtual machine solves that problem, too.  If you�re willing to, like, browse in a VM and shut it down and not save the things that it does, that�s really safe, too.



LEO:  Moving along to Topher Slater of Portsmouth, VA.  He asks:  How will retail respond when the key for my video card or HD-DVD has been revoked, and I want to return it?  He�s talking about that revocation process where the Motion Picture Association could say, oh, that video card doesn�t do what we want it to do, we�re not going to allow it to play back HD-DVDs or other premium content.  He said:  Or what happens if I buy a DVD and it will not play on my player?  I have to open it in order to find out if it will work.  As of now, they won�t take it back.  Am I stuck with a $20 piece of plastic?



STEVE:  It�s a really good question.  I really have to believe that the threat of revocation is easily blown out of proportion.  It�s such a bad thing for players, commercial players, to have their licenses revoked that it�s difficult for me to believe it would ever actually happen.  So, I suppose, I mean, we know it�s possible.  We know the technology is there.  We know that the content providers unequivocally have the capability of doing that.  But I just have to wonder how big a problem it really is.  And I don�t want to scare people by saying, oh my god, because it can happen, it will.  It very well could never happen.



LEO:  I think, now having heard all the arguments pro and con, it would be such a costly, public relations-wise, thing for them to do, there�s no way that�s going to happen.



STEVE:  It would be a disaster.



LEO:  It�d be the end of the, not the movie industry, but of the MPAA for sure.



STEVE:  And to get back to Topher�s question, he�s asking would he be stuck with a worthless piece of plastic, meaning his DVD.  Certainly not.



LEO:  And that�s up to the retailer.



STEVE:  Well, yes.  Well, the DVD is still playable.  You don�t revoke the DVD.  You revoke the player or the screen or something in the encryption channel.



LEO:  Well, here�s something that actually is a real issue.  You can go out and buy an HD-DVD thinking you have an HD-DVD player, which you might, but you don�t have the properly encrypted monitor.  This happens all the time; right?



STEVE:  Yes, very good point.



LEO:  Yeah.  And you get a black monitor because your monitor either doesn�t do HDMI or does HDMI but not HDCP.  That has been happening to people.  And I guess that�s up to the retailer whether they�ll take it back or not.



John Hutchinson of Clermont, Florida, is worried about LAN-based viral spreading.  That doesn�t sound good.  He says, I have a few questions regarding Windows filesharing.  I use Windows filesharing extensively inside my NAT router for things like backing up data between machines using an old command script I wrote years ago and for just moving files around between machines.  John, I do exactly the same thing.  I back up all the time over my network.  Sometimes I map a drive.  Me, too.  Sometimes I just browse using My Network Places.  It�s very convenient.  I tend to shy away from mapped drives.  I suspect that might make it easier for malware or viruses, should it get one on a machine or on my LAN, to propagate.  I suspect, however, this is not much of a deterrent as, if I can browse My Network Places, so can malware.  Secondly, I have nightmares of someone visiting with a laptop and loaded with bad things, using my Wi-Fi to connect and having bad things propagate on my LAN that way.  That does happen.  That�s why Zotob knocked out CNN about a year ago.  So my question is, do you have any recommendations regarding how to make it harder for malware to spread to another machine on my network, without sacrificing the convenience that filesharing provides?



STEVE:  No.



LEO:  Oh, come on.  I do.  The Zotob worm and all of these other worms aren�t an issue if you turn on Windows Firewall on each system.



STEVE:  Well, exactly.  I was being a little facetious�because...



LEO:  You were being facetious.  See, I�ve been listening to you.  I know the answer.



STEVE:  Well, although with Windows Firewall up, then you still have a problem of making those machines connect.  That is to say, if you have mapped drives, malware can see mapped drives.  So the only thing I can imagine...



LEO:  A mapped drive just means that that network drive has a letter, it�s drive Z or whatever, and so you can open it as if it were a regular drive.



STEVE:  Exactly.  It�s very easy for something to see it.



LEO:  And so malware wouldn�t have to look on the network, yeah.  It would just say, oh, hey, there�s something on the M drive.



STEVE:  Yes, it would have to do no work in that case.  The only thing I could suggest would be that, if all of your machines are in the same workgroup and/or domain, with the same username and password, then you�re able to create a mapping without giving any credentials.  However, if you deliberately had different usernames and passwords on the different machines, then you do have to create some credential, you have to give it the log-on credentials of the target in order to create the mapping, and no malware would know how to do that.  So again, it makes it less easy to do this kind of filesharing.  You have to not leave static mappings up against the danger that something could get into your machine and spread.  And so that means you�ve got to bring them up and tear them down when you�re not using them.  And it�s exactly what we always run into, Leo, like what you were talking about, about not using NoScript under Firefox because it just � it�s a pain to have to give�sites permission.  Similarly, it�s a pain not to be able to use static mappings.  But if you want the security of not having that liability, it�s going to be a little bit of hassle.



LEO:  You know, okay.  I map, but...



STEVE:  It�s a balancing act.  It�s a balancing act.



LEO:  It is a balancing act.  I map, and I�m not too�worried.



STEVE:  I use file mapping myself all over my network.  And I�m just very careful not to let anything bad get in.



LEO:  I guess my attitude is, if there�s something bad on your network, you�re dead anyway.  Doesn�t matter if you�ve file mapped or not.  And if somebody comes in and uses my network, which does happen all the time, I think that�s why it is important to have an individual firewall on each machine as opposed to the NAT router because they�re inside a NAT router.



STEVE:  Yes, very good point.



LEO:  David Gladstone, not far from Peter Gutmann, he lives in Auckland, New Zealand, has been doing some thinking about Vista DRM.  David says:  I�ve been listening to your discussions of Vista DRM and revocation of drivers.  My understanding is that premium content is not necessarily only available on HD-DVD or Blu-ray media.  If so, I was wondering if it would be possible for a suitably crafty hacker to create a �viral video,� in both senses of the term, that contained revocation lists for a bunch of non-leaking drivers, thus neutering the Vista platform.  Wow, this guy�s thinking real hard.  I am sure there must be some cryptographic safeguards to prevent this.  Maybe this is a weak link?  Is there a single private key that, if compromised, could bring down the whole pack of cards tumbling down?  That�s interesting.



STEVE:  It really is interesting.



LEO:  So let me understand what he�s suggesting.  So somebody puts a video up on YouTube.  The video has revocation lists in it.  And but wrong, illegal revocations lists somehow.  And while you watch that video it�s basically disabling the functionality of your video card.  Is that possible?



STEVE:  Well, what prevents that is that there is a single central revocation list authority which is this � I believe it�s the 5C Authority, if that�s the same as who runs AACS.  But anyway, it is the AACS Authority that maintains the master copy of the revocation list.  All of the AACS licensed players have only the public key that allows them to decrypt the master revocation list.  Nobody but the AACS has the private key, which they use to encrypt the master revocation list.  So it is not possible for someone to basically make up their own naughty revocation list and get any players that are operating correctly to decrypt it and believe it and apply it.



LEO:  Makes sense.



STEVE:  So really this whole, you know, the jump that we�ve had in crypto has been hugely leveraged by the AACS system, using public key and symmetric key crypto in every way you could imagine so that they, I mean, they really have thought through all these scenarios and done everything that they can think of to prevent it from being abused.



LEO:  The good old public key cryptography helps everybody.  SN listeners Mr. and Mrs. Sven Thomas of Caronport, Saskatchewan have been wondering � I love reading these.  I just love it.  It feels like old-time radio, doesn�t it?  Mr. Answer Man, we have questions about the HDCP and Vista DRM in general as they pertain to hi-def home video and high-end hobbyist video content makers.  While it�s clear that HDCP affects only HD and premium HD content that is played back from a commercial HD-DVD or Blu-ray disk, what about those of us who use, for instance, Sony Camcorders, hi-def camcorders, and produce hi-def content for ourselves?  Is Vista and our future hardware, including that inside the camera, going to cripple my personal HD content, just because it�s not digitally signed?  Or will the camcorder apply a consumer-type key that will allow any content we create to be played back in hi-def?  He�s worried that all this hi-def content protection is going to impact his personal recordings.



STEVE:  Right.  And it absolutely will not because his personal recordings will not be encrypted.



LEO:  So just as Hollywood could make a DVD that you could copy, you get to make a DVD, even hi-def, that you can give�to your friends and everything.  It doesn�t impact you�at all.  So it�s not the fact that it�s hi-def that�s the issue.



STEVE:  Exactly.  And in fact, the same has always been true of regular old standard definition DVDs.  If you create your own DVD, for example, from your home movies, converting your home old 8mm movies over to DVD, if you have some service do that, they�ll almost certainly be producing a non-encrypted DVD, which is then freely copyable.  I mean, if it�s not encrypted, in no way will anything prevent you from doing whatever it is you want to do with it.



LEO:  Dee Smith of Leesburg, VA says:  I really enjoy your podcast seminars with Leo.  So does Leo, by the way.  However, the more I hear about Vista and the diabolical plans for hardware digital rights management, the more I want to find an alternative.  Every two years or so I build myself a new system.  It�s about time for a new one, and I�m anxious to avoid all the embedded complexities that Microsoft is forcing on the hardware guys.  All I want is a Core 2 Duo system that will perform well and do justice to my new 24-inch Dell monitor.  I have no interest in HD media players.  If necessary, I�ll also stay with XP Pro for as long as I can, if that�s what it takes to avoid Big Brother Bill.  Any suggestions?



STEVE:  Well, I would suggest doing exactly what I�m doing.  I have just put together a big Core 2 Duo � actually, mine is a Core 2 Quad.  I named it Quadmire.  And I�m installing Windows XP Pro.  That�ll be my new platform.  Because first of all, we know that I�m a Luddite in terms of staying, like, one major step behind.  I�m still using Windows 2000 as my main workstation.  And so I�ll be moving to XP.  For people who are really put off by Vista, who don�t feel that they�re getting any benefit from Vista above and beyond, well, enough benefit to tolerate this sense of losing control over the OS and so forth and so on, then, I mean, I would just say stay with XP.



My sense is Microsoft may have a much harder time killing off XP than they want to.  They�ve been forced in the past to continue supporting OSes or OS versions that they really wanted to shut down support for, but they weren�t able to because of strong demand, mostly from their enterprise customers.  They�re less concerned about individual end users.  But the enterprise customers just said, no, we�re not going to be ready yet to move up to the next platform.  And Microsoft�s been forced to continue support.  So I would be very surprised if Microsoft�s able to kill off XP, given that the only choice is people going to Vista who just don�t want to.



LEO:  I wonder if Microsoft would consider making kind of a stripped-down version of, let�s not say Vista, but let�s say of Windows, that is for people who don�t want all of this extra stuff.



STEVE:  That�s been discussed in our newsgroups, over in the newsgroups on GRC.  The reason it can�t be done is � which is unfortunate because that would be a tremendous solution.  And in fact, maybe you were talking about it on TWiT because I feel like I�ve heard this...



LEO:  I�ll put it this way.  They do make a stripped-down�version for the China market of XP, for the international markets.



STEVE:  And of course we have the, quote, �Media Center Edition� of Windows XP that would sort of lead you to believe, well, how about, like, a really non-media-centric version of Vista.  The reason they can�t is that all of this AACS and the so-called protected video path and the protected audio path, they have hugely changed the fundamental kernel of Windows in order to embed this stuff really deeply into the OS.  It�s not something you can simply remove.  It�s really been a pervasive change to the architecture of the OS, making it a solid DRM platform.



LEO:  And also from a political point of view, they don�t want to do this because really what you�re seeing here is Microsoft�s response to Hollywood�s assertion that all a PC is is a piracy device.  And really Hollywood would like to see all PCs neutered, regardless of what you want to do with it.  They see them, every single one, as a potential piracy device.  They say, look what happened to DVDs.  That�s how people use their PCs.  So what Hollywood would like is for not one PC to be sold without this kind of copy protection on it.  That�s their goal.  And I think to some degree Microsoft�s acquiescing by making Vista.  And that�s why this DRM is built in to every copy of Vista, regardless of whether the machine comes with a hi-def player or not.



STEVE:  Well, we�re going to have, next week, when we run through Microsoft�s blogged response, David Marsh�s response, I think a lot of these issues get covered.  It�s going to be really interesting.



LEO:  Oh, good.  Oh, I can�t wait.  That�s next week, good.  Microsoft�s response.  I can�t wait to hear it.  Rich in Highlands, Scotland � and I�m not going to do the accent.



STEVE:  Thank you.



LEO:  Well, maybe I will.  No, okay.  Wants to find a new free email service.  He writes:  I have a problem.  On signing out of my Yahoo! mail account I was horrified to discover that at the bottom of the page it said, quote, �Notice:  We collect personal information on this site,� end quote.  I also noticed that after signing in, the URL changes from HTTPS, the secure HTTP, just to plain old HTTP://.  I thought it might be time for a change from Yahoo!.  I heard you talk positively about Gmail several times.  However, I just discovered you have to be invited.  Can you suggest somewhere I could make an email account that won�t take my info and will stay secure?  This is a real issue because I use my Yahoo! mail for eBay, Amazon, et cetera, and I�m now really convinced I should switch.



STEVE:  And this is actually a question for you, Leo.  I�thought maybe you�d have a better sense than I do.  I�mean...



LEO:  I do.



STEVE:  ...I know about Gmail.  I really like it.  I would be surprised, if this guy knows anyone who has sent him email who has a Gmail account, he could simply write to them and say, hey, could you invite me to Gmail?  I think I�ve got a hundred invitations sitting here.



LEO:  Oh, I�ll send him an invitation, yeah.



STEVE:  Yeah, exactly.



LEO:  I don�t know that Google is any better than Yahoo! in this respect.



STEVE:  And of course it is frightening because we know that�they�re archiving everything forever.  Which is sort of�frightening.



LEO:  And we know that their business is advertising, just as Yahoo!�s is.  So this Yahoo! disclaimer may be not something to really be terrified about.  Every website collects a certain amount of information, like your IP address, automatically.  So this may be a lawyer saying we�d just better disclaim this.  I don�t know that Yahoo! is somehow trying to cross-reference your IP address with stuff you do online and so forth.  But if they are, Google just as well might be.  There are, however, web-based mail services that are aggressively private.  Probably the most so is Hushmail, at Hushmail.com.  Hushmail is remarkable.  First of all, it�s PGP.  All your mail is secured.  It�s built in.  It�s automatic.  They also are extremely privacy sensitive.  And their business is not selling advertising, it�s selling Hushmail.  They do offer a free version, but they also offer some very advanced business solutions.  So...



STEVE:  And there�s also COTSE; right?



LEO:  CO � I don�t know that one.  COTSE dot...



STEVE:  I think .com, .net, I�m not sure.  I think it�s also a very strong...



LEO:  The ultimate way of protecting your privacy online.  Oh, that�s interesting.  I have not seen that one.  Full-service privacy website, your shield from the Internet.  So it sounds like they do proxy stuff, as well.



STEVE:  I know that they have mail, so...



LEO:  And another email service that is also aggressively � now, I like Hushmail because it has built-in PGP, so there�s a lot to be said for that.  But SpamCop.net is an antispam site that is also aggressively privacy focused.  So another�� and I actually have a SpamCop account, as well.  If you want to avoid spam or report spam, SpamCop is very useful there, too.  So I�m going to have to take a look at COTSE.  That�s interesting.  But Hushmail, Phil Zimmermann worked with them for a while, the creator of PGP.  I think they�re a very good group.  And they have a lot of interesting features.  But, I mean, email is not private, as�we know.  The only way it could be private is if you encrypt�it.



STEVE:  Exactly.



LEO:  Someone referring to themselves as �Anonymous Sender� says:  At work we have web applications which require testing from outside our firewall.  Currently we attempt to do this with an iMac running OS 9 and a 56K modem.



STEVE:  Isn�t that great?



LEO:  Not the best solution, he says.  We�re wondering if it would be possible to use The Onion Router from either a newer OS X machine or a machine running XP to access our site as if we were outside the firewall.  Oh, I see.



STEVE:  Brilliant, it�s brilliant.



LEO:  I see.  So their web applications running on their site, and they want to test them as if they�re a customer.  I get it.



STEVE:  Yes.



LEO:  If I understood your description of TOR, it sounds like using it would give us the same view of our site as we would see from outside the firewall because our incoming connection traffic would be coming from outside.  Is this right?  Any pitfalls I�ve missed?



STEVE:  That�s brilliant.  I think it�s a perfect idea and solution.  Yeah, it ought to work great.  I mean, what they�ve been doing is they have a dialup ISP somewhere.  They�ve been using their 56K modem to dial into the ISP and then surfing back to themselves from outside.  And yes, The Onion Router ought to work.  And because with The Onion Router you�re able to determine the complexity of the onion network, you could just tell it, we just want to use one.  So you�d have very little latency and other problems associated with, like, really long, multi-hop onion routes.  So that�s a tremendous idea.



LEO:  Microsoft does have some tools, I seem to remember, for doing this kind of thing.  But that seems like an easier way.  Free, certainly, yeah.  Bob Sudduth of Dayton, Ohio � you were born in Dayton?



STEVE:  I was born in Dayton.



LEO:  Wow.  From your hometown.  How long did you stay in�Dayton?



STEVE:  I wasn�t even conscious, I think.



LEO:  There and gone.



STEVE:  Well, I guess I was barely conscious.  My sister was�born in Fairborn, and I�m two years older than she.  So�I guess � and I think my parents left shortly after she was born.



LEO:  What were they, on the run?



STEVE:  So I was two-point-something years old while I was in Ohio, and I�ve never been back.



LEO:  Then to Fairborn, and then to California.  Extrapolating from your discussion on Vista and DRM, what�s to keep companies from being extorted by hackers?  For example, if you don�t pay us X million dollars, we�ll disable all your drivers everywhere.



STEVE:  Right.  And that comes right back...



LEO:  Same thing.



STEVE:  Yes, exactly.  I put this in there because many people have worried about this and asked the question.  So although we just read Bob�s question, this is for everyone who asked.  Same story, is nobody else will ever have, hopefully, or that would really be a problem, the private keys for the public key crypto system that the AACS guards as an absolute secret, so that there�s no way for anyone to spoof any of this information anywhere along the chain of delivery from the AACS.  It�s really interesting, in fact, there�s something we didn�t talk about because it was sort of an unnecessary level of detail.  But even the production of the HD or Blu-ray that is an AACS content, nobody knows anything more than they need to.  The content provider is given some keys.  The actual manufacturer is given a different set of keys.  And then of course the rendering machine, the computer or driver display, they�re given their own keys.  And they have this all kind of fixed together in an interlocking way.  But nobody has the ability to do anything wrong with the system because everything is protected from everything else.  So, I mean, it�s a beautifully engineered system.  It�s just a pain to have it.



LEO:  It works.  Listener Ed from Philadelphia wonders:  What are the security benefits of surfing the �Net under a user account rather than an administrative account?  Boy, I run all the time under user accounts on all my machines.  I remember having heard of it several times on Security Now!, he says, but would you remind me?  And by the way, this is not just on Windows.  This is on Mac, on any operating system.  You don�t have to always run as an administrator or root or super user.  You could run as a normal user.



STEVE:  Right.  And in fact, of course this was all created by UNIX machines originally, where the administrative account was called the �root� account.  And then you would use, I mean, even servers would log in as non-root users, so if they were compromised they wouldn�t be able to do really damaging things to the system.  So to answer Ed�s question, the idea is that when you�re surfing as a user account, or that is to say a limited user or a non-admin account, essentially the programs you�re using are running with your privileges, that is, your log-on privileges.  If those are limited, then the program�s actions on the OS are similarly limited.  So, for example, it�s not able to launch code running in the kernel because that�s not a privilege that a limited user has.  Only an administrative user is able to do that.  So the point is that the programs you run, run with the same privileges that you do.  And so they�re limited just like you are from doing bad things to the system.



LEO:  There are some drawbacks to doing this because some programs don�t work well if you�re not a super user, a root, or administrator.  I think a lot of programs don�t.  I found it to be a little bit easier under Vista than it is � in fact, a lot easier than it is under XP.  So they�ve fixed that problem from an operating system level.



STEVE:  Yes.  In fact, Vista � at one point we will talk in depth about UAC, the User Account Control, because all users of Vista see is this box that�s popping up all the time, asking them for permission to do things.  It turns out there�s much more going on under the hood.



LEO:  Ah, interesting.



STEVE:  Yeah.  It�s some very potent, powerful, and useful�technology.  So we�ll certainly be doing an episode�of Security Now! to explain exactly what is User Account Control.



LEO:  Even if you run as administrator, you see that UAC box.  If you�re running as a limited user, however, you�ll be asked for the administrative password, which I think is a little bit more secure, I really do.



STEVE:  I agree.



LEO:  And that�s kind of how Apple does it, as well.  Even if you�re running as an administrator, you have to give it the password to actually give it the root permissions to make the changes it needs.  But nevertheless, on both Apple and Windows, I almost � except for XP, where it�s just almost undoable.  But on Vista and OS X I�m always running as a limited user, and it works great.  In fact, my only regret is that in Vista it doesn�t kind of require you to set up a limited user account.  When you set up an account, it�s automatically an administrative account.



STEVE:  Yeah, I think that�s Microsoft again, recognizing that it would just be too hard to sell for most users.  And so but what they�ve done is, and this is what we will be talking about in detail, is even an administrative account, there�s like a lack of automation for the things that can happen.  If anything tries to do things that modify the operating system, there�ll be a dialogue that pops up.  And this is not just a regular dialogue.  There�s all kinds of protection around that simple-looking UAC popup that you�re clicking �Okay� on.  So that if some malware got in your system and tried to make a modification behind your back, even as an administrator it would not be able to do so without your permission.



LEO:  Jeff Smith of Alpena, Michigan, after listening to my KFI show, I guess, has a question.  Uh-oh.  I hope I didn�t say something stupid.  I learned about a very cool program thanks to Leo and his KFI podcast.  It�s called CrossLoop and can be found at CrossLoop.com.  It�s a simple remote desktop � oh, yeah, this is really cool � simple remote desktop-type application which has been very helpful for me, the family computer geek.  It�s amazingly simple to set up and use, even for the beginner computer user.  However, since I�m a listener to your Security Now! podcast, I�m curious if there are any security risks to myself or others by using this program.  It�s a remote access program.  Mind you, it has never given me any reason to suspect it.  I�m just a cautious person when it comes to my computer security.  And I�m confident that you could give this program a thorough look at how it works.



STEVE:  What it is, is it�s sort of a cross between VNC and Hamachi.  And in fact it uses VNC�s open source, I think it�s the code from the TightVNC version, the open source VNC.  Then what they�ve done is they�ve added cross-router penetration like Hamachi does, so that essentially you�re able to give the app to another person.  You have a copy.  Instead of having this notion of separate client and server, which can be confusing, you�ve just got two different tabs.  One of them is the host, and one is the guest or however.  I mean, the idea is that it�s for desktop sharing, very easy desktop sharing.  Then you create a user account for yourself.  And it uses a 12-digit number to sort of authenticate.  So all of that�s good.



The only downside, and this is true of any service which is going to do NAT router penetration for you, like Hamachi or like this CrossLoop, is you are inherently trusting that external third party not to mess with you, not to play any games.  Because both users behind their routers are contacting that third-party server.  That�s the thing which is negotiating their subsequent direct point-to-point connection between them.  And that�s how the NAT penetration works, as we�ve discussed in the past.



So again, he has no reason to mistrust the CrossLoop guys.  We have no reason to mistrust them.  I mean, I talked to, as you remember, Alex Pankratov, the original author of Hamachi, and was very convinced that he was a good guy.  But I like the idea of having complete control myself.  And so I shy away a little bit from � just anyone should be aware that the involvement of a third party does give them the ability, if they wanted to, to play games.  Which is not to say they ever would or are.  But that�s a factor.



LEO:  We don�t know who they are, and so we don�t...



STEVE:  And again, it�s a tradeoff that you make in, again,�a typical security tradeoff.  If I don�t want the responsibility for needing to configure my NAT router to, for example, doing a static port mapping into the router in order to get to my computer from the outside, if I don�t want that responsibility, then I�m going to trade that for some little bit of security, probably not enough to worry�about.



LEO:  Right, right.  Steve, we�ve completed 12 questions and 12 answers.  Unbelievable.  And since this is our 15th episode, that means you�ve actually done 180.



STEVE:  And we�ve got many more.  When I checked my mail I had 600 postings from people came down.  So we won�t be running out of questions anytime soon, Leo.



LEO:  We�re glad to get the questions.  Can you tell people once again how you find the questions?  I mean, where to submit one?



STEVE:  Right.  We have a form at the bottom of the Security Now! page.  So just go to GRC.com/securitynow.  The page will come up, and just hit �End� on your keyboard, or scroll to the bottom.  There�s a form there.  People can be anonymous if they choose; or, in fact, if they want to get their questions read on the air, they need to use their name and tell us where they are.  Not that we want to force people to be non-anonymous, but we like to be able to say, hey, Jeff Smith of Alpena, Michigan asked the following question.  It�s just more personal and more fun for us.  So send a question to me, and I�ll get it, and perhaps we�ll read it.



LEO:  And while you�re at GRC.com don�t forget SecurAble, Steve�s new free security application, along with dozens of other security applications, including the great ShieldsUP.  GRC.com is the place to go.  And, you know, the one thing that�s not free on GRC is the thing that is the most valuable, the great SpinRite program, Steve�s bread and butter for the last decade or so.  It is the ultimate disk recovery utility.  And by the way � or just maintenance utility.  I run it regularly on all my disks to catch problems before they happen.  And if something happens to corrupt your disk, or bad sectors, SpinRite can almost always recover those bad sectors, recover that data, and get you back on your feet.  It�s really a great program.



STEVE:  Well, and we�re here for people, too.  I received an interesting note from someone over Christmas.  The subject was �Redownload SpinRite from remote location.�  And he first wrote to our sales address, which Sue monitors even through the holidays.  And actually this was on the 23rd, so not on Christmas Eve, but the day before.  And he asked, he said, just wanted to say thanks so much.  Oh, when he first wrote he said:  I purchased SpinRite a while back.  I�m at my mom�s for Christmas, trying to troubleshoot what looks like a hard drive problem on her computer.  My SpinRite and license info is at home.  Is it possible for you to email me creds to download a copy to try to run on her hard drive?  And then he says:  I think I registered either under blah blah blah or blah blah blah, you know, his two email addresses that he had.  If you could send information to either of those addresses, I would be able to get them from here.  Many thanks, and have a wonderful holiday.  So Sue got his mail, looked him up in our ecommerce system, which I wrote from scratch, and it has all these capabilities.



LEO:  Of course you did.



STEVE:  So she found him, sent his transaction code, which he didn�t have.  And the transaction code allows any of our SpinRite owners to download SpinRite from anywhere they happen to be.  So, for example, if he had it in his wallet, he could have used that in order to grab a copy.



LEO:  Keep your code with you at all times.



STEVE:  Well, you just never know when your mom�s computer�s going to crash out.



LEO:  That�s right.  In fact, I�ll be fixing my mom�s computer next week, so I�m bringing my code with me.



STEVE:  What was really cool was he then followed up that letter.  And he said:  Just wanted to say thanks so much.  I got the ISO, burned a CD, ran SpinRite, and now Mom�s PC seems to be running just fine.  He said there had been a failure in a Windows component related to Windows Explorer.  So after boot, things just pretty much stopped working.  He said:  After SpinRite, it�s all good.  She�s thrilled to have her email and web back, so you provided her the best Christmas present this year.



LEO:  See, that�s really interesting.  Hard drive failure, you know, these big hard drives now are so huge, and it can happen at any time.  And that can give you all these weird symptoms that, you know, I answer all the time on the radio�show.



STEVE:  It�s funny, I was doing some research on Seagate�s site because I�m setting my new system up with serial ATA drives.  I was talking to Mark Thompson, who was commenting they�ve got so many systems, they�ve got hard drive problems all the time.  And he said it�s mostly the newer disks.  When I was on Seagate�s site, I was a little surprised by their reliability claim.  This is the spec sheet.  It was a 7200.9, a Barracuda, brand new Barracuda SATA 7200.9 drive.  They were saying they had 0.34 percent failure per year.  I�m going, wait a minute, 0.34 percent failure per year, that�s one in 300, because it�s a third.  One in 300 drives will fail per year. 



LEO:  That�s high.



STEVE:  It�s high, Leo.



LEO:  Think of how many millions of drives they sell.



STEVE:  Now I know why I�m getting so many testimonials for�SpinRite.  Yeah, I mean, one in 300 are going to die per�year?



LEO:  And even in this case, this wasn�t even a drive failure.  This wouldn�t even have counted there.  This was just some error on the data.  So, I mean, yeah, it must be even more, one in a hundred.



STEVE:  I was really surprised that apparently the reliability is beginning to come down.  As you say, when you put a terabyte of data, eight terabits on a drive, which drives are now up to, how do you get them all back?



LEO:  Well, GRC.com, that�s the place to get the answer to that question.  I know how to get them back.  SpinRite.  By the way, I want to thank our sponsor, Astaro Corporation, makers of the Astaro Security Gateway.  They�re just great folks.  We unfortunately had pretaped our show last week so I couldn�t mention, they had an event in Toronto last, well, actually it was this week.  And I wasn�t able to give them a plug, unfortunately, because we had pretaped.  But I�ll mention future events.  It�s actually great.  They do these events where you can go, and you could try it out, you could see it at work.  And the Astaro Security Gateway is a really, really remarkable device.  In fact, they wanted me to mention V7.  This is a new technology they�re launching this month.  You may not know about this.  I�ll get more details on it from the folks.  But it�s an email encryption, or actually just a basic encryption technology that they�re building into this ASG.  That�s the beauty of it.  It�s an open source platform.  It looks about the size of a router, the Astaro Security Gateway.  It�s running open source Linux.  But because it�s such a powerful platform, they can add these plug-ins.  It has VPN capabilities, intrusion protection, content filtering, antispam, industrial-strength firewall.  It�s very high performance.  The best thing to do is just try it free.  And it�s beautiful because sometimes you�ll just get new features they just download into the firewall.  Contact Astaro at Astaro.com.  I shouldn�t call it a firewall, it�s a security appliance.  Or call Astaro at 877-4AS-TARO, and they will schedule a free trial of the Astaro Security Gateway appliance in your business.  And we thank Astaro for supporting Security Now!.  And I�m sorry I didn�t get to mention that event.  Feel bad about that.  It was actually, as we record this today, it was last night in Toronto, at Lynch Digital Media.  Oh, well, next time.  Steve, I think we have run out of time.



STEVE:  We got another good hour.



LEO:  And then some.  I will see you next week.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#77

DATE:		February 1, 2007

TITLE:		Microsoft on Vista DRM

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-077.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  In episode #74 Peter Gutmann shared his concerns and fears about the system-wide consequences and impact of the digital rights management (DRM) Microsoft has built deeply into Vista.  Microsoft�s Vista Team responded with a comprehensive Blog posting which Steve and Leo read and examine this week.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  This is Security Now! with Steve Gibson, Episode 77 for February 1, 2007:  Microsoft Responds.



Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



It�s time for Security Now!, everybody�s favorite security podcast.  And here he is, ladies and gentlemen, the star of our show, Mr. Security himself, Steve Gibson.  Hey, Steve.



STEVE GIBSON:  Hey, Leo.



LEO:  We need a live studio audience with music.  It�d be fun to do all that.



STEVE:  Whistles and catcalls and things, yeah.



LEO:  So we are going to address a podcast that we did a couple of episodes ago this week.



STEVE:  Right.  I wanted to, in all fairness, I wanted to give Microsoft�s response to Peter Gutmann�s white paper about Vista DRM some airtime.  I was thinking we could just tell people to go to this link.  But it�s like, wait a minute, this is an audio podcast, let�s audio-ize Microsoft�s publicly posted blog response and discuss it.  Because, you know, obviously Microsoft was not happy by what Peter had to say.



And so what happened was David Marsh, who is the guy whose name I�ve seen on all the documentation on all of the PowerPoint slides that are presented, he�s the guy at the WinHEC conference who exposed this for the first time, showed what AACS was, how it works, I mean, he�s the main guy at the center of Vista�s support for AACS.  And some guy named Nick White, who�s with the Vista team, he has a Vista Team Blog.  On Saturday January 20 he posted, essentially asked Dave to come up with 20 questions and answers which � basically synthetic questions which Dave felt were being raised by Peter�s white paper, and to address those, to answer those questions.



In going through them, what I�m going to suggest is that you read this, Leo, and then I�ll sort of react to them and tell you what I think about them.  And many of the points are very fair.  And I think we�re most useful to our Security Now! listeners if we really work to paint a balanced picture.  Certainly it�s been fun to look at the sort of, okay, what�s the dark side of AACS.  But many people are wanting to use Vista.  They�re going to use Vista.  Many are going to have to use Vista.  Or when they�re buying a new PC, it�ll have Vista on it, and they may not have a choice.  So I want to back off from overstating and also give Microsoft a chance to tell their side of the story.



LEO:  So in this particular podcast I�ll play the role of Microsoft.  I�m Dave Marsh.  And shall I just start reading, and you stop me when you have something to say, how about�that?



STEVE:  Yeah, I think that�s perfect.



LEO:  Dave begins:  Over the holidays, a paper was distributed that raised questions about the content protection features in Windows Vista.  The paper draws sharp conclusions about the implications of those features for our customers.  As one of the lead program managers for the technologies in question, I�d like to share our view on these questions.  Windows Vista � anything from the opposition?  Nothing, okay.



STEVE:  No.



LEO:  Windows Vista includes content protection infrastructure specifically designed to help ensure that protected commercial audiovisual content such as newly released HD-DVD or Blu-ray disks can be enjoyed on Windows Vista PCs.  In many cases this content has policies associated with its use that must be enforced by all playback devices.  The policies associated with such content are applicable to all types of devices, including Windows Vista PCs, computers running non-Windows operating systems, and standalone consumer electronics devices like DVD players.  If the policies required protections that Windows Vista could not support, then the content would not be able to play at all on Windows Vista PCs.  Clearly that isn�t a good scenario for consumers who are looking to enjoy great next-generation content experiences on their PCs.



STEVE:  Now certainly he raises the point, basically he�s trying to say we didn�t create this, we didn�t do this.  And if we didn�t offer this kind of DRM content protection, then Windows Vista PCs would not be able to play it.  And that is absolutely true.  I mean, it is the case that the way AACS works is that the content providers, through this really super-powerful, next-generation DRM, this digital rights management, they�re able to absolutely dictate what devices are able to play.  So it�s only if Microsoft provides an infrastructure, which they have with Vista, which is sufficiently secure and provably secure, that then there�s any possibility for Windows machines playing this content.



LEO:  So it�s really basically what a number of rebuttals to Peter�s argument in Peter�s own website said, hey, they don�t have a choice, they have to do it.



STEVE:  Right.  Essentially all Windows Vista is is another implementation of AACS, much as you will have in any consumer device.  There will be AACS there if that device is able to play this AACS-protected content.



LEO:  Peter made an argument, frankly, an argument for which I don�t think he has any standing, saying, well, hey, Microsoft could have just said, we�re Microsoft.  We have 90 percent of the PC market; we�re not going to do it.  I mean, that�s a business argument.  It has nothing to do with security.  And I don�t know if any of us are competent to say whether Microsoft could or could not do that.  Maybe they should, but...



STEVE:  Well, but Microsoft, yeah, if Microsoft had done that, we then are faced with the question, would hi-def content providers essentially have scrapped all their content protection because they�re so desperate to have movies playable on personal computers?  I think it�s clear that that�s not the case, that content providers would say, fine.  If you are not going to give us a secure platform, Windows users � XP users, Vista users, any users � just like, by the way, Linux users, and I don�t know where Mac is on this.  But, for example, Linux users are not able to play hi-def content either because Linux doesn�t bring all of this protection that�s necessary.  And we are seeing the danger in XP users being able to play this, as we talked about last week, this muslix64 character is using now a known plaintext attack on the �cryption used with this content.  So again, if Microsoft had said, we�re not going to play ball, then I think it�s very clear that Windows Vista would not be able to play hi-def content.



LEO:  So I will continue on here.  Associating usage policies with commercial content is not new to Windows Vista or to the industry.  In fact, much of the functionality discussed in the paper has been part of previous versions of Windows and has not resulted in significant consumer problems, as evidenced...



STEVE:  Okay, now, stop there.



LEO:  Whoa, whoa, whoa.



STEVE:  In fact, much of the functionality discussed in the paper has been part of previous versions of Windows.



LEO:  That�s not true.



STEVE:  That�s absolutely not true.  I will defend David�s need to have this in Vista because there�s no other way, if Vista�s going to be able to play HD-DVDs.  He cannot say that much of the functionality discussed in the paper.  Because, I mean, the paper was all about the bad parts of DRM in Vista, none of the happy news.  So it�s...



LEO:  He could say, okay, so there was a random number generator.  I mean, I guess you could say some sort of root technologies were there.  But there wasn�t an AACS layer.



STEVE:  We had no tilt bits, and we had no encrypted video path and all that other stuff, no.  So, I mean, I�m sorry.



LEO:  He continues on:  ...as evidenced by the widespread consumer use of digital media in Windows XP, in other words, no consumer problems.  For example, standard definition DVD playback has required selective use of Macrovision ACP on analog television outputs since it was introduced in the 1990s.  DVD playback on and in Windows has always supported this.  I guess he�s saying earlier generation forms of copy protection, like Macrovision.  He also goes on to say:  The ability to restrict audio outputs, for example S/PDIF for certain types of content, has been available since Windows Millennium Edition and has been available in all subsequent versions of Windows.  Oh, that�s interesting.  I didn�t know�that.



STEVE:  Yeah, I didn�t know that.



LEO:  The certified output protection protocol, COPP, was released over two years ago for Windows XP and provides applications with the ability to detect output types and enable certain protections on video outputs like HDCP, CGMSA, and Macrovision ACP.  So he�s pointing out, look, there�s been copy protection technologies in Windows all�along.



STEVE:  And they haven�t been a big problem for consumers.



LEO:  Nobody�s blown their stack saying my S/PDIF won�t work because � although Macrovision has caused problems all along.  But...



STEVE:  Oh, and it always will.  I mean, it�s just a yucky analog technology that messes up what should be a good video�signal.



LEO:  You can�t really say people aren�t upset about Macrovision.  He goes on � I�m again quoting, just so this is clear this isn�t me talking, this is Dave�s response.  Dave Marsh is the lead program manager for Windows video handling, and this is his blog response to Peter Gutmann�s article.  He goes on to say:  It�s important to emphasize that, while Windows Vista has the necessary infrastructure to support commercial content scenarios, this infrastructure is designed to minimize impact on other types of content and other activities on the same PC.  That was one of Peter�s big contentions is that the whole PC suffers for this.  For�example...



STEVE:  I have to say, Leo, that anecdotally we are � we don�t really know why yet, but people are reporting Vista is not as good a media platform as XP.  I�ve seen a lot of posts in my newsgroups and elsewhere where someone has upgraded themselves to Vista, got it all running, done some stuff, just playing non-protected content on Vista, and the picture stutters, it�s jerky, it�s not looking nearly as good as XP was.  Then they�ll fall back to XP, and it�s working much more smoothly.  So, I mean, it may very well be that there is some impact to this, unfortunately, even when playing non-protected content.  And it�s going to be systemic throughout all of Windows Vista.



LEO:  I should, to be fair, point out it could just be suboptimal drivers.  Now, Vista is just now out.  But Microsoft�s been optimizing drivers the entire time since December or November when Vista RTM came out.  So it could very � there are lots of reasons for it.  I think it�s early to say what the case is, whether it�s a problem or not.  He gives an example:  If a user were viewing medical imagery concurrently with playback of video which required image constraint, only the commercial video would be constrained, not the medical image or other things on the user�s desktop.  Similarly, if someone was listening to the commercial audio content while viewing medical imagery, none of the video protection mechanisms would be activated at all, and the displayed images would again be unaffected.



STEVE:  And of course that was one example that Peter gave of somebody listening to protected audio, some medical image processing guy who was � and Peter was concerned that the fact that there was � he said that the system was all or nothing, was his reading.  And I�m sure Peter believed that that was the case.  So I think this is a case of a clear mistake in the way the system works, understanding the documents.  I have to say, too, that from what I saw, what Peter stated was entirely believable and reasonable.  So David is putting to rest that concern that, if any protected content is anywhere in the system, then the whole system locks itself into paranoia mode and makes the screens blurry and so forth.  Clearly that�s not the case.



LEO:  Well, as anybody who has ever read specs and designed software will absolutely agree with, the software doesn�t always reflect what the specs say.  It may have been the intent; it may have not been the intent.  But it�s perfectly possible that the documents read one way and the software does something else.



STEVE:  That�s a very good point.



LEO:  Contrary to claims made in the paper, the content protection mechanisms do not make Windows Vista PCs less reliable than they would be otherwise.  If anything, they have the opposite effect, for example, because they will lead to better driver quality control.



STEVE:  Certainly at best that�s an unsupportable statement.



LEO:  It�s a spin.  It�s a spin, let�s face it.



STEVE:  Yeah, I mean, that one�s really hard to get behind.  Certainly we�re talking about much more complexity.  It is the case, though, that certain classes of mistakes, that is, the sorts of mistakes that would lead to a driver leaking content, that�s something that any driver author will have a real concern not to allow to happen.  So, I mean, basically Microsoft through this is raising the stakes on errors by forcing driver makers to make sure that they just � essentially creating a much greater penalty if there is a problem.  So you could say, well, that�s going to lead to better drivers.  It�s like, well, let�s let history determine whether that�s the case.



LEO:  It could also lead to more crashes.  We just don�t know yet.  It�s like, you know, we�ve raised our standards.  It�s not exactly what they were doing, they�re saying we�re making it much less tolerant of faults.



STEVE:  Yeah, well, now, I was just going to say, we have these tilt bits all over the place.  And it�s like, well, let�s hope those don�t go off.



LEO:  Going on to quote Dave:  The paper implies that Microsoft decides which protection should be active at any given time.  This is not the case.  The content protection infrastructure in Windows Vista provides a range of a la carte options.  It allows applications playing back protected content to properly enable the protections required by the policies established for such content by the content owner�s service provider.  In this way the PC functions the same as any other consumer electronics device.  With that introduction, here are the top 20 questions and answers.  So we�ll go on to those.



STEVE:  Yeah.  I think that�s fair.  Although I have to say I did not read what Dave is suggesting in Peter�s paper.  He says the paper implies that Microsoft decides which protection should be active.  I didn�t get that impression.  So he�s disabusing us of something that I don�t think Peter said.  I think it�s very clear that Microsoft facilitates whatever protection the content provider wishes to have.



LEO:  This is what an operating system provider does.  They provide a platform with the technologies that are required.  And then the playback device decides which ones it wants to take advantage of.



STEVE:  Exactly.



LEO:  All right, now.  This is probably where you wanted me to start reading.  But anyway...



STEVE:  No, no.  I�m glad we did that.  I�m glad we have a foundation there.  And so we have 20 questions and answers.  And I have to just say that I�ve read all this already.  And I think we�ll see that some of these questions are questions Dave wanted to ask so that he could answer them.  They�re not necessarily things that a fair reader of Peter�s paper would have come away believing or being concerned about.



LEO:  All right.  Question 1.  So again, Dave Marsh, this is him posing a question:  Do these content protection requirements apply equally to the consumer electronics industry supply player devices, such as an HD-DVD or Blu-Ray player?  The answer is:  Generally the requirements are equivalent for all devices.  For example, an HD-DVD or Bluray disk always requires HDCP protection for the DVI HDMI outputs, regardless of the type of device playing the disk.  There are some cases, such as DVD video, where PCs have slightly different protection requirements than CE devices.  But these differences are mainly historical and as�dictated by the licenses associated with the systems providing access to the content.  For example, CSS for DVD.��So he�s saying basically yes, they have the same�requirements.



STEVE:  Yes, and I think that�s completely fair.  Essentially, Windows Vista becomes an HD or Blu-ray hi-def content player, just like you could buy off the shelf.



LEO:  The subtext is, hey, we�re just like everybody else.  We�re just doing what we have to.



STEVE:  Exactly.



LEO:  Question 2:  When are Windows Vista content protection features actually used?  He answers:  Windows Vista content protection mechanisms are only used when required by the policy associated with the content being played.  For Windows Vista experiences, if the content does not require a�particular protection, that protection mechanism is not�used.



STEVE:  And I think that�s, again, very fair and a balanced appraisal.  It�s not like Microsoft is adding DRM where it didn�t exist before.  And they�re not basically constraining the channel that the content provider has not required be constrained.  And part of the power and flexibility of AACS is that there is such a strong capability for usage policy to be bound in with the content.  And so again, Vista is just being a fair playback device.  And if it weren�t, it wouldn�t be allowed to be a playback device at all.



LEO:  Right.  Makes sense.  Is this question three?  Yeah, Question 3:  Will the playback be reduced on some video output types?  Image-quality constraints, David says, are only active when required by the policy associated with the content being played, and then only apply to that specific content, not to any other content on the user�s desktop.  This is that medical imaging example.



STEVE:  Exactly.



LEO:  As a practical matter, image constraint will typically result in content being played at no worse than standard definition television resolution.  In the case of HD optical�media formats, HD-DVD and Blu-ray, the constraint requirements is 520K pixels per frame, i.e., roughly 960x540.  That�s still higher than the native resolution of content distributed in the DVD video format.  We feel this still yields a great user experience, even when using a high-definition screen.



STEVE:  I think, again, that�s an absolute fair and accurate rendition of what�s really going on.  You can imagine that a laptop user who had a HD-DVD drive in his laptop, you know, buys it because he wants to be able to watch movies on his laptop.  And so he would have to have Vista.  He would not be able to do this with XP because XP doesn�t provide this.  So Vista integrated in with a laptop that�s got an integrated LCD screen and drive, it�s simply going to be an HD or Blu-ray DVD player.  It�s going to work.



LEO:  Actually a little better because it�s 520P instead of�480P.



STEVE:  Exactly.  I mean, not substantially, but a little bit, yeah.  Well, and actually...



LEO:  But that�s not what Peter asserted.  Peter was saying it would really go down in quality below 480.



STEVE:  No, actually I think Peter was talking about the 520K pixel a frame.  He just didn�t like the idea that there was this artificial constraint imposed by Windows.  And again, Dave is saying, wait a minute, this is not our imposition.  And it�s true that, again, the content provider says, if you�re not going to provide digital encryption all the way to the screen, where it finally jumps off the screen and travels by light into the user�s eyeballs, then you must provide the following constriction.  So again, Windows is simply enforcing the policy that the content provider has bound in with the content.  And so, yes, the content provider could say we want it to look really smeary, 200K pixels or 100K pixels.  Again, Microsoft has no control over that.  So David is assuming that the content provider is not going to ask for something blurrier than 520K pixels per�frame.



LEO:  Ah, so they could.



STEVE:  Yes.  We don�t really know that.



LEO:  Okay.  Will this affect things like medical imagery applications?  David answers:  Image constraints only apply to protected content being played and not to the desktop as a whole.  Therefore, the resolution of other non-protected media, such as medical images, is not affected.



STEVE:  Right.



LEO:  Good.  That�s great.



STEVE:  So clearly, if you�re running your medical imaging utility in a window, and you also have hi-def playing in another window on your screen, the hi-def video constraint may cause that to be blurred, but not a separate window running on the same system which is displaying completely crisp, non-resolution-lowered images.  So it�s certainly possible for Windows to do that, and David is asserting that�s the way it works.  I would be surprised if it did�not.



LEO:  He�s actually so adamant in this assertion, I think we can trust that that�s the case.  Otherwise that would cast this entire document into doubt.



STEVE:  And there�s no reason for it not to be.  I�ve looked at the architecture...



LEO:  As long as they can do it.  That�s the key; right?



STEVE:  Yes.  I�ve looked at the architecture, and it�s clear from their diagrams that they have the ability to just protect a certain path of video through the system, separate from all others.



LEO:  Do things such as HFS, Hardware Functionality Scan, affect the ability of the open source community to write a driver?  This is another one of Peter�s very strong criticisms.  David says:  No.  HFS uses additional chip characteristics other than those needed to write a driver.  HFS requirements should not prevent the disclosure of all the information needed to write drivers.  Just to recap, Peter said that there has to be some secret sauce in every driver that cannot be opened publicly.  That�s kind of a requirement of the content protection.  So Dave said, no, but you still can expose everything you need to know.



STEVE:  Yes, exactly.  So he�s coming at it in the classic sort of black hat/white hat fashion, by which I mean you�re able to look at one thing and spin it in two different directions, depending upon what�s best for you.  So Peter was saying that you cannot completely document the hardware or it would be possible for someone to write a software emulator for that hardware and fake out the system to believe that what they had written in software was actually protected hardware, where it wouldn�t be.  And Dave is coming at it from the other side, saying, well, okay, but it is necessary not to disclose everything in order to allow the hardware functionality scan to verify the hardware.  But he�s saying even though it�s necessary not to disclose everything, it�s not necessary that everything be disclosed in order to write fully functional drivers.  And so I agree with him.



LEO:  You have to rely on � as always, if you�re going to write an open source driver, you just have to hope that the company that made the hardware is exposing everything you need to know.  And that�s always been a crapshoot.



STEVE:  Right.



LEO:  Will the Vista content protection � so I guess if a hardware company really wants an open source driver, in other words, they can expose enough information to make that�possible.



STEVE:  Exactly.  And they can still keep some things private that will not be part of that open source driver.  It will not the hurt the driver�s ability to function while still giving them the leverage they need of making sure that their driver cannot be emulated by software.



LEO:  He goes on:  Will the Vista content protection board robustness recommendations...



STEVE:  Meaning the AACS, for example.



LEO:  Okay.  Will the Vista content protection board robustness recommendations increase the cost of graphics cards and reduce the number of build options?  He responds:  Everything was moving to be integrated on the one chip anyway, and this is independent of content protection recommendations.  Given that cost, particularly chip cost, is most heavily influenced by volume, it is actually better to avoid making things optional through the use of external chips.  It is a happy side effect that this technology trend also reduces the number of vulnerable tracks on the board.



STEVE:  Okay, that�s another spin.



LEO:  That�s a big fat spin.



STEVE:  That�s a big spin.  He was certainly feeling defensive, that is, Dave Marsh was feeling defensive against the allegation that hardware needed to be changed; that, for example, you couldn�t have a hardware board that didn�t have some components on it which was leaving traces unused where you might have content leaking out of those traces.  Well, my feeling is this is not something that David ought to try defending.  I mean, he asked the question, so I guess he wanted to answer it.  Unfortunately, his answer is not very convincing in this case.  I mean, it is the case that in order to have a system � and this was our original premise, Leo, when you and I first talked about this, is essentially adding AACS and this level of DRM is a heavy impact to Windows.  But it�s not just software, it�s hardware, because of course a deliverable solution is both hardware and software.  So if you�re going to protect the software, it does no good not to protect the hardware.  So Microsoft that only makes the software is trying to defend the need to also protect the hardware.  I don�t think this is Microsoft�s problem.  So again, this is why I don�t think David needed to address this.  I agree, however, that it would be much more convenient for board makers, just as Peter said, to have the option of populating the boards just as they do now with those components they choose to.  I don�t know that since everything is moving toward one chip argument really holds at all.  So I think we need to sort of discount that�one.



LEO:  Yeah.  It�s like Martha Stewart saying �It�s a good thing.�  Will Windows Vista content protection features increase CPU resource consumption?  Another contention of Peter Gutmann.  As he said, it�s going to slow everything down because the system has to 30 times a second be checking for piracy.



STEVE:  Oh, and not only that, Leo, but if you�re using an external video card, as power users want to, that cross-bus encryption, you�re needing to encrypt at high-bandwidth rates.  That�s a huge burden on the system.



LEO:  And he says yes.  David says output content protections are not new requirements for commercial � I�m sorry.  Read the wrong one.  He said yes.  Same answer.  Yes.  However, the use of additional CPU cycles is inevitable as the PC provides consumers with additional functionality.  Hey, it�s additional functionality.  You�re getting additional functionality.  Windows Vista�s content protection features were developed to carefully balance the need to provide robust protection from commercial content �  I don�t think he means �from� commercial content, I think he means �for� commercial content � while still enabling great new experiences such as HD-DVD or Blu-ray playback.  Of course, if I don�t have an HD-DVD player or a Blu-ray player, is it still going to eat those CPU cycles, even though I can�t?



STEVE:  No.  And so here again, okay.  First of all, this was a total spin answer.  So, you know, sorry about that.



LEO:  Well, at least he said yes.  At least he didn�t deny it�s going to use more CPU resources.



STEVE:  Good point.  And there�s no way Microsoft had a choice.  That is, they had to run encryption at high-bandwidth rate across the bus in order not to allow a bus probe to simply grab the hi-def video.  So they�re having to encrypt from the driver to the display card hardware across the bus, which requires very high speed.  In fact, so high speed that AES, the encryption that�s used throughout this, is unable to keep up.  Intel had to come up with an abbreviated cascading AES to be fast enough for software to be able to do this on the fly.  What I think we�re going to find is that a system which is playing hi-def content probably cannot really do anything else.  It�s going to pin the processor, well, I don�t see any way of not saying it�s just going to pin the processor.  And so that�s something very different about not playing hi-def content.  So it�s not always going to pin the processor.  It�s only when it�s playing hi-def content that requires that the hardware bus be encrypted.  That�s such a burden on the system, that�s probably all you�re going to be able to do.  On the other hand, that�s probably all anybody wants to do.  If you�re playing hi-def content, you�re in movie-watching mode.  You�re probably not trying to write letters home at the same�time.



LEO:  Well, you�d better not be.



STEVE:  And you may not be able to.  Or maybe you could do�email.



LEO:  Although, see, I think part of the contention was it also uses up CPU resources even when you�re not watching content.  Right?



STEVE:  No.  Well, it really seems like � and that�s a little bit in the spec gray area � as though only the things that are required are being brought to bear by Microsoft.  And certainly when you�re not playing protected content you�re not having your bus encrypted because there�s just no one asking for it.  So it would be nuts for Microsoft to leave this really high-overhead stuff on all the time.  Therefore I�m sure they�re not.



LEO:  It�s smart enough to say, oh, well, you�re not playing a DVD, so we won�t use up your CPU.



STEVE:  Right.



LEO:  Okay.  Let�s see.  Aren�t there already output content protection features in Windows XP?  I don�t think anybody�s asking this question, but...



STEVE:  There�s a perfect example of a question that nobody�asks.



LEO:  He chooses to answer anyway.  But wait a minute, aren�t there already these things in XP?  Yes, he says.  Well, really.  Output content protections are not new requirements for commercial content.  The CSS content protection system for DVD video disks requires output protections such as Macrovision ACP and limiting the resolution on component video outputs on standard definition.  Windows XP has supported these requirements for�some time.



STEVE:  Which is really interesting because I have never ever heard of any resolution limitation, I mean, I�ve never seen an API or a spec or anything that indicated there was resolution constraint happening on component video outputs.  That�s news to me.  I�m going to take Dave at his word because he�s the expert on this.  But again, nobody was really asking.



LEO:  And if you ever ask, we�ve got the answer.  Is content protection something that is tied to high-definition video?  He answers:  While HD content has some unique content protection requirements, many of the requirements apply to commercial content generally, independent of resolution.



STEVE:  Okay.



LEO:  Who asked this question?  And what does it have to do with the subject at hand?



STEVE:  Exactly, good question.



LEO:  What�s the point?  There must be a reason he brought this up.



STEVE:  I guess, okay, is content protection something that is tied to high-definition video, the idea being, is this all just about high-definition video?  And he�s saying, no no no, there�s streaming video, there�s audio can ask for it, you know, blah blah blah.  We�re just a big, happy DRM platform.  We�ll provide it for anybody who wants it.



LEO:  Anybody who wants it.  In fact, he goes on to ask:  What about S/PDIF audio connections?  And answers his own question:  Windows Vista does not require S/PDIF to be turned off.  But Windows Vista continues to support the ability to turn it off for certain content, a capability that has been present in Windows for many years.  Additionally, in order to support the requirements of some types of content, Windows Vista supports the ability to constrain the quality of the audio component of that content.  In other words, like image constraint.



STEVE:  Exactly.  You�re able to make it muddy.



LEO:  Similar to image constraint for video, this quality constraint only applies to the audio from content whose policy requires the constraint, not to any other audio being played concurrently on the system.  As a practical matter, these audio restrictions are not widely used today.



STEVE:  So I guess it sounds like the audio could be down-sampled and its resolution limited in the same way that they�re able to do with video if that�s what the content provider says they want.



LEO:  And he does point out, and I think this is important, nobody�s doing this.  In fact, nobody�s doing it in video yet, either, as far as I can tell.  So this is all kind of could be, might be.  Will component � that�s the YPBPR, what is that, chromium red, I can never remember, the blue, anyway, you know which ones we�re talking about � the component video outputs be disabled by Windows Vista under content protection?  Similar to S/PDIF, Windows Vista does not require component video outputs to be disabled, but rather enables the enforcement of the usage policy set by content owners or service providers, including, with respect to output restrictions, an image constraint.  So...



STEVE:  So he�s saying, it�s not our fault that we allow S/PDIF to be disabled.



LEO:  Or component.



STEVE:  Yes, component or S/PDFI, right.  Where, you know, it�s not our fault that we allow it to be turned off.  We have to make it disable-able in order to satisfy the demands of the content providers.  So again, they�re just sort of being the middleman between the content providers and the end user.  Which, you know, is fair.



LEO:  Sure it�s fair.



STEVE:  Yeah.  If you want that sort of thing.



LEO:  If you want that sort of thing.  Will echo � actually that�s really probably for things like set-top boxes.  Cable companies might turn off component and force you to use HDMI if you�re watching HD content, things like that.



STEVE:  Yeah, exactly.



LEO:  Will echo � so I guess Windows Media Center would have to do the same.  Will echo cancellation work less well for premium content?  We believe � I don�t even know what echo cancellation is.  We�ll find out.  He responds:  We believe that Windows Vista provides applications with access to sufficient information to successfully build high-quality echo cancellation functionality.  What�s he talking about?



STEVE:  The reason this is an issue is that the way echo cancellation functions is by feeding back into the echo cancellation circuit some of the output.  You feed it back in, sort of like 180 degrees out of phase, in order to cancel it sending itself back up the line.  Peter made the point that, if audio was being constrained, then the echo cancellation system would inherently be less effective because it wouldn�t be able to perfectly match essentially the echo signal which it would otherwise be.  And so David is saying, oh, don�t worry about it, it still works.  It�s like, okay, we�ll see.



LEO:  I didn�t know that.



STEVE:  And also it�s worth noting that, if what Microsoft is saying, and that there would be audio constraint for protected content, one wonders why you would ever have echo cancellation happening to protected content.  You would typically have it for VoIP, for example.  When two people are talking you want echo cancellation so that you�re not hearing yourself coming back the other end.  But a normal dialogue between people over a VoIP call, that�s not going to be protected content.  Therefore there would be no artificial constriction to the audio.  So I do think that Peter was raising a theoretical point that would in fact never affect anybody in the real world.



LEO:  That makes sense.  Will it mean there will � this is actually a direct response to a statement in Peter�s article.  Will it mean there will no longer be unified graphics drivers?  Peter said that�s it for unified graphics drivers.  Here�s David�s response:  The Windows Vista content protection requirements for graphics drivers will not lead to movement away from unified drivers.  In fact, all graphics drivers shipped with Windows Vista are unified drivers.  Well, there you go.



STEVE:  I mean, it�s interesting, though, because remember that Peter�s point was, if you had a single driver which covered a broad range of cards with different capabilities, if a HD card were found to need its driver revoked, since you had a unified driver, then you would be revoking a huge set of cards.  That is, you�d be revoking all drivers because you had a single unified driver that was covering your whole line of cards.  So he was saying this would force manufacturers to do per-card drivers rather than unified drivers.  So I don�t think Dave has really addressed that issue at all.  He says, well, Windows Vista is using unified drivers, and they�re just fine.  It�s like, yeah, well, let�s hope that none of them are ever revoked.  Because then whole families of cards will die en masse.



LEO:  So he�s not saying there�s no technical reason you can�t do a unified graphics driver.  It�s just it might be a good idea.  Apparently Microsoft doesn�t think that�s ever going to happen, this mass revocation.



STEVE:  It really does sound like that�s the case.  Or, and I think we�ll see that if they � they�re hoping and assuming they would always be able to replace a driver that is soon to be revoked with a new driver that would have then different keys and would fix the problem that went wrong with the bad driver.  So essentially the replacement would arrive before the revocation of the prior version.



LEO:  Okay, right.  So in other words � yeah, okay, right.  You get a new version before they make your old one not�work.



STEVE:  Yeah.



LEO:  Will Windows Vista audio content protection mean that HDMI outputs can�t be shown as S/PDIF outputs?  Will Windows Vista audio content protection mean that HDMI outputs � HDMI carries audio � can�t be shown as S/PDIF outputs?



STEVE:  Apparently in the UI it actually shows the HDMI�video...



LEO:  Looks like S/PDIF.



STEVE:  Exactly.



LEO:  Okay.  Dave says:  It�s better if they show as different codec types as it allows the difference to be reflected in the UI, thus providing the user help with their configuration and creating a better user experience.



STEVE:  The user...



LEO:  Yeah, wants to know the difference between HDMI and S/PDIF as they are different physical connectors.



STEVE:  Okay.  I don�t know why we care about this one.



LEO:  I don�t even know.  Maybe he�s � I don�t know.  Okay.  Next question.  What is revocation and where is it used?  Now, here�s a good question.  Dave responds:  Renewal and revocation mechanisms are an important part of providing robust protection for commercial audiovisual content.  Sounds like he�s quoting the MPAA.  In the rare event that a revocation is required, Microsoft will work with the affected IHV � that�s the hardware guy, the guy who built the card that�s going to be revoked...



STEVE:  Independent Hardware Vendor; right.



LEO:  ...to ensure that a new driver is made available, ideally in advance of the actual revocation.  That�s what you were saying.



STEVE:  Exactly.



LEO:  Revocation only impacts a graphics driver�s ability to�receive certain commercial audiovisual content.  Otherwise the revoked driver will continue to function normally.  So your card still works.  You just won�t be able to watch HDDVDs.



STEVE:  Now, that�s huge big news because that�s a really important point that I want to make sure everyone got is that Peter�s paper � and we all just kind of went along with it without thinking about it � presumed or stated that the driver would be revoked, and all of those drivers would no longer function.  And David is saying, whoa, no, all we�re doing is we�re revoking the hi-def capability of the driver.  You can still watch non-hi-def movies, even, and your desktop will work, and everything else will work.  I mean, it�s like, when you hear it, it�s like, oh, duh, of course that�s the way it would and should work.  So it�s not like no one�s computers are going to work anymore.  It�s just that, if there isn�t a replacement already on your system, and you are hit with revocation, you lose the ability to play hi-def content.  You don�t lose anything else about your driver�s ability to function.  Which I think is, again, a really important point to make.



LEO:  And of course we�ve said a couple of times it doesn�t seem likely that revocation will ever happen.  However, you can�t assume it�s not going to.  It�s built in, so you have to assume at some point they�re going to use it.



STEVE:  It�s in there.  It�s in there.



LEO:  There�s also the issue of what if � and this Peter raised, and I don�t see it, maybe we�ll get to it.  It sounds like you have to continue to pay your dues to this organization, whatever organization�s doing this, to continue to be certified.  In other words, you could be revoked, not because you cracked content protection, but just because you didn�t pay your dues.  Which means, if you went out of business...



STEVE:  That�s bad.



LEO:  ...you could be revoked.  But the good news is revocation, at least according to Dave, doesn�t mean the thing stops working, it just means you can�t play high-end�content.



STEVE:  And I think it�s another perfect example of a nightmare scenario that�s very unlikely to occur.  Certainly the MPAA or the content provider, the AACS organization, they could revoke anyone�s licenses they wanted to at any time.  I would be surprised if somebody choosing not to renew their license would automatically force the revocation of their earlier license.  I mean, that�s, okay, they have the capability to do so.  I think it�s a real stretch to presume that they therefore would.  I think somebody could just say, we�re going out of business, we�ve got 100,000 graphics cards out there.  As long as those aren�t breached, then I would imagine they would continue to function.  The danger would be if revocation was then necessary, the manufacturer was out of business, Microsoft did not have the source code in order to fix the driver themselves, and then users of those cards of the company that went out of business whose drivers were revoked for playing hi-def content, they�d be in bad shape.



LEO:  It may not be so academic.  I think because of muslix64�s work, it may well be that some of these keys get leaked out and revocation � we�ll see.  It�s going to be just a matter of time before keys for some of these cards are leaked out.  Explain this to me, but this is how I understand it, that each video card or playback mechanism has its unique key.  And in order to use the AACS unprotect software that muslix has written, you need the key for the card you have.



STEVE:  A simplified way of describing it is as follows:  Imagine that there�s a universe of keys that will ever be used.  And so the title�s decryption key is encrypted with every different key possible, and it�s put on the disk.  So what happens is your player decrypts its specific matching key, which is on the disk.  And that allows it to determine the decryption key for the title.  But if the disk no longer contains an encrypted version of the key for the player�s key, then there�s no way it can decrypt the title key.  That really didn�t simplify anything, did it.



LEO:  Well, okay, so...



STEVE:  Now everyone�s confused.



LEO:  No, that made sense.  So let�s talk practically.  So in order to use muslix64�s unencryption technique you have to get the key for your playback device.  Let�s say somebody online starts distributing these keys.  Now, nobody has yet, at least to my knowledge.  I�m sure in some private areas they are.  But let�s say these keys start getting distributed.  Now, at that point, wouldn�t these keys get�revoked?



STEVE:  Yes.  Well, those particular disks are now forever cracked.  That is, you can certainly imagine that there will be a cracking site that will start listing the decryption keys for all the disks that have been cracked.



LEO:  So they�re giving out keys for the disk, though, not for the hardware.



STEVE:  Yes, and what�s called the �title.�  It�s called a �title key.�



LEO:  But it doesn�t have to match your hardware card.



STEVE:  Well, exactly.  Then the title key would allow you to decrypt the digital content and then play it anywhere you�want.



LEO:  On any device.  Okay, so this is...



STEVE:  And the title keys are already leaking.



LEO:  Yes.  I shouldn�t have brought this up, then.  This doesn�t have anything to do with the hardware revocation.



STEVE:  Right.



LEO:  Well, okay.  Going back to revocation, he says:  Does this complicate the process of writing graphics drivers?  In other words, kind of dividing the premium content playback into a separate section that can be revoked from the regular content playback, which cannot be revoked.  Dave responds:  Adding new functionality usually introduces new complexity.  In this case, additional complexity is added to the graphics driver, but that complexity comes with the direct consumer benefit of new scenarios such as HD-DVD or Blu-ray playback.  Basically the answer is yes.



STEVE:  Yes.  It�s going to be more complex, but it had to�be.



LEO:  It had to be.  You�re playing back new content.  But it does mean that the hardware manufacturers and the driver authors are going to have to be aware of this, cognizant of this, to keep their cards working after revocation, should revocation happen.



STEVE:  Yes, good point.



LEO:  Question:  Will the tilt bit mechanism cause problems even when the driver is not under attack from a hacker, for instance there are voltage spikes?  And this is something we really talked about with Peter.  Voltage fluctuations are a constant in the PC hardware world.  Wouldn�t that set a tilt bit?  Dave answers:  It is pure speculation to say that things like voltage fluctuations might cause a driver to think it�s under attack from a hacker.  It is up to a graphics IHV � manufacturer � to determine what they regard as an attack.  Even if such an event did cause playback to stop, the user could just press Play again and carry on watching the movie after the drivers reinitialize, which takes about a second.  Now, remember that these tilt bits are set 30 times a second; right?



STEVE:  Yes, every 30 milliseconds there�s a scan done.



LEO:  Basically you could be pressing that spacebar a lot.  Okay.  Again, it is important to note that this could only occur in the case of watching the highest grade premium content such as HD-DVD or Blu-ray.  In practice I doubt it would ever happen.  Well, we don�t know.



STEVE:  And we�re not going to know until � it would be annoying if it took you three hours to get through a twohour movie.



LEO:  You�d have to keep pressing the spacebar.



STEVE:  That would be a problem.  Time to get a new power�supply.



LEO:  It seems like a card manufacturer would try to avoid that particular scenario.



STEVE:  Especially now that it�s had so much attention.  They�re not going to have any tilt bits on their power�lines.



LEO:  Right.  But there may be other issues.  All right.  I�d love to hear what Peter said about this one because I got the strong impression from Peter that that�s the kind of thing cards have to look for.  That kind of voltage modulation is one way hackers might attack these disks.



STEVE:  Well, I think, frankly, I think what Peter was offended by from a purist standpoint, the idea that Windows requires maximum robustness in order to survive out in the real world anyway, that you�re going to have voltage fluctuations, you�re plugging USB and Firewire devices in, you know, it�s like there�s just a lot going on.  And so Windows needs every benefit of the doubt in order to be as reliable as it is.  And so what this does is this deliberately removes every benefit of the doubt so that if there is any doubt, a tilt bit gets set, and Windows resets its whole graphics display system.  So again, we won�t really know until this has been out for a while.  And I think Peter was mostly concerned about the idea that, rather than � that we�re switching from a benefit of a doubt to allowing no doubt whatsoever.



LEO:  Right.  You know who I�d really love to hear from and who could best answer these last few questions is a video card manufacturer.  I mean, they�re the ones who have to deal with this in the real world.



STEVE:  And in fact Peter quotes ATI throughout his presentation, talking about all of the cost which gets passed on to the consumer.  That was a big issue in his original white paper was that, yes, this is all more complex, no more unified drivers, no more unified hardware.  It�s going to raise the cost to the consumer, especially having to do massive sorts of decryption in the hardware of the card itself now, if it�s going to be a plug-in card on a�bus.



LEO:  Another question.  Does Windows Vista�s use of OMACauthenticated communication impact graphics driver performance?  Dave answers:  The authenticated communication mechanisms used for protected video path in Windows Vista are only actively used while commercial content is playing.  That means that, while there�s a performance impact, it�s limited to the scenarios where it�s required to provide robust protection for commercial content.  Just as you said, it ain�t gonna slow you down unless you�re watching a hi-def movie, and in that case, what the heck are you doing doing anything else?



STEVE:  And given what we know now, it�s probably going to slow you down a lot.  But again, it�s going to suck up...



LEO:  It�s busy.



STEVE:  It�s very busy.  It�s very busy.



LEO:  I�m working here.  Do content protection requirements mean that graphics chips have to provide hardware acceleration for video decode?  Dave says:  No.  The Windows Vista content protection requirements do not require that graphics hardware include hardware acceleration for decode for many years.  But such support is highly recommended to improve the user experience for HD content.



STEVE:  Again, this is one where it�s not � Microsoft�s trying to defend something which is really not theirs to defend.  The answer is certainly yes.  The more power your graphics card has, the less power you need from the rest of the system in order to do your decoding.  So but again it�s hi-def itself which is going to be a substantially greater burden on the system than playing a standard YouTube video in a small window, which is just not going to take much of your system�s power.  So again, it�s Microsoft sort of saying, defending something that�s really not their problem, but which is just a consequence of a PC being turned into a hi-def media platform.



LEO:  Right.  Again, I don�t know if anybody�s been asking that question, but now we know the answer.



STEVE:  I don�t think so.



LEO:  Will the video and audio content protection mechanisms affect gaming on the PC?  This might be the question I hear most often asked.  Dave says:  The Windows Vista content protection features were designed for commercial audiovisual content and are typically not used in game applications.  A game author would have to specifically request these features for them to impact game performance.  In other words, it�s turned off when you�re gaming.



STEVE:  Yes.



LEO:  So you don�t need it.



STEVE:  Well, it�s turned off anytime and always when it�s not specifically needed for creating protection from the media to your eyeballs.  And so we can assume that this won�t affect gaming.  What we don�t know, and this may be patches and service packs away, is whether Vista is going to be a smooth and powerful gaming platform.  Again, there are anecdotal reports saying that Vista is not nearly as good at�this today as XP has been.  But again, it�s not even released yet.



LEO:  We don�t know.  Actually, as we do this podcast, it has not been released.  By the time you hear this it will have been out for a couple of days.  It�s going to be a month or two before really we know.  And some of this might have more to do with DirectX 9 and 10 than any � this is a whole new platform.  DirectX 10 changes everything.  So it�s hard to know what to blame if things are slower or not as�reliable.



STEVE:  Well, I�m glad we did this, Leo.  I�m glad we ran through these questions because there were some points that David brought up that I think did clarify some things that were big concerns from what Peter brought up.  And it does sound like Microsoft is feeling painted into a corner by this.  And I think it�s unfair because they had the choice of allowing Vista to be a DRM content delivery platform or not.  On the other hand, this does make me less excited about moving to it than I would have been otherwise, although I wasn�t moving to it anyway.



LEO:  Yeah.  He�s reassured us on a number of things, that copy protection won�t affect the whole system, just the hi-def content playback.  And I think that in many ways this is reassuring.  And frankly, you always have the feeling when we�re talking about this stuff that we might be kind of overreacting.  It�s just it�s hard to say what it�s going to mean until it actually comes out and people are using it.



STEVE:  Well, and if in fact he�s right about there being quality restriction and Macrovision protection and other things already in XP, it�s worth noting that XP doesn�t seem to be giving anyone a lot of trouble.  Certainly, though, it�s not the case that XP has anything like this massive redesign which has been perpetrated for the purpose of allowing AACS essentially policy to be pushed through all the way to the end user.



LEO:  Right, right.  We�ll just have to wait and see.  We�ll find out.  It�s certainly a worthwhile discussion.  It�s fascinating discussion, and you can imagine over the last two or three years that there�s been a lot of talk back and forth between Microsoft and Hollywood and vendors, these IHVs.  This is not an easy thing to implement.



Steve, it�s not an easy thing to explain, you do a great job.  I thank you so much.  We thank our sponsors, the Astaro Security Gateway folks, for providing us with support to make the wherewithal to make this podcast a reality.  We couldn�t do it without them.  If you are looking for superior protection from spam, from viruses, from hackers, complete VPN capabilities, intrusion protection, content filtering, an industrial-strength firewall, and now new encryption capabilities as well, all in a single, easy-to-use, high-performance appliance, you need the Astaro Security Gateway.  I�ve got a 120 right here, and I just love it.  It�s great for small or medium business.  Call Astaro for a free trial in your business of the Astaro Security Gateway appliance.  It�s Astaro.com, or call 877-4AS-TARO.  And if you�re noncommercial, if you�re non-business, you can download this software.  It�s open source.  Use it.  You can even � I think it�s something like 79 euros a year � subscribe to the other features and get all the benefits.  It�s just a remarkable product.  Astaro.com.  Thanks so much for supporting Security Now!.



You could find more about this, including a transcript, both of Dave�s questions and answers and of Steve�s responses, on Steve�s website, GRC.com.  Elaine does transcripts for us.  We have 16KB versions for those of you who don�t want to download the big file, and comments, and that�s where you can ask questions of Steve for our Q&A segments.  And of course where you can find ShieldsUP, SecurAble, Shoot The Messenger, DCOMbobulator, and all of his great security programs, and the best disk recovery and maintenance utility ever written, ever will be written, SpinRite.  Read some great testimonials at SpinRite.info.  You have very � you are beloved by your customers.  That must be a nice feeling.



STEVE:  Well, I think what I like about it is that anyone who�s publishing software is saying, hey, you know, ours is the best this or the best that.  And there�s nothing better, I think, and more true and persuasive, than actual users reporting how they were able to use the product.  And so in our case, in SpinRite�s case, since it�s not just giving them larger fonts or changing the clarity of their resolution or whatever, it�s really coming to their rescue�and aid all the time, it makes for some really great�reading.



LEO:  It�s just great.  I am so glad that you wrote SpinRite.  I�ve used it, and it�s saved my bacon many times.  And I hope others will check it out at GRC.com.  We�re going to be back next week for yet another thrilling, gripping edition.  We�re actually going to talk about Data Execution Prevention next week.



STEVE:  Right.  I still believe, I continue to believe there is probably no single more important thing people could use than preventing buffer overflows.  We�re talking about all the time; the security industry is talking about it all the time.  This is the way remote hackers are able to send something into someone�s computer and essentially find a vulnerability to exploit and run their own code.  With Service Pack 2 of XP and ever since, and of course in Vista as well, there is this data execution prevention support which requires hardware to be able in order to essentially turn this on.  The reason I wrote SecurAble was to let people know if they had DEP support in their hardware, as anyone who�s purchased a processor for about the last two years will, although unfortunately Microsoft has it defaulted to �off� in most cases.



LEO:  Forward compatibility, of course.



STEVE:  Exactly, for backward compatibility.  So they don�t want to suddenly have Windows not working.  But unfortunately what it really means is that Windows is much less secure than it could be.  Next week we�re going to talk about that some more and go over it in a little more detail.



LEO:  Great, that should be fun.  We�ll see you next week.  I�m Leo Laporte for Steve Gibson.  Thanks for joining us.  We�ll be back next Thursday for another Security Now!.







Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/








GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#78

DATE:		February 8, 2007

TITLE:		DEP in Depth

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-078.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  With Steve�s new SecurAble freeware now launched, he and Leo discuss the full impact and importance of hardware DEP technology.  Steve explains why he believes that hardware DEP is the single most important Internet-related security technology developed so far.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  This is Security Now! with Steve Gibson, Episode 78 for February 8, 2007:  Hardware DEP.



Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



I may be afloat in a boat somewhere in the Caribbean, but�that�s no reason not to do a Security Now!.  Hello, Leo�Laporte here with Steve Gibson, the security guru.  Hello,�Steve.



STEVE GIBSON:  And so are we depending upon your new software gizmo to have automatically posted this?



LEO:  If you�re hearing it, it worked.



STEVE:  Ah, very cool.



LEO:  No, I can actually get online from the boat.  But it�s very expensive, and it�s something I kind of like to eschew because I�d really prefer not to be posting podcasts from the sea.



STEVE:  Oh, I love that you have the technology to post this on the fly.  That�s going to be very cool.



LEO:  Well, we�ll see.  We�ll hope it works.  The software I use is called Feeder from Reinvented Software.  And the new edition, which just came out, has scheduled posting.  So if the Mac didn�t crash while I was gone, and if the scheduler worked and everything, this should have gone up at noon Pacific time.  And if not, I will check it from the boat.  So the truth is you could be hearing this and it didn�t work, but I just made sure that it did.  As much as I say I don�t want to get online when I�m on a boat, I always end up doing it.



STEVE:  Yeah, you�re a geek.



LEO:  It�s slow.  It�s really � it�s satellite, it�s very slow, and it�s something like 40 cents a minute, I mean, it�s very expensive.



STEVE:  Oh, so lots of latency, too, for the packets.



LEO:  Huge, huge.  It�s not so bad for, like, email.  But, boy, web surfing is just painful.  Posting podcasts isn�t so bad because that�s pretty asynchronous.  You do that all locally, and then you press �Post,� and then it doesn�t take that long.  Hey, let�s talk about � we don�t have any errata or things to talk about from previous episodes because we recorded these en masse before I got on the boat.



STEVE:  Right.



LEO:  So we may do that next week, depending on how much we got wrong.  Which is none, I�m sure.  But we do have...



STEVE:  We do the best we can.



LEO:  We have a great topic today, something you�ve talked about before, data execution prevention.



STEVE:  At the risk of beating this thing into the ground, I want to make sure people who could be using it will be using it.  The greatest problem is that it isn�t enabled by default, not only maybe by people�s BIOSes, but certainly by Windows.  This was one of the substantially new and important security features which Microsoft introduced with Service Pack 2 of Windows XP.  So it�s been around now for years.  When they first introduced it there were only some AMD processors and the Intel Itanium processors which supported this in hardware.



The idea is, and we�ve talked about in detail buffer overflows or overruns, and we had a whole podcast about it.  So if listeners are feeling a little bit like they�re late to the party on this, by all means, I don�t know which episode number it was, but it was just titled �Buffer Overruns� [Episode 39].  We talked about in detail how it is that software which doesn�t protect the amount of data it allows in can accept by mistake too much data.  When that happens, the data flows off or falls off the end of the buffer.  And due to the architecture of PCs and computers in general, it�s possible that the computer inadvertently executes that data when it�s through doing what it was doing, essentially gathering this buffer all together.



LEO:  Whoops.  Not good.



STEVE:  Not what you wanted.  So the idea is that, because this has been such a huge problem for the industry, I mean, buffer overruns are just extremely difficult to catch a hundred percent of, and hackers love them because they�re able to essentially send something to a remote user and essentially inject their code as data into someone�s computer.  The computer then runs it, and you no longer have control of your machine.  I mean, it�s epidemic, it�s such a�problem.



Well, responding to that, the hardware makers have added a capability of flagging pages as non-executable.  Intel calls this, let me think, Execute Disable.  AMD calls it NX, for no execute.  Or maybe I got that backwards.  I can�t remember who is who.



LEO:  No, I think you�re right, yeah.



STEVE:  Unfortunately, AMD, who was early to the game with this, they also call it EVP, Enhanced Virus Protection, which is a really annoying sort of marketing term.  It doesn�t talk about what it actually does at all because it�s really not about viruses, it�s about preventing the execution of data.  And so the idea is that, when the operating system knows that the process supports this, and when the processor has it enabled, the operating system can load programs which are going to be executable, marking the memory the program occupies as being executable.  But when the program allocates memory for use for its communications buffers, or even the so-called �stack� which the program uses for holding data, the operating system will deliberately mark those as non-executable.



The beauty of that is that virtually solves the vulnerability of even, well, non-known exploits.  That is, if a hacker finds an exploit which no one knows about and tries to inject their own code into the user�s data buffer, the system itself will intercept this code before it has a chance of executing and raise a dialogue on the user�s screen, telling you that this program has violated data execution prevention and is being shut down.  So what I love about this is it is a preemptive protection against this kind of exploitation happening anywhere in the system.  And whereas antivirus has to be updated with AV patterns; and there�s always the cat-and-mouse game where the patterns are behind, and you�re making sure you�ve got the latest updates.  And the point is that antivirus is only able to protect against known specific problems.  This whole DEP, the hardware DEP support, actually sort of cures a systemic vulnerability that all systems and software running in the system has.  It�s fantastic.



Problem is, it�s not turned on by default because there are good programs which, because this has never been enforced in the past, good programs might cause false positives.  And there are some that do.  There was a version of my past favorite antispyware software, Ad-Aware, which was causing a problem.  And in fact, even in some cases, in some settings of hardware DEP operation, the current version of, I think it�s pronounced IrfanView...



LEO:  IrfanView, yeah.



STEVE:  IrfanView is a neat little and very popular little image viewing tool.  It�s currently, as I�m writing this, or as we�re talking about this, it�s at version 3.99, I believe.  And if I set DEP into always-on mode, IrfanView will not open.  The operating system shuts it down before it has a chance to execute.  So there�s something going on there which is causing a problem.



LEO:  Irfan is a long-time, old-school hacker.  And obviously he�s modifying his own stack.  He�s putting code in the stack or something.



STEVE:  And that�s a perfect segue into one of the things that people who start experimenting with hardware DEP support will find, is they may find that there are things that cause problems.  Now, Microsoft has four modes in which hardware DEP can function.  But before any of them have a chance of working, the BIOS has to not be turning it off when you boot.  Some people�s BIOSes will have some UI, some configuration pages that allow you to enable hardware DEP support if the BIOS sees that the chip offers it.



So one of the things I did with SecurAble, the reason I created SecurAble is it�s able to check to see whether it is available in your chip, and whether it has been disabled by something, probably your own BIOS, when you boot up.  It turns out that one of my tablet PCs, my favorite little TC�1100, my HP tablet, it has a Pentium M processor that does support hardware DEP, this data execution prevention.  But the BIOS is disabling it, and there�s no way for me to enable it.  Which is very annoying.  So that�s one of the reasons I�m doing a follow-on utility called DEPuty.  It will allow things like that to be fixed in what I hope are some clever fashions.



LEO:  I like that name.



STEVE:  DEPuty�s going to be free also.



LEO:  I like it.



STEVE:  So anyway, already in our newsgroups people who are running SecurAble, which is just GRC.com/securable, many people were surprised to find that their chips did support  hardware DEP.  As I mentioned, at the time this first came out in Service Pack 2, only a few AMD chips and Intel�s high-end Itanium processors supported this ability to force an exception being raised to the operating system if the processor tried to execute code in a page that was marked as not being code executable.  Now, and for the last two years, virtually all AMD chips and all of Intel�s chips, for example my older Pentium M that is now a few years old, do support hardware DEP natively.  So you have to have support by your processor.  SecurAble tells you whether or not you�do.



Then these people who were surprised, for example, in my newsgroup, they went into their BIOS and poked around, and most of them � in fact I don�t think I know of anyone except in my own case � they were able to find configuration settings that were defaulted to disabling this execution prevention.  So it was really frustrating and annoying, first of all, that for whatever reason � again I think in the name of compatibility, making sure that nothing wrong would happen, when this feature was added to processors the BIOS makers were concerned that, if they left it enabled, that it would cause problems.  So they were deliberately disabling it.  Most BIOSes, certainly any well-behaved BIOS is going to allow the user to turn that back on.



Microsoft recently got an agreement from all major hardware vendors not to disable hardware DEP on boot, but rather by default to enable it.  Because Microsoft has learned the lesson that defaults are generally what hold sway over PC users.  And they knew that, if people had hardware DEP disabled, they�d just never go about finding out that they could get this additional protection, which as I�m claiming and as I believe is a substantial win for PC users.  So now any machines coming out in the future, Microsoft has an agreement from all major makers, they�re going to leave hardware DEP enabled by the time Windows boots, to at least then give Windows the opportunity to do what it wants to with it.



So now that we�ve got hardware DEP present in the processor and enabled by default, or you can use SecurAble to see if you�ve got it and go digging around in your setup pages in your BIOS to enable it if it�s not, now we come to the operating system.  It needs to be enabled in order to have this working most usefully.  Hardware DEP has four different modes of operation:  always-off, always-on, or opt-in and opt-out.  What�s interesting, and I�m going to be doing some further research on this, I can�t find any documentation on Microsoft�s site anywhere, because we�re seeing a difference between always-on and opt-out.  That is, you would imagine that always-on mode would be the same as opting out if you weren�t having any opt-out programs.  It turns out it�s not the case.  For example, that IrfanView program, the IrfanView file viewer I was just talking about, it runs fine in opt-out mode, even if it has not been opted out.  But it won�t launch, Windows blocks it from launching, if I�m running in always-on mode.  So I don�t know why.  I�m going to have to � I�m going to be doing some further research.  So but that does make it clear that always-on is providing us with some sort of additional protection beyond using opt-out mode, even if nothing has been opted out of.



So Microsoft�s normal mode is opt-in.  What that means is that Microsoft � and this is what they say, we don�t even know the extent of it, is they say on their various pages describing this that some Windows binaries are being protected.  The presumption is, okay, not all of Microsoft�s own Windows binaries and programs, drivers and so forth are being protected, but some are.  So I guess that�s better than none, obviously.



LEO:  And why wouldn�t I trust their software?



STEVE:  Exactly.



LEO:  I mean, unless I guess a malicious program could pose as that program.



STEVE:  Oh, no.  No, no, that�s exactly it, Leo, is that certainly Microsoft has been the vector for many of these buffer overruns in the past because they had the bugs in their code that the hackers...



LEO:  Well, I would hope they wouldn�t exempt Internet Explorer.  That would be a mistake.



STEVE:  Well, and in fact it turns out that there are some toolbars for Windows Explorer that do have problems with DEP.  So essentially at this point we�re in the frontier mode.  What you really want to do, if you can, is run DEP in the so-called always-on mode, which is clearly the strongest of all.  It works for me, except IrfanView doesn�t.  Now, certainly Irfan, who is the author of IrfanView, he can fix it.  So what I�m hoping will happen is, as hardware DEP begins to gain momentum and becomes more important, I mean, no one�s been talking about this for years since Service Pack 2, partly because we haven�t had the hardware that supported it.  But even now it�s sort of like it�s not getting much attention.  That�s the reason I�m going to be spending some time creating freeware and, as I am, spending time here talking to you and our listeners, Leo, on Security Now! to raise the awareness of this really important and significant benefit.  Many of the security vulnerabilities that have occurred in the last year were already stopped cold by hardware DEP.  That is, had it been in place in the system and enabled properly, those vulnerabilities were never a danger to those users who had their systems set up that way.  This is just a very good thing to do.



LEO:  I have two important questions for you.  First of all, why would somebody code something � why would somebody need this ability to modify the stack or execute code from the stack?  And secondly, if you can walk us through the Windows XP, at least, method of turning hardware DEP on, I would really appreciate that.  But before I get those answers, if I might, I�d like to just mention Astaro Corporation.  Could I do that?  And then we�ll get your answers?



STEVE:  Of course, of course.



LEO:  This podcast is, of course, brought to you by Astaro.  And I do want to make sure that I don�t forget to mention Astaro.  They�ve been such a great support to the show from day one.  They�ve signed up for another year, throughout 2007.  And we can�t think of really a better partner for Security Now! since Astaro is, in my mind, one of the premier security providers in the world.  They do the Astaro Security Gateway.  That�s a small security appliance that just packs all the power you�d ever want.  Superior protection from spam, from viruses, from hackers, always updated.  It�s got a complete VPN.  It�s got intrusion protection, content filtering even.  So it�s great for an office.  And of course it�s an industrial-strength firewall, absolutely.  But it�s all in a single, very easy-to-use, high-performance appliance.  You could even try it for free, just go to Astaro.com, or you can call Astaro at 877-4AS-TARO, and you can schedule a free trial of the Astaro Security Gateway appliance in your business.  If you�re a non-business user, you can even download the software and put it on a beige box, any old PC, and try it for yourself.   Really a great company with a great product.  And we are glad to have them onboard.  Astaro.com.



So let�s start with the first, which is why would Irfan write his program so that it executes code from the stack?



STEVE:  I really can�t speak to that, Leo.



LEO:  What�s the advantage?  You�re a programmer.  Why would you do that?



STEVE:  Oh, yeah, I know all about the stack, and I�m a programmer.  There are, for example, he might have several different image display algorithms that he has compressed in his own code.  So he allocates some memory to hold it, and then himself decompresses his own code into that memory, which is then marked � because it�s presumed by Windows to be data, Windows marks it as no execute, even though Irfan�s real intention, his own intention is to execute from there.



LEO:  I�ve seen modifiable code and things like that where you put code in a data area, and then you modify it, depending on what you want the program to do.  And it�s a hack.  It is an efficient hack, but it�s a hack.



STEVE:  Well, and famously, the old Windows bitblit routines, that is, the bitblit is the term for moving a rectangle of pixels around the screen, like when you drag a window, you�re actually doing blitting.  You�re blitting that around the screen.  And the original Microsoft code, in order to create sort of self-optimizing blitters that would run as fast as possible, they built them on the stack and ran them on the stack.  So there was a real reason once for doing that.  Now, if Irfan knew that IrfanView didn�t run under Windows always-on mode, he could certainly make a trivial change to his program.  He�d find out where the problem was and why, and he�s able to allocate the memory as�executable.



LEO:  Okay, so when you allocate the memory you can say this is data or this is code.



STEVE:  Yes.



LEO:  So it�s simple to fix.



STEVE:  It�s so simple to fix.  So what I�m hoping is that users will...



LEO:  That he�ll listen to this podcast.



STEVE:  Well, or that people will contact him.  But more than just IrfanView, that as people start trying to live with hardware DEP turned on, they�re going to run into some things that don�t work.  So they could, first of all, they could back off from always-on, which for whatever reason seems to be the strongest protection possible.  They could come back a notch to the opt-out mode where they may have to exclude some programs that they wish were going to be protected, but they exclude them opting them out of DEP protection, in which case Windows will not mark the data they allocate as non-executable, allowing them to run.  I�m hoping, though, that this will create pressure from the industry for programmers to clean up those programs which are not currently DEP-friendly programs, so that in a relatively short time people are then able to run in always-on mode, the strongest mode, and that problems become the exception.  They are actually now an exception, but a much smaller exception so that it becomes really feasible to run our Windows systems this way.  What I�m excited about is everybody with XP can do this.  That is, you don�t have to move to Vista in order to get this hardware DEP capability.  This was added in Service Pack 2.  So all XP users will have access to this.  Now, your second question was...



LEO:  How do I do it?



STEVE:  ...walking our users through.  I�m reluctant to do that for a couple reasons.  It is possible, and we have had reports of it, that Windows will not boot if you switch the system into always-on mode, or if you increase the strength.  You could have drivers, third-party drivers � all of Microsoft�s drivers are just fine.  And I�ve got systems booting fine in always-on mode, many different systems, in fact.  But it�s possible that you could have a third-party driver that would cause a problem.



LEO:  That�s kind of a problem...



STEVE:  That�s a problem.



LEO:  ...because you can�t know if you�ve got that or not.



STEVE:  Well, you can�t.  There are ways around it, but not something I can casually describe in a podcast.  For example, this is done by modifying the boot.ini file, which is by default marked as a system hidden file in the root of your boot drive.  So I don�t want to go through here verbally telling people, okay, go make changes.  It�s a little freaky, like making changes to your registry.  The good news is, if you are a power user, you know how to edit your boot.ini to create multiple boot profiles, which is what I have done.  You�re able to give yourself a menu when Windows boots, saying how do you want to boot?  Always-off, always-on, opt-in, opt-out?  So and that�s what DEPuty is going to do for people.  You�ll be able to run DEPuty, my forthcoming freeware.  And I don�t mean to be pre-announcing this, but this is where I�m headed here, is you�ll be able to run it, and it will completely make you safe.  You�ll be able to essentially have DEPuty change your boot.ini anyway you want to, to give you these boot options, to allow you to safely experiment.  Once you find that you�re able to get booted in always-on, you could remove that option from your boot.ini if you didn�t want to have to choose it, or make it the default rather than being able to, for example, use opt-in mode.



So again, there are � unfortunately this is all sort of black art, black magic.  On the SecurAble page, where I do talk about this, I have a link to Microsoft�s Knowledge Base article describing DEP because I didn�t want to tease people saying, well, you need to use DEPuty to do this.  You don�t, actually.  You can follow Microsoft�s instructions, although they don�t talk about this nice dual boot solution, which is a little bit more advanced.  They talk about how you can edit your boot.ini file with these different settings.  I�m going to leave it there so that only experts go there.  And if people fear to tread, don�t worry, we�re going to get you there with DEPuty in a really safe fashion.



LEO:  So there is a GUI, Microsoft does offer a GUI in the system properties control panel.  Does that not do the same thing as the boot.ini switch?



STEVE:  Correct, it does not.  It allows you to move between opt-out and opt-in, but it does not allow you to activate the much more strong always-on mode.



LEO:  And there�s good reason for that, if it would keep you from booting.  Only an expert should be messing with that.



STEVE:  Exactly.  And so that�ll be the � but basically I�ll be providing a GUI in the form of DEPuty that allows people to safely make these changes and create a multi-boot mode so they�re able to really begin running with this thing on in a safe fashion.



LEO:  Although I should point out, if it�s just modifying boot.ini, you could always get in a recovery mode, and it�s just a text file, fix that text file and get the system booted again.  But it�s for experts.



STEVE:  Again, yes.  I would hate to recommend something that causes people�s machines not to boot.  Which again, it�s why Microsoft has backed off of this so far.  I congratulate them and salute them for putting this in at all.  It is a potentially way powerful solution.



Now, one person in our newsgroup posted a question a few days ago, saying, hey, Steve, why are you so hyped up about hardware DEP support when there�s a way around it?  What about return to libc?  Okay.  First of all, he�s right.  There are ways around this.  What I did was I did a whole bunch of research on the value of hardware DEP and the strength of workarounds.  Return to libc is a very clever but also very limited means for bypassing hardware DEP.  And it�s not a complete bypass.  Again, it�s very limited.  In fact, I quote one of the authors on the SecurAble page already, I quote one of the authors of one of the sophisticated workaround techniques who himself says this white paper, which talks about ways you might be able to get around this, should in no way be construed as suggesting that [audio glitch] not very powerful things to do.  They absolutely are.  That is, hardware DEP is a potent solution, and this paper should be seen as demonstrating that the options for executing arbitrary code are rapidly diminishing.  Which is really what�s happening.  He�s basically saying, yes, we found some theoretical ways that it�s possible maybe for a hacker to still get around this.  But they�re theoretical more than not.



The way this works is, notice that executable code is obviously not going to be marked as non-executable.  That is, it�ll be in memory which is executable.  So imagine a buffer overflow which doesn�t execute code in the buffer which we already know is marked as non-executable, but in fact jumps to some code that already exists in the system at a known location, and that that code ends up being something that the hacker wants to run.  Now, the classic example of this is the actual code for implementing opt-out.  So imagine that a buffer overrun occurs, and it�s possible to jump to the routine already in Windows for disabling DEP-checking for a given application, and that you�re able therefore to essentially opt the program out so that when you return from that, then you are able to execute code in your buffer.



Now, I can�t even say that that�s possible.  But it�s an example of a very clever trick where, because we�ve locked the buffer so that it can no longer be executable, instead the hacker jumps to some existing code that sort of helps to achieve their end.  Again, you can see that this is a real stretch to imagine that that�s very useful, which is why my enthusiasm for this is not daunted at all.  The fact that there are some theoretical ways around this kind of very strong buffer overrun and buffer execution prevention in no way diminishes the value of this to be applied system-wide.



LEO:  And you�d have to really get on that system and have some real access to it to make that kind of a change, wouldn�t you?



STEVE:  Well, as a matter of fact, that leads us directly into the other feature that Vista has which unfortunately XP does not have.  And that�s this ASLR, Address Space Layout Randomization.  Notice that the absolute crux of that exploit was that it knew where some code would be sitting in the system.  If the system now starts randomizing the location of its programs, of its own system programs, then it�s not possible to know where in memory the code is.  And that�s what ASLR, Address Space Layout Randomization, does.  It randomizes the layout of the system�s address space so that hackers cannot know where these things are going to be in memory.  Now, the bad news is, that�s not available for XP.  The good news is, there is some freeware which adds this to XP.  It�s been around for a few years, and we�ll be talking about it in the future.  So address space layout randomization sort of adds the final touch to hardware DEP, making it even more impossible for hackers to exploit using any kind of hardware DEP bypass.



LEO:  What is the default for Windows XP?  Always-off?  Or is it software?



STEVE:  I think it�s opt-in, yes.  And in fact, software � really interesting that you mentioned that.  Software DEP � and I�m trying to be very good about always saying �hardware� DEP.  Everything I�ve been talking about so far in this podcast is hardware DEP.  And everything that�s SecurAble talks about is hardware DEP because software DEP really isn�t.



What I think must have happened is many years ago some manager guy was saying to his coders at Microsoft, hey, guys, what can we do to fix these buffer overrun problems?  And they said, well, the chip manufacturers are going to be adding a feature which pretty soon everybody�s going to have, certainly everybody buying new machines, which will allow us to stop in the hardware any kind of buffer overrun.  And so the manager said, okay, except that we�re doing Service Pack 2 now, not in three years.  So what can we do for Service Pack 2?  And the programmer guy said, nothing.  And the manager said, wrong answer.  I don�t want to hear nothing.  Give me something.  And so one of the programmers had a brilliant thought.  He said, well, there was a hack once where somebody used Structured Exception Handling, SEH, in order to get control of a system.  And we could do a better job of checking that and so that doesn�t happen again.  And so the manager says, oh, is that software DEP?  And the developer said, no.  And the guy said, oh.  But let�s call it that.  And so they said, oh, but it�s not.  And the manager says, okay, well...



Of course this is a synthetic conversation.  I don�t know that anything like this ever happened at Microsoft.  But given the evidence, it would seem that something like that happened.  So Microsoft calls it �software DEP,� and it�s not.  It�s better than nothing because it does prevent the exploit of one very limited class of problems, nothing like what hardware DEP does.  Nothing like really blocking the execution of code in a buffer.  So having software DEP is not the same as having hardware DEP.  But in Microsoft�s defense, it did help to increase the security of Windows a little bit.  Not nearly as much as hardware DEP.  But on the�other hand, it existed before hardware DEP support was�available.



LEO:  Right.  It�s the best they could do.



STEVE:  It�s not a bad thing.  It�s the best they could do given the hardware at the time.  But sadly, hardware DEP is�� I think it�s in opt-in mode, which says that if the BIOS does not have...



LEO:  It is.  I just checked.  It says the default is�optin.



STEVE:  Yes.  So if the BIOS has not disabled it, as unfortunately some BIOSes have, so if you turn it on in the BIOS, then you�ll be in opt-in mode, which gives you some protection for Microsoft�s own code, which is certainly better than none.  Microsoft of course made sure that none of their own code would be false-triggering hardware DEP.  We just need to get the rest of the industry to be similarly responsible, in which case we�re going to be in really great shape with any processors that have been made for the last few years that have this stuff enabled.



And so we�ll be coming back to this at least one or two more times in the future, Leo, as I have more of my own solutions ready.  Anybody who�s listening to this could go to the SecurAble page, grab a copy of SecurAble, run it on your system, see if you�ve got hardware DEP.  And if you are a power user and feel comfortable finding and modifying your boot.ini file, there�s a link to the Microsoft Knowledge Base page that tells you how to change it from opt-in to opt-out, which is it seems to be really safe to use opt-out.  And maybe you could try always-on, which is certainly the strongest of all.  But we do see more problems with always-on.  I�m just hoping that we�ll begin to create some pressure so that the third-party program developers and driver makers will be able to make their software compatible with always-on, which is going to end up giving XP users and Vista users much stronger security protection than they�ve ever had before.



LEO:  Yay.  So get SecurAble.  I�m downloading it right now because I want to turn on my hardware DEP.  And I just got a boing, and it says, yes, hardware DEP is available.  Very cool.  Not hardware virtualization.  I�m running an AMD FX64 chip, so.  But that�s okay because it�s running Windows, and that�s all I want it to run.  But I�m going to turn on hardware DEP.  If you want to get your copy of SecurAble, you just go to GRC.com.  You�ll also find many other useful tools there, like ShieldsUP where you could test your router.  All these are free, by the way.  Many, many more.  And one that�s not free, but very much worth the money, and that is, of course, SpinRite, everybody�s favorite, my favorite hard drive recovery utility, great for maintenance, keep an eye on your drive, what it�s doing, fix bad sectors, recover data on bad sectors, and a whole lot more.  It�s from GRC.com.  For testimonials, to learn more about SpinRite, SpinRite.info is the site to go to.



STEVE:  We hear from people all the time.  I got a nice piece of mail.  Someone named Mark Kramer in Pasadena down here said:  �Mr. Gibson. after listening to you and Leo on Security Now!, and Leo and his other Netcasts, I decided back in November to buy a copy of SpinRite just in case I ever had a problem.  Well, after coming home after the holidays, I found my Windows XP/SP2-based PC in a nonbootable condition.  I tried several reboots, and it kept getting hung at the Windows XP splash screen.  I was going to just reload the drive from an image I had cloned about a month ago.  But then I remembered that I had a copy of SpinRite 6.  I shut the machine down, put in the floppy, and turned it back on.  After answering the easy-to-understand prompts, away it went.  It was done in approximately 45 minutes, and I exited the program and rebooted the computer in anticipation.  Sure enough, the PC went through the splash screen and on to my Windows log-in prompt.  Everything seems to be back to normal.  Thanks for your wonderful product and your contributions to the tech community.  Hope you have a great new year.



LEO:  Isn�t that nice?  You must...



STEVE:  So I just love...



LEO:  You get those every day, don�t you.



STEVE:  Yeah, we get them all the time.  It�s funny, as I was sorting through these, I thought, which one am I going to read?  It�s hard to choose.



LEO:  Decisions, decisions.



STEVE:  I just love the fact that we�re able to fix these things for people because these days, with drives being so big, and as we talked about, I guess it was two weeks ago, the shocking � even to claim the low reliability of drives, where Seagate is saying that they�ll have 0.34 percent failure per year, it�s like, yow.  People are storing stuff they really need on their hard drives, and SpinRite is, as you say, the best utility for getting it back.  So I�m glad to do it.



LEO:  And you are the best guy for explaining security.  Steve Gibson, what a great job.  I know there are a few people who tuned in thinking that we were going to talk about Johnny Depp today.  I�m sorry, this is the wrong podcast.  But we do now know about hardware DEP.  And I�m going to reboot because I just changed my boot.ini while we were talking.  I�m brave.  I�m bold.  I�m scared.



Steve, a great job.  We�ll see you next week.  Have a great week.  I will sail back to you, and we�ll get on the line via Skype for another one next week.



STEVE:  Sounds great.



LEO:  Take care.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#79

DATE:		February 15, 2007

TITLE:		Backtracking Spoofed Spam eMail

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-079.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Leo's 'TWiT.tv' and Steve's 'GRC.com' domains are used by spambots which spoof their domains as the source of bogus eMail.  This week they discuss the details of eMail "Received:" headers and explain how the examination of those headers can penetrate any spoofing to reveal the true originating IP of any spoofed spam eMail.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 79 for February 15, 2007:  Spambots.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



It�s time to talk about security with everybody�s favorite security maven.  I�m going to call you a �maven� from now on, Steve Gibson.



STEVE GIBSON:  I�m not sure what a maven is.



LEO:  It�s good.  I know it�s a good thing.  It�s like a, hmm, I don�t know how to describe it.



STEVE:  An advocate, maybe?



LEO:  No, no, like a big shot.  A maven is regarded by cohorts as a trusted expert in a particular field and who seeks to pass his or her knowledge on to others.



STEVE:  Boy, you are fast with that dictionary, Leo.



LEO:  That�s Wikipedia for you, baby.  It�s right there.  So you are � I would say that�s pretty much you, a trusted expert in security, and you seek to pass your information to�others.



STEVE:  I�d go along with that.



LEO:  You da maven, man.  And today we�re going to talk about what, Mr. Maven?



STEVE:  Well, a couple things.  It�s funny, I was listening to one of your recent TWiT broadcasts, I sort of listen to them in the background when I�m doing work where I can have one ear on that.  And you guys were talking about � this was in the last couple weeks � the really continuing expansion of zombie botnet fleets.  Do you remember that it was a couple weeks ago somebody had some stats about the percentage of PCs that are now believed to be infected with some sort of remote-control bot.



LEO:  Yeah, it was Vint Cerf, the father of the Internet, who said that, of the 600 million PCs out there, he believed 150 million, one quarter, were infected.  And you know, I�ve talked to a number of people since then who think that number is low.  It�s certainly a very big number.



STEVE:  Well, it�s phenomenal.  And of course that corresponds with two things because these bot fleets are being used both for spamming and for attacking with denial-of-service attacks.  And what I wanted to talk about today was the issue of spoofing email.  It was triggered by � well, before we get into that we probably ought to talk about errata.  And then we�ll start talking about it.



LEO:  There�s also a news story that we�ll talk about because botnets were used to try to bring down the Internet just last week.



STEVE:  Right.  Again, an attack on DNS servers.



LEO:  The root servers, which you have always said is the weak link.



STEVE:  It�s a vulnerability, for sure.



LEO:  And at some point, maybe this isn�t the episode, but I would love to talk to you � we did it on Call For Help, and I don�t know if we�ve ever done it on Security Now!, about that vulnerability.  And they are trying to do things to protect you.  But I would love to talk about that at some point on the show.



STEVE:  For sure.



LEO:  But meanwhile, let�s cover errata from previous�episodes.



STEVE:  Well, actually this is not from previous episodes.  But the big news today, and actually it�s big enough news that it�s been picked up by a number of different news stories on the �Net, is Microsoft released a surprisingly large batch of vulnerability fixes on Tuesday.



LEO:  For Vista or XP?



STEVE:  Well, for Windows.  But they included Vista, which was one of the things that I picked up on immediately, and I was looking at it.  What caught my eye � okay.  First of all, Microsoft tied themselves for the largest batch of vulnerability updates they�ve ever released.  There were six critical and six important.  But together those 12 updates fixed about 20 problems because a couple of the updates fixed multiple problems.  What caught my eye as I was just sort of scanning it, first of all, I looked at the length of the email that I received from Microsoft.  And it�s like, whoa, this is more than your normal couple one or two.



LEO:  So you get an email that says, watch out, here it comes, this is what it�s going to be.



STEVE:  Exactly.



LEO:  I don�t know if I get that email.



STEVE:  You�re able to subscribe to it somewhere on Microsoft�s site.  And...



LEO:  So it gives you a heads up.



STEVE:  It does, and it sort of keeps me in the loop.  Now, the reason that I use that is I don�t like the idea of this Windows Update running behind my back and automatically downloading and installing things for me.



LEO:  I do.  I let it do it.  I just say, go ahead, you do anything you want.



STEVE:  Well, and I think for most users it�s probably the right thing to do.  At least maybe to download them and then advise you when they�re ready to install.  But for example, on my old creaky Windows 2K machine that I�m still using, I�m not moving from IE6 to IE7.  And of course Microsoft is really pushing IE7 hard.  So I don�t � and then they�ve got that .NET stuff.  Now they�re at .NET 3.0.  And that�s 50 megs of blob that I just don�t want on my machine.  So, you know, and I think like many of our listeners probably, I�d like to have more control over what Microsoft is pushing onto my hard drive behind my back.



So the reason I bring up this security issue is, if there are other listeners among our growing base, I think you and I were just talking a minute ago, the numbers seem to be increasing of Security Now! listeners.  I wanted to make sure that people would do an explicit verification, use Windows Update under your Start menu to grab this stuff.  Because there were six zero-day vulnerabilities, which is to say, as we know from having talked about those before, those are exploits which appear and surprise everybody, exploits which are active and discovered before anyone knows there�s even a vulnerability, let alone a patch for it.  Now, they were not widespread exploits.  Otherwise our listeners would already have heard about them from us.  They were only being used in more selective, targeted attacks.  But they were discovered on the �Net being used.  And it was from them that these vulnerabilities were reverse-engineered to find out what it was these things were exploiting.  So there were, among these 20 problems, six of them were zero-day...



LEO:  Six.



STEVE:  Yes.



LEO:  That�s unbelievable.



STEVE:  Well, and, okay, the first thing that caught my eye, as I was saying, when I was scanning through this email I saw �Vulnerability in HTML Help ActiveX control could allow remote code execution.�  Well, it�s like, okay, that�s a bad one.  Because once again that�s your typical browser-based exploit that we�ve talked about a lot where doing something that brings up a page allows a remote site to have its way with you and your computer behind your back.  Essentially, you know, the kind of problems we�re going to be seeing are mostly this type now because Microsoft has finally got a firewall that�s running by default.  So I don�t expect to see wide-scale worm problems the way we have been before.  That is, as we said recently, in fact, mostly that the problems that we�re seeing now are people visiting unsafe sites with scripting active that allows their machine to basically run a script that the website provides, which you know always makes me very nervous, and they get their machines taken over.  So...



LEO:  It�s not that the worms aren�t out there.  They still are, but you�re protected as long as you�re running that Windows firewall.



STEVE:  Correct.



LEO:  So there�s got to be some other way.



STEVE:  Well, and even if you didn�t have the firewall, any currently patched system will not fall victim to the old Code Red or MSBlast worm or any of the worms that are still out there poking around and we�ll probably never get rid of.  On the other hand, it�s just so fundamentally wrong to have your ports open and exposing services that you don�t really need to have exposed, which are what worms are looking for.  So you really want the firewall up.  But then the other vulnerability out of this list of 20 that caught my eye, get this, was in Microsoft�s own Malware Protection Engine.  There was a remote code execution vulnerability there in the way it parses PDF files.  So, and this is Windows Defender for Vista.  So...



LEO:  Wow.  Defender has a bug in it that will allow a bad guy to remotely execute code on your system?



STEVE:  Yes.  It says...



LEO:  Via PDF.



STEVE:  Via a PDF.  And the problem is, Vista�s Windows Defender scans incoming stuff without user intervention.  It�s trying to protect you.  In the process, it exposes a buffer overrun vulnerability, exactly like we�ve been talking about a lot here recently.  This was found and reported by the IBM X-Force guys, the ISS guys.  And they say, �By sending a specially crafted PDF file, an attacker can trigger a heap overflow, resulting in remote code execution.  This file may be sent over common protocols such as SMTP� � you know, email � �HTTP, FTP, et cetera.  In many cases, this vulnerability may be triggered without user interaction.  The vulnerability exists because an arbitrary integer from a PDF file is used in a memory allocation calculation without proper bounds checking.  As a result, an attacker may provide a large integer value, creating an integer overflow in the calculation.  This causes a heap overflow with arbitrary file data.  There are several structures on the heap that an attacker may abuse to obtain remote code execution.�



So, I mean, here is exactly the kind of stuff we�ve been talking about where a PDF file contains a very large integer, some math is done, it wraps around to a smaller value, then a small amount of memory is allocated when a large amount of data is provided which overflows the buffer that was allocated and, wham, you�ve got a compromised system.  So, and I think the little � a couple articles that I�ve seen have commented that, well, you know, the one thing you want to have really be secure is the software which is securing you.  So here�s a vulnerability...



LEO:  Yeah, no kidding.



STEVE:  ...in Windows Defender, and it affects Vista as well.  So again, these are really difficult things to fix.  Now, what I haven�t been able to find, nor have I been able to test this, is whether having hardware DEP running would protect against this.  I�m going to keep my eyes out to see if I can find any demos for this.  Oftentimes exploits will surface a few weeks after the patch, just looking for people who haven�t made their machines current and kept them updated.  So I may be able to find some sample code to exercise this exploit, which would then allow me to play with hardware DEP under Vista and XP and see whether having it enabled would have already protected people.  Because of course it would be very cool if this was never a problem for people who had hardware DEP running.  We don�t know one way or another about that yet.  And anyway, so I absolutely want to let people know that if they don�t have Windows constantly checking for updates, go and do one now because there�s a big package of goodies waiting for you at Microsoft that you really do want to have installed in your machines.  And this is virtually all versions of Windows.  I mean, Windows 2K, XP, even Vista, all have issues that are being fixed by last Tuesday�s � second Tuesday of the month.  It was also the 13th of February.  So I thought, well, that�s the right day for...



LEO:  It was a little Valentine�s Day gift early.



STEVE:  A little pre-Valentine�s Day, yeah, exactly.



LEO:  Got the love.  You know, I�m looking at my system, and�it has yet to tell me I have an update, so that�s interesting.  Even in and of itself.



STEVE:  Yeah, it is taking a while for these things to get  pushed out by Microsoft.  I notice that it sometimes is a day or two after the second Tuesday that Windows finally gets around � I think the problem is so many people are using this, and of course Microsoft has all this enabled now for many years in XP and certainly all in Vista, that there�s got to be a tremendous load on Microsoft�s servers, especially when you get patches of this size.  So they�re probably metering out the rate at which they notify people of these updates in order to get some control over it.



LEO:  But with six zero-day exploits it seems a little foolish to wait too long.  And this is why I, you know, have turned on the automatic updates and just say go for it, you know, because I don�t want to take the chance.  Is there something people should do before they receive the downloads, if they haven�t received them yet?  Should they stop surfing?



STEVE:  Well, it�s always the case that, as you know, my standard advice is be very wary of scripting.  So many of these are, again, scripting-based vulnerabilities that are caused by someone browsing to somewhere unsafe.  One of the�other ones was really interesting, it�s 016, it�s technically the 16th one of 2007, and that�s the cumulative security update for IE, both IE6 and IE7.  And there were � that�s one of the updates that contained multiple vulnerability fixes.  It turns out that, if a script tries to instantiate, which is the term used in all this ActiveX or COM stuff, if a browser script tries to instantiate a COM object which was not intended to be instantiated by IE, and there is just a bazillion of those, it turns out that a vulnerability was found in the way that happens that allows remote code execution.  So we�ve got vulnerabilities in ActiveX controls that are designed for IE to be able to run them.  And now we�ve got even a bigger class of problems because it�s been found that it�s possible to exploit the instantiation process for COM objects in the system which were not intended to be instantiated by IE.  I mean, it�s a�mess.



LEO:  Let me just make this clear.  Which of these are for�Vista, and which of these are not for Vista?  I mean, Defender obviously is in Vista.  IE7 is in Vista.  So I�presume...



STEVE:  Yes, but IE7 in Vista is not vulnerable to this particular problem.  And IE7 is also not because there are � IE7�s enhanced security over IE6 does prevent, by default, it prevents this particular exploitation.  The problem is, if IE6 had been configured to allow some of these things to run � because you might have some corporate system where for some corporate website or internal Intranet you were using some COM objects in your normal daily business.  If you then update IE6 to IE7, in order for the update process not to break things, it will carry those permissions forward, and you�ll still be vulnerable.



So anyway, unfortunately it�s not a simple answer.  But it�is the case that IE7 under Vista is not vulnerable to this particular 016 set of problems, although Vista is vulnerable, as we said, the Windows Defender component of Vista is vulnerable.  And in fact there�s, like, eight different modules that Microsoft is now using for its antiviral stuff.  It�s like Windows OneCare, that�s vulnerable.  And there are several other places where they�ve got email scanning engines and things that are more IT oriented than end-user and consumer.  All of those, all eight of those things use the common Windows Defender core, and they all have this PDF file vulnerability.



LEO:  Wow.  And so Defender, and then some of the other patches, are they XP specific?  Are there any Vista-specific patches, just for Vista?



STEVE:  No.  There was nothing that was only Vista except Windows Defender.  Of course you are able to put Defender, I guess, on XP.  So that sort of falls back there, too.



LEO:  It�s both, yeah.  But that�s actually quite interesting.  I mean, in a way that�s encouraging.  There were no zero-day exploits that were particular to Vista.



STEVE:  Right.  And at the moment what we�re seeing is we�re seeing the common code that has always been in Windows that unfortunately Vista has carried forward is still causing a problem.  It is also troublesome that, okay, it�s troublesome that Windows Defender has this problem because it was clearly recently written.  So you can�t argue that there was lots of legacy code in Windows Defender.



LEO:  Well, no, because they based it on an antispyware program from Giant that is fairly old.



STEVE:  Ah, that�s a good point.



LEO:  So they could have inherited bad code.



STEVE:  Exactly.  And probably this...



LEO:  I�m going to let them off the hook there.



STEVE:  The PDF file parser � well, actually I was going to let them off the hook by just again saying that this kind of stuff is so hard to find.  I mean, a programmer could stare at that, I mean, and as a programmer I have stared at my own code, a programmer could stare at that integer math and look at it and just not see, I mean, just not see how it could be misused.  It�s so difficult to find these things.



LEO:  Yeah, but when you�re accepting input from a user, those are the places you check.



STEVE:  Yes, exactly.  Well, especially, see, as we know, a PDF file is basically a form of encapsulated PostScript.  And PostScript...



LEO:  Right, so it�s programming.



STEVE:  It�s a scripting language, exactly.  So when you open a PDF, you�re running a scripting code.  And that�s exactly why a static file like a PDF would have an integer that something would be using to drive an allocation of memory that creates this problem.



LEO:  Very interesting.



STEVE:  So anyway, the takeaway message is make sure, everybody who�s listening to this, that you know that last  Tuesday was a major patch event, the second Tuesday of the month, for Windows.  And you want to make sure your machines are current because, although there�s no widespread exploitation of these things, they generally do get more popular after the news gets out, after a patch occurs.  We see more exploitation then in many cases than beforehand.  And I wouldn�t be at all surprised to see that happen here.



LEO:  But again, I�m going to look at the bright � I�m going to be the optimist here and say the fact that Vista now has been out for, what...



STEVE:  Couple weeks.



LEO:  ...couple weeks, almost three, well, two weeks, and has not had any major exploits that are specific, that are particular to it is encouraging.  I mean, we�re on this countdown clock, frankly.  The minute Vista shipped, I�ve been waiting to hear of that first Vista exploit.



STEVE:  Yeah, they will happen.  There�s no doubt.



LEO:  I�m saying half full; you�re saying half-empty.  That�s just the way it is.



STEVE:  Well, for you to be saying half full about Windows security, Leo...



LEO:  That�s pretty surprising, isn�t it.



STEVE:  That�s a real change.



LEO:  I think it might just be that I want it to be true, you know?



STEVE:  I got a really neat note that I just wanted to share with our listeners about � this is a different kind, sort of, about SpinRite.  We have an avid Security Now! listener named Russell Gordon, who has been listening to the testimonials that I�ve been sharing with our listeners and got to the point where he was looking forward to his hard drive�crashing.



LEO:  He wanted to use SpinRite.



STEVE:  He did.  I just love this note.  So he says:  �Dear�Steve, I�m an avid listener of your Security Now! podcasts and...�



LEO:  That�s so funny.



STEVE:  Oh, just listen, it�s so great, it says:  �...and have always heard you and Leo reading the SpinRite emails that you get.  When I would hear those stories, I would think to myself, one day I�ll be needing SpinRite.  As a matter of fact, after hearing the stories and how much success people were having with SpinRite, I was almost eagerly anticipating getting to use it.  Well, yesterday was my day.  I�m a controls engineer who programs industrial computers called PLCs, Programmable Logic Controllers.  Those are RISC-based processors that are extremely reliable and hardened for the industrial environments they reside in.  Yesterday I was at one of my customers� sites, which is a brewery in Texas.  I�d been working for several days on upgrading one of their programs to change the way the beer was being filtered.�  That sounds like a good idea.



He says:  �Yesterday afternoon I started getting these Windows messages about how memory was corrupt, and I noticed that my hard drive light was staying on a lot more than usual.  At one point I had to power the laptop down and turn it back on due to unresponsiveness.  When it started to boot up I got a message saying something to the effect of ntoskrnl� � the NTOS kernel � �.exe is missing or corrupt.  I rebooted again, and it never even got far enough to tell me what was wrong.  Dead laptop.�  He says:  �I knew it was time for me to purchase and download SpinRite.�



LEO:  Lucky boy, he gets to use SpinRite.



STEVE:  He said:  �What was interesting to me was that, after hearing all the stories, I was not even the least bit worried.  For some reason I was in the mindset of, �Bring it on, baby...��



LEO:  We do not recommend this, by the way.



STEVE:  Yeah, don�t go dropping your laptops just so you�have a reason to run SpinRite.  Anyway, he says:  �...because I knew I could probably resolve the problem with my drive.  It was being recognized by the BIOS, so I knew that SpinRite would have a good chance of helping me out.  I purchased and downloaded SpinRite and started it running in Level 2.  It found quite a few problems with my disk, and all but one of them was recoverable.  I let it run overnight and came in the next morning and it was complete.  I pulled the floppy out of the laptop and rebooted, and there was my Windows again, running perfectly, just like it should be.  Thanks to SpinRite, Texas will still have a good supply of Shiner Beer.�



LEO:  And filtered, no less.



STEVE:  Well-filtered Shiner Beer.



LEO:  Wow, that�s really great.  Another happy story.



STEVE:  I just got a kick out of that.  It was like, bring it on, baby.



LEO:  SpinRite, of course, is Steve�s disk recovery and maintenance program, available at GRC.com.  Before we get into the show � are you ready?



STEVE:  Yeah.



LEO:  You�re ready.  Are you prepared?  I would like to mention our sponsor, Astaro, because Version 7 of � this is good news � of the Astaro Security Gateway is here now.  And of course Astaro makes this great security software, and they�ve been a sponsor of the show for some time.  And we are really happy to have them as a sponsor.  But let me just talk a little bit about Version 7 because there are a number of new improvements, including transparent email encryption and decryption.  You know I�m a big proponent of that.



STEVE:  Well, and Leo, let me just interrupt you to say I�think that is so cool because it means that the machine that is your gateway machine does all the encryption and�decryption.



LEO:  For you.



STEVE:  So inside your network you don�t have to have any of that stuff, and you don�t need to see any of that stuff.



LEO:  You don�t have to be aware of it.  I think this is great.  You can use S/MIME or OpenPGP standards.  Inbound email is automatically decrypted, too.  So it�s just really a great solution, completely automatic.  They also now have secure remote access on their VPN via SSL, which as you know makes VPN so much easier.  Let�s see, what else?  In fact, I�think it�s the only appliance on the market with VPN solutions that are SSL, IPSec, L2TP and PPTP with SSL VP.  I mean, they really cover the waterfront there.  Can be clustered for scalability so as you grow, so will your Astaro Gateway.  In fact, you can even get up to ten clustered together without load balancers, it does it automatically.  And they are going to continue to offer the home use package, but the v7 package will now be free of charge � get this � and will include the base license, all subscriptions, and Astaro up-to-date, but it�ll be limited to ten IP addresses or ten users or 1,000 concurrent connections, plenty for a home user.  So you don�t even have to purchase the home user subscription anymore, the one that we were talking about for 79 euros.  You get that for free.  These guys are the good guys.  Aren�t they great?  You can download Astaro v7 for free on the website, or call them for a free demo unit, Astaro.com.  I am just really pleased that they�ve made that free now, including the subscriptions.  That just makes it so much of a great product for everybody.



Now, let�s get to our topic of the day, and I think it couldn�t be more apropos, the use of bot networks.  And�you�re going to talk about one particular use of bot�networks.



STEVE:  Yeah.  Okay.  The problem is, and we�ve talked about this before, that bot networks are one of the new ways of disseminating spam.  So when these little bots that are running on, by some reports, what is it, 150 million machines, one quarter of all PCs, when they�re not being used to go blow some website off the �Net through denial-of-service attack, they are being used, and it�s been confirmed, for sending spam.  They�re like sources of spam.  A couple times we�ve received some complaints from people saying, hey, you � GRC, Steve Gibson � sent me this spam.  And it�s like, I guarantee you I didn�t send you any spam.  And I�ll scroll down, and they�ll have attached the spam.  And it�s, you know, some horrible blob of keyword stuff meant to get through the spam filters.  And then typically it�ll have some binary attachment which is, you know, some evil thing.  So it�s not only spam, it�s probably malware that is being sent.  And something in the headers has led them to believe that I sent it.



LEO:  Often it�s the from address is xyz33@grc.com.  I�m�getting those to TWiT.tv all the time.  And I hear from�people all the time who are saying, they�re using my�address.



STEVE:  Yes, exactly.  And so what the spam generators have is a whole list of reputable websites, like mine, like yours, like many others, you know, CNET and Amazon.  And so they have a huge list of reputable websites, and they�ll randomly pick those websites and spoof them as the source for the spam they�re sending out in order to get through people�s filters, in order to basically try to steal the credibility which is built up by good domains and ride their junk through on that credibility.



LEO:  I wonder if that works, though.  I think antispam solutions aren�t fooled by the return address.



STEVE:  Well, no.  It takes � actually it takes more than that.  But in the samples that I have been sent from spam that has been sent in GRC�s name, the headers do provide some reason to believe that it came from us.  And that�s what I wanted to talk about.  I wanted to talk about how the headers can � well, there�s one mechanism in email which is it�s very cool, and it turns out it�s very useful for tracking down the true source of spam that is received.  And so this is of interest to listeners because if they get some stuff and want to understand a little bit more about the path it took from wherever it was originated to their machine, that information is in the headers.



The idea is that email was originally designed with what�s called a �store-and-forward model,� where you would have socalled post offices, and those would receive email, not only for their own recipients, but actually technically for anyone.  That is, in the old days, in the good old days of the original design of the Internet, before it became so subject to abuse, you�d have an SMTP server, Simple Mail Transfer Protocol, SMTP, which would be out on the �Net, listening on port 25 for anybody who wanted to connect to it.  And it would accept a connection coming in on port 25 and say hi there, identify who it was, and accept email.



Now, if the email was bound for its own domain, its users, it would store it locally, and then the users would use a different protocol, originally something called POP, the Post Office Protocol.  That�s what clients use to hook up to their POP server.  And in the case of POP it�s on port 110.  They would hook up to it in order to retrieve their mail.  IMAP is the other now arguably as popular, if not more, protocol that essentially does the same thing, but it�s more recent and has additional features.



In the case, though, that this SMTP server received email not bound for one of its users, it would still accept it and say, oh, this isn�t for me, but I�ll send it on toward its direction.  So it would look up, using DNS, it would look up what�s called the �MX records� in DNS � MX stands for Mail Exchange � and find the IP address of the SMTP server for that mail�s intended recipient, and it would connect to that server and forward the mail.  So it was sort of a go-between.



Well, this quickly became exploited by spammers.  And a server operating like this is known now as an �open relay.�  Because it is a relay point, it will accept email intended for people other than its own users, that is, other than its own domain, and happily forward it on.  So spammers quickly discovered that they could simply dump their spam on other people�s SMTP servers and get them forwarded on their behalf.  Well, one of the consequences of this sort of store-and-forward model was realized by the original designers of the email system.  And this is, again, this is part of, you know, the original brilliant conception of all of this.  They realized that it would be possible for email routing loops to exist in this store-and-forward model, that is, they deliberately designed SMTP servers to be friendly back when the Internet was all just good guys.  And so you might not be able, for example, to send email directly to its destination.  You�d have to stick it on an intermediate server.  And then it would try and try and try, for days in�some cases, to ultimately move the email to its final�destination.



The problem is, if DNS was configured in erroneous ways, it might be that an SMTP server would send email through a destination that would accept it; and then, in getting ready to forward it on, it might send it back to the server it just got it from.  Or it could send it to a third server that would send it back to the first server, or any kind of round-robin looping like that was possible because the protocol itself didn�t disallow that from happening.  So you could see how you could end up with a piece of email just being handed off among servers in a particular messed up configuration of DNS.



So the designers, recognizing this problem, said okay, we need a way of tagging email such that, if an email comes back to a server that it has previously sent, it will know that, wait a minute, I�ve already seen this mail.  I�ve already received this mail before.  We�ve got a problem here.  And it will not then continue to send it on.  Instead, it�ll send an error back to the email�s apparent sender, saying this mail cannot be delivered as addressed.



LEO:  And that�s to prevent just a loop, right, an endless�loop.



STEVE:  Exactly.  And so the way this works is, any incoming email, any email received by an SMTP server has a new header appended to the front.  And this is important for people to visualize, that there will be a bunch of so-called email headers.  It�ll say �To:,� �From:,� �Subject:,� �Date:.�  Those are just lines with a word, followed by a colon, followed by data.  And those are the email headers.  What the receiving server does is it adds its own header.  It appends it or pre-appends it to the front, to the top of the email as the first header now on the email, and that starts out saying �Received by.�  So that received-by header is a way of establishing that it has received this piece of mail.  It identifies itself.



It also identifies, and this is really cool and critical, the IP address of the connection which it accepted.  That is, it accepted a connection coming in, as I said before, on its port 25.  Well, that means it has a remote IP which we know cannot be spoofed.  As we said early on in Security Now! episodes, TCP, because it requires this three-way handshake, that is, in establishing the connection packets have to go back and forth three times.  That validates the IP of each endpoint in the two endpoints of a TCP connection.  So the IP that it logs in this received-by header cannot be spoofed.  That is the IP of something.  It doesn�t know what, necessarily, but it�s definitely the IP of the sender of that piece of email.  So this received-by header gets added to the top of the email.



Well, if the email is bound for its own domain, for example, if GRC.com received this piece of email, it would say, okay, it would just store it.  And when one of the GRC people, one of the clients connected, it would say, oh, got some more mail for you, and I would receive it.  If I look at the headers in my email, I will see only one received-by line at the very top of the list of headers, which was pre-appended there by my server that received it at GRC.com.  But say now that in the old happy days of open email relays this email was not intended for GRC, my server would then � the GRC server or the receiving server would then forward it to its destination, at least in that direction, towards its intended recipient.  The server that received it would add its own received-by header, and now that one is on top of or in front of the first one.  If that server forwarded it to a third server, that third server would again add its own received-by header.



So the point is, every hop that email makes, there is a received-by header always added to the front of the email.  And what that does is, it creates basically a trace.  It allows anyone looking at the headers to know what path that email took as it got towards them.  And in fact, even though out on the public Internet you no longer have open email � you very rarely have open email relays because they�re quickly found by spammers.  The people who are looking at spam quickly identify open email systems and will notify you that you�ve got that problem.  So it�s generally not the case that public servers are open relays.



However, inside of networks, like inside of Yahoo! or inside�of Google or inside of Cox, you know, in any large organization you may have multiple email servers.  And so it�s very often the case that email will be forwarded internally through multiple hops on SMTP servers.  Which is why users � oh, and also Hotmail, for example.  Which is why users who look at email headers will often see multiple received-by header lines.  You would normally not see that, for example, if some remote user had sent email directly to its target server.  You would normally see typically two received-by lines.  For example, a user in the Cox network would � their client would send mail to the Cox SMTP server, which would add its received-by header line.  The Cox server would then send it, for example, to GRC.  My server adds its received-by header line, where the mail then sits until I receive it.  So I would see, in the normal case, two received-by headers because that mail was received by two SMTP servers, the originator�s SMTP server and the recipient�s SMTP server.  Sometimes you�ll see many more.



Okay.  So the way spoofing is done is the first time you see it, it�s pretty clever.  Some bot somewhere wants someone to believe that GRC has initiated, is the actual sender and initiator of a piece of spam.  So the mail they send out has a fake received-by header stuck on the front of it.  That is, most email that is sent out doesn�t have a received-by header because that�s only added to the front of mail by receiving SMTP servers.  But remember that these headers are, like, they�re in reverse order.  They�re stacked so that the first one is the most recent recipient, and then they go back in time.  So there�s nothing to prevent an email from being spoofed and generated with a fake received-by header at the beginning of the mail, so that when that bot then sends it to some SMTP server, that SMTP server will stamp its received-by header in front.



But that means now that, for example, the spoofed GRC received-by header is underneath it, and it appears that someone at GRC sent the mail to our server, which created that stamp, and then our server sent it on.  So basically what that does is it creates a spoofed piece of email.  At first glance it hides the fact that some end user somewhere sent the mail.  Except it turns out that that really falls down under closer scrutiny.  Remember that I said that the received-by header contains the IP address that the receiving SMTP server connected to to receive the mail.  Well, GRC�s server, SMTP server, is at a known IP address.  And, you know, it�s in the GRC.com network.  But since a spam-generating zombie connected to some other SMTP server trying to fake it out, the received-by header, which was added by that server, won�t show a connection from the GRC.com IP.  It�ll show a connection from the IP of the infected computer.



And in fact, when I�ve responded to these spoofed emails that people have occasionally sent, saying hey, GRC.com sent me some spam, I take a look at the email they sent, and I write back a response explaining to them how, yes, it does look like GRC originated this because we�re the lowest-down header in the received-by stack.  Except that if you look at the second one up, you will find the IP address, not of GRC, because our server would have connected to the second SMTP server.  Instead, you see the IP address of the zombie machine.  And so on...



LEO:  So you can actually tell who these zombie machines�are.



STEVE:  Yes.  And in fact, that�s the cool thing...



LEO:  That�s not spoofed.



STEVE:  And here�s the point, Leo, it cannot be.  Because the receiving SMTP server always adds the IP of the other SMTP server that it�s accepting the email from.



LEO:  And it�s not possible for you to have a rogue SMTP�server that fakes those originating addresses?



STEVE:  Remember that it�s actually using the TCP connection IP.  And there�s no way to spoof that.  And so what�s been fun is when I�ve responded to these people, and I�ve shown them how to read � you know, I figure I ought to try to educate them since they�re sending out erroneous complaints about spam.  I�ve educated them.  I explain and show them this is the IP that actually connected to the second SMTP server, not GRC�s IP.  And then I�ll use my very favorite site that I�ve shared with you, it�s DNSstuff.com, it�s www.dnsstuff.com.  If people will go there and scroll down a little bit, there�s just a beautiful array of very easy-to-use tools, it�s web-based, that allows you, for example, to perform what�s called a �Reverse DNS� lookup.  I�ll take the IP address out of the second received-by header, drop it into the DNSstuff, and often get and know a lot about the infected zombie computer.  I�ll know whose network it�s in.  And not only do I have the IP address, of course, but I actually get more information from the Reverse DNS.  Is it DSL?  Is it a cable modem?  Probably it�s a semi-static IP.  And so I�ll return that and say to the guy, this is the source of this spoofed email.  Not me, but some random zombie in Norway or in China or in Russia or wherever, one of these 150 million...



LEO:  I just did one, and it�s in Mexico.  Interesting.  Very interesting.



STEVE:  Yeah, yeah.  It�s very cool.



LEO:  But it�s posing as TWiT.tv.  But it�s really a relay.  Very often it�s in the U.S.  Many of these zombies are in the U.S.



STEVE:  Actually 20 percent of spam is currently originating from the U.S., 20 percent from Russia � oh no, 17 percent from Russia, and I think 20 percent from China is the most recent stats.  It turns out that 67 percent of all email is now spam.  So two thirds of email is now spam.  And, you know, obviously no end in sight because this continues to be a problem.  But at least if our listeners are interested in taking a look at some of their own spam, they�ll be able to see now by looking at, especially if it�s spoofed, if they see, you know, multiple received-by lines, you can normally, if you take a look at the IPs in the received-by headers, since they are not spoofable, those are the actual IPs that each SMTP server in line received, had a connection to.  And often you will find that they are end-user IPs, and those are infected machines.



LEO:  They�re zombies.



STEVE:  They�ve been taken over.



LEO:  Yeah, the one I�m looking at looks like it was in fact an end-user machine.  Fascinating.



STEVE:  Now, I�ll close by talking about one last � and this is pretty quick � one last antispam measure which is very cool.  And this is what GRC uses, and many others are, too.  And that�s the SPF, the Sender Provider Framework, or Sender Policy Framework.  It�s got multiple names, and the name has mutated a few times.  The idea of that is that SPF is a very cool antispam measure which is also very useful for anti-spoofing.  GRC has added a text record in DNS.  In DNS you have different types of record.  An A record in DNS lists the address of the machine.  I mentioned MX records earlier, which give the IPs of mail exchange servers for that domain.  And there are many different types of records.



Well, one type is a text record where it�s basically freeform.  You can put anything in there that you want, and anyone who wants to look it up can essentially ask for GRC.com�s text records.  Well, if they do, they will find one which is formatted with the protocol of this SPF, this Sender Provider Framework.  What it does is it declares the valid IPs of email originators for GRC.  That is, in there I say that any email coming from GRC that�s valid has to be in this range of IPs.  And it�s basically GRC�s network.



What that means is, since it is not possible to spoof a TCP connection, if a receiving SMTP server had somebody on the line, essentially, that is, accepted an SMTP connection, they would know the IP of the connection originator.  If that person then says, hi there, I�m GRC, I�ve got an email for you, well, that receiving SMTP server can do a lookup in GRC�s DNS records for this SPF record and determine what GRC�s actual range of valid email originating IPs are.  And if the connection it has from somebody claiming to be an authentic GRC email sender isn�t in that range, it absolutely knows it�s fraudulent, that it is spoofed, and can simply drop, I mean, they could drop the connection, they could tarpit it, they could do whatever they want to.  Certainly just, you know, discard the email.



LEO:  And that won�t have any false positives?



STEVE:  No, and that�s the beauty of it, it cannot false positive.  There are some problems with this in relaying because, if GRC were to need to relay email to a third-party server for some reason...



LEO:  I�ll give you an example.  I talk to people who have businesses.  They have home addresses that they want their business email forwarded to, and they want to respond from that home address using the business address as the replyto.



STEVE:  Exactly.  Exactly.



LEO:  And that would fail.



STEVE:  Exactly.  And in fact my tech support guy, Greg, who�s in Phoenix, he uses Cox and has in some cases tried to send GRC email out through his Cox system.  And oftentimes he�ll get a bounce-back because this system is beginning to come online, this SPF technology.  Of course, it�s only as good as it is adopted.  And it�s trivial to add these SPF records to DNS.  It�s so simple to do.  In fact, the site that is promoting this even, you know, it has a little online web form where you�re able to fill it out, and it builds for you the exact line of text that you need to put into your DNS.  So...



LEO:  Microsoft has a little form like that, as well.



STEVE:  Yeah, that�s very cool.  Anyway, so it does absolutely prevent spoofing.  But it does have the problem, exactly as you say, Leo, that if you are trying to route email through some other server and not going direct, then you�ve got a problem.



LEO:  You could add an SPF record if you wanted him to do�that.



STEVE:  That�s exactly right.



LEO:  To say, oh, he�s an accepted sender, or a Comcast accepted sender. 



STEVE:  Yes.  And in fact, well, I wouldn�t � I�d be afraid, for example...



LEO:  You wouldn�t want to open Comcast, obviously.



STEVE:  Yes.  I wouldn�t want to whitelist all of Comcast�s network.  But for example, you know, Greg�s got a cable modem.  Of course he�s got a NAT router, which tends to anchor his IP firmly.  Also the SPF format is flexible enough that you can use a domain name.  For example, in general, stuff coming from us comes from an IP at client.grc.com.  In fact, I think in every case it�s client.grc.com.  Any outgoing traffic comes from that IP.  So you are able to use domain names in that record.  So, for example, if we really wanted to do it this way, Greg could have his router set up using a dynamic DNS service, which is giving his IP an automatically updating DNS record.  I could put that in GRC�s SPF record, in which case his IP would always be a legitimate source for GRC email.



LEO:  So you only have to change it for the domain that�s the source of the email.  You don�t have to change the MX record for his sending SMTP server.  He doesn�t have to have Comcast�s cooperation, in other words.



STEVE:  Right.  The idea would be that he would send email to Comcast.  If they were using SPF, they would check to see whether he�s a valid generator, a valid sender of email from GRC.  So they would check GRC�s DNS.



LEO:  They�d go back and ask you, yeah.



STEVE:  Exactly.  They come back and ask us through our DNS.  And we�d say, yes, that IP can, is authorized to generate GRC email.



LEO:  So if I want to send email from Leoville.com via my FastMail account, I wouldn�t change my FastMail�s records, I would change my Leoville.com�s records to accept anything from that IP address.



STEVE:  Right.



LEO:  That makes sense.



STEVE:  It�s a very cool...



LEO:  It also raises the issue that, frankly, another way to kind of prevent these bots, now you tell me if I�m wrong, would be for Internet service providers to validate that the return email address was in fact in their network.



STEVE:  Well, yes.  Actually there are many things that ISPs could do.  For example, a bot, in order to do this, a bot is in a network where it is able to connect to an external SMTP server.  Okay, you could argue that � and in fact, ISPs are often now blocking port 25.



LEO:  For that reason.



STEVE:  Exactly, for that reason.  So you are unable to get a port 25 connection outbound.  The only thing you can do is plant your email on your ISP�s server.  And that completely shuts down these bot networks.  Although what the bot networks then do is they just dump all their spam on their own ISP.  And often the ISP forwards it on.



LEO:  So that�s why, by the way, I think the U.S. is now only 20 percent.  I think it was a much larger number for a long time because some of the big, high-speed Internet service providers refused to block port 25.  Now they�re doing so.  And so now it�s going offshore to Mexico, Romania, Russia, and these other countries, where ISPs I guess are not so enlightened.



STEVE:  Right.  And in fact there are various sorts of workarounds for getting through, of course, port 25 blocking.  If you just allowed an SMTP server to run on some other port number, then you�d just have to configure your client.  But, you know, that would work.



LEO:  Right.  By the way, that�s OpenSPF.org was where that wizard lives, if you wanted to do that.  And Microsoft has one as well, although I don�t know, they don�t use � do they use SPF?  That�s part of the reason this has become such a spaghetti is that there are competing standards.



STEVE:  Yes.  Microsoft had one that they did not want to leave as completely open.  They wanted to get intellectual property protection on it and then say, well, but we�ll license it for no cost.  It�s like, wait a minute, you know, the open source community said...



LEO:  No.



STEVE:  No.  And so Microsoft has substantially muddied the waters by sort of trying to do their own.  The other very popular one is a more sophisticated approach known as domain�keys.  And was it Yahoo! that was the early domain keys adopter?



LEO:  I think Yahoo! Mail was going to use that, yeah.  Hotmail wanted USPF and domain keys...



STEVE:  Right, right.  So we�re seeing those.  But anyway, for people who are curious about the spam they receive, and certainly for people like you or I or anybody else who�s a high-profile, good reputable source, we end up being the target of these sorts of spoofing attacks.  It turns out the good news is it�s very possible to demonstrate that we were not the source; and there is no way, if you know how to read those headers, that you can be fooled.



LEO:  Yeah, would you send me the boilerplate that you use?  Because I would love to use that.  I get those comments fairly frequently.  Actually more commonly I get people asking me, you know, I�m a businessman, I have a domain, why am I getting all this bounced-back spam?  Who is using my domain name?  And I have to explain the same thing to them.  And apparently there�s nothing you can do about it.



STEVE:  No.



LEO:  As long as people don�t require domain authentication, it�s going to continue.



STEVE:  Right, well, and it is interesting, too, that, I mean, we notice that we are getting the IPs of infected machines.  On the other hand, there�s 150 million of them, and they�re all over the globe, so what are you going to do?  



LEO:  Right, right.  Well, fascinating subject, and just one of the ways botnets are used.  I do hope we�ll at some point talk about how botnets are used to attack systems like, as they were recently, used to attack the domain root servers.  But that�s a topic for another show.



STEVE:  That�ll be a good one.



LEO:  I think we�re all done here, Steve.  I will see you next Thursday.  Have a happy week and a happy weekend.  And thanks to our favorite security maven.



STEVE:  We�ll be doing Episode No. 80, which of course is going to be one of our big Q&A episodes.



LEO:  Oh, boy.



STEVE:  So we�ll have lots of good questions, and we�ll address the answers.



LEO:  Go to GRC.com, that�s Steve�s site, and you can ask questions, pose questions there.  It�s also where you can find show notes and 16KB versions for the bandwidth-impaired, and of course transcripts so that you can follow�along, read along as Steve speaks, which is often useful, frankly.



STEVE:  Oh, also I should mention there have been some questions, people saying how do they send questions to me for Security Now!.  So I want to remind people, just go to GRC.com/securitynow.  Go to the very bottom of the page, and there�s a web form where you can provide as little or as much information about your identity as you choose.  I don�t really care one way or the other, but we do like to know names and locations in order to read these things on the air because it makes it more...



LEO:  We�ll give you credit, yeah.



STEVE:  ...know where people are.  And that�s how you can submit questions to me.



LEO:  Yes.  Steve doesn�t take personal mail.  He bounces it�right back to you.  All right, Steve.  GRC.com�s the place for SpinRite also, Steve�s great disk recovery and maintenance utility, and now SecurAble, his new program that tests how secure your system can be.  A lot of interest in�that.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#80

DATE:		February 22, 2007

TITLE:		Listener Feedback Q&A #16

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-080.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world 'application notes' for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 80 for February 22, 2007:  Your questions, Steve�s answers, #16.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.



It�s kind of a landmark Security Now!.  I�m Leo Laporte.  Steve Gibson is joining us from his fortress of security in beautiful Irvine, California.  Hello, Steve.



STEVE GIBSON:  Hello, Leo, great to be back with you.



LEO:  Also joining us, the podcast dog.  Can you hear him?  Why is it he always starts barking right when the show begins?  I�ve got a little terrier across the street from me, and he just drives me...



STEVE:  We�ll probably have listeners starting to count the barks.  Hey, I heard 319 barks.



LEO:  Oh, are you kidding, it�ll be a Wikipedia article, how many barks there were in this week�s TWiT.



STEVE:  That�s true.



LEO:  We�re going to do, because it�s Episode 80, it�s a mod-4 episode, we�re going to do our questions and answers, the 16th of these.  But before we do that I think we want to cover some stuff from previous episodes.



STEVE:  Got a whole bunch of interesting errata.  First thing is, shortly after we closed down the recording last week of the really, really well-received episode on backtracking email spoofing � and in fact we�ve got a bunch of Q&A issues of really great questions that people had about some of that because there was a huge amount of interest in that.  Anyway, shortly after we stopped recording, I was puttering around, I don�t remember exactly why, but I looked at the headers of some of my email, and I realized with one of those classic kind of like �doh� events, that the header that I had been always referring to as �Received by� was just �Received:.�  And I was confused with something else.  And it was like, oh my god, I said�the...



LEO:  Oh, no, I knew what you were talking about.



STEVE:  Well, not a single person � I thought I was just going to be held up and tarred and feathered.  But no one mentioned that.  Everyone was happy to have the content, so.



LEO:  We weren�t holding you to the literal words.  It�s the thing in the header that says who it was received by.



STEVE:  Yes, well, exactly.  But as an Assembly language programmer, Leo, I�ve got to count my dotted I�s.



LEO:  You can�t leave anything out, yeah.  Well, it was funny because I should have said something because as we were doing the episode I was looking at my headers.  I knew exactly what � I could have said � I didn�t know that it mattered to you.



STEVE:  Nobody was confused.



LEO:  Nobody was confused.



STEVE:  I was made self-conscious of it, so I immediately�made a note in the errata for this week to confess my mistake.



LEO:  There is no �by,� it�s just �Received.�



STEVE:  Also, I subscribe to the SANS Security Institute newsletter.  And I thought it was interesting that there�s a new malicious JavaScript exploit which can alter DNS settings on routers with default passwords.  And this basically relates to my continual drum-beating about scripting is bad, scripting is bad.  I mean, wonderful and convenient and useful as it is, as I�ve said over and over, and nothing�s going to fatigue me from saying this, is that you are accepting code from a remote server when your browser has scripting enabled.  So I want to � there were a couple comments to flesh out this particular example of a new problem.  SANS writes that malicious JavaScript placed on websites could be used to change DNS settings on home routers that are still using default passwords.  Once the change has been made, the next time the router is rebooted, the user would be redirected to spoofed, possibly malicious websites.  Research indicates that about half of router owners have not changed the password from the default.  Now, this is really interesting because, for example, I have not changed, I confess.



LEO:  What?



STEVE:  My password from the default.



LEO:  Steve Gibson.



STEVE:  I haven�t.



LEO:  I�m shocked.



STEVE:  Because I�m all closed to the outside.  I deliberately said, you know, block WAN requests and kill off any WAN-side administration.  So there�s no way anyone can get at my router from the outside.  But if I were not surfing with scripting disabled, as of course I am, what happens is, this new exploit, which is actually very clever, the script that runs in your browser goes out and tries to find your local router, then logs into it, all behind your back and without you knowing this is going on, and modifies its settings.  So it�s, you know, it�s very clever.  It�s like a hack from the outside which you invited in because you�ve got scripting running on your browser.



LEO:  Couple of things I would say there, though.  First of all, this was a hack created by Symantec.  It was a proof-of-concept hack.  So I don�t think it�s in the wild.



STEVE:  Well, right.  SANS has two editors who commented, and I thought that their comments were interesting, too.  The first one says:  �This is a clever attack exploiting the weak default configuration of most consumer home network products.  Those consumer products tend to walk the user through a wide-open setup.  And then at the end they say, if you want to turn security on, click here, but it might ruin performance or totally screw up your network.�



LEO:  And we don�t want to support it, is what they�re really saying.



STEVE:  Exactly.  We really don�t want you to, exactly.  It says:  �The Wi-Fi Alliance has started an effort called WiFi Protected Setup.  To make it easier for default configuration of Wi-Fi networks to be secure, the same thing should happen for the rest of consumer network products.�  Then the second editor appends to this:  �Although this attack focuses on consumers, it illustrates a major trend I�m seeing,� he says, �in the cases I�m investigating.  Browser scripts are a scourge, with implications beyond the browsers in which they run.  Recent browser script attacks that I�ve investigated,� he says, �as well as the attack described in this article, involve a browser requesting content from a website where the attacker has posted a malicious script.  The website shoots the script back in a web response that causes the browser to take some action on the infrastructure on which the browsing machine resides.�  That is to say, you know, inside of your network.  He says:  �The browser is used in effect as a remote-control sentinel inside the organization�s firewall to manipulate its infrastructure, such as routers, internal applications, et cetera, controlled via browser scripts.  We are seeing this in some advanced attacks today, but watch for this vector to increase massively in the next year or so.  To defend against it, you may want to disabled browser script support in your browsers associated with critical components of your network, or enable them only for important web servers that you�ve added to your trusted zone.�  So...



LEO:  Well, you know, I�m not a big fan of this here.  Because I have to say, first of all, all of the scripting, the Java scripting exploits we�ve seen are of this nature.  They�re not putting a trojan horse in your system, they�re modifying your router and things like that.  And second of all, I mean, turn off scripting and say goodbye to the �Net.  Almost every site, including our site, uses JavaScript.  I mean, I tried for a long time, I used the Firefox NoScript extension.  And I still do.  But it causes reliability issues, and it�s a big pain in the butt, and you end up approving it on most sites anyway.



STEVE:  Yeah, Leo, the problem is that scripting is not safe.  I mean, it�s just not.  Yet it�s so useful that it�s difficult to fly without it.



LEO:  I guess my question is how not safe.  I mean, JavaScript is pretty sandboxed.  It�s not � it can�t do � it can�t erase a file on your hard drive, let�s say.



STEVE:  Oh, sure it can.  I mean, well, not by itself.  But JavaScript, for example, on IE is able to invoke ActiveX controls, which then completely empower it to break through the sandbox and do anything it wants to.



LEO:  I would submit the problem there is ActiveX, not�JavaScript.



STEVE:  I wouldn�t disagree.



LEO:  I mean, that�s a big problem.  The other thing is, I�m surprised to hear you haven�t changed the default password.  We�ve been saying for a long time that there are a couple of basic things you should always do on a new router, one of which is change the default password, turn off Universal Plug and Play, and turn on WPA if you�re on a...



STEVE:  Well, and in my defense, this is not a router on my network.  It�s on my cable modem, which is like a backup connection that I use sparingly, but...



LEO:  [Indiscernible]; right?



STEVE:  That�s true, yeah.



LEO:  Yeah, I change all my passwords right away.  And we do say that a lot.  So I guess in this case there�s a very clear fix that doesn�t have anything to do with JavaScript.  Your point is that JavaScript�s dangerous.



STEVE:  Right, right.  Okay.  I was about to say �Moving on,� as Kevin always says on Diggnation.  I�ve been spending way too much time listening to him and Alex.  We talked weeks ago about what muslix64 and the postings over on Doom9 about decrypting HD-DVDs.  I�m only going to, in this errata section, mention that those guys have continued to go crazy.  There�s an amazing thread over on the Doom9 site.  We will have a link to it in today�s show notes if anyone�s curious in continuing to follow that.  They�re uncovering process keys and volume IDs and basically just really pulling HD-DVD encryption apart and developing a broad base of understanding all kinds of additionally clever hacks for ways to decrypt HD-DVD content.



LEO:  Kind of reminds me of a feeding frenzy.  It�s like people are just dying to crack hi-def DVDs.



STEVE:  Probably just because it�s there.



LEO:  Yeah, well, it makes them mad that, you know, they came back with, quote, a better � that�s the problem with any kind of copy protection.  It just raises, riles up the masses.  And they get upset, and they get � and they�re going to crack it.



STEVE:  Also the other thing that we were swamped with this week were people asking about basically my reaction to and wanting me to talk about the Google white paper that they � I believe it was a USENIX � it was just recently released, in the last week, essentially.  Google did a huge study on hard drive reliability based on the hundreds of thousands of hard drives that Google has in its massive Internet services and Internet indexing system.  And it was really funny, I mean, I was going to talk about it from the beginning.  I made a note in the errata a few days ago, I ought to mention this because one of the most shocking things about this was that hard drive reliability is much worse than even I thought.  Remember a couple weeks ago I mentioned that I was surprised by a Seagate specification that talked about the reliability being 0.34 percent per year, meaning one in 300 drives.  It turns out that, after a couple years, Google is seeing more like 8 percent failure per year.



But anyway, so many people wrote and said, Steve, you know, we know you�re really supposed to only be talking about Internet security, or PC security.  But the reliability and lack of failure of our hard drives is kind of important, too; right?  Couldn�t you talk about it?  And I got so much email from people that � and since I obviously have a lot of knowledge about this stuff through my experience with SpinRite, next week we�re going to talk about this Google paper.  Again, we will post a link in this week�s show notes to the PDF, so anyone who�s interested can grab it and read it beforehand.  Or you can just put something like �hard drive reliability� into Google�s own search engine, and it�ll find that link for you also.  Anyway, so many people wanted us to talk about it that I thought, okay, I�m not going to turn into a SpinRite commercial, I�ll just � we�ll talk about what Google found because it�s really interesting.  And they did a beautiful study using this large sample base of hard drives that they�ve got.



LEO:  Well, I�m all for making it a show.  I mean, I think this is your area of expertise, why shouldn�t we?



STEVE:  I also wanted to mention, and I picked this up from one of the other podcasts, Leo, where you, and maybe it was Amber, I�m not sure, mentioned that Google has now gone public.  In other words, you no longer need someone else to invite you.



LEO:  Free, yes.



STEVE:  Because I remember that one of our Q&As a couple sessions ago someone asked, hey, you know, I�d like to use Google and Gmail, but how do I get invited?  So I wanted to just make a note that it�s no longer necessary to be invited.  Anybody can get a Google Mail account and take advantage of Google Mail.



LEO:  And well worth it, I might add.



STEVE:  I also noted that ShieldsUP crossed 48 million downloads.  There was a big milestone for ShieldsUP.



LEO:  We�ve got to party for 50 million.



STEVE:  Yeah, that�s a serious number, yeah.



LEO:  No kidding.



STEVE:  And finally, I�ve had a bunch of people that I�ve never mentioned before tell us that they really enjoyed the Peter Hamilton book that � there was �Pandora�s Star,� and then there was...



LEO:  Well, the one you recommended to me was �Fallen�Dragon.�



STEVE:  �Pandora�s Star�...



LEO:  �Pandora�s Star� and �Judas [Unchained]� is the...



STEVE:  �Judas [Unchained],� exactly.  And in fact several people said they liked �Pandora�s Star� so much they were now waiting for �Judas [Unchained]� to come out in paperback, and they couldn�t...



LEO:  I bought the hardcover.



STEVE:  I did, too.



LEO:  I couldn�t wait.



STEVE:  The thing I wanted to mention was, I just finished  my third reading of �Fallen Dragon.�



LEO:  You know, I have to say, having now read �Pandora�s Star� and halfway through �Judas [Unchained],� and �Fallen Dragon� is the best of the three.  It is wonderful.



STEVE:  Yes.  So I wanted to tell our listeners that if they liked �Pandora�s Star,� I mean, I read it already twice.  It had been long enough now that I�d sort of forgotten the details.  And I just really enjoyed reading it again.  So I will recommend �Fallen Dragon� by Peter F. Hamilton as a great, you know, it�s not one of those things that you want to hurry through.  All of his stuff is sort of literary in nature, sort of Dickensian, I guess you would say.



LEO:  Yeah, it is, yeah.



STEVE:  You know, with lots of character development.  But just a really good...



LEO:  It�s great, I mean, it�s a full-fledged universe.  And if you like sci-fi � I had never heard of Peter Hamilton till you told me about him.  And I remember I was in Toronto, and I bought �Fallen Dragon� that day.  And then I got it in the mail from you the next day.



STEVE:  That�s right.



LEO:  But you know it didn�t go to waste.  I lent it to a friend who�s a sci-fi fan who loved it.  We�re turning people onto Peter Hamilton right and left.  And then I did just � I�m in the middle �Judas [Unchained].�  But, you know, it�s funny because you�ll get �Pandora�s Star,� and that in itself is 900 pages.



STEVE:  It�s a read.



LEO:  Yeah.  And you figure, well, hey, at least it�s going to end.  It doesn�t end.  At the end of the 900 pages you�ve got one character going over a waterfall, you�ve got the aliens approaching, and for more, read �Judas....�  It�s like you�re only halfway through.



STEVE:  Oh, it is, well, in fact, his bigger volume � that�s not even the biggest one.  I�m blanking on the name.  His famous was a three-volume hardback that became six paperbacks.  The �Night�s Dawn� trilogy is the name of it.



LEO:  Is that worth reading?  Do you recommend that?



STEVE:  If it weren�t so darn long.  I mean, it�s really interesting, some fantastic sci-fi ideas, real neat stuff.  But boy, does it go on and on and on.  So...



LEO:  Well, I�ll bring it to a desert island the next time I�m shipwrecked.



STEVE:  For people who have time it�s, you know, like for non-TV watchers who really enjoy reading, I don�t think there�s anything better than Peter Hamilton.



LEO:  I agree.  Hey, you said we aren�t going to do an ad for SpinRite.  But yes we are.  Let�s do an ad for SpinRite, everybody�s favorite hard drive maintenance utility and disk recovery.  And if you�re one of those 8 percent a year � that really brings it home, doesn�t it.



STEVE:  It really does.



LEO:  SpinRite is Steve�s bread and butter.  It isn�t really an ad because we just do it because we love it.  But I do want to make sure people know about it.  You can read the testimonials at SpinRite.info, or buy a copy, as everyone should, at GRC.com.



STEVE:  While I was browsing through these questions in order to pull 12 together, which we�re about to start on, I ran across a really neat one where the guy used the Security Now! web page to send his testimonial to me, rather than sending email to, you know, sales or support at GRC.com.  And I�ll just read the first line.  He just said:  �SpinRite saves a business.�  So I got a kick out of that, and I�ll share that with our listeners at some future time.



LEO:  Or just go to SpinRite.info.  Let�s get to our questions.  We�ve got 12 good ones, as usual.  It�s Episode�80, divisible by four, so that means it�s time to read a question for Steve.  And you said that our episode on spam stimulated some email and some questions, and you�re absolutely right.  We got quite a few.  Let�s start with the first one from Chris Mckamie of Taft, California.  He says:  In episode 79 you talked about spoofing email headers.  I wanted to know, how do I look at or find the headers in the email I get?  We didn�t mention that.



STEVE:  No, it was a great question from a practical standpoint.  I�m a Eudora user.  And it�s funny because the button is labeled �Blah blah blah� on Eudora.  As in yeah, yeah, yeah, you know, this is stuff you really don�t need to see.  And so you click the �Blah blah blah� button on Eudora, and it will show them to you.



But of course probably the majority of people are using Outlook or Outlook Express.  And so I did a little � I just fired up one of my XP machines where, you know, you get Outlook whether you want it or not, thank you Microsoft.  And if you right-click in the upper pane where it shows you your list of email, and go to the bottom of the pop-up menu, the context menu that comes up, there�s a Properties item.  Under Properties you can choose the Details tab.  And what it shows you are the headers, and there�s also a button there that says �Message Source.�  And if you click that, it opens another window with the entire source of the message, although probably just looking at the headers is enough.  And so right-click on the item, go to Properties, and then go to Details, and that�s where you�ll find your headers in Outlook Express.



Most, I would say all email clients, without knowing that it�s all, but it�s probably all, do give users some way to find your headers.  You might check under their Help or just browse through, you know, like the Edit menu or the Messages menu or whatever menu they�ve got to see if there�s something about, you know, show all headers, or show header, something like that.  It�s probably discoverable by anyone who wants to track that down.



LEO:  Oh, yeah, it�s always there somewhere, absolutely.  Joe McDaniel of Tallahassee, Florida, Go Seminoles � did you add that, or did Joe say it?



STEVE:  No, he did.



LEO:  Right.  They love their football in Tallahassee.



STEVE:  I don�t know who�s in Florida, Leo.  I don�t even know what sport that is.



LEO:  Well, probably this time of year it�s basketball.  Anyway, he says:  I was looking at your password page � that�s GRC.com/passwords, or password, or password.html, or any variety thereof...



STEVE:  Yeah, you�ve got this nailed.



LEO:  And a question occurred to me.  I use it all the time, that�s why, Steve.  If a strong hashing algorithm is being used to hash the user�s input down to a cryptographic key � okay, I�m going to have you explain that.  But is there any advantage or disadvantage to using a password that contains the full printable ASCII character set, versus one that only contains hex characters?  In other words, is a password containing the full ASCII set more robust than a password containing only the hex set?  He wants to know if dollar signs and asterisks and all the other stuff...



STEVE:  Right.  This was a great question because it gives people a way to think about � it�s one of the ways I�ve always approached problems.  So first of all, to back up a little bit, he�s talking about how on GRC�s passwords page you get this, you know, many different forms of strings.  I have a full ASCII characters.  I have one that�s zero through nine to A through Zs.  And then there�s one which is only hex.  And so presumably maybe things are able to digest the hex strings more easily or with less confusion.  He�s wondering would there be a reason to use the more complex, fuller character set strings.



The way I often solve problems is I, when I�m trying to get my handle on the answer to that sort of question, is I�ll take it to one extreme or another.  And so for example the idea being that, if you�re using hex characters, then you only have four bits of data for every character you�re using because you�ve got 0 through 9 and A through F, a total of 16 characters in the alphabet.  And so you�ve got four bits of data per character.  Well, if you use full ASCII, you�ve got seven bits for printable ASCII.  So you�ve got many more bits per character that you�re then stringing together.  Well, so going to hex means fewer bits per character.  Well, let�s take that further and say that we only used 0 and 1 characters � that is, essentially, one bit per character � and we had passwords that are 64 characters long.  Well, that means that we�ve essentially reduced the space of possible passwords to 2 to the 64th, which are then being hashed down to the cryptographic key.



So by taking it to an extreme, you can see that having a smaller alphabet does limit the number of possible passwords that you could be using, and therefore you could argue that it�s less secure because, if somebody was going to brute-force it, they�d have a smaller world from which they were trying to brute-force your password.  And somebody might, for example, glance at your password in the clear and notice that it�s all ones and zeroes and go, oh, that�s easier for me to crack than something that looks like your typewriter broke.  Which is, you know, what the full character set looks like.  So the answer is yes, having and using the full ASCII character set that gives you seven bits of randomness per character, so it�s 7 times 64, that�s going to end up giving you more security than using more limited character-set passwords.



LEO:  I guess the question is does it make a difference.  I mean, 2 to the 64th is still quite a few.



STEVE:  Yeah.  It doesn�t really matter.



LEO:  Okay.  Great.  Thanks a lot.  I mean, it�s one thing to say binary.  But, I mean, it�s not like your only two choices.  You do have a few more choices.



STEVE:  That�s absolutely true.



LEO:  He also says if it�s doing hashing.  Isn�t that even processing it more and making it completely random?  I mean, you can�t do a brute-force on a hash, can you?



STEVE:  Well, no.  In fact, what�s happening is we�re taking the large, you know, for example...



LEO:  It�s almost just a seed; right?



STEVE:  Well, WPA, for example, which is what most people are using these passwords for, WPA takes what you give it and hashes it down to a 256-bit key.  So you want to give it more bits than it�s going to be hashed down to, rather than fewer bits.  So if you did give it 64 characters of 4 bits, well, now you�re only giving it 256 bits, which are being hashed to 256.  So basically that would be creating a mapping.  There could be some overlap between the input and output.  So it�s better just to give the hashing algorithm as rich a source of entropy as you can.



LEO:  Now, that makes sense.  Brian �Da Hammer� � he probably prefers �DeHamer� � of San Diego has his thinking cap on.  He says:  I just listened to the Spoofed Spam Email episode, last episode, where you discussed how faked �Received� headers are used to try and mask the true identity of the mail�s origin.  You described how this sort of spoofing doesn�t hold up under close scrutiny due to the fact that each SMTP server will use the IP address of the server it receives a message from.  However, what if a spam bot were to initially add two �Received� headers to the outgoing message?  The first header would make it look like the message originated from GRC.com; the second header would make it look like GRC.com had passed it on to some other SMTP server.  The second spoofed header would of course include the actual IP address of the GRC.com SMTP server.  Wouldn�t this make it almost impossible to tell that the message did not originate from GRC.com?  In other words, spoof the �Received� twice.



STEVE:  In fact, many, many people, to the great credit of our listeners, many people � and that�s why I�ve included several questions that relate to this in today�s Q&A � really thought this through and came up with some clever, wait a minute, how about this sort of ideas.  And this is a perfect example.



LEO:  I love it.



STEVE:  I was saying that, you know, that a single header would be spoofed.  So they said, hey, what if you spoofed two?  Because then, if someone was smart enough to look at the first one and go, well, that might not be right, they might not be smart enough to look at the second one.  So the answer here would be to scrutinize the chain.  Remember that we were talking about how email moves from SMTP server to SMTP server.  And basically the �Received� headers � I�m not calling them �Received By� anymore � the �Received� headers would show you a chain which at some point is probably broken.  And it�s the break in the chain that would tell you, wait a minute, here�s where this thing really came�from.



LEO:  So...



STEVE:  So he�s right that adding a second spoofed header or more could make the task of figuring out where it came from more difficult.  But if a discontinuity were found in this chain of received headers, that would be a key that something wasn�t right somewhere.



LEO:  Ah.  So you�d still know something was wrong.



STEVE:  Probably yes.



LEO:  But that�s the point is that this is to fool people who aren�t really that savvy.



STEVE:  Exactly.  And it would be really good if people or servers really scrutinized the whole chain and said, wait a minute, this is fishy.



LEO:  They don�t, obviously.



STEVE:  Exactly.



LEO:  Thom in Cortland, New York raised his antenna and asked:  I have a question about Wi-Fi.  Recently I took my university laptop home.  Instead of a presentation, I started the system.  Instead of a presentation.



STEVE:  Ahead of.



LEO:  I�m sorry, I was misreading it.  Ahead of a presentation.  I started the system.  The laptop is wireless.  It automatically connected to an open hotspot in my building titled � oh, this is the Free Public Wi-Fi question.  I like this one.  I am certain � he got something, a hotspot saying �Free Public Wi-Fi.�  I�m certain there�s no free public Wi-Fi and recognize this to be likely a scam hotspot.  But I noticed it quickly; I shut the system down immediately.  Even though I shut it down so quickly, and there�s not any personal data on my machine, am I at any risk?  Is it likely the hotspot was even able to do anything nefarious considering the quick shutdown?  Do you  know the answer to this, Steve?  Because I do.



STEVE:  Go for it.



LEO:  This is actually not a scam.  When I first got this question on the radio, I said what you probably were planning on saying, which is it probably is a scam because there�s no free public Wi-Fi.  It�s actually a bug in Windows.  Did you know this?



STEVE:  No.



LEO:  Yeah, it has to do with...



STEVE:  And I�ve also seen that, so I was wondering, isn�t that a coincidence. 



LEO:  [Indiscernible].  Because if you�ve ever logged into an access point called �Free Public Wi-Fi,� it has something to do with infrastructure Wi-Fi.  I don�t know the exact details, and I�ll find the reference.



STEVE:  Ah, right.  I know, where you�re going machine to machine instead of machine to an access point.



LEO:  And this is actually, in a way, spreading like a virus because one guy apparently did it; right?  And then other people saw it and joined it.  There�s nothing there.  You can�t get any Internet access from it.  So they forgot it.  But it persists.  And it�s in your system.



STEVE:  It crept into your registry somewhere.



LEO:  It shows up on other systems, and it has now spread across the land, and there are quite a few places where you will get online and see something called �Free Public Wi-Fi.�  It is a Windows machine in infrastructure mode that at one point logged onto another Windows machine in an infrastructure mode with �Free Public Wi-Fi� as one of the hotpots it had been to.  I�ll find the article because I did some research when this person asked me the question on the radio.  And I answered it as you I�m sure were going to answer, which is, yeah, it�s probably not a good idea to join such a thing.



STEVE:  Right.  We can say a little bit more, although I think that�s very cool news.



LEO:  It�s fascinating, yeah.



STEVE:  We can say a little bit more about this issue in general.  That is, for example, if you were to find that your machine had automatically connected to a hotspot that you were suspicious of, first of all, answering this question, it�s probably not the case that just the act of connecting could be a problem, so long as you�ve got � probably you�re using Windows XP or maybe Vista.  But one way or another you probably have a personal firewall on.  So as we know, today�s exploits generally are people going out through a firewall asking bad stuff to come back in, or in the case of a Wi-Fi, people, for example, doing nonencrypted email log-on where their username and password are going out in the clear.  In both instances, the user is doing something with the computer, and somebody deliberately running a malicious Wi-Fi hotspot will be monitoring that.  However, with the firewall up, just the act of connecting to even something malicious, as long as you recognize it and shut down, it�s probably not � there�s no opportunity for you to be infected in the normal case.



LEO:  Yeah.  And to add to this, it is a bad idea in general to log into ad hoc networks.



STEVE:  Right.



LEO:  There�s a difference, and you can tell, whether it�s an infrastructure network or an ad hoc network.  And an infrastructure one is with a Wi-Fi base station and, you know, like at the coffee shop and so forth.



STEVE:  The normal style.



LEO:  Ad hoc is coming off of somebody�s computer.  So you really probably don�t want to join a network on somebody�s computer.  That would just be very trusting.  The reference I�m going to put on the website is from Dwight Silverman�s tech blog in the Houston Chronicle.  That�s where I saw it first.  It�s a great story, and it just � it�s a bug in Windows.  Microsoft says they plan to fix it at some point in the next XP Service Pack.  But who knows when that�s going to be.  Unknown whether it�s in Vista.



STEVE:  Interesting.



LEO:  Isn�t that weird?



STEVE:  Yeah, that�s cool.



LEO:  Chris Detrick of Westerville, Ohio has been watching some TV.  He writes:  I was watching TV the other night.  I happened to see the new Mac commercial � oh, I love that.



STEVE:  I do, too.



LEO:  It makes fun of the Vista User Account Control.  In the commercial the Windows machine says, I�m receiving a connection request, accept or deny.  And it goes on and on.  In fact, I�ll find it while you answer the question.  While I found the commercial quite funny, after thinking about it for a moment, the Mac does the same thing.  I own both a PC and a Mac, and I�ve used both Vista and OS X quite a bit.  They both require approval for system-wide changes, installing software and other similar actions.  If anything, the UAC in Vista is more relaxed because it doesn�t require a password.  It only seems more aggressive because the desktop fades away, and the UAC window is running in the foreground.  But I believe the effect is the same.  I�m wondering what your opinion is on the subject.  Is one better than the other?  You know, Bill Gates was incensed about this commercial.



STEVE:  No kidding.



LEO:  Yeah, he said they lie.  How are they allowed to lie like this?  Because he makes the same point.  We�re just copying what Apple�s been doing for years.



STEVE:  Okay, now, you know better than I do, Leo, because you have a lot more Mac experience than I.  But doesn�t the Vista UAC, the User Account Control, seem more in your face, seem to actually require more yes, this is what I want to do acknowledgements than the Mac?



LEO:  It does.  And I think some of that ad comes from the early beta versions of Vista, when it would do it all the � it was so bad, it would take four clicks to get anything done.  The actual shipping version of Vista is much less intrusive.  I don�t mind it.  And again, as a Mac user, I�m used to some of this already.  I don�t think it�s � if it�s more, it�s not much more.  And it�s not more intrusive.  Now, if it�s not asking you for a password, that means you�re running as an administrator.  And you might want to rethink that strategy.  You might want to start using a limited user account on Vista.



STEVE:  On the other hand, if you do that, then you will be asked for a password every time one of those pops up.



LEO:  Well, not every time, but every time there�s a system change.  There are certain rules about when it needs a password, when it needs to be an administrator to make the change.  Frankly, that�s what the Mac does, as well.  And I think that�s good.  Let me play, as long as we�re talking...



MAC:  Hello, I�m a Mac.



OS:  Mac has issued a salutation.  Cancel or allow?



PC:  Allow.  And I�m a PC.



OS:  You�re returning Mac�s salutation.  Cancel or allow?



PC:  Allow.



MAC:  Okay, what gives?



OS:  Mac is asking a question.  Cancel or allow?



PC:  Allow.  He�s part of Vista, my new operating system.  PCs have a lot of security problems, so he asked me to authorize pretty much anything I do.



OS:  You are pointing out Vista�s flaws.  Cancel or allow?



PC:  Allow.  I could turn him off, but then he wouldn�t give�me any warnings at all, and that would defeat the purpose, so...



OS:  You are coming to a sad realization.  Cancel or allow?



PC:  Allow.



LEO:  You�ve got to, I mean, it�s a funny ad, but I think Chris is absolutely right.  This is something Apple�s done for quite some time.  And frankly, I�d say it�s the number one reason that Macs have been more secure than XPs.



STEVE:  Well, yes.  And in all seriousness...



LEO:  Kind of disingenuous of Apple to make this ad,�frankly.



STEVE:  Right.  In all seriousness, one of the things I have said, and we will do, there�s much more technology going on in User Account Control than just that dialogue.  So we will be doing a Security Now! episode about the Vista�s User Account Control and really going on there because there�s a lot of technology there.  But, you know, this comes back to the fundamental security rule that we talk about often, which is there isn�t a way to achieve security in the existing structure without requiring some tradeoff with user convenience.  The browser scripting problem that you and I always tussle with is exactly that.  As you know, you want scripting on.  Turning it off and selectively enabling it is a pain in the butt.  But it�s the only way to browse without scripting on while still being able to go to some sites.  And similarly, the problem with Windows is that malware has access to everything going on in your system.  And of course this dialogue popping up is to give you some opportunity to intercept malware doing things behind your back, to make sure that this is something you�re really asking to be done.  And there�s no way to do that without asking you in the current model, unfortunately.



LEO:  Well, and I don�t find it onerous.  I don�t find it a�pain in the butt.  It�s a reminder to me that I�m doing something that�s modifying the system.  I think it should�ask.



STEVE:  And we got a good commercial out of it, anyway.



LEO:  It�s hysterical.  I mean, it�s a very funny commercial.  Tony Chen of Orlando, Florida wants to know how to best perform long-term data archiving.  He writes:  I work as a UNIX sysadmin, where security is only one aspect of my job.  It�s been noted many times in the podcast that, due to the high areal density � that�s the number of bits per square centimeter � of today�s hard drives, they�re constantly throwing out errors that the drive controller or firmware is correcting on the fly.  That�s that ECC you talk about, Steve.



STEVE:  Right.



LEO:  Do these errors only occur when the drive is powered on?  In other words, if a drive is sitting unused, outside a computer in a box, for instance, is the drive protected from degradation � maybe, but not humiliation � assuming it�s stored properly, without the firmware to constantly correct it?  I have automated backups to hard drives � oh, he�s worried about archiving things off-drive for fear they won�t be recoverable on a dead DVD-R.  At least with a hard drive I can use Disk Warrior on OS X or SpinRite to recover some, if not all, of my data.  So I guess what he�s saying is his method of backing up is to � and I know people who do this � back it up on a hard drive, put it in the shrink wrap, and stick it in the corner.  Is that better than putting it on a�DVD?



STEVE:  Okay.  Well, this brings up a couple issues.  There was some interesting dialogue on TWiT a few weeks ago that I caught that I thought was interesting because all the studies that I have read have said that recordable media is more reliable, for example, than pressed media.  That is, that pressed media, for example traditional DVDs, you know, regular consumer video DVDs, have been shown to have a long-term oxidization problem with their surface, which due to the different process used in recordable either CD-R or DVDR that those photo-based technologies do not have.  And so properly stored, everything that I�ve seen says that recordable media has more reliability over the long-term than non-recordable media, just from a disk, you know, an optical disk standpoint.



LEO:  We said it the other way around.  I probably...



STEVE:  Exactly.  Okay, so now in terms of long-term hard drive storage, the answer is, once upon a time there was a problem with something called �stiction.�  Stiction was a phenomenon where the head would essentially molecular bond to the hard disk surface because they were both so smooth.  The head was so smooth and the disk platter was so smooth that, if you turned the drive off over a long period of time, you would end up with the head literally just sort of welding itself to the hard drive.  And in fact, that�s one of the reason that heads park on the inner area of the disk.  They go to the inside spindle for two reasons.  One is that if the disk is bounced by mistake, you can imagine the platter edges are going to be oscillating wildly out on their perimeter.  But because they�re anchored at the spindle in the middle, there�s not much motion in there.  So you�d much rather have your head on the inside near the spindle mounting, where there�s not going to be much oscillation of the drive is bounced, than sitting way out on the outer edge flying back and forth and up and down.



Secondly, from a mechanical standpoint, the starting torque of the spindle motor needs to be much less to make sure that any stiction is broken to get the head loose of the platter as the drive starts up.  You can also imagine from just a standard mechanics of physics standpoint, if the head is way out on the perimeter, and if that�s where it�s sitting, it�s got a much greater mechanical advantage to keep the disk from starting up in order to overcome the friction between the head and the disk platter.  Thus heads are now parked on the inside of the drive as a much better place for them to stay.  I haven�t heard of stiction being a problem for a long time.  Back when SpinRite was young and people had this problem, the common wisdom was you powered your computer up, and then you bonked the hard drive with the handle of a screwdriver, literally to give it a little bit of a knock in order to shake the head loose from the platter.  And many times that worked for people.  But with current technology and new drive and head lubricants, that�s just not a problem�anymore.



LEO:  But I still hit my hard drive with a screwdriver...



STEVE:  Just bonk it a bonk, bonk it with a screwdriver. 



LEO:  I used to love that.



STEVE:  Keep those bits from getting too set in place.  It�works.



LEO:  It does work.



STEVE:  Back in the old days it did, yeah.



LEO:  And it was the best thing to tell people, oh, you got stiction, hit it.  And people go, what?



STEVE:  So this is one of the advantages of using, for example, a current technology removable Firewire or USB drive is you are able to plug it in, do some backups, and just stick that drive on the shelf.  To answer his question, you know, in the reasonable term, like 10, 20 years, there�s no reason that a drive would age in a way that would cause it to become less reliable when it�s just sitting on the shelf doing nothing.  You want to, you know, make sure you don�t subject it to temperature extremes for long-term storage.  But the drive would be much more stable that way than if they were in constant use where, as Google has shown, and we will be talking about next week, reliability really does start to suffer after a couple years.



LEO:  So sitting there, well, cosmic rays hit it and stuff.  But it�s not going to � you�re not going to lose enough data to make it something to worry about.  In fact, I think Alex Lindsay tells a story of somebody who, you know, hard drives have gotten so cheap, the video editor people who will just when the project�s edited and done, they�ll just take that drive, wrap it up, put it aside.  That�s the backup.



Eden Li of Beijing, China by way of Arizona has been paying attention.  He asks:  I am a long-time listener, first-time emailer.  I was listening to your latest episode about determining the origins of spam by using the �Received� email headers.  You mentioned that it was possible to determine that someone had faked a message from GRC.com by  putting in the domain name for the first received header.  However, because the IP address of the connecting machine was included, it was possible to prove your domain did not relay the message.  The domain name doesn�t match the number.  Since the sending agent can add whatever headers it wants, can�t it just fake a path with valid IP addresses from GRC to itself before sending it out?  This is kind of similar to the earlier question.  The path up to the malicious sender would look entirely valid since it controls the headers.  In this case, it would appear that GRC had sent the message to the sender, and the sender was just doing its duty by relaying it to the next server.  So kind of like a man-in-the-middle attack.  You put GRC first, and then put yourself in there underneath.



STEVE:  Yes.



LEO:  Is there any recourse against this?  Am I missing�something?



STEVE:  He is not missing anything.



LEO:  Oh, dear.



STEVE:  And this one wins the prize for the cleverest hack�around the way that we talked about last week of backtracking and determining a spoofed email.  Now, one thing that the vulnerability, of course � so first of all, just to quickly summarize this, rather than having a header saying that this originated from GRC.com that sort of just is there, and then the second header in a row would be added by the SMTP server that the spammer connected to, so that server would be able to see the connection from the spammer, he�s saying intelligently fake the very first spoofed email header so that it says GRC.com connected to their IP address so that the chain I was talking about when I answered a related question earlier, the chain of header would be unbroken, and it would literally look like GRC had used some random consumer�s machine somewhere else as an email relay, and that it was then relaying it.  And sure enough, that works.  Of course the giveaway is, if you looked at the IP range or did a reverse DNS lookup on the IP, you would see, you know, some Comcast.net IP, or, you know, basically a consumer-looking IP rather than a regular server.  So...



LEO:  And you would never send to that [indiscernible] to relay your mail.



STEVE:  It is a clever hack for getting around this notion of an obviously spoofed �Received� header.



LEO:  But I�ll tell you it probably never happens because nobody looks that closely anyway.  There�s no reason for a spammer to worry about it.



STEVE:  Exactly.



LEO:  Why go to the effort?  I mean, if we all started looking at our headers, I guess.  But we don�t.  And it doesn�t matter.  The spam still gets through.



Jeff P. of St. Louis, Missouri has learned to become more cautious on the �Net.  He says:  Listening to Security Now!, I�ve also learned to question things when they don�t seem right, which is what I�m doing now.  I recently logged onto my work laptop at home, connected by VPN, to do some work.  I opened an internal web location, http://something, that has always worked in this manner.  To my surprise, I get a Charter Communications search page � that�s his Internet service provider � that says �Page Not Found.�  I tried again, then another internal site, another, no luck.  In the past week I noticed on my home machines that 404 errors had been redirected to Charter.  I thought they were probably starting to proxy web traffic, or had been doing it but just now made it easy to see.  However, when on the VPN I thought all traffic would be tunneled to the corporate server.  Why is Charter seeing it?  I still get that Charter-served error page.  Even when he�s on VPN.  How is that possible?  I did go to GRC with and without the VPN connected.  It did report two different IP addresses.  From what I know, I can�t explain what is happening.  I can�t either.  This is interesting.  Can Charter proxy HTTP traffic when it�s connected as VPN?  Any ideas?



STEVE:  Well, we know that it cannot.  That is to say that, if you�re trying to go through a VPN, or your traffic is going through a VPN to your remote destination, that no one can proxy that connection in the way that it�s happening.  That is, you ought to be able to get a connection into your corporate network, and it would be an encrypted tunnel that is impenetrable.  Listening to this, the two things I would ask Jeff to check would be his browser�s proxy settings.  There have been various attacks where proxying was turned on.  So if his browser is not just using his raw Internet connection, but is for some reason running through a proxy, it might be possible, depending upon the way his VPN is configured, for him to still be using his raw, non-VPN traffic.  And when he thinks he�s going to his internal site, he�s actually going to the external Internet; and then Charter is saying, wait a minute, we are now unable to find this, and giving him an error message.  So the first thing I would look at is the proxy settings on his browser.  Secondly, check your hosts file.  This, you know, this happened in the last week or so, and it�s new behavior.  It�s possible that something may have crept into the hosts file and is messing up the DNS resolution on his system, basically trying to intercept traffic and route it somewhere�else.



LEO:  There�s one other thing I would mention.  A number of�� I�ve seen this on a number of VPN clients, and I�m actually just launching a couple now, just to see � allow you to route web traffic not through the VPN.



STEVE:  Deliberately.  Yes.



LEO:  Deliberately.  So in fact you�ll see a checkmark in the settings that says something like route all traffic through VPN, and that I would suspect as being unchecked, or it would say do not route web traffic through the VPN.  Clearly it�s not being routed through the VPN.



STEVE:  Right.



LEO:  So but I think that it�s not necessarily something nefarious.  I think that that is a setting in some VPN�clients.



STEVE:  Cool.  Then certainly look for that, Jeff.



LEO:  And that makes sense because, if you�re surfing the �Net, and you just want to surf the �Net as opposed to using the corporate network for transferring files, you might not want to go through the overhead of going all the way to your�office.



STEVE:  Well, and moreover they might, by policy, they might not want you to use that much bandwidth over their VPN server.  They might want to reserve that for email and just, you know, internal corporate stuff.



LEO:  Yeah, excellent point.  Let me just � I�m just going to look in my � I have a Cisco VPN client running here.  And I�m just, out of curiosity � I�m pretty sure I�ve seen this as a choice in a lot of...



STEVE:  I absolutely have.  When you talk about that, the name on that setting, it seems very familiar.  And I�ll bet Jeff�s going to go, oh, that�s exactly what it was.



LEO:  Of course.  Now, he raises another interesting thing which I think we should talk about, and you�re seeing this more and more.  When you use a company�s DNS servers, it�s possible to configure them to handle a 404.



STEVE:  And in fact, of course, we know that, what was it, VeriSign that got famously in trouble because they ended up redirecting unknown domains to their own, you know, commercial advertising page, essentially.  And, you know, the whole Internet community got very upset with that.



LEO:  Yeah.  That was wrong because they�re just a registrar.  They�re not your service provider.  The same thing happens with OpenDNS.  If you use � in fact, I think that�s how OpenDNS monetizes itself.  If you use, instead of your ISP�s DNS server, if you were to use OpenDNS, one of the advantages of it is OpenDNS does a very good job of trying to guess what you were trying to say when you type in an address so it can fix a mistyped address.  If you typed .CMO instead of .COM, it�ll fix it.  But also if you type a 404 it�ll give you actually a very useful search page.  So it can be a positive.  But that�s important to know, that many ISPs are starting to do that.  And they do...



STEVE:  And they have that power.



LEO:  Yeah.  And they do it because they put ads on there; right?  That�s what VeriSign was all about.



Ted Hosmann of Monterey, California has been thinking about email spoofing.  Who hasn�t?  I have a question regarding the spam backtracking episode.  You had mentioned that in some cases the received headers in email can be many, based on how they�re routed to the final destination.  Is there a chance that more than one email header could be spoofed?  Say 10 or 20 or 30 headers before you�ll find the source of the zombie machine?  Wouldn�t it make sense to throw in a number of headers from which spam could be coming from, in a red herring-style attack?



STEVE:  Yeah, I mean, there�s another creative approach is to literally bury yourself in a whole bunch of spam headers.  Now, again, it�s the last header in that group that is going to be the real connection point to the email as it moves to its first SMTP server because the destination SMTP server will add the top received header to the existing pile of them.  But and so there�s no way for a spammer to bury its received header among others.  But it certainly could confuse the issue just by having a bunch of them.  And, you know, just make some poor recipient�s eyes cross when he thinks he�s going to be tricky and look at the email headers and just sees this whole nest of them.



LEO:  There�s two morals to take away from this.  One is that SMTP is hideously insecure.  I mean, it does nothing to validate headers.  Zero, right?  It just, I mean, you could do anything you want.  But I think also spammers don�t even bother because, so what?  So what if you figure out it�s�spoofed?



STEVE:  Well, yes.  And in fact, we�re probably guilty of being so much overboard on the technology relative to the value of the content of the junk that�s being sent out.  I mean, it�s phenomenally amazing to me that spam still works.  These spammers are making reportedly an amazing amount of money just by spewing all this junk out on the �Net.  It�s like, who clicks on that stuff?



LEO:  Well, in the last analysis, that might be the best way�to fight spam is not to do it.  Don�t buy anything from�them.



STEVE:  Unfortunately, it is so cheap to send this stuff, especially now that we�ve got spam bot networks.



LEO:  Yeah, they�re free.  Well, you have to pay some hacker, but that�s about it.  Yeah, in fact, don�t even � I think a lot of people say, oh, well, let me click � I can click the unsubscribe link; right?  No.



STEVE:  All that does is validate that you exist.



LEO:  Don�t click anything.  Todd Zervas of Riverside, California has crucial files he wants to protect.  I�m very tempted, he says, to use one of these online backup sites to backup the files from the computers at my house.  Making DVDs at regular intervals is a pain, and I have to move them offsite in case the house catches fire and melts all my pretty backup disks.  Well, he�s got the right idea.  I think offsite backup is really important.  He says:  I do fear these online backup sites.  How do I protect my data from them?  If I back up all my computer�s data to these online sites, can�t the operators look at my files?  I�ve got financial information on one of my PCs.  My daughter is writing novels on another.  Can I trust the encryption on these online backup sites?  Can I add my own encryption and not give them the keys?



STEVE:  Isn�t that a great question?  I love the question.



LEO:  You�ve got to trust some of these guys, though; right?



STEVE:  Well, I would add one more thing, and that is, if they have the ability to decrypt, then they could be legally compelled to do so.  And I ought to tell you, I actually have the domains cryptkeepers.com because I�ve been interested in the idea of providing secure online backup services.  Not like I have � believe me, Leo, it�s not on the list of things I�m going to do.  But I grabbed those domains a long time ago because I liked this idea.  I don�t know if it ever makes economic sense with hard drives becoming so cheap and with things like BitLocker and, of course, TrueCrypt being available.  But it is an interesting�alternative.



So to answer Todd�s question, again, it�s not so much that I would worry about malicious intent on the part of the backup sites.  But we know, especially with everything that�s been going on with the Patriot Act in the U.S. and concerns about what subpoenas could be issued, I would be very concerned about even a reputable company being subject to a subpoena and compelled to decrypt somebody�s offsite backup under court order.  So what you want is you want a technology where you are absolutely sure you�re giving data to people, and there�s no way they can use it, that the data is just an opaque blob.



And thinking about the answer to this question, I thought, hey, you know, TrueCrypt would be a perfect solution.  You configure TrueCrypt in that mode where it uses a file as its container, and then you mount that as a drive.  You see a drive from your perspective.  On the outside, the operating system just sees a file.  That one file is then what you keep synchronized with your offsite backup facility.  Anytime something happened, you would be able to get that file back and apply your TrueCrypt passwords in order to decrypt it.  Only you in the world would be able to make any sense of that file.  And it�s just a cool solution because basically you see a drive letter.  Everything that you�re storing there is encrypted in that container, always stored, as we know the way TrueCrypt operates, always stored in an encrypted fashion, never in the clear.  And so that one file, anybody can have it, essentially.



And in fact, as we talked about a long time ago when we were talking about TrueCrypt, it�s exactly what I do for my precious cargo.  I burn TrueCrypt containers onto DVDs and send them to my attorney and to my mom.  And I just know that that stuff is out of here, I can always get it if I need to.  But if their home or office was burglarized, I�ve lost nothing because nobody else can make use of that data.



LEO:  I�ve become a kind of fan of these offsite backups.  In fact, Carbonite, which is one of them, a really good one�� it�s a sponsor of the radio show, so a disclaimer there.  But the reason I like that is because it�s in the background, it�s doing it all the time, it�s always backing up.  And I�m backing up podcasts, I mean, I use it because I backup our raw tracks of the shows and the podcasts so that nothing gets lost.  You know I�ve lost some podcasts, and it�s been very embarrassing.  So this has been a boon.  I don�t care if somebody, some government agency wants to hear the podcasts, so I�m not going to encrypt that.  But it makes sense to do that for your financial data.



I am looking at Carbonite�s privacy statement.  And certainly before you use any of these services you should read their privacy statements and make sure they�re verified by an independent third party.  But one of the things they say is � they do encrypt, they encrypt with SSL, and they have all the security on the facility and stuff.  But it says Carbonite will not share your encrypted files with any third party unless such action is necessary to comply with a government or court order legally compelling us to do so.  So I�m sure every one of these services has a statement like�that.



STEVE:  Right.  And so from the consumer watch standpoint, you simply give them a pre-encrypted blob.



LEO:  And there�s nothing they can do.



STEVE:  And nobody can ever do anything with it.



LEO:  They�ll comply with the court order.  They�ll give the court order the unencrypted data, removing their encryption.  But the court can�t do anything.  Now, the court can come to you.  That�s between you and the court.



STEVE:  Exactly.



LEO:  Mark Frautschi in Rockville, Maryland is wondering, how do spammers get our email addresses in the first place?  Could it be that our friends, families, and colleagues are unwittingly turning our addresses over to the spammers and malware writers? 



STEVE:  You know, we had never really talked about this.  And I know that a lot of people probably have a sense for how this happens.  I have some experience myself running an SMTP server, which I�ll share.  But one of the things that makes me cringe, Leo, more than anything else is when someone I know who has my cherished and protected email address uses a website to send me something.  You know, like, oh, your Valentine has sent you a Valentine�s Day card.  Oooohhh, Mom, don�t do that.  Because there they�re deliberately giving your email address to some website that now has it, and lord knows what they�re going to do with it from there.



LEO:  Yeah.  And it may be Evites, fine, I�m sure it is, or Egreetings.  But who knows?  And Mom didn�t check.  Mom didn�t read that privacy policy.  So it is true, that�s probably one way.



STEVE:  And certainly websites are being scraped.  The other thing we knew from the way GRC�s email addresses used to be getting out was we would be getting lots of spam to our support and sales email accounts, even though those were scrape-protected on our website.  What was happening was, people who had written to GRC Support or Sales, they would get some malware on their machine that was scanning their machine for other email addresses and combining them into a master database.  So it�s certainly the case that malware, one of the things malware has done is mail stuff out.  Well, we know many viruses like this in the old days that you�d get your machine infected with, and they would send themselves to everybody in your address book.  So that same kind of scenario is now being used by spammers.



The one thing I would add, as an operator of an SMTP server, I�ve watched the traffic on my server carefully.  And it�s phenomenal, I mean, doing packet captures, you will see remote SMTP spam servers connect to any other SMTP server, TWiT or GRC or Amazon or anybody, and just sit there guessing.  I mean, literally alphabetical dictionary lists of names, they just go, you know, albert@grc.com, andrew@grc.com, anyone@grc.com.  And they just go through the list.  So the one thing I would say to anybody is, if you ever change your email address again, change it to something unguessable, not something that�s probably going to be in someone�s dictionary somewhere, because back when I was just steve@grc.com it was not pretty, Leo.



LEO:  No.  I get mail to leoshair@leoville.com.  Oh, no, I get several thousand messages a day.



STEVE:  Leoshair is an account that you have?  Or do you have a wildcard account, so anything...



LEO:  Well, what happens is the mail service that filters my spam, I use a commercial company called MailRoute, knows what my canonical, my good addresses are, and only forwards me mail to those good addresses.  But it gives me statistics on all the other addresses.



STEVE:  I see.



LEO:  And besides Ann and Sally, I get some to Leoshair.  My�thinking is somebody who didn�t like me added it to some mailing list somewhere, and I�ve been getting stuff.  So maybe it was my mom.  I don�t know, Mark.



Jim Etherington of Ottawa, Canada writes � is this our last one?  No, we�re going to have...



STEVE:  This is #12, but we have a closing comment.



LEO:  Closing comment.  I�ve been a longtime fan of GRC from reading the interesting security articles and trying the freeware programs to using ShieldsUP.  I�ve listened to every single Security Now! podcast from the very beginning, and I have bought and used SpinRite 6 to keep my hard drives working.  This is the kind of guy we like.  My question is, how good is port knocking as a security measure to selectively allow connections to closed ports in a router?  Oh, port knocking, this is something I�m starting to hear about now a little bit.  Thanks for doing a great job with the podcast, and look forward to hearing more.  What is port�knocking?



STEVE:  I am so high about port knocking.  It is a very, very cool solution.  It�s had some bad press because people are attacking weak implementations of port knocking, saying that port knocking is bad.  But it�s just very clever.  And in fact, I�ve been considering using it in some fashion for my own security because it can be really bulletproof.  The idea is you�ve got a router with all ports closed.  If you want, from the outside, say that you�re a telecommuter, and you want access into your network, with port knocking you would send a pattern of packets, a sequence of packets to specific ports on your router.



LEO:  A sequence known only to you.



STEVE:  Known only to you.



LEO:  It�s like da, da da da da da, da da [to the tune of �Shave and a Haircut�].



STEVE:  Exactly.  And it could be as long and arbitrary as you want it to be.  Of course, as we know, the longer the sequence, the less chance anyone�s going to be able to guess it, blah blah blah.  And with 65,535 possible ports, that is to say, essentially 16 bits per port, if you just did four packets, now you�re at 64 bits.  And if you do eight packets, you�re at 128 bits of equivalent security.  The idea being that the router notices the sequence of packets that it�s rejecting.  Remember, you have your router running in full stealth mode so it�s blocking these packets.  But even though it�s blocking them, it can still sense them.  It�s still receiving them.  So you send a specific sequence of packets from your IP, your router or some software running behind it, maybe for example reading the router log in real-time, it sees a given IP has sent a matching sequence of packets, and it says, oh, this must be somebody who knows the secret knock.  And so it then alters the router�s configuration on the fly to allow inbound traffic from that IP.  I mean, there�s just nothing wrong with this, Leo.  It�s a tremendously clever idea.



LEO:  I�ll have to ask, I bet it�s the kind of thing Astaro�s Security Gateway would implement.



STEVE:  That�d be � oh.



LEO:  They�re very up-to-date.  You know, the new 7 came out.  This is a commercial, by the way, right now.  Just for those of you who are...



STEVE:  That was a smooth segue, Leo.



LEO:  ...a little puzzled by the segue.  No, it just made me think of this, and I thought, well, let�s do the � Astaro, of course, has been a sponsor of the show for quite some time now.  Last 30 episodes, something like that.  And through the rest of this year.  And we�re just really thrilled.  They did just update to Release 7.  And I�m wondering  � of their Astaro Security Gateway software.  And I�m wondering if that�s � they added so much new stuff, including � and we talked about this before � transparent email encryption and decryption.  So it happens at the gateway, so users don�t even have to worry about it.  It�s automatic.  Digital signatures.  It�s based on S/MIME or OpenPGP.  Really slick.  There�s also a secure remote access via SSL built into its VPN, so that�s much easier.  SSL VPN is so slick.  So now IPSec, L2TP over IPSec, PPTP tunneling with SSL, you�ve got it all.  In fact, I think it�s the only UTM appliance on the market with this kind of flexibility and VPN and remote access.  You can cluster them so you can scale.  I mean, it just goes on and on.



Try it, v7, in your business.  A free trial is waiting for you.  All you have to do is go to Astaro.com.  And now the best news for you noncommercial users.  And I�m really pleased to hear this.  They continue to offer the home use package absolutely free; but now with v7, not only do you get the software absolutely free, you get the base license, all subscriptions, and Astaro up-to-date, the complete set, free.  They used to charge 79 euros a year for this.  It�s now absolutely free.  That�s limited to 10 IPs, 10 users, and a thousand concurrent connections.  But basically this is such a good deal.  Try Astaro v7.  And if you�re a noncommercial user, you�ve got to check it out.  Astaro.com, or you can call Astaro and get a free trial of the Astaro Security Gateway appliance in your business:  877-4AS-TARO.  And I will ask them about port knocking because I wouldn�t be surprised.



Anyway, port knocking.  Is that something that�s brand new?  Because I hadn�t heard about that till very lately.



STEVE:  It�s been around for the last year or so.  You need something on the client side to generate the knocks.  And that�s kind of tricky because you�d really like to use, well, you�d like to use some sort of raw packet technology.  But there are ways to do that with UDP packets, where you�re able to aim them at your IP on the fly.  And so you need something at each end.  I just think it�s very clever.  I mean, what you could also do is just use a single packet containing your own, basically, a password as long as you want.  And just when the router sees any packet, it takes a look at it, and it checks to see whether it�s your magic authentication let-me-in packet, and then takes off from�there.



LEO:  That might be a little more risky because couldn�t somebody intercept and catch that?



STEVE:  They could, except that then what you would do is to�take care of that you would base the detailed � actually I�ve given this some thought, Leo, because I really find�it...



LEO:  You�re going to implement it, aren�t you.  You�re going to do it.



STEVE:  I�m thinking about it.  What you would do is you would base the content of the packet on your current source IP and port.



LEO:  Perfect.  So you [indiscernible] IP address or�something.



STEVE:  Exactly, and nobody could spoof � no one could get a connection that spoofed your IP because they would be at a different IP and would never be able to � so basically it would really allow traffic only from that remote IP.



LEO:  Unbelievable.



STEVE:  It�s kind of a cool idea.



LEO:  A closing comment from an avid listener, Paul Fisher, with Hughes in Illinois.  He says:  In Episode 79 of Security Now! you mentioned that two thirds of all mail on the Internet is spam.  That�s what we�re hearing from a lot of different sources, including some of the companies that actually filter the stuff.  He says:  You probably have access to better information than I do.  But I thought you might be interested in another data point.  The mail servers at our company � Hughes is huge, 35,000+ worldwide users � has a spam rate of, get this, 99.7 percent.  That is 99.7 percent of all email bound toward our email servers is identified and blocked as spam.  We get very few false positives and very little complaints from users receiving unwanted spam in their mailboxes.  It seems unbelievable, but that�s what our servers have seen for some time.  I really enjoy the podcast, hope you continue it.  I�m also happy that you can force Leo to do one every week.  He knows that I�m a lazybones.  It�s the one TWiT podcast I can always rely on.  Fortunately, I have no stories for you about SpinRite.  I own a copy, but I�ve never had to use it.  I�m hoping just owning it will keep my drive from going bad.  Yes, you�ve terrorized your drive.



STEVE:  That�s right.  If the drive knows you�ve got SpinRite nearby, it�ll say, okay, I give up, I give up, I�ll keep working.



LEO:  I�ll keep working.  Actually his number matches my number.  But I think when they say 70 percent of all mail worldwide is spam, that�s a conservative number.



STEVE:  I think so, too.



LEO:  I�m much more like 99.8 or 9 percent.  In fact, I think it�s 99.9 percent.  It�s awful.  But fortunately, the good news is there are good technological solutions that get rid of � good filtering solutions that get rid of most of the spam.  Most spammers don�t make much of an attempt to hide their spam.  And those that do get through, but...



STEVE:  Yeah, because they�re just on the shotgun profile.  It�s just like we�re going to send this to as many gazillion people as possible, and a few of them will get through, and that�s going to pay the bills, so.



LEO:  They don�t care.  Sons of guns.  Well, Steve, we�ve come to the end of another mod-4 episode.  Boy, this was fun.  So much interesting material.



STEVE:  Yeah, we�ve had some great feedback from the Q&A people.  And I ran across a number of pieces of email that I sort of like as this closing comment thing, so that we may add that as a feature to Security Now!, just so we can begin to, when they�re relevant and interesting, include some of our listeners� comments.



LEO:  We do listener mail in every episode of the Daily Giz Whiz, and it�s in many ways one of the most fun parts of the�show.



STEVE:  I think it�s a great idea.  And next week we�re going to talk about this amazing study that Google did on what they discovered about the reliability of their monster hard drive farms that they�ve got that runs Google, by popular request.  I was going to make a little mention of it this week, but so many people wanted more coverage that I said, okay, let�s do that.



LEO:  Oh, absolutely.  I mean, this is an area where you�re probably one of the top experts in the world.  So it�s absolutely something we should talk about.



Steve, we�ve come to the end of a fabulous episode.  But it�s not over.  You can get more at GRC.com, that�s Steve�s site where you�ll find SpinRite, but also all of his great free security utilities, now the 48-million-user � there are not many people who could say that anything they�ve done have 48 million users.



STEVE:  And I have to say that�s a really clean number.  I go to the trouble on ShieldsUP of maintaining a list of the most recent 4K, that is 4,096 users.  So anyone who�s poking around the site, using ShieldsUP for several hours, half a day, I am not multiply counting them.  If their IP is already in the list, I just move it to the top of the list and only � so basically I�m only counting people who are gone long enough to have their IP fall off the most recent 4,096 users.  So it�s a really good number.  And you�re right, 48 million is very cool.



LEO:  That�s just amazing.  Also we�ve got 16KB versions for the bandwidth-challenged, and Elaine�s great transcriptions so you can read along.  In fact, we�d better wrap this up so Elaine will...



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#81

DATE:		March 1, 2007

TITLE:		Hard Drive Unreliability

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-081.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Leo and Steve discuss the distressing results and implications of two recent very large population studies  (more than 100,000 drives each) of hard drive field failures.  Google and Carnegie Mellon University (CMU) both conducted and submitted studies for the recent 5th USENIX conference on File and Storage Technologies.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 81 for March 1, 2007:  Hard Drive Reliability.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Nerds On Site, helping people with technology all over the world.  Visit Iwanttobeanerd.com.



This is the Security Now! I�ve been waiting for for a while.  Leo Laporte here.  Steve Gibson is in his laboratory watching hard drives spin.



STEVE GIBSON:  That�d be SpinRite.



LEO:  SpinRite, they�re spinning right there.



STEVE:  Spinning right and spinning wrong.



LEO:  Have you turned off all the noisemakers?



STEVE:  Ready to go.



LEO:  Someday I want you to leave them on.  That�d be fun.



STEVE:  You�d be able to hear Fred Flintstone say �Yabba dabba do� every so often in the background.



LEO:  That�s when you get a new registration for SpinRite and different sounds for different people�s emails and...



STEVE:  Ah, yes.



LEO:  Do you have any really rude sounds for anybody?



STEVE:  No, I�ve got some friends who have totally gone sound happy.  I�ll be talking to them on the phone, and it�s sort of like people who have disco music for their ringtone on their phone.  It�s like, oh, what happened to a simple little chime?



LEO:  You know what, after a long time playing with ringtones I finally went to the �nostalgia� ringtone which is basically a phone ringing.  And it�s not so bad.  And nobody looks at me funny when my phone rings.



STEVE:  Exactly.



LEO:  Last thing I had was the Call For Help theme.  That really put it over the top.  That was it.



STEVE:  When the phone starts doing a cha-cha all by itself, and then keeps on going.  I mean, you know, meanwhile some embarrassed person is fumbling through their briefcase or through her purse or something because it�s like, okay, well, we all know.



LEO:  Well, if it�s on the table and the vibrate�s on, it might quite literally be doing the cha-cha right across the table.  I�ve seen that happen, too.  Hey, we want to welcome a new sponsor to the show.  We�re very glad to have them.  You had coffee with them when you were up in Toronto last time.  They�re worldwide.



STEVE:  They have been Security Now! followers from the beginning, Leo.



LEO:  I�m so glad.  Their name is Nerds On Site, don�t laugh, Nerds On Site.  And their specialty is helping people with their technologies.  Now, in the past you�ve thought, oh, I would like to get a consultant to come in, somebody who would help me troubleshoot my system or help me configure it or set it up.  But you�ve wondered, how can I know whether they�re any good or not?  And that�s really kind of the problem.  That�s why you�re going to love Nerds On Site.  All Nerds on Nerds On Site are independent contractors, but they�re certified, and they have a University of Nerdology.  And in fact they�re looking for new Nerds.  So that�s one of the reasons they wanted to buy some ads, because they want to tell you that, if you want to be a nerd, you can.  Nerds On Site is in Canada, U.S., Mexico, England, Australia, South Africa, and Bolivia.  Wow.



STEVE:  Well, you know, the question I get all the time is, how do I know if my computer has malware or spyware on it?  And it�d be neat if you were able to say, oh, just call a nerd, and they�ll come over and fix it for you or check it out for you.



LEO:  They have over 250 core competencies ranging from systems architecture design, I mean, high-end stuff, software development, on-source IT departments, to desktop support.  And even, yes, they�ll come to your house, residential or small business IT services.  Whether it�s Cisco, Oracle, PC or Mac, they need it.  Fix-it technicians, website designers, programmers, project managers, sales, trainers, security experts � I know there are a few of those listening � antivirus gurus.  Just go to Iwanttobeanerd.com.  Iwanttobeanerd.com.  And by the way, there�s a video there of their coffee with you, Steve.



STEVE:  Yeah, I spent, I think, about four hours with them last time I was in Toronto to come up and do the Call For Help show with you, Leo, because I had some time, and I had never met them person-to-person, although we�d had some interaction in email and in teleconferences.  So it was really fun.



LEO:  And there�s pictures on there of their cute little red Volkswagen bugs with the Nerds On Site logo in U.K. and Australia and South Africa.  I just think it�s neat that they�re global.  This is our first � actually not really because I guess Astaro is also a global company.  That�s the neat thing about podcasting.  We get the global companies.  Go to Iwanttobeanerd.com, and you can take the �Are you a Nerd?� test.  And we know you�ll pass.



STEVE:  Qualify.



LEO:  And we thank them for supporting Security Now!.  So before we get into the meat-and-potatoes of our episode � which is going to be about what, Steve?



STEVE:  We�re going to talk, as we promised last week, about�the implications and results of Google�s really interesting study into their findings about the hard drive reliability within their network of hundreds of thousands of�hard drives.



LEO:  Oh, excellent.  Excellent.



STEVE:  Yeah, really neat topic.  And, you know, it�s not mainstream Internet security or PC security, really.  But so many people wrote to me, and even to you, after this Google study in PDF form came out, saying, oh, would you guys please talk about this?  It�s like, yeah, we can certainly spend a week on this.  So that�s what we�re going to do.



LEO:  I think it�s fascinating.  And we should point out, Steve�s a security expert, but really I knew him first, well, first I knew you as a designer of the light pen for the Apple II.  But after that I knew you and have known you for years as a hard drive expert because of SpinRite.  So this is really your area of expertise.



STEVE:  I will never forget, Leo, that episode of, wait, it was The Screensavers, where you and Kate were standing side by side with a computer.  And you weren�t sure what she was going to be talking about.  But she had some sort of like a Kate�s Discoveries segment or something like that.  And that�s when she discovered ShieldsUP.  And so she�s talking about this, there�s this really cool site done by Steve Gibson.  And I think you were sort of looking off-set or something and didn�t really hear her.  And then you realized she was talking about me.  And you said, �Wait, Steve is doing Internet Security?  I thought he was hard drives.�



LEO:  Yes, exactly.



STEVE:  It was really fun.



LEO:  When did that shift happen for you?



STEVE:  It was at a point when the company sort of was going along, SpinRite was doing fine, and we were setting up an ISDN line to our office for the first time to have that level of connectivity rather than all just having modems.  And I remember scanning the neighborhood around the IP address we were given, and I found all kinds of C drives, back in the wide-open Windows Filesharing days.  And I thought, my God, there�s no way people know their C drives are on the Internet.  And so I said, okay, I�ve got to do something about this.  And I launched the whole ShieldsUP�idea.



LEO:  That�s fantastic.  Well, we�re going to talk about hard drives in a bit; but first let�s cover some errata, some follow-ups.  In fact, there�s some very interesting stuff to say about our last show.



STEVE:  Well, yes.  In fact, we received a piece of email that reminded me that XP has a default setting � remember we were talking about this notion of infrastructure networks versus ad hoc networks.



LEO:  We were talking about wireless networks.  You can have one with a base station, which is infrastructure.  But you can also use your laptop or even desktop as a base station, in effect, and that�s called an ad hoc network.



STEVE:  Right.  In fact, Windows refers to it as computer-to-computer, sort of to explain to people, I think, more what they mean, rather than saying ad hoc.  Anyway, the ad hoc networks are a problem.  And I had seen several security issues relative to this even before the issue came up last week, like for example people getting infected on airplanes because a bunch of travelers are using their laptops; and, if the laptops are able to connect to each other, there are viruses and types of malware which use ad hoc networks to do cross-computer infiltration.



LEO:  So the kind of interesting thing is that that connection is the default.  It�s automatic.



STEVE:  Yes.  Thank you, Microsoft.  It is the default for XP�to connect to either type of network, either to an access point or to another computer.  So what I�ve done is, on the notes page for this episode, Episode 81 � I�m excited here, Leo, we�re heading here towards #100, the big 100 episodes under our belt.



LEO:  We�ll have to have a party.



STEVE:  So on the notes page I have step-by-step instructions showing how you can click on your wireless connector icon down in the Windows tray and step through a couple clicks to get to the dialogue where you�re able to say I only want to connect to infrastructure networks, not both ad hoc and infrastructure.  And it�s really the case that this is wrong.  And this is one of those things that XP should really be defaulting to infrastructure-only.  But again, in the interest of compatibility and not having people call Microsoft and ask them why they can�t connect their computers together, Microsoft has it set so that you can connect to anything, even though most people, I mean, almost all people are connecting to an access point, a so-called �base station,� rather than wanting to go computer-to-computer directly without going through a base station.



LEO:  But let�s underscore, it�s dangerous to just willy-nilly connect to another computer without asking.  And so you do want to disable this.  The default is to have it turned on.  I want to thank Evan Katz.  I don�t know how you found out about this, but Evan...



STEVE:  Oh, I think it was Evan, yes.



LEO:  Yeah, from Manhattan, who sent me the email, and I�forwarded it on to you.  Actually he sent it to support,�sales...



STEVE:  Oh, I got it from every direction, Leo.



LEO:  Every address he could think of for you.  And he talks step by step � in fact, it looks like you�re using his screenshots.  He gave us some great screenshots.  So thank you, Evan, for that tip.  Now, what about Vista?



STEVE:  Good question.  I dug around in Vista for about half an hour.  It�s still a frustrating experience for me, Leo, because I�m not using it mainstream myself.  I don�t expect I will for a while.  But I could not find a similar thing in Vista.  Maybe Evan will write to us again and tell us where it is in Vista.  Although those are my screenshots.



LEO:  Oh, they�re yours.



STEVE:  I didn�t see the ones that Evan sent.



LEO:  Of course they look the same because they�re the same dialogue.  That�s the source of my confusion, all right.



STEVE:  Exactly.



LEO:  I�ll give you credit for that.  So we don�t know in Vista; and if somebody knows, I�d love to hear about that.  And I will dig around a little bit, too, because I have a Wi-Fi laptop on Vista.  And I certainly don�t want that on.



STEVE:  No.  It�s something that no one should have on.  So it is something that we wish XP had defaulted to off.  And then there wouldn�t be this bizarre, as we discussed about it last time, this strange Free Wi-Fi...



LEO:  Free Public Wi-Fi, yeah.



STEVE:  Free Public Wi-Fi that is literally jumping from machine to machine because it ends up being enumerated as available networks, and then it gets stored in the registry, and then that machine will enumerate it to the next one.



LEO:  It�s not a virus, but it is viral in the way it spreads.  It�s kind of interesting.



STEVE:  There were two other little articles that I picked up in the SANS newsletter this week that I just wanted to share with listeners that I thought would find that sort of interesting, and in some cases distressing.  The first is interesting.  A man is facing prison � this was picked up by USA Today had the story.  It says the subject is �Man Faces Prison for Uploading Movie to the Internet.�  What happened was, this guy, Salvador Nunez, Jr., his sister is an Oscar screener who received a copy of � I had it right here in front of me, I�m sorry � the movie �Flushed Away,� the animated �Flushed Away� movie.  Because she got a screener copy, it had a digital watermark in it.  She gave it to her brother, who unfortunately thought, oh, let�s share this with everybody else and so uploaded it to the Internet.  And someone sent a note to the authorities, who found it and tracked it down, were able to backtrack it to her, and he confessed that, yes, he had uploaded it and one other movie to the Internet.  So he got caught in a way that was directly trackable due to the fact that there was a digital watermark, a unique digital watermark, in the copy of the movie that he had received from his sister.



LEO:  They started doing that last year or the year before because they had a real problem with screeners leaking out.



STEVE:  Right.  The other story is worrisome.  It turns out that law enforcement in Germany � I was thinking about this again when you were talking about how we have a global audience.  Law enforcement in Germany is using custom malware to infect the computers of people they want to surveil without their knowledge.



LEO:  Now, to me, well, certainly in the U.S. that would be illegal.  And to me that seems really, really creepy.



STEVE:  Well, it�s aggressive.  And in fact the story came to light over the � Register.com carried it because a German magistrate denied the German police the right to do this.  They apparently went before the court and said, you know, this is what we want to do.  And he says, no, this is an unreasonable thing for you to ask.  It turns out that there is a division, however, that is still working.  It�s now called the German Trojan because it�s going to be installed in people�s machines if the police are able to do this.  And apparently there�s a bill that is getting ready to be put through that will make this legal, which has sort of resolved this gray area that it�s in right now, and allow the German authorities to install this in people�s machines.  I don�t know, it�s not clear to me how they would get it into a machine.  That problem still needs to get solved, presuming that it isn�t already solved.  But it is, it�s a creepy development, the idea that there could be software that is known by authorities, installed surreptitiously in people�s machines, specially for the purpose of surveilling�them.



LEO:  I can give you a similar example we talked about this week on TWiT.  A citizen in British Columbia, 19-year-old kid who wanted to help catch child molesters, hosted a trojan horse posing as a picture of an underage child on several child porn newsgroups, kiddie porn newsgroups, and for the last few years has been monitoring the people who downloaded that trojan.  And in fact a judge in your part of the world, Southern California, was successfully prosecuted using evidence that this kid generated by illegally using a trojan horse to get into the judge�s computer.  Now, I admire the results, but I can�t say I admire the means.



STEVE:  Well, in fact, I remember there was a group of security people, among them me, who were talking to the attorney general back in the days of the Internet worms, when the Code Red and Nimda worms were really being a problem.  And we were asking whether it was possible to basically fix these machines which had the problem.  Since the IPs of the inbound traffic of the worm could not be spoofed, we had the IPs of all the machines that were infected.  So it was so tempting to create our own inoculation, essentially, for those machines, and go and remove this software, fix this problem in the machines that were infected.  And, you know, anybody running a honeypot could have collected the IPs of the infected worm-transmitting machines.  Anyway, of course the word came back in no uncertain terms that it was absolutely illegal for us to make any unauthorized modification to a machine over which we don�t have any rights at all, even when we�re doing something good, something that the owner would almost certainly want us to do, like fix their machine for them because it�s actively broadcasting Internet worms.  It�s like, no, you know, there�s no way that�s okay.



LEO:  Yeah.  Very interesting.  Very interesting stuff.  And certainly an ethical issue that we haven�t heard the last of.  Shall we get to hard drives?



STEVE:  Sure.



LEO:  Any other errata?



STEVE:  No.



LEO:  Before we do, I just want to mention that I had a very�good experience with a certain program this week known as SpinRite.



STEVE:  That is so cool, Leo.



LEO:  Yeah, well, I�m just glad I know you, that�s all I can say.  Because I forgot my � I lost my serial number.  And I had burned a CD, and this is one of the good things you can do with SpinRite is burn a CD because you do want to boot to the SpinRite CD so that you can be in DOS when you�re doing the checking.  And I don�t know what I did with my CD, and I couldn�t find it.  You know, and I realized later I shouldn�t have bugged you.  I could have gone to the website and retrieved my serial number that way.  Thank you for being very patient with me.  But the good news is, the computer that was dying is the one I�m using right now to record this, I record all the podcasts on.  It�s a pretty important computer.  And it wasn�t booting.  And it said there was something, you know, couldn�t find an operating system.  So I ran SpinRite on it.  I ran the long maintenance, you know, the check and the maintenance fix overnight on all the drives.  It�s been flawless ever since.



STEVE:  I just love that, Leo, that is so cool, so cool.



LEO:  I am grateful to you.  Well, I just thank you so much.



STEVE:  Well, and for what it�s worth, the ecommerce system that I wrote, of course, in Assembly language to run all of this, if any user holds onto their transaction code that they receive when they purchase SpinRite, that enables them at any time in the future to go back and grab a copy of SpinRite.  So if they were somewhere else, I mean, you just use a web browser.  So you could even do it if you were away from home and your laptop started giving you trouble.  And also for people who don�t have that written down in their wallet or have lost it, they can certainly contact our sales email at any time, give us enough information to find you in our database, and we�ll just let you know what your transaction code is, and then you�re off and away.  So even people with less direct connection to me, Leo, than you have are similarly able to get themselves back to their copy of SpinRite if they don�t have it when they need it.



LEO:  We all have a friend at SpinRite.  GRC.com is the website.  If you want to read testimonials, SpinRite.info.  I can�t recommend it more highly.  The ultimate disk recovery and maintenance utility.  And I�ve used it before to save drives.  This is just the most recent example.  It�s such a great thing to have in your toolkit.  So, Steve, speaking of drives...



STEVE:  While we�re on the topic...



LEO:  While we�re on the topic.  Now, we should say this isn�t exactly a security topic.  But I think when you have kind of one of the foremost experts on hard drives available, that it�s important, it behooves us to talk about this Google study.  Let me just ask right upfront, when you read this, were you surprised by the results?



STEVE:  Not one bit.  One of our favorite expressions at GRC for years has been that �SMART is dumb.�



LEO:  I like that.  You�re talking about the SMART drive capability built into hard drives.



STEVE:  Yes, the Self Monitoring and Reporting Technology, SMART.  Or I�m sorry, Smart Monitoring Analysis and Reporting Technology.  The history of this so-called SMART technology is not well known.  Back in the early days of the PC, when drives were beginning to become sort of, I want to say self-aware, you know, like Skynet with �Terminator.�  But when drives were beginning to get intelligent, remember that the earliest drives you actually had a disk controller with a whole bunch of stuff on it, and then one or two cables that went to the drive, sometimes a serial cable and a radial cable.  So you�d daisy chain one, and then you�d have a direct radial cable from the controller to each of your drives.  And these drives were really � they were dumb drives.  They were spinning platters, read-write electronics, and in many cases a stepping motor that just stepped the heads in and out.  And those drives held all of�10 megabytes or 20 megabytes or, you know, 40, even, of�data.



LEO:  That was a big day.  I remember when they went from 20 to 40.



STEVE:  It�s like, wow, yeah, now we�ve got...



LEO:  [Indiscernible] RLL, and that was a big jump, oh.



STEVE:  Right.  Right.  So what happened was, when drives were dumb like that, there wasn�t anything you could really do on the drive.  When drives went to the IDE interface standard, what happened was essentially, well, in fact, IDE stands for Integrated Drive Electronics.  The controller was moved onto the drive, that is, like a disk controller was moved onto the drive so that all of the data flow, the serial data flow on and off the heads and the control, that was all made local.  And an interface was then created that allowed you to use a simple parallel cable down to the motherboard, or at that time to even a very simple IDE controller.  But the idea was the drive started being smart, and had its own microprocessor on it.  And so now it was sort of autonomous.



Well, Compaq was the big leader, as you remember, in the clone market at the time.  They were the first people who came up with a clean room-created BIOS, that is, a BIOS clone of the original IBM PC that had never � where the authors of the BIOS had never had any contact with the source code which IBM published in their technical reference manual.  So in order to avoid any possibility of copyright infringement, Compaq put a bunch of engineers, literally locked them up in a room, gave them � and these are people who had never even seen the source code for the IBM BIOS.  But from the BIOS�s specification, they wrote their own BIOS from scratch.



So Compaq, of course, took off as a major clone of the IBM�PC.  IDE drives began happening, and they began failing.  And what Compaq did was essentially they turned around to the drive industry and said, look.  I think this was Seagate, Quantum, and Connor Peripherals at the time were the three, and Western Digital joined in later.  Compaq said, look, we�re going to tell you what you have to do.  Well, the drive manufacturers were not excited about being told what they were going to do by Compaq.  But Compaq�s purchasing power was king at the time.  I mean, Compaq was buying so many drives that the manufacturers said, well, okay, what do you want?  And Compaq said, we need some way of knowing what�s going on inside the drive because, as the drives became intelligent, that allowed them to hide what was going on inside.  And so Compaq felt like, wait a minute, we don�t know what�s happening now because there�s this intelligence in the drive that has created sort of an abstraction of a hard drive storage.  And of course that�s even more true these days, when drives are, like, self-relocating sectors and doing all kinds of stuff autonomously.  They really do present this opaque wall.  So Compaq said, you need to give us a way to know what�s going on behind the scenes in the drive.



Well, so this SMART specification was created to allow a means for the drive to publish some information about itself.  The problem is that, in order to get the manufacturers to agree, and they were not happy about this, the specification had to be left very loose.  You know, it would be like, well, we�d like you to tell us, sort of give us some health parameters that, when they go lower, that�s worse, and when they go higher, that�s better.  And Compaq tried to nail the manufacturers down to a tighter specification, but it just wouldn�t work.  So what we�ve ended up with, even today, 15 years later, is a specification which is sorrowfully weak.  And in fact, the Google paper talks about this in several instances where they are seeing no uniform meaning behind many of these SMART parameters across a large install base of hard drives.



LEO:  Well, they even go farther.  They say a lot of the failed drives had no SMART errors at all.



STEVE:  Well, now, that�s sort of a different issue.  That�s the issue of how effective is all of this, as opposed to what is...



LEO:  Is it predictive, yeah.



STEVE:  What is all of this, yeah.  And of course that certainly � that�s a perfect segue, Leo, because certainly the goal of SMART was to allow software running in the machine to keep an eye on what the drive was doing and predict hard drive failures.  That was the whole idea.  The problem is, and in fact the reason that we�ve always used the slogan �SMART is dumb� at GRC, is we see dead drives all the time where the SMART system says, oh, everything�s fine.



LEO:  It�s all working, no problem.



STEVE:  Exactly.  The drive can die spontaneously while SMART is completely happy and sees nothing going wrong.  At the same time there are drives which look like they�re on their last throes from a standpoint of the SMART data that just keep on going for years.  So the problem really, and this is what Google�s findings were � well, actually Google found a lot of things.  But relative to SMART they found a very disappointing lack of correlation between, well, based on extensive statistical analysis of over 100,000 drives within their system, a very weak analysis...



LEO:  Correlation.



STEVE:  Thank you, yes.  A correlation of what SMART showed to the actual failure of the drives.  The reason I was pausing there is I was trying to find the exact reference.  It said in the study, it says � and I�m reading from their report on the predictive power of SMART parameters.  It says, �Given how strongly correlated some SMART parameters were found to be with higher failure rates, we were hopeful that accurate predictive failure models based on SMART signals could be created.  Predictive models are very useful in that they can reduce service disruption due to failed components and allow for the more efficient scheduled maintenance process to replace the less efficient (reactive) repair procedures.  In fact, one of the main motivations for SMART was to provide enough insight into disk drive behavior to enable such models to be built.�  Which is a long-winded way of saying we hoped that SMART would allow us to know when a drive was going to die before it does.



LEO:  Well, they weren�t alone.  I think we all hoped that.



STEVE:  Yeah.



LEO:  But I think we all knew, anybody who had any experience with drives, and I�ve said this for a long time,�knew that really SMART didn�t seem to have that kind of ability.



STEVE:  And if it did, we�d all be using it a lot more than we are.  Because it�s there, but it�s not highly used.  And just to finish this one thought here from the report, reading from the report, it says, �After our initial attempts to derive such models yield relatively unimpressive results, we turn to the question of what might be the upper bound of the accuracy of any model based solely on SMART parameters.  Our results are surprising, if not somewhat disappointing.  Out of all failed drives, over 50 percent of them have no count in any of the four strongest SMART signals, namely scan errors, relocation count, offline relocation, and probational count.  In other words, models based only on those signals can never predict more than half of the failed drives.�



So essentially what Google found is that many drives were failing, more than half of theirs were failing where nothing showed up at all in the SMART subsystem; and also that exactly the reverse was happening, is that SMART was showing things where drives never failed.  There were things they found, for example, when they would ask the SMART system to scan the drive, if an error was found during that scanning, the drive was 39 times more likely to fail in the next 60 days than all other drives.  Except that it turns out 39 times more likely wasn�t predictive enough to say, okay, we should replace the drive, because it turns out that there were lots of drives that had scan errors that never failed.  So, I mean, it just...



LEO:  It�s useless.



STEVE:  It�s basically, yes.  It�s funny, too, because in SpinRite 6 I incorporated, as you probably saw when you were running SpinRite just recently, Leo, I incorporated a real-time monitor of the whole SMART subsystem.  Now, there are interesting things that you can see.  SpinRite will show you these SMART parameters being driven down.  One of the things that makes SpinRite different than just scanning passively is it�s reading and writing and reading and writing and writing to the drive, essentially, you know, really working the surface.  So rather than just being a read-only scan, SpinRite is a full read-write stress that inverts all the bits, writes them back, reads them back, reinverts them, writes them back, reads them back.  So it�s basically checking the entire surface aggressively.  So what�s really interesting is that we�ll often see that the SMART parameters which are normally running okay on weak drives, sort of these health parameters get driven down for a while while SpinRite is running on the drive, and then gradually recover.  If they don�t go critical, it�s probably not something to worry about.  But if you were watching it happen, you could compare this behavior of your drive to its behavior, for example, six months from now.  And if it started seeming like it was worse, then you�d get some qualitative sense that the drive was, you know, not doing very well.



So anyway, unfortunately, just the SMART stuff by itself, as Google found and as all of our experience has shown, just isn�t useful enough.  And imagine software saying, oops, you need to replace your drive.  Well, who�s going to believe that?  Certainly in a mission-critical situation where you absolutely can�t have a drive fail, maybe that�s interesting.  Except that what Google found is also that there was some infant mortality behavior, that is, they found that younger drives just installed had a higher failure rate for the first three and then even six months than drives that had been there for a year.  So the idea was that newly minted drives could have something wrong with them that has sort of gotten through quality control and manufacturing that would manifest to the detriment of the drive during its first few months of use.  After that time you get to a point where, okay, the drive is now sort of matured, and it�s going to give us a nice long life.



What designers have always assumed was that the statistical curve would look � it�s called a �bathtub curve,� where it�s high initially.  It drops down after you move out of the infant mortality period.  Then maybe hopefully for five or six years you have relatively lower failure rate.  And then at some point later on, just due to the drive�s aging and fatigue and mechanical wear and tear, the reliability begins falling again, and the rate of failure goes back up.  Thus the other side of this so-called �bathtub curve.�  What Google found, and this was what we briefly discussed last week, and it�s what�s so disturbing, is that in fact drives two years old were experiencing suddenly much higher failure rates than drives one year old, and three years old were even more.  You may remember, I think it was 8.6 percent annual failure rate, meaning two out of every 25 drives is failing every year at three years old.



LEO:  Well, it�s kind of still a bathtub curve, it�s just a shallow � it�s a narrower bathtub than we would expect.



STEVE:  It�s a one-year bathtub instead of, like, five or six years, exactly.



LEO:  Is this the biggest study ever done of hard drives?  It must be.



STEVE:  Well, yes.  There had been lots of littler studies.  Actually filed during the same conference, also in the 5th USENIX conference, was another paper, and we�ve got a PDF link to it also on our notes page for Episode 81.  Two guys, researchers at Carnegie Mellon University, CMU, studied very much the same sort of data.  They didn�t use their own 100,000-drive dataset, but they got maintenance data from a number of very large ISPs that were willing to make this available.  And so they did a similar study, and their conclusions were very much the same.  One of the things they found was that they were talking about how manufacturers would quote a one million hours mean time to fail, MTBF or MTTF, Mean Time to Fail or Mean Time Before Failure.  Well, a million hours equates to 0.88 percent annual failure rate.  You may remember that that Seagate spec I referred to, which surprised me, it was for a Barracuda 7200.9 drive that quoted a 0.34 percent annualized failure rate.



So anyway, what the CMU guys found was almost the same as what Google found.  These guys were not looking at SMART data because they weren�t doing real-time SMART capture in their whole infrastructure the way Google was.  They were just looking at, like, basically aggregating, did a big statistical study of maintenance reports.  But reading from their conclusions, they say, �Large-scale installation field usage appears to differ widely from nominal data sheet MTTF conditions.  The field replacement rates of systems were significantly larger than we expected based on data sheet MTTFs, which was...�



LEO:  What a surprise.



STEVE:  Yeah.  Which sort of is to say, oh, you mean manufacturers are not telling us...



LEO:  Inflating the numbers.



STEVE:  ...what we should have � they also say...



LEO:  Instead of .88 percent, it was as much as 13 percent.  Well, that�s close.



STEVE:  Yes.  I mean, substantially higher.  They say for drives less than five years old, field replacement rates were larger than what the data sheet MTTF suggested by a factor of two to ten.



LEO:  Wow.



STEVE:  And for five- to eight-year-old drives, field replacement rates were a factor of 30 higher than what�the...



LEO:  Unbelievable.



STEVE:  ...than what the datasheet MTTF suggested.  So basically what, I mean, this is sort of corresponding, unfortunately, with people�s real-world experience.  And, I mean, you just had a drive that wouldn�t boot on you.



LEO:  Right.



STEVE:  Every week or so I share a real-life experience from�one of our customers who turns the computer on, and it says, I�m not a computer anymore.  Operating system not found or whatever.



LEO:  That�s exactly what happened to me.



STEVE:  And I think I read the number somewhere, I think it was 350 million drives were manufactured in 2006.  So we have, obviously, there�s hard drives all over the place.  And coming back to your point about how this is not really about security, I guess my feeling is, well, certainly that�s the case.  But there�s almost nothing more important to computer users than their hard drives.



LEO:  When in fact that�s the number one cause of data loss.  It�s not hackers.  It�s dying hard drives.



STEVE:  Exactly.



LEO:  Can we infer anything else or learn anything else from these studies?  I know that Google looked at temperature, for instance.



STEVE:  Yes.  And that was really interesting, too.  My wisdom has always been that temperature matters.  I�ve seen drives failing due to high temperature conditions.



LEO:  Now, by the way, I think that�s what was wrong with my�drive.  It�s a shuttle case, and it�s a very small, tight�case.



STEVE:  Ah, yes.



LEO:  And almost immediately SpinRite said, hey, you�ve exceeded 150 degrees.  I�m going to stop.



STEVE:  Yes, in fact, it�s really interesting.  That�s one of the things that laptop users often report with SpinRite.  I actually have a photo that was sent to me a couple weeks ago of a laptop running SpinRite in a refrigerator.  Somebody took out...



LEO:  Not recommended, by the way.



STEVE:  They took out all their food and a couple shelves, and they stuck the laptop in the refrigerator.  The problem is, laptops are notoriously troubled about cooling.  I mean, I�m amazed, when you put a laptop on your lap, literally how hot these things get.



LEO:  Well, I bought a 7200 rpm drive in my most recent Dell, and that thing, before it even starts working, really, is already blowing very hot air out the side, you know, the fans are working hard.  And I�m sure the hard drive has a lot to do with it.



STEVE:  Yes, it certainly does.  And so what happens is it turns out it�s the seeking of the drive.  When a drive�s head actuator is not moving, the only real power consumption you have is the relatively steady state spin of the drive.  But from an engineering standpoint, or from a physics standpoint, when you need to move the head very quickly to another cylinder, you need to mechanically accelerate the head up to speed, it flies across the cylinder, and then you need to stop it immediately.  So what you�re doing is you are briefly applying very high forces laterally to the head in order to move it from a rest state into motion and back.  So anything, even like defragging, for example, which is putting the drive through a great deal of exercise, will increase the power consumption of the drive, but also a lot of heat.  The energy that is dumped into the drive comes out acoustically; thus you hear, you know, you actually hear the drive doing things.  And thermally is the other way that the energy is converted from electrical energy.  So you end up seeing that the drive�s temperature will increase.  So SpinRite, using the SMART system, is constantly keeping an eye on the drive temperature to alert people that, you know, hey, you�ve got a problem here with your drive getting beyond manufacturer�s spec.  And when SpinRite says it�s a problem, it really is.  I mean, I set that to the upper limit of manufacturers� safe running conditions for a drive.  So if anyone can do � if SpinRite says your drive is running too hot, anything you can do to move more air across it or keep it cool, just for normal daily use, too, would be good.



LEO:  In fact, that�s what I did is I opened the case up, and I have a fan flowing air from the window across the whole system.



STEVE:  Now, here�s the problem with Google�s study, which they acknowledge, and with, for example, quote, my common wisdom about temperature.  And that is, their study was based on many years of aggregate data collecting, during which time new drives came along, new makes and models, and manufacturer mixes changed.  I mean, the most potentially interesting thing Google could have told us and deliberately�didn�t, they referred to it as �proprietary information,� was to show us a breakdown of drive failures by manufacturer.



LEO:  Oh, I would have loved to have known that, yeah.



STEVE:  Who would not kill to have that information.  I have my secret suspicions of who would have been top of the list for drive failures.  But anyway...



LEO:  Well, who?



STEVE:  Well...



LEO:  You�ve got a database.  I mean, you know.



STEVE:  Yeah, I never buy Western Digital drives.



LEO:  Oh, that�s funny, because I do.



STEVE:  And the reason I hedged, and I didn�t offer that initially, Leo, is that I have said that before, and I have had people say, wait a minute, I�ve never had a WD drive give me trouble.



LEO:  No, in fact, I put Western Digital Raptors in every single new computer.  In fact, our web server is running on�Raptors in RAID-5.  I�ve got three Raptors on each web�server.



STEVE:  Well, and the Raptor is a high-end WD drive.



LEO:  You pay a lot more for it, yeah.



STEVE:  Yes.  I do think that, although the Carnegie Mellon study, the CMU study, did not show that SCSI drives were less error-prone that SATA drives or than Fibre Channel drives.  So they did take a look at, by interface type, what drives tended to fail more.



LEO:  But that makes sense.  You wouldn�t expect the interface to impact that, would you?



STEVE:  Although my sense, again, has been that SCSI drives were higher end, more expensive, and just they were built with a little more love and care than push-them-out-through-the-consumer-retail-channel IDE and SATA drives.  But here�s my point.  My feeling is that, and certainly this is the case in the last five to seven years, drive technology is clearly a moving target.  These drives are changing internally to such a degree that I�m not really sure that a study taken over a long period of years really tells us anything about today�s drives.  Because, for example, the Google study did show that older drives showed more of a temperature susceptibility, that is, more of a problem to temperature than newer drives.  So you might assume, then, first of all, that okay, maybe as any drives get older they become more temperature susceptible, though I don�t know why that would be the case.  Or you could assume that newer drive technologies are always going to be less susceptible to temperature than older drive technologies were.  So, for example, five years from now a repeat of this study on a�next-generation population base of drives would yield different results.



LEO:  They said that was actually the greatest, the most surprising result of the study was that temperature didn�t seem to have much to do with failure rate. 



STEVE:  Yes.  And, well, and what�s bizarre is, it turns out that the failure rates were higher for cooler drives.  There was actually � you had to get the drives very hot before the reliability finally spiked in the negative, or running drives very cold.  They just didn�t seem to like that.  Which of course is not much of a problem because they heat up pretty quickly.



LEO:  Right, right.  A very interesting study.  And as Steve mentioned, there are copies of this study and the CMU study from Bianca Schroeder and Garth Gibson on his website.  So you can read this.  This is all from FAST �07, the 5th USENIX conference on File and Storage Technologies, which just happened over the Valentine�s Day weekend.



STEVE:  Right.  So my takeaway from all of this, I mean, it would be very cool if we could tell people before their drive was going to fail, with a high degree of reliability, that it was going to.  On the other hand, if you cry wolf once or twice, no one�s ever going to believe you again.  And the common wisdom is, of course, back up your data.  And so where I am with SpinRite, and where we�ve always been, basically, is saying to people, look, the best thing you can do is keep a current backup.  That�s really your only way of knowing that your data�s going to be safe.  But people never get around to it, or their backup�s a few months old, and they did some really important stuff in the last few months that they have to have back.  So the good news is, with SpinRite, there�s a way of at least turning back that clock a little bit, maybe getting, you know, if it doesn�t completely fix your drive, it�ll get you back going again long enough to pull your critical data off.  So...



LEO:  Well, you remember what HAL 9000 said in �2001�:  �I would recommend that we put the unit back in operation and let it fail.  I would recommend....�  So even then, even �2001� that was a recommendation, so that�s pretty much the way it is.  And certainly you�re not going to pull a drive just because SMART says to.  That would be a big mistake.  Main thing is back up, for crying out loud.  Just make�backups.



STEVE:  Right.  And more often than not, SMART won�t tell you that a drive is failing, and it does anyway.



LEO:  Well, we thank you for summarizing.  I think it�s fascinating stuff.  And I hope you folks don�t mind that we diverted a little bit from our security topic; although, as Steve pointed out, there is nothing more important than keeping your data secure.  And certainly your hard drive is the front line of defense there.



We are brought to you, as always, by the good folks at Astaro, the makers of the Astaro Security Gateway.  They just announced Version 7, some significant new improvements.  We�ve talked about them before, things like transparent email encryption and decryption, which means your entire enterprise can be using email encryption without having to worry about teaching everybody how to do it individually.  It�s just fantastic.  Also you�ll find that signatures are enabled using S/MIME or OpenPGP standards.  I use S/MIME myself, it�s great.  Of course I have an Astaro Gateway, that�s why.  Inbound mail is also automatically decrypted.  They�ve got remote access via SSL; that�s significant.  You�ve got IPSec, L2TP over IPSec, PPTP tunneling with SSL, makes it so much easier to enable.  And of course all sorts of useful things, including scalability via clustering; the usual antispam, firewall, intrusion detection, anti-phishing; I mean, it�s just a really superb unit.  And you can try it absolutely free by calling Astaro or visiting them online at Astaro.com, or call 877-4AS-TARO to schedule a free trial of the Astaro Security Gateway, now in Version�7, in your business.



By the way, you can now � and this is, I think, really fantastic news � download, if you�re a noncommercial user, not only � you could always download the ASG software because it�s open source and free for noncommercial use.  But now they�re going to include all subscriptions and Astaro Up2Date.  This used to be a 79 euro per year subscription.  Now that�s absolutely free.  Just another reason to visit Astaro.com.  We thank them so much for their support of Security Now!.



So I�m going to keep my Western Digital Raptors, Steve Gibson, I�m sorry.



STEVE:  That�s okay.  Well, and my favorite drives were always, when I decided that � because I had several WD drives die on me.  And I thought, okay, when am I going to learn a lesson?  I switched over to Quantum.  And I�ve loved Quantum drives for years.  Then Maxtor bought Quantum.  And then, as you know probably, recently Seagate bought Maxtor.



LEO:  Right, so it�s all the same now.  There�s really only two companies, basically.  I guess Hitachi and IBM are still in business.



STEVE:  Well, and what, I think Hitachi bought IBM�s drive�business.



LEO:  Oh, did they?  Oh, all right.



STEVE:  Yeah.  So the problem is, drives are phenomenally complex.  There�s so much to go wrong with them that, you know, they fail from time to time.



LEO:  And I should mention that the drive that I had problems with was in fact not the Western Digital Raptor.  I think it was a Maxtor drive.  The Western Digital�s been working in there flawlessly.  And I have one in my Mac, one in my PC.  Every machine I just buy a Raptor because I like�� now, tell me if I�m wrong, but I believe � this could�be a completely fallacious belief � that the 10,000�rpms makes a difference.  It also has a 16-meg cache in speed; right?



STEVE:  Oh, in speed, absolutely.  You will definitely be getting a transfer rate performance because literally you�re spinning the drive faster.  So not only do you have a higher data rate, but you have a lower latency because it�s going to take less time for the sector transfer to begin.



LEO:  Yeah.  That�s why it�s not my boot drive, it�s my media editing drive.  We record to the Raptor, and we edit on the Raptor, because I want all the speed I can get.



STEVE:  Well, again, I didn�t mean to badmouth WD.  I know there are other people who really like Western Digital drives.  So it�s just like, to each their own.  It�s like people have cars they like and cars they don�t like, so.



LEO:  I think also that it�s probably true across the board, the cheaper drives are going to be less reliable.  Higher density cheaper drives.



STEVE:  Oh, one thing I did pick up when I was doing the research for today�s show � although obviously I live and breathe this stuff, so I knew a lot of it.  But one of those studies talked about the lower reliability for higher headcount.  And so there is the feeling I had had intuitively, that smaller drives were more reliable.



LEO:  But we thought it might be areal density.  It turns out to be the heads that matter.



STEVE:  Well, yes, because the smaller drives only have a single platter.  And what they�re doing is they�re adding platters.  Which is why drives jump typically, for example, by 80 gigs or in some cases 40 gigs.  It�ll go 40, 80, 120, 160 because they�re adding surfaces to the drive.  And it turns out, of course, that the more of that stuff you�ve got in there, any one of them failing will bring the drive down.  So the fewer you have, the more reliable it is.



LEO:  Excellent.  This stuff is good to know.  That�s why we always listen to Steve Gibson.  If you want copies of the studies and more information, including information on how to turn off ad hoc networking...



STEVE:  And anybody using Wi-Fi with XP absolutely should do this.  You want to go to our notes page and follow that.



LEO:  That�s at GRC.com.  That�s where you�ll also find 16KB�versions of this show for the bandwidth-challenged, and Elaine�s fantastic transcriptions.  By the way, Steve, you�ve inspired me.  We�re going to do a deal with a company�to do transcripts of many of our other shows, too, because I think people really do enjoy reading along often with the show.



STEVE:  I get a lot of great feedback about it.  And of course it makes it also text-searchable.  So Google and other search engines are able to find those articles and refer people to them.



LEO:  Yeah, I think it�s a good thing.  GRC.com.  That�s where you�ll also find, of course, Steve�s free security programs like SecurAble and ShieldsUP, and his day job, SpinRite, a great recovery and maintenance utility.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#82

DATE:		March 8, 2007

TITLE:		Cyber Warfare

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-082.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss the interesting topic of state-sponsored Cyber Warfare.  While born through the imagination of science fiction writers, the reality of international, inter-nation cyber combat is fiction no longer.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 82 for Thursday, March 8, 2007:  Cyber Warfare.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Nerds On Site.  Looking to grow your IT service business?  Find out how Nerds On Site can help.  Visit Iwanttobeanerd.com.



Time to talk about security, protecting yourself, your computers, your home, your family, and our national borders with Mr. Steve Gibson.  I kind of blew it up a little bit bigger than it really is.  It�s just your computers.



STEVE GIBSON:  Well, actually we are going to talk about national borders today.



LEO:  Oh, really.  Oh, good.



STEVE:  Yeah, we�re going to talk about state-sponsored cyber warfare.



LEO:  Holy cow.



STEVE:  Which I think is, you know, a really interesting topic.  And there�s actually more going on than people might guess.  So I think it�s going to be really interesting.



LEO:  Can�t wait to hear that.  Anything that we want to clear up from last episode or...



STEVE:  Oh, yes.  The challenge of secure Wi-Fi just never seems to be resolved.  We of course talked last week, following up from the week before, last week we were talking about this problem of how ad hoc networks, as opposed to infrastructure networks, an infrastructure being where you�ve got a base station you�re connecting to, an ad hoc network being where you just have two random, for example, laptops that are able to directly connect to each other or associate in order to create a connection, and how unfortunately Windows XP is a little misbehaving.  In fact, you had that neat anecdote from two weeks ago, Leo, about how there�s sort of almost a virus, this Free Wi-Fi network virus that jumps from laptop to laptop.



Well, hearing last week�s episode where we talked about and showed on the show notes page how to go through and deliberately disable this sort of automatic ad hoc network connectivity, some sharp people over in the GRC newsgroups picked up and said, hey, Steve, did you forget about the Windows Client Update from late last year?  And it�s like, uh.  Then of course it rang a bell, and I remembered being aware of it, but it�s something we definitely want to talk�about.



Okay, now get this, Leo.  This is really annoying.  A completely patched, like right up to date, XP system that includes wireless will not have a client update to the Windows � it goes by various names, like Wireless Zero Configuration, WZC.  But it will not have a really important update which all XP Service Pack 2 people will really want to incorporate.  So it�s something that Microsoft � it turns out it was on October 17 of �06, so only a few months ago, that Microsoft released this to fix a whole bunch of holes in this Wireless Zero Configuration.  But they never put it on their list of stuff that you�d like to have automatically downloaded into your machine.



LEO:  Oh, so you have to specifically request it.



STEVE:  Yes.  Yes.  And it�s really important.  For example, reading from � and on our show notes page, of course, I�ve got links to all this.  But reading under Changes for Ad Hoc Networks, it says, �On a computer that does not have the wireless client update� � which is what we�re talking about�� �installed, wireless auto configuration� � which is the other name it goes by, either zero configuration or auto configuration � �automatically tries to connect to all the wireless networks in the preferred networks list that have previously been connected to.�  Get this.  �If no infrastructure mode networks are present, wireless auto configuration sends probe requests out to try to connect to the first ad hoc wireless network in the preferred networks list.  An observer could monitor these probe requests and establish an unsecured connection with a Windows wireless�client.�



So literally, a laptop that someone�s just carrying around with them, when they�re not connected into a network already, every minute it�s sending out probes announcing networks that it used to be connected to or had been connected to in the past to see whether there might be a non-broadcasting network, that is, a network which is not broadcasting its SSID, its network identification, that would allow then this machine to connect to it.  So it�s, literally, it�s spilling the beans.  It�s sending out the names of networks that your laptop knows about.  So...



LEO:  Wow.  Wow.



STEVE:  Yeah.  And so, like, okay.  This is not a huge security problem.  But who wants their Windows machine sending out, you know, by radio, Wi-Fi names of...



LEO:  Here�s people I trust.  Here�s people I trust.  Okay, just come on, pretend you�re one of them.



STEVE:  Yeah, I mean, essentially, anyone passively sniffing Wi-Fi packets will be learning about the names of the networks that the people around them have connected to in the past.



LEO:  I would guess that�s how the Free Public Wi-Fi...



STEVE:  That�s exactly how it happens, is that a machine that has it, broadcasts it.  Another machine says, oh, and connects to it.  And now it has it.  So the changes, on a computer that has the wireless client update installed, �Wireless autoconfiguration does not send probe requests to connect to newly created ad hoc wireless networks in the preferred networks list.  Because many ad hoc wireless networks are created for temporary wireless connectivity� � I mean, that�s like all what you�d be using it for � �you must use the Choose a Wireless Network dialogue box to manually initiate a connection to an ad hoc mode wireless�network.�



Okay, now, that makes sense.  So here�s a perfect example of Microsoft still not getting this tradeoff between privacy and security and convenience.  Because the original design, even post-Service Pack 2, I mean, this is just in October, at the end of �06.  So even post-Service Pack 2, the big, much-heralded security update for Windows XP, they�re saying, oh, it�s better to err in the direction of convenience and, oh, look, it just works, than it is towards privacy and security.



LEO:  Interestingly, though, this whole Wireless Zero Config, while I guess on the surface it looks more convenient, it�s caused more problems for more people.  It is not, it is the opposite of convenient.  I get people complaining all the time that they drop connections, and often it�s because Wireless Zero Config is kind of�promiscuous.



STEVE:  Ah, well, actually that�s also one of the things that this update deals with is, if you end up with another network acquiring a stronger signal than the one you�ve�got...



LEO:  It just flips right over.



STEVE:  Yes, it�s able to jump networks and switch to the stronger one.  It�s like, no.  That�s not my network.  This is not a cell phone, where I want to be jumping between cell towers.  So anyway, they�ve fixed a bunch of things.  We�ve got links on the show notes page to this description, to the page you can use for downloading.  And just I was curious.  So I, literally, I took an XP machine that had never � it was fully patched, up to date.  I looked at one of the main files, which is wzcsvc.dll.  So that�s going to be Wireless Zero Config service dot dll.  On a completely patched XP SP2 machine, its file date was 6/21/05.



LEO:  That�s completely patched with critical patches, but not these optional patches.



STEVE:  Well, no, everything that � no, not, I mean, everything that you can get automatically from, you know, as you install XP, then you go through all the Windows Update cycles over and over and over until it finally, you know, the patches have had their patches, and they�ve had their patches.  so that it�s all settled down, and so okay, you�ve got everything you need, this thing is not part of that.  And so only if you deliberately update, then it jumps you from a 62105 to 81806 on basically a whole set of files, which are enumerated on this page.  So people will be able to look at their files, see whether this has been done for them by someone, and most likely it hasn�t been since it hasn�t been that long ago, it was in October.



LEO:  I�m sure mine�s not.



STEVE:  And so everyone listening is going to want to run this patch because this basically locks down the wireless service, you know, this autoconfig sort of promiscuity of�XP.



LEO:  So once again, you�ll run Windows Update.  It�s not a critical patch, though.  You have to go in the optional patches.  And what�s the name of it?



STEVE:  No no no, Leo.  It�s not in Windows Update.  You can�t find it there.



LEO:  It�s not even there?



STEVE:  No.  You have to deliberately go and ask for this by�name.



LEO:  Oh, grumble, grumble, grumble.



STEVE:  So the only way to find it, I mean, if you put in, for example, to Google or to Microsoft, you put in �wireless client update,� I�m sure you could find it on Microsoft�s site that way.  So �wireless client update,� put it in the Microsoft search box, I�m sure you�ll find it.  Or we�ve got links to it on our show notes.  But there is no way, I mean, it doesn�t show at all through any of the normal, you know, take-care-of-me-Microsoft updates.



LEO:  It�s not even an optional update.  Okay.



STEVE:  Right.



LEO:  And it is the first Google result if you do �wireless client update.�  And there�s a download link on that page.



STEVE:  Perfect.



LEO:  And that�s for XP.  Now, presumably they fixed that in�Vista.



STEVE:  Yes.  Given, you know, they know they made a mistake, and they should have fixed this; and Vista came out, you know, only last month, in February.  We can presume.  Although I have to say I�m still scratching my head about where they�ve hidden all these things in Vista.  It�s like, I dug around and couldn�t find sort of the same thing that I�m used to seeing in XP.  So...



LEO:  This modifies six different files.  So it�s quite a big update.



STEVE:  Yes, basically it�s the entire collection of Windows Zero � the Wireless Zero Config set.  And I only read one aspect of the behavior changes.  There�s...



LEO:  There�s a lot of them, I see, yeah.



STEVE:  ...five or six different things that this thing says, uh-oh, this is really not what we want to do.  And who wants their unconnected laptop, that probably has its Wi-Fi still on, the Wi-Fi radio still on, unless you�re, like, really conscious of that, as I am, for example, to shut it down to save battery life, when I remember to do that, you know, who wants it broadcasting the name of networks it knows?  That�s just not cool.



LEO:  Well, in the past we�ve gotten this question a lot on the radio show.  And I just told people, disable the Wireless Zero Config service, that you don�t want it because it�s a bad thing.  But now I have something better, which is download an update.  And you know what, you should come on the radio show and tell everybody because I think people need to know this.  This is something we want to get out very widely.



STEVE:  Ah, that�s a great idea.



LEO:  Any other updates?



STEVE:  Well, no, except that I�ve been trying to read this one really neat piece of email that we received about SpinRite saving someone�s business?  But, you know, of course last week it saved your computer, so I was quite willing to have you talk about that.



LEO:  You do it now.



STEVE:  Anyway, so this is from � this is email from a Michael Diaz in New Jersey.  And the subject of the email was SpinRite saves a business.  He says, �I just wanted to drop you a note thanking you for your great product, SpinRite.  I am a network administrator, and I use SpinRite on a regular basis to diagnose problems as well as refreshing drives on our older PCs.  I�m well aware of the value and power of SpinRite as a business tool.  That�s why it�s what I used when a friend�s business was on the line.�  He says, �I have a friend who is an automotive specialty tuner.�  I didn�t even know about this kind of thing.  But he says, �He builds and customizes primarily late model Ford Mustangs.  Many of these cars have 400, 500, even 600-plus horsepower.  And in order to reliably and safely drive these cars on the street, there needs to be a very good tune, as he calls it, built into them.  Modern cars are tuned via software.  And that usually requires a laptop and a lot of tweaking to the car�s software.



�So I receive a frantic call from a friend one day, basically saying his laptop will not boot, it starts up, gets a Blue Screen of Death, and then reboots, getting caught in a cycle.  I know this is never a good sign, so I dart out to his shop with only SpinRite in hand.  When I arrive there, my first question is, of course, do you back up the data on the laptop?  To which I hear the reply, uh, no.�  So this ends up being, like, critical stuff for this guy.  He says, �Knowing full well that his reputation as a tuner and the hard hours of work he�s put into building his business are on the line, I put SpinRite to work.  The first thing I notice is that the hard drive is clicking.�  He says, �That is never a good sign.  I start to wonder if I�m too late, but I continue on with SpinRite.  It does not take long for it to find some bad sectors, and we decide to leave it running for a while.  Many, many hours later, the scan finishes with a plethora of red Us showing on the screen.  The only way I can describe it is, it looks like virtual Swiss cheese.  As I attempt to reboot the laptop, the clicking is gone, and Windows boots.�



LEO:  So the red Us are unrecoverable sectors in SpinRite.



STEVE:  Yes.  What it really represents is we were unable to get all of the sectors� data back.  One of the very coolest things about SpinRite that makes it completely unique as far as I know is, we are able to read most of a sector, even if we can�t get it all.  And so SpinRite will try like crazy to get it all, and in fact that�s what this whole DynaStat thing is, the Dynamic Statistics, is it�s able to accept whatever the computer is able to read, even if it�s not perfect, knowing that it�s not perfect.  And so it�s very often the case that we can get one good read.  But if not, even after trying a lot, SpinRite is able to say, okay, I couldn�t get it all.  But for example, out of 4096 bits, which is what a sector is, it might get 4090, which you could argue in many cases, for example, if it�s a critical, for example, a file system sector, you might get back your file system because that one sector was preventing the whole file system from functioning.  So you can tolerate some fuzziness in some sectors.



Anyway, so he says, �I attempt to reboot the laptop.  The clicking is gone, and Windows boots.  Not trusting the drive, I quickly retrieve his data and tuning files, as well as his custom tuning software, none of which he had copies of.  Not long after transferring all his vital data off the system, the click is back.  This time the drive just dies.  Luckily, SpinRite was able to make it stable enough for me to get all the data off before it completely seized.  SpinRite does not have to completely fix a drive to save the day.  In my case, it did enough for me to get the vital customer data off the dying drive and, yes, save his business.  I can�t tell you how competitive the custom tuner scene is, especially in the world of super high-power street cars.  One�s reputation is key, and in this case that reputation is intact, thanks to SpinRite.�



LEO:  So the moral is here, back up.



STEVE:  Yes, please, please.  I mean, I�m glad we�re able to, like, come to the rescue in these cases.  But really, when there�s this kind of data � I�m sure his friend now has learned a lesson by seeing how close he came to the brink of losing everything.



LEO:  He�s very lucky.



STEVE:  And it generally takes one of those lessons to, you know, get someone clued in.



LEO:  Unfortunately, it�s really true.  Hey, we�re going to get to our subject, which is, I think, very interesting, cyber warfare, in just a second.  We do want to thank Astaro, our sponsors for this show.  They�ve released Version 7 of the Astaro Security Gateway, and a number of improvements, including, as we�ve mentioned before, transparent email encryption and decryption, which means it�s centralized in the Astaro Gateway, so your users, your employees don�t have to even know about it.  No additional encryption software is required on their computers.  It just does it all for them.  It even handles digital signatures based on S/MIME and OpenPGP standards.  Really, really works.  And inbound mail is automatically decrypted.  So it allows you to have a completely secure email without any effort on your part.  Of course there�s lots of other new features including SSL for VPN.  In fact, I think the Astaro is the only UTM appliance on the market with such an amazing array of VPN and remote access solutions.  You can cluster them, which means it�ll scale to any size.  As many as 

10 gateways can be clustered together.  And they have, and this is for home users great news, eliminated the home user fee.  So you can continue to download the home use package for free, as always for noncommercial use.  But now you�ll also get the base license, all subscriptions, and Astaro Up2Date for free.  They�re giving it away.  So if you�ve got an old beige box lying around you want to turn into a security gateway, this is the way to do it.  Astaro.com.  And don�t forget, you can call Astaro for a free trial in your business.  Just call 877-4AS-TARO.  We thank them for supporting Security Now!.



Cyber warfare.  Even the name sounds scary.  It sounds like �War Games.�  Sounds like Matthew Broderick should be part of this.



STEVE:  Well, yes.  And I think the really interesting thing is that, without specific details, it�s so easy to pass off this whole concept as just sci-fi.  It�s like, oh, yeah, come on.  Like, you know, state-sponsored cyber warfare. 



What I want to start with here is reading a really interesting article because it provides this kind of grounding and foundation.  This was in Federal Computer Week.  The article is dated February 13, so less than a month ago, from Norfolk, Virginia.  The article reads:

�At the Naval Network Warfare Command� � okay, so first of all, there is something we have in the United States called the Naval Network Warfare Command.�



LEO:  Napoleon Solo should be an agent for that.  My goodness, wow.



STEVE:  It says, �U.S. cyber defenders track and investigate hundreds of suspicious events each day.�  Oh, I forgot to read the title.  The title of this article is �Cyber Officials:  Chinese Hackers Attack Anything and Everything.�



LEO:  Yeah, that I know.



STEVE:  Is the title.  So it says, so �cyber defenders track and investigate hundreds of suspicious events every day.  But the predominant threat comes from Chinese hackers, who are constantly waging all-out warfare against Defense Department networks, Netwarcom officials say.�



LEO:  I don�t know if they�re targeting Defense Department networks because they�re also waging all-out warfare against my website.  So I think it�s just general.



STEVE:  Yes.  Well, it says, �Attacks coming from China, probably with government support, far outstrip other attackers in terms of volume, proficiency and sophistication, said a senior Netwarcom official, who spoke to reporters on background February 12.  The conflict has reached the level of a campaign-style, force-on-force engagement, he said.�  I�m not even sure what �force-on-force� means.



LEO:  Doesn�t sound good.



STEVE:  Doesn�t sound good.  Then he says, ��They will exploit anything and everything,� the senior official said, referring to the Chinese hackers� strategy.  And although it is impossible to confirm the involvement of China�s government, the attacks are so deliberate, �it�s hard to believe it�s not government-driven,� the official said.



�The motives of Chinese hackers run the gamut, including technology theft, intelligence gathering, exfiltration, research on DOD operations and the creation of dormant presences within DOD networks for future action, the official said.



�A recent Chinese military white paper states� � okay, get this.  �A recent Chinese military white paper states that China plans to be able to win an �informationized war� by the middle of this century.  Overall, China seeks a position of power to ensure its freedom of action in international affairs and the ability to influence the global economy, the senior official said.



�Chinese hackers were responsible for an intrusion in November 2006 that disabled the Naval War College�s network, forcing the college to shut down its e-mail and computer systems for several weeks, the official said.  Forensic analysis showed that the Chinese were seeking information on war games in development at NWC, the official said.



�NWC was vulnerable because it was not part of the Navy Marine Corps Intranet and did not have the latest security protections, the official explained.  He said this was indicative of the Chinese strategy to focus on weak points in the network.



�China has also been using spear phishing, sending deceptive mass e-mail messages to lure DOD users into clicking on a malicious URL...�



LEO:  They call that �spear phishing,� huh?



STEVE:  Yeah, well, because instead of phishing, where you�re just sort of broadcasting to anyone, a spear phishing exploit is, exactly, is targeted, and in this case at DOD users, DOD employees.  So it�s directly � and of course spear phishing means that they can also tune the content of the email to be more application specific.  So it might be, you know, more prone to a DOD interest and look more authentic to people in the DOD.



It says, �China is also using more traditional hacking methods, such as Trojan horse viruses and worms, but in innovative ways.



�For example, a hacker will plant a virus as a distraction and then come in �slow and low� to hide in a system while the monitors are distracted.  Hackers will also use coordinated, multipronged attacks, the official added.



�Chinese hackers gained notoriety in the United States when a series of devastating intrusions, beginning in 2003, was traced to a team of researchers in Guangdong Province.  The program, which DOD called Titan Rain, was first reported by Federal Computer Week in August 2005.  Following that incident, DOD renamed the program and then classified the new name.�  So we don�t know what it�s called.



�That particular set of hackers is still active, the Netwarcom official said.  He would not confirm whether the Titan Rain group was linked to the NWC attack or any other recent high-profile intrusions.



�Other senior military officials have spoken out recently on U.S. cyber strategy, saying the country urgently needs to develop new policies and procedures for fighting in the cyber domain.



��Current U.S. cyber warfare strategy is dysfunctional,� said Gen. James Cartwright, commander of the Strategic Command (Stratcom), in a speech at the Air Warfare Symposium in Orlando, Florida, the week before.  �Offensive, defensive and reconnaissance efforts among U.S. cyber forces are incompatible and don�t communicate with one another, resulting in a disjointed effort,� said Cartwright.



�Gen. Ronald Keys, commander of Air Combat Command, told reporters at the conference that current policies prevent the United States from pursuing cyberthreats based in foreign countries.  Technology has outpaced policy in cyberspace, he said.



��The United States should take more aggressive measures against foreign hackers and web sites that help others attack government systems,� Keys said.  �It may take a cyber version of the 2001 terrorist attack�� � meaning 9/11 � ��for the country to realize it must re-examine its approach to cyber warfare.�



�Netwarcom officials described their approach as an active defense, in which monitors build defenses around the perimeter of DOD systems, work to mitigate the effects of attacks and restore damaged parts of the network.



�Meanwhile, the consolidation of DOD�s cyber resources is ongoing.  Netwarcom works directly with the Joint Task Force for Global Network Operations, DOD�s lead agency on network defense and operations, a component of Stratcom.



�Netwarcom, the Navy�s lead cyber agency, is moving from monitoring the networks to full command-and-control capabilities. The Air Force announced in October 2006 that it will create a Cyber Command, based on the infrastructure of the 8th Air Force under Lt. Gen. Robert Elder, at Barksdale Air Force Base, Louisiana, to coordinate its cyber warfare efforts.



�In the end, the cyberthreat is revolutionary, officials said, because it has no battle lines, the intelligence is intangible, and attacks come without warning, leaving no time to prepare defenses.  Education and training of computer users, not enforcement, are the most effective defense measures, officials said.�



LEO:  Well, we�ve kind of said that for a long time.  That�s what we do.



STEVE:  Isn�t that, I mean, it demonstrates that the U.S. and certainly other nations on the globe are really taking this notion of the importance of our global network and the need to defend ourselves against, you know, deliberate attacks and intrusions into that network surface.  And I thought it was really interesting, too, because we talked, it was last week or the week before, I don�t remember which, about this idea of could good guys who had the best interests of the world and users and the network and so forth at heart, could they proactively do things to other people�s machines that were good for them, for example, like since we had the IPs of worms on the Internet, and we even have them today, I mean, there are still instances of Blaster and Code Red and Nimda out on the �Net, scanning around, still trying to infect machines.  And if you put a fresh copy of Windows 2000 or XP on the network without its firewall in place and not behind a router, it�ll get infected before long.  That�s now been proven and is well known.  So that means that we all know the IPs of those machines.  But the law protects us from fixing them, even though we could, since they were infectable by this problem, we could use the same problem to disinfect them, but doing so is illegal.  And so similarly it�s clear that in this report the military is saying that U.S. policy and law prevent them from doing to others what apparently is being done to us effectively.



LEO:  It�s unfortunate, after many years of being lied to by our government, I�m not sure I completely trust what they�re saying.  I�m trying to think of what ulterior motives they might have to this.  And I�d hate to see them move towards locking down what we can do on the Internet, using this as an excuse for it.  But I think that it�s probably pretty clear that this is going on.  Isn�t it?



STEVE:  Yeah, I think so.  And in fact, one thing that I find really interesting is that it seems that they�re having such a problem in protecting themselves.  Now, there was a reference to an Intranet, meaning that these systems that were vulnerable were apparently directly on the Internet.  And so you could imagine, I mean, you know, DOD has humans, has people just like any others.  And they�ve got their PC at home where they surf the �Net and they click on links and they�ve got email.  And the problem is, the experience is so much the same when they�re on the Internet at work that they probably bring some of their casual habits that developed in non, you know, non-information, non-intelligence-critical environments, with them, and may without thinking click on a link in email.  So to me it�s really interesting that, with this much at stake, with national secrets, and the idea that somebody could, obviously, as we know, you click on a link, and your browser goes somewhere, you�ve got scripting active, there�s, you know, a whole basketful of exploits that are currently known that allow even fully patched browsers to get compromised.  So it�s very much the case that I guess I�m surprised that these networks are exposed to the Internet, which we know is such a hostile place.



LEO:  You would think, though, that if anybody could block�and lock down their systems, it would be the Department of Defense.



STEVE:  Well, I have an interesting story that I�ve never told.  It dates back about five years ago.  A hacker contacted me, a white hat hacker contacted me, saying that he had gained access into Microsoft�s internal networks.  And I said, okay, I don�t want to talk to you about this.  I mean, I said, I don�t want anything to do with this.  Go away.  And he said, well, I really think this deserves some attention.  And I said, go tell Microsoft, you know, tell them how you�re doing this if your interest is really to, like, help them do things better.  And I said, look, you know.  And he wanted to, like, send me some proof.  And I said, no, you�re not sending me anything.  And he said, well, how can I bring this to public attention?  And I said, well, if your interest is in embarrassing Microsoft, then you want to talk to some computer reporter, not me.  I said, I am not going there.



So actually I did have a guy that I knew that I referred him to, that is a very active reporter in the computer industry who did receive, based on all of his, you know, reporter confidentiality agreements and things, he received some documents that proved to him that this guy really had penetrated Microsoft�s network.  And again, he urged the guy, I urged the guy, just tell Microsoft.  Get a story written if that�s what turns you on, but tell Microsoft.



But the point of this is, what he explained was that he had gotten in through some satellite network in a foreign country, I mean, a Microsoft remote sales or support office or something, got essentially onto a computer that wasn�t as secure as it should have been.  I think it was back in the Windows 2000 days, so it was a Windows 2K box that had some vulnerabilities.  He was able to get into it.  Once he was there, he was on a network, and so he established a presence on that machine.  Then he was able to, within Microsoft�s network � and this was arguably, and as I recall, I mean, this is a long time ago � he was able to go from, sort of leapfrog from an insecure Intranet to a much higher security Intranet by finding a machine that had dual network adapters.  So somewhere there was somewhere, maybe at Redmond or who knows where, there was a machine that was straddling both networks.  It was on the less secure Intranet and also had a presence on...



LEO:  So it was a gateway.



STEVE:  Well, exactly.  And so whoever it was running that machine, they needed simultaneous connection to both networks.  And there was no hard division separating these two Intranets.  So he was able to get himself onto, from a satellite machine, onto basically a more important machine that had two networks, and then essentially hop into the much stronger network through that means, setting up a relay point of his own at that machine.  So I guess the point is that even a network architecture designed to be secure, where you really, really have spent time shoring this thing up and preventing anyone from getting in, if it�s a sufficiently complex and sophisticated set of connectivities, there can be little loopholes that are not obvious, and that somebody determined really just sort of by exerting pressure from the outside, they can find a leak if they sit there and exert sufficient pressure.



LEO:  Does this mean that the hackers will always win because there�s just more of them, and they�re more willing to work at this than anybody else is willing to defend?  I mean, if the Department of Defense can�t secure it, if Microsoft can�t secure it, well, we don�t have any hope.



STEVE:  Well, it�s certainly the case that there are systems within the DOD that are off the Internet.  I mean, we�ve all seen in sort of sci-fi movies where you go into a room that�s just got a computer sitting there, and it�s a super high-security machine.  Well, you know there�s no way that you can go www.google.com and, you know, you are not on the Internet on that machine.  So you have to have a completely separate network with, like, no connectivity across.  And certainly that�s the case.  But what happens is, people do want convenience.  And it�s always that case of, like, well, you know, I�ll be really careful.  I need to be able to get on the Internet, but I also need to have access to the internal DOD documents.  So that�s a point of vulnerability.  And I think you could argue that with networks being so sophisticated, so complex with their interconnectivity becoming richer and richer, that there are ways to worm around inside.



LEO:  Amazing.  Well, let�s hope that people are listening to this, and the Chinese aren�t.  And if you�re in China, we�re glad you�re listening.  And please don�t hack us.  Please, we beg of you.



STEVE:  Well, yes.  And I�m a little skeptical of these guys saying, oh, this is supported by the Chinese government, you know, because of the nature of the attacks.  We know that teenagers are running botnets of tens of thousands of bots and are able to administer huge attacks anywhere they want to, you know, bandwidth floods, and they�re being used for spam emails and things.  And if it weren�t known that these were 13 year olds who were running these networks, we might think, oh, this must be some major government operation.  It�s like, no.  It turns out that, you know, people are curious.  And certainly in the case that I was talking about, this white hat hacker guy who, you know, I remember very little about him now, but he was just, you know, he was curious, and he was just poking around and seeing what he could do, you know.  And it�s illegal, and we want to make sure we stress that.  All of this is illegal.  But it�s very possible to me that there are just non-government-backed people certainly all over the world who are poking at other countries� networks.  I wouldn�t be at all surprised if we�re doing the same.



LEO:  And I could provide you with evidence of that.  If I look at my logs, and I bet if you look at your logs, I get every day hundreds and hundreds of attempts to find backdoors into my system, attempts to log-on via telnet and SSH.  And almost all of them come from Chinese IP addresses.  I don�t think the government�s trying to break into TWiT.tv.  And they�re usually universities in China.  I think there are a lot of kids there who, you know, for whatever reason, they like to � they�re hacking, and they�re trying to find a backdoor into my system.  I can guarantee you that TWiT.tv is not a backdoor into the Department of Defense.  Maybe they know something I don�t know, but it�s just, I mean, it�s gone on for as long as I�ve had a web server.  And they try to hack every service � SMTP, IMAP, you know.  They hack services that I don�t have.  I�m sure they�re automated.  They�re just trying every � and it�s brute-force log-in�attempts.



STEVE:  Well, and, you know, site defacing happens all the�time.  I have to think, too, that the way, based on domestic�U.S. politics, there is some tendency for these guys to maybe overinflate the threat because they want bigger budgets.



LEO:  It�s not like they would ever do that, of course.  It�s not like that would ever happen.



STEVE:  Yes.  Which is not to say these things are not�possible.



LEO:  That�s the problem, it�s hard to assess because � it�s hard to assess.  I guess that was my point.  And that�s why it�s too bad we don�t trust our government a little bit�more.



STEVE:  Well, and, you know, you could also argue that the U.S. was caught off guard on the morning of 9/11, and that since we�ve done things to make ourselves safer.  This guy makes the point that it may take something like that in order to get the government to say, oh, maybe you guys do need some more money for more fancy security and networks and so forth.



LEO:  There was, right after 9/11, of course, there was a cyber security czar, and there was a lot of attention paid to this.  I don�t know if that activity�s waned, or if it�s still part of Homeland Security.  I imagine it still is.



STEVE:  I�m sure there�s a title on a door somewhere.  But the question is...



LEO:  Who�s inside.



STEVE:  ...how much money are they being given.  It�s all a function, I mean, it all comes down to money, what you�re able to afford.  And we�ve heard stories, for example, about how the FBI�s network is just horribly antiquated.  I mean, just, you know, just almost punch cards.  And it�s like, okay, well, maybe you can get rid of those old copies of WordStar and WordPerfect one of these days.



LEO:  And soon as J. Edgar Hoover � oh, wait a minute, never�mind.  Folks, this podcast is sponsored by Iwanttobeanerd.com.  That�s the folks at Nerds On Site.  They are a great group.  They�re growing, too.  And they need more nerds to service their customers.  Looking for folks with competencies and skills in all areas, from PC and Mac experts to specialties like Cisco and Oracle.  You name it, they need it:  fix-it technicians, website designers, programmers, project managers, sales folks, trainers, security experts, antivirus gurus and more.  They especially love those nerds who troubleshoot, tear apart, and rebuild their own systems in their spare time.  You know who you are.  Nerds are independent contractors.  You�re in business for yourself.  But not by yourself.  And I think that�s what I like so much about Nerds On Site.  You can focus on your passion, but they handle the burdens of running the business.  Now in seven countries � Canada, U.S., Mexico, England, Australia, South Africa, and even Bolivia.  And if you want to know more, go to Iwanttobeanerd.com and register for a nerds-only meeting in your area today.  Good people.  Our people.  Iwanttobeanerd.com.  That�s Nerds On Site.  We thank them so much for their support for Security Now!.  They love you, Steve.  They see one of their own.



STEVE:  They�re good guys.  It�s funny, too, because you mentioned the site that had a video of me.  And I was curious, last week I went there thinking, oh, you know, what�s this going to be?



LEO:  What did they tape, yeah.



STEVE:  And what was cool, it was me telling them the story that I had told to our Security Now! listeners before about this guy who was fired because SpinRite saved this cute old lady�s drive.  And so, you know, it must have been before I told it on Security Now! that I was up in...



LEO:  I think it was because you were in Toronto, yeah.



STEVE:  ...Toronto.  And I told these guys the story.  And so that was a little short video, I don�t know, it was like five or six minutes of me, you know, waving my hands around in the air as I am apt to do, telling them this story of � and, you know, it�s funny, too, because the first thing they said when I told them that the younger, junior, good repair guy was terminated because he was willing to take, like, double the time and to run SpinRite and recover the data, rather than just reformatting this poor old lady�s machine.  And the first thing these guys, the nerds said was, who is he?  We want to hire him.  We want him to be one of our nerds.  So, you know, the kind of guys they�re looking for.  So it was a fun story, it was a perfect story for their�site.



LEO:  Nerds On Site.  Iwanttobeanerd.com.  We thank you all for being here.  And of course, if you want 16KB versions of this show, we make them available on Steve�s site, GRC.com.  We also offer transcripts there of the show so you can read along with Steve.  And there�ll be links there to the original document, the Cyber Warfare document that started this whole discussion off.  That�s GRC.com.  That�s also where you�ll find all of Steve�s free security products, including ShieldsUP and the new SecurAble and, of course, SpinRite.  Got trouble with your hard drive, SpinRite is the answer.  GRC.com.



We�ll be back next week and talk more about security.  Okay, Steve?



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#83

DATE:		March 15, 2007

TITLE:		UAC in Depth

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-083.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo wrap up their quest to get Windows Wi-Fi to 'Maintain Full Radio Silence' by adding one additional important tweak to Windows settings.  Then they discuss the detailed security implications, now and in the future, of Vista�s new and powerful user account control (UAC) system.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 83 for March 15, 2007:  Vista�s UAC.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Nerds On Site.  Looking to grow your IT service business?��Find out how Nerds On Site can help.  Visit Iwanttobeanerd.com.



Time for Security Now!, our favorite security podcast.  Well, frankly, my only security podcast.  But it�s still my favorite.  And my favorite security guru is here, that�s for sure, and that�s Mr. Steve Gibson from GRC.com.  Hi, Steve.



STEVE GIBSON:  Hey, Leo, great to be back with you.



LEO:  We are, of course, going to talk about something new in a moment.  Actually I�m very excited about this, the user access control, the UAC feature in Vista, and whether it really does protect you.  But before we get to that, do you have anything from previous episodes you�d like to...



STEVE:  Believe or not, yes.  We�ve basically snuck in an�entire show on maintaining full radio silence on Windows�WiFi.



LEO:  Well, it started when we were talking about this Free Public Wi-Fi that pops up on Windows from time to time, and what it was, and how now Microsoft has offered a fix but never told anybody about it, and you have to explicitly download it.  That�s what we talked about last week.  And if you didn�t hear last week�s episode, you should absolutely download that update.



STEVE:  Right.  So that was our second mention.  Then the week before, Episode 81, we talked about � we actually showed the dialogues required to turn off the functionality, just sort of this promiscuous connect-to-anything-that-I-hear, and also this idea of broadcasting the names of any networks you had connected to before, which by default Windows tries to do.  It turns out that it�s trying to do that still, even after you�ve got the update, because Microsoft added a checkbox to one of the configuration dialogues which is checked by default, and you have to go turn it off.  So here in our fourth serialized How to Get  Wi-Fi Just to Shut Up, we have additional instructions.  People can, if they go to the show notes for this Episode�83, I�ve got a link back to the new and enhanced instructions that are over now on Episode 81�s notes.  So Episode 81�s show notes are enhanced with this additional information, and this episode links back to those.



LEO:  So this is if you installed the patch that Microsoft offered in November to fix wireless zero config, it�s still promiscuous unless you uncheck this box.



STEVE:  Yes.  There�s a box which enables it to connect to networks which are not broadcasting.  And so if the networks are not broadcasting, then your computer does.  And it�s just like, okay...



LEO:  Is this ad hoc only?  Or is it infrastructure networks, as well?



STEVE:  It�s both.  And so anyway, the idea is � in fact, I realized, okay, I started using the term �maintaining full radio silence.�



LEO:  Yeah, that�s a good way to talk about it, yeah.



STEVE:  As the famous jargon.  And that�s what we want.  We want to be able to carry a laptop around.  If we forget to disable our Wi-Fi, we don�t want it sending out stuff of any sort.  We want full radio silence.  And so it turns out that following the instructions that are now on the show notes for 81, with the update which we talked about in 82, which we�re all pulling together now in 83, when we first opened the topic in 80, we basically snuck in a whole Security Now! episode on maintaining full radio silence for...



LEO:  I should just take those chunks and edit them together, and we�d have Episode 84 ready to go.



STEVE:  And then the other news is, we had a second Tuesday of the month with no major Windows security updates.



LEO:  Wow.  Now, that doesn�t mean there were no major Windows security flaws, we�ve learned.  And often Microsoft will just say, well, a patch isn�t ready, or we�re not going to elect to ship it out.  As I remember, I saw that in fact there were several critical flaws in XP, at least, that Microsoft wasn�t ready to patch yet.  So those flaws are still there.  Presumably it�ll be patched next Tuesday.  But I don�t think anybody has said there are any flaws in Vista.  And that�s actually very encouraging news.



STEVE:  Well, and I don�t think they�ll be patched next Tuesday because � oh, you meant...



LEO:  Next month.



STEVE:  ...next Patch Tuesday, right.



LEO:  Yeah, Microsoft�s doing it the second Tuesday of every month now.  Unless there�s something really serious going on, and sometimes they�ll do a quick patch.



STEVE:  And of course several times, I guess it was last year, we saw them do that, where they would catch up.  They said, okay, this will not wait for our standard monthly cycle.  We�ve got to get this done now.



LEO:  Well, I have to say, and we�re going to talk about it today, a little bit about Windows Vista security.  But I am encouraged.  Vista�s been out now officially for more than a month, almost a couple of months, and I haven�t seen any major exploits.  Of course people have been attacking the Windows authentication.  But I don�t care about that so�much.



STEVE:  Well, in fact, I think it was on one of your other podcasts you were talking about � or it might have been Diggnation.  Anyway, so one of these podcasts I heard mention that there was now a tool that would generate valid keys for installing Vista, and that it was possible that somebody else could come along with a correct key which Microsoft would say, oh, I�m afraid that�s already been used.  You can�t use that key.



LEO:  Yeah.  I�ll update you on that.  We were talking about that on Windows Weekly.



STEVE:  You and Paul, yeah.



LEO:  It turns out that was a scam, bogus.  It was phony.  And the people who claimed to have actual keys generated by this thing were either lying � and the guy who wrote it admitted it.  He said, you know what, 25 characters, a mix of alpha and numeric, too big for any brute-force key cracker to solve.  So I lied to you.  However, that doesn�t mean that the hacks don�t continue.  There�s now a BIOS hack to disable authentication.  So the hackers go on trying to crack into Windows Vista.  And everything I�ve heard about this latest one is that it does, in fact, work.  And it doesn�t have that really � somebody pointed out that this key cracker, if it had worked, wouldn�t be stealing from Microsoft, it would be stealing from other users because you�d be coming up with a serial number that these other users might in fact legitimately have.



STEVE:  Right.



LEO:  Anyway, that�s where the hacking seems to be going on.  But so far I haven�t heard � I don�t know, have you? � of any exploits against Vista, which is very encouraging.



STEVE:  Well, okay, yes.  It�s encouraging.  But it�s also predictable.  For example, we know that so many problems we had with Windows 2000, well, certainly 95, 98, Windows 2000, I don�t even want to talk about ME, and even XP were due to the fact that Microsoft just seemed so slow about getting a clue about how to make a Windows system safe on the �Net.  All you have to do is have a firewall.  And as we know, XP had it, but it was disabled by default.  Finally, with Service Pack 2, they turned it on.  It�s funny, I�m seeing this pattern, and I�m recognizing, though, what the pattern means.  The pattern is a means for sort of slowly but surely creeping forward with good security.



LEO:  Hallelujah.



STEVE:  Yes.  And this actually feeds directly into today�s topic because I spent a lot of time researching something that I promised that we would talk about because I knew there was a lot there, and that�s the UAC, the user account control.  Because it�s more than just the annoying dialogue that pops up.  There�s a ton of stuff going on back there.  And when I look at what Microsoft had to do to implement the solutions they have, I can understand why Vista took so long.  Even though they threw out all the other goodies that they were promising to have in so-called �Longhorn,� which was the backroom codename for a long time, there�s really a lot there.



But, for example, Vista of course maintains XP Service Pack�2�s default enabling of the firewall.  Well, that means that you don�t have this problem of open ports that we�ve always had until, well, a router would be in front.  That would be a solution.  But obviously lots of people several years ago during all of the worms on the �Net, they didn�t yet have home routers.  And in fact, I don�t know at the time whether we were yet promoting the idea of a router as an affirmative hardware security measure.  I think still then we were talking about software firewalls.  So certainly people who added software firewalls to their system or made sure XP�s disabled-by-default firewall was enabled, they were much more secure.



Well, finally we got that built in with Service Pack 2.  And�essentially that whole set of problems is resolved now.  That�s just not going to be a problem.  But what�s interesting to me is that this is sort of the trend that we see with Microsoft, where new, better technology is put in, but it�s not enabled initially, sort of because they want to warn everyone, this is coming.



LEO:  Right.  They don�t want to break everything, but they�do want to implement it.  So they give you a little�headsup.



STEVE:  And a perfect example, we�ve talked of course extensively about hardware DEP, data execution prevention, that I�m so bullish about, which now exists both in XP and being given a lot more attention in Vista.  What I�ve seen as I�ve looked at it more is, for example, a very popular image-viewing program called IrfanView, it turns out it won�t run with DEP turned on.  It�s because it uses an EXE packer, an executable compression program called ASPack.  And it makes sense that it wouldn�t because naturally an executable compressor has got to decompress the executable, so it allocates a bunch of data memory into which it decompresses the compressed executable, and then it runs it.  Well, it�s running a data allocation, which is exactly what DEP is designed to stop.  On the other hand, UPX, which is actually the leading and most popular EXE compressor, it�s DEP-compatible because those guys realized, hey, when we allocate this memory, we should mark the pages as executable.  In which case, DEP has no problem with it.  So that�s a great example of how a program might stumble over DEP, but how it�s also possible to do the same thing in a DEP-friendly fashion.



LEO:  Now, why doesn�t a hacker just mark his pages executable and avoid the problem himself?



STEVE:  Well, because he�s got to be running in order to mark them.



LEO:  So he can�t run the code until he can run the code.



STEVE:  Exactly.  Exactly.  So it�s the perfect example.  And in fact we see this a lot.  For example, when Vista pops up the user account control screen, the whole screen darkens, and you get this highlighted dialogue that you have to say Continue or Cancel on in order to allow this permission or not.  Well, it�s been noted that malware could fake that screen in order to get users to type in administrative credentials.  And so from that standpoint it sort of represents an Achilles heel of user account control because with user account control you�re constantly, if you�re not running as an admin user, you�re constantly having to type in your admin credentials to prove that you have admin rights that are just you�re not flexing those muscles right now, which raises the exposure of those credentials.  But then the counterpoint to that is, well, yes, but malware has to be running in your system in order to allow it to spoof user account control.  And what user account control prevents is the inadvertent installation of malware in the first place.



LEO:  Hey, before we get too far into the discussion of user account control, because I�m very interested in this, should we pause for a station break?



STEVE:  Sure.



LEO:  And we�ll get back to it in just a second.  But I do want to mention our sponsors since we are talking about security.  Astaro Security Gateway�s Version 7 has come out.  And, man, what a major update.  I mean, a lot of neat new features you�re going to take a look at.  Of course you know the Astaro Security Gateway is a device that runs software that gives you a complete solution, soup to nuts, for security.  I mean, everything from VPN to hacking intrusion detection.  You get email security, antivirus, antispyware, you get web filtering, you get spam protection, all of that in an easy-to-use device; and all, of course, the network protection stuff that you�d expect.  But now with Version 7 there�s some new features � a centralized email encryption strategy, which means you get email encryption and decryption at the device instead of at the desktop, so your users, it�s completely transparent for them.  A great way to implement S/MIME or OpenPGP standards.  It now has SSL on VPN, yay.  Scaleable via clustering so you can get as many as ten Astaro Security Gateways working together to really give you, without load balancing, to really give you some powerful growth capabilities.



And this is the thing for home users that I�m very excited about.  In the past you�ve always offered the Astaro Security Gateway software so you could put it on your own beige box machine.  It�s an open source distribution.  And in the past, what they�ve done is they�ve charged you 79 euros, and you�d have a subscription to all the other features � the web filtering, the spam, the updates for the antivirus and the antispyware.  Well, they�ve waived that subscription fee if you�re ten users or ten IP addresses and up to a thousand concurrent connections.  So for home users it�s now completely free for all of the goodies Astaro can offer.  This is really a great deal.



If you want to know more about Astaro, visit their website, Astaro.com, or call 877-4AS-TARO, and they�ll schedule a free trial of an Astaro Security Gateway in your business.  We thank Astaro for their support of Security Now!.



So some people complain sometimes about that user account control screen, the fact that it�s a separate screen.  For instance, I notice some programs don�t work.  I use a program called Synergy that allows me to share my mouse and keyboard over the network.  And it�s befuddled by that screen.  I guess that�s also to defeat some hacking.



STEVE:  Yes.  In fact, it�s much more going on there than meets the eye.  Let me finish with sort of the concept that I was...



LEO:  I�m sorry, I didn�t mean to interrupt you.



STEVE:  No, it�s fine.  Irfan of IrfanView fame is now under tremendous pressure to get IrfanView to be compatible with DEP.  So even though it�s disabled by default, some early adopters, like all the people we�re preaching to, are turning DEP on.  They�re discovering IrfanView is incompatible.  They�re sending him support email saying, hey, this doesn�t work.



LEO:  Something he could fix easily, I�m sure.



STEVE:  And it�s funny because I saw � someone forwarded me his response.  And I�m not sure what his native language is, but it was pretty clear it�s not English.  And he was like, what�s going on?  All of a sudden everyone�s complaining about this.  And I�m thinking, well, can you say Security Now! and the importance of turning on hardware DEP?



So this is an exactly analogous thing to certainly what happened back in the early days of software firewalls.  Early adopters who were security conscious turned this on.  And they were the people who were aware enough to understand sort of the UI complexity and sort of the downside of being an early adopter.  They put pressure on anything that was incompatible to get it fixed.  So essentially the way was paved for Microsoft then to come along later and do a firewall built into Windows that would just be able to be turned on.



So similarly, here Microsoft has DEP.  And thanks to us bringing it to attention, and of course with Vista�s increased security, there is now pressure on developers of applications which are not DEP-friendly to fix that.  So what I can absolutely foresee is that some point in the future DEP will be enabled by default.  But it won�t be until all of the early adopters have put pressure on applications and sort of moved incompatibility from more of the, well, yeah, that�s another problem so it�s not worth turning DEP on, we�ve essentially moved it to where DEP-incompatible or unfriendly programs are enough in the minority that it�s sort of more their fault for being un-DEP-friendly rather than expected.



And as we talk here about user account control, there�s all kinds of aspects of what Microsoft has done in Vista which, as I have explored it, I�ve come to the conclusion that, slow as Microsoft is � glacial, in fact � in moving, it�s very clear to me with Vista that they really got it.  I mean, the light finally lit up and said security is the big deal.  We have got to resolve this.  And this was essentially Jim Allchin�s final gift to Microsoft.  He was there for 17 years, and he resigned the moment Vista went out the door.  He said, I am done.  Because he was the head of this project with a long, deep career in networking and understanding this stuff.



And what we end up with is essentially a system which throughout the system it�s putting pressure on developers.  It�s doing it gently, just as the existence of DEP does, sort of in the background.  But there is pressure nonetheless.  A perfect example is what you were just saying about how people are upset or complaining about this UAC, the user account control permission dialogue popping up so much.  It turns out that an application developer can completely control that so that it isn�t popping up when it�s not necessary.  But by default, unless you mark your application as UAC-aware, then Microsoft falls back to the default behavior of essentially popping it up too much because your application hasn�t provided the granularity which is available in Windows.



A perfect example is my little SecurAble app that I wrote a couple months ago.  I made it Vista-compatible by specifically appending what�s called an �application manifest� to the executable to declare that this thing needs administrative privileges.  Because, as we�ll remember, I am installing explicitly, briefly I�m installing a kernel driver in order to access the chipset�s hardware directly in order to get underneath any disabling that the BIOS or Windows may have done.  I want to actually see what the hardware is telling me.  The only way to do that is from ring 0 in the kernel.  So SecurAble announced right upfront, hey, I�m going to need admin privileges.  So anyone attempting to run SecurAble in Vista is immediately presented with this UAC dialogue.



Well, it would be possible, and Microsoft provides complete documentation, for making that more granular so that, for example, you could run SecurAble, and if there were more to it, basically you run SecurAble and it simply shows you the results, so there was no UI process to go through, which is why I have that dialogue, the user account control dialogue presented right upfront.  But, for example, it�s very possible for a more complex application not to show you that dialogue until you actually do something that will, in that user interface event, will need those kind of privileges.  A perfect example is setting the clock.  If you look under Vista at just the standard old clock setting dialogue, the button that you have to push to change the time has a little shield on it.  That shield over time will come to be associated in users� minds with, oh, this is user account control.  So Microsoft has designed an icon which can be attached to buttons, just to sort of show users, if you push this, we�re going to ask you.  And so it creates a little bit of sort of interactivity, even pre-pushing interactivity, because the user can adopt the expectation that they�re going to be asked for credentials if they�re logged in as an admin user.



So the idea is that all of these things, they put pressure on the developers.  Your application can be more friendly if you do the following things.  Well, in the process it is substantially more secure also.  And so what�ll happen is, this behavior will end up over time pervading applications which become Vista-aware.  And so this whole notion of needing admin privileges will be diminished.



The other thing is that, because now even people running as admin users are being prompted to confirm, again, the application experience is the motivation that developers have to minimize their use of admin privileges.  It turns out Microsoft�s analysis of many applications showed them that most apps really don�t even need admin privileges.  It�s just they were inexpertly, or I should say casually, written so that, well, you know, what the heck.  I�m running as an admin.  We know most users run as an admin.  So we won�t pay much attention to that.



Well, thanks to Vista not even running admins as admins, which I�ll talk about in a second, it turns out that all applications which were sort of assuming admin privilege even when they didn�t need it, they�re now popping up these dialogues which can be easily prevented just by having the developer pay more attention to whether admin privileges are really necessary or not.  And just that simple, this little bit of pressure is going to end up changing the experience.  It�s going to make applications more friendly under Vista by essentially never showing this user account control dialogue because there was a little pressure on the application writers to do the right thing.



LEO:  So by default the application, if the application writer doesn�t do anything, opts for the highest level of�security, just assumes that you have no access to do�anything.



STEVE:  Well, yes.  And Microsoft recognizes that there are apps, old apps, for example, that are no longer being maintained.  Companies have gone out of business.  You still want to be able to run those securely.  So if the application doesn�t identify itself as being Vista-aware, then Microsoft defaults to the behavior we�re seeing from most existing applications at Vista launch time, which is this is a lot in your face...



LEO:  It�s not too bad.  I have to say it isn�t too bad.  I think, though, that really it does respond to a problem that I�ve seen in both XP and Windows 2000 of applications not running at all if you�re not an admin.



STEVE:  Yes.  And in fact that was what SecurAble was doing.  When I was first running SecurAble, it was failing silently.  And I thought, wait a minute, that�s not good.  So it didn�t have admin privileges.  And rather than asking for them, I was performing some calls.  What Microsoft has done is a little bit of a problem because they are silently failing some low-level calls without letting the application know that this thing it tried to do didn�t work.  I guess they�re trying to be a little bit tricky or clever in order to prevent malware from knowing that something it wanted to do hasn�t happened.



There are many layers to this.  They�ve got something called UIPI, the user interface privilege isolation, which is another new thing in Vista.  We�ve never had it before.  It�s, again, really a long time in coming, but will do a lot to enhance desktop security.  The idea is that they�ve added a new abstraction for applications called �integrity levels.�  You can have low, medium, high, or system integrity.  And many things that go on in terms of the system communication depend upon the level of integrity.  For example, a lower integrity process cannot validate a window handle, which is something that goes on in the API of a process with higher integrity.  You cannot send it a message or post a message to a process with a higher integrity level.  There are other things that hackers often do known as attaching a thread or a journal hook to an application, and injecting DLLs is a common means for sticking one of your own DLLs into a privileged application and getting it to run there.  All these things were fundamental, I mean, long-standing, fundamental, serious security problems in Windows.



So Microsoft is sort of inching forward.  They couldn�t turn that stuff off because it would break too many things.  So they said okay, let�s create a new abstraction, this notion of how much we trust applications.  And so, for example, Internet Explorer runs at the lowest level of integrity, as does email applications, because they�re communicating, and they�re more potential vectors for trouble.  So those programs have absolutely no need to be reaching out and touching other applications on the desktop.  But by default Windows was designed, for example a macro recorder could attach to another process and send it keystrokes.  That�s how macro recorders and macro playback operates is you�re able to sort of send messages to a program as if you were the user typing things or clicking the mouse.  Well, malware�is able to do that also in order to cause obviously malicious things to happen.  So this longstanding behavior, again, Microsoft is slowly tightening the screws on this saying, wait a minute, for things that we don�t trust as much, we�re going to limit their ability to access other�programs.



Well, now, this will break some things.  Microsoft is unable, as we�ve seen, for example, with the kernel patch protection, they�re unable to simply shut down all kernel modification in 32-bit Windows as they have for 64.  So they�re saying, look, we�re going to be really resistant to this kind of behavior and sort of try to moderate how much they push back.  But what�s very clear as you look at what Microsoft has done throughout Windows Vista is there is finally some real pushback from the OS onto applications, saying, look, it�s time for us all to clean up our act.  It�s time for us to start behaving ourselves.  And you can read the handwriting on the wall that this is going to be increasingly enforced over time until eventually, Leo, I can say, I can foresee the time when Windows ends up being the most secure operating system around.



LEO:  What I�m really hearing you say actually explains a lot.  People like Chris Pirillo who have decided to go back, they don�t want to use Vista, they�re going back to XP because so much stuff doesn�t work, what they�re really running up against is what we�ve always said all along.  It�s a tradeoff, security for convenience and security for compatibility.  And in a way it�s encouraging to me that Vista is not compatible with some of these applications.  It can�t be if it wants to be secure.



STEVE:  Well, yes.  And in fact we also hear � I did a lot of research.  I�ve heard, in fact, even our friend Joanna Rutkowska, who created the Blue Pill system, she�s poked around at UAC some.  And she commented that initially, well, first of all, one of her main systems she�s using all the time is Vista.  She�s moved over to it.  And she was seeing that she was getting the UAC pop up a lot initially, and that it quieted down.  It stopped being a problem.  And so I think it�s clear that it�s also a function of what kind of user you are.  Certainly Chris is a power user.  He�s installing things all the time.  He�s experimenting with stuff.  He�s a different profile than your typical, buy a new Dell laptop at Circuit City and basically take it home and plug it in and don�t do anything with it because it�s got all the stuff in it already that you need.



LEO:  Well, and that�s what I�ve been saying.  If you�re getting a new computer, and you don�t have legacy hardware and software, absolutely go with Vista.  And if you�re not, if you�re upgrading, you might want to wait just because of these compatibility issues.



STEVE:  Well, again, for myself, I�m happy at XP.  And I also saw...



LEO:  Well, you were happy at 2000 until about a month ago.



STEVE:  That�s true.



LEO:  In fact, you still run 2000, don�t you.



STEVE:  In fact, I�m sitting in front of 2000.  I was a little annoyed that Microsoft chose not to update the time zone change during our recent daylight savings time shift.  Windows 2000 is still under their critical care, whatever the heck they call it, where major security things get fixed, but non-important things don�t get fixed.  Which they could have easily done, but I think it�s some pressure from Microsoft to say, okay, they�re not telling me to move forward, but they�re telling the industry it�s time to start moving away from Windows 2000.



LEO:  Although there�s no technical reason.  All that daylight savings time update is simply changing a setting for when summertime begins.  There�s no need to vet that or test it.  It�s just push it out.  So it�s very blatantly, if you ask me, commercial pressure to upgrade, for no good technical reasons.



STEVE:  I think that�s clearly what was going on.  But again, just to make sure I made myself clear, I could see Chris backing away from Vista and essentially allowing other people to get the arrows in their backs and essentially solve these problems.  It makes sense to wait for applications to mature for the Vista environment.



As I really came to understand, as I looked at what was going on here, I realized, you know, these are deep changes.  When we talked about the incompatibility you experience with remote control of the secure desktop, it is explicitly the case that the secure desktop, even though it sort of just looks like the desktop got dim and a dialogue was allowed to run, sort of like in the foreground, what�s actually happening is that desktop bitmap is copied, and the desktop is switched to a secure environment where nothing but system code is able to have any contact with that desktop.  So application code, which is normally what you have running, for example, keystroke macro recorders and playback and so forth, that are using Windows hooks in order to control applications remotely, and certain keyboard and mouse remoting, those things lose � they have no connection to this secure desktop.  And the reason Microsoft did this is they wanted to prevent obviously malware from clicking Continue before the user is able to click Cancel if this has been presented by malware trying to install itself.  So it really is a substantial change.



Now, Joanna, in examining this user account control stuff, she spotted something which really annoyed her, which was in order for Microsoft not to break installers, they�ve done this bizarre stuff, Leo.  Literally, if you run any program that contains the word �install� or �setup� or �update� in the filename, Vista looks at the filename, the executable filename.  And if it has �install� or �setup� or �update� or many other things, like specific vendors or company names, product names, keywords in the executable, specific strings in the environment, any of these things will trigger Vista to decide you�re running an installer which should have admin privileges.



LEO:  Now, it�s funny because I don�t expect a hacker to put the word �setup,� �update,� �install� into their software, or even name it such.  Do you?



STEVE:  Well, again, it�s a perfect door for a trojan to basically trick somebody into running a trojan program.



LEO:  Oh, you make it look like a standard installer, of course, yeah.



STEVE:  Exactly.  And essentially, for anything that looks like an installer, Vista completely drops its guard.  And Joanna�s complaint was anything with those words in the name, for example, can install drivers in the kernel.  And so it�s like, well, okay, but that�s what a setup program may need to do.  It may need to legitimately install drivers in the kernel.  And so I guess Microsoft�s response again is, well, wait a minute, we asked you if you wanted to run this program.  So we�ve prevented it from happening behind your back, and that�s the whole point, is we�re going to prompt you to make sure this is what you want to do.



And again, it�s Microsoft fighting the need to not break old things while waiting for them to catch up.  For example, once all the installers and installer systems around have been caught up, Microsoft can quietly back off on this sort of flaky heuristic approach to solving the problems of the past and, again, putting more pressure on these things to update in order for those programs to identify themselves as installers that explicitly need admin privileges in order to�run.  So essentially I�m very impressed with what Microsoft has done.  Even, you know, we�ve also commented how even users who do run Vista as an admin, your typical I-don�t-need-no-stinking-limited-account guys, even they...



LEO:  And that�s the default, by the way, it encourages you to make a user account, but it doesn�t require it.



STEVE:  Actually the way it works by default, Leo, is the first account you create is one of these sort of limited admin accounts.  Successive accounts are user accounts.



LEO:  Right, users, right.



STEVE:  By default.  So...



LEO:  And most people just create one account, though, that�s my point.  And that account will be an admin account.



STEVE:  Yes, it will.  Now, what�s interesting, though, is at log-on, two separate tokens, two separate privilege tokens are actually created by the operating system.  It creates a privileged user, but it also creates what they call a filtered standard user.  And that�s what everything you do runs under.



LEO:  So you really aren�t running as an admin, even if you�re running as an admin.



STEVE:  Yes, that is what�s so cool.  And it�s one of the things that I didn�t understand is that you absolutely are not running with admin privileges.  Even when you log on as an administrator, you get this filtered, limited, standard user token.  And that�s the privilege under which Explorer.exe, not Internet Explorer, Explorer.exe, the main desktop shell, which is the parent process for everything else you do, that is running as a standard user.  And it�s called a filtered token because what happens is Windows is watching for things asking this token for heightened privileges.  And so the more privileged admin token, the real admin token, does still exist.  And that�s what Windows will switch to if you satisfy it by saying, yes, I want to proceed with installing whatever it is you�re doing.  But by default, even an admin user under Vista is running as a standard user.



LEO:  Do you know of any attempts to hack UAC to get around it?  It sounds like UAC provides a very good barrier.  But of course, with any barrier, it might be possible to just ignore it to get around it.



STEVE:  Well, and certainly that is the attack surface that we can imagine hackers will be going after.



LEO:  They�re not going to go straight in.  They�re going to have to go around.



STEVE:  Exactly.  One of the things that I have seen as I�ve looked at what Microsoft has done is that all the things that all of us have known have always been wrong with Windows, they have fixed.  This notion of the too easy inter-application communications, well, they�ve created this integrity level concept to mitigate that threat and to prevent DLL injection.  While still not breaking it completely, they�ve made it less accessible.  And certainly data execution prevention, and the address space layout randomization, ASLR, to make things load in unknown, uncertain locations to prevent hackers from being able to jump to code at known fixed locations in the system.



I mean, basically they�ve sat back, and they�ve looked at everything wrong.  And with Windows Vista they said, okay, we can�t just lock down on this because things will break.  But we�re going to make it very clear that we are in the process of locking down on these things.  Which is why I�m so encouraged.  I mean, as you know, I�ve been very rough on Microsoft historically about their lack of care and lack of concern.  I was pulling my hair out with raw sockets, and for so long they kept running with no firewall enabled and active exploitable services, open ports exposed to the Internet.  Those things are fixed.



What Vista represents is a major psychological mindset change about where Windows is going.  I�m not surprised that Chris Pirillo has backed off from it because it�s so new.  What he�s feeling is he�s feeling that pressure.  I expect that three or four years from now it�ll be a much � when I�m ready to move to it, it�ll be a much better experience because that pressure will have rippled backwards through the application community; and application providers, wanting their stuff just to work seamlessly, they will have fixed things to be Vista-compatible.  And in the meantime I�m happy with XP.



LEO:  Now, let me ask a question, because a couple of podcasts ago you were worried about Vista�s virgin stack, that completely rewritten stack that at least in beta was making some mistakes that had been fixed in earlier versions of Windows.  Any evidence that the stack is providing a�weakness?



STEVE:  Well, it�s not providing a static weakness, by which�I mean because of the firewall in front of it there�s no access to it.  There is still the problem that, once you�ve got a connection opened, there could be some packet-level connectivity problems.  But we haven�t heard of anything yet.  I wouldn�t be surprised if we end up with some funky way that a malicious server could send you bad packets.  The problem is, they couldn�t be unsolicited.  They have to be solicited.  And so that�s a much lower attack surface than what we saw before, for example, with UNIX, with no firewall running by default and just all these services running in the very early days of the UNIX stack, where all these exploits and mistakes were first being made.  So Microsoft, even though they�ve got this unproven stack, which worries�me, it�s much less easy to get access to it from the�outside.



LEO:  Well, I have to say I�m excited.  And I�ve been very happy running Vista both in emulation on my Mac and on at least one of my PCs.  I can�t run it on another one because Adobe Audition does not work with Vista, and it doesn�t seem to have any timeline when it will.  Somebody told me that...



STEVE:  Well, and you know, Leo, it totally makes sense, too.  Because as we know, Vista completely revamps the whole audio subsystem in order to add DRM.



LEO:  I�m sure it�s a major thing to rewrite.  And it�s based on old code, Cool Edit Pro.  So I have a feeling that maybe, in fact, some have indicated that perhaps Adobe won�t even do an Audition for Vista, but just start a whole new application like Soundbooth from scratch.



We do want to thank right now our great friends at Nerds On Site who are celebrating, I�m sad to say, their last episode with Security Now!.  If you are a nerd, they need nerds to service their customers.  Visit Iwanttobeanerd.com.  Nerds On Site are looking for nerds with all competencies and skills from PC and Mac experts to specialties like Siskel � not Siskel, Cisco, Siskel�s a movie reviewer � and Oracle.  Actually I think I combined Cisco and Oracle to make one thing.  You name it, they need it.  Fix-it technicians, web designers, programmers, project managers, even you could be a sales nerd, a trainer, a security expert like Steve.  Antivirus gurus, the list goes on.



They especially love nerds who like to troubleshoot, tear apart, and rebuild their own systems in their spare time.  Nerds are independent contractors.  You�re in business for yourself, but not by yourself.  And that�s what�s so cool about Nerds On Site.  You could focus on your passion and not the burdens of running a business.  All over the world, seven countries, 256 different competencies and that University of Nerdology.  Visit Iwanttobeanerd.com and register for a nerds-only meeting in your area today.  Great people.  We really are glad that they stopped off and spent some time with us on Security Now!.  We wish them all the best in the future.  Iwanttobeanerd.com.



Boy, I have a feeling Microsoft is going to want to publish this podcast on their website.  If you go to GRC.com, Microsoft, you get a transcript.  You can also � everybody can do that.  A 16KB version for the bandwidth-impaired.  I know Bill Gates doesn�t yet have broadband, so maybe you want to go to GRC.com.  That�s also where Steve stores all his great security programs like the new SecurAble, DCOMbobulator, UnPlug n� Pray, and of course ShieldsUP.  Have you crossed 50 million users yet?



STEVE:  No, but we�re approaching that.  That�s going to be a big event.



LEO:  We�ll do a party, yeah.  GRC.com.  And of course that�s where SpinRite lives, too, everybody�s favorite, my favorite disk recovery and maintenance utility.  If you�ve got a hard drive, you need SpinRite at GRC.com.  Next week it�s question-and-answer time.



STEVE:  We�ll do a dozen of our listeners� questions and answers.  And to answer the question that they ask, how to send that, you go to GRC.com/securitynow.  That brings up our main and growing Security Now! page.  Scroll all the way to the bottom, and there�s a web form.  Just fill it out.  You can put a name and tell us whereabouts you�re calling from, click the Send button to post it to me, I�ll receive it, and we�ll get to it.



LEO:  Next week.  Thank you, Steve.



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/


GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#84

DATE:		March 22, 2007

TITLE:		Listener Feedback Q&A #17

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-084.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world �application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 84 for March 22, 2007:  Your questions, Steve�s answers.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And�by Nerds On Site.  Looking to grow your IT service business?��Find out how Nerds On Site can help.  Visit Iwanttobeanerd.com.



It�s time for Security Now!, and because it�s Episode 84, that�s good news.  That means it�s one of our divisible-byfour episodes.  Every fourth episode we like to answer your�questions.  Steve has a passel of them.  Hello, Steve�Gibson.



STEVE GIBSON:  Hey, Leo, great to be back with you.



LEO:  It�s nice to have you.  You�ve been great, by the way; and I don�t know if people know this, but Steve has been doing a regular segment on my radio show, as well.  And it�s just been great.  It�s going over very well.  It�s kind of a mini Security Now! because it�s only six minutes.  But still, I think it�s getting the word out to a wider audience, and that�s kind of important.



STEVE:  Yeah.  It�s really cool, too, because you�ve got a whole different, you know, a different geographical spread.  You�re on XM Channel 152, I think it is?



LEO:  Yes.  I�m really happy about that.  All six hours of the show every weekend.



STEVE:  Did you happen to mention GRC and ShieldsUP maybe, like, early in the show on Saturday?  Do you know if...



LEO:  Could well be.  I don�t know.  I don�t remember.  Why, did you get a little...



STEVE:  Something, yeah, something happened on the server.  It�s like, whoa, it�s like in the old days of Tech TV.  Whenever you�d mention GRC, like I�d just have to hold onto the edge of the desk.



LEO:  Oh, I�m glad to hear that.  If it was during show time, that�s probably what it was.  I don�t know what else.  Anyway, yeah, because, well, we�re now all over the country�in 13 or 14 markets.  We just got Washington, D.C.  I mean, it�s really � it�s growing very rapidly.  So it�s a big audience.



STEVE:  Fantastic.



LEO:  Yeah, I�m really happy about it.  And I�m happy to use it to expose people to some of the TWiT, you know, the best TWiT folks like you and Amber.  And really, that�s a neat opportunity, too.  Dick DeBartolo does it.  But let�s get to our � oh, before we do, hey, some happy news.  Last episode we said goodbye to Nerds On Site.  They had only bought a three-week schedule.  We think they�re a great company, and we were really glad that they came on the show.  And, you know, I think for a smaller company, I understand it�s a big commitment.  So we were happy to give them a three-week schedule.  We don�t normally do that.  But they�ve had such success, results with their ads that they�re back now for three more months.  So...



STEVE:  Wow.



LEO:  ...I�m thrilled.  That�s good news.



STEVE:  Very cool.



LEO:  It just confirms what we know, of course, which is that people who listen to this podcast are very active and pay attention.  And the people who sponsor it get the results because, you know, it�s a good audience.  So let me just mention, we�re sponsored, once again, not only by Astaro, who is of course still with us and will be through the rest of the year, but by the good folks at Nerds On Site.  Iwanttobeanerd.com.  Maybe you could explain what they are because I�m not exactly sure, Steve.  It sounds like it�s kind of a guild of tech support, IT people.



STEVE:  Yeah, I think the word is �federation.�  They�re like a federation of individual consultants who have this organization that sort of provides them with an umbrella identity.  They get, you know, I don�t know anything about the contractual details, but I do know...



LEO:  But you get to keep your own business.  You�re still doing your own thing.



STEVE:  Exactly.  But certainly there�s some sort of fielding of leads.  And they hold educational seminars.  They have get-togethers where they all pull together.  You know, I�ve done a deal with them that allows the Nerds to use SpinRite to help their own customers.  So it was like a special expanded site license kind of deal.



LEO:  Oh, isn�t that nice.  Oh, that�s neat.



STEVE:  Yeah.  I just think that they�re, I mean, I know for a fact that there is a tremendous need for this kind of business.  And certainly the quality of the people you get to have come out and help you matters a lot.  Frankly, I�ve not heard great things about that Geek Squad group that seem to be doing that.  People talk about long lead times and then not really great performance.



LEO:  This is not them.  Don�t get confused.



STEVE:  Exactly.



LEO:  This is Nerds On Site.  One of the other things I love about it, it�s very �  most podcast advertisers are very nationalistic.  They buy the ad mostly for the U.S. market.  But Nerds On Site�s in Canada, U.S., Mexico, England, Australia, South Africa, and Bolivia.  So...



STEVE:  Wait, wait, and India.  I just happened to notice�that...



LEO:  India, wow.  And we�re there, too.  So that�s one of the reasons podcasting is so good for them.  Anyway, we thank them for their support.  If you are a nerd, you�re in business for yourself but you don�t want to be in business by yourself, focus on your passion, not the burdens of running a business, with the help of Nerds On Site.  No matter what you do, PC to Mac, Cisco to Oracle, fix-it, website design, programmers, product managers, project managers, sales, trainers, security experts, antivirus gurus and more, they especially like those nerds who troubleshoot, who tear apart and rebuild their own systems in their spare time.  Iwanttobeanerd.com.  Register for a nerds-only meeting in your area today.  Iwanttobeanerd.com.  We should make a little jingle for them.  Iwanttobeanerd.com, yeah.



So let�s get � because we have a bunch of great questions.  I just love the questions that we get.



STEVE:  Yes.  We have no errata this week.  Well, actually there was some, but I sort of incorporated them into the Q&A because the errata were people making notes or comments and things.  So we�ll deal with that in the Q&A.  I did want to share one fun SpinRite anecdote that put a smile on my face.  This is from someone named Hareem, it looks like Haque, Haq-u-e.  He says � the subject of his email was �Thanks for making SpinRite.�  He said, �My name is Hareem Haque, and I am a computer tech working with a firm here in Toronto.�  So he�s up on the East Coast of Canada.  He said, �I would like to say that ever since I bought your product life has been great.�  Yes, we fix people�s lives, as well.  He says, �The firm keeps an old Dell server as its primary data server, and the hard drive on the server was acting strange for the past few months.  A few weeks ago the disk drive was on the verge of death.  However, I ran SpinRite on the server, and within 12 hours the drive was working like it was new.  There were no signs of data loss, and that awful noise was no longer there.�  Then he says, �My boss was so impressed with the work he gave me a promotion.  So I love you guys, man.  The best $89 I ever spent.  Keep up the good work.�



LEO:  Oh my gosh, that�s really great, that�s really great.



STEVE:  I just love that.



LEO:  Very nice, happy stuff.  SpinRite, of course, is Steve�s product, and you can get that at GRC.com.  I use it.  Nerds On Site use it.  If you have a hard drive, you ought to be using it, too.



STEVE:  Well, and it fixed your computer a few weeks back.



LEO:  It did save me.  I�m still using � by the way, that drive that it fixed, I�m still using it.  It�s recording reliably now.  Haven�t had a single problem ever since.  So it worked.  It worked.



STEVE:  Love it.  Love it.



LEO:  I didn�t even retire it.  I thought, well, it�s fixed.  I don�t need to get a new one.  Which is a good thing because it was a � oh, no, it wasn�t a Raptor, it was the second hard drive that failed.  The Raptors are the editing hard drives.  Anyway, let�s get to our questions.  We�ve got quite a few of them here, starting with Security Now! listener Ian Chapman of Calgary, Alberta, Canada.  He found newer versions of that stealthy Wireless Zero Config Update we were talking about, the one Microsoft didn�t push out.



STEVE:  Which we keep talking about and trying not to talk about, but we can never get away from this topic.



LEO:  The subject that will not die.  KB923154, that�s Knowledge Base article 923154, has slightly newer versions of the Wireless Zero Config files than KB917021, newer by four days, the 22nd of August as opposed to the 18th; and a later build, Build 2979 instead of 2977.  The files seem to be the same size.  They�re both updates.  The later update also includes updspapi.dll, an old DLL from 2005 but still newer than the version on my up-to-date patched system.  I discovered these newer versions while perusing the RyanVM update packs to see if they included the 917021 files.  In case you don�t know, and I didn�t know this, the RyanVM packs are used to slipstream all XP patches into a new Windows install disk, a very handy thing to have.  Thought you might like to update the Security Now! Episode 81 notes yet again.



STEVE:  Yet again.  Okay.  Well, so what we have is we have an update to the update, neither of which you would normally get when you were keeping your Windows up to date using the normal Windows Update facility, even if you were accepting everything that Microsoft wanted to do to your machine.  So what we advised people of last week was this 021 Knowledge Base article that has files four days older than the one that Ian found, this 923154.  So I will put a link to this in today�s show notes for this Episode No. 84.



It�s worth mentioning, though, that this is what Microsoft calls a �hotfix,� or a �hot patch,� on the existing one.  They specifically say that it�s in case you have authentication problems with your Wi-Fi, it updates something called EAP, which we just touched on briefly back when we were doing all of our Wi-Fi coverage.  That�s the Extensible Authentication Protocol which WPA encryption allows.  It basically allows different types of authentication to be easily added to the Wi-Fi protocol.  Microsoft has a bunch of their own authentication that they like to use on their system.  So there are situations which they discovered where this sort of reauthentication will fail if you don�t have this hotfix.  They specifically say don�t bother with this unless you have this problem.  But it seems to me like, well, it�s probably a good thing to do because you get newer files.  So I can see why RyanVM is using these.  And I would say this is not nearly as critical to do, if for any reason it�s not easy to do.  But it�s worth doing because then you�re going to get more things�fixed.



LEO:  You know, and for all we know that newer file just has � they changed a name of a menu item or something.  I mean, it may not make a big difference.



STEVE:  It could be a small thing that may not affect most people who are not using, like, one of these strange add-on authentication protocols.  I just want to let people know that it�s there, and I hope we never talk about this again.



LEO:  We�re done.  Maybe.  David Weiss of Redmond, Washington, raises the following point about full radio silence.  In Episode 83 you mentioned how to maintain what you call �full radio silence� on a Windows machine.  Now, I�m a Mac user.  Couldn�t believe it was so hard to turn off Wi-Fi on a Windows machine.  It�s true because on the Mac it�s on the menu bar, you just pull it down, you say turn off Wi-Fi.  After I blogged about it � and by the way, I should point out that many laptops have an on/off switch, which is an even easier way to do it.  After I blogged about it, one of my astute readers pointed out that what you were talking about was radio silence when Wi-Fi is on, not trying to turn it off.  Ah.  I think the name �full radio silence� might be misleading.  At least it was for me.  Maybe you�d want to clarify this, at least for others that might have been confused like me.



STEVE:  So, yes, so I wanted to put this into this episode exactly for that reason, to say that � or to draw the distinction that when I said �full radio silence,� I actually did mean it in the sense of the radio is on, but nothing is being sent out.  Because that�s been the challenge that we�ve been talking about for now it�s five weeks, is trying to get Windows to allow your Wi-Fi to remain on, but to be quiet about it, even when you�re connected or not connected.  Because remember that, even when you�re connected, it�s still sending out packets, seeing if it can find a better connection, unless you say, no, just be happy with what you�ve got.  Don�t be talking about the networks that I�ve hooked up to in the past.



So like you, Leo, my laptops have an on/off switch.  I would recommend for people to get in the habit of just turning the switch off.  Or you can normally disable Wi-Fi, depending upon which Wi-Fi manager you may be using on a laptop.  Some of them have add-ons in addition to Microsoft�s.  There are different ways you can actually turn off the radio.  Being a fanatic about battery life, I like to do that all the time just because anything that�s on is taking its little share of life from the battery, which as a cordless user you�d like to minimize that.  So turning the radio off is certainly the best of all worlds.



LEO:  That�s true silence.



STEVE:  That�s right, yeah, then it�s been fully gagged as opposed to, you know, sending out all these little beacons and probes and things.



LEO:  What we were talking about is full radio silence while still using Wi-Fi.



STEVE:  Yes, or being able to, or at least having the Wi-Fi radio enabled.  Whereas in the default case, Windows is just blabbing like crazy.



LEO:  Right.  Maybe just in the system tray you just right-click on the Windows Network little icon there and say disable the wireless, and then it�ll be turned off.



STEVE:  Disable, right.



LEO:  Although, as I said, it�s really great when there�s a switch on the side.  That�s the best way to do it.  I think that�s for airplanes.  So when you get on the airplane, you just switch off your radio.  Stefan Schmidt, listening to us from Mississauga, Ontario, wanted to share a spam solution and get our opinion.  And I do have an opinion on this one.  He says:  After listening to you guys talk about spam during Q&A 13 at the end of 2006, the spam sent to our office email address has forced me to do something, to search for a product that could address this issue.  He had tried the filtering features in Outlook and Norton to no avail.  I agree.  They don�t work.  What I found, he says, was a software program called Cloudmark Desktop at Cloudmark.com.  It plugs into the Outlook.  When I came into the office the next day and started up Outlook, to my amazement, and every day since, it gets rid of 99.9 percent of spam.  Cloudmark�s been around a long time.  We�ve actually talked about it.  I remember talking about it on The Screensavers years ago.  He points out the software is based on a community of users who assist in identifying spam from which Cloudmark ranks the users and collects the data to filter out the spam.  In other words, a community is working to find and delete spam.  And since it�s a community, the integrity of the spam filtering is tremendous.  Have you heard of this product?  What are your thoughts and concerns?



STEVE:  And I put this in here, Leo, because I was hoping, and assumed, that you would know about Cloudmark.



LEO:  Oh, yeah.  Cloudmark�s excellent.  Highly recommend.  The way it works is you actually are sending your mail through their servers.  You change the MX record.  And they make it very easy to do.  So that the mail goes through their servers.  That�s what I use.  I use a very similar service called MailRoute.  And the point is really that a professionally managed antispam service that is kept up to date, constantly worked on, is going to do a better job than anything on your desktop.



STEVE:  Well, for example, my own experience with Google Mail is that, because they�ve got the same sort of centralized view into the mail that�s coming in, they�re able to do a fantastic job of spam.  Every so often, if your Google mailbox gets a piece of spam, you select it and say �Report as Spam.�  And that of course tells Google for everybody else�s benefit that, you know, this is spam that exists with this particular profile.



LEO:  I�ve had less, ironically � and I agree, it�s the same concept � I�ve had less good results with Google.  I get spam every day in my Google mailbox.  But most people report very good results with Google, so I�m not sure what�s going on with mine.



STEVE:  It works well for me, although I don�t have a widely public email address, either.



LEO:  Yes, you see, you�re not a target.



STEVE:  So the takeaway from this, I think, is that if we�ve got people who � oh, is Cloudmark free?



LEO:  It is not.



STEVE:  Okay.



LEO:  And actually there�s one that works very similarly that is, in my opinion, just a little bit better.  It�s a little more up to date.  It�s called OnlyMyEmail.com.  Same idea, collaborative filtering, taking off on Cloudmark.  Cloudmark�s very good.  I think Cloudmark�s been around for quite some time.  OnlyMyEmail.com I think is 10 bucks a month, I�m not sure.  And then, as I said, I use a commercial solution called MailRoute.  But these all work the same way.  And I think it�s � I�ve always said the best way to get rid of spam is to not have it arrive in the first place.  And the problem with a desktop antispam program is you�re still downloading all that spam from your servers.  These actually filter it out before it gets to your inbox on the ISP.  So as a result you�re downloading a lot less mail.  In my case, a million messages a month less.



STEVE:  Well, and there is also the positive side effect that, as we know, some of this shotgun-sent email can be hazardous to your health.



LEO:  Right.



STEVE:  It�s not just hazardous to your mental health.  That�s been well established.  But it can actually be hazardous to your system.  So not letting it get near your computer is just sort of generally good for security.



LEO:  Well, all these services will get a lot of the phishing scams.  They will get a lot of the viruses.  They�ll actually strip viruses out.  So, yes, you�re absolutely right, these are security solutions as well as spam solutions.



STEVE:  Neat.



LEO:  Yeah.  Cloudmark is good.  I highly recommend it.  I haven�t seen how much it costs lately.  Kevin Rose was a huge Cloudmark fan.  They�re a good service.  A listener using the Gmail handle of Diazamet, which is a risky handle � isn�t that a drug?



STEVE:  Sounds like it.



LEO:  In Warrington, U.K., is not impressed by Windows UAC.  We talked about it last episode, the User Access Control.  Despite your praise for UAC in Episode 83 of Security Now!, I still see the problem of security will be down to user behavior.  And he�s absolutely right.  Of course it is.  Users can screw up anything, can�t they.  As far as I�m aware, the UAC implementation by Microsoft does not require a password, unlike Linux or OS X.  He�s wrong there.  The problem I see with this is partly the way in which Microsoft has implemented this � requiring the entry of a password is far more secure � and partly the mentality of a lot of Windows users.  I do not mean to be condescending to Windows users.  But for your average Joe, if the common response to these UAC dialogue boxes is to click OK, then it will become a reflex action � I do agree with him on that � because this is the action that will get rid of the UAC dialogue box the quickest.  And therefore any security it offers will be quickly eroded.  Both Mark Russinovich of Sysinternals and Jim Allchin of Microsoft state this is a design feature which is a tradeoff, as always.  It�s always a tradeoff between security and convenience.  Unfortunately, nobody ever said security would be convenient.  However, security is a necessity.  And as long as Microsoft puts convenience before security, it will be flawed.



Allchin says, if security is not convenient, people would not use it.  I say don�t give people a choice.  Whether or not they realize it, it�s there for their own good.  I know this sounds a little totalitarian, but a compromised Windows machine can affect all of us with spambots and so forth.  That�s a good point.  It�s not just the machine�s owner.  As Leo often stresses, change in user behavior is the biggest security feature you can have.  But humans are creatures of habit, and sometimes it takes more than friendly advice to instigate change.



You know, it�s interesting that you put this in because, you know, Kaspersky, who makes an antivirus software, in fact, one of the best antivirus softwares out there, recently said, quoted by ZDNet, saying that most users are just going to get so annoyed by UAC they�ll disable it.  And Kaspersky says that, without UAC, Vista is less secure.  And Kaspersky�s chief executive � now, remember, he�s got a little axe to grind here, actually she, Natalia Kaspersky, said that her analysts have already found five ways in which malware could bypass UAC.



STEVE:  Well, you know, my comment to this, of course, and I put this in here just because I wanted to, I mean, it�s a very valid point.  He was a little mistaken saying that you didn�t need to enter a password, unlike the Mac.  In fact, on one of my Macs I don�t have to enter a password.  And in the case of Windows Vista, the idea is, if you didn�t log on with the authorizing credentials, that is, if you�re not logged on as an administrator � in which case, if you are logged on as administrator, you simply have to say Okay.  If you�re logged on as a so-called standard user, then you do need to provide administrative credentials.  Of course, that just makes the burden of the UAC pop-ups more annoying rather than less.  So, I mean, Microsoft is stuck because they are, as we�ve said before, and as I talked a lot about last week, they really are trying to make the system more secure.  But they really are fighting the corner that they�re painted into because anything they do that really changes the system�s behavior to increase security will break things.  So this is, you know, it�s an evil, unhappy compromise, but it�s arguably better than allowing changes to the system with no oversight at all.  It�s not perfect.  They recognize, everyone recognizes that it�s a tradeoff.  It�s going to be really interesting to see how it plays out.  We really won�t know probably for six months, and as we get more sort of feedback from people, was this useful or is it just, you know, annoying.



LEO:  It does seem to bug you more than the Macintosh does.  I�ve gotten used to it on the Macintosh.  On both my Mac and my Windows machine I am frequently asked for an admin password.  You don�t get asked if you�re running as admin on�Mac.



STEVE:  On the Mac, isn�t it only when you install something, yes.



LEO:  Yeah, or you modify system files, yes.



STEVE:  Okay.  And so on Windows it certainly is more pervasive than that.  There are many other things that will cause that to pop up because of course Microsoft is reacting to, in every case, to specific malware that has abused something in Windows.  And they�re, like, saying, wait a minute, if that happens again, let�s make sure this is the user doing it.  So I do think that UAC is more � I don�t know if I would say more granular, certainly more in the way in Windows due to Windows� own history of having so many exploited problems in the past.



LEO:  Look, there�s no perfect solution.  Users are going to be able to get by anything that a company does.  That�s the problem.  There�s no way you can force a user to be secure.



STEVE:  Yeah, well, now I have to go and research what Kaspersky is saying because that�s...



LEO:  Kaspersky, that�s a little scary, although they bring up that same old boondoggle about why doesn�t Microsoft let us modify the kernel?  They say the PatchGuard hinders their ability.  I�ll send you the link to this article in ZDNet.



STEVE:  Yeah, cool.  I�ll do some research.



LEO:  And I thank Stephen Cerruti for sending it to me.  Jonathan Lackman of Kansas City, Missouri has an oft-asked question:  I�ve been reading your site for years.  I presume he�s talking about GRC.com.  I�m an IT professional, and you�ve taught me a lot.  I know he�s talking now about GRC.com.  I�ve also been listening to your podcasts since numero uno.  However, when setting up my new iPod, only the last 14 show up in iTunes.  Do you have any idea why they don�t all show up?  I can download them separately, but they aren�t as nicely formatted and presented on the iPod.



STEVE:  And that�s for you, Leo.



LEO:  Shall I take that one?



STEVE:  Yes.  It�s here for you because � but it is, I hear this all the time, so I thought we ought to just tell people what�s going on, and you�re Mr. Pod Man.



LEO:  And I make the decision, by the way, not to include all of them.  With 84 episodes, it would be � the RSS file would be several hundred K.  The way RSS works, it�s really never been intended to have a complete listing.  If you look at the RSS feed from any web page, it doesn�t show every article that�s ever been on that web page.  It shows the most recent articles.  And every person who creates an RSS feed has to make a decision, well, how many articles are you going to include?



STEVE:  I know the problem.  The problem is we�ve deliberately designed a podcast that laid down some really significant, important, historical stuff, rather than just being sort of a news sort of thing.  And so that�s created a strong desire in the part of people who discover Security Now! to, like, go back and get them all.



LEO:  I don�t blame them.  But the feed is not the place to find them.  Now, I make a point of � my general policy is the most recent 20 episodes of every podcast.  That�s five months back.  And it�s really balancing the size of the RSS feed.  Remember that every time some aggregator, including iTunes, requests the feed, it�s downloaded from our site.  And that can be quite a bit.  That�s several terabytes of downloads, and we�re trying to manage that, as well.  So what I do, if you go to TWiT.tv, in fact, just go to TWiT.tv/sn, for Security Now!, and every episode�s there.  It�s on the web.  It�s not that it�s not available to you.  It�s just that it doesn�t show up in the RSS feed.  And I think the reason people are confused is it�s kind of Apple.  I blame Apple a little bit because it�s not clear that what you�re looking at is an RSS feed.  It looks like you�re looking at a directory of all episodes.  And that�s not the case.  It�s not the case from our podcasts or anybody�s podcasts.  You can�t do that.



STEVE:  So when he says � he says, �I could download them separately,� so he obviously knows about that.  But they aren�t as nicely formatted and presented on the iPod?



LEO:  That shouldn�t be the case.  It should be exactly the same.  It may be something that iTunes does different with a podcast.  It probably is, when it sees it as a podcast in the feed.  Write to Apple.  Don�t complain to me.  That�s the way iTunes has decided � iTunes does some very strange things.  It renames the files, it does some very strange things.  But all of them are there.  And frankly, you can listen to them all on the web page.  It�s the other thing we�ve done is we�ve made it possible to just click on an episode number.  In fact, you can go by episode number.  Just go to TWiT.tv/sn and the number.  So if we say, oh, Episode 81, remember that, you can go to TWiT.tv/sn81.  You�ll go right there, and there�s a player on that page.  So I think that you can always, frankly, find it.  It�s not that you can�t find it.  I get this periodically.  You know, with the Daily Giz Whiz we�ve done 270 episodes.  There�s  no way I�m going to put 270 episodes in the feed.  I mean, it�s just...



STEVE:  I�m not going to be catching up with that number any time soon, am I.



LEO:  Well, and nobody would probably want to listen to all 270, although we do hear from time to time people doing that.  You�re absolutely right.  Security Now!, it�s more natural you�d want to go back and listen.  It�s really the difference between what a feed is and what iTunes is presenting to you.  And it really does look like iTunes is saying, hey, here�s all the episodes.  They�re not.  They�re just saying what�s in the current feed.  Moving right along. I�m glad actually you put that in because I get that question a lot.  For the first, you remember, for the first maybe year I put them all in there, and the file size was well over 100K.  It was getting too big.



STEVE:  Well, and frankly, it would encourage people � I mean, okay.  The way things are now, if people like the podcast, they�ve got to deliberately go back and yank these�files off the server, which creates a nice tradeoff.  If in fact the entire feed contained all the files, somebody�just experimentally joining would suddenly find themselves downloading...



LEO:  Oh, that�s a good point, yeah.



STEVE:  ...84 monster files.  It�s like, aagh, stop, I don�t want all this.



LEO:  iTunes is smart enough to say you just want the most recent one, right?  But you could say no, I always want to get all the files.  And that really would be a nightmare.  If you look at any podcast, I don�t know of anyone that actually puts all of their shows, if they have any number of shows, because you just can�t.



Doug Smith of Albany, New York is busy catching up on back episodes after being hooked by the Honey Monkeys.  Well, that was Episode 1.



STEVE:  It really was.  I couldn�t believe it was so long�ago.



LEO:  Way back.  He asks:  Here�s my question.  In your show about wireless security, when talking about brute force attacks, you mentioned a hacker could steal off with a sample of encrypted traffic and subject it to the attack.  You made it clear that as long as you have a good password, you�re probably safe from this kind of attack.  But my curiosity is this.  How does a hacker know when they�ve cracked the encryption?  It would seem to me that they�d need to attempt to try to access your network with what they believe to be the key before they could really know.  Doesn�t that make the idea of them doing it from the comfort of their own secret lair somewhat impractical?



STEVE:  I loved the question because it�s something I never addressed.  It never occurred to me, because I know the answer, to make it explicit.  And I also like it because we�ve much more recently seen exactly this happening with the cracks of protected content under Vista and HD-DVDs, where they were finding keys � and remember the idea was that the key would be somewhere in memory, and so they would scan through memory taking candidate keys and testing them against known encrypted content to see if it decrypted it.  Exactly in an analogous fashion, we talked about � and this is specifically the WPA.  Of course there were, you know, enumerable ways of cracking WEP, the first-generation bad encryption for Wi-Fi.  The only known vulnerability for WPA is exactly what Doug cites here, and that�s sort of the offline brute force attack, where you...



LEO:  That�s just because it�s so hard to do that you need a lot of time to do it, is that why?



STEVE:  Well, it�s because, yes, there is no obvious attack.��So the attack that is available is that you capture some encrypted traffic, and then you do a brute force attack, for example...



LEO:  You�d try every key.



STEVE:  Exactly, using dictionary attack, using alphabetic attack, using, you know, basically, I mean, maybe as much as going A, then AB, then ABC and so forth.  So...



LEO:  That�s why, if you have a � that�s why you keep pushing for a 64-character totally random key.



STEVE:  And as we know, if you go to GRC.com/passwords, you get exactly that over a secure link as raw material for using a key because it�s just going to be garbage, and that�s going to maximize the chance to the point where it�s just not feasible of doing that kind of attack.  Anyway, to answer this question and the exact analogous question in the case of hi-def decoding, it�s always the case � at least in both of these cases.  It wouldn�t necessarily have to be the case.  But in both of these cases when you get a decrypted blob, whether it�s a chunk of video that�s been encoded in MPEG format, a frame of MPEG or a frame of radio data, a frame of Wi-Fi, suddenly the format becomes crystal clear.  That is, all of these things, for example a Wi-Fi packet has a bunch of header information at the beginning before it�s got whatever the content might be, whether it�s ASCII or binary, and arguably that just looks like noise to a casual observer.  But the headers have a rigorous set format that is very easy to recognize.  So the automated software is looking at the beginning of the packet, in the case of Wi-Fi, or the beginning of a frame of MPEG data.  And you know if it looks like complete nonsense, or if suddenly it all makes sense to software that knows sort of heuristically what the front of whatever it is you�re trying to decrypt should actually look like.



LEO:  It�ll pop into focus.  It�ll be obvious.  It�ll just jump at you.



STEVE:  Popping into focus is a great analogy because literally, if you got the key wrong, it is completely random.  As we know, encrypting and decrypting with the wrong key results in absolutely nothing coming back.  It�s just noise.  So if suddenly you get structure at the beginning of whatever it is you�re trying to decrypt, you know you got the right key.



LEO:  Yes, absolutely.  Dan Berkowitz, writing from somewhere in Pennsylvania, says:  In my work I set up PCs for people.  You should call Nerds On Site.  A week after I installed � free plug.  A week after I installed a Vista machine for someone, they told me they don�t even pay attention to the UAC pop-up anymore.  Okay, proof positive.  And they hate Vista for it.  All this brought me to thinking UAC might bring spyware infestations from 25 percent of PCs to 15 to 20 percent, you know, bring it down, but it�s not going to be a whole lot more.  The normal user that doesn�t pay attention to the window is still going to get infected.  Do you agree with this statement?  It might be an interesting side note.  And they will always find a way around it, probably in a week.  Well, we have addressed it, haven�t we, in the earlier question, but...



STEVE:  Yeah, exactly.  And I just � I liked this because, as I said, we�re going to have to see how the world reacts to this over time.  This is an experiment that Microsoft is doing, clearly, saying to my mom and people who are not computer savvy, you know, popping this thing up and saying something is trying to mess around with your computer.  Is this you?  I mean, even that question, you could argue, is somewhat murky.  It�s very much like the problem that the personal software firewall vendors had when their software was popping up a dialogue saying something wants to talk to the Internet.  It�s this.  Do you want to allow it or not?  I mean, the great Achilles heel of that was people not knowing whether to say yes or no.



LEO:  Yeah, and we saw that happen.  That was very clear that people eventually either turned it off or gave up and just said okay, okay, okay, okay.



STEVE:  Or, as happened in the case of personal firewalls, once they had authorized all of their properly formatted programs, properly intended to be talking to the Internet software to do so...



LEO:  It did calm down, yeah.



STEVE:  ...then it really did calm down.



LEO:  But, see, that won�t happen with UAC.  It�s going to annoy you every single time.  It will never learn.



STEVE:  I�m afraid that might be the case.



LEO:  Yeah.  So it�s not like it�s going to ever calm down.  What you see now you�re going to see in five years because it�s going to warn you every single time you install a program or every single time you modify the desktop file.  You know, it doesn�t bother me.  In a way, now, I don�t use Vista day in, day out, so maybe it would if I used it full-time.  I don�t.  But I use it a lot.  And it doesn�t bother me.  I just feel � in a way I just say, hmm, good, it�s protecting me.



STEVE:  Well, yes.  And, you know, from a power user standpoint, which certainly the two of us are, and many if not all of our listeners probably are, to a much greater degree than, you know, our moms, for me it�s like I come to expect it.  It�s like, oh, okay, you know.  I just did something, yes, yes, this is me.  I mean, so for someone who understands what it�s doing, it isn�t that interruptive because like you, Leo, I recognize, ah, the system is there.  I would want to know if it popped...



LEO:  Of course, we�re the ones who need the least�protection.



STEVE:  Exactly.



LEO:  We�re the ones who could turn it off safely.  Alex in Kentucky needs to accept incoming connections from SSH on port 22.  SSH is the secure terminal.



STEVE:  Shell.



LEO:  Yes, secure shell.  He writes:  I have an SSH server set up on my computer so I can create a secure tunnel for TightVNC.  I currently have the server set up to use port 22.  I use a 12-character password of random numbers and letters.  I�m having trouble changing from the default port.  Is there any significant security problem from using the default port?  21 I think is the default for SSH, isn�t it?



STEVE:  No, that�s Telnet.



LEO:  Oh, that�s Telnet, okay.  So 22 is the normal port.



STEVE:  Correct.



LEO:  Oh, he wants to use a non-default port.



STEVE:  Well, he�d like to change to a non-default port.  But for whatever reason he says he�s having trouble changing it from the default port.  So he is on 22, the default port for SSH, and he�s wondering is this a problem.  You know, he says, is there any significant security problem from using the default port.  Well...



LEO:  I�ll tell you, when I look at my server logs, I see people try to log in on port 22 all the time.



STEVE:  Well, exactly.  Now, but you don�t have a server running on 22.  Right?



LEO:  I do.  This is on my website.  I use SSH to log into my website, of course, because it�s secure.  And we use the default port.  The point is, if you have a good, secure password, these Chinese hackers are going to be working on it, but it�s not like you can do a mass brute force attack.  You get three tries, and then you have to start over again.



STEVE:  Right.  So here�s the issue, I think.  He�s advertising, his system is advertising that it�s got SSH running, that is, an SSH server listening and accepting incoming connections, because he wants to be able to be outside of his own network and be able to connect in, give his credentials, which is secure over secure shell.  It was well designed.  So you end up with, you know, good, non-eavesdroppable security.  But the problem is, he�s saying, okay, when people don�t know my password � and he knows enough to have a really bizarro 12-character password � am I in any danger?  If his password is good, as you say, Leo, it�s very burdensome for someone to crack it.  On the other hand, it�s still there.  It�s accepting connections.  And so I would say he doesn�t have a security problem.  He just sort of has an annoyance problem.  For example, he would be prone not to log what�s going on on his router or his server because it�s going to be, just exactly as you said in the case of your logging, it�s going to fill up with people who go, oh, let�s see if he�s got a simple password that�s in a dictionary.  So he�ll be prone to being attacked on 22.  Not that he would be vulnerable because he did the smart thing.  But people are going to be hooking up to him and trying.  And that would annoy me if I was looking at my log and just seeing people hooking up to my port.



LEO:  It�s a little scary.



STEVE:  Yeah.  It would just be...



LEO:  It�s a little scary; but that�s, I mean, when you run a web server you have stuff like that.  I mean, they�re always trying to get in, you know.  And they�re trying to get into other services, too.  I mean, they�re always trying to do that.



STEVE:  But what I would suggest is, if he�s behind a router, and he�s mapped port 22 through, some routers allow you to map a different incoming port on the outside to a port on the inside.  It may be that his SSH server running on his system doesn�t like to change off of port 22.  If he�s got a router...



LEO:  That�s not the case.  I don�t know of any SSH server that won�t let you easily do that.  I�m not sure why...



STEVE:  Exactly.  And I don�t know what his problem is.  But anyway, I guess, Alex, if you�re listening to this, and I hope you are, not only for the benefit of all of our other listeners but for you, you know, make up your own mind.  I wouldn�t say you�re under a great security risk.  But it would bug me if I had just random strangers all over the globe who I don�t know hooking up to my port 22 and giving it a try.



LEO:  When we were talking about Chinese hackers on the other episode, that�s what they�re doing.  And I can tell.  I look at the IP address, it�s from China.  I have strong passwords on there.  I don�t think a brute force attack � because you can�t � it�s not like you can run a program that will run through this...



STEVE:  At high speed.



LEO:  ...at high speed.



STEVE:  Exactly.



LEO:  It�s a slow process.  It has to be done by hand,�essentially.



STEVE:  On the other hand, it�s automated, and it�s happening day and night unless you do something to prevent�it.



LEO:  Well, that�s true.  That�s true.  I guess if I saw a lot of activity I might change ports.



STEVE:  Well, and it would also be a matter of the value.  You can imagine that, if this was a DoD IP or, you know, something really, you know, within .gov, that�s probably much more prone to somebody methodically just saying, well, we don�t care how long it takes.  Maybe we�ll get lucky one of these days.  Whereas this guy, you know, he�s just some random IP in Cox or wherever that, you know, doesn�t clearly have that much value.



LEO:  The other point is that, even if you move it to a non-standard port, these guys test all ports.  So they�ll test all ports for SSH response until they find your port.  So if they�re really determined to hack at you, they�re going to hack at you.



STEVE:  Well, and in fact it may not be that anyone would even bother doing a brute force.  There have been historically known security vulnerabilities in SSH.  So it could be somebody looking for vulnerable servers, which Alex probably doesn�t have.  So it�s just exactly as you say, Leo, someone scanning through IPs on port 22, hoping to take advantage of an insecure secure shell server.  So they�ll hook up, they�ll try their little hack to see if they can bust through some buffer overrun in the server.  And if not, they go away.



LEO:  Right, right.  You know, how hard you make your system, how hardened you make it, is up to you.  And, right, it depends on the value of what you�re protecting.



Mike Fattori, listening and writing in Toronto, writes:  On�a number of occasions in the past few months Steve has mentioned, somewhat parenthetically, that IP addresses cannot be spoofed because of the three-way handshaking involved with setting up a TCP connection.  We recently had a Cisco firewall expert do some consulting for us.  I asked him about IP spoofing, and he said it was all too real.  He attempted to explain how it�s done, but we were interrupted before he completed his explanation.  So is IP spoofing real, or are you and he talking about different types of�spoofing?



STEVE:  Well, I�m sorry that this guy was interrupted because I�d love to hear from a Cisco firewall expert how IP spoofing is all too real.



LEO:  He�s probably talking about raw sockets.



STEVE:  Well, yes.  He had to have been talking about something else.  It�s absolutely the case that, again, and we�ve talked about this extensively in the past, you know, on those podcasts that are not available on the � for easy�download...



LEO:  By the way, if you subscribe in iTunes from now on, it doesn�t delete old forms of the podcast.  So everything from now on will be in your iTunes directory.



STEVE:  And that�s exactly how it was intended to operate.  So anyway, the idea is, packets are just little blobs of data moving across the Internet.  The only thing that most software looks at is the so-called �destination IP.�  The source IP is also there, always there.  Every IP, that is, every Internet protocol packet, has that right up at the very front, the destination IP and the source IP.  The destination IP is where that packet is going.  In theory, the source IP is the IP of the source of that packet, which is where it came from.  But nothing validates that as packets move across the Internet.  So anybody who wants to emit a packet can pretty much make up any source IP that they want to, drop it on the �Net, and off it goes.  So, yes, that�s spoofed.



LEO:  But you can�t have a conversation if you do that.



STEVE:  Yes, and that�s exactly my point is why, when I specifically talk about the three-way handshake that sets up a TCP connection, the beauty of the security of that is that each end requires a roundtrip.  The reason it takes three packets is that the initiator sends a SYN packet, a synchronized packet.  The receiver sends a SYN/ACK, which acknowledges the receipt of the SYN, and contains its own synchronization to which the first party sends a final ACK back to acknowledge the SYN, the synchronization from the second party.  So those three packets give each end a roundtrip.  The only way each end can get a roundtrip is if all packets have the correct source IP and destination IP.  So that TCP handshake prevents spoofing.  Now, things that don�t prevent it are, for example, pings, which can just be sent out to any random IP you want.



LEO:  Or if you�re a hacker who doesn�t care about the return response, as in a SYN flood, you can spoof the originating IP because you�re not having a conversation, you�re just flooding.



STEVE:  Exactly.  Exactly.



LEO:  All right.  I�m going to give you a hypothetical.  How about in the man-in-the-middle attack?  Couldn�t a man in the middle modify the return IP address?  He knows what the real return is.



STEVE:  Yes, absolutely.  And in fact, that�s what a man-in-the-middle attack would do is he would grab the packet on its way to the other party and change the source IP to his own.  So that then the packet goes off to the other party, the other party responds back to him thinking that it�s the first party.  He then changes the source of that packet as he forwards it back to the first party to his own, basically knitting himself into the middle of a conversation.  And by the way, that�s exactly what proxies do.  Proxies are man in the middle of TCP connections.



LEO:  Oh, yeah, I guess they are. So in that sense certainly it is possible to spoof IP addresses.  It�s just not possible to spoof an IP address in a real conversation, that�s all.



STEVE:  Right.  And we�re normally talking about something where you�ve got an encrypted PC connection which, if things are done properly, even prevents a man in the middle, i.e., a proxying of that connection.



LEO:  Right, right.  David Barnes from Basildon asks, what can we as users do about the continuing spread of excessive Java and other client-side scripting use?  I�m just going to have to correct him here.  There�s Java, and there�s JavaScript.  It�s not your fault.  It�s the people at Netscape who decided, oh, we�ll call our language JavaScript and confuse everybody.



STEVE:  And you know, Leo, it doesn�t even � it�s got no connection to Java.  It�s not even � doesn�t look the same.  It�s a made-up language, completely separate.



LEO:  Well, I can�t remember the original name, but it wasn�t JavaScript.  It was purely a marketing thing.  Well, hey, Java�s hot right now.  Anyway, so he says �Java.�  I�m going to read it as JavaScript.  I recently complained to eBay that the pages were not displaying correctly with scripting off.  Well, as you might imagine, I was told I had�to use scripting on eBay, a sort of �tough, we don�t care, lump it� attitude.  I then had a quick look at the�JavaScript...



STEVE:  Script.



LEO:  ...and the include files for a normal search results page.  It totaled up over 300K.  No wonder the page is bloody slow to load with scripting enabled.  What else can us lowly sys admins and our users do?  I feel like I�m being held hostage and dictated to in how I use the Internet.



STEVE:  This is where I put the needle down on my broken record, you know, and I just say, mark my words, this is going to be a problem.  Not just the size of scripting, but it�s going to be a constant problem.  And I wanted to answer David�s question because of course I�m sympathetic to it.  As you know, I surf with scripting disabled, much as he obviously does.  In my case, I�ve seen the same thing with eBay.  So I�ve, using IE�s sort of dynamic scripting enablement system, which is using these zones of trust that IE has, eBay is in my trusted zone, so scripting is enabled automatically when I go to eBay, but not by default when I surf to random sites that I don�t trust.  So basically he�s talking about sort of the tyranny of web scripting.  And I could not be more sympathetic to him.  I mean, I absolutely agree.  I think it�s sad that we have these problems.  Of course, now, Leo, I understand you take, as you�ve said recently when we talked about this, sort of, you know, your site requires scripting like eBay does.



LEO:  Almost all sites do.  It�s just you can�t do AJAX, you can�t do a lot of user interface stuff.  You can�t validate forms.  I mean, it just goes on and on and on.



STEVE:  And sort of all of that Web 2.0 stuff that you and Amber are talking about...



LEO:  It�s all JavaScript, yeah.  Now, you can, if you really work hard, do a lot of it, as you�ve proven with your CSS, without any JavaScript, but it�s a lot of work.  And there is stuff you just absolutely have to use JavaScript.  Now, what I would say is, yeah, there are JavaScript exploits.  But they are few and far between.  I don�t think JavaScript is as dangerous as you seem to.



STEVE:  It�s just, I�m not complaining about the danger, I�m just saying philosophically it�s bad to load code from random websites you don�t know.



LEO:  But that�s what the web is.



STEVE:  That�s, well, it�s what it�s become.  It isn�t, I mean, it wasn�t there originally.



LEO:  No, if you just want static text pages, the web is�fine.



STEVE:  Except that my site runs perfectly with no scripting.  My ecommerce system, ShieldsUP...



LEO:  But your site looks like it came from 1989.



STEVE:  Well, it did.



LEO:  This is the tradeoff.  More and more we want web-based applications.  You�re going to have to load code.



STEVE:  Okay.  You�re right.



LEO:  So in my opinion what you should do, I mean, look at Java � as opposed to JavaScript � which is sandboxed.  There have been some exploits, but nothing of any severity.  You could make JavaScript much more secure.



STEVE:  Now, is Gmail JavaScript or Java?



LEO:  JavaScript.



STEVE:  Okay.



LEO:  Pretty much, well, you know, because you turn off scripting, almost every site uses scripting.  Even if just for a rollover.  Now, some of that�s laziness.  I suppose you could do it other ways.  But it�s pretty much accepted.  And as we get to a richer and richer web experience, it�s going to be more and more, not less and less.  With Flash, I mean, Flash is scripting.



STEVE:  So David and I are losing the battle on this.



LEO:  You�re going to lose this battle.  So I think the real trick is to really insist that companies that make these languages sandbox them, make them bulletproof.



STEVE:  Well, and it�s one of the things that we briefly touched on last week with UAC.  Microsoft has this notion, this concept, which is still in its infancy.  But the idea is that IE or other browsers, and email clients, things that are chatty on the �Net, things that are fundamentally less trustworthy, they will be running with less interconnection privileges in Vista, which doesn�t give them the access to the desktop and to other Windows resources that more trustworthy applications have.



LEO:  I think that�s where we�re going, absolutely.  And I think that�s a perfectly sensible way to deal with it.



STEVE:  And we�ve talked, in fact, about running sandboxes and sandboxing IE, or virtual machines, using virtual machines to create an environment of containment around these dangerous things.



LEO:  Java�s been around a long time.  And you receive very few complaints about its security.



STEVE:  JavaScript you meant.



LEO:  No, I�m talking about Java.  Java is sandboxed.



STEVE:  Oh, yes, yes, yes.



LEO:  JavaScript obviously has issues.  The biggest issue is this most recent one where you could, if somebody hasn�t changed their default password on their router, you can go into the router.  And I think that that�s a hole that can be fixed.  I mean, I think it just should be fixed.



STEVE:  But it�s a perfect example of what I�m saying, too.  I mean, yes, I know it can be fixed.  But it�s a perfect example.  You know, I�m running � my system is running scripts that I didn�t really want it to run.



LEO:  I know.  No, I know.  But that�s the web.  I mean, the question is, do you want the web to be static text...



STEVE:  Yes.



LEO:  ...or do you want it to be web services?  Do you want applications to run?  And I think people want applications to run.



STEVE:  Yeah, you�re right.



LEO:  A listener named John from Downers Grove, Illinois wonders:  I followed all the Wi-Fi lockdown instructions from your recent Episode 81 notes.  But now I see two new networks, �freetoguest� and �NRT-AIRPORT,� both unsecured computer-to-computer networks.  But they�re not real.  Network Stumbler doesn�t see them.  Any explanation from the guru department?



STEVE:  I guess that�s us.



LEO:  I don�t know.



STEVE:  Yes.  And I never made this explicit.  But that Preferred Networks list that you can see in the dialogue box in the samples, there are two different lists that you encounter when you�re using most Wi-Fi interconnection helpers, and certainly Microsoft�s default one.  There�s that list of all networks that your computer can currently see.  And then there�s that different list called Preferred Networks, and those are networks it has seen in the past.  So those you can � and that�s what he�s talking about here.  He�s got everything locked down, but he�s seeing �freetoguest� and �NRT-AIRPORT� in his Preferred Networks list.  All you have to do is highlight them and delete them.  Highlight the next one and delete it.  And they will go away.  And now that you�ve got this thing locked down, they won�t come back.



LEO:  So this may happen from time to time that new networks enter that list.



STEVE:  It could because networks that you do connect to will be added to that list because Windows thinks it�s doing the right thing by trying to reconnect to things you have explicitly connected to in the past.  The good news is you at least now, with all these updates in place, even the one today, that we talked about today, you at least won�t be broadcasting that you ever talked to those networks in the�past.



LEO:  And now our last question.  Ryan Skelton in Portland, Oregon has a different problem with Windows UAC:  I�m a serious computer user with multiple disabilities, and I must use assistive technology to enter text into all computer applications.  My concern is that the UAC secure desktop may prevent my assistive technology application from entering text into the authentication fields.  This is because it does that weird screen thing.  I understand this is a tradeoff between usability and security.  In my case, and I suspect many other disabled users out there, this usability is not merely a convenience but a necessity.  Is there a way for an administrative user to specify that a particular program should be allowed to run in a protected desktop environment?  If not, maybe I won�t be able to use Vista.



STEVE:  Well, we never talked about � and this is a great question because we never talked about disabling all of this UAC nonsense.  I certainly don�t want to be promoting it.  But this seemed a very valid place where a serious computer user is saying, I just, for whatever reason, I can�t have these pop-ups.  Now, backing off from that for a moment, I would imagine that any updates to his assistive technology would be updated to deal with this, and that there are doubtless ways of handling it.  I�m assuming that.  On the other hand, you could imagine that, if there were ways of handling it, that would be backdoors that would allow hacker technology to do the same thing.  So what I do know is that many power users are familiar with utilities like Tweak UI.  Tweak UI basically allows you to change even more settings than you can from the normal desktop.  Well, there�s a whole �nother huge array of settings that are known as �Windows policies.�  There�s group policy editor.  Those are things � it�s phenomenal how many other tweaks there are.  And it turns out that being sensitive to what changes Microsoft was introducing with Windows Vista, there are a whole bunch of new policy settings that allow you to completely remove UAC�intrusions.



LEO:  And I believe you don�t have to go that far.  You can just turn off secure desktop but still have UAC.



STEVE:  Correct.



LEO:  And that�s probably going to solve his problem.  I mean, he could certainly turn off UAC.  But you can keep UAC without getting rid of, I mean, you can get rid of that blacked-out desktop without getting rid of UAC.



STEVE:  Yes.  And if you did that, then you�re right, then the assistive technology would no longer be cut off from the secure desktop environment that is deliberately putting a moat around itself in order to prevent it from being disabled.  But I wanted, first of all, to tell Ryan that that exists in Vista so he could definitely use it if he needed to.  And I wanted to point out for all of our listeners that there is highly granular control in the Windows policies world.



LEO:  It�s really cool, yeah.



STEVE:  Yeah, I mean, there�s just a ton of stuff you can do.  And again, sensitive to what Micro- because Microsoft never wants to break anything.  So sensitive to that, they said we�re going to have an intrusive technology, but we�re going to give you all kinds of control.  In fact, there�s even, right up in the standard log-on profiles, not even down in the policy editing stuff, you�re able as an administrator to just turn off the pop-up completely, turn off that acknowledgement with a single checkbox up in the regular user configuration dialogue.  But there�s much more you can do, as well.  So I wanted to make sure that our listeners knew that that was all buried down there in Vista for people who did want, for example, and Ryan may have to, make that sort of change if UAC is really causing a problem.  It isn�t a reason for abandoning Vista.



LEO:  I should point out, unfortunately, that all of these policies are available in a very easy-to-use, the local security policy, very easy to use in Vista Ultimate and Vista Business.  But if you�re a home user, you have to go into the registry and modify a registry key.  So they don�t want home users to have that kind of capability, I guess.



STEVE:  Probably just as well.



LEO:  Yeah.  I have a good article here from HowtoGeek.com that describes this in detail.  So maybe I�ll put that link up in the show notes there.



STEVE:  Oh, cool.



LEO:  Yeah.  It just talks exactly about how to do it and even has the key for registry editing.  Well, that wraps up a list of 12 great questions.  Before we wrap up, though, I do want to thank our friends at Astaro who have been sponsoring this podcast for a long time and now are up for the entire year of 2007.  Again, we really � that support makes such a difference to Steve and me, I mean, really means that the show is working for them.  And they work for you, let me tell you.  Version 7 of the Astaro Security Gateway is out and amazing.  I�ve talked about some of the features, the fact that now email encryption is centralized so your users don�t even have to know they�re doing it, it�s just automatic.  You�ve got SSL, VPN, makes it very easy to use VPN.  It clusters now, so it scales up to 10 Astaro units in one without installing and load balancing.  It�s just really remarkable.



But the thing for the home user that I think is great is they�ve now waived the license fee for the v7 package so when you download the free Astaro Security Gateway as a non-commercial user, you get all of the subscriptions, including Astaro Up2Date, the antispam, the antivirus.  They used to charge 79 euros for it.  It�s now free.  I�ll tell you, if you are in business and you want the best appliance to protect yourself, you�ve got to check with Astaro, www.astaro.com, or call 877-4AS-TARO, and you can schedule a free trial of an Astaro Security Gateway in your business.  I use them, and it�s just fantastic.



Wow, 12 questions, 12 answers, and some really fascinating stuff, too, I think.



STEVE:  Yeah, I love our Q&A sessions.



LEO:  I really do, too.



STEVE:  Because they bring a diversity, lots of different things going on.  You know, it closes the loop with our listeners.  It�s just terrific.



LEO:  Well, Steve, we�ll wrap...



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#85

DATE:		March 29, 2007

TITLE:		Intro to Web Code Injection

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-085.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo begin a three-episode series to�discuss and examine web-based remote code injection exploits.  Commonly known as 'Cross-Site Scripting' and 'SQL�Injection,' these exploits are growing in popularity and strength as hackers discover increasingly clever ways to�exploit subtle defects in next-generation web-based�applications.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 85 for March 29, 2007:  Cross-Site Scripting, Part 1.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Nerds On Site.  Looking to grow your IT service business?  Find out how Nerds On Site can help.  Visit Iwanttobeanerd.com.



It�s time for Security Now!.  And that means it�s time to say hello to Steve Gibson from his ultra-secure, Tempest-hardened lair somewhere in Southern California.



STEVE GIBSON:  I hope it�s ultra-secure.



LEO:  You know about Tempest; right?



STEVE:  Oh, sure.



LEO:  The military spec for hardening, what, technology devices; right?



STEVE:  The idea was that anything that�s electronic has emissions coming from it.  That is, you know, any time you�ve got current running through a wire, you generate a magnetic field around the wire.  And when the frequencies are high enough, that ends up generating radio frequency emissions, which of course travel much greater distances than magnetic emissions.  And so the whole concept behind Tempest was, like in the spy era, was that you could passively monitor the emissions of things like computers and reverse engineer what they were doing, like literally what was on their screens and what people were typing and so�forth.



LEO:  They call that, I think, �Van Eck phreaking.�  At least that�s what Neal Stephenson calls it in �Cryptonomicon.�  Which we were talking about before we began here.  But we�re going to talk about books a little bit later on.



STEVE:  Yeah.  We have some errata from last week.  Actually only really one piece.  Someone commented that I messed up my ports.  We were talking about SSH and Telnet.  And I know what the port numbers are, but I just got myself scrambled up there.  So just for the record, in the errata category, FTP uses two ports, 20 and 21.



LEO:  That�s where I went wrong.  I said 21, and you said no, that�s not, that�s the Telnet port.  So FTP is 21, okay.



STEVE:  Exactly.  FTP is actually 20 and 21 because, remember, the FTP uses two channels:  one, a so-called control channel, which is where the client and server talk to each other about what they�re going to be doing; and then a separate port is the data channel.  So they have a control and a data channel instead of...



LEO:  And doesn�t it create a random port for the transfer, and that�s why you have to use passive FTP because it�s an�incoming random port that the server sets up?  I seem to�remember...



STEVE:  The way it works, actually, is that in the normal sort of � the default FTP is called �active� FTP, or �non-passive� FTP.



LEO:  Normal, right.



STEVE:  Normal, yeah.  What�s tricky about it, and in fact this caused problems traditionally for people behind NAT routers, is that these connections go in opposite directions.  That is, you the client, you connect into the FTP server, and then the server connects back to you.  So the idea being that you would say to the server, hey there, I want a connection, and you can connect to me on this port.  So you tell the FTP server what port to connect back to you on.  And so the client is also a server in the sense that it�s going to accept an incoming reverse connection from the FTP server.



The problem is that, if you happen to be behind a NAT router, you know, computers behind NAT routers hopefully don�t have to know that they�re behind NAT routers.  They don�t have to do anything special.  So the problem was, as we know, NAT routers make really good firewalls, hardware firewalls.  So here the FTP client connects out to a remote FTP server.  And it creates � it sort of starts listening on some high-numbered port on its computer, saying hey, remote server, connect back to me.  But when the remote server tries to connect back to it, it�s blocked by the NAT router because the NAT router has no idea that, you know, what�s going on.  It thinks this is just an unsolicited packet.



So there were two solutions.  The first was to change the FTP protocol in so-called �passive� mode so that both connections are outgoing from the client, and that solves the NAT router problem.  The cooler solution, which now all contemporary NAT routers support, is they�re smart enough to see a packet going out to port 20 of the remote FTP server and to literally look inside the packet to interpret the packet in the same way that the FTP server will, where it says make my reverse connection on this port.  So the router dynamically opens that port for the FTP server�s reverse connection.  So it allows regular active FTP by being � basically by participating in the FTP protocol.  Very cool.



LEO:  So, and then just to finish, we said Telnet wrong and SSH wrong.  So what are the ports for Telnet and SSH?



STEVE:  SSH is 22, and Telnet is 23.



LEO:  23, that�s it, okay.



STEVE:  Exactly.  And it�s funny, too, because I wanted to � when I was making sure that I wasn�t going to get myself scrambled here, I said, well, I�ll just use GRC�s Port Authority.  I�ve got a cool facility on GRC.  I don�t even know if you know about this, Leo.  But if you just go GRC.com/port=something, like port=23, my server sees that.  And any kind of URLs of that form, it�s very flexible, and it will immediately take you to one of our Port Authority Database pages.



LEO:  And so we just go there, and we look it up, and now we�know.



STEVE:  And now we know.



LEO:  And we should have done that in the first place.  But we were doing it off the top of our head, anyway.  Hey, before we go much further I just want to mention the great folks, as you know, who are back sponsoring the show, the Nerds On Site.  I think they need a jingle [singing].  I don�t know, maybe...



STEVE:  Oh, Leo, you may not want to ask them for that.  That could be really scary.



LEO:  Nerds On Site is actually a neat idea.  It�s a guild or a, I don�t know...



STEVE:  Federation?



LEO:  Federation maybe, yeah, of tech support specialists, IT experts.  So the idea is you�re still an independent contractor, you�re in business for yourself, but you�re not by yourself; so you can focus on your passion, not the burdens of running a business.  Worldwide, seven countries.  In fact, I think they added an eighth country.  It�s Canada, U.S., Mexico, England, Australia, South Africa, Bolivia, and�more.  And if you�re in business doing any kind of thing, whether it�s fixit technicians, website designers, programmers, project managers, even sales, trainers, security experts, antivirus gurus and more � but they especially love, of course, those folks, those nerds who troubleshoot, tear apart, and rebuild their own systems in�their spare time � go to Iwanttobeanerd.com and register�for�a Nerds Only meeting in your area today.  Like�minds, building a business, it�s a great idea.  And I�m�really glad that we can help them out.  Nerds On Site.��Iwanttobeanerd.com.



STEVE:  And I guess since they initially gave us a relatively short three-week run and now have re-upped for three months, it must be that there�s a good intersection between our listeners, Security Now! listeners, and the kind�of people that they�re hoping to find through this campaign, Iwanttobeanerd.



LEO:  A lot of nerds listening, I think, Steve.



STEVE:  Well, speaking of which...



LEO:  I don�t want to depress you or anything, but I think that�s the fact.



STEVE:  No, you know, these are our people, Leo.



LEO:  One of us.



STEVE:  I�m one, god knows.



LEO:  Someday we�re going to tell the story which I just�recently learned about your wine cellar that you�re�designing.



STEVE:  Oh, my radio telemetry � we�ll do that sometime.  We�ve had a lot of feedback, very positive feedback, from people who have followed our mentions in the past of Peter F. Hamilton�s books.  We talked about �Pandora�s Star� and then the sequel, �Judas Unchained,� and recently �Fallen Dragon.�  We had a bunch of comments back from people saying, wow, I really loved �Fallen Dragon,� and specifically saying, you know, what else do you know?  Who else have you discovered that is equally good?  And I have to say that the kind of sci-fi I like is more along the socalled hard sci-fi variety.  I�ve never really understood why wizards and unicorns and things are in the sci-fi section of bookstores.  It�s so annoying.



LEO:  They�ve got nowhere else to put it.



STEVE:  I guess.  But I don�t think that�s science fiction at all.  It�s fiction-fiction, you know, fantasy.  And I guess often you see, like, fantasy and sci-fi.  Well, to me these are completely different genres.  But I did want to share, thanks to the quest from people for additional authors, I wanted to share another one of my finds that I am very excited about.  This is a guy who is literally a rocket scientist.  He designed pumps that are on the international space station.  He�s an aerospace engineer located out in Arizona.  And he writes really good science fiction.  He�s got a site, and we�ll put a link to this on our episode notes.  It�s scifi-az.com.  His name is Michael McCollum.



And actually he and I were just exchanging some email because I wanted to find out about the various formats he offers.  He has his books in paperback, so you can buy them that way, but also electronically downloadable, both PDF, Microsoft Reader, and in Palm format.  And he just released the sequel to a book of his that I had read, I don�t know, about a year and a half ago, that I really liked.  It was called �Gibraltar Earth.�  And I was telling you about it a little bit before we started recording.  Humanity has never encountered any other aliens, and we�re out in the future exploring around, and we stumble upon evidence of a vast intergalactic race that is so powerful that it just stomps, basically it enslaves any other species that it encounters.



LEO:  Yeah, baby.



STEVE:  And they don�t know that we found out about them, so we scurry back to Earth with our tail between our legs, and the story unfolds from there.  Well, he�s just done a sequel to that, that I haven�t read yet, that I just discovered because I was looking up his site in order to tell our listeners about him.  But there�s another trilogy, the Antares trilogy, which is just spectacular.  So anyway, I give it my unrestrained � obviously � full recommendation.  All of his stuff is really good.  He also has some freely downloadable short stories.  I�ve not read them because I�ve�just found his regular stuff to be so good.  So without�reservation I can recommend this Michael McCollum at�scifiaz.com.



I don�t have any sense for how much people enjoy the eBook experience.  You know that I�m a major eBook reader.  And in fact you and I, Leo, have both just purchased the new Sony ePaper reader.  I�ve seen it.  I have not yet used it.  But I�m excited to give it a try and see how it feels.



LEO:  I just got it yesterday.  And I used it last night, and I read quite a bit of Neal Stephenson�s �Quicksilver,� which I had in hardcover.  But I thought, well, I don�t want to carry these to Canada.  They�re too big.



STEVE:  Well, especially Stephenson books are like, I mean, they�re like carrying an encyclopedia around with you.



LEO:  So I bought the Quicksilver trilogy.  And the funny thing is, it�s only 10MB, all three books, which is three huge books.  And I put them and a bunch of other stuff, and I haven�t even � there�s 100MB worth of storage to start with on that eBook reader, and I still haven�t filled it up.  It�s taken me � I�m not used to reading on an electronic device.  It�s small and lightweight, very thin.  And it feels like a paperback.  I got a little booklight for it, too, because you need ambient light.



STEVE:  Right, because it�s an ePaper display, which is to say they actually have got bi-colored spheres, white on one side, black on the other, and they electrostatically rotate the spheres to either have their white face front or their black face front.  And then the beauty is, once you�ve spun these spheres, they require no power because they�re in a viscous medium.  They just hold their position.



LEO:  It�s very clever.



STEVE:  And ePaper, we�ve been reading about it for literally, I think, decades.  But it�s one of those ideas that�s been on the drawing board and hard to actually put into production.  And but Sony, as far as I know, is the first commercial ePaper technology.  And what�s cool about it is battery life issues just go out the window.  They say you can read all of �War and Peace� four times on a single charge.  So there�s just none of that.



LEO:  Well, we�ll see.  I have a lot of books on there.  And�I have the Antares trilogy; and I�m now, on your recommendation, going to buy the Gibraltar books.  And unfortunately I had the Antares trilogy in Microsoft LIT format, which is an incompatible format.  But I�m going to get a PDF.  I wish more authors would do it.  There are quite a few books I can�t get, including, I mean, only �Pandora�s Star� is the only Peter Hamilton book in the Sony CONNECT library.  But I don�t care if it�s Sony CONNECT.  Just put it on PDF, and I can read it.  And I would love�that.



STEVE:  And I really appreciate this, too, and I know you will.  Michael does not...



LEO:  No copy protection.



STEVE:  Exactly.  He does not � well, except I wonder about�the...



LEO:  The LIT format is, yeah.



STEVE:  Yes.  The Microsoft Reader would be.  But it is a nonprotected PDF.  I read his license page yesterday also.  And he said, look, you know, I�m doing this because I want to trust everybody.  Please don�t post these.  Please pay for them.  Don�t share them.  If you like my work and you want more � and believe me, I really want more.  This guy, his books are just so good.  He says, you know, pay for them, don�t steal them, and then this can work.



LEO:  Well, I�ve paid twice now for Antares.  And I don�t mind.  It�s so cheap.  15 bucks for three books, come on.



STEVE:  Oh, and Leo, let me tell you, you have a treat in store for you with this Antares series.  It�s just so good.



LEO:  Now I have too much stuff to read.  This is a bad thing.  This eBook reader has literally now 20 or 30 volumes on it.



STEVE:  And how did you find � I have not yet had the Sony ePaper experience.  And you know that I don�t mind looking at a little tiny Palm Pilot screen.  How did you find that�screen...



LEO:  It�s pretty good.  You know, you can set the text size to small, medium, or large.  And of course I�m getting old, so medium was good for me.  It isn�t high contrast.  I would like it if it were a whiter background with black text.  It�s a little gray.  But it�s fine.  I mean, it�s better than a Palm, I think.  And it�s certainly a bigger screen than a Palm.  And the only other thing that bugs me a little bit, there are two different ways to turn a page, neither of which is very natural.  At least not for me.  And there�s a flicker when you turn the page which I find a little annoying.  But these are minor.  And I did find it easy on the eyes, and I read quite a bit.  I read about 20 or 30 pages last night, and I didn�t have any eye fatigue.  So I think it�s going to work, you know, be great for an airplane and great for traveling because I can now have my whole library with me.



STEVE:  Yeah, I�m really fanatical about battery issues.  And so if I�m reading in a restaurant and the waiter comes over to talk, I have to, I mean, I do, I turn the power off.



LEO:  You won�t have that problem with this.



STEVE:  Well, exactly.  With this you literally � you just don�t even worry about it.  You just lay it down because it�s not consuming any power.



LEO:  And it looks a little bit like a paperback.  You know, it�s thinner than a paperback, but it�s not much bigger.  And so that�s kind of, I mean, you don�t look like too much of a weirdo.



STEVE:  Yeah.  And it plays music, too, doesn�t it.



LEO:  I�m not sure how the battery life would be with that.



STEVE:  Yeah, it would probably pretty much kill it.  Well, I had one SpinRite fun story that I wanted to share.  I�m not going to read Tom�s last name because, well, you�ll see when I read the story why he may not want me to identify him.  He said, �Steve, I looked all over the site and could not find anywhere to leave some feedback.  So I�m mailing you here.�  I think he must have sent it to our support email, and then Greg forwarded it to me.  He said, �I�m a Windows systems administrator, and I�ve been dealing with bad hard drives for quite a while.  I�ve been listening to TWiT and Security Now! since the beginning.  I�ve been trying to get my boss to purchase SpinRite for years, but it never seems to be in the budget.  Since I am a father of two small boys, and daycare costs are killing me, I�ve not had the funds to purchase SpinRite for myself.  But I have heard and read many of the testimonials and would love to try a copy.�  So he says, �Finally last week a co-worker came to me with his dead laptop.  He had all of his wedding photos and many hundreds of dollars� worth of downloaded music on his drive.  I looked at the laptop and knew for sure that SpinRite could fix his problem.�



LEO:  I wonder how he knew that.



STEVE:  How would you � why would you think that?  And so he says, �Well, I got a copy of SpinRite through some nefarious�means.�



LEO:  Oh, shame on you, Tom.



STEVE:  And he said, �Sorry, Steve.  And sure enough, SpinRite brought the hard drive back to a working state, and I was able to recover everything.�  He says, �When my co-worker found out that I got everything back for him and made backups, he was delighted.  He asked me what I would want in payment.  I said $89.  He looked at me strangely and said, why 89?  I told him about SpinRite and how I got a copy.  So right then and there he pulled out his credit card, and we went to GRC.com and purchased SpinRite.  I feel a lot better now, having a legal copy.  Thank you, Steve, for the great product.  And I can�t wait to help others in the future.�



LEO:  It�s a nice tool to have because � for exactly that reason.  When people come to you, you can say, well, let me try SpinRite on it.  And it�s really nice to own, I have to say.  It is well worth the 89 bucks.  That�s neat.  What a nice story.  And a happy ending.  He ended up buying it.  That�s great.



STEVE:  And you know, frankly, I don�t have any problem with that.  I mean, it�s why I read this.  Technically piracy, well, yes.  But I recognize that not everyone who needs it is going to buy it.  I really appreciate it, obviously, when people do because it�s what keeps me on the air, literally.  So it�s a win for everybody.



LEO:  That�s great.  Well, thank you, Tom, for sharing your story with us.  And now what are we � we haven�t told anybody what we�re going to talk about today.



STEVE:  No, 20 minutes in, and this is a big mystery.



LEO:  Well, if you heard the title and you heard me announce it, I guess you probably know.  We�re going to talk about something that is a big security issue.



STEVE:  Wait, wait, wait.  Are you announcing this some other time?  I don�t think you even gave us the title yet.



LEO:  Well, you don�t hear it, but at the beginning of every show I say welcome, and I tell them the name of the show and the date.  Just so that if you�re listening on a shuffle or something, and you don�t have a readout, you know whether you�ve heard this one or not.  So they know that this is Cross-Site Scripting Part 1.  They may not know what that means.  But they know what we�re talking about.  So what are we talking about?



STEVE:  Yeah.  It�s something that we have never yet touched on, I don�t even think at all.  Most of the time we�ll swing by some topic when we�re talking about something else, and then move on, and then later, weeks or months later, come back to really focus on something that we�ve talked about before.  I would generalize cross-site scripting a little bit more and say that it is about web-based code injection.  And cross-site scripting is one major way that that can�happen.



LEO:  The other one is buffer overflows.



STEVE:  Well, no, because that�s not necessarily web-based.



LEO:  That�s a technique.



STEVE:  Exactly.  Well, in fact, we�ve of course extensively talked about buffer overrun issues.  And in buffer overrun issues a hacker is injecting executable machine code, essentially, directly into some other application over a communications connection.  So you�re certainly right that that is also remote code injection.  In this case we�re talking sort of about web-based apps which turn out to have a disturbing number of vulnerabilities to this kind of exploit.  But the second type is something called Sequel Injection, or SQL Injection, SQL having pretty much become the de facto dominant database language because it�s, you know, there�s now Open SQL, MySQL.  Microsoft of course is pushing SQL, or Sequel, as that acronym is often pronounced.  And it turns out that because SQL is scriptable � you know how I feel about scripting, Leo.



LEO:  Yes.



STEVE:  There�s all kinds of problems there, too.  So for a long time I�ve had this on my list of things to talk about.  But something happened last Saturday afternoon on the East Coast that sort of said, okay, now is the time to discuss this.  So this is a big topic.  And because we�re doing an audio podcast, and I want to make sure people are able to visualize this, I�m not going to try to cram too much content into this first introduction.  So this week is sort of introduction to this issue.  This will be sort of the teaser for what I think will be the next two weeks.  And then the week after that we�ll be back to one of our Q&As where we�ll be able to tie up any loose ends and answer any questions that have come about from talking about this.



So what happened last Saturday was that a guy named Billy Hoffman from SPI Dynamics, which is a well-known, good-reputation, security research firm, he gave a presentation at a funny-named hacker conference called ShmooCon.  It�s a three-day � it was Friday, Saturday, and Sunday � a three-day East Coast hacking conference.  The title of his talk was �JavaScript Malware for a Grey Goo Tomorrow.�



LEO:  I like it.  I don�t know what it means, but I like it.  The grey goo is in that nanotech problem that people have raised?  Maybe if there were too much nanotech we�d all become grey goo?



STEVE:  Just be reduced to grey goo, just sort of like thoroughly homogenized.



LEO:  A slurry.



STEVE:  Okay.  So leading up to this there were a couple interesting stories.  And in fact afterwards � that is, stories in the news.  And I want to run through these quickly because they are full of really good quotes from Billy and other people.  In eWEEK this basically was covered under the subject �Tool Turns Any JavaScript-Enabled Browser into a Malicious Drone.�



LEO:  Wow.



STEVE:  A new tool too dangerous to give away can turn any PC � Windows, Mac, Linux � or any device with a browser into a site attacker.  The tool, called Jikto � that�s actually �J� stands for Java.  There was an earlier tool, a web vulnerability scanner called Nikto.  Of course �nikto� is a�word...



LEO:  Nikto barada...



STEVE:  Exactly.



LEO:  From �The Day the Earth Stood Still.�



STEVE:  You definitely have your geek hat on.



LEO:  Klaatu barada nikto.  That�s what you had to tell the robot to save the Earth.



STEVE:  Well, because the robot�s name was Klaatu.  And so you had to address Klaatu, and then give him this coded phrase.  So anyway, this is not Nikto, this is Jikto, Jikto.  It�s a web application scanner that searches for cross-site scripting vulnerabilities.  Billy Hoffman, a security researcher with SPI Dynamics, demonstrated what the tool could do at the ShmooCon hacker convention on March 24th, namely Jikto, which is written in JavaScript.  Okay, JavaScript.  You know how I feel about lovely JavaScript.  How you feel about Web 2.0, Leo, and I know that [audio glitch].  But this can surreptitiously latch onto a browser�� and remember, any browser, Windows, Mac, Linux � that has JavaScript enabled.  After silently inserting itself to run inside any browser, be it that of a PC or even a cell phone, Jikto can then search sites for cross-site scripting vulnerabilities and report its findings to a third party without the user of the infected browser being aware.



So get this.  You go to a site with JavaScript enabled, which we understand most people have to have to get the functionality of Web 2.0 and all the fancy stuff that�s being done these days.  Or you receive email, and you�re using a web-based email viewer, as most people are by default.  One way or another, this JavaScript runs.  Basically it commandeers your browser on the spot, turning it into a scanning tool which will then scan other websites for vulnerabilities and report what it finds to a third party.  And so Hoffman says it can also replicate itself onto sites containing cross-site scripting vulnerabilities, meaning that it has the capability of also being a worm which can self-propagate and then spread via latching onto other visiting browsers.  This is something that JavaScript wasn�t supposed to be able to do.  But unfortunately, Hoffman says, it can.  And he demonstrated it.



So that was one, that�s part of one story.  Then I wanted � there were some more good quotes in � a guy named Joris Evers, who reports for CNET News, wrote a story before and after.  And there was a bit of controversy stirred up by his first story, which was � there were, like, blogs about it because he either made a mistake or believed, one way or the other, that Billy Hoffman was going to release the JavaScript code for this at the conference.  Maybe they said so; maybe they changed their mind.  It�s not clear.  But Joris�s first story says, �A security researcher has found a way hackers can make PCs of unsuspecting web surfers do their dirty work without having to actually commandeer their systems.  That�s possible with a new security tool called Jikto.  The tool is written in JavaScript and can make PCs of unknown web surfers hunt for flaws in other websites, said Jikto creator Billy Hoffman, a researcher at web security firm SPI Dynamics.  Hoffman, who developed the tool as a way to advance web security, plans to release Jikto publicly later this week at the ShmooCon hacker event in Washington, D.C.  �This is going to drastically change the scope of evil things you can do with JavaScript,� Hoffman said.  �Jikto turns any PC into my little drone.  Your PC will start attacking websites on my behalf, and you�re going to give me all of the results.�



�With the advent of online applications, hackers have shown increased interest in breaching web security through vulnerabilities such as cross-site scripting bugs and SQL injection flaws.  Even though these have been around for years, such security problems are increasingly being reported and exploited.  �Jikto is a web application vulnerability scanner.  It can silently crawl and audit public websites and then send the results to a third party,� Hoffman said.  �Jikto can be embedded into an attacker�s website or injected into trusted sites by exploiting a common web security hole known as cross-site scripting�flaw.��



Vulnerability scanners by themselves aren�t new.  Hackers often use such tools to find holes that let them break into systems.  Jikto is like Nikto, a web application bug scanning tool popular among hackers.  The difference is that Nikto is a traditional PC application, while Jikto runs in a web browser and distributes the bug-hunting task across multiple PCs.



LEO:  Like SETI@home for hackers.



STEVE:  Exactly.  We�re all familiar with the whole problem of bot fleets and distributed DoS attacks.  Now we�ve got distributed vulnerability scanning courtesy of Jikto, which is just written in JavaScript, which was originally designed not to be able to do this kind of thing.



LEO:  Now, he didn�t release the code.  He just demonstrated it working.



STEVE:  Correct.



LEO:  We don�t know exactly what it�s doing.  It may in fact be calling a Nikto server somewhere.  In fact, I suspect it probably is.  You wouldn�t write Nikto in JavaScript.  You couldn�t really make that something you could...



STEVE:  Well, the code has leaked.



LEO:  Oh, it has.  Oh, well.  Now we�ll find out.  And the reason I mention that is because, if it does do something like that � and this is an example of why security � this happens all the time that they demonstrate these flaws at security conferences, but they don�t give enough details to really know.  And for instance, if this requires a Nikto server somewhere, you would be caught red-handed at some point because it would be calling your server, and people would know who you are.



STEVE:  Yes.  And again, I�ve not looked at the code.



LEO:  That�s an example of a potential flaw that you wouldn�t know until you saw the code.



STEVE:  Well, and the other thing, too, certainly if it�s going to be returning its results back to, for example, its originator, then certainly you�re able to look at the code and track that down, too.  The problem, of course, is that these could be sites where you�ve got an unfriendly nation or an uncaring nation with whom we don�t have a relationship.  Or they could use the same sort of obscuration techniques that the IRC chat servers do.  For example, it could log to an IRC chat channel and send its results into the IRC cloud, where it just disappears because�it�s being relayed autonomously from one IRC server to another.



And the biggest problem is that, as is always the case with these things, once someone knows it�s possible, it�s not hard to recreate it.  That is to say, just the fact that this has made the news, that we�re talking about it, it�s been blogging all over the place, if you put Jikto into Google now you get just pages of this stuff.  So now it�s known that someone did this.  And once you know that someone did this, it�s just not difficult.  Everybody is smart out there who�s involved in this.  And so it�s just not difficult to recreate these kinds of results.



LEO:  And you said it�s leaked out.  So even if you weren�t�smart.  That�s what I worry about.  I don�t worry about the guys who are smart enough to figure it out.  I worry about the script kiddies who aren�t, but will use this�maliciously.



STEVE:  Well, yes.  And in fact, it�s interesting because there are papers that have been written by researchers as much as ten years ago.  In fact, I�ve got one here that was put together by a bunch of Microsoft guys in early February of the year 2000.  And I just want to read verbatim what they say about cross-site scripting.  They say, under �Consequences of the Attack� � and I�ll put links to this whole paper, and we�ll be talking about this again.  And we�re going to get into the real detail, the nitty-gritty of what this is, next week and the week after, although week after we may talk about SQL Injection because it�s related but not the same.



But Microsoft writes, �Assuming that a particular web server is vulnerable to cross-site scripting attacks, the attacker can run a script in the wrong security context.  This means that cookies can be read, locked-down plug-ins or native code can be instantiated and scripted with untrusted data.  User input can be intercepted.  Any web browser supporting scripting is potentially vulnerable, as is any web server that supports HTML forms.  And even HTTPS, that is, secure sockets connection, a secure connection provides no immunity.  Data gathered by the malicious script can be sent back to the attacker�s website.  For example, if the script has used the DHTML object model, that is, dynamic HTML, to extract data from a page, then it can send it to the attacker by fetching a URL.  As long as the user navigates within a given domain, that is, within the same domain, a robust exploit script can follow the user.  This attack can be used against machines behind firewalls.  Many corporate local area networks are configured so that client machines within their LAN trust servers on the LAN, but do not trust servers on the outside Internet.  However....�  So it�s a way of breaching those zones of trust.



It says, �However, a server outside a firewall can fool a client inside the firewall into believing that a trusted server inside the firewall has asked it to execute a program.  To do this, all the attacker needs is a web server inside the firewall, like the corporate Intranet server, that doesn�t check fields in forms for special characters.  Only one page on one web server in a domain is required to compromise the entire domain and network.  This is true even if the vulnerable web server doesn�t hold any important data.�  Because of course it can be used as a jumping-off point.  �It can still be used as part of an attack on other machines within the same domain.  All web servers should guard against this attack, even ones that don�t perform critical tasks.�



So, okay.  In a nutshell, and this is what we�re going to expand upon next week, the big problem is sort of a gotcha, that the originators of HTML and Web never thought about.  And that is, what happens when, for any reason at all, users, that is, clients of a web server are able to provide anything that is going to be redisplayed.  And that�s the fundamental flaw in the web architecture.  That is, originally, in day one of the Web, as we know, web servers were serving static pages.  That is, users would go and, you know, you just clicked on links, and you looked at pages that the webmaster and his people had created for people to download and view.  That is, browsers were simply browsers.  They looked at static pages that never changed.  Every time you went back you saw the same page.



Then of course little additions were made, like web counters, like how many visitors have been to this site, or how many visitors have viewed this page.  So there we were seeing a little bit of dynamic content.  But of course the whole big explosion in the �Net came, or especially in the Web, came from making sites interactive.  Any kind of a forum is an interactive site.  DIGG is an interactive site where, anytime users are able to post content to the server, which it will then serve to other users, it radically changes the rules because what happens is you immediately get an interaction between the notion of trusted content coming from a server and the fact that you are displaying content from an untrusted source.  That is, you know, anybody can log onto an open forum and post their comment.  When they do that, text that they�ve provided is then being stored by the server and is being redisplayed to other people who visit the site.



Well, here�s the problem.  There is no separation between textual displayed content and executed scripting content.  That is, because of the evolution of the Web, there was no really clear and clean delineation between text that the web server sent your browser, which you would see, and text which it would execute.  In fact, all you have to do is have an open bracket, you know, �less than� sign, the word �script,� and then a closing bracket.  And then anything after that, until the closing script tag, is treated as scriptable content.  And arguments to that script tag tell the browser what kind of scripting it is, what language, what version and so forth, so that it�s able basically to turn its scripting engine loose on whatever this text is in between these tags.  And it turns out there are a bunch of different tags that will end up causing the interpretation of text as script, which is to say, you know, to run scripting; and that all you need to do is � all an attacker needs to do is figure out some way to get a web server to serve this script when it thinks it�s serving just non-executable text.



And even after this problem was known, it turns out that there are still very clever ways of finding holes in the prevention of this.  For example, you would imagine that you could simply tell your web server, strip out any bracketed things, that is, anything with a bracket and a closed bracket.  Well, there are normally exceptions.  People want to be able to put italics in their postings or underline words in their postings or have some formatting controls.  And it turns out that exceptions in the way text is parsed have still allowed holes to be found.  And that�s, for example, what the so-called �web vulnerability scanners� are�scanning for, is they�re looking for any sorts of active�content.



Historically, web servers even came with a bunch of default pages and default scripts which were vulnerable.  So you could just have, for example, there were some versions of Microsoft�s IIS where, when you installed the server, it gave you a whole bunch of, like, starter pages, which many � you know, like sample pages � which many people left alone.  And they were vulnerable to cross-site scripting, so people would immediately be able to leverage them.  And in fact, this is one of the ways, you know, we�re always hearing about websites being defaced, you know, sites being changed, home pages changed and so forth.  It has been these kinds of cross-site scripting which allows those kinds of defacement to happen.  That�s been the enabling technology.



LEO:  Well, I guess we�re going to have to rethink the enabling technology, then.  I mean, it�s a little scary.



STEVE:  It really is scary.  And, yes, it�s powerful that you can have inline scripting just mixed right in with your text.  But the fact that you can do that, the fact that, for example, scripting isn�t somehow sequestered completely separately from content, but in fact is just a form of content, and it is, I mean, to say it�s active or alive, I mean, that�s almost an understatement.  It�s hyperactive.  And it really does create an opportunity for exploits.



LEO:  So we�re going to continue to cover this subject in the next couple of episodes, give you some more in-depth look at how cross-site scripting works and so forth.  In fact, what are we going to talk about next time?



STEVE:  Next time will be some exact examples of all the very things that a web server � the few mistakes a web server needs to make in order to allow cross-site scripting exploits.  I�m going to get very specific with some examples and walk our listeners exactly through, for example, how you could end up with another � with an attacker capturing your cookies, which is your log-on credentials for a site like Amazon or eBay, which would allow them to then assume your identity and take it from there.



LEO:  And meanwhile, you might want to download Nikto and run it against your sites, see if you�ve got any of these vulnerabilities.  I presume Nikto does a good job of it.  I don�t know of other programs that can do the same thing.  But that�s very interesting, very interesting.  It makes you want to go out and get Astaro�s Security Gateway right now and run it everywhere you can.



This show is brought to you, as I mentioned, and I do mention every week, by the good folks at Astaro Security.  They make the great Astaro Security Gateway, which is a security appliance that runs on open source software.  The newest version, Version 7, is out now, with email encryption at the server side, and so you don�t have to worry about it on the client side, at the device.  Also secure remote access via SSL VPN, which is fantastic.  And scalability via clustering.  Astaro�s developed a unique brand of active clustering that enables a load distribution for as many as ten gateways, eliminating the need to install additional load balancers.  It�s very cool.  It�s a patent-pending technology which really increases the speed and reliability of network traffic.  So you know when you�ve invested in Astaro�s Security Gateway, you can grow it as your enterprise grows.



And don�t forget, by the way, home user licenses are available for free for the v7 package, including all subscriptions and Astaro Up2Date.  That�s a great deal.  Astaro, find out more by visiting on the web at www.astaro.com.  Or if you�re so inclined you can also find out more about Astaro.  In fact, go to them and sign up for a free trial of the Astaro Security Gateway in your enterprise by going to 877-4AS-TARO.  Wait a minute, let me check that and make sure that�s right because I actually don�t have it sitting in front of me.  I have this all memorized now.



STEVE:  It sounds very familiar, Leo.



LEO:  It sounds like the right number.  But let me just look it up.



STEVE:  In the meantime, while you�re doing that, I�m going to correct my own errata from the beginning of the show.  Even as I said it I knew I was misspeaking.  And so for anyone who has already sent off email telling me that I�ve still got my FTP ports backwards, I mean, I know so well that the server listens on port 21.  And I�m sure that I said it listens on port 20, which I know is not the case.  FTP is the main, is the control channel for FTP, the server listens on port 21; and then it�s port 20 that is the reverse channel, the data channel.



LEO:  I always thought it was a random port.  I must have misunderstood the spec when I was looking at it.



STEVE:  Well, it�s random at the client end.  But because...



LEO:  Oh, okay, yeah.



STEVE:  Yeah.  So it�s whatever port the client is able to be assigned by the OS.  Remember that service ports are only able to be opened � okay.  Service ports are those ports from 1024 and lower.  Those are only able to be opened for listening by privileged processes in UNIX so that clients are unable to listen, for example, on 21 and 20.  They�re able to listen on high-numbered ports.  So the idea is that the client makes the remote connection to the server on port 21 and says, I�ve just opened port whatever, 32654.  Connect back to me.  And so the server connects from its port 20 up to the client�s specified port number.



LEO:  Okay.  Got it.  And...



STEVE:  Fixed my own mistake there.



LEO:  And the number of Astaro is � I was right � 877-4AS-TARO for a free trial in your home.  We thank them for their support.  Well, I think now we have � this is the first time we ever had an errata correction in the actual show, correcting an errata at the beginning of the show.  So that�s impressive.  The turnaround�s getting very quick on these errata.  Steve, lots of fun.  We�ll come back next week and talk more about cross-site scripting.  And of course your questions should continue to flow to GRC.com.  He�s got a form there.  I�m sure it�s safe.  Tested for cross-site scripting.



STEVE:  Yes, because I�m not displaying anything that anyone posts.  Although, Leo, I have to say, I will confess that GRC did have a cross-site scripting vulnerability years ago.



LEO:  Oh, interesting.



STEVE:  Back when IIS, Microsoft�s IIS was having so much trouble with its own URL parsing, remember there were all kinds of exploits where you were able to, like, put funky Unicode characters in the URL in order to get IIS to misbehave.  And I was unhappily using IIS.  And I didn�t have any sort of filter.  So I wrote my own URL pre-parsing filter to intercept any and all incoming URLs before they got to IIS.  And what I did was I had a page that would intercept and say � oh, I called it the APF, the Advanced Prophylactic Filter, because it was a prophylactic for IIS that would basically protect IIS from any badness trying to get in.  And what it did was, when you got intercepted by this, it showed you the URL that was illegal.  Oops.  Because what that meant was that the user was providing something, anything, which could cause the server to redisplay it, even as an error message.  And so that created a cross-site scripting vulnerability, which someone pointed out to me and I quickly changed.  So it�s like, yeah, I mean, it�s so easy to do.



LEO:  It is.



STEVE:  You have to be just ever vigilant.  It�s very much like, although different, of course, from the buffer overrun problem where it just requires so much vigilance.  And so the problem is, with all of our contemporary sort of next-generation Web 2.0 applications, which are all about, like, you know, Wikipedia and DIGG and online forums and communal blogging, any situation where the server has any reason to display what someone provides, that creates real trouble due to the fact that text and script, they�re able to cohabitate on a page.



LEO:  Right.  Well, go to GRC.com.  Look at that form.  Find a hole.  Find a flaw and let us know.  Meanwhile, while you�re there you can download 16KB versions of this podcast, and Elaine�s great transcriptions so you can read along.  On complicated subjects like this I think it�s always helpful to read along as you�re listening to Steve.  You can refer back to it, show the boss, explain why you have to recode the entire site, all of that is at GRC.com along with all of Steve�s free security software and the great SpinRite, the world�s finest disk recovery and maintenance utility.



Steve, we�ll wrap this up, but we�ll reconvene in a week.  What do you say?



Copyright (c) 2007 by Steve Gibson and Leo Laporte. SOME RIGHTS RESERVED.  This�work is licensed for the good of the Internet Community under the Creative�Commons License v2.5. See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#86

DATE:		April 5, 2007

TITLE:		Cross-Site Scripting

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-086.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  In this second installment of their three-part coverage of web-based remote code injection, Steve and Leo discuss cross-site scripting vulnerabilities and exploits.  Steve quickly reads through the 28 vulnerabilities discovered in popular software just during the previous month and discusses the nature of the threat and challenge facing authors of modern 'dynamic' web sites and services.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 86 for April 5, 2007:  Cross-Site Scripting, Part 2.



Security Now! is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.astaro.com.  And by Nerds On Site.  Looking to grow your IT service business?  Find out how Nerds On Site can help.  Visit Iwanttobeanerd.com.



It�s time for Security Now!, our second episode of the week because we had a special on the problem with the animated cursor vulnerability:  [64 kbps:  http://media.grc.com/sn/SN-085a.mp3; 16 kbps:  http://media.grc.com/sn/SN-085a-lq.mp3].  That was on Monday.  Trust you�ve solved your problems with that.  Steve Gibson�s back now to resume our conversation about cross-site scripting.  Hey,�Steve.



STEVE GIBSON:  Hey, Leo, great to be back with you.



LEO:  What�s the update on the animated cursor, by the way?



STEVE:  Exactly.  I was just going to say it�s worth making sure that everyone has run Windows Update.  Microsoft did, as we expected and as they had stated, push out an out-of-cycle, single-vulnerability fix just for this problem on Tuesday, which would have been the 3rd.  And so that�s a week earlier than their normal second Tuesday of the month patch cycle, which apparently they�re still going to have a bunch of other stuff that they�re going to be doing next Tuesday on April 10th.  But I want to make sure that everyone�s got that.



So, you know, it turns out that it�s being widely exploited.  There�s now a lot of use of it on the �Net, hoping to find users who are not updating, who don�t have Windows Update turned on, who haven�t visited Windows Update and in one way or another gotten themselves patched.  So I imagine there�s going to be, for a month or so, a strong effort to continue to install malware into unsuspecting users� machines through this vector.  And it may never go away completely, as these things tend not to.



LEO:  You have to think that there was this window of vulnerability.  The vulnerability�s been out there for three months.  Microsoft patched it April 3rd.  And there were exploits happening as early as March 30 or even earlier.  I mean, that�s the first we heard it.  That must mean that some, many, maybe millions of computers were bit.



STEVE:  And actually I got email specifically from people after our special podcast saying they knew of, I mean, personal knowledge of specific instances where people got malware through this vector.  So we called it a zero-day exploit, as we do when it�s discovered � when the first discovery of it publicly is its exploitation.  What�s annoying, as I mentioned a couple days ago, is that Microsoft was sitting on this thing.  Now they say they were planning to patch it on the 10th, which I assume they were because they knew it was a bad problem.  But they were not in any real big hurry for the last three months or four months.  So it�s like, okay.  You know, this is the frustration that I hear from many security researchers, like the guys at eEye.  At one point they were showing a calendar of how long things they had informed Microsoft of had just been ignored by Microsoft.  And known vulnerabilities remaining unpatched for, like, six, nine months even.



LEO:  I�ve been hearing this from security experts for a long time.  This is a very common complaint about Microsoft.  And I understand that Microsoft doesn�t want to push patches it hasn�t tested because, especially now that people have automatic patching turned on, there�s a risk in that.



STEVE:  Well, and in fact I got a wacky error message about a conflict of address space on a DLL.  I think it was the htmlhelp.dll, but I�m not sure.  But it was after the system rebooted on an XP machine where I had applied the patch.  And I know I�m not alone because I saw some other reports, actually I received some other reports of the same thing.  So there was some sort of a little oopsie, you know, interaction that got away from them.  And you can see Microsoft really pushing for what they call �responsible disclosure.�  They�re big into responsible disclosure now to�remind everyone that they don�t want irresponsible disclosure, which is to say they don�t want to be pushed or�hurried.



LEO:  And that some might characterize as irresponsible, to�be honest with you.  eEye, as long as we�re mentioning them, I�d love to get your opinion at some point down the road, does offer a free, I guess it�s a firewall.  It�s called Blink.



STEVE:  Yes.  Blink is a very well-known and reputable tool which is sort of their prophylactic around Windows which they maintain.  And it�s like their main deal is this really nice � well, they also have something called Retina, which everything of course is in the eye, e-y-e, theme.



LEO:  Oh, I get it, all right, yeah.



STEVE:  So you�ve got Blink and Retina and so forth.  And I guess it deals with Windows cataracts, I�m not sure.



LEO:  Security blindness on the part of Microsoft.  So it�s hard to exactly figure out what it is.  It sounds like it�s an antivirus.  It sounds like it�s antispyware.  It also sounds like it does some Internet security.  It sounds like it would be a very good choice for a lot of people.



STEVE:  Well, consider this.  It has the same sort of auto-updating features.  And they inform Blink, that is, eEye informs Blink of the stuff they find when they find it.  So during this somewhat frightening � I can�t think of the word, the word I�m looking for � this sort of refractory period during which Microsoft knows about a problem but hasn�t yet fixed it.  Well, the eEye guys that know about the problem, they have fixed it in Blink.  So Blink users were protected during this whole period of time from December 20th of �06 when they informed Microsoft, all the way through now.  So that�s a very cool thing.  I mean, you�d like to have that kind of preemptive protection.



And then, of course, once Microsoft fixes it, I�m not sure whether the eEye guys remove that rule from Blink or leave it around.  I would imagine they�d leave it around because it�s, you know, it�s a good thing to protect yourself from.  So it�s like, whereas the AV people are often always playing catch-up, you could argue that eEye with their Blink tool is really leading the pack.  Of course there are other vulnerabilities that they don�t know about that other security researchers are reporting to Microsoft.  And it�s not clear to me how active they are in trying to reverse engineer those things and put that protection into Blink as well.  One would certainly think that it makes sense for them to do so.



LEO:  So you would recommend Blink.  Of course, if you�re running another antivirus or security software you probably shouldn�t mix.  And so that�s the question, is Blink a full-service antivirus or just a purpose-built antivirus to...



STEVE:  And I haven�t looked at it that closely.  But these guys are down in Southern California, not far from me.  We might consider getting them on the show and talking about their stuff.



LEO:  They�re good.  I trust them.



STEVE:  They are.  And I�ve also met them at a couple of user group meetings.  And they�ve really got the technology.



LEO:  So that�s the good news, it�s [audio glitch] XP, Windows 2000, Tablet PC and Media Center.  The bad news is it doesn�t come on Vista.  And the really bad thing is it�s the first serious Vista vulnerability.  Here we are, not two months into the Vista era, and already a serious unpatched exploit that�s been there since the beginning, since Vista shipped, that doesn�t bode well, frankly.  I mean, to me the sole recommendation for Vista is improved security.  And if it can�t do that, well, I don�t know.



STEVE:  Well, it�s certainly the case that this is old code.  This has been around for a long time for it to affect all versions of Windows, including Windows 2000.  I did note something interesting, and that is that apparently it�s XP Service Pack 2 that is affected, but not presumably original XP and Service Pack 1.  So it sounds like something that got introduced somewhere along the way.  And it�s worth mentioning also that this ANI, this animated cursor issue, if that sounds familiar to people it�s because there have been security problems there in the past that Microsoft � so Microsoft in fixing those may have created this or didn�t find this one when they were in the code fixing other ones.  But this has been a vector for trouble that we�ve seen�before.



LEO:  Good to know, and we�ll keep an eye on it.  Of course that�s one of the reasons we do these special updates.  It�s kind of our commitment to you, when we see an issue like this, we will push out a special edition of Security Now!.  That�s a good reason to subscribe to the podcast, not rely on manual downloads or listening on the website.



STEVE:  It is � yeah.  I�m sorry.  I didn�t mean to interrupt you.



LEO:  You can do that through iTunes, of course, and we have a podcast feed of this is I guess what I�m saying.  Subscribe to it.



STEVE:  I did want to remind people, though, that IE7 with its enhanced protection turned on was not vulnerable to this.  So that is an aspect of Vista�s enhanced security which does bear against this kind of problem.  Whatever it was in detail that was causing the trouble, turning on the IE7 extra protection that is available in Vista did prevent�this.



LEO:  Is that on by default?



STEVE:  I don�t remember whether it�s on.  It�s in the standard security settings, and it�s sort of innocuous looking.  I sort of think it�s not on by default actually because, again...



LEO:  It breaks a lot of sites.



STEVE:  That�s the problem is that you start getting � in fact, someone sent me just recently a DEP error that IE was kicking up.  And I think it was under XP, I�m sure it was under XP because he sent me a screen shot of the dialogue box.  And so but that was IE causing some sort of trouble.  Which is, again, which is why we�re moving very slightly toward tightening things up.  But I�m glad to see Microsoft really is putting pressure on the world to make the stuff more secure.



LEO:  Let�s see.  Any other addenda or additions before we address cross-site scripting?



STEVE:  Well, yeah, I did want to talk about, follow up a little bit on last week�s discussion of eBook stuff.  I know that there�s a strong interest in it.  The thing that brought me into the topic, as you�ll remember, last week was that I�ve had a lot of feedback from people saying, hey, you know, what other authors do you like?  I loved your last recommendation of Peter Hamilton.  Who else?  And so of course I talked about Michael McCollum at scifi-az.com, SciFi Arizona, as another one of my favorite authors.  He and I have had some email back and forth because I�ve been interested in figuring out basically what it would take to move his electronically downloadable books over to the Sony.



And in fact you�ll remember, Leo, that when we talked you had had the Sony for a while, that is, the new Sony eBook reader, they call it the Sony Reader, it�s the PRS-500.  And I was expecting mine to arrive the following day.  It did, and I�m now converted.  I like this experience.  I�ve picked up my Palm that I was using for years, various Palms, but the one I was most recently using, and just sort of looked at the screen again and then looked back at the Sony.  And I�ve got to say, I mean, it would be nice if the Sony had an optionally turn-on-able backlight of some sort that was available � or maybe like edge lighting or something so that you didn�t have to bring your own lighting.  I know that you bought the booklight, I also did, from Sony�s site, that clips on the top and sort of reaches around.  And it�s got just two very bright white LEDs that do a great job of illuminating this thing.  But overall I really like this.



Now, I mean, I�ve got a bunch of complaints with it.  But I�m also an early adopter, as I know you are.  And I remember Sony�s journey through the MiniDisc.  Their very first MiniDisc recorder that I owned was sort of a big black portable blob with a big battery pack that connected to the outside.  And it worked, but it was first-generation.  It had that feeling.  And then a year later they had one with three times the battery life and smaller batteries and more features, and it was smaller.  And then another year later even better, and another year later even better.  And, I mean, to the point now where their current MiniDisc recorders are just these gorgeous little things, I mean, really refined.



And so I think that this first reader has the same sort of feeling.  I mean, it is new technology.  It�s using this eInk technology, so-called �electrophoretic display.�  And the way it works, I�ve learned a lot about it since because I�ve been curious, is I described it incorrectly last week as spheres that rotated either their white hemisphere or their back hemisphere forward, which is actually one of the eInk technologies, but it�s not the one this one uses.  And have you noticed ghosting from, like, the prior page?



LEO:  Yeah.  There are couple of complaints that we all have.  I talked to Patrick Norton about this because he was really high on this as well.  And we all agree, the controls aren�t great, and this little flicker you get when you turn a page is slightly annoying.



STEVE:  Yes.  It turns out that Sony � there are different ways to refresh this technology.  What�s actually happening is that the pixel resolution, that is, the pixels we�re used to thinking of in terms of what�s on screen, is 800x600, so it�s sort of the original, what, SVGA resolution.  Although of course it�s in portrait orientation as opposed to the 4x3 original VGA landscape orientation.



LEO:  And for the size of that screen, that�s a pretty high resolution.  That�s a decent...



STEVE:  Oh, and Leo, I�ve been very critical of the, I mean, I�ve stared at the screen with a very critical eye, looking closely, as closely as my eyes will focus on the characters.  And they�re beautiful because they are anti-aliased characters.  So what�s actually happening here is that this screen has an ultra-high particulate resolution.  I mean, down in the something-or-other microns.  And there are tiny, tiny little particles of titanium, I think it�s titanium dioxide, which is a white particle.  And it�s embedded in a dark hydrocarbon-like oil, essentially, emulsion.  And so what happens is, when these particles are pushed to the back, you see darkness there.  And when they�re pulled to the front, you see their whiteness there.  But the idea is so there�s this super-high resolution surface, I mean, really high resolution.  And then there are charging pads on the front and back, transparent of course on the front and not necessarily so on the back, which put an electrostatic field across a square region of all of these particles.  So the point is that the ghosting is when not all of them move all the way back or all the way front when you�ve switched one of these pixels, rectangular regions, from black to white or white to black.



So it turns out that there are � there�s like a quick change that Sony can do or a more extensive change where it�s sort of like, you know, how hard do you shake the Etch-a-Sketch.  It�s sort of, you know, that�s sort of an analogy for it.  Do you want to really shake it hard and get it all the way erased, or are you kind of, for reasons of UI, would you rather just do it more quickly because a little bit of the past won�t really annoy you.  And so Sony has different strategies for this that they�ve been evolving.  I�m not minding that screen change.  It does...



LEO:  You get used to it.



STEVE:  ...take a little, yes, it takes a little getting used to.  And in fact because there�s a little bit of delay, I�ll now hit the next page button while I�m reading the last line of the screen, knowing that it�s going to take a while for it to catch up with me.



LEO:  You�re a smart monkey.  You�ve learned.  You�ve�adapted.



STEVE:  So there are a number of things...



LEO:  Why is it not paper white?  That�s my biggest complaint is that it�s not as high contrast as it could be.



STEVE:  I completely agree.  And I think it�s just that the nature of the particles, the particle density, the particle color, and probably the fact that it�s basically very white things suspended in a dark medium, even when you pull them all to the front, you�re still going to have some of the dark goo that�s around them, it�s going to be lowering their overall reflectivity.  One of the things that I have noticed is that, unlike a book, like regular book paper, like especially paperback paper that sort of tends to be a little bit yellow, this is almost metallically reflective.  In other words, it tends to reflect the color of the light on it.  So that, for example, when I�m under incandescent light, it has sort of a yellower feel than when I�m outside it has a much bluer sort of look.  And when I�m under white LEDs that sort of have that real sort of blue crispness, it looks just fantastic.



So I�m pleased with it.  There are a whole bunch of UI things.  You talked last week about not being really happy about the page turning.  I completely agree with you.  I�m still having to kind of figure out how to hold it so that my�thumb or a finger can rest on the buttons.  Also it�s wrong that paging forward is given no more preference over paging backward.



LEO:  Right, because that�s what you do mostly, yeah.



STEVE:  Exactly.



LEO:  How often do you turn a page back?



STEVE:  Exactly.  Sometimes if the paragraph on the page you�re reading, wait a minute, doesn�t make sense, or you got interrupted while you were reading, you�ll have to go back to...



LEO:  But that�s probably one time in ten.



STEVE:  Oh, if that.  I would say more like one in a�hundred.



LEO:  A big button that says Next Page.



STEVE:  Yes.  And sure, you definitely want to be able to go back.  But you don�t have to go back equally to going forward, which is what they offer you right now.  So again, I want to remind people, I mean, this thing is, what is it,�$349?



LEO:  Right, it�s cheap.



STEVE:  So, well, okay, except � you and I each have one.��There are people who have said, and I completely�understand...



LEO:  That�s ten hardcover books, and you can put a hundred on there.



STEVE:  Okay, from that standpoint, yes, it�s cheap.



LEO:  Of course, the books aren�t cheap.  The books are only slightly cheaper than the hardcovers.



STEVE:  What I am absolutely sure will happen, and this is always what Sony does, I mean, the first Walkman to the Walkman now, the first MiniDisc player to the MiniDisc player now, anything they do, it starts out big and bulky, sort of almost proof-of-concept.  It�s like the engineers say, we can do this, let us try, let us try.  And so they�re going to prove themselves.  And so I would say to anybody who�s annoyed by Apple with the iPod phenomenon, where you buy one and then next week they come out with the one you wish you�d waited for, but you didn�t know they were going to come out with one a week later, certainly we are going to see the price of this thing fall.  It is Linux-based.  There�s a bunch of stuff that they�ve left in there that they didn�t need to leave in there.  It�s running MontaVista, I think it is, MontaVista Linux.



LEO:  Must be an embedded Linux.  My only question would be�if it�s selling well enough for Sony to pursue it.  It may be, I mean, do you get the sense that it�s taking the world by storm?  I don�t.



STEVE:  I have no sense for that yet either way.



LEO:  Yeah.  And so that could be a bad sign.  We know Sony is unusually defensive of their products.  Look how long they�ve kept MiniDisc alive.  But at the same time, if it�s not doing well, I don�t know if they would...



STEVE:  Well, and it is DRM�d again.  That�s the other real annoyance.  Although I have to say that I think, and you would know this better than I because I just read this once, that when you purchase a book from the Sony CONNECT store, you have five or six devices that you�re able to install it�on.



LEO:  Now, remember the computer is one.



STEVE:  Yes, the computer counts as one.  But still that seems very liberal to me.



LEO:  It�s much like the iTunes store.  I wouldn�t say, I mean, how many devices are you going to put that thing on?



STEVE:  Right.  Right.  I like the Palm model, actually, the Palm Reader, when you download from them you need to unlock it using the credit card number you used to purchase.  And their theory, of course, is you�re going to be reluctant to give your credit card number to anybody else in order to unlock the book you bought on their reader.  So I think that�s sort of a nice, clever inhibition for piracy.  But and I will say that, Leo, I have never ever seen the battery charge indicator come off of full.



LEO:  I know.  Neither have I.  It goes a long time.



STEVE:  And also the books tend to be 350, 360K, like an average-sized book.  Which means that the 100 megs which is free in this thing will, I mean, it�s all the books you will ever need to carry at one time.  So the only reason I can see for using the SD card and the Memory Stick, again, another Sony proprietary technology, would be for music.  And as an experiment a couple mornings ago I did put a  bunch of music on it.  And it�s the only thing � playing music was the only way I was ever able to get the battery full meter off of high.



LEO:  How did the music sound?  Because I haven�t listened to music on it.



STEVE:  Sounded absolutely fine.  And in fact, if I didn�t already own every iPod and a Shuffle and all these things...



LEO:  Can you read a book and listen to music at the same�time?



STEVE:  Well, my music, I�ve got this weird sort of spacey�stuff.



LEO:  But, I mean, will that technology allow you to play a song while you�re reading?



STEVE:  Oh, it�s designed for that.



LEO:  Oh, see, that�s not so bad.  Oh, that would be nice.  I could put some classical music on there and read.



STEVE:  That�s exactly right.  There�s an artist called Liquid Mind that I really like.  And it�s just, it�s very, you know, ethereal, interesting sort of ambient in the background...



LEO:  Perfect for a plane, perfect for a plane.



STEVE:  Yes.  And so this works perfectly.  You stick your headphones in, you go and choose what music you want.  Now, they don�t currently, at least I don�t think they currently have any sort of playlist facility, and they sort the music based on the name in the ID3 tag.



LEO:  It�s kind of an afterthought, in other words.



STEVE:  Yeah.  No, again, everything about this is first-generation.  You are able to create book collections, as they call them, in order to provide some organization of authors and books by collection.  There�s no facility for that over on the audio side.  So what I did is because they don�t even sort based on filename, they sort based on ID3 tagging, I went in and edited my tags in order to force the sort order that I wanted because it always plays...



LEO:  The same.



STEVE:  ...in the order, yeah, exactly, in the same order.  But, I mean, it really works.  You plug your headphones into the bottom.  You turn on music.  And then you go right back to reading, and everything works great.



LEO:  What kind of life do you get with the music?



STEVE:  I don�t have any sense for it because I had never charged it.  And I�ve been using it extensively now for nearly a week.  And when I plugged the headphones in and started playing music, not long after I first saw the highest charge bar disappear.  But I�d already been using it for days without even a thought for charging.  That I really like.  And I have to say, I mean, the text is so large, it�s very readable.  I�m not trying to promote our listeners to go purchase this the way I really wanted to recommend Michael�s books.  And by the way, he will before long have his books also offered in Sony Reader format.



LEO:  Thanks to you.  You�ve figured out the way to do it.



STEVE:  Yes.  The industry is a mess at the moment.  And I could do it now with a lot of jockeying around.  But I�d rather work out the way for him to be able to convert his books over.  And he�s absolutely demonstrated an interest in doing so.  For example, he made �Gibraltar Earth� available to me in a format, basically he exported what he had in HTML, and I found some really wacky tools, I mean, Python and Java and all this junk mixed together.  But I�m reading �Gibraltar Earth� now on the Sony Reader.  And so it�s completely workable, and I�m really pleased.  And of course I�m rereading it because I�m excited to go to the sequel, which is �Gibraltar Sun.�  But there was some confusion.  I wanted to make sure people knew that, if I were to recommend a first series to read of his, I think the Antares Trilogy, which I first recommended to you, Leo, it�s just fantastic.



LEO:  Well, I have both.  And I was a little disappointed because they�re unprotected PDFs, which in theory you can play on the Sony Reader, but it turns out you can�t just put any old PDF on there.  And so with your help I hope he�ll re-encode them so I can read them.  I�m looking forward to bringing it to Vancouver with me.  That�s the main reason I bought this.  I found myself carrying a giant �Judas Unchained,� the giant Peter Hamilton book, on the plane, weighs about eight pounds.  And I thought, you know, I need something lighter for this stuff.



Let�s, before we get to cross-site scripting, I just want to mention once again our great friends at Nerds On Site, at Iwanttobeanerd.com.  They are sponsors of this podcast.  And they are looking for more nerds.  It�s kind of a neat idea.  These guys aren�t � they�re not the company.  They�re a guild, really, of independent contractors.  So you�re still in business for yourself, but not by yourself.  So you focus on your passion and not the burdens of running a business.  This sounds like a great idea.  I wish there were something like this for podcasting.  There are Nerds On Site in seven, I think eight countries now � Canada, USA, Mexico, England, Australia, South Africa, and Bolivia, all over the world.  If you are an expert, PC to Mac, Cisco to Oracle, fixit technicians, website designers, programmers, project managers, even sales, trainers, security experts, antivirus gurus � they particularly like those folks who like to tear apart, build, and troubleshoot their own systems � visit Iwanttobeanerd.com and register for a Nerds Only meeting in your area today.  Nerds On Site, Iwanttobeanerd.com.



STEVE:  And Leo, that�s sort of a perfect segu� for a fun mention of SpinRite, too.  I didn�t understand until I read this that this was one of the Nerds who had sent me a note.  And so you�ll see as I read this from the context that that must be who he is.  He says, �I would just like to share an experience I had using SpinRite last week.  I had a PC in my office� � and this is a different sort of SpinRite testimonial, too, so as you�ll see it�s a different aspect of SpinRite.  �I had a PC in my office that I suspected had a hard drive going bad.  I ran chkdsk on it several times, and it found nothing.  The PC kept blue-screening and freezing up at the worst possible times.�  Like there�s a good time to get a blue screen.



�So I decided it was a good time to try out SpinRite.  I started to do a scan and was ready to let it run as I have heard other Nerds say it takes a while to do its thing.  Within a minute or two a screen popped up from SpinRite saying that this drive was in danger of complete failure, cancel the tests and back up any data as the drive may not survive the testing process.�  And that�s something that�s cool, that�s something cool that I built into SpinRite 6 is while it�s doing its stuff, it�s constantly polling the drive�s SMART subsystem.  And as we know from a podcast we did on this, SMART is not as smart as we would like it to be.  But it has the ability of really raising a red flag and saying, okay, we are in serious trouble here.  So that will never false-positive.  It generally doesn�t save you the way it would be nice if it did.  But since SpinRite is monitoring it all the time, if SpinRite sees that its own use of the drive is causing the drive to panic, it�ll stop and say to the user, look, there may not be enough of your drive left here to save.



So continuing with his note, he says, �I was a little skeptical, to say the least.  But to save time I put in a new drive and started reloading Windows.  Just for kicks, I put the �bad� drive in another PC and started SpinRite again to see what it would do.  About five minutes into the test I heard a very familiar clunking sound coming from the definitely bad hard drive.�  And he says, �You don�t need to be a nerd to know that�s not good.�



LEO:  Now we know.  He�s come out of the closet.  All right.



STEVE:  He said, �The drive crashed hard.�  And then he says, �It�s great to know we have access to a product� � meaning the Nerds because I�ve done a deal with the Nerds guys to make SpinRite available to them, a site license, essentially, which is one of the things we offer � �that we can rely on to give us accurate results and thus make us better techs.  My thanks to Steve Gibson and the folks at SpinRite for saving me a bunch of time.�  Dave Everett in�Michigan.



LEO:  That�s great.  You should add that, you know, �Nerd Certified� or �Tested by Nerds.�



STEVE:  It�s all over the country.



LEO:  Inspected by Nerd No. 5.  All right.  Let�s get to cross-site scripting, shall we?  This is something we talked a little bit about last week.  We kind of got our start, but now we�re going to go into some greater detail, as you are wont to do.  You like to set us up, then knock it down.



STEVE:  Well, and so last week we sort of talked about the generic problem of what I would call, stepping back a little bit, sort of overall website or web code injection, where through various mistakes made in servers and in the sort of next-generation web code that is now becoming so popular, in other words to say scripting, all kinds...



LEO:  Folks, just in case you didn�t know, Steve doesn�t like scripting.



STEVE:  Well, all kinds of problems are being created.  Now, rather than just saying that and making a blanket statement, I thought I would start out by giving people a sense for recently discovered problems with prominent and less prominent web-based software.  So I started enumerating them.  I thought, okay, we�ll just go for 2007.  What�s been found in 2007?  Well, there was so much trouble that I said, okay, forget this, let�s just do March.  Let�s just do March because March had 28 problems that were identified...



LEO:  Wow.  Where do you go to find this stuff?



STEVE:  Well, the really terrific resource I continually use is the SANS Institute.  You know, the SANS security guys, I�m on their mailing list; I get notices of this.  And it�s one of the things that has always had the issue of cross-site scripting on my mind as something I wanted to talk about in this podcast is because I scan it every week, and I see what�s going on.  And sure enough, every single week there�s six or seven or eight or nine new cross-site scripting vulnerabilities that they�re reporting.  And so it�s like a constant annoyance that I�m seeing this going on.  And I wanted to, again, we�ve never talked about this before, so I thought it was a topic really worth mentioning.  So I�m going to very quickly, as quickly as I can, zip through just in March what was found.  And to give people � it�ll give you a sense for obscure companies and some well-known companies like IBM and Oracle are mentioned in here as having vulnerabilities, and also sort of a sense for the nature of the problem.  So the first one here is:



�Built2Go News Manager Blog is a blog application.  The application is exposed to multiple cross-site scripting issues because it fails to sanitize user-supplied input.�  We�ll be hearing that phrase a lot.  �Built2Go News Manager version 1.0 is affected.�



Then we have �OrangeHRM is a human resource management application.  The application is prone to multiple unspecified vulnerabilities on the login page of the application.  OrangeHRM versions prior to 2.1 alpha 5 are affected.�  So it sounds like they found out about that, and they fixed it.



�Webmin is a web-based Unix system administration interface...�



LEO:  Oh, yeah, everybody uses this.  I use this.



STEVE:  Uh-huh, �...implemented in Perl.  The application is exposed to multiple cross-site scripting issues because it fails to sanitize user-supplied input to multiple unspecified parameters of the �chooser.cgi� script.  Webmin versions prior to 1.330 are affected.�  Wordpress.  Ever heard of that?



LEO:  Yeah.



STEVE:  Uh-huh.  �Wordpress allows users to generate news pages and web logs dynamically.  It is exposed to a cross-site scripting issue because it fails to properly sanitize user-supplied input to the �post� parameter of the �wpadmin/post.php� script. Wordpress version 2.1.1 is affected.�



�Webpress is a web-based publishing application.  The application is exposed to multiple cross-site scripting issues because it fails to sanitize user-supplied input.  Version 2.1.1 is affected.�



This looks like �Docebo� � D-o-c-e-b-o � �is a content management system (CMS) application.  The application is exposed to multiple cross-site scripting issues because it fails to sanitize user-supplied input of �index.php� and �/modules/htmlframechat/index.php� parameters.  Versions 3.0.5 and earlier are affected.�



�PhotoStand is a photo blog application.  The application is�exposed to a cross-site scripting issue because it fails to properly sanitize user-supplied input to the �a� parameter of the �index.php� script.  PhotoStand version 1.2 is affected.�



�PhpWebGallery is an image gallery application.  The application is exposed to multiple cross-site scripting issues because it fails to sanitize user input.  PhpWebGallery version 1.4.1 is affected.�



Active Calendar, now, I�m going to stop going through this.  But I�m going to say Active Calendar, web-based calendar creation; Trac is a wiki and issue tracking system; the dynaliens program is a guestbook application that�s got problems.  Lazarus Guestbook is a web-based guestbook application; it�s got problems.  vCard Pro is a virtual greeting card application � oh, goodness.  That�s got�problems.



�VirtueMart is an ecommerce application.  The application is prone to multiple cross-site scripting issues because it fails to sanitize user-supplied input.  Unspecified parameters to the �ps_cart.php� and �virtuemart_parser.php� scripts are vulnerable.�



�DirectAdmin is a web site administration panel.�  �Oracle Portal is a portal application integrated into Oracle's application server software.  The application is exposed to...� blah blah blah, blah blah blah.  �IBM Rational ClearQuest is a software development management application...is exposed to cross-site scripting...� blah blah blah.  �Multiple Cisco products are exposed to cross-site scripting issues because they fail to properly sanitize user-supplied input.�



�Horde Framework is a web log application.  The application is exposed to...� multiple HTTP cross-site scripting, blah blah blah.  �PHProjekt is a modular web-based application to share information and documents.�  I think it probably shares a little more information and a little more documents than it was intended to.  �MindTouch DekiWiki is a file server and intranet tool.�  Oh, again, Oracle Application Server has a problem.  Here�s another WordPress "PHP_SELF" problem.  Interstage Application Server has a problem.  �Overlay Weaver is a web-based search engine...� that�s not happy.  eBitWhizzy, I�m not kidding � oh, no, I�m sorry.



LEO:  This is all in the month of March, by the way.



STEVE:  This is just March.  I was going to do the �07.



LEO:  I�m glad you didn�t.  I don�t think we have a long enough podcast.



STEVE:  I think everybody�s glad.  They don�t have enough time to download this.  aBitWhizzy, I�ve got three left, is �aBitWhizzy is a PHP script that uses whizzywig.js to create and edit web pages through a WYSIWYG interface. The application is exposed to multiple cross-site scripting and directory traversal issues because it fails to sufficiently sanitize user-supplied input to the �d� parameter.�



�Mephisto Blog is a web log application, implemented in Ruby.  The application is exposed to...� blah blah blah, multiple cross-site scripting blah blah.  CoCounter, I�m sorry, �CcCounter is a web site hit counter application.  It is exposed to a cross-site scripting issues.�  Aagh.



[Full text for above:

http://www.GRC.com/sn/files/Cross_Site_Scripting_March_2007.txt]



LEO:  Well, one thing that becomes obvious is that most of these are web-based tools.  That�s of course why they�re at risk, because anybody can use these tools and enter in data, and then the data can be overflowed.



STEVE:  Well, that�s exactly right.  So there�s a couple things this means.  Essentially, you know, look how long it took us to get Microsoft up to speed on security.  Now what�s happened is, essentially, because of Web 2.0 and PHP and Ruby and JavaScript and all these other tools that are allowing and empowering, in all fairness, empowering web guys, webmasters, and administrators to create really amazing active websites, suddenly now they�re all having to be security experts, and they�re not.



So the problem is that any situation where it�s possible for user-supplied input to contain scripting itself, that is, that�s the whole injection deal, the whole cross-site scripting problem is that users are able to provide stuff which the application will then digest and perhaps show to them or to other users.  And in the process their browsers, which are running scripting as part of what they do to offer these features, their browsers will run code that malicious creators have written and, bang, you�re in trouble.  You don�t need buffer overflows.  DEP won�t protect you.  SSL won�t protect you.



Basically the fundamental problem is that the way web page scripting has been designed from the start is you could argue it�s too powerful because there�s a free mixture of web visual content and interpreted content mixed right in.  That is, right in the middle, for example, of a web page, you could say [script], and then you could say document.cookie and then [\script] in order to close the script.  What would happen is, when your browser is showing you this page, it encounters that script tag and immediately, without any requirement, switches on the script interpreter which reads �document.cookie.�  Well, that�s a variable which the interpreter replaces with your cookie for that site, and then it continues.  So what the user will see is blah blah blah, they�re reading along, and then they will see the cookie, which is supposed to be and up to now has been secret between them and the remote server.  Their browser understands that it�s okay to show this cookie because after all it�s a page coming from this remote server.  Well, that power, the power of being able to embed�script anywhere, and you can even embed it in the arguments of queries, you know, the famous �get� query which search engines use, for example, in order to send information back, you�re able to put script tags even there.  And the browser will dutifully interpret whatever the script is and run it on the spot, replacing whatever you�ve got with current variables.



So it turns out that there�s a way, and it�s well documented, all the hackers know about how to do this, where if you provide the URL for a malicious server as part of that little script, you can have the malicious server receive the cookie for whatever server has served the page.  Which means it completely breaks this notion of cookies being safe for authentication and for session tracking.  I mean, for example, when I�m using eBay, I choose the little checkmark of leave me logged in for some length of time until I explicitly log out.  The same thing with Amazon.  I mean, Amazon is smart in, for example, if I try to add a new mailing address for books, it makes me type my password in again, which is a good thing because what cross-site scripting does is it absolutely allows session hijacking where, because of the fact that cookies are what�s used to maintain state as we move from page to page on a site, anybody else returning my cookie will be believed to be me.



So you can easily see a scenario where, for example, if Amazon were to have a cross-site scripting flaw, it would be possible for third parties to capture Amazon user cookies on the fly while they were logged in, immediately open a session using their cookie, thus completely impersonating them to Amazon, and then buy a whole bunch of stuff using their credit card because that�s all stored by Amazon and you�re never required to enter that again, and then add a mailing address other than where you want, you know, other than your default or any that you�ve used in the past, and basically buy anything they want and have it sent to them, and the user would know nothing about it until their credit card bill comes at the end of the month and they go, wait a minute, I didn�t spend $5,000 on Amazon.com.  But by that time the damage is done and the goods have been shipped.



And so this is the power of this kind of exploit.  Now, it�s true that the only credentials which will leak through this are those of the site which has the problem.  So, for example, as far as we know, and certainly in March, Amazon.com had no trouble, nor did eBay.  But they have � eBay has notoriously historically had cross-site scripting problems and was abused like this.  So what happens is you definitely need to hope that your bank doesn�t have cross-site scripting vulnerabilities because this is the kind of exploit that would really concern people who were doing electronic banking.  And of course the double whammy is you typically have to have scripting enabled in your browser in order to use the banking site.



So the beauty of all of this is, if you had no scripting in your browser, your browser would ignore that start script/end script tag.  It would skip right over it, and you�d see something missing on the page, but there�s no vulnerability.  The vulnerability comes from the client browser which is being tricked because of this leakage of unintended text from a trusted website like Amazon or eBay or your favorite blogging site or whatever you�re using, where a hacker has been able to inject their own text into that flow.  When that happens, you can get into trouble.



And so this is not a problem like, well, for example, like three days ago we had the huge problem with Windows animated cursor exploit that was going to be immediately exploited and was immediately exploited essentially worldwide.  Instead, these kinds of vulnerabilities, because they are specific to applications, you know, specific vulnerabilities in specific applications, they tend to be more targeted attacks.  That is, it doesn�t make sense to try to send everybody a link to a known problematic blog and have them go there because they may never have been there before, they haven�t established an identity, they don�t have any log-on credentials to be stolen, so that doesn�t make any sense.



But you can merge these with social engineering attacks.  For example, knowing that a site is vulnerable and wanting to be up to some mischief, you could, for example, if it was a blogging site or an online forum site, you could start chatting with people, find out a little bit about who they are, and then send them a link saying, hey, you know, check this out.  And when they click on the link, essentially that goes to one of the forum pages where there�s a known scripting vulnerability that will cause their browser to divulge their credentials to this third party, which allows them to then log on as that first-party user and essentially pretend to be them on the blogging site and cause all kinds of mischief.



LEO:  That�s an interesting combination of social engineering and hacking.  Which more and more that�s what you�re seeing.  I mean, that�s � you want to get the job done, that�s how to do it.



STEVE:  Well, exactly.  And so for the targeted kinds of attacks, and for example I think we mentioned a couple weeks ago when we were talking about China deliberately attacking the Defense Department, those are targeted attacks where they will take known cross-site scripting vulnerabilities.  And remember that one of the real gotchas with this is it is a firewall-penetrating attack, meaning that if somebody from outside, for example outside the United States � I don�t mean to pick on China by any means, but that does seem to be where the bandwidth of these attacks is emanating largely...



LEO:  Important, by the way, you point out the bandwidth but not necessarily the attackers, since they can spoof any location, obviously.



STEVE:  Exactly.  Or bounce through proxies in China and actually be located anywhere else.



LEO:  It may just mean that�s where the most unprotected machines are.  We don�t know what it means really.



STEVE:  Well, and historically when we look at the demographics of the machines that have been infected by worms, China has been a large infection target, meaning that, if nothing else, their Windows machines were not being kept currently patched.  So whether they were legitimate or not is impossible to guess.  But so an email from, like, scattered across the Defense Department, containing a URL to an Intranet server inside of the security perimeter of the Defense Department, would then have preferred access to whatever was going on.  And even there, by allowing the browser to trust the Intranet server, the cross-site scripting vulnerability is able to use those enhanced power credentials in order to get up to much more mischief internally and essentially establish a stronghold inside of the external security perimeter.



So these are real problems.  They�re not like, oh my god, the sky is falling, Windows has a zero-day exploit scale problem.  But in terms of how they affect individual users, everybody who is using a certain vulnerable blogging site or people who are being socially engineered where there�s someone trying to get you and these sorts of problems, if they find out what sites you visit and then cross-reference that versus known vulnerabilities, they have a way of targeting people.  And it�s also worth mentioning that you notice that we were seeing, okay, those 28 problems I read just from last month and didn�t go back any further, I mean, this is always happening.  So one of the problems is that many sites that will be using these web packages are not updating them at the same rate or level of frequency, if ever, that Microsoft is updating Windows.  So the other thing that is helping Windows is that we are all now slaved to this second Tuesday of the month, if not sooner...



LEO:  Or first Tuesday if it needs to be.



STEVE:  Yes, exactly, update paradigm.  Whereas many of these shopping cart and blogging and Web 2.0 tools, they install them, they get them running, and then the developer�s contract runs out or he�s off to do something else; they�re not being maintained at the same level that Windows is.  So many sites that will talk about diversions of their PHP whatever it is they�re running, the hackers look at that, and they go, okay, cool, we can hack this anytime we want.  And they just sort of leave it there.  These problems tend not to get found because they�re not huge world-shaking problems.  They�re little, specific, sort of like vertical problems that can be exploited whenever a hacker has an opportunity or for whatever reason needs to.  But they exist all over the Internet right now.



LEO:  Well, I was going to say it�s a PHP problem, but then you have some Perl scripts in there, too, which run out of cgi-bin.  So it�s not purely that it�s running on a � it�s just, you know, a lot of programmers are not used to looking at the inputs and making sure that it�s valid and protected.



STEVE:  And again, Leo, as I�ve said before, as a developer myself, the psychology of the developer is, oh, can I just get this thing working?  I just want to be done with this.  I want to get this working because my boss is breathing down my neck, and I�m already three weeks late.  And so there isn�t that awareness.  And again, as a developer, I really respect how clever many of these hacks are.  For example, there are filters which will attempt to look for [script].  I mean, that�s the most obvious thing you would filter out.  But it turns out that there are very clever ways to obscure even that token.  You can use all kinds of weird Unicode escape.  You can even use � there�s even some ways of using some permissible script to expand to non-permissible scripting.  I mean, so again, the hackers are sitting here pounding on this, trying to figure out how they can break in.  Whereas the developers are just happy that the thing seems to work and not crash the server anymore.  So it�s two very different mindsets with radically different goals.  And the big problem is that the people who are developing these are not security experts.  They�re generally, I mean, I talk to people all the time who are barely coders.  They go, well, you know, I learned PHP in order to implement my own�blog.



LEO:  Well, that�s how PHP was written.  It was a Personal Home Page program designed to do exactly that, to enhance a�blog.



STEVE:  And it�s an easy-to-learn language, so it�s made for amateurs.  So almost by definition, amateurs are not going to know about this, about all the problems that they�re opening themselves and, more importantly, their users of their insecure sites to, due to the nature of this kind of�problem.



LEO:  Well, I�m glad that we can clarify this.  And I hope that anybody who�s thinking about doing some programming will think about validating user input.  Because clearly that�s where the problem lies.



STEVE:  Yes, that is the nature of it.  I�ve got three really good links on our show notes for this week � a couple white papers that talk about this in more detail, show code samples so people can actually see how this works in real life, and the third link is to a really nice consortium.  I think they�re about, boy, I don�t know, 80-some members.  It�s OWASP, the Open Web Application Security Project.  This is an organization clearly formed because of the recognition of this kind of real pervasive problem.  There�s a bunch of utilities there.  They�ve got some scanners and some tools and guidelines.  And so if we do have � I�m sure we do have, I know we have, in fact, because I know some of them, they�ve written to me � web designers who are listening to Security Now!, and this episode has really caught your attention, I highly recommend � it�s the third link on the Security Now! notes for this Episode 86, or just put in OWASP into Google and you�ll get there.  And they�ve got a whole bunch of great resources.



LEO:  Excellent.  GRC.com.  That�s the place to go.  As long as I�m pointing you to places to go, I might remind you that this podcast is sponsored by our good friends at Astaro, the ultimate security folks.  They really are good.  The Astaro Security Gateway is used by many businesses to protect themselves.  And now Version 7 just came out, and it has so many nice new features.  The usual, of course, antivirus, antispyware, content filtering, IM and P2P control, network firewall, remote access and VPN, intrusion protection.  But they�ve now added encryption and decryption at the server side so that no additional software is required by your users.  There you have now secure remote access via SSL VPN, the easiest to implement.  And of course they scale very well.  You can cluster up to ten different Astaro Security Gateways together, eliminating the need to install additional load balancing.  It�s patent-pending technology, actually.  It increases the speed and reliability of your network.  As your network grows, so does Astaro.  Don�t forget you can get a free trial by calling 877-4AS-TARO in your business.



And if you�re a home non-commercial user, those home licenses now have been extended in the v7 package.  You get everything, the base license plus all subscriptions and Astaro Up2Date.  That used to be 79 euros per year.  Now it�s free for up to ten IPs, ten users, and a thousand current connections.  So Astaro Security Gateway for the home user is an incredible deal.  If you�ve got an old PC lying around, highly recommended.  Astaro.com.  We thank them so much for their support.



So we�ve wrapped another sucker up here.  And well done, I must say, Steve.  I am fascinated by the subject.  Are we done with cross-server-side scripting, or is there going to�be...



STEVE:  Well, we�re done with this.  But next week I want to talk about another equally troublesome remote injection.  This is not the same sort, though.  This is called SQL Injection, or Sequel Injection.



LEO:  Oh, yeah.



STEVE:  A big problem.



LEO:  I�ve been subject to that myself.  A lot of forums had problems with SQL injections.  Okay.  That�ll be next week on Security Now!.  For transcripts of this edition and 16KB�versions for the bandwidth-impaired, go to Steve�s site, GRC.com.  That�s where you�ll find his show notes, those links he mentioned, and of course his great program, SpinRite, which is really the disk maintenance and recovery utility.  Just ask the Nerds On Site.  They know.  SpinRite.info for testimonials or GRC.com to buy yourself a copy.  Steve, we�ll wrap this thing up.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#87

DATE:		April 12, 2007

TITLE:		SQL Injection Exploits

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-087.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo wrap up their three-part series on web-based code injection vulnerabilities and exploitation with a discussion on web-based structured query language (SQL) database attacks.  They explain why and how SQL injection vulnerabilities are creating an ongoing plague of vulnerabilities besetting modern 'Web 2.0' applications.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 87 for April 12, 2007:  SQL Injection.



Time to get secure.  And you can never be too secure.  He�s the master of security, Steve Gibson, in his secure lair.



STEVE GIBSON:  You know, Leo, speaking of getting secure, we get so much great feedback from people who, even if they thought they were really security knowledgeable before, I mean, people who�ve been in IT all their lives; but they invariable say that, even when we�re discussing a subject that they feel pretty well versed in, they�ll still get a tidbit here and there, something that they haven�t encountered before.  So...



LEO:  Well, I don�t think it�s possible, even if you�re � and I think if you�re a pro you know this.  Even if you do this all the time, stuff changes.  It�s hard to keep up.



STEVE:  Well, yes.  And in fact, I had � a bunch of people wrote to me about the recent event which happened in the AACS area, remember we�ve talked so much about the � uh-huh.  You�ve probably heard that WinDVD is having its keys revoked from it.



LEO:  Yeah.  The first example of key revocation.



STEVE:  Exactly.  And this we talked about as something that would certainly be possible to have done.  Now, it�s also the case that having a software program�s keys revoked is far less onerous, for example, than having your Toshiba HDDVD player�s keys revoked.



LEO:  Right, right.



STEVE:  That would be a big annoyance, needless to say.  But still this demonstrates that Hollywood, although it�s taken them many months, you know, this of course all comes from the muslix64 guy who started this, and it turns out that they�ve been continuing to do work on this in the Doom9 forum, and there�s now a utility developed by somebody else that basically dumps all the encryption keys from any disk that you insert in a PC with WinDVD.  So as we expected, they�ve automated and polished this approach and made it so easy.  And so finally Hollywood is saying, okay, no more.  We�re revoking WinDVD�s keys.  Now...



LEO:  Now, does that mean that this technique doesn�t work�anymore?



STEVE:  No, it�s going to be a cat-and-mouse game.  What�s happened is, the InterVideo people who publish WinDVD, they�ve done some things to a next version of WinDVD which existing WinDVD owners can upgrade to, to hopefully � or they�re hoping, anyway � thwart this kind of exploit.  Maybe they�re protecting it more, they�re not leaving the keys out in the open as usual, they�re obscuring them in some fashion.  But again, this is � because the player has to have the ability to decrypt the content, and it�s a fundamentally open platform, under XP this is going to be very hard for anyone to prevent.



Now, as we�ve talked about, Vista has this notion of protected processes, and Microsoft has put a lot of energy into tightening Vista down in ways that would make this much more difficult.  You just can�t run a debugger on a Vista process which is running in this protected process environment and dump its memory.  So Microsoft is, you know, building walls around processes for this reason, to keep this kind of easy exploitation from being, I mean, really so easy to do.



LEO:  So they�re calling this a �mandatory update.�  What happens if you don�t update?



STEVE:  Well, essentially WinDVD has a set of encryption keys which were given to it by the AACS authority.  Those are going to be invalidated by new DVD content.  So as you, for example, downstream the newer published HD-DVDs and Blu-ray DVDs, any of the technology using this AACS next-generation DRM � digital rights management � for high-definition content, they will know that the earlier versions of WinDVD are not safe because they have been reverse-engineered.  So those things, that content simply will not play on the older WinDVD players.  Older content might.  It�s not exactly clear how this is going to work, that is, whether the download of the new version will automatically remove the keys from the older versions; whether you could still play an older disk; or whether ever once letting a new disk touch your system would leave a mark behind that prevented the older disks even from playing.



LEO:  I didn�t realize that.  So, yeah, because that�s the question, is does it make your existing stuff not work?  And apparently that�s the case.



STEVE:  It certainly could make your existing stuff not work on the existing player.  So the idea is you need to upgrade your player.  And, I mean, this will be sort of fun to watch from the sidelines because, you know, the Doom guys, they�re not going to take this lying down.  They�re going to say okay, roll our sleeves up a little bit further, and we�re going to do this again.  I mean, if for no other reason than to prove the point that what Hollywood is trying to do is, as we�ve said over and over, is fundamentally impossible.



LEO:  Amazing.  Fascinating cat-and-mouse game going on.  And for those who said, oh, don�t worry, nobody will ever revoke keys, well, now we know they will.



STEVE:  Well, yes.  And in fact, again, though, I would say�that this is the case for software players.  It�ll be very interesting...



LEO:  It�s different for hardware, yeah.



STEVE:  Oh, well, consider, I mean, you know, that�s the nightmare scenario, that hardware that people have purchased, which is not as easily upgradeable as clicking on a link and getting a new version of it, that hardware people have purchased would then stop functioning because some instance of that hardware somewhere had been reverse-engineered and hacked in a way that allowed people to use that hardware in order to decrypt high-definition content.



LEO:  It�s my suspicion that the movie industry isn�t so worried about hardware since it�s software that really gives you this piracy capability, and as we see with this decryption.  It�s a little harder to make it, you know, so what if you crack a machine.  Right?



STEVE:  Right.



LEO:  Ah, well, fascinating stuff.



STEVE:  So also I received some questions about why I never posted Episode 85a on the Security Now! site.  I didn�t.  I sort of thought it was, you know, that was our early last week announcement of the ANI cursor vulnerability disclosure.  And I sort of thought of it as a little quickie, like, oh, just a little notice for people; and besides, we�ll be doing a regular podcast in three days anyway.  But people were saying, hey, where is that, I need that, I want that.



LEO:  They want the complete set.



STEVE:  Yes.



LEO:  Collect all 87.



STEVE:  So by the time anyone is hearing this, I will have added 85a to the Security Now! page.  So anybody who wrote to me saying where is that, I want it, I need it, it�s there�now.



And the last thing was, last week I referenced some errors that people were reporting which have now been acknowledged by Microsoft and resolved.  That was an error that occurred to me on one of my XP machines where I installed the ANI cursor vulnerability fix.  When I rebooted the system, I got [glitch] came up complaining � the message said the system DLL, user32.dll, was relocated in memory.  The application will not run properly.  Well, it turns out it�s because this machine actually, this happened to be a cute little HP Pavilion, little mini Pavilion that I have, it uses the RealTek HD Audio Control Panel, and that was one of the things that conflicted.  There was also a German tax calculator, something called TUGZip, and a CD tag program.  Those all gave this patch a problem.



So anyway, we�re now talking, here we are on the 12th, which is after the second Tuesday, Microsoft�s normal patch cycle, which was this most recent Tuesday on April 10th.  And during that they updated this fix again to cure the problems that people were having.  There was an interim hotfix that I was preparing to tell people about today, which did fix this problem for this week between the ANI release and the normal Patch Tuesday, second Tuesday of the month release.  But it turns out Microsoft incorporated that already into the � and there�s, like, another three or four patches, depending upon what version of Windows you have.  So once again, you want to make sure you�re patched.  But anyone who was having this�problem will have it cured here by our normal second�Tuesday.



LEO:  Very interesting.  Okay.



STEVE:  And two last little quick points.  Several people who have been liking and following along our discussion of eBooks and the Sony Reader and so forth made mention of two really interesting sites that have literally tens of thousands of free eBooks.  And I know you�ll be interested in this, Leo.  One is manybooks.net...



LEO:  Let me write this down, okay.  Will these work with the eReader, is the question.



STEVE:  Yes.  And in fact at manybooks.net you select which format of, like, I don�t know, like 20 formats that you want the books in, and one of them is RTF.  And in fact the guy that wrote to me about manybooks.net has a Sony Reader.  He downloads these things in RTF format.  Then, because they�re in RTF, he then will use Word or WordPad to maybe enlarge the font or bolden it or whatever he wants to do, and then he says it works beautifully with the Sony Reader.



LEO:  Because that was the problem we had with McCollum�s books was that, even though they were PDF, they didn�t really seem to work very well.



STEVE:  Well, yes.  And I�m playing around with doing a book converter that�ll just, you know, for a little quick project here, just because I want to play with the stuff before I set it aside, which will create texts in native format that allows you, for example, to resize the text so that it�s comfortable for you.  And of course RTF format allows you to do that.  So anyway, and I did look at manybooks.net, and there�s a bunch of stuff.  They have, they say, at the moment 16,380 completely free eBooks, many of...



LEO:  Mostly public domain, I would imagine; right?



STEVE:  Well, many classics, but some surprising books that look like � there was one that was, like, published back in 1920 that was � it looked like a huge compendium of English idioms, you know, and common phrases and things.  I thought, oh, that�d just kind of be fun to have on there to browse around in.  So there�s that.  And then there�s also www.wowio.com, and that�s another free eBook site.  And I�ll have links in our show notes to both of these for people who are, you know, driving while they�re listening to this.



LEO:  This has become the eBook show.



STEVE:  Not intentionally.  There were some people who expressed some frustration that we were spending so much time on that.  But it�s something that you and I were both interested in.  And I�m such an avid eBook reader that I wanted to share this for people who wanted to know about it,�so...



LEO:  Thank you.



STEVE:  So, yeah.  We don�t want it to be the eBook show, but I did want to let people know what was going on.



LEO:  Hey, we talk about what we�re interested in.  That�s sometimes more than security.  Not usually.  All right, Steve.  What are we talking about this week?



STEVE:  Well, we�re talking about what is arguably the, well, an incredibly big problem for what�s happening with the web.  In fact, as I describe this to people, as I�m about to, you could almost imagine that a system could not have been deliberately designed to be worse than what we�have.



LEO:  Isn�t that nice.



STEVE:  And again, it�s sort of old technology which is meeting new technology and having a real problem with it, essentially.  So the old technology is this database technology known as �sequel,� or SQL.  SQL is an acronym, of course, it stands for Structured Query Language.  The good news about SQL is it was designed, you know, way pre-Internet, pre-web, as a very powerful database technology.  The thing that makes SQL so powerful is that it is inherently a language-based data access system.  So, for example, you generate so-called SQL queries, which are, for example, of the form select subject event date and content from a certain database name like newsletters, where the newsletter ID is 5, for example.



So it�s almost sort of an English-y sort of like query language where you build up your query by putting together verbs and specifiers, variables, into this thing.  And you�re able to create tables.  You can add items to tables.  You can add columns.  I mean, Mark Thompson, for example, our friend at AnalogX, he�s just jumping up and down about how cool SQL is because as a programmer he�s very comfortable with the idea of a linguistic interface to data.  And so SQL is extremely powerful because it just allows people to have data contained in these tables with records in columns, and rows are like records of the individual database records.  I meant fields and rows, sorry.  And the idea is that using this linguistic approach you�re able to make � basically that�s your entire interface to the database.  And so when you issue these queries, the result sort of comes back from the database with your answers, which is in the form of another table or additional information that you�ve asked for.



So SQL was there for a long time.  And it made sense, as we moved from sort of static pages that we talked about before into the Web 2.0 dynamic pages, it made sense that, if you had an online forum, for example, an online bulletin board system, that as you�re creating and accepting postings from people, you need to keep them somewhere.  They need to go into some sort of a database in order to be stored on the hard disk in a way that they�re accessible and can be efficiently retrieved.  And in fact, compared to prior databases, that�s really the whole concept behind SQL is over a network, for example, where you don�t have high-speed connection between the client and the server, old-style databases would have required that you basically rifle through the data by sending it back and forth between you and the database, if they were, for example, over a network on separate machines.



The cool concept that made SQL so powerful is that, instead of having sort of a dumb database where you basically have to go through the entire database, moving it across the network, checking each record to see if it�s what you want, instead you send the query across the network.  And now the database is smart, and it interprets the query, applies it to the database that you�ve asked it to, or in some cases even more than one database at the same time, and then gives you back the results.  So SQL was really designed to be sort of a transnetwork solution for dealing with data in a very efficient fashion.



LEO:  And there�s a lot of different flavors of SQL.  Microsoft makes a SQL Server.  Many of us, for instance, on TWiT we use the open source MySQL database.



STEVE:  Which is becoming extremely popular.



LEO:  And uses the same, basically the same SQL syntax.  SQL�is a language, and there�s many different implementations of it.



STEVE:  Right.  So last week we talked about cross-site scripting problems, where because the user�s browser was accepting scripting that appeared to be from a trusted server, there were ways to inject that scripting into the user�s browser to cause, you know, all kinds of nefarious things to happen.  Hackers had jumped onto this as a way of creating havoc and leveraging this insecurity for their own�purposes.



LEO:  This is the same idea, I guess, as anyplace where you have a field that you can overrun the field with too much text and execute arbitrary code, you�re doing the same thing with this SQL query.



STEVE:  Well, actually it�s very different than that.  That, what you were talking about, was a buffer overrun.  And last week with cross-site scripting the exploitation is essentially occurring on the user�s end, on the user�s browser.  What�s different about SQL injection is it�s a means that allows hackers to inject queries into the remote server that the designers certainly never intended.  And essentially it leverages this expressive power, this linguistic power of SQL, in ways that, just like with so many of these exploits, it�s very simple to get the system working.  It�s just so hard to have it work in a way that can�t be compromised.  That is, just because of the nature of the power of SQL and the connection between the client�s machine and the server creates these vulnerabilities.



For example, say that you go to a site, and it presents you with your username and password that you�re supposed to fill in in order to get access to the site.  Maybe it�s a high-value site that regular normal authorized users might pay a lot of money to have access to all the time.  And so what happens is, the web browser gives you a form where it says please input your username and your password, and you click okay.  You know, we�ve all seen that kind of front page on a site that we have to authenticate ourselves to.



Well, behind the scenes there will be � this username and password will be accepted from the user over on the server.  And then the code running on the server needs to look up this username and password to see if it�s valid.  So, for example, you might have a table or a database called �log-ins,� which is the username and password of everyone who can log in validly.  So it�ll say, for example, in SQL, and this is sort of a simple construct like I mentioned before, it might say �select ID from log-ins,� meaning the log-ins table, where the username equals, and then the username provided by the user, and password equals the password provided by the user, meaning that username and password would be columns or fields in this log-ins database.  And so the idea is that the data provided by the user is plugged into this SQL query, which is then given to the database to see whether this username and password are valid.



Well, okay.  Get a load of this.  So the phrase that we�re looking at is where username equals the username provided and password equals the password provided.  So obviously both of those have to match.  Okay.  It turns out that if, instead of just putting in a password in the password field, you put in, I mean, like anything, noodles, and then you said �or� in the same field, you said �noodles or one equals one,� then you submit that.  Okay?  So now what happens is, instead of the password that the user provided, you�ve put in a bogus password, noodles, and then essentially you�ve extended the query by saying �or one equals one.�



LEO:  Which is true.  Always.



STEVE:  Which is always true, exactly.  So you said, so only allow a log-in where username equals the username provided and password equals noodles, which, you know, it probably won�t, or one equals one, that is to say, essentially the user of this log-in page is able to write their own SQL into the query in order to make it work.



LEO:  Wow, very interesting.



STEVE:  And it turns out in a surprising number of sites this works.  Now, I have a link...



LEO:  Try it on my site real quick.



STEVE:  I have links to some white papers that go into more detail if people are curious because there are little things you have to do.  There�s, for example, the user is not putting quotes around their username and password, so those will be provided when their username and password are patched into the SQL query.  But it turns out that doesn�t stop you.  You can still do what you want to do, but you have to be cognizant of the way quotes are probably going to be futzed in there.  So that�s just a simple example of a way that, without the developers ever intending you to provide your own SQL, literally, over the Internet, using a web form, you�re able to do something they didn�t like.  Well, it turns out...



LEO:  That�s amazing, just...



STEVE:  Isn�t that cool?



LEO:  Yeah.  Well, I don�t know if it�s cool.



STEVE:  Cool in a bad way.  So it turns out that SQL is so powerful, you can use parentheses to get nesting, you�re able to query other aspects of the server that are not even relevant to the application.  For example, the way SQL works is there are system-level tables, sort of so-called �metadata,� where the system stores its own information.  For example, there�s a table called sysobjects, syscolumns, sysindexes, for example.  Those are tables containing information about the actual database tables.  Using SQL, you�re able to query those metadata tables to get the names�of the databases, the columns in the database, and other information.



And in fact, if you have a website which is not very carefully cleansing and scrutinizing everything provided by the user, it�s possible, for example, on a website that�s going to give you like a list of all the threads in a forum, for example, you could take the capability of dumping out from the SQL database all of the threads in the forum.  In the same fashion of essentially injecting your own SQL code through a form, you could, by a series of experiments on the server, even starting out knowing nothing about what the database tables are called, what the form columns are called, you�re able to sort of, over time, extract that information in order to get what you need, and ultimately put into a form a complex query which instead � where the system thinks it�s dumping out a scrolling list of threads, it instead dumps out every username and password in the username/password dictionary.



LEO:  Wow, that�s amazing.



STEVE:  Basically, I mean, just giving you all that data.  Now, imagine if a banking site had this vulnerability, I mean this kind of vulnerability.  It�s one thing, it�s like, okay, someone could play havoc in some online forum.  But this is, I mean, this is how serious this kind of exploit is, is if your own online banking technology that offered online banking had this kind of a vulnerability, and somebody could sit there poking at the form, extracting information about the metadata, the table names and column names, and end up tricking their server into dumping the log-in username and password of all the bank�s online customers, allowing them then to log in as you and do anything that you would normally be able to do on your banking site, like sending checks to them.



LEO:  So how do you prevent this?  Do you look at the input and, I mean, and say, oh, you can�t pass SQL commands along,�or...



STEVE:  Well, yes.  And, I mean, essentially that�s what you need to do.  Now, remember how last week I read the 28 new�cross-site scripting vulnerabilities that had been identified just in March.  This same problem relative to SQL injection has 38 new SQL injection exploits just in March.  And I won�t...



LEO:  You�d think they�d understand this, it�s so well-known that they�d understand this, and it�d be just kind of standard operating procedure to prevent it.



STEVE:  I know.  And the problem is it�s sort of like, okay, whose fault is it?  Well, we know that it�s the webmaster�s fault.  It�s the person who coded this and didn�t pay attention to this.  But again, I mean, it is just � it�s phenomenal.  I�ll just read a couple of these to give people a sense for this:



�VBulletin Inlinemod.PHP SQL Injection.  vBulletin is an application for web site forums.  The application is exposed to a SQL injection issue because it fails to sufficiently sanitize user-supplied data to the "postids" parameter of the "inlinemod.php" script file before using it in an SQL query.�  I mean, it�s exactly what we�re talking about.  And�here�s:



�Serendipity is a web log application.  The application is 

exposed to this issue due to a failure in the application to properly sanitize user-supplied input.�



�Angel Learning Management Suite is a learning management

application implemented in ASP,� active server pages.  �The application is prone to an SQL injection because it  fails to sufficiently sanitize.�



Coppermine Photo Gallery, Zephyr Toolbox Address Book, GaziYapBoz Game Portal...



LEO:  GaziYapBoz is vulnerable?  No.  No, say it�s not so.



STEVE:  SQL-Ledger/LedgerSMB Remote Code Execution, Monitor-Line Links Management, LI-Guestbook Application, Rigter Portal System, multiple AJ software products, PhpStats, Creative Files, Absolute Image Gallery, Woltlab Burning Book, blah blah blah.



LEO:  We get the message.  There�s a lot of them.



STEVE:  I mean, well, and that�s one month, Leo.  And they�re like this every month.  Now, what�s really a concern is you might say, okay, well, so some guestbook application is vulnerable.  It�s like, okay, yes.  The guestbook application is vulnerable.  But more than likely this is a guestbook for a site that has a lot of other stuff going on.  And what this does is, this vulnerability in the guestbook app � and I think I just read about nine different guestbook apps that are vulnerable.  And it�s because this is sort of a low-security thing...



LEO:  And it�s written by amateurs.  I mean, these are, you know, most of what you just described, they�re kind of free open source and kind of group projects, not even high-end open source, you know.



STEVE:  Exactly.  The problem is the guestbook application makes use of the SQL Server that runs the entire website.



LEO:  Right, right.  Most websites, mine included, only have one SQL program running, MySQL running.  And of course if it was different databases with different users and log-ins.  But if you have the same user and log-in, as many of us do...



STEVE:  No no no, it�s worse than that, Leo.  It�s worse than that.  A single insecure application, like your guestbook application, can use access to the table metadata to get the names of every database on your SQL Server...



LEO:  That�s kind of bad.



STEVE:  ...and then explore � yes.  So it ends up being � and this is really why SQL injection is such a problem is that, exactly as you said in your case, you�ve got MySQL running, one instance of the server, that runs your whole site.  So the guestbook application that also is using a single little guestbook table in SQL Server, that provides an entry point to allow a hacker to go and explore all the tables, all the databases that your site is using, and get, for example, much more valuable username and password data, or anything that you�re keeping in that SQL database.  And in fact, due to some notorious problems with SQL, it�s even possible to leverage SQL vulnerabilities to allow a hacker to get access to the underlying operating system.



So, I mean, it is a very, very powerful backdoor into, well, into web servers all over the place.  And the problem is that, exactly as you said, Leo, guestbook apps are written by people who this is like their first web application.  It�s freeware.  It�s downloadable.  And exactly as we talked about last week, oftentimes it�s not the kind of thing that you update.  I mean, on all these things I was talking about, it�s like, for example, �Woltlab Burning Board is a free web-based bulletin board package based on PHP and MySQL.  The application is exposed to an SQL injection issue because it fails to properly sanitize user-supplied input to the �action� parameter of the �usergroup.php� script.  Woltlab Burning Board version 2.7 and earlier versions are�affected.�



Okay, so clearly they fixed this after version 2.7.  But how many people who are using this thing know that there�s a problem?  Now all the hackers in the world who didn�t know before, know exactly what the problem is with Woltlab Burning Board versions, you know, earlier than and including 2.7.  So now they go around to interesting websites, and maybe they even know because this is what they do, which types of bulletin boards different sites use.  Now any site that didn�t update its bulletin board system, which tends to be something sort of thrown in to give your users someplace to chat among themselves, suddenly now that site�s entire SQL database repository is vulnerable because there�s a backdoor in through SQL.



LEO:  So that gives them access to anything that�s running on that database server.



STEVE:  Exactly.  Any databases that are being managed by that instance of SQL on the web server.



LEO:  You know what�s really scary is that many, many people are in a shared hosting situation where there�s one instance of MySQL running for many, many, many accounts.  So it�s not just your database.  You may be exposing everybody else on the server.  Which means hundreds or thousands of different websites.  Wow, that�s interesting.



STEVE:  It is.  And in fact oftentimes, especially with Web�2.0 situations, the SQL Server has basically the page content, that is, all of your site is being served out of an SQL database.  And so this is the way all of this website defacing that we hear about comes about.



LEO:  Oh, that�s why, yeah.



STEVE:  Exactly.  People are able to go in, and you�re able to delete tables.  So through SQL it�s called �drop table.�  And baby does it.  It just drops the table.



LEO:  It�s fast, and it�s easy.  Yes, I know, I�ve used it many times.  And I�m always scared when I press that button.



STEVE:  Yes, but imagine that somebody determines the table name, wishes you no good, and then they insert a drop table command through a web form.  So to answer your question, coming back to how do you prevent this, the way to prevent it obviously is to absolutely scrutinize anything the user provides.  And of course this is a problem, too, because you�d like a password to be freeform.  Let them put in any kind of junk that they want to into the password field as long as they are able to type it in again.  So but of course here�s the danger in doing that is if they put in an SQL command extension, it�s like, well, that�s a valid password.  I mean, no one�s going to guess it.  It�s like an unguessable password.  So you�ve got to really � you�ve got to be very clever about how to allow things that are supposed to be anything the user wants to write, how does the system know that that�s also a valid SQL sequence?



So you see the problem.  I mean, it�s not that simple a problem to nip in the bud.  And the same is true, for example, in a forum where you�re inherently wanting to let people put anything in that they want to.  It�s also sort of a bigger problem than scripting injection because you could argue that, as long as you don�t allow the open angle bracket script/close angle bracket to be present, then you�re going to be okay.  Well, of course people have cleverly found ways around that by using various other means of evaluating expressions to that string.  But with SQL it�s much more like English language, and there isn�t something as obvious as the script keyword to hang onto.  So, I mean, it really is a problem.



LEO:  Fascinating.



STEVE:  It requires extreme sanitization of anything coming from the user.  And believe me, here was 38 examples from March.  There�s a similar number in February and a similar number in January, and it goes back through time.  Because, again, we�ve got people who are not security experts who are using very powerful tools like SQL behind them and web servers to put together an application.  The moment they get it working so that it doesn�t crash when users submit data, they think they�re done.  It�s like, yeah, I got this working.  You know? 



LEO:  I�m done, goodbye.



STEVE:  I�m done.  Pay me.



LEO:  I�m going to go have a hamburger.



STEVE:  Yeah, exactly, pay me, and I�m on to my next�disaster.



LEO:  Yeah, wow.



STEVE:  So it is a very serious, pervasive problem.  And it�s going to take time for awareness of this to filter out into the web developer community because that�s really the only way you�re going to handle this.  I mean, these are valid queries to issue to the SQL Server.  So it�s not possible, for example, for SQL Server or MySQL to say, wait a minute, this looks like it�s a suspicious request.  There isn�t anything suspicious about these requests.  They�re valid requests.  The problem is that people you don�t trust were allowed to make them of your server by leveraging this whole concept of anonymous user-accepted input.  And this creates a serious problem, one we�ve never talked about before, but I�m glad we have now.



LEO:  It�s fascinating, you know, I�ve heard about SQL injection.  And by the way, I�m always looking for updates on the various programs we use on the site like the Drupal program, and there have been SQL injection exploits in some of these programs.  I don�t know about Drupal particularly.  But I always look for updates, and I always make sure I apply the updates.  And if you�re a webmaster, that�s just one more thing you have to do.  You have to keep your eye peeled.  Even if it�s just a stupid guestbook.



STEVE:  In fact, next week we�re going to read a Q&A note from somebody whose ears perked up when I read through that list, and he realized he was using one of the vulnerable things, and it had been exploited to attack his server.  So this is, I mean, this is real stuff.  This is not science fiction that we�re talking about here.



LEO:  Fascinating.  Steve, thank you.  Another great and fascinating subject explaining something many people have heard many times, and now you know exactly what it all�means.



STEVE:  How it happens.



LEO:  Yeah.  Security Now!, of course, is brought to you also by SpinRite.  That�s Steve�s day job.  So I say it�s brought to you by SpinRite because if Steve didn�t have something to do, he wouldn�t have time for this, that�s for�sure.



STEVE:  That�s true.



LEO:  You can find out more at SpinRite.info or on Steve�s site, GRC.com.  And we also want to mention that GRC.com has the 16KB versions of this show, including, what was it, 84a, 85a?  I can�t even remember.



STEVE:  85a will be there by the time our voices are being heard, Leo.



LEO:  You know, it�s funny, because I made a 16KB version of it.  But I completely understand why you didn�t post it because it wasn�t something you would want to save.  It was very specific to a point in time.  It was a news bulletin, really.  But people want completeness.



STEVE:  Lesson learned.  I will have everything posted as of this podcast.



LEO:  You�ve got to remember, nerds like complete sets.  Complete sets.  You know that.  If you�re collecting comic books or Security Now!, you�ve got to have all 87.  16KB versions, transcripts thanks to Elaine, notes, too, at GRC.com.  That�s also where you�ll find, besides SpinRite, Steve�s free security programs.  SecurAble is up there to test the security of your system.  And of course ShieldsUP!, the world�s most popular firewall and router test system, absolutely free, GRC.com.  Next week questions and answers.



STEVE:  Episode 88, we�re divisible by four once again.



LEO:  It�s good.  I like that.  Always enjoy those.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#88

DATE:		April 19, 2007

TITLE:		Listener Feedback Q&A #18

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-088.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world 'application notes' for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 88 for April 19, 2007:  Your questions, Steve�s answers, #18.



It�s time for another thrilling, gripping edition of Security Now!.  Actually, because it�s Episode 88, divisible by four more than once, it�s more than just a thrilling, gripping episode.  It�s the thrilling and grippingest of all, your questions and Steve�s answers.



STEVE GIBSON:  Thrilling and grippingest?



LEO:  Of all, yes.



STEVE:  I like it.  Grippingest.



LEO:  Well, you know, I feel that way.  I feel like they�re really the most interesting episodes because they�re so wide-ranging.  And it�s one of the reasons I do talk radio is really people ask, you know, if you answer questions that people are asking, you know you�re talking about stuff people care about.  So I always enjoy these.



STEVE:  And in fact, I think also that they benefit from the fact that there are all kinds of different topics, not just, like, we�re not focusing on one.  Certainly when we�re talking about a specific important topic, that�s a really good way to do a show, which is what we do for three out of four.  But I think also equally good is a potpourri that involves users� questions and also their comments.  I�m finding people are now beginning not only to ask questions, but to say things that are really worth sharing with everyone else.  So we�re mixing a few of those in, too.



LEO:  We have very smart listeners.  And in fact it kind of surprises me that people, intelligent people, experts in this field, are listening to what we�re doing.  Isn�t that nice?  Doesn�t that feel good?



STEVE:  It does.  I�m almost a little bit embarrassed by it.  It�s like, oh...



LEO:  It�s just this little podcast we�re doing.



STEVE:  But for what it�s worth, people who have written, and many people have, who have said things like I�ve been in IT, you know, for the last 45 years, and I know all about this stuff, but sure enough, you know, I listen to you guys, and I enjoy listening to you.  And every single episode has at least one or two things that even I haven�t run across before.  So that�s just very cool.



LEO:  And that�s the nature of the beast.  And I think anybody who�s really a good security professional acknowledges that.  It�s the people who say �I know everything� who I would watch out for, frankly.  And that�s one of the things I love about you is your thirst for knowledge is insatiable.  And you are the first to say, hmm,�I don�t know, but I can�t wait to find out.  And that�s�what...



STEVE:  Oh, and the web is just so amazing for that reason.  I mean, just anything we want to know we�re able to plow into.  And frankly, Leo, we�ve covered some things in Security Now! that I�ve known in more generality than I have presented it to our listeners because, for the purpose of the show, I�ve had to get much more specific.  So the show is driving me into a greater level of detail for areas, things I just haven�t had any reason to explore before.  So it�s, you know, it�s certainly good there, too.



LEO:  That�s excellent.  Well, let�s, unless you have something you want to talk about from past episodes, delve right into our questions.  We�ve got quite a few here.



STEVE:  Yes, let�s do it.



LEO:  Number one, from Donald Park of Laurel, Maryland.  And whenever I see a Maryland address I think probably works for the National Security Administration.  Okay, that�s fine.  I won�t hold it against you.  He has been wondering about bot networks.  We talk about those a lot.  He says:  Would you agree that the bot network epidemic exists because consumers leave their broadband-connected computer on 24/7?  The best way to limit the number of bots a bot herder has at his disposal would be to limit the amount of time that broadband computers are connected to the Internet.  I do know some people who have various ways of disconnecting from the Internet, whether it�s hardware or just doing it by hand.  Is that a good idea, do you think?



STEVE:  Well, yeah.  It certainly, I mean, it�s not going to solve the problem completely.  I very well remember when I was doing my research into denial of service attacks.  And I was � remember that I penetrated into an IRC chat forum where a major bot network was in operation, that is, as the bots came online, they phoned home into this IRC channel and basically said, hey, Bot #34926 ready for action.



LEO:  Yeah, it�s terrifying to see that because it happens so fast, and so many thousands of machines join up.



STEVE:  Well, and so what I was noticing, and I did this because I was able to see IPs, is I would track those back out of curiosity to see, you know, what types of computers are these?  Are these in universities?  Are they on cable modems?  Are they dialup?  Are they AOL?  At the time, and this is now many years ago, many of there were dialup.  That is, so even though a user is using a machine which is not on the �Net all the time, when they do get on the �Net, the bot is aware of it, it connects up and spends as much time as it�s able to doing its bad stuff.



LEO:  If you have a 100,000-computer network, even if half of them � and if they�re worldwide, it will only be half of them are offline at any one time, you still have 50,000 computers at your disposal.



STEVE:  Exactly.  Now, one mitigating factor is, typically, well, almost exclusively, dialup people are using a modem, which means that their ability to flood the world with zombie bot traffic is really constrained by the bandwidth of their connection, you know, 56K or so, or typically.  But certainly broadband users are a much bigger problem because they�ve got much more upstream bandwidth at their disposal.  And, I mean, I don�t really disagree with our questioner here, Don Parker.  He�s right that always-on computers on broadband connections, that�s the worst possible scenario from a being attacked standpoint.  But it�s, you know, basically it scales back as people turn their machines off, and/or as they have DSL that has a lower rate than cable modem typically and so forth.  So it�s really sort of a sliding scale.



LEO:  Yeah.  In other words...



STEVE:  It just makes things worse, but it wouldn�t eliminate the problem altogether.



LEO:  Not going to get rid of it, yeah.



STEVE:  Right.



LEO:  And I have to say I agree.  Intrepid listener Matt in New Zealand made a disturbing discovery:  I just wanted to let you know your topic on XSS, cross-site scripting, inspired me � uh-oh � to check whether my bank�s website was vulnerable.  It turns out it is.  Oh, dear.  As if that weren�t bad enough, they do some silly things with their session ID cookie.  These two flaws combined allow an attacker to craft a URL which, if visited by a customer, will load a persistent cookie into their browser, even if the customer doesn�t log in after clicking on the link.  And what that means is, when they return to the site, the session ID is the same, so the attacker can easily hijack the session and perform transfers or any other bank transactions as that customer.  I don�t want to disclose any more at this time as I am in the process of dealing with the bank on the issue.  Is this possible that Matt�s found this?



STEVE:  Well, I also eliminated some additional content from his question because it wasn�t appropriate to share it with, you know, a huge anonymous audience.  He was...



LEO:  But it was sufficient to convince you of the veracity?



STEVE:  Yes.  Matt really does seem to know what he�s talking about.  The one thing that, and I wrote back to him, that I would caution him about is nobody likes to be told that some high-value site like a bank�s ecommerce banking transaction site is vulnerable.  There are instances where well-meaning hackers have found themselves brought up on�charges...



LEO:  Yeah.  Adrian Lamo might be the first name that would come to mind.



STEVE:  Yeah, now, there are some people who�ve done it in sort of the wrong way.  So you could argue that there�s a right way and a wrong way to do it.  But technically, unfortunately, our laws now are so restrictive and subject to interpretation that an attorney for the bank could argue that in performing these experiments that Matt had to inherently perform, and notice we don�t have Matt�s last name here, in doing this he was �hacking the site,� that is, he was performing conduct outside the terms and services that are posted on the site.  Therefore, you know, even though he�s trying to help them, there have been situations where people who have only wanted to be helpful have found themselves on the wrong side of a lawsuit and criminal charges.  So it�s something, unfortunately, that is very delicate.  The only thing I could suggest is that, if other people were to do this � and maybe Matt is being anonymous, I hope he�s being anonymous � I would certainly start out that way, you know, somehow bring it to people�s attention in a way that�s not putting a bull's-eye, you know, on you.  But it is really interesting that he, you know, he did some poking around after listening to last week�s, or two weeks ago, our cross-site scripting episode, and apparently discovered a vulnerability.



LEO:  Unbelievable.  Amazing.  Wow.  Nathan Clark of Allendale, Michigan, he says:  I like Vista.  But I�m having a little trouble with it.  I recently purchased a new laptop.  It came installed with Windows Vista Home Premium.  I actually enjoy the OS more than I thought I would.  I have noticed one key problem.  Occasionally when a program is launched that requires administrative rights, the system won�t switch to the protected mode correctly.  The only way to get past this is to log out and log back in.  I think when he says �protected mode� he�s talking about UAC; is that right?



STEVE:  Exactly.



LEO:  I was curious if you have any advice and wanted to raise awareness about this problem.  I haven�t seen this myself.  Do you know what he�s talking about?



STEVE:  Yes.  There have been some reports of this.  And having programmed UAC for my little SecurAble freeware, I understand what�s going on.  And it�s a consequence of the way Windows is sort of trying, again, to give us the best of both worlds.  As we know, when you log in, you are inherently protected because you�ve got non-administrative credentials.  And then the User Account Control attempts to elevate your credentials.  Well, it�s very possible to write code for which that will not work.  For example, code could be � and this gets into the entrails of Windows.  But there are ways you ask for things from Windows which are marked with your rights at the time they�re granted.  So if a program were to ask for things before Windows realized that what it was going to do with those things are privileged, the rights granted to those initial tokens would be limited, and they�re not dynamically regranted as a consequence of�UAC.



So basically this is a perfect instance of, again, what Microsoft is trying to do is solve the problem of people normally running with too much rights, more rights than they really need for most workaday things, and then not making it necessary to log out and log back in, in order to do things that need administrative rights.  Mostly they�ve solved the problem in an elegant fashion.  But as is always the case, there are incompatibilities with some programs that assumed the rights you have when you log in are the rights you�re ever going to have during that log-in session.  That�s what Microsoft deliberately changed.  And what Nathan is seeing is a place where a particular program isn�t flexible enough to accept the greater rights be granted it because Microsoft just isn�t doing the right thing because Microsoft has changed the rules, essentially.



LEO:  So it�s a non-Vista-aware program, essentially.



STEVE:  Yes.  And, you know, most programs today are non-Vista-aware.  And Microsoft is trying to be compatible with them.  This one they stumbled on a little bit.  So unfortunately either the...



LEO:  Look for an update.



STEVE:  Yes.  The program could be updated for this to work, or this may well be something that just is not going to be happy if it�s normally running with less privilege.  And it�s not going to understand that suddenly it�s got more privilege now than it did when it was initially started up.



LEO:  Right, right.  Donald Parker in � I�m sorry.  Back to Question 4.  Don�t want to skip Chris in Connecticut.  He�s been wondering for a while:  I�ve used your Shoot The Messenger and Unplug n� Pray � these are free security tools Steve offers at GRC.com � to disable these unnecessary services.  I guess Shoot The Messenger is that Windows Messenger service that actually Kevin Rose discovered was a flaw in Windows, and UnPlug n� Pray is that Plug and Play service.  What�s to keep malware from just turning them back on?  In a similar vein, I�ve noticed that some software, Retrospect Backup, for instance, offers to open the necessary ports on the Windows firewall when it installs.  Well, what�s to prevent malware from doing the same thing and not letting me know?  I know that once malware is running, all bets are off.  But some of these measures are ideally supposed to help control the damage.  Are they helpful?  Or are they just window dressing?  Oh, good�question.



STEVE:  I thought it was a great question.  Okay.  First of all, most of the things that I was doing during pre-XP and also now pre-Vista, that is, you know, before XP but all through XP, I was doing some quickie little freeware, in some cases to fix a problem, often to turn off a service that Microsoft had running by default which was known to have security vulnerabilities.  So, you know, Shoot The Messenger turned out to be a problem.  Not only was it causing pop-ups on users� systems, but it turns out that because it was a service with an open listening port that was just collecting anything that came in, there were ways that it could be taken advantage of.  The Universal Plug and Play was a service that was found to be vulnerable.  And, again, I was just annoyed with Microsoft that they had all these services running by default just to make things sort of work automatically, even for people who didn�t need them, which really represented a problem.



Now, what�s changed is, with Service Pack 2, Windows� own firewall is on by default.  So even if you had open ports on your system, they are behind a firewall.  Now, the beautiful aspect of the second part of this question is he�s talking about how some programs are able to programmatically and silently open ports through the firewall.  That�s absolutely true.  And it�s one of the reasons that having a router is still a good thing, even if you�ve got a PC with a personal firewall.  Any software that wants to, whether good or bad, has a documented and officially supported means for basically bringing the firewall down for all intents and purposes.  It may not want to turn the whole thing off because then all kinds of bells and whistles start warning you that your firewall�s been turned off.  But it doesn�t need the whole firewall down.  It can just open one hole through the firewall that allows external hackers to get in through that route.  So that cannot happen, however, if you�re using a NAT router and you turn off the NAT router�s autoconfiguration, which is Universal Plug and Play in the�router.



So, you know, he�s correct that, essentially, I would say that you could turn these services off if you want to using my freeware or just, you know, shutting them down using the normal service management panels in Windows, both XP and Vista.  But it�s really not that necessary now.  And you can have side effects if things depend upon those services.  As long as you�re behind a NAT router with Universal Plug and Play disabled, it�s not possible for software inside the network to go reconfigure the router to make it vulnerable.



LEO:  Okay.  But on the computer it can do anything it�wants.



STEVE:  Yes.



LEO:  And that�s the real problem.  Once you�ve been compromised on the computer, you�re kind of out of luck.



STEVE:  Yes.  You never then are really able to trust it again because you don�t know what might have happened to it.



LEO:  So they�re not Window dressing, they�re a barrier.  But since a lot of hackers know enough to do this � this is why I always say that a software firewall isn�t necessarily very useful because they can often be disabled.



STEVE:  Yes.  And in fact we�re also seeing the typical refractory delay from introduction to implementation of exploitation.  You know, sure, XP�s firewall�s on.  Before Service Pack 2 it wasn�t, so it was never a problem, so hackers weren�t worrying about it.  Now that it is on all the time, and Microsoft has a published API, an Application Programming Interface that allows software to open holes, for example, you know, you would want your instant messaging program to work easily without requiring that people had to manually reconfigure their firewall.  So good programs are doing this on behalf of their users.  But so can malware.



LEO:  Right, right.  Donald Parker, Laurel, Maryland, has a solution to the bot network epidemic.  He writes:  I seem to be the only person on the planet � see, whenever I read that � all right.  I�m just going to keep reading.  I seem to be the only person on the planet that knows how to defeat bot network herders.  I can�t get anyone to listen to me.  The botnet epidemic cannot be solved with a software solution.  A distributed attack method must be met with a distributed defense strategy.  No one seems to realize this problem exists because of broadband technology.  With dialup computers, they were only connected and susceptible to hackers when they went through the long process of connecting to the Internet.  With broadband � this is the same kind of thing as our first question.  With broadband, people leave their computers powered on when they go to sleep at night and leave for work in the morning because they want the convenience of instant access to the Internet.  Hackers use their computers more than their owners do.  No broadband-connected computer should be allowed to connect to the Internet without some method of automatically disconnecting the computer from the Internet, whether the user shuts down their computer or not.  If hackers don�t have so many potential bots at their disposal, the threat would decrease significantly, and cyber law and order would be restored.  Steve, do you want to just shoot this down now, or...



STEVE:  Well, we actually did.  I guess I covered this in answering the first question much more thoroughly than I had intended to in the first question, thinking of this question.  Basically he�s just saying that broadband-connected machines are the problem, and that they should not be left turned on or connected.  The reason I wanted to bring this up is this does provide sort of some additional fleshing out of that idea because in fact there are many reasons why people do leave their machines on all the time and connected to the Internet.  For example, you want to be able to download large podcasts in the middle of the night and not sit around having your bandwidth tied up by doing�that.



LEO:  And we see this all the time, a lot of botnets are in universities or businesses where computers are left on all the time for perfectly legitimate business reasons.  And there�s always going to be enough of those on.  And by the way, if you have a big enough pool, let�s say 600 million Windows users, there�s sure to be, let�s say 100 million on all the time.  Plenty.  Plenty.  Right?



STEVE:  Yes.



LEO:  I mean, even if they�re not on all the time, if they�re on now, on at any given moment I guess is what I should say.



STEVE:  Right.  And also, again, it seems to me that, well, I�m not one who recommends turning machines on and off all the time.  All of my main machines are on all the time.  I know that�s becoming nonpolitically correct from an energy consumption standpoint.  But it is really wear and tear on the system to heat it up and cool it down and heat it up and cool it down, as opposed to just letting it stay idling.  And of course newer machines are much better about their energy consumption when they�re not in use.  They�ll spin down the hard drives, they�ll blank the monitors and, you know, go into an energy-conserving mode.  So, you know, I�m not someone who thinks you should be turning your machines off all the time.  And certainly unplugging them from the �Net is a pain, too.



LEO:  Yeah.  Aaron Burns in the United Kingdom is seeking a�bit of assurance:  I was wondering if WPA-PSK is at all crackable?  I�ve heard it can be cracked offline using the�brute force dictionary attack.  But if you use a 63character random password you�re virtually uncrackable;�right?



STEVE:  Right.



LEO:  Next question.  No, people will ask me that almost every week, well, I heard WPA was cracked.  And it was cracked in the same way that you would crack, say, PGP or any encryption tool if you use a bad password.



STEVE:  Yes.  The proper thing from a crypto science standpoint to say is that the only known attack on WPA using a preshared key � which is what the PSK stands for, WPA with a preshared key � is that if the key can be discovered.  The only way to discover the key, again, the only known way to discover the key is by taking a chunk of data that was encrypted using that key, taking it offline, means take it home with you and give a powerful computer the job of trying either all possible keys or all mixes of words in a dictionary, the so-called dictionary attack.  These are brute force.  And as long as you�ve got a long key that is just looks like gobbledygook, I mean, the kind of keys generated by my passwords page, GRC.com/passwords, I on-the-fly generate keys for people over a secure connection that cannot be sniffed which will never be generated again.  And you can refresh the page a few times, grab pieces of keys if you want to, like, make up your own, so you�re not even using one that I gave you, but it�s just raw password material.  If you use that, you are doing everything you possible can to be secure.



The reason I also enclosed this question was just last week�huge progress was made in cracking WEP, the original insecure technology.  And that�s going to be the topic of next week�s podcast is looking at what happened to WEP.  It just got a lot worse.  So anyone who�s still using it thinking that, oh, it�s good again, it�s still good, it turns out you can crack now, using the update, any WEP-encrypted network in around a minute.



LEO:  Wow.  That�s really bad.  And just to reiterate, WPAPSK is perfectly secure if you use a good, strong password, one that, you know, not in the dictionary, not your dog�s name, not iamsosexy, something a little harder than that.  And of course Steve�s got that great password generator for you.



STEVE:  Yeah.  Mine is one of those, I got it from my own page.  And, I mean, I don�t know what it looks like.  It�s nothing I can remember.  But I have it in a text file.  And when I�m configuring a machine, I�ve got it on a USB dongle, I�ll stick it in, open the file, drop the password in, and then take it out.  So I�m not leaving it on the machine.  Because the password is then hashed into an actual key that the WPA system uses.  So, you know, mine is not something I even know.  I don�t know my own password.  It�s just 63 characters of junk.  But I�m as secure as I can be with WPA using a preshared key.



LEO:  That�s one of the nice things about WPA.  You only enter it once, and that�s it.  You don�t have to reenter it again and again.



STEVE:  And XP and Vista really like it.  They work very, I mean, they�re happier with WPA than they are being forced back into WEP encryption.



LEO:  Oh, really.  How interesting.  Mark Jones of Midland,�Minnesota says:  I have a question concerning vulnerabilities such as the recent cursor zero day.  I�m careful.  I keep up to date.  I also find myself diagnosing other people�s machines, especially my less-than-computer-literate relatives.  The nightmare scenario, next to the family fortune going to Nigeria, is that Pop�s machine becomes a zombie.  How do you know whether your machine is a zombie?  This is good.  I want to know this.  Will processes be running continually?  Do these machines just phone home and start up?  Is there something to look for?



STEVE:  There are a couple things to look for that we�ve touched on in earlier episodes, but it�s always worth, you know, making this current and reminding people.  Two ways you could see a zombie.  And this is what I do if I encounter a machine for the first time.  I did a week ago, I went over to a friend�s house, exactly like this, not a relative, but a friend who said, you know, something feels wrong.  The system really seems slow.  Could you take a look at it?



So I ran Task Manager, which is, you know, it�s in every version of Windows, and you can also get it by doing Control-Alt-Delete, and it pops up the little window from which you can select to run Task Manager.  And I look at the process list, which is everything that Windows says is running.  Now, many of these things are cryptic looking.  You know, there are things you may not be familiar with.  But over time you can develop some familiarity with them.  Of course, you know, I live in there.  So I was able to use Task Manager to just sort of browse down through the stuff he had running and see whether there was something that really looked suspicious.



If you do find something suspicious, you can then � what I�ll do is use the search, the file search built into Windows, I�ll put the name of the program, because it�ll say, you know, pqrdzx.exe.  It�s like, okay, well, that one doesn�t ring a bell.  So I�ll just cut and paste that or type that into search, have it find the file for me in Explorer.  Then I can right-click on it and look at its properties, and the version tab will tell me who made it.  And almost always it�s like, oh, yeah, that�s my, you know, the Corel Photo something or other; or it�s the driver that came with my HP scanner; or, you know, there�ll be something that is immediately recognizable about that, that then disqualifies it typically for, like, further concern.  If it�s not something that has a version tab, and you can�t recognize what it is, then even so, normally where it�s located on your main system drive, that will often give you a clue.  When you search for it, it�ll show you where it found it on the disk.  It�s like, oh, okay, well, that�s under an application that I installed a week ago, and so I know what that is.  So looking at the process list is one good way.



Now, that fails if what you�ve got in your system has rootkit technology because, as we know, rootkit technology specifically is rootkit technology because it�s able to hide itself.  One of the things that really good kernel-level rootkit malware will do is, once it�s running, it will go down and edit the data structures which govern running processes.  There�s a list, literally a linked list of processes where the first one has a link to the second one that has a link to the third one and then so forth.  Well, what the malware will do is, when it finds itself running, it will read through the list until it finds the one that�s pointing to it, and it will instead point that to the one it�s pointing to, essentially unlinking itself from the list.  When it does that, then simple task enumerators like Task Manager won�t see it.  It just won�t show up at all.  So while Task Manager is useful for sort of giving yourself sort of an appraisal of what�s going on, it�s not something you can absolutely count on; but it works more often than not, enough so that it�s the first place I always go.



The second way that something that is running in your machine and playing with a network will show up is with the so-called �Netstat� command, which we did an entire episode on.  So essentially there are commands you can give when you open a DOS box window, Netstat followed by some parameters, that will quickly show the activity, the network activity of your various network-using programs, processes again, running in the system.  And you can see if ports are open, if connections are made; and, using the proper commands in XP and Vista, it will show you the name of the process doing the communication.



Now, what�s cool about that is many fewer processes should be listening with open ports or talking.  So Netstat can be used to narrow this down dramatically.  And I would refer people back to the episode that we did entirely on Netstat.  Anyone who wants a little refresher on this, we really gave it good coverage about a year ago.



LEO:  So it really isn�t like Norton Antivirus or something for detecting invasions.  There are just too many possible ways you could be co-opted.



STEVE:  Yes.  And there are always things that are happening before the AV companies are up to speed.  And that�s what bites people.



LEO:  Yeah.  Babak � oh, by the way, I think AVG, the folks who do the free antivirus, have just announced a free anti-rootkit, although there are several other choices, as well.  But it�s nice to have another anti-rootkit, or at least a rootkit detector.



STEVE:  The more the merrier.



LEO:  Yeah.  Babak in San Jose, California asks:  I was wondering if you could comment on which hard disk defrag and  maintenance tools you prefer.  I�m referring to tools that run under Windows.  What do you use to defrag and maintain your disks?  Besides SpinRite.



STEVE:  Well, certainly SpinRite for sector-level maintenance.  There is a defragger that you�ll know well, Leo, probably.  It�s still around, and it�s my favorite.  It�s from a company called Golden Bow Software.



LEO:  Oh, that�s still around.



STEVE:  That�s Vopt.



LEO:  That�s the one that Jerry Pournelle would just sing the praises of.



STEVE:  Yes.  And I�m still doing so.  I�ve become less and less impressed by Microsoft�s defragging.  I find that when I use the defragger in XP or especially Vista, Vista they just took all the meat out of it.  I mean, it�s just amazing.  I�d like to see...



LEO:  You�re not supposed to really need it, though, with NTFS, are you?



STEVE:  I know.  But just it feels good.  It just feels � I don�t want all these little red teeth all over my hard drive.  I like everything to be in little blue blocks.  And so anyway, Vopt is my favorite defragger.  It runs, I�m not sure about Vista, but certainly all the way through XP.  And I�m sure they must have a version now because Vista�s been around long enough.  Anyway, they�ve kept it alive.  It does a very good job.  It�s got a whole bunch of really nice�features.



The thing that�s built into Windows, there�s a disk cleanup which is something I also recommend that people use because it empties your trash, it throws away a whole bunch of the cached stuff that your Internet Explorer browser has downloaded.  I mean, and many times, in many cases, hundreds of megabytes of just stuff you really don�t need.  And so when you run this, it will get rid of that stuff.  Vopt has an even more thorough version of that that does a better job, a deeper job of cleaning up really the debris that the systems accumulate over time.  And it is the case also that defragging your system will mean less wear and tear on your hard drive.  It�s the head moving which will create wear and tear.  And that�s what causes heat.  If a drive is just sitting there idling, or not moving the head a lot, it will run cooler than if the head is flying back and forth all over the place.



LEO:  It is possible to over defrag and make it worse.  In other words, you shouldn�t run these things every day because then you�d be doing the opposite.  You�d be overexercising your drive.



STEVE:  Yes.  You�d be putting the drive through more work than it wants.  And there is also something, a sort of a SpinRite-ish benefit to defragging, and that is that it does cause your system to revisit areas of the drive, and it allows the drive to see that it�s got problems that it might otherwise not be aware of.  SpinRite, of course, does it from zero to a hundred percent.  I mean, it does the entire surface.  Defragging doesn�t guarantee you that, but it�s another sort of a good thing to do, just sort of, you know, shake the dust loose from the drive.



LEO:  And by the way, Vopt is available for Vista, does work with Vista, $40 at Vopt.com.



STEVE:  The other one that I love is a funky program called SpaceMonger.  There was a program that I was using for years called DriveMapper.  This is a really cool visual technology.  Imagine that you � and it�s visualization, which is what I love about this.  How do you know, when you notice that your hard drive is, like, fuller, like, by a lot than it was a month ago, how do you know where the space went?  Well, SpaceMonger, which is free, the reason I�m mentioning it, is v1.4 is free.  Sean the developer is now charging for 2.0, which does a whole bunch of more stuff than version 1.4.  But frankly, 1.4, the free version, is all anyone needs.  If you just put SpaceMonger into Google, it�ll find it for you.



What this does is, it shows your hierarchy of folders and files on your computer in a hierarchy, a nested hierarchy of rectangles on the screen where the size of the rectangle is the relative size of the file or directory.  So when you let this thing run on your computer, the first thing you�ll see is, like, big chunks of stuff which are like, you know, videos you downloaded three years ago and forgot about, or a whole tree of audio WAV file songs buried deep under My Documents, My Songs, My Audio Albums or something, you know, way down sort of off the chart.  But there it is sitting there, occupying 650 megabytes per CD, and you just forgot about it.



So what�s so cool about SpaceMonger, and in fact this is the thing I also use, I downloaded it on the spot when I was over at my friend�s house a week ago when he was saying that his computer was running so slowly, and we found exactly that.  This guy had downloaded DVD content from a couple years ago and forgot about it.  He had, you know, each DVD is 4.7 gig.  He had, like, six or seven DVDs sitting on his computer, just forgot about it.  But boy, it stood out like a glaring problem under SpaceMonger because it makes it so easy to see where the space went.  So I really recommend it without � it�s free.  I recommend v1.4 without hesitation.



LEO:  And there�s a similar OS X application.  And I thought it was DiskView.  I�m trying to remember, something X, anyway, that�ll I�ll find for you.  We�ve mentioned it on the show before.  It�s very � it�s really a useful thing.  To see what you�ve got is so handy.  I think it�s actually, ultimately was based on a UNIX X Window application way back, from way back when, that would show this beautiful graphical display of what you�ve got.



STEVE:  Well, it�s funny, too, because the original one, this DiskMapper, was all burdened with intellectual property claims and patents and all this stuff.  Well, it turns out that Sean found that this had all been done in a university environment, and all this technology, this notion of nested size-relative rectangles, is in the public domain.  It was put there by the people who developed it so nobody could claim ownership of it.  It�s very cool.



LEO:  Let�s see.  So any other tools?  Let�s see, that�s a defrag tool is Vopt, maintenance tool � oh, SpinRite.  There would be a good choice.  If you have a hard drive problem, just keep SpinRite in mind.  Will you do me a favor, that�s Steve Gibson�s, not free, but excellent utility for protecting your hard drive.  It really is, I mean, let�s face it, a great tool.



Question 9, Jon in Katy, Texas:  I�m on a small corporate LAN with a Cisco router and a separate stateful firewall.  How can I allow outbound SSH connections, but block the building of outbound tunnels to defeat my proxy firewall settings?  Outbound SSH tunneling seems like a great way to exfiltrate data.  People do it all the time.  It�s a great way to build a tunnel; and then, you know, the IT guy can�t see what you�re doing.



STEVE:  Yes, and there is nothing he can do about it.



LEO:  No.  If you�re going to allow outbound SSH, you�re allowing tunneling.



STEVE:  Yes.  The only thing that, well, I mean, the only thing that I could imagine doing would be to try to get control of your clients.  But even the client firewall on the computer, it�s going to see this connection originating from inside and allow it to go outbound.  So it�ll go through the client firewall, through the corporate firewall.  And, you know, if he wants to allow outbound SSH connections, then, you know, they can be tunnels.  And because they�re inherently encrypted, I mean, there�s no way to see inside those, tunneling is absolutely possible.



The only thing I could imagine would be, and this is, you know, hard to implement and sort of at corporate level, would be if he were to proxy SSH and force his users to use a certificate that the proxy server had.  Then essentially that would allow him to perform a corporate authorized man-in-the-middle attack, essentially terminate the SSH connection at the corporate firewall proxy, decrypt it, filter it, and then establish a second leg SSH connection out to the remote destination.  So basically you would be breaking the tunnel open, running it through permission filters, and then reassembling it, you know, connecting it back into a tunnel and sending it out.  But again, you know, it�s possible; but it�s certainly not something easy to do.



LEO:  He really could use a corporate VPN or something else like that that would be probably a better solution, right, than setting up SSH.  Same problem?



STEVE:  Well, yeah, but a corporate VPN, I mean, a VPN is a tunnel, yeah, it�s an encrypted tunnel.  If you allow that to happen out through your firewall, you have no way of monitoring what your users are doing.



LEO:  Jason Anderson in Wisconsin is a savvy webmaster who got caught by cross-site scripting.  Oh, no.



STEVE:  This is the one I referred to last week, Leo.



LEO:  Yeah.  I heard your last podcast on cross-site scripting.  My ears perked up when you said that Webmin had a vulnerability.  Lots of people use Webmin.  I have a server that runs Gentoo Linux, and it recently became compromised because of this Webmin vulnerability.  Wow.  I installed it and forgot about updating it.  See, this is what happens when the newer versions came out.



STEVE:  Exactly.



LEO:  And a hacker found my user credentials in Webmin, SSH�d � oh, boy � into my server.  It then proceeded to set up a phishing site in one of the subdirectories of the Apache server.  The phishing site was a PayPal site.  After a week or so I got a call from RoadRunner saying that I was hosting a phishing site on my web server, and the domain name was being revoked.  I logged onto my server, removed the phishing directory.  I then checked the bash history to see if they did anything else that would compromise my server anymore.  Remember, though, folks, they�re going to change these bash logs and the other logs.



STEVE:  Exactly.



LEO:  I also took a look at the SSH logs, saw that it wasn�t a brute force attempt, they just logged right into my server with the right credentials the first time.  I then began to think about what software I had installed on that server and narrowed it down to Webmin.  When I checked the change logs on the Webmin site, I found that my version of Webmin was below �1� � P.S.:  SpinRite has saved the day at our office many times.  It�s great to be able to tell high-ranking university professors we�re able to save their hard drive and their millions of dollars of grant applications � and upgraded immediately.  What�s �below 1� mean?  I don�t understand.  My version was below, oh, below 1.1.  Oh, my gosh.  And upgraded immediately.



This painful lesson has taught me that it doesn�t matter what kind of software you have installed on your server.  It has to be updated on a regular basis.  After this was all over I set up a script that would check for software updates every day � many Linuxes do this now, by the way, automatically � and then email the list to me so I can keep track of what needs to be updated and as a reminder to update my server.  Thank you for Security Now!.  I love the show.  Keep up the great work.



Now I�m going to read the footnote which I shouldn�t have read when I read it.  P.S.:  SpinRite has saved the day at our office many times.  It�s great to be able to tell high-ranking university professors that we are able to save their hard drive and their millions of dollars of grant applications.  Another happy customer.



STEVE:  So that was an interesting posting.  I thought it was really interesting.  I wanted to include it because, you know, we mentioned Webmin as a vulnerability.  And here, from all the evidence that he has cited and his own forensic analysis, you know, he�s told by his ISP that he�s running a PayPal phishing site on his server that he had no knowledge of, and then goes in and tracks it down to them using SSH to log on to his server remotely.  And then by further pursuing the parsing of his logs he sees that they logged in perfectly the first time, no brute force into his SSH tunnel, but first time they were able to get a command shell; and from there they were able to do everything that they wanted to.  So really interesting.  And it was caused by exactly what we were talking about two weeks ago, a cross-site scripting vulnerability.  And he�s a happy SpinRite user.



LEO:  What more could you ask for?



STEVE:  Very cool.



LEO:  College student Brian K. at Penn State has an interesting dilemma:  I�ve been playing around on my Mac lately, and I�ve recently installed Vista into Boot Camp to see what�s going on with this latest version of Windows.  Of course, why not?  I was also playing around with ShieldsUP.  I noticed that the IP it showed is the same IP I have in my computer.  I�m in a college dorm, and I had to give them my MAC address and such to set up while they gave me a static IP to use.  Seeing this IP in ShieldsUP makes me wonder.  Am I not running behind a router?  Do I have a direct connection to the Internet?  Should I be worried?  I know when I�m on campus wireless they make you use a VPN, but that doesn�t work from the dorm.  I just want to make sure I�m secure, even though I�m running a Mac.  Why is he seeing his real IP address?



STEVE:  That�s a great question.  This is evidence of the fact that he is not behind any sort of a NAT router.  When he�s using ShieldsUP, when any user is using ShieldsUP, the IP that ShieldsUP shows, you know, my free security testing facility, is that public IP from which ShieldsUP sees a connection coming to the server.



LEO:  That should be the router address; right?



STEVE:  That would be the router address, exactly.  So any home user behind a router, whereas their computer will be 192.168.something.something, the ShieldsUP will show you, you know, the public IP, 38.172 or, you know, whatever your public IP is.  But something that�s not a 192.168, it�s not 10., it�s not 172, it�s a public-facing IP.  The fact that his campus IT people wanted his MAC address means that they probably are running a DHCP server where they have built a database of associated IPs and MACs.  So his computer is set up to obtain an IP address automatically.  When it does that, it says, here�s my MAC address, what�s my IP?  Well, they�re giving him a public IP which they�ve associated with his MAC address.  That way...



LEO:  That�s wrong.  Is that misconfigured?



STEVE:  No, it could just be the way their campus network is set up.  I mean, they must have a big network where they can afford to give public IPs to the students in dorm rooms.



LEO:  They have what we call �static IPs.�



STEVE:  Yeah, it�s like it�s a cool, real IP.  Now, the problem is, of course, you don�t have the protection that we�re pretty much now taking for granted is going to be between users and the Internet in the form of a NAT router.  So it does mean that, you know, he asks, what does this mean, am I vulnerable, well, you know, it means you are entirely dependent upon your software firewall running in your computer.  And that would make me nervous.  Given that NAT routers are now in the $49 range, it�s so simple to stick a NAT router on your IP connection from...



LEO:  Oh, yeah.  He can just put one in his room.



STEVE:  Exactly.  Run your own local NAT router.  And then you get the advantage of Wi-Fi, if you�ve got a wireless NAT router, and we know how you want to be secure that way, and then also being able to plug multiple computers into your own little personal local router.  So that�s definitely what I would do.  It�s funny, you know, maybe it�s that I�m obsessed about security.   But Leo, the idea of, you know, a direct, unfiltered, un-NAT-protected connection, I mean, even you sound like it makes you a little nervous.



LEO:  Well, it does, yeah.  If it�s really the case.  I mean, isn�t it possible that he could still be protected but he�s got a static IP address? 



STEVE:  Well, yeah, that�s a very good point.  The campus�could have a firewall which is firewalling all inbound traffic.



LEO:  Yeah.  They must be doing that.  I mean, it�s Penn State.  It�s not some...



STEVE:  It�s not Podunk State.



LEO:  No, it�s Penn State.  I�m sure they�re doing that.  I can�t believe they wouldn�t be.  But of course we know we can never assume that anymore.



STEVE:  A lot of strange things happen in universities.



LEO:  Yeah.  Wow.  Oh, I know why they do this.  Well, they don�t need to do it to do this.  But I think maybe this is kind of to tell people, hey, if you are going to do filesharing or anything illegal on our network, you�re kind of out there with your personal IP address.  Maybe that�s why they do that.



STEVE:  Oh, it�s interesting, yeah.



LEO:  Because you know they�re filtering it.  Anyway, just a thought.  Question 12, Victor Rodriguez of Arvada, Colorado asks:  I was listening to your episode about cross-site scripting, couldn�t help but wonder why someone would want to use my browser when I visit a given website to seek out and find cross-site scripting vulnerabilities on other websites.  Oh, he�s talking about, what was it...



STEVE:  Jikto.



LEO:  Jikto.  Why wouldn�t they just seek out those vulnerabilities from their own systems?



STEVE:  Well, of course the reason is that they would rather not expose themselves to anyone backtracking.  Essentially they�ve turned your machine, not into a malicious traffic-generation zombie, like so many DDoS or spam-generating systems are.  They�ve turned your machine, your browser, using browser scripting, into a vulnerability scanning system so that, if anyone sees, hey, wait a minute, somebody is poking at m web server looking for cross-site scripting and other sorts of vulnerabilities, well, as we know it�s not possible to spoof a TCP connection.  You can spoof UDP packets like are used in floods.  But you have to actually have your real IP connection known by the server who you are trying to exploit.  So if they�ve got logs, they�ll lock down your IP and could pursue you directly, saying we know what IP you are.  They get a court order to force your ISP to release your personal data, and the FBI will be knocking on your door.



LEO:  Well, there�s a second value, is that you can assign an army to this task.



STEVE:  Exactly.  Exactly.



LEO:  You can have much more success because you�ve got millions of people out there doing your work.



STEVE:  All working in parallel.



LEO:  It�s the ultimate distributed computing, without your�permission.



STEVE:  Yeah.



LEO:  Steve, we�ve gone through 12.



STEVE:  And we�re on to Episode 89 next week.



LEO:  Wow.  You�re going to get to 100 before we know it.  I�m going to have to work on some great prizes or something.  I�m sure we can come up with something.  Do we know what we want to do next week, or...



STEVE:  Yes, next week we�re going to talk about a dramatic breakthrough in Wi-Fi security cracking, the WEP protocol, which used to take a long time to hack, now takes less than a minute.  And we�re going to talk about how that works.



LEO:  Great.  More security coming your way.  We thank you so much, Steve Gibson.  GRC.com is the place to go for the 16KB versions of this show, the transcripts, the great free security software Steve offers like ShieldsUP, SecurAble,  and of course, lest we forget, the great SpinRite, the ultimate disk recovery and maintenance utility.  If you�ve�got a hard drive, you need SpinRite.  Get your copy at�GRC.com.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#89

DATE:		April 26, 2007

TITLE:		Even More Badly Broken WEP

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-089.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo review the operation of wireless network security and discuss in detail the operation of the latest attack on the increasingly insecure WEP encryption system.  This new technique allows any WEP-protected WiFi network�s secret cryptographic key to be discovered in less than 60 seconds.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 89 for April 26, 2007:  WEP Insecurity.



Time to gather together to talk about security, something very important today in computing and the Internet.  And of course there is no one I�d rather talk to about security than my trusted friend, Steve Gibson of GRC.com, the man who�s done more to secure individuals, I think, than anybody else.  Have you hit 50 million yet on ShieldsUP?



STEVE GIBSON:  I just looked at it this morning, as a matter of fact, Leo.  We�re at 49.2 million uses of ShieldsUP.  So, yes, we�re approaching � that�s going to be really neat, to actually cross the 50 million uses of ShieldsUP boundary.



LEO:  And as Steve will say, but I want to reiterate this, that if you hit it, like, three times in the same hour, that�s one.  That counts as one.  Steve�s talking about these are kind of unique hits at way different times and so forth.  This is people who are actually using it.  And it�s really amazing.  50 million.



STEVE:  It�s actually, it�s a good count because I keep track of in a list the IPs of the most recent 4,000 � actually, you know, 4K of course, 4096, being a programmer.  And if the same IP is still in the list, I move it to the front of the list and don�t count it again.  So, and with about 25,000 people per day, you know, so it�s going to last maybe four hours.  And so if someone comes back after that length of time, I think it�s reasonable to count them again.



LEO:  That�s a new test.  Yeah, they�ve done something, and they�ve changed their system, and they�re trying it again.



STEVE:  Right.  But if they�re poking around at the site, I only count them once.  So, you know, I�m really happy with that number.  And in fact someone in the U.K. just yesterday, I got a link, I saw it posted in our newsgroups, has done a � he�s like an IT guy with one of the major U.K. magazines � did a user�s guide to ShieldsUP because he was tired of answering the same questions over and over and�over.



LEO:  Hey, that�s handy.



STEVE:  So, yeah, it�s very nice.



LEO:  Although I have to say the online help in ShieldsUP is so good that I almost always refer people, I just say, hey, read � once you get your results, read what Steve says about it because it�s everything you�d ever want to know about port checking and all that stuff.



STEVE:  Right.



LEO:  I mean, it�s all in there.  Do we have any errata, addendum, something...



STEVE:  No, we don�t have any errata.  We did a Q&A last week, so I didn�t have any errata from that.  But I do have a really fun testimonial that refers to the testimonials that we�ve received in the past from SpinRite from a Security Now! listener that I want to share with people because this is the kind of story that really makes me feel neat about SpinRite.



LEO:  You get these stories every day, it seems like.



STEVE:  Well, yeah.  Yes.



LEO:  That�s kind of neat.  I mean, that�s really neat.  It must make you feel good.



STEVE:  I have lots of them.  And it is neat.  This is from�a guy named Duncan Smith, who is one of our listeners.  And he says, �Dear Steve and all at GRC, I�ve listened to so many of these testimonials on Security Now! and now have reason to join the ranks of ecstatic customers with yet another �SpinRite saves the day� story.  My mother� � and I think he must be English from some of the idioms he uses.  You�ll hear this in what he says.  �My mother retired several years ago and enrolled in part-time classes for a horticultural degree.  For the past six years she�s been working away, and for the last nine months has been undertaking her final dissertation.  To celebrate the recent�completion (but not submission)� � uh-oh � �of the�dissertation...�



LEO:  Uh-oh is right.



STEVE:  Nine months of work on her dissertation.  You know where this is going.  So he says, �To celebrate the recent completion of the dissertation and my father�s recent retirement, they embarked on an eight-week trip of a lifetime to New Zealand.  Last night I got the dreaded phone call.  Her PC was stuck in a never-ending loop of restarts, never making it into Windows.  The hard drive was also making �unusual noises,� and her local PC store, as well as a computer-savvy neighbor, had suggested the hard drive was beyond repair and all was lost.  She had no backup, and the PC contained all her degree work and all their digital pictures from that holiday and several years of other�holidays.



LEO:  As if the thesis weren�t enough.



STEVE:  Yeah, it�s all the photos.  So...



LEO:  You know, it still gets me that people are not backing up, just drives me crazy.



STEVE:  It�s just, you know, it�s because, of course, you know, I�ve lived with SpinRite and these kinds of problems and solutions now for, I think, like, 19 years, 20 years.  It�s just that the computer works today, and they turn it on tomorrow, and it works.  And they figure, well, it�ll work day after tomorrow.  I mean, it�s just, you know, it lulls, it truly lulls into sort of a false sense of security.  And the other thing is, I think, when the computer is new, it contains nothing of value that isn�t obviously immediately replaceable.  And over time that value that it stores grows slowly.  And so there�s never really an event where it�s like, oh, now I really need to start backing up.  It just creeps up on you, and suddenly...



LEO:  There�s no warning.  There�s no warning.



STEVE:  Yeah.  Anyway, so he finishes, he says, �I�ve been considering purchasing SpinRite for a while, so I had no hesitation in grabbing a copy before driving over to get the PC.  Setting it off, I went to bed, hoping the testimonials I have heard were as trustworthy as the advice you give on Security Now!.  I awoke this morning to find SpinRite had finished its business, restarted the PC, and it booted first time.  One hour later, all documents were backed up, and I am seriously in my parents� good books,� as he puts it.



LEO:  If God or Steve Gibson gives you a second chance, take�it.



STEVE:  So he said, �I�m seriously in my parents� good books.  Perfect timing, as I have a house move coming up, and my wife and I need some extra babysitting for my�daughter.�



LEO:  Now there�s a testimonial.



STEVE:  And he said, �Many thanks for the great product and for all the work you put into Security Now!.�



LEO:  That�s the headline.



STEVE:  Signed Duncan Smith.



LEO:  �SpinRite Gives You Babysitting Time.�  That�s the headline.  I like it.  I like it.  That�s hysterical.  You know, it reminded me with a chill kind of what happened to my wife on her master�s thesis.  She didn�t have Security Now!.  It was lost...



STEVE:  She didn�t have SpinRite.



LEO:  I mean SpinRite.  She didn�t have Security Now! either; but she didn�t have SpinRite, which is more to the point.  It was lost, and she actually had to take that whole year over again.  So it can go really badly.



STEVE:  Oh, no kidding?



LEO:  Yeah.



STEVE:  Wow.



LEO:  Yeah.  She got an incomplete for that and had to do it all over again.  Ooh, I know, it sends a chill just thinking about it.  She did it.  She got her degree, and she got her license.  But boy, I mean, that�s � talk about dedication after that.  Which is maybe why she never uses computers now, come to think of it.



STEVE:  Exactly.  Exactly.  Well, and it takes one event like that, and then you...



LEO:  Then you back up.



STEVE:  You realize, okay, I really have to do backups,�yeah.



LEO:  Yeah.  All right.  Let�s talk about...



STEVE:  You wanted to talk about eBooks a little bit; right?



LEO:  Well, you know, it�s funny, we�ve become the eBook guys, haven�t we.



STEVE:  I�ve been an eBook guy for a long time.



LEO:  And I could never go with it because you were reading them on these little tiny Palms.



STEVE:  Right.



LEO:  So you and I both bought a Sony eReader, and we�ve been spending a lot of time talking about it.  Don�t worry, folks, we�re going to get right to WEP in a second.  But we�ve been getting a lot of great email from people suggesting other places to get free eBooks, websites and so forth.  There really is, even for the Sony, there�s a lot of choices out there.  So I�m very pleased.



STEVE:  Yeah.  And I did want to mention your reaction so far to �Gibraltar Earth.�



LEO:  Oh, I love it.  You know, I�m always a little nervous when I read stuff that hasn�t gone through a regular publisher and isn�t on the bookstands and stuff.  And I don�t know why.  I shouldn�t be.  This is great.  This is great.  And Michael McCollum deserves all praise.  I can�t wait to read � I bought the Antares Trilogy and the second, �Gibraltar Sun.�  Got halfway through �Gibraltar Earth,� it�s fascinating.  I can see where it�s going, too.  It�s�exciting.



STEVE:  Well, and �Sun� is, yes, �Sun� is the second in that�trilogy.



LEO:  Oh, it�s a trilogy.  Oh, good.



STEVE:  Actually, yes.  I finished book two, and I wrote to Michael.  And I said, you know, you have built such a cool universe, please don�t be in a hurry to finish it.  I mean, I�d like him to have two more books.  But he�s like, uh, I don�t know if I�ve got two more books...



LEO:  That�s kind of how I felt about �Fallen Dragon� was don�t, you know, gosh, you�ve created something here.  And we all want to go back there, so don�t stop.



STEVE:  And all I can say, Leo, is you have so much good reading ahead of you.



LEO:  Oh, good.  And, you know, this is now � so I�ve read over a thousand pages on the Sony eBook Reader, and I�m very comfortable with it now.  One thing, though, I�ve only had � it�s only gone down through the charges twice, which is more, you know, faster than it said it would, I have to say.



STEVE:  Have you listened to any music?



LEO:  No, it�s just reading.  And it�s not charging.  I�m thinking maybe the first time it didn�t fully charge because it�s � I don�t know if there�s something wrong with my charger, but it doesn�t seem to be � I�m going to leave it overnight tonight and see what happens.  But it doesn�t seem to be charging up.  Have you had trouble with the charger?



STEVE:  Yes, I...



LEO:  The red light�s coming on.



STEVE:  Yes, I�ve had the same experience.  Again, this is, you know, first generation.  And this is unusual for Sony to have a problem like this.  But what I noticed is I�ll plug the book into its charger, red light comes on, red light goes off.



LEO:  Yes.



STEVE:  It�s still not charged.



LEO:  Right, that�s what happened.



STEVE:  And if you just do it again, it, like, kicks it a little bit more.



LEO:  Okay, all right.  It�s good to know, yeah.  Although I�ve been reading with one bar for, like, five days now.  I mean, you know.  So maybe that�s why I had to charge it again is that I didn�t really fully charge it the second time around.  That�s probably what happened.



STEVE:  I think you probably � yes, exactly, is it probably didn�t work.  Now, it happens from an electrochemical standpoint that lithium ion batteries are a little tricky to charge because the charge stop point is set by the terminal voltage on the battery.  And that can be tricky to get right.  That is, it�s possible for it to, like, get a little false trip now...



LEO:  That�s probably what�s happening, huh.



STEVE:  Yeah.  Obviously this is a problem everybody else has solved.  And who knows, maybe it�s because it�s got Linux in there, and it�s missed an interrupt or something.  But it�s certainly the case that if you try a couple times, you�ll end up getting a charge.



LEO:  Okay, yeah.  I have to say the ability to carry it with me everywhere at such a small package and have so many books in there is really, really great.



STEVE:  Yeah, I love it.



LEO:  And thanks to Michael McCollum for going to the extra effort to make it work on the Sony Reader.  Thank you, Michael.  I appreciate it.  It�s really great.  Highly recommended.  Scifi-az.com.



STEVE:  And for what it�s worth I�ve had other feedback from people who are similarly loving his books.



LEO:  Is he published?  Does he have other novels that are�published?  Are these published?  Or is he all selfpublished?



STEVE:  Well, he�s got a publisher.  For a long time he was  using a regular publishing channel.  But he ended up getting the rights back, I don�t know if they expired or whatever.  But he literally now, I mean, you can buy his books in paperback.  And he�s got a complete printing system, a whole binding system.  So the books that you buy from him, he has printed.  And I think, as far as I know, they are professionally, you know, put together.  So it�s cool because he�s getting a hundred percent of the revenue from that, less the direct cost of printing books, which, you�know...



LEO:  Right.  And even more from the eBooks.



STEVE:  Exactly.



LEO:  And he deserves it.  They�re really good books.



STEVE:  I can�t wait for the third, or fourth, maybe, in the Gibraltar series.  And I can�t tell you, Leo, I mean, the Antares stuff is even better, I think.



LEO:  Oh, really.  Oh, I can�t wait.  I think the other � we�ll say one more thing, and then, honest, we�re going to talk about security.  What�s exciting about this is these readers make it possible for anybody to be an author because the cost of publishing is so low.  And if, as these readers proliferate, as I hope they will, you�ll have a large universe of readers for virtually no cost, the cost of bandwidth alone.



STEVE:  Exactly.  And of course the Internet is the other enabling factor.  It�s going to be cool.



LEO:  It�s exciting.  I love these times, I must say.  Now, the Internet is also a scary, dark, forbidding place, with evil men desperate to get into your system.  No, not really.  But anyway, sometimes it helps to think of it that way in terms of security, and that�s what�s going on with WEP right now.  Fill us in on this here.



STEVE:  Well, we haven�t talked about WEP for a long time.  Back on Episode 11, which was, what, 78 episodes ago, back in October of �05 was our coverage of � the actual title was �Bad WiFi Security.�  And that was really the last time, although we�ve mentioned it in passing many times since, but it was the last time we really gave strong coverage to the problems with the original encryption for WiFi, which was called WEP, which is an acronym, WEP, which stands for Wired Equivalent Privacy.  And the goal of WEP was, and the reason they named it Wired Equivalent Privacy, was they wanted to create a level of privacy for radio WiFi that they felt was as strong as if the communication was wired, as if it was wired equivalent.



Well, they really fell far short of that.  And a couple weeks ago a new group, three German guys at a technical university in Germany, published a paper where they demonstrated how they had figured out that they could crack WEP, that is to say, determine the encryption key being used in under a minute.



LEO:  Whoa, that�s not good.  How long did it take before?



STEVE:  Well, it took much longer.  In fact, it took on the order of five million packets captured...



LEO:  That was the key, you had to have a certain amount of data before you could crack it.



STEVE:  Exactly.  These guys have brought that down to about 40,000 packets from five million.



LEO:  Two orders of magnitude, that�s quite a bit faster.



STEVE:  It�s a huge gain.  So, now, this is still significant.  You know, people might be saying, uh, yeah, but, you know, we all have WPA now so who cares.  Well, the fact is that the demographics show that no encryption is being used on 25 percent of wireless networks; WEP is still in use in half of wireless networks; and the good, virtually uncrackable WPA encryption is only in use in about a quarter of wireless networks.  Which is to say that the fact is, 75�percent of wireless networks today either have no encryption or WEP encryption.  And only 25 percent are essentially uncrackable.  And as we�ve said many times, those WPA networks, that is to say, WiFi Protected Access networks, they are only as good as the quality of the password because their weakness is brute-force cracking of the password.  WEP�s weakness is far more extreme.  So to paint the picture, what this means, for example, is if you were using a hotspot where you were using WEP encryption, as many do because it�s � because it was the original encryption built into WiFi, you always have WEP.



LEO:  It�s kind of the default, the fallback, the last�resort.



STEVE:  Exactly.  And in many cases, it�s what is, like, first on the menu.  It�s the one that the system will choose for you.  I mean, and a perfect example of this, Leo, is back when we were originally telling people, please please please do not use WEP, use WPA, we got a lot of email from people saying, I would love to use WPA, but my, you know, my wazzagazza doesn�t support it.  Or, you know, my TiVo won�t support it, or my this or that.  I mean, there were, like, all these problems with people trying to use WPA.  I mean, there are even people who have now dual WiFi, one with WPA and one with WEP, where like they use WEP with their TiVo because they really don�t need encryption, but they�d like to keep their neighbors from using their WiFi, and so you could argue that WEP � well, actually, until a couple weeks ago, WEP was probably good enough for keeping your neighbors off of your network.  Now it really isn�t any longer.



LEO:  Well, is this fairly easy to do?  I mean, is it just a�program you download off the Internet and it does it, or do you...



STEVE:  Yes.



LEO:  Oh, boy.



STEVE:  Proof-of-concept code is now posted on the Internet.



LEO:  Which means it�ll be in Cain & Abel or one of these tools any minute now.



STEVE:  Yes.  Well, it is in the Aircrack suite, which...



LEO:  Oh, okay.  Well, that was fast.



STEVE:  Exactly, it took no time.  And the reason this is significant is it�s one thing to say, yes, I can get into WEP with five million packets.  Well, five million packets, that�s a lot of packets.



LEO:  You have to sit out on the curb a long time, and you�ll be noticed.



STEVE:  You need to bring your sleeping bag if you�re going to do that.  Here it�s 40,000.



LEO:  It�s a thousand times faster.  I mean...



STEVE:  No, 40,000 packets you could say, okay, well, that�s still a lot of traffic.  Well, let�s walk through how this is done because what I love about this and about talking about this specifically is that it brings out many of the foundations we�ve laid before about the way crypto stuff works.  In the first case you need lots of packets.  And you need not only lots of packets, but you need packets that you know something about.  Well, the way that Ethernet is glued together is with what�s called ARP, the Address Resolution Protocol.  And what ARP does � and we�ve discussed this in the past, so if anyone wants to go back and listen to an episode all about ARP, in fact where we talked about how ARP can be abused in order to create man-in-the-middle attacks � it�s one of the reasons, for example, in a hotel setting you do not just want to plug yourself into the hotel network because it�s trivial for someone to intercept your traffic due to ARP spoofing.



Anyway, the way ARP functions is anybody on the Ethernet sends out a broadcast to the entire network saying I need the MAC address associated with this IP.  What ARP does, and the reason it�s called Address Resolution Protocol, it resolves the relationship between IP addresses and MAC addresses on an Ethernet LAN.  All Ethernet LAN endpoints, that is, all NICs, Network Interface Cards, they actually are addressable by their MAC address because the IP protocol is just one of many protocols that they could support.  You could be Token Ring, you could be any of a number, for example, IPX, SPX, the old Novell protocol, all these things run on Ethernet.  So the IP protocol needs a way to figure out which adapter card on the Ethernet we want to send our data to.



So a station, whether you�re wired or wireless, will broadcast to everybody, who�s the MAC address for this IP, for example, the gateway IP, in order to send the traffic to the gateway in order for it to get routed out of the LAN onto the Internet.  Everybody receives this request.  And the one proper, presuming there�s no ARP spoofing going on, the one proper adapter that has that IP responds, saying I�m�the guy with this MAC address.  Okay.  So all you have to do�in order to generate a lot of packets is broadcast this request all the time, and you�ll get a whole bunch of�responses.



LEO:  Ah.  So you can stimulate it, in effect.



STEVE:  Exactly.  You can tickle the network in order to cause it to � just like, you know, flood it with this data.  Now, what�s very cool about ARP � well, cool except that this is huge leverage for the attackers � is that the first 12 bytes is never � it never changes.  The first 12 bytes of an ARP request happen to be AAAA, 03, then 000, then a 08 and 06, a 0, 01, 08, 00, 06, 04, 0001.  Those are the first 12 bytes of an ARP request.  The ARP reply has exactly the same bytes except the very last byte is a 02, which actually is the flag saying I�m a request or I�m a reply.



So now what we�ve got is we are able to watch ARP traffic on the network.  And in fact, one of the many things broken about WEP is that there�s no what�s called replay attack � I was blanking there for a second.  There�s no replay prohibition, meaning that you can � we�re just listening to the network.  Now, we can�t inject a packet because we don�t know the encryption key.  So what we�re able to do is we�re able to see packets that other people are generating, and they will occasionally generate ARP packets because this is something that � essentially ARP times out, and then you need to renew your knowledge.  So when we see an ARP packet, we can capture it and then send as many more of that packet as we want in order to generate responses.  So we�re using the same packet we saw once, and WEP doesn�t prevent you from doing what�s called a �replay attack,� which is to say replaying the same packet over and over and having it validated.  WPA, the good encryption, never allows the reuse of an entire packet.  So it has replay prevention, attack prevention; WEP does not.  So we capture an ARP packet, and we�re able to identify it by length and send it back into the network in order to generate lots of traffic.



Okay.  So now we have a whole bunch of these packets.  Well, if we remember the way WPA works � I�m sorry, not WPA, that�s the good encryption.  WEP, the bad encryption, WEP, the way it works is it uses a pseudorandom number generator, an encryption system, a pseudorandom stream generator called RC4.  RC4 is initialized with an encryption key.  Typically it�s either 64 bits or 128.  128 is the large size key, obviously, and provides substantially more protection than the 64-bit key.  So 128 is what this attack is cracking, and certainly that�s what anybody who didn�t have some real reason to have weak security, you know, if you�re using WEP at all, you would certainly expect it to be cranked up all the way.



So this 128-bit key is broken into two pieces.  There�s a 24-bit sort of front piece and a 104-bit back piece, so 24 plus 104 and you get 128, which is where the total key length comes from.  Well, this 24-bit front piece is called the �initialization vector,� or IV for short.  What happens is most adapters just use a counter to count this initialization vector upwards.  Thus you have a counter on the front of the other 104 bits that are not changing, giving you an always-changing 128-bit key.  Unfortunately, only the front of it changes, not the whole thing.



So what happens is, the way RC4 functions is this 128-bit key is used to generate a pseudorandom stream of bytes.  Those bytes are XORed with the data.  And we talked about XOR back when we were talking in detail about encryption and decryption.  The idea is, if you have a string of randomness, and you XOR your so-called plain text, or unencrypted data, with this randomness, what you get back out is random.  And if you are truly XORing with randomness, and this is what�s so cool about this, is there�s no way to decrypt that.  If you mix plain text with something truly random, what you get back is as random as the original random stuff, even though it�s been modified by the unencrypted data, by the plain text.  And what�s neat about XOR is that it�s easily reversible.  That is, you re-XOR the encrypted text with the same randomness, and what falls out is the so-called plain text, that is, it decrypts.



Well, that�s cool, except it�s a problem if you ever use the same random data twice.  That is, if what you�re XORing with is not totally random, not truly high-quality random data, then you�ve got problems.  And this is the main weakness with the Wired Equivalent Privacy approach.  Since we know the first 12 bytes of our ARP packets, all we have to do is XOR those first 12 bytes that we see in the air passing by on WiFi.  We XOR that encrypted data with what we know is the first 12 bytes of an ARP request or reply.  And what we get back is the first 12 bytes of pseudorandom data.



LEO:  Oops.



STEVE:  Yes.  Yes.  Yes.  And so as we get all these packets, we take the packet, XOR the first 12 bytes, and we capture the first 12 bytes of pseudorandom data for that corresponding key.  Now, in the front of the packet is this IV, the initialization vector, is the unencrypted 24 bits that is changing each time.  That has to be unencrypted and on the front of the packet because the receiver has to have that in order to add it to the secret 104 bits in order to make the 128-bit key in order to generate the same pseudorandom stream of data from the RC4 cipher in order to XOR the packet�s contents.



So we�re able to stimulate the network to flood us with ARP replies.  We capture the packets, XOR the first 12 bytes, and save the 24-bit IV and the first 12 bytes that we know is generated by the RC4 algorithm.  Now, all of that�s been done before.  The prior approach for cracking this, the thing that needed the five million packets, it was an approach where it required that many because it was error-prone.  It also required that you were only able to essentially crack the key from the first byte, then the second byte, then the third byte.  That is to say, in byte sequence.  And if you made any mistakes in guessing, because these are all sort of statistical processes, if you made a mistake in guessing, and you realized, wait a minute, this doesn�t seem to be working, you have to completely backtrack and essentially start over again.



What these guys did in the paper that they published a couple weeks ago was they used a different approach, sort of based on the first one, but using a different style of statistical checking which allows them to determine individual bytes of the key with no reliance upon previous bytes.  And that gives them this tremendous gain factor.  In cases where they�re not able to absolutely determine what a byte of the key is, they�re able to at least determine what it probably is.  That is, they may have, for example, five or 10 or even 20 bytes.  But that�s much better than 256 because of course there are 256 possible combinations of a single byte.  So in the worst case what they�ve done is they�ve hugely narrowed the number of possible bytes that an individual byte of the key might be, and RC4 is so fast that they can then test all the keys that are possible, even if they can�t determine exactly what the key is, in order to verify that they�ve got the right byte determined.



LEO:  So it�s a smaller set.  It�s doable.



STEVE:  Exactly.  It hugely reduces the set because, you know, if you had 256 times 256 times 256 times 256 for, like, for four bytes, that�s a huge number.  Well, it�s four billion, much bigger than 10 times 10 times 10 times 10, which is just 10,000.  So it turns out that the speed of RC4 that makes it possible to test guesses so quickly, leveraged with this algorithm that they�ve come up with that allows them to determine the individual, like the most probable byte, and then second and third and fourth and fifth and sixth probable bytes for each byte in the key, that gives them their leverage.  The result of this is that they are able to collect 40,000 packets by stimulating a typical WiFi network in about 53 seconds.  Then, in less than three seconds on a medium-speed ThinkPad � they used a 1.7 GHz Pentium M ThinkPad � in less than three seconds they can process the data they collected.  And so that brings them to about 56 seconds, and they have a 50 percent chance of having cracked the key in under a minute.  If they give themselves two minutes, then their probability increases to 98 percent.  So the reason this is significant is that this is going to change � this changes the calculus.  As we were saying before, needing five million packets means you have to have a motivation for cracking the network.



LEO:  Right.  Well, and I would tell people, use WPA; but, if you can�t, it�s okay to use WEP because it�s enough of a barrier to eliminate all but the most determined hacker.  Well, that�s no longer true.



STEVE:  Right.  In fact, it�s almost faster to do this than it is to enter the WEP key for a network that you know.  It�s like, oh, I�ll just turn on...



LEO:  If you can�t guess the WEP key, just crack it.  Can�t remember it.



STEVE:  You know, you type it in wrong.  It�s like this is faster than dealing with correcting a typo or, like, going into your router configuration or your computer.  It�s like, forget it, just crack it, it takes a minute now.



LEO:  I�m sure there are videos on the �Net already showing how to use Aircrack to crack WEP in less than a minute.



STEVE:  Well, and as you might imagine, this news got a lot of attention because, I mean, it really does change the calculus.  You could now just open your laptop, run your cracker, and you could imagine that within a month there will be turnkey tools.  It�s like, don�t even bother filling out the WEP form anymore, just crack the key because it only takes 60 seconds.



LEO:  Well, I would never do this, but I have to say it�s kind of tempting because many is the time I�ve had access points I could have used if I only knew the WEP key.  And, you know, I mean, if you can�t get online any other way, I�m sure there are people not as ethical as you and I who would do that.



STEVE:  Well, from time to time we�ve made Security Now! predictions, Leo.  And a Security Now! prediction would be that in short order we�re going to see some tools that are turnkey, easy for anyone to use.  And, I mean, it really does change the calculus.  So the takeaway message from this is that, if you�re using WiFi, and it�s not WPA encrypted, you either, A, don�t want to use that WiFi network; or you want to make sure that you�re providing your own encryption.  You�re using a VPN, or you�re using HTTPS so that essentially your traffic is running through an independent layer of encryption, a so-called, you know, we�ve talked about tunneling a lot.  So, for example, if you�re using Gmail, make sure you�re https://mail.google.com or Yahoo! or whatever.  You want to make sure that you�re providing your own encryption because you really, unless you�re using WPA, that is, unless the network that you�re hooked to is using WPA, WEP just no longer provides virtually any protection.



LEO:  In other words, treat a WEP access point as an open access point.



STEVE:  Yes.  There�s virtually no difference.



LEO:  All right, Steve Gibson.  You know, I�m really glad you covered this because it�s been all over the place.  And as always, I think it�s great to get the actual facts.  Also I should point out that people talk about WPA being cracked, and it�s not the same, is it.



STEVE:  No, no.  In fact, as we said before, WPA, the only known crack for it, because this was designed by real security guys � as we said back in Episode 11, the original encryption, WEP encryption, was designed by engineers.  And they had the best of intentions, but it�s just embarrassingly riddled with problems.  WPA was really designed by crypto people.  The one attack � and this is not WPA�s fault at all, there�s literally nothing you could do about it � the one attack is the so-called brute force attack, where you capture some packets on the network, and then you start using virtually every possible decryption key.  Of course you don�t want to just start, unless you really have to, with A and then B and then C and then AA and BB and, I mean, you know, AB, AC, and so forth.  What you�ll do is you�ll use a dictionary attack, trying combinations of common words, hoping that the user did something like that.  So the only real way to hack into, as far as we know, WPA is by using a brute force attack.



So what you want is a really unguessable password for WPA, something unlikely to be, you know, in anyone�s dictionary, just all kinds of random stuff.  And of course that�s why I created the passwords page of GRC.  If you go to GRC.com/passwords, I give you, over a secured encrypted connection, a bunch of raw material.  You can use it as is; you can grab some, refresh the page a few times, and then cut and paste to put your own together if you�re not comfortable using one that actually came from our server.  And the technology that I developed for that guarantees we will never issue the same one twice.  So it�s impossible for anyone to get that.  In fact, I use one directly from that page.  And, you know, it�s in a little file on a USB dongle that I carry around whenever I want to put another system on my own network because, lord knows, I mean, this thing is just literally gibberish.  And I kind of recognize it visually now, but I don�t know what it is.



LEO:  If you don�t know what it is, I think it�s pretty hard to guess.  If you can�t remember it.  All right, Steve, we�re going to wrap it up.  We�ll be back next week with more security for you.  We encourage you to patronize our fine sponsors.  They keep this show afloat, and we thank them for supporting the show.  It�s really nice to get your emails, to get your donations, and to get the support of sponsors, too.  It really makes this all happen.  And we thank you all for being so great.  What a great audience we�ve built for this show.



And of course you can catch Steve every week on my radio show because he does a little mini Security Now! on the radio show.  So we�re trying to get the word out to an even larger audience.  And that�s on the Premiere Radio Networks on XM Satellite 152, Saturdays and Sundays.  You�re on at different times, so I don�t know what time to say.  I just rotate you around so everybody gets to hear.



STEVE:  Cool.



LEO:  Thanks, Steve.  We�ll talk again...



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#90

DATE:		May 3, 2007

TITLE:		Multifactor Authentication

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-090.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss the theory and practice of multifactor authentication which uses combinations of "something you know," "something you have," and "something you are" to provide stronger remote authentication than traditional, unreliable single-factor username and password�authentication.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting. This is Security Now! with Steve Gibson, Episode 90 for May�3, 2007:  Multifactor Authentication.



Here we are already at Episode 90.  At this rate, Steve, I think you�re going to catch up with TWiT any minute now.



STEVE GIBSON:  I look forward to that day, you know it.  One of my own personal benchmarks.



LEO:  I�m starting to get emails and stuff on our 100th episode of TWiT, you know, people want to give away stuff, and I�m getting gifts in the mail and stuff.  It�s kind of neat, I just hope we make it to #100 at this point.  It�s getting a little iffy.  There�s no question that in ten weeks we�ll be at #100 for Security Now!.  There�s just no doubt about it.



STEVE:  Well, and I�ve got some plans for it.  I have a special plan for the 100th episode, something I think everyone�s going to get a big kick out of.  So, yeah.



LEO:  Well, the Daily Giz Wiz just did its 300th, and we gave away a bunch of stuff.



STEVE:  See, now, that�s cheating because you do one a day;�right?



LEO:  Yeah.  Well, and of course the first podcast I did was the radio show.  And that�s up to Episode 350.  But the Giz Wiz�ll catch up because we only do two a week of the radio show.  But I started � that was the very first podcast I did.  I think it was one of the very first podcasts of any kind.  And it was in September, I think, of 2004.  Is that right?  Yeah.  Anyway, enough reminiscing.  Time to talk about security.  And today we�re going to talk about something you call "multifactor authentication.�



STEVE:  Yeah.  It�s something we�ve never touched on before.  We certainly, of course, very early on this series we did some extensive coverage of what are good passwords and good password management habits and so forth.  But increasingly what we�re seeing is that what�s called "single-factor authentication,� which is just typically a username and password, is being regarded with increasing skepticism simply due to all the problems that we�ve talked about with passwords.  So multifactor authentication is like the new thing.  And I think it�ll be fun to talk about it with our�listeners.



LEO:  So any updates from the last couple of weeks, Steve?



STEVE:  Don�t have any errata.  Although I do have sort of a�fun...



LEO:  You�re perfect.  You�re perfect.



STEVE:  No, certainly not that.  But nothing has come to my attention.  But I do have sort of a fun, different sort of SpinRite anecdote to share, one that�s not about saving a PC.  I got a note from someone named Scott Freudenthal in Florida who�s a Security Now! listener.  And the subject of the note was "SpinRite saves more than just computers, thanks be to goodness,� as he put it.  He said, "Steve.  I�ve used SpinRite for saving multiple hard drives in the past.  I�ve always been impressed with the capabilities of the product.  I always knew that I could count on SpinRite to save the day.  I figured you had enough feedback on your basic day in, day out computer recoveries.�  No, that�s not true, everybody.  Send as many notes as you want.  I love getting them, love reading them.



LEO:  That�s his reward, yeah.



STEVE:  Yeah, exactly.  And he said, "So I have never sent you any feedback before.  However, I was gone on a vacation recently, and during my absence our TiVo died.  Now, we�re talking about a real serious situation.�



LEO:  Yeah.



STEVE:  Well, because you can imagine, he was counting on his TiVo to be sucking up all of the programs that he wasn�t able to watch while he was on vacation, planning...



LEO:  And you�ve never seen anything so scary as somebody going through "Grey�s Anatomy� withdrawal.  I mean, that�s just painful.  Painful.



STEVE:  So he says, "I tried tech support when I returned and realized the only solution they were offering was a new TiVo.  I vaguely remembered hearing on Security Now! that someone had used it to fix a TiVo drive.  So I gave it a shot.  Oh, happy day.  Our TiVo is back, and harmony has returned to our little family unit.  Thank you so much for  making such an exceptional product.  Keep up the good work and the great information provided on Security Now!.  Signed, Ann and Scott Freudenthal in Florida.�



LEO:  That�s neat.  So now we�ve heard of people using it on their iPod hard drive and their TiVo hard drive.



STEVE:  Yeah.  And I think I did once mention it sort of offhand about it being useful for TiVo.  It has saved Greg, my tech support guy Greg�s TiVo, a couple of my TiVos several times.  Because those things sit there, they tend to run hot, and they just go day in and day out.  And the TiVo actually is always running data through the hard drive, so the head is constantly moving back and forth between its recording area and its playback area, even if it�s doing nothing.  I mean, when you turn it on, you�ve got that 30minute buffer delay always sitting there.  So TiVo really does work these hard drives pretty hard.  And sometimes they just get more than they can handle.  So SpinRite is, of course, able to fix them.  And I wanted just to renew that fact as a consequence of Scott�s note.



LEO:  It doesn�t matter what operating system or what file system is being used on the hard drive?



[Talking simultaneously]



STEVE:  Well, SpinRite will, if it�s present.  But if it doesn�t have a partition table that it recognizes, it goes, okay, well, we�ll fix whatever�s here, even if we don�t know what it is.



LEO:  Ah, interesting.



STEVE:  And of course it�s interesting, too, because on the older Series 1 TiVos like mine, which I�ve stayed with because they�re much more hackable than the newest ones, that�s a PowerPC platform that has the bytes swapped in a different order than Intel.  So the data recorded on the drive isn�t even recognizable as a normal partition table, even though it has one.  SpinRite looks for the signature at the end of the partition table, doesn�t see the 55AA because on that system it�s AA55, and SpinRite goes, okay, well, we�ll just fix it even if we don�t know what this is.



LEO:  Interesting, yeah.  All right.  Let�s see.  No updates from last week, so let�s launch right into it.  This is something called multi...



STEVE:  Multifactor authentication.



LEO:  Okay.



STEVE:  Yeah, now, okay.  Let�s step back a little bit and talk about authentication sort of generically.  You know, back in the "olden days,� like Andy of Mayberry days, you know, Opie would go into the drugstore and...



LEO:  [Whistling theme to "The Andy Griffith Show�]



STEVE:  Exactly.  And the pharmacist knew him.  And so he�d say, oh, you�re here to pick up, you know, Grandma � well, I don�t remember what his grandmother�s name was, but...



LEO:  Aunt Bee.



STEVE:  Aunt Bee, exactly.  Thank you, Leo.



LEO:  Opie, go down to the drugstore and get my heart pills.



STEVE:  Exactly.  And so there was known person-to-person authentication that you could rely on.  And so people knew you, and just being known was real-world authentication.  Or, you know, a restaurant you went in all the time, say you forgot your wallet once, it�s like, oh my god, I don�t have my money with me.  Oh, that�s fine, Leo, we know you.  Come�back in an hour or pay for it next time, whatever.  So,�I mean, in the real physical world we always had�authentication.



Well, of course what�s happened with the Internet, and to an increasing degree, that kind of real-world authentication is gone.  But it�s still very important, and in fact you could argue increasingly important, due to the fact that applications of the Internet are expanding, really important for authentication to be present.  Now, we�ve talked about websites authenticating themselves using SSL and certificates, where a web server has a certificate signed by an authority where we trust the signing authority, VeriSign or Equifax or whomever.  And so we assume that that signing authority has done its due diligence to verify the identify of anyone it�s giving a certificate to.  So our web browser trusts that signing authority.  And when we get a certificate as we�re setting up an SSL, a secure connection to the web server, we get the certificate, we see that it was signed by someone we trust, and so that creates a chain of trust that says, okay, we�re going to trust the certificate owner because we trust the signer of that certificate.  Well, that�s authenticating from the remote end to us.



LEO:  Single-factor authentication, really.



STEVE:  Well, that�s actually, yes, that is a single factor.  And in typical ecommerce mode the need, when you�re wanting to authenticate yourself to someone else, is going in the other direction.  And the classic example is online banking, where you want to make sure you can get to your personalized online banking account page, but nobody else can.  And the bank would like to know that you are you.  So originally, of course, passwords is what was used because people were kind of � they understood passwords immediately.  You know, you have a username and password which you use to log on.  Now, as we�ve talked about in talking about passwords extensively, you know, they�re free, that is, they don�t cost anything, and they�re easy to use.  But at the same time they have the downside of you get what you pay for, that is, you know, you didn�t pay anything for them.



So you have the problem, as we�ve talked about, of user management, you know, if a password is easily guessable then that�s a problem.  If it�s really complex, then you�re in danger of not being able to remember it.  And so what many people do is they�ll write them down, and a written down password, of course, is a problem because then anyone else coming along can see it and find it.  So that�s bad.  And we�ve also talked about the use of many different passwords, not using the same password all the time, but having a bunch of them.  Well, having a bunch of them also puts a burden on the user of just having so many passwords.  The other problem with a password is it can be deliberately divulged, that is, you could say, oh, you know, if you want to read, you know, my New York Times online magazine subscription or online newspaper subscription, just log on using my password, my username and password.



LEO:  I�ve done that many times, yeah.



STEVE:  So it has both the problem of unintentionally being discovered and being deliberately divulged.  So essentially there�s this issue of accountability and plausible deniability.  You know, weak authentication means that users cannot be held accountable.  It�s like, you know, the dog ate my homework problem, meaning that, say that your boss comes to you and says, hey, you know, you logged onto the server and were doing some bad things.  But, you know, if all you�re using is a weakly authenticatable password, you could say, oh, somebody must have stolen it.  I didn�t do that.  So there isn�t strong accountability there because, again, they�re easy to use, but they have a problem.



So all of this discussion so far, the whole issue of passwords, is known in the security trade as "single-factor authentication,� that is, you�re only being asked to provide a single aspect for authentication.  Well, generalizing factors, it�s very cool, sort of the jargon that�s been developed, I get a kick out of this because passwords are something you know.  The next two types of factors are something you have, and something you are.



LEO:  Wait a minute.  Let me understand this.  A password is something you know.  Okay, that makes sense.  So that�s the first of a multifactor authentication scheme would be that.



STEVE:  Or I would say it�s the most common factor in a multifactor authentication scheme is something you know.



LEO:  Something you know.  The other would be something you have, like, say, a Smartcard.



STEVE:  Or some sort of a token.



LEO:  A token.  And then something...



STEVE:  Something you are, which is to say your fingerprint, or the pattern of blood vessels in the iris of your right eye or something.



LEO:  Or Opie�s face when he walked into the pharmacy.



STEVE:  For facial recognition.



LEO:  Right.  He didn�t need a password, and he didn�t need a token.  He had his face, so that was the single factor�there.



STEVE:  Exactly, because of who he was, and that was uniquely recognizable.  In fact, now, that�s the key, is what we�re really talking about here.  And actually I haven�t seen this anywhere in the literature, maybe because it�s too obvious.  But again, by making these obvious things clear, we end up with, I think, a deeper understanding.  What we�re really talking about is something only you know, something only you have, or something only you are.  Because of course the problem with a password is maybe somebody else could know it.



LEO:  Or if Opie were a twin it wouldn�t only be him that looked like him.



STEVE:  Very good point.



LEO:  Okay, I get it.



STEVE:  So things you know, something you know, as we�ve talked about, could be a password or a pin, like you use when you�re using an ATM card.  And in fact, an ATM card and the experience of authenticating yourself to an ATM machine is probably the most common and a perfect example of two-factor authentication because the something you know is the PIN number, and the something you have is the ATM card.



LEO:  Got it.



STEVE:  And that�s arguably much stronger than just a password.  On the other hand, it, too, could be defeated.  That is, you know, Mom could give her ATM card and PIN to one of her kids and say, you know, go down and withdraw $100.  So the fact that the card is loanable represents some insecurity.  That is, although the responsibility certainly falls on the card owner to manage that card correctly.  So it�s stronger than a password.  But you could argue that the ATM machine is assuming that the actual owner of the card is the person who is present, when in fact that�s not the case because there�s no use of that third factor, which is something only you are.



LEO:  Right, right, got it.  So the more factors the better.



STEVE:  Well, yes.  Except that � well, yes.  In general, it�s certainly the case that the more factors the better.  The one downside of that is the more factors you have, the  more tendency there is to trust the authentication.  And what can often happen is that organizations or IT structures will put more trust in than they should because they get all worked up over how secure their solution is, and then if something comes along to break that authentication you can end up with much greater exposure and vulnerability as a�consequence.



Now, of course, so we have the something you know is some information.  Now, remember that there�s also other classes of that.  For example, there�s the normal password and pin.  Then there�s like, you know, instances where you�ll be asked for your mother�s maiden name or the name of your elementary school or some, like, second-tier information if you�re needing to further authenticate yourself for whatever reason.  And of course, again, the problem with that is anything like that is easily sharable.



Now, we talked about the ATM card as something you have.  Of course, what�s becoming now popular are various sorts of dongles or tokens.  RSA has something they call "SecurID� which is a little battery-powered LCD display with a six-digit number on it which changes once every minute.  And so the idea is � and it�s a clever solution, of course they�ve locked it up in patents every which way, the idea being this is a hardware token which you can stick on your keychain, and every minute the number changes.  So if you need to log into any facility on the Internet which uses RSA�s SecurID system, you will be asked for the current six-digit number appearing on this little token, which you just type in.  And what�s cool about is that it�s obviously got a clock inside.  Every minute it�s changing this.



Well, we understand enough of crypto now that all that�s required is for a number of seconds since whenever, since the year 2000, for example.  The linear number of seconds is run through symmetric encryption with an individual key which turns that counter from just a monotonically increasing value into what looks like a completely random number.  And in fact there�s no way, without knowing what the symmetric key is, to guess, given any one number, what the next one will be.  And an extension of that is there�s no way to know at any point in time what number will be showing on that LCD.  And the only people who know is the RSA server because there�ll be some serial number on the key which is in no way related to the symmetric key being used to encrypt this monotonically increasing value.  But what happens is, when you type it in, the server you�re trying to authenticate to, like � I can�t use Bank of America because they�re not using this system.  They have something else which actually...



LEO:  SiteKey, which I hate.



STEVE:  And we�ll talk � and it�s bad, Leo.



LEO:  I know.



STEVE:  It turns out it�s already been hacked and broken.  And they�re all jumping around, talking about it as a powerful two-factor authentication, and it�s not.  But imagine some working system that has contracted with RSA to provide authentication services.  So you enter this token into their server.  Their server asks RSA � so you identify yourself by username and enter the current value on the token.  RSA looks you up by the serial number on your token, which has been established ahead of time.  They look up the matching secure symmetric key that is inside your token and unreadable using any practical technology, but they know what it is because they established that once.  They look that up.  They unencrypt, that is, they decrypt the six-digit number, which is just a number of seconds since some period in time.  They decrypt that back to the counter value and verify that it�s within a minute or two of the current�time.



LEO:  So that�s why it�s no good after that minute.



STEVE:  Well, exactly.  So, however, they want to have some fudge window because the minute counter could click over, for example, your little battery-powered clock in the token could be running a little fast.  And so what�s very cool, though, is every time you use it, it resynchronizes with RSA a fudge factor.  So, for example, RSA can see from the token you give it, it�ll look at the minute before, maybe as many minutes before or after as necessary to find the value that you�ve entered.  And then RSA can decide if that�s close enough to the current time.  And when they make that decision, they store a fudge factor so that next time they know, oh, this guy�s dongle is running three minutes ahead.  But as long as you use it every, like, three or four times a year, your clock in your little dongle isn�t going to drift that far off from the last time you used it.  So the RSA knowledge of where your little counter is stays synchronized.  So it�s a neat solution.



LEO:  This is supposed to be the, I mean, for a single-factor security solution, this is really supposed to be it.



STEVE:  Well, it�s a good solution.  And in fact they�ve got it patented.  They�ve also implemented the same thing, and you can imagine how, in a software-only version.  They�ve just recently released it for the Java ME, the Micro Edition platform, that�ll run on any small phone.  It runs on Windows Mobile, Pocket PC, Symbian, the Palm Treo, the Blackberry.  So you are able to use a regular PC-based or Smartphone and have the SecurID technology in there also because of course all of those things have a clock, and all you need is a clock and a counter and crypto.



Now, you could argue, and I would, that that�s not as secure as using a specific custom token because anything that�s basically in software is certainly hackable.  On the other hand, it costs much less to download a piece of software than it does to make and carry this dongle.  And people typically have their phones or their Treos or their Blackberries or whatever with them.  So it�s a good solution.  By the end of this podcast we will explain why it�s no good.  I mean, why it�s good, but it�s not perfect.



LEO:  It�s not perfect, okay.



STEVE:  It�s not perfect because it is susceptible to man-in-the-middle attacks, and many of these things are.



LEO:  Right.  But that�s why multifactor becomes so�critical.



STEVE:  Exactly, because you want as many as you can.  Now, one of the other really interesting solutions which people have come up with is the actual use of a mobile phone, that is, not like I was just saying, using RSA security, but imagine that what it is that � you remember, one is what you know and one is what you have.  Well, many people, if not most people these days, have a cell phone.  So the fact that they�re in possession of the cell phone is a strong aspect of authentication.



LEO:  Ah, of course.



STEVE:  We�re not going to overstate it.



LEO:  It�s not perfect.



STEVE:  Exactly.  But it�s better than nothing, and it�s probably free.  So imagine a service where you log in, and they send your phone, that is, the phone associated with your account, a short SMS message with a password, a series of digits which you have to type into the web browser as you�re logging in.  The only way you could know it is if you are in possession of the phone, and you look up the message you just received and key the number in.



And the real beauty of this approach is it�s an out-of-band communication.  That is to say, and we�ve talked before about in-band and out-of-band, the idea being that anything in-band is the main dialogue that we�re having, for example, over a secure connection with a server that we�re logging into, but doing something out of band is really nice.  It�d be like someone phoning you at the phone near you and saying, Hi there, John, you need to enter this number into the web browser in order to authenticate yourself.  That�s an out-of-band communication.  But using an SMS message on a cell phone is very easily automatable and provides the information out-of-band only to the person�s phone that�s associated with the account.  So there�s another sort of clean, clever approach for this kind of something you have�authentication.



One other approach that I�ve seen is the use of a code sheet.  That is, there�s one company, and I can�t think of their name, and again they�ve got patents protecting this, is when you sign up for this form of two-factor authentication, you print out a web page containing a little four-by-four, four-inch by four-inch piece of paper which is a chart of symbols and letters.  And so the idea is, again, that�s something you have that you can easily fold in half and stick in your wallet.  And when it�s time to authenticate yourself, their website will show you a series of icons, and you look them up on your chart and type in the corresponding letter.



LEO:  That�s cool.



STEVE:  It�s very clever.



LEO:  And simple.



STEVE:  And simple.  And it�s a one-time � basically it�s like a one-time little crypto sheet.  It costs nothing because everyone who can bring up a web page and print it is able to do that.  So you don�t need a hardware token.  But it�s a form of hardware token because every single one that�s issued is different so no two people have the same two sheets.  The issuing server remembers which sheet each person received.  And then the web server is able to issue a one-time pattern of icons, that is, it will never issue those again.  And so these things are trying to solve the problem of anyone collecting keystrokes.  Because if you had a keystroke logger on your system that saw you entering this password, well, that password that you are giving back to the server in a classic challenge-response fashion, you�ve been challenged by being presented this series of icons.  You look up on your unique sheet the corresponding letters and type that in.  You will never receive the same series of icons again, never type in the same password again.  So no one logging your whole log-on handshake protocol is ever able to reuse it.



LEO:  And that�s kind of the key to a lot of these systems is these one-time passwords, or one-time authentication.



STEVE:  Yes.  And of course that is the whole RSA SecurID�deal.



LEO:  Right, it�s not good again.



STEVE:  Since it�s changing every minute, it�s not good again.  It�s funny, because as I was thinking about this and doing some research, I was thinking, okay, well, what if you did a typo, and you had to enter it again?  Well, that�s okay.  First of all, in a minute, or actually in an average of 30 seconds, you�re going to get another one, and that will be okay.  But if it�s a typo, it�s wrong anyway.  So if you correct it, then the server goes, oh, you got it right.  And in the process of getting it right, it will no longer ever accept that again.  So it�s very cool.



So some of these things involve hardware.  There�s even another company that has something called the iButton.  Dallas Semiconductor produced something called an iButton which looks exactly like one of the little tiny hearing aid batteries that we�re all familiar with because our calculators use them, or obviously people with hearing aids use them, the little round cell which is very small and has a sort of an inner circle contact on the other side.  Well, Dallas Semiconductor realized, hey, we�re able to provide power and data over two wires.  So they build crypto chips into something that looks exactly like a hearing aid battery and then mount them on a little paddle that you can hook onto your key ring.  It doesn�t have a battery in it, but when you press it against their little socket...



LEO:  It charges it.



STEVE:  Well, it powers it up, and then it�s able to do a little security protocol to say, give me your ID number, give me our serial number.  So it is, it�s very...



LEO:  That�s a very clever technique, yeah.



STEVE:  Yeah.  And super small, lightweight, easy to have on your key ring, and it provides � again, it�s something you have that nobody else has.



LEO:  But there�s problems with all of these.  Something you physically have can easily be lost.



STEVE:  Yes, exactly.  Or loaned.  It can be loaned.



LEO:  Yes, exactly.



STEVE:  So you tell your child, only withdraw $100.  Well, or 20 or whatever to go to the movies.  And certainly obviously there is accountability when the bill comes at the end of the month.  But still, you�ve given up control.  So the next factor in this hierarchy of authentication is something you are.  Which is to say, some measurable physical characteristic.  Fingerprints, of course, are very popular and have long been used.  Speech patterns are also being used.  You�ve probably also seen, Leo, over the years there was an attempt to use the typing rhythm.



LEO:  Right.  That keeps coming back.  People keep talking about that.



STEVE:  Yeah.  It�s interesting because no two people type with the same kind of rhythm.  Many people don�t type with any rhythm at all.  And of course now that requires something active on the computer that is down at a level where the rhythm of your typing can be received, for example, that would not work through a web form because you type offline, essentially, and press the button to submit.  And then of course the more high-tech retinal scan or some other biometric.



In fact, just yesterday I wanted to grab something from my server cabinet at Level 3.  And so I went there.  They use, interestingly enough, they use the second two approaches and not the first.  That is, something I have and something I am.  I have a badge from them.  And so I wave the badge near a reader which tells them whose badge this is.  But it doesn�t tell them that it�s me, of course.



LEO:  Who you are, right, yeah.



STEVE:  Exactly, because I could have given it to someone else.  But then the next thing I have to do is stick my hand in this, it�s sort of a plate with some poles sticking up, little one-inch-high posts.  So I put my hand all the way up into this so that the posts rest in between each of my fingers.  And this thing measures the physical characteristics of my hand.



LEO:  So it�s not exactly a scanner; or is it?



STEVE:  Well, no.  And this is what�s interesting and is significant is that certainly there are probably people around, I�m sure there are, walking around who have a hand measurement that is indistinguishable from mine.



LEO:  Ah, but they don�t have the card.



STEVE:  Exactly.  They don�t have the card.



LEO:  Or the likelihood of them having a card is highly�unlikely.



STEVE:  Exactly.  And the likelihood of someone stealing my card who has the exact same hand size that I have is low enough to make this much more secure than just using a card.  And certainly just using my hand measurements is really not security at all.  So the point I want to make about this, because it�s clever the way it interacts, and it relates to fingerprints in an important way that we�ll talk about in a second, is that just using a hand size really isn�t enough to identify me uniquely in the world.  So I wouldn�t want to use that.  But using my card first tells the system, okay, now check the one hand size we have on record.  Or maybe one or two, whatever, depending upon how many people are going to use this card.  In fact, with this system that Level 3 uses, it�s a one-for-one association.  If I had Sue or Greg needing access to the Level 3 facility, they would have their own card and their own hand measured for that card.  So there�s a one-to-one mapping.



But the point is, this thing never says, oh, look, this looks like Steve�s hand, let�s unlock the door.  No.  Instead, it�s, oh, we�ve just sniffed Steve�s card, and we know what Steve�s hand size is, so let�s see if the hand that�s about to be put on the scanner qualifies as being Steve�s.  So it�s a really nice system that � and nothing to remember.  Notice that I�m not putting in a PIN or a password in this system.  However, I noticed that on the scanner there is a keypad.  So probably, if Level 3 were�even...



LEO:  Third-level authentication, third...



STEVE:  Yes.  All of the technology is there for me to have to enter a PIN and a card and my hand.  And I guess they�re  thinking, okay, let�s, you know...



LEO:  Enough is enough.



STEVE:  The hard two out of the two out of three is good�enough.



LEO:  Right.  Fascinating.  And I think a lot of network operations centers use something like that.  That seems to be very common.



STEVE:  Yeah.  And in fact, as I was thinking about talking�about this today, I realized that even if someone got my card who had my hand � and I don�t mean that literally because of course we�ve all seen the spy movies where guys...



LEO:  Cut your hand off, right.



STEVE:  Exactly, cut my hand off and take it to Level�3�or...



LEO:  Would that work?



STEVE:  Yeah, I think it would.  I don�t think it has to be a living hand. 



LEO:  They�re not measuring the heat of the hand, okay.



STEVE:  I don�t think so.  And of course all of the spy movies we�ve also seen where you get your finger chopped off, and then they carry the finger and stick it up on the fingerprint scanner.  Or on "Mission Impossible,� you know, they�re always peeling...



LEO:  Plastic, rubber...



STEVE:  ...fake fingerprint, you know, impressions off of you.  So fingerprints are interesting because they�re sort of like hand size.  That is to say, yes, you could argue that certainly a whole set of fingerprints, a whole hand, provide enough unique identification to be strong.  On the other hand, given the opportunity to get DNA, which is absolutely unique, that�s what forensic researchers and scientists and, you know, forensic criminologists use rather than fingerprints.  And in fact, a fingerprint is vague enough and also susceptible enough to damage from, you know, an Xacto knife, and fingerprint databases tend to be huge, that they don�t really work the way they show them on CSI, where it�s like, oh, scanning and all these fingerprints and people�s faces are flashing by.  Because, I mean, those databases are way too huge.



The way fingerprint scanners work is that a number of characteristics of all fingerprints are found.  There are swirls, there are breaks, there are places where, like, four ridges fade out or, like, merge into two, sort of like a Y intersection in the road.  Well, those things are easily spotted by software, and they create position-dependent marks.  That�s then used to make a robust index.  And that index is used to index this criminal fingerprint database in order to then sort of go to a successive level of refinement and decide if that�s who you are.  In the case of fingerprint scanners which are now appearing on PCs, they operate much more like the Level 3 analogy, where you have very few people who are logged in to this fingerprint scanner, you know, yourself, maybe a spouse or your kids or something.  I was going to say your dog, but not in this case because it�s not paw print scanner.



And so as you drag your fingerprint, or your finger, across this, one or maybe multiple times, it builds up an image.  And then all it has to do is it says, okay, all I need to verify is that within sufficient level of certainly I recognize this fingerprint from among one or two or three.  And again, the likelihood of some random thief having a fingerprint sufficiently close to yours is just diminishingly small.  And since you are able to train this multiple times, and you are using it continually, it�s able to adapt over time to slow changes that may evolve in your fingerprint, like, you know, a little cut appears somewhere.  It�s like, okay, we�ll forgive that because all the rest of the finger looks good.  So again, you�re only really doing a comparison against a very small database of potential matches.  So you can afford to do a very good job of that.



And the other cool thing about the newest scanners, you know, the original scanner was sort of a plate you put your thumb or your first, your forefinger on or something, and it would take a picture of the whole thing.  There has been lots of work on how easily that is forged, just by using some rubber cement.  It turns out you can very easily fool these because they�re not checking for the likeness of the fingerprint.  And so those things like the "Mission Impossible,� you know, rubber finger really do work on those.  But the newer scanners, which are even less expensive and so are becoming predominant, are more like a line scanner, where you have to actively draw your finger across that.  Well, that�s superior because it�s a dynamic process.  It�s much less easy to make a rubber finger that is going to fool that than it is if you just had a Xerox copy of your fingerprint and just stuck it down on the�window.



But it turns out that all of these things, while they are better, there are attacks that are workable attacks against these kinds of things.  Now, it�s interesting, you mentioned BofA and SiteKey.  And it�s certainly gotten a lot of press because it�s a very sort of, oh, touchy-feely sort of solution.  The idea with BofA�s SiteKey is you give it your username first.  It looks up your username and says, ah, Leo has registered a picture of his trash can with us.  And so it sends back...



LEO:  And but you give it a phrase, too, that goes with it.



STEVE:  Yes, exactly.  A phrase and a picture.  It sends those back to you.  Now, what that�s supposed to do is give them phishing protection, that is, it�s supposed to verify that you�re really talking to BofA because they know they have a picture of your trash can that you provided them when you set this up, and no phishing site would be able to do that.  And so the idea is that it�s like, oh, good, now I know I�m talking to BofA.  And then they prompt you for your�password.



Now, the problem is that they need this to be robust in the event that you want to sign on at the library � god help you, you don�t want to sign on at the library.  We�ve certainly covered that enough.  But the point is, what happens if your IP changes?  What happens if you�re at a neighbor�s who you trust, or you use a laptop, and your�IP...



LEO:  Well, that�s what happens because I sign on on three or four different IP addresses, or I�m in a hotel, and I�m signing onto my bank.



STEVE:  Okay.  You don�t want to admit that here on Security Now!, Leo.



LEO:  Well, now, wait a minute.  It�s an SSL connection, so I�m okay even doing it at the hotel; right?



STEVE:  Well, yes.  Although...



LEO:  It�s my laptop.  I�m not using their computer.



STEVE:  It�s your laptop.  And we know that you would be careful.  But the way phishing sites still crack this, well, okay, wait.  First, there�s a non-phishing approach, or, that is, a simple way of breaking this.  MIT did a study where they deliberately presented people who were used to using the SiteKey system with a page that did not challenge them with the picture.



LEO:  Oh, I�d be happy.  I don�t want to see that stupid�picture.



STEVE:  People complain about it all the time.



LEO:  I don�t want the picture.  I just want to sign in.



STEVE:  Get this.  97 percent of people didn�t notice that they weren�t being given a picture of their teddy bear or their dog Spot or...



LEO:  It was a relief.



STEVE:  Exactly.  And the other problem is, and I�m sure you�ve had this happen, is there are instances where you will be asked for some additional information...



LEO:  When I use a new computer, and I�m at a different IP address, then it wants a bunch of � and it�s a real pain because it asks all these silly questions.



STEVE:  Well, and that, it turns out, is the weakness.  Because if a phishing site creates a pseudo-site for BofA and gets you to click on a link, and we�ve all seen, and we�ve talked about how it�s possible to obscure the URL so it looks like you�re still on BofA...



LEO:  I think I�m at BofA.  Let�s say I�m not paying attention.  I think I�m still at BofA.



STEVE:  Exactly.  So what BofA will do is they will see you don�t have a cookie.  Oh, and by the way, they use Flash cookies, which we will be talking about here before long.



LEO:  Really.  They�re not using standard browser cookies, they�re using Flash cookies.



STEVE:  Also, but I do know that they are a user of Flash�cookies.



LEO:  Interesting, huh.



STEVE:  And it says so in their privacy statement about the whole SiteKey system.  So if they see that you�re at a different computer that doesn�t have a cookie, that�s when they ask you some additional information.  Well, it turns out that, if you were a victim of phishing, which is what this whole thing is designed to prevent, you log into what looks like BofA, and it�s not.  They ask you your username and your state.  So you fill that in.  The phishing site turns around and submits that to the real BofA site.



LEO:  And gets the SiteKey.



STEVE:  Yes.  Yes.



LEO:  Give me your SiteKey.  Now, actually it won�t get the SiteKey, will it, though, because it�s a different...



STEVE:  No.  What happens is, the BofA site asks the question, which the phishing site turns around and asks you.



LEO:  Passes on to you.  So you fill in the answers.



STEVE:  So you fill in the answers.



LEO:  And it fills in the answers.



STEVE:  It sends it back to BofA.  BofA then finally says, oh, this must really be Leo in a hotel.



LEO:  Here�s the SiteKey.



STEVE:  Sends the SiteKey, which the phishing site bounces through, providing you with the picture you�re expecting, and you give it your log-in.



LEO:  So it�s completely stupid.



STEVE:  It�s completely stupid.



LEO:  Which I always knew.



STEVE:  Yes.



LEO:  Not so clearly proved.  But it struck me as really silly.  And the real problem is people who get fooled by phishing scams are not savvy enough to be figuring out how the SiteKey works, what to watch out for and all that.  That�s the whole point.  They�re trying to protect people who are not savvy.



STEVE:  Exactly.  And we�ve just seen that a non-savvy person can still get fooled...



LEO:  Easily.



STEVE:  Even with a picture of their kitty cat on the screen.  It�s like, oh, I know I�m using BofA.  I�m going to transfer all my money.



LEO:  Well, so there�s no reason for me to go through this stupid � you know, the pass phrase I use with it is very insulting to SiteKey because it annoys me so much, even though I know nobody at BofA is reading it.  It just makes me happy.  Every time I see the SiteKey and the word stupideffingsitekey come up along with it, it just makes me feel better.  I recommend this to everyone.



STEVE:  Well, so essentially the takeaway from this is that multifactor authentication is generally a good thing.



LEO:  And that�s what they�re trying to do here.  This is�multifactor.



STEVE:  Yes, well, that�s what it is.  Well, technically, right, it�s more than just you using a password.  Actually what they�re trying to do there is they�re trying to provide the authentication which already really exists in the SSL secure connection.



LEO:  Ah, yeah, that�s true.



STEVE:  And in fact that�s where it�s really good.  But again, that�s what people aren�t checking.  That is, if you verify that you have a secure connection, and you take the trouble to check the certificate, and you see that it�s issued from Bank of America directly from Equifax or VeriSign or somebody trusted, that�s the way to know you�ve got a really good, nonspoofed connection.  But exactly following your point, Leo, typical users don�t do that.



And the problem is, this thing is trying to say, we�re really BofA.  Look, here�s a picture of your kitty cat.  And so it�s actually providing a false sense of verification because it has been cracked.  It has been hacked.  There are phishing sites that are using man-in-the-middle attacks on the SiteKey technology.  And unfortunately I guess Yahoo! has adopted it and a bunch of other companies have adopted it after BofA made such a big splash about it.  And it�s like, well, okay, this is better than nothing, you could argue.  But once again, the fundamental technology of verifying the validity of your SSL secure sockets connection is a much better approach because it�s real, and that cannot be, as we�ve seen, man-in-the-middle attacks are thwarted by SSL as long as you verify the authenticity of the certificate that you�ve got.



LEO:  Well, and I think this is a good example of a company going for the appearance of security and not really the fact of security.  This is such an obvious, intrusive technique that it gives you the feeling of, oh, they must be taking care of me.  When in fact it has absolutely none of that.



STEVE:  I think that, I mean, I like the idea of simple biometrics, for example, using a little fingerprint scanner on a laptop I think makes a lot of sense, as long as the underlying � as long as what�s done with the fingerprint, that is, the underlying technology to deal with the fingerprint makes everything else secure.  For example, you really need this stuff stored in the BIOS and for that to unlock your hard drive, for example, rather than waiting for Windows to boot and then using that to log on.  Because by the time that�s happened, you know, all bets are off.



Now, all of this, this whole issue of multifactor authentication, this actually came out of the research I�ve been doing into something we�ll be talking about soon, which is the Trusted Platform Module, TPM.  Because that ends up being an interestingly robust, or at least robustable � there�s a new word for us.



LEO:  Robustable.



STEVE:  Another way of providing a very secure authentication factor which of course has a mixed blessing because, again � and you could argue that even these approaches are mixed blessing because, to the degree that they limit user freedom, there are people that are saying, well, you know, I�d rather just use my password, my username and password, because I want the flexibility of sharing it with some other people.  So again, all of these things involve tradeoffs.  And if someone�s going to have their retina scanned, they might object to a laser being beamed into their eyeball.



LEO:  You know, that�s actually what Customs in the U.S. is�using now is a retinal scan and fingerprinting.  And a�passport.



STEVE:  Yes, exactly.  I have been fingerprinted as I�ve been going between here and Toronto.



LEO:  Have you?



STEVE:  Have you had a retinal scan � yeah, actually, last year sometime, you know, stick your thumb here.  And I was like, okay.  Oh, wait a minute, no.  I�m thinking of the DMV.  It was the last time I renewed my driver�s license.



LEO:  They do, if you�re coming from the U.S. generally into Canada they don�t, or vice versa, I should say.  But if you�re coming into the U.S. from many other nations, they absolutely do.  And now they�re using, there�s a kind of a fast pass thing they�ve got for � they call it CANPASS in Canada, and NEXUS, I think, is another word that they use in the states � that allows you to kind of breeze through with your passport and a retinal scan.  And again, it�s dual-factor authentication being the idea behind it.  And of course the reason they let you do this is they�ve pre-interviewed you, and they�ve done a background check and so�forth.



STEVE:  That sounds like a cool thing, Leo.  I�ll definitely sign up for that.



LEO:  Yeah, I�m going to sign up.



STEVE:  I don�t mind if some laser scans my retina.



LEO:  And I�ve watched people do it.  You know, in Vancouver there sometimes is a very long line to get into Canada.  And I�ve watched these guys just whip through the NEXUS line.  And they bend over, they get their eyeball scanned, and�they...



STEVE:  Wait a minute.  They bend over to get their eyeball�scanned?



LEO:  Well, they�re bending forward, let�s put it that way.



STEVE:  Oh, I see, bend down, right.



LEO:  Very important, yes.  The machine is a little lower than eye height.  And it looks like then you do talk to a person, but very briefly, and you whisk right through while the rest of us are standing in line.  So it�s kind of a neat thing.  And the sad thing is that a lot of people coming to the states now from other countries are really put through the third degree, including fingerprints and pictures and�passports.



STEVE:  Well, you know, the nice thing about that is it appears that retinas are very hard to spoof.  I�m not sure how you would spoof someone�s retina.  I mean, especially if you were under supervision by a guard.  You could imagine you could make a fake eyeball, and then you wouldn�t have to bend over.



LEO:  Right.  Here, just do this.



STEVE:  But at the same time I like the idea of, for example, being known as somebody who�s a member of NEXUS.  And if you could, like, check off "require me to have my retina scanned,� then that would provide � because I�m wanting stronger authentication, it would prevent somebody from spoofing me and coming into the country pretending to be me.



LEO:  Right.  It makes perfect sense, you know, it�s a good way to do it.  And in this day and age of heightened security, it�s, you know, whatever it takes, I guess.



STEVE:  Well, and here we are talking about Security Now!, and the issue of authentication, which is certainly going to be an ongoing concern in the future because with everything moving electronic, with more and more services going online, the idea of establishing your identity to whoever it is you�re having a transaction with is increasingly important.  And unfortunately the bad guys are seeing more and more gain from coming up with ways to circumvent whatever authentication schemes people come up with.



LEO:  That�s true.  If you want to know more about authentication, I bet you Steve�s got lots of information on his website, GRC.com.  Am I right, sir?



STEVE:  Yes, sir.



LEO:  That�s where the show notes live; the 16KB version of the show for the bandwidth-impaired; the transcriptions, the fine handmade transcriptions by Elaine; and of course Steve�s fine array of free security programs like ShieldsUP, SecurAble, DCOMbobulator, Unplug n� Pray and on and on and on.  And of course who could forget SpinRite, everybody�s favorite disk recovery and maintenance utility.  So that�s a�� I think that that�s just a fascinating subject, this multifactor authentication.  And it makes me want to do more to authenticate myself.



STEVE:  Well, Leo, you are authentic for all of us.



LEO:  PGP doesn�t seem enough.



STEVE:  We absolutely know you are you.  There are various interesting offshoots of this that we will be discussing in coming weeks.



LEO:  Oh, good.



STEVE:  Because authentication is a big issue, or should I say a big factor, in all things happening on the Internet now, and only more so in the future.  I think ultimately the notion of username and password over time will end up being considered no longer sufficient for many applications; and people will, you know, maybe we�ll all just have something like an RSA SecurID dongle or various schemes will become popular, and people will get used to them and appreciate the additional security that they do provide, even though you could argue nothing is perfect.  Then again, you know, people aren�t.  So that�s the...



LEO:  It�s actually amazing that we�re able to do as good a job as we do, yeah.  Hey, thank you so much, Steve. 



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#91

DATE:		May 10, 2007

TITLE:		Marc Maiffret

SPEAKERS:	Steve Gibson & Leo Laporte & Marc Maiffret

SOURCE FILE:	http://media.GRC.com/sn/SN-091.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo talk with Marc Maiffret, founder�of eEye Digital Security of Aliso Viejo, California.  eEye has perhaps done more forensic and vulnerability testing research to increase the remote security of Windows�than any�other group, including Microsoft.  They continue to find�and report an amazing number of Windows security vulnerabilities.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 91 for May�10, 2007:  Marc Maiffret of eEye Digital Security.



It�s time for Security Now, Episode 91, and a great episode, one of the rare interview episodes coming up in just a little bit.  Let�s welcome Steve Gibson of GRC.com fame.  Hello, Steve.



STEVE GIBSON:  Hey, Leo.  Well, of course we�re cheating a little bit.  We already recorded this fantastic interview with Marc Maiffret, who is the founder, actually cofounder with a friend of his, of eEye Security, that we talk about, I mean, their name comes up over and over and over because these are the guys, for example, that are finding all kinds of problems in Windows, telling Microsoft about them, and then waiting month and month and month for Microsoft to finally patch the problem, during which - and I remember saying this.  And one of the questions I asked Marc, because I wanted to make sure we were right about this, during that interval when they are aware of a vulnerability, Microsoft is aware of a vulnerability, and there�s this window of potential zero-day exploitation.



Well, due to the technology that eEye has, their users are preemptively protected.  And, in fact, not only are they protected - and actually it�s even better than I was saying�- not only are they protected because eEye knows well before Windows has been updated, but eEye�s technology, as we�re going to hear Marc describe it, is fundamentally preemptive because he�s doing a filtering at many levels, one of which is the protocol level.  So, for example, they�re looking at the data coming in for sanity checking, saying does this make sense?  And so even if there�s a vulnerability which Windows is unaware of and which actually eEye is unaware of, their system will catch and block unknown problems.



And what we learned really - and I�m very excited about this, I want to make sure people don�t miss this - is there is essentially a one-year free download for domestic users.  And even after that one year Blink is very affordable.  I�m very excited by what we learned during this hour-long conversation with Marc.



LEO:  Well, we�ll get to that, of course, in just a little bit.  Before we do, anything you want to clear up, clean up, fix, or rebut from last episode?



STEVE:  Yes, yes, yes.  I�m going to try to do a better job of reading my mail because I�m finding so much good stuff in there.  So I�m expanding the definition of our top-of-the-show errata to calling it maybe "Errata and Mailbag," so that we have the opportunity of sharing just one or two good things that people have noted.  And many listeners commented about RSA�s SecurID.  You remember that two weeks ago - or was it last week?  It was last week we talked about the multifactor authentication.  And SecurID was RSA�s token that shows a six-digit constantly changing, well, changing once every minute, changing number which moves - it�s sort of a pseudorandom sequence.  It moves through a progression that is a function of the cryptographic information stored inside this thing.  And whenever you connect to an RSA-based server it�s able to synchronize.



Well, a huge number of people said, hey, we use SecurID, and one thing you forgot to mention is that when you set up for this system, you provide them with a password which you prepend to the front of those six digits.  So that adds something you know to the something you have in order to get two-factor authentication.  And it�s clear that this varies.  So apparently you don�t have to do that.  Some people use a four-digit or four-number PIN.  Other people actually use their own password that they�ve chosen.  But I did want to bring it up because many people wrote to say, hey, part of this is it�s not just these six digits because that would only give you single-factor authentication, something you have, proving that you have the token in your possession which is generating this number.  But you also prepend something that you know being your hopefully secret PIN or�password.



Then I had one fun anecdote from someone named Scott in Washington.  He wanted to keep his last name private, and I don�t blame him.  You�ll see why in a second.



LEO:  Washington state, or Washington, D.C.?



STEVE:  Washington, D.C.



LEO:  Oh, okay.



STEVE:  Regarding hand scanners.  You know, the idea - we were talking about the biometrics of hands.  And I mentioned how, for example, I didn�t feel that hand sizing would be enough, clearly would be accurate enough and distinguishing enough and essentially differentiating enough to use as your sole ID.  But, for example, when I enter Level 3, I do it with a pass card coupled with my hand so that the system is able to say, oh, this is maybe Steve.  Let�s see whether this is his right hand.  Oh, yes, we believe it, and then it unlocks the door.



So Scott says, "As for your discussion on hand geometry, most of the studies I�ve seen said it can be sufficient for low-risk physical access.  If you are using hand geometry for access to a server room, what was the security leading to the door?  Was this another layer in the physical access controls of the location where the servers were located?  I ask because I am reminded of my college days, where they used hand geometry for access to the dining halls.  Those of us who were non-weekend meal plans used to take the cards from friends with similar hand geometry to use at the dining hall.  Even if the friend ate earlier, I could still use his card to get in and have my own free meal.



LEO:  Seconds.  Wow.  Okay, there�s a flaw.



STEVE:  Isn�t that great?  So I loved that because, you know, you�d go around high-fiving people to find somebody who has the same size hand and then say, hey, do you have the weekend meal plan?  Could I borrow your card?  Because the system wouldn�t be good enough to know.



LEO:  Right.  I hope they�ve gotten better than that.



STEVE:  And then finally we heard from a 12-year-old listener with a note that I got a kick out of.



LEO:  I love that.  Man, I wish my 12 year old would listen.



STEVE:  Well, his name, this guy is Justin Girard.  And he says, "Hey, Steve.  I�m a 12-year-old kid who listens to Security Now! and is quite computer savvy.  A few weeks back my drive in my two-year-old XPS-600 just died.  I don�t know what it was, but I just got a BSOD."  And then he wrote, "The Blue Screen of Death�s brother, the Black Screen of�Death."



LEO:  Ooh, even worse.



STEVE:  He says, "I scheduled a Geek Squad visit so they could fix it.  I was watching what he was doing, and he popped a CD into the system.  Lo and behold it booted into�SpinRite."



LEO:  Well, now I have new respect for the Geek Squad.



STEVE:  Well, not quite, Leo.  Wait till I�m done here.  It says, "Needless to say, SpinRite fixed it.  And I�m now a firm believer and will be getting a copy soon."  Okay.  The  bad news is, I�ve checked with my office.  The Geek Squad has no license for SpinRite.



LEO:  Oh, I hope that�s not - maybe it was his personal�copy.



STEVE:  Well, but you can�t use a personal copy...



LEO:  They need a commercial license.



STEVE:  Yeah.  We actually have three.  We have the normal end-user license, a single user.  And I have no problem if people use it on all the machines they own.  And as we�ve  heard in the past, if a buddy of yours has their machine die, I�m not going to complain if you go fix his machine.  Then we have our site license, which says a company is welcome to use it on all of their machines in a single location, if they will have four copies.  The cool thing about that is people can buy one to try it, and then buy three more to qualify for the site license.  I mean, just - it�s very nice.  Obviously this is all the honor system.  But I�ve been very impressed with how many sets of four I�ve been seeing sold after we made this more clear during our�podcast.



LEO:  Good, good.



STEVE:  And then we have what we call an enterprise license, which is ten copies.  And you can�t buy ten over the website because we limit it to four just to prevent there from being any chance for funky abuse of some sort.  But if you just write to our sales email address on our website, Sue will allow you to purchase ten copies.  And an enterprise license allows you to use it on multiple sites within a single enterprise and, you know, just for as long as you want to, to fix all the machines you have trouble with.  The problem is, of course, the Geek Squad has been in trouble before, as you may remember, Leo, from using unlicensed software.



LEO:  Oh, okay.  I was going to say...



STEVE:  Oh, this is not our Nerds guys, the Nerds On Site�guys. 



LEO:  No, they�re good.  That�s something else.



STEVE:  They�re 100 percent legitimate and great guys.



LEO:  The Geek Squad is the Best Buy people; right?



STEVE:  Yes.  So anyway, if there�s anyone listening within range of the Geek Squad...



LEO:  Busted again.



STEVE:  ...I would invite you to upgrade yourself to an enterprise license.  And then I�d be more than happy to have you guys running around popping your SpinRite boot CDs into your customers� machines and fixing their hard drives for�them.



LEO:  Spies everywhere.  Shall we say hello to Marc�Maiffret?



STEVE:  Absolutely.  We have such a great hour ahead of us,�Leo.



LEO:  I�m really excited.  First thing we asked him, of course, is how he got started in the security business.



MARC MAIFFRET: eEye started roughly about eight or nine years ago.  And it was started by myself and my cofounder, Firas Bushnaq.  And at the time I was basically your typical 17-year-old teenager, hacking and doing all the things I shouldn�t have been doing.  And long story...



LEO:  You were kind of a black hat hacker at the time.



MARC:  Yeah, at the time, yeah, definitely.  And I had, long story short, the kind of wakeup call one day when I was 17 that I was, you know, raided by the FBI.  And that was really the point where I knew that all this stuff I had been kind of doing that was really more of, you know, for fun and typical teenager stuff but on a much larger scale, realized that, you know, I need to actually kind of grow up and do something with my life.



LEO:  You�re kind of lucky you had that call to Jesus.  Although I have to say, I�m thinking of Kevin Paulsen and Kevin Mitnick both got caught as minors...



MARC:  Yeah.



LEO:  ...and weren�t sufficiently scared, I guess, to stop.  So you avoided jail time.



MARC:  Yeah, I never went to jail or, you know, I�ve never been arrested or any of that sort of stuff in my life.  So I think I have some parking tickets...



LEO:  And just out of curiosity, what were you doing when you got caught by the FBI? 



MARC:  You name it.  At the time I�d been in a couple of different hacking groups, and I was a part of pretty much one that - everybody�s familiar with hacking groups like The L0pht, for example.  And I was part of one of the hacking groups at the time which was called Rhino9.  And we were pretty much one of the first hacking groups that was focused around security and exploits around Microsoft Windows, and really like a Microsoft-centric focus around the research and the hacking.  At the same time I had also been doing a lot of stuff, everything from compromising systems to, you name it, pretty much major companies or governments and...



STEVE:  Oh, goodness.  I�m curious.  At age 17 did you have a different direction sort of marked out for yourself?  Did you have some interests, or were you just sort of like, I mean, I�m wondering if eEye and this switching over to doing good replaced some other plans you had, or had you nothing at that point really cast in stone?



MARC:  Yeah, there wasn�t really plans at the time.  I mean, the whole hacking to me was really just kind of an escape from an, let�s say, interesting home life, if you will.  So it really just kind of was this train, you know, that I jumped on.  Everything was happening fast as far as everything related to hacking and stuff.  And I really didn�t have a thought of where it was all going.  I mean, I didn�t really have a kind of perception of how big some of the stuff was that I was doing at the time.



STEVE:  And of course being part of Rhino9 gave you a group identity.  You were now a member of something, and you were connected to a whole bunch of guys that were, you know, similar thinking.



MARC:  Exactly, exactly.  And, I mean, and so that I just kind of got lost in it all, really.  You know, there wasn�t really any kind of grand scheme or plan or anything else, and really got lost in it.  And that�s why, you know, I really used the sort of wakeup call, you know, as pretty much the best way because I was lost in the whole hacking and everything I was doing at the time.  And, you know, being raided was a wakeup call.  And I was lucky enough that, after that happened - I had also previously, again, kind of long story short, before I was raided I actually had run away from home for about a year and was living all throughout the United States doing hacking and different stuff.  Like I said, I got back, everything caught up to me, and I was raided, and pretty much made the decision at that point that high school wasn�t for me.  I really wasn�t happy going there, not because I thought I was smarter than everybody or anything like that, but it just wasn�t kind of what I wanted to be doing at the time.



So I worked out a thing with my mom and everybody else that, you know, I wanted to start working.  And looked around, and being a 17 year old and whatnot it wasn�t like you just go jump into a security job.  So I actually got a job at a website design hosting company which Firas Bushnaq had started, and started showing him about the different tools that I had been using, which were kind of more exploit tools, or like kind of penetration testing tools.  And, you know, he comes from a software development background.  If you guys are familiar with the company Berkeley Systems and the After Dark screensavers and everything, he was...



LEO:  Oh, that�s neat.  That�s great.



MARC:  Yeah.  Remember when guys actually used to buy�screensavers?



LEO:  Yeah, and Berkeley Systems was the best, man.  Flying Toasters and, oh, yeah.



MARC:  Exactly.



LEO:  Lawnmower Man.



MARC:  Yeah, he kind of came from that background, you know, much more structured, standardized, but nothing security specific.  And we really just got together and talked about what we�d want to do product-wise, and that�s where we came up with our first product and still our most prominent product, which is Retina, which is a vulnerability assessment product.  And the simplest way is that you target�- here�s all the different computers that exist on your network.  And Retina will give you the output as far as here�s all the ways that people could break into the computers, and then how to actually solve all of those problems, you know, and kind of looking at your network like a hacker, thinking like a hacker, as we would say.



And as we started having a lot of success with Retina, everywhere from - we have I think roughly about 9,000 customers using Retina, and you could name some of the biggest.  The entire Department of Defense - which is funny considering I was raided when I was a kid - but the entire, though, right, entire Department of Defense is actually standardized on using Retina as their vulnerability assessment solution.



LEO:  So compare Retina to something like Nmap.  How is Retina different?  What does it do?



MARC:  Nmap is really something more of, you know, obviously as you guys know it�s going to map out all your ports, and it�s really going to stop at the point of here�s the attack surface, as far as here�s all the services and ports that exist that you could potentially use to exploit.  Retina takes it many steps further, where it will actually determine what are all the vulnerabilities that exist within those services.



LEO:  So it needs to know what exploits are current.



MARC:  Exactly, exactly.  So Retina�s kept up to date with, you know, what are all the current vulnerabilities.  For example, yesterday being Microsoft Patch Tuesday, two of the most critical vulnerabilities, one revolved around Microsoft Exchange and the other with the Microsoft DNS services.  And Retina will be able to remotely, rather than just telling you you have Exchange running, like what an Nmap would do, Retina will tell you that Exchange is there, and here�s the five different vulnerabilities or misconfigurations that you need to resolve, otherwise your system can be compromised.  And that eventually built out into more of an enterprise solution with a product that we have called REM.  And REM is what would be used at a Department of Defense or a large bank or something where you have 60 different Retina scanners all throughout the world that are all tunneling back to a central server to give you a consolidated view.



STEVE:  So essentially REM is like a centralizing management console for distributed Retina installs?



MARC:  Exactly.  It�d be for distributed Retina scanning.  And really the kind of one of the main differences is if you look at most vulnerability assessment, the standalone solutions like Retina or like what a Nessus would be or something, those are really just saying, here�s your computers, here�s some vulnerabilities and that sort of stuff.  When you look at like an enterprise or any sort of business level, people really want to be able to look at their vulnerabilities and attack information, and they want to be able to report and think about it the same way that they think about their business.  You know, so you might want to overlay some sort of a manufacturing business process and then know what are the potential vulnerabilities and security weaknesses that are part of that process.  And so REM really brings it to that kind of level, not just centralizing all of your vulnerability and attack information, but also giving you all the different kind of analytics and stuff that you would need to make sense of this mountain of data.



STEVE:  I�m grinning over here as I�m listening to you because you�ve gone totally corporate, Marc.  It�s paying the bills, so that�s great.



MARC:  It is, it is.



LEO:  And it�s better than eating tuna fish in jail for three years, too.



MARC:  This is true.  



STEVE:  So at one point a while ago, when we were talking about you, I was assuming that, if you found a vulnerability that you reported under sort of so-called "responsible reporting guidelines," meaning that you secretly tell Microsoft you found something, and you�ll say something about it on your site, but certainly not divulge any useful information that the bad guys could take advantage of, then are you preemptively protecting through some mechanism your customers against that so-called "zero-day," if somebody else took advantage of it?



MARC:  Yeah, exactly.  I mean, that was one of the things that for the longest time we�ve been doing is the identification of vulnerabilities through products like Retina.  And we really, in doing that, part of it was the research aspect of eEye discovering vulnerabilities, you know, which I could definitely expand on.  But on the point of, you know, on the protection side, I mean, that really led us to create our Blink product, which I think you guys mentioned recently.



LEO:  That�s very exciting, actually.



MARC:  Exactly.  So we really focus on the kind of vulnerabilities in security from the two perspectives of tell you everything, you know, where do we stand from a security perspective, and then actively protecting you.  And that�s where Blink comes in.  And part of it, if you name kind of any run-of-the-mill different critical Microsoft flaws, we had been discovering so many of them, and we had a lot of customers that were telling us, why don�t you guys have a solution that just protects us so that, if it takes us three months to patch or something of that nature, that�s really where Blink came about in being able to shield, you know, whether it�s desktops or servers from attacks, regardless if you have patches installed or not.  And everything from, you know, the consumer user who maybe just isn�t good about patching, there�s a lot of problems that haven�t been uncovered in consumer security.



But at the same time, on a business level, there�s a lot of time that it takes just to roll out patches.  And when you have exploits that are either zero-day, so there is no patch, or in the case of a lot of times when a patch does come out there�ll be an exploit within a few hours, whereas most people it takes them typically at least a couple of weeks or more to actually roll out patches within their business.  And even when they�re doing that, you end up where you�re rolling out patches in a rush, which means you don�t really get to do all the testing to look at compatibility and that sort of thing.



So Blink being there is, you can take Windows 2000, put Blink on the system, have no patches on that system, put it live on the Internet, and it won�t get compromised.  And it�s really taking all the research and everything that eEye�s been learning in the last, you know, eight or nine years about vulnerabilities in research and putting it into a product to protect people.  And I think probably the most exciting thing for me is, you know, we�ve been doing that on the business side as far as selling Blink to corporations and a lot of the same Retina customers.



But even more exciting is the stuff that we�re doing on the consumer side because if you look at, you know, still to this day my mom and everybody else�s mom that are worrying about, you know, protecting their individual consumer desktop, they�re still heavily dependent on stuff like antivirus, which just isn�t cut out for the types of attacks that people are facing today.



STEVE:  So your mom is no longer worrying about you.  She�s now worrying about what you used to do.



LEO:  Is Blink - is it a firewall?  Is it a patch program?  How is it protecting me?



MARC:  Blink is actually a handful of layers of protection.  It doesn�t really...



STEVE:  Is it a protocol proxy, Marc?



MARC:  Yeah, actually it does a few things.  So we do have that, your standard application firewalling, you know, what programs should and shouldn�t communicate to the Internet.  But we all know the problem with that is that my mom is going to say yes to every program or no to every program, and she�s going to break things or open herself up to attack.  So the application firewalling, which was really the first extension in security beyond antivirus, we have that within Blink.  At the same time you can have Blink, you can turn off the application firewall, and we�re still going to protect you from every attack.



And the way that we do that is through a few levels.  We do do the network-based protocol analysis.  So in the case of remote exploits over RPC or something of that nature we�ll be analyzing a protocol and looking generically for buffer overflows, integer overflows, any sorts of malformed requests and that sort of stuff.  Beyond just the network layer itself, we also have hooks into the application layer, with application-specific plug-ins for stuff like Internet Explorer and Outlook, looking for more application vulnerabilities.  And then we also do protection within the actual kernel itself, hooking various APIs and looking for kind of common types of bad behavior.  And then the kind of last part rounding it out is what we call kind of application protection, which is our kind of generic buffer overflow and related type of technology.



And the important part is that with Blink, you know, some people might say it truly is everything and the kitchen sink.  Be hard-pressed to find another host-based security software that does everything that Blink can do.  But I think one of the kind of feats of what we�re able to do is that we�re able to do all that with still using less memory than the McAfees and Symantecs and everybody else, and having a better performance because it�s always the balance of you can really, truly protect a system; but if it means that now my mom is having a delay on her Yahoo! games coming up, she�s not going to be a happy person, and she�s going to start disabling things.  And that�s the real world that a lot of security people kind of forget is the usability aspects and stuff.



LEO:  Do you still recommend using antivirus or antispyware along with Blink, or do you not...



MARC:  No, one of the last layers, or one of the last couple of layers of Blink, beyond preventing attacks that come from vulnerabilities, is Blink actually has a full-blown antimalware which is antivirus and antispyware, a solution...



LEO:  So you really don�t need any other security software.



MARC:  No, you truly don�t.  Even on the antivirus side itself is that, not only are we doing your classical keeping signatures up to date, looking for signatures of virus, but there�s also a sandbox technology which will take an executable, emulate it in a virtual environment so we can see what�s the behavior of the executable.  And if we see the executable is going to connect to an IRC server in Russia and take botnet commands, we know without having a signature or not that that�s a malicious piece of code.



LEO:  Yeah, that�s pretty obvious.



MARC:  So there�s a lot of stuff like that, you know.  Because it�s the same thing on the viruses is you�re always only as good as the signature update.  And we all worry about zero-day attacks today because there�s no patches.  But we should really think of malware as the same way, is that there is malware every day, and hundreds of them, where it is a week delay or longer...



LEO:  So you�re not looking at signatures at all.  It�s all�heuristic.



MARC:  Yeah.  We do have a signature capability.  And the reason that we added that is a lot of security companies, they love to tout the fact that they�re very generic and all this other sort of stuff.  It�s pretty much kind of that sliding scale of the more generic you become, the higher chance that you could break valid applications or, you�know...



STEVE:  Yes, you start having a problem with false�positives.



MARC:  Exactly.  So we try to keep the balance of we want to be as generic as possible; but I would never come out and say, you know, you never need to update Blink again or something like that because I think that�s kind of crazy talk.  The other reason, you know, being able to react in a case where we didn�t generically protect, being able to react to the signatures is an important thing to have there.  I can safely say, if you look at Microsoft attacks in 2006, I think we had to do an after-the-fact kind of signature maybe two, three times, which is a pretty good track record.  And the other important thing really on a corporate side of needing to do signatures is because, if you�re doing everything generically, you can�t differentiate on a threat level.  So you might have a hundred events that say there was a generic RPC attack.  But it�s important to know was the RPC attack due to a worm, a script kiddy, a targeted attacker.  You need to be able to make sense of when you have thousands of attacks that are coming into our console, what�s the needle in the haystack that you should care about that you should be responding to?  Which again, that�s where REM on the management side comes in, to making sense of that�data.



STEVE:  I really like the architecture you have because this protocol level filtering means that, if something did happen to get through, you can look at how it was that it got past your filters and strengthen them in a way that closes not only that particular instance, but all kinds of other latent instances that you haven�t actually encountered yet.



MARC:  Exactly.  And that, I mean, specifically what you said is actually how we went through the design process of Blink where we sat down before figuring out do we want to do network-based or protocol or anything - a lot of security products, they tend to pick a philosophy without analyzing the data set.  And we sat down, and we looked at about 5 or 6,000 different Windows-related vulnerabilities, not just Microsoft, but it could be a patch running on Windows.  And looking at the 5 or 6,000 vulnerabilities, we tried to boil down what were all the common characteristics that existed that allowed the system to be compromised through this flaw?  Not just the classes of attacks like buffer overflows, but how were protocols used, maybe RPC or HCP, how were they manipulated in a way.



And we really found that looking at this 5 or 6,000 vulnerability is that there truly was maybe a few hundred different commonalities between them.  And that was really the first effort of making sure that Blink is looking for these things generically.  And it�s an ongoing process of when there�s new attacks and analyzing was there other layers.  You know, one of the good things about Blink is not just that we�re doing the network and applications and everything, but typically, if you take something that was very popular and bad like a Sasser worm, Blink actually stopped that with three different layers of protection.  So it wasn�t just that we lucked out that one of our rules caught it.  But a lot of times there�s multiple rules within Blink that�ll catch most of the attacks that exist today.



LEO:  Let�s use a recent example, the animated cursor flaw.  And you knew about this long before Microsoft admitted to it or patched it.  You knew about it in October, I think.



MARC:  Yeah.



LEO:  And I want to talk a little bit later on about this whole issue of when do you tell the public, how long do you hold off.  And I know this is a hot one for you and a lot of security researchers.  But let�s ask specifically about Blink and the ANI cursor flaw.  Did you put a patch in Blink?  Because I know you had a patch before Microsoft did.  Or do you not worry about that?



MARC:  Yeah, with that flaw specifically, Blink was already protecting without an update or anything.  There was a couple layers that were protecting.



LEO:  That is so nice.



MARC:  We do some stuff on the - kind of like what we do with the network side of analyzing protocols and how they�re�behaving, we do similar stuff on the file system side.  But we caught it with one layer there.  And then also we have a system that�s generically looking for buffer overflows.  So if we see you�re trying to run code from some crazy place in the heap or off the stack or whatever it might be, we�ll generically flag and prevent those things.  So Blink�itself...



LEO:  That�s different from DEP; right?  And I presume more�robust than DEP since you obviously - DEP breaks so many�things.



MARC:  Exactly.  DEP�s implemented different than how, you know, than what we�re actually doing because we do, rather than something like DEP, where they�re just super generically looking, hey, is there code executing off a place that it shouldn�t be, we actually do a little bit of intelligence on looking at what types of code and this and that.  Because you have stuff like Java, for example, that does actually do things that will make it look like you�re executing code off the stack or whatever it might be, you know?  And in those cases you can have false positives.  So we do a lot more intelligence around when some of these cases trigger, doing a second step of, okay, is this really a bad thing or just an application that is acting a bit funny, if you will.  And that�s the same in the case of the ANI flaw in the sense that, you know, the two different layers, we were protecting without updating.



So for a consumer it�s great because your antivirus doesn�t really stop ANI.  And you don�t have a patch at that point.  Whereas Blink, without a signature update or anything, is already preventing the attack.  That�s definitely a benefit for a consumer.  And on the corporate level, especially if you�re talking, you know, you have 2,000 systems or something, at that point again there is no patch, so you�re protected without an update.  But even when the patch comes out, it might take you a few weeks to roll it out or test it.  If you�re in the financial world, you have to do all the change control documentation, which also creates delays.



So what we ended up doing, which you were asking earlier on, we did release a third-party patch for the ANI bug.  And what that was, was we actually wrote a specific code fix specific to that flaw.  So this is a completely separate thing than Blink.  The reason we did that is that Blink is something that, at the time, we do have the free version now, basically, and at that time it was kind of really what could we get most people�s attention on to download and protect themselves.  And at that it was really more, I mean, that�s kind of on a business decision at the time of we could try to tell the reporters, hey, we�ve got this Blink thing.  But reporters are all hit with, you know, ten companies that are saying my product protects and my product, you know, and that kind of thing.  So the third-party patch thing is a lot easier way.  And we kind of use the third-party patch, you know, the first screen that you got was you can do this one-off patch which will protect you from this single ANI flaw, or you can go download Blink, which will protect you from ANI and every single other Microsoft flaw and zero-day that has existed, basically.



LEO:  Boy, if I were in the security software business I would not like you very much right now.



STEVE:  In fact, I was just going to say that I want to make sure our listeners heard that, and that we make sure that we heard it.  So you guys have a free version of Blink that does a lot of this.



MARC:  Yeah, literally we have - the marketing guys will probably shoot me for saying this.  But we have Blink, which�is the exact same thing that we sell to companies all throughout the world...



STEVE:  For like a lot of money; right?



MARC:  For a lot of money, yeah.  Competitive, obviously, but a lot of money, all throughout the world.  And we literally took that exact same technology, and we made a personal consumer version.  So we changed some of the defaults, the installation process, to make it a little bit more friendly.  But the exact same kind of under-the-hood technology, and it�s basically free for a year is the catch for consumer use, and anybody can go get it and download it.  And everything I�ve been describing with the zero-day protection, the whole antivirus system, I mean, we have so many people right now that are, you know, their renewals are coming up for Symantec and McAfee, and they�re all downloading Blink.  And we still have work to do because, again, Blink was really first meant for companies to be using, and so it�s got great protection.  And the current interface we�re looking to kind of simplify a little bit more and that sort of thing, make it flow and be a little bit easier for consumers.  But our first and ultimate goal is to really just make the out of the box where the compatibility is good and as far as what it works with and those sort of things.



And one of the ways that we do that, and the kind of catch, as the American way goes, there�s nothing really free, so our catch on free is basically that any of the attacks or vulnerabilities that are being discovered on your computer is sent back to eEye anonymously.  And the two uses of that for us is, number one, to improve any bugs, so if there�s a spike in Yahoo! Messenger or something, we know there�s definitely a bug, something going wrong there, maybe a false positive.  And then number two is to figure out what are the�- maybe something that we�re generically protecting with our buffer overflow system that we should have a network intrusion prevention rule for and that sort of thing.  And basically all that goes back into the product for the consumers also.



STEVE:  Very nice.  And so is Blink somehow updating itself during this first year free period also?



MARC:  Yeah.  So Blink, you can set it to - because the last component of Blink which I didn�t even mention is there�s actually our Retina products, which I was describing earlier, the 9,000 whatever customers where you can identify all your vulnerabilities, we actually threw that into Blink.  So there�s a full-blown vulnerability assessment solution within Blink.  The engine�s been slimmed down as far as interface and that sort of thing.  But there�s about 3,000-plus vulnerability audits that Blink will also do.  And so it�ll tell you what patches are missing, where to go get the patches, anything that�s potentially misconfigured.  One of the eye-opening statistics that we saw, all the anonymous Blink data comes back to actually one of our REM systems.  And one of the interesting statistics we saw is that most home users, they�re getting better at making sure they stay up to date with Microsoft patches as far as the timeline of when their Windows Update is patching their system and�whatnot.



But one of the things that we saw is that the greatest number of vulnerabilities are actually the non-Microsoft vulnerabilities, the vulnerabilities within iTunes or Adobe or QuickTime or Flash.  And the list goes on and on.  And one of the things in 2006 that I was kind of preaching at as many conferences as I could is this idea that - a very simple idea, but it�s more than a Microsoft world.  And really the simplest way to compromise most consumers and most companies these days are actually through non-Microsoft vulnerabilities.  It�s in the corporate world your Veritas backup software having vulnerabilities, or your IBM laptops that have an ActiveX flaw, the list goes on and on.



But the problem is that, if you look at what exploits are being created, for example the open source platforms like Metasploit, they do cover non-Microsoft, and they come out with exploits just as fast for non-Microsoft flaws as they do for Microsoft.  But if you ask the average person in the IT world, you know, what did you do when the Veritas flaw came out, did you have a Patch Tuesday, you know, there is no Patch Tuesdays or quick responses or anything else.  So in the consumer world it�s even worse because, again, the average consumer, they don�t understand when iTunes pops up and says, you know, hey, there�s a new 42-meg installer that you need to do.  They�re like, well, why would I do that?  Because my music�s playing fine, and I don�t want to wait for that, you know, thing to download and whatever else.  And there�s a real problem with most non-Microsoft applications, you know, like some of the ones I listed where they�re not good at separating features versus security updates, and also the way that they inform their users and keep that software up to date.



So I think that�s probably one of the more eye-opening components of Blink is the vulnerability assessment piece on really showing you that, even if you�re running Windows Update every night, you�re not actually secure.  There truly is other things that people can leverage to compromise you.  And that�s another thing that�s a part of Blink that�s there.  And, I mean, you can�t find another host-based product that does that.  And that part�s free, part of the free version also.



LEO:  I don�t suppose we could convince you to write a Blink for Mac by any chance, or Linux.



MARC:  We toy with the idea.  I mean, obviously that all comes down to the business side on the...



LEO:  And you guys are Windows experts.  I mean, that�s�your...



MARC:  Yeah.



STEVE:  So what this is also saying is that, in terms of this application vulnerability issue, Windows itself is really no longer the lowest hanging fruit.  There are now, because Microsoft has been effective with Windows Update, with Patch Tuesday, with over the course of the last five years slowly and painfully educating users, that message really has gotten through.  But no one has really yet woken up to the fact that there�s all these other things which are trying to enhance themselves by being network aware, like backup software that now wants to be on the �Net, which is like the next round of vulnerabilities for everyone to deal�with.



MARC:  It is.  And, I mean, it�s an interesting thing.  You know, one of the things I tell people is I look at the start of Microsoft security as really happening, you know, back in about 1999 or so.  And that was where I personally found some of the first remotely exploitable Microsoft flaws.  And then years later we saw stuff like Code Red and whatnot.  And really in the last eight or nine years - eEye kind of started at the beginning of Microsoft�s thing, really.  But in the last eight or nine years Microsoft has progressed greatly.  And they do have one of the best security response, or not just response, but really security processes in general of how they build their software, how they try to educate users and that sort of thing.  And in that last eight or nine years, as Microsoft has pushed the bar to make their software more secure, researchers and also just bad guys that are trying to exploit systems, they�ve also improved and added a lot of skills and basically things to the toolbox, if you will.



And if you were to kind of put that on a graph, if you will, you�d see Microsoft and the average researcher just climbing and doing better.  But you can label almost any other software company out there, and they�re pretty much a flat line because most other software companies have never had an incentive or a reason to focus on security.  I mean, Microsoft themselves, you know, as much as it might be out of the kindness of their heart or something, we all know that businesses revolve around the bottom line of money and everything else.  And if you�re not losing money based on having insecure software, you�re not going to spend the money to make it more secure software versus adding new features to stay competitive.  And I really think that there is a time coming, I mean, we saw one of the first non-Microsoft worms targeting Symantec�s antivirus, and I think we�re going to see a lot more of that in the future.



STEVE:  Yes.  And frankly, while I completely agree with you that Microsoft has finally got it, look how long it took.



MARC:  Yeah.



STEVE:  I mean, look at the incredible inertia they had.



MARC:  Exactly.



STEVE:  Not to get it for so long.  So, I mean...



MARC:  And the interesting part, you know, more than the Microsoft world, usually the way that I end up, you know, because everybody usually is surprised, they�re like, wow, Marc Maiffret�s saying all these nice things about Microsoft, and I do mean it all.  They do truly have the best practice around security than any other software company.  I�ll say that time and time again.  The thing that worries me is not just that the attack surface is shifting and will shift to non-Microsoft flaws.



But it also worries me with all the marketing now that Microsoft does around things like Vista and Office 2007 and related, it really worries me about people becoming complacent and just kind of a little bit idle as far as making sure that we keep Microsoft on the path of writing secure software.  And the way that I usually like to end that kind of presentation is I�ll do a demonstration of you can basically take Windows Vista, which is the most secure thing ever for Microsoft, and Office 2007, which also went through the full, you know, security development life cycle and everything.  And I�ll actually do a remote exploit, remote hacking demonstration on showing a malformed Office file that then leads to code execution and uses a local Vista kernel privilege escalation so that you go from the local unprivileged user to running code in the kernel.  And that pretty much shatters all layers of Vista and Office 2007 security.



And the reason that that�s important is because there definitely isn�t an end, and I don�t think you�ll see a big tapering off of Microsoft vulnerabilities.  And really I think the thing that we�ll come to a point on is that, when it comes to Microsoft and security, I think we�ll see that, even if you�re doing everything possible that you can as a software company to make your software secure, there�s still going to be flaws.  And there really doesn�t need to be that many flaws a year to kind of cause the same negative aspect on Microsoft or really negative aspects on people�s computers and networks.



So if you think about it, most businesses, if they were to have, you know, even once a month or every couple of months, a major critical vulnerability that they�re worrying about, that�s going to keep them busy.  And when you put it in that terms you�re really talking about maybe 12 vulnerabilities a year.  And when you look at the entire Microsoft attack surface between the operating system and all the common applications, to say that there�s not going to be 12 mistakes a year is kind of - I don�t think we�ll ever kind of get to that point.  So there�s always going to be those problems every couple of months where you do need to rush out, you do need to patch.  But again, I can�t say enough on that Microsoft has come a long way.



And the last point on the Vista, since I was talking about it, is Vista has a lot of security improvements.  But they�re really towards improvements around Microsoft code itself.  If you look at something, for example, like they added the address-based randomization, which is a good way to help prevent some buffer overflows.  They added that to Vista.  And one of the things that�s interesting, though, is most of that is focused on Microsoft applications.  So one of the flaws we found recently affects Java, which I think a couple people still use.  And in the case of the Java flaw, you can be running Vista with all the latest patches, everything enabled.  And if you go to the wrong website we can compromise you through a Java flaw.  Which is, again, another example of the kind of non-Microsoft world.



And one last point, before we get off Microsoft, but one last point is that the two vulnerabilities that we found, the vulnerability within Vista itself, the kernel, and the vulnerability within Office 2007, the most eye-opening aspect was that the vulnerable code only exists in Office 2007 and only exists in Vista.  Which means these aren�t two legacy bugs that got missed.



LEO:  Brand new.



MARC:  Yeah, exactly.  It was new code that was added.  And that to me was even more eye-opening than, hey, we found a Vista flaw, but that it was actually new code and that kind of thing.



LEO:  Let�s not get off Microsoft quite yet because there is an issue that comes up with security researchers all the time, and it�s an important philosophical issue, to reveal or not to reveal when you find a security flaw.



MARC:  Yeah, I mean, there�s definitely levels.  And, I mean, for me there�s a lot of terms that should just be killed off like "full disclosure" and "responsible disclosure."  Because everybody means things different.  So to me, you know, kind of how you should handle vulnerabilities and what you should do to it, you know, what we do at eEye is, when we discover a vulnerability, we need to take it to the point of understanding everything we can about the vulnerability, knowing that a vendor isn�t always going to get it right and isn�t always going to want to tell you the truth.  So we�ll research it.  And it could take us, you know, could take us a month that we�re researching this thing and figuring out all the aspects.  But at that point that you feel comfortable that you have as much of an understanding as you can, at that point you should be reporting it to the vendor, and you should be giving them the time that it takes to fix the flaw.  In some cases...



LEO:  In other words, reveal it to the vendor but not to the public right away.



MARC:  Exactly.  I mean, you should never really reveal it to - reveal details like actual specific details you should never reveal to the public until a patch has been created.  The problem comes into play is that, in the case of companies like Microsoft, they can end up taking sometimes close to a year to actually create a patch.  And they have all these crazy reasons of why that is.  To me there�s really no excuse to take a year.  And the problem that comes into play with that is that, for a company like eEye, I mean, we�re a business, and the last thing in the world from all sorts of perspectives that we want to do is release a zero-day or something.  It doesn�t help anybody.  I can definitely see why a lot of independent researchers do come to the point of frustration, where it has taken so long for Microsoft that they do just want to tell people about it because especially in the current climate, where one of the things we�re almost worried about is zero-day attacks, the longer Microsoft takes to patch a certain flaw, the more chances that the flaw is already known within the underground as being used to exploit systems.



And the ANI vulnerability is one of the perfect examples of that, where it was actually found by a security company, or the second ANI flaw, not the eEye one, was actually found by a security company and then was actually - took months for Microsoft.  And we saw it come out in the wild and in a zero-day fashion.  And that really, again, goes back to these isn�t a lot of time, you know, you�ve got to make a good patch.  You know, it needs to go through QA and stuff.  But I think we could all safely say that, you know, a year is probably too long.



You know, and again it comes down that, you know, there�s independent researchers who - there really is no - there�s nothing illegal.  You can go release as many zero-day as you want tomorrow, and that�s a whole �nother debate about laws.  But there�s nothing illegal about releasing a new flaw tomorrow without telling a vendor.  And, you know, for a lot of independent researchers there really is no motivation to work with the vendor because it�s a very painful process.  The vendor wants to minimize everything they can about the flaw, whether that�s saying what�s right or wrong or what�s real or not.  It still is a marketing problem for them, and they want to minimize everything.  So there�s kind of a lot of B.S. that a lot of the researchers have to go through.  And I can�t blame a lot of independent researchers for not wanting to have to go through that for six months with Microsoft or some companies out there that are even worse, like the Oracles of the world.



STEVE:  And ultimately you guys, security researchers, never get anything back really for the trouble except maybe a little mention in some postscript note somewhere at the bottom of an announcement of, you know, thanks to so-and-so for reporting this.



MARC:  Exactly.  I mean, for independent researchers, you get some recognition.  You post your advisory on a mailing list or something.  So maybe if you�re looking for a job or you want to get noticed by an eEye or somebody like that.  But yeah, otherwise it�s a lot of time without really any value.  And that�s why you see a lot of independent researchers that, not only are they actually just not simply telling Microsoft, but they�re not actually telling anybody.  They�re actually selling the exploits to third parties, you know.  And in some cases it could be legitimate third parties, you know, companies like iDefense or, you know, the TippingPoint initiative and stuff like that.  But in a lot of cases these things are being sold, in some cases to the bad guys, if you will, that are using zero-day to couple it with, you know, whatever scam of the month that they�re doing as far as phishing attack or something of that nature.



We saw with the ANI zero-day that within about a week of it becoming kind of a public thing, that there was actually already websites that were hosting it, and it had malware attached to it, too.  Where if you went to that website it would actually scan looking for credit card information on your system to be sent back.  And that was all in a very short period of time.  And that kind of gets back to what I was saying on Blink is that the attacks now are very different, that the bad guys aren�t hoping you accidentally run an EXE from an attachment.  They�re hoping that you go to the wrong web page or that you�re using Microsoft Office, and you open a Word document or whatever, because they�re taking advantage of vulnerabilities within software flaws much more these days than the kind of human, for lack of a better word, stupidity or whatnot.



STEVE:  One of the things, as I�m sure you know, that early�on I was really waving my arms around about was that Microsoft for years kept shipping Windows systems with open services.  You know, with exposed services.  So I was early on the bandwagon, trying to get people to run personal firewalls.  And more recently, you know, being behind a router, which is inherently giving you stateful connection�protection.



MARC:  Exactly.



STEVE:  So it really is the case, first of all, finally with Service Pack 2 having its own firewall running by default, thank god, and everything since then.  And even more so with so many residential users now being behind routers, the nature of attacks has really changed...



MARC:  Exactly.



STEVE:  ...to one where you�re counting on users to go out and do something to get themselves infected, rather than having just a system sitting there doing nothing that is going to automatically pick up a Blaster worm over its Internet connection.



MARC:  Exactly.  Yeah, I mean, you�re totally right.  I mean, the attacks have shifted from being the kind of network-based, the Sassers, the Blasters, and those kinds of things, to really targeting a lot more of the kind of client applications.  Which to me is a kind of scarier proposition because, if you�re targeting the Outlook vulnerability, the Office vulnerabilities or something of that nature, a Skype vulnerability, which we�ll get to in a minute - no, I�m just kidding.  But if you�re targeting those kinds of application vulnerabilities, especially in the business world, most average companies, they�re very dependent on perimeter security, you know, they put up their firewall, and they kind of have the same thing that we used to say back in the �90s of you got your castle and the moat and everything like that.  And most businesses are still that way.  You know, maybe they have antivirus on the desktop is about it.



But when it comes to these client application vulnerabilities, the easiest way to really do some damage and get some data out of a company is to send the Microsoft Word zero-day to the HR department at a large company, and the lady in HR opens it, Word disappears, she�s none the wiser, now I have that computer compromised.  Now that I�m on the inside of your network, I take a remote attack like the DNS zero-day to target your active directory server.  And now I�ve compromised that, and I can do anything I want to your company.  And this all happens within a few hours.  And the big problem there, again, is because we�re not really protecting the insides of our network.  You know, we�ve put all these walls around it.  And as one would expect, the attacks shift.  Well, if there�s walls everywhere, I�m going to go ahead and find different ways, either kind of under or over or whatnot.  And that�s what we�re seeing with all the kind of client application attacks and file format attacks.



STEVE:  I generally, it seems, if I look back, go sort of from one crusade to another.  And I�m sure you are aware of my raw sockets crusade before the launch of XP, trying not to let Microsoft send XP out with raw sockets.  And of course it took a couple of years and two service packs before they finally, reluctantly, pulled that out.  Now the thing that I drive Security Now! listeners, and especially Leo, crazy with is I�m so against browser scripting because it�s just such a problem.  I mean, if you�re scripting in your browser, you�ve enabled your client, your browser client, to run code from any site you visit.



MARC:  Yes, exactly, I mean...



STEVE:  And how is that ever going to be safe?



MARC:  Yeah, and it honestly is really headed for the worst.  I mean, you guys know as much as anybody that the browser is becoming - might as well be becoming the operating system almost itself, you know, if Google and everybody else has their way.  And as that happens more it means that you�re going to have so much more of this kind of web-enabled content and stuff.  And really all that ends up doing, whether it�s active scripting or Flash or what�s the new Microsoft Silverlight, I believe it�s called.



LEO:  That�s right.



MARC:  As all these things are added to the browser to make the browser kind of this more rich experience and really to make it like a Win32 app and everything else, the more that they do that, the more that you increase the attack surface, or really the number of areas where an attacker can supply malformed code and potentially compromise the system and whatnot.  So, I mean, that is almost, from a browser perspective, there�s kind of no end in sight as far as the "browser vulnerabilities."  But I really think a lot of that is you could almost say there�s also no end in sight on operating system vulnerabilities.  And it�s really a byproduct of the browser itself becoming much more of this platform, you know what I mean, that everything�s starting to live in and exist in.



STEVE:  Right.  And again, it�s not so much that things on the outside are any longer able to come in because, as you said, there is good border security.  Now it�s things, you know, on the inside, things people do that invite the bad guys in across your border.



MARC:  Exactly.  And we see that, I mean, if the attacks like we�ve seen that have come across stuff like MySpace, for example, you know, embedding things within that, and then using that to do different browser attacks and, you know, that sort of stuff kind of goes on and on.  And I think one of the interesting aspects that people haven�t really talked much or done too much forward thinking on is one of the scary aspects of security as we move into kind of this everything�s hosted online, everything�s, you know, managed services and software as a service and whatnot.  As everything becomes more hosted on the web, it becomes actually harder for third-party independent researchers to actually audit products at that point for vulnerabilities.



STEVE:  Good point.



MARC:  If you take, for example, what Google is doing with a lot of kind of, you know, basically trying to bring something like Microsoft Office in a web browser experience, you can�t really sit there and test that experience for vulnerabilities because when you�re doing the testing you�re actually doing it with a third-party server, which at that point becomes illegal for you to actually do that.  A lot of the software companies are excited by that idea.  I know some of the security guys at Microsoft love what Microsoft is doing with Microsoft Live because they�re like, if the software�s on the web server, you can�t really mess with it as much in the legal manner, so we shouldn�t see as many�flaws.



The bad thing is that the white hat, the good researchers, the guys at places like eEye, yeah, it does make it harder for us to look for flaws because we�re not going to illegally interact with a Microsoft web server or a Google.  But the real bad guys who don�t care about laws, they�re still going to be looking for flaws, and they�re still going to be finding them.  So in those cases it kind of cripples some of the good researchers.  And the thing that becomes kind of compounded by it all is that, when you have all these kind of web-enabled, you know, and online services and stuff, it makes it where I don�t need to find, you know, if I find that vulnerability within Outlook, for example, I can target a user here, a user there.  If I find the vulnerability within, you know, Outlook Live or whatnot, some web-based version, that means now I have the potential to compromise a system that now houses every user of Outlook.  And so the kind of value of an attack becomes much greater as everything turns into hosted web servers and everything else.  So that�s going to be interesting.



STEVE:  You know, one thing that you�re touching on brings up an issue that I was going to ask you about, and that is the work you�ve been doing and its potential collision with the DMCA.



MARC:  Yeah.  One good thing about the DMCA, it does actually have a provision that, if you�re doing reverse engineering because of doing security research and looking for vulnerabilities, that is actually legal and protected.  A lot of people blur the lines on and get up in arms on DMCA as really more around people that are defeating, you know, the copyright restrictions and stuff like that, which is what it was meant for.  But you can go and take Internet Explorer and reverse engineer and print out all the Assembly code and do whatever you want as far as looking for flaws.  And there�s nothing illegal about doing that.  But like I said, if it�s hosted on a web server, you can�t really sit there and throw different attacks at it all day because that does become illegal, you know, depending how it�s done.  So I think that�ll be kind of an interesting shift and change in, you know, how we�re doing vulnerability research, how companies are protecting from those sort of things.



And some benefits is that, if there is a flaw within a web service, unlike something like Outlook, where you have to now push a patch out through Windows Update and hope everybody out there gets it, with the web-enabled stuff you change it on one server, you know, your cluster of servers, and now everybody�s protected.  So it does make some things on security actually a lot easier and a lot better.



STEVE:  But you�re right, by centralizing all of that - and notice in an instance like, for example, Google Mail, where you also have everybody�s data in addition, so you�ve got centralized repository of data, and if you�re able to get into that server and farm the data, you know, we�re talking about spectacular, you know, the potential for spectacular�disasters.



MARC:  Oh, definitely.  And I think we haven�t even begun to see how that goes.  I mean, if you look at the data theft that we all worry about today, you know, when TJX or somebody like that loses customer data, I mean, those things are obviously bad.  And if somebody does SQL injection and gets customer data, it�s a bad thing.  But when you talk about now we�re going to have most all home users that all their data is sitting online at a third party, number one, there�s a lot of weird privacy things.  I always joke with friends that I�m pretty sure the NSA started Google because that�s the best way to spy on everybody.  But not only is the privacy stuff there, but if those servers are compromised, now you�re talking about instant access to everybody�s data.



And it�s similar to, you know, when we make analogies about, you know, the kind of real world, if you will, to cyberspace about, you know, in the real world I could go door to door, trying to break into a house.  In cyberspace it�s easier because I can sit from one computer in the middle of China and attack thousands of systems.  And then when you start talking about it moving to this kind of web, you know, service-type stuff, now it�s - I don�t even need to attack a thousand systems.  Now I�m the one guy sitting in China that�s attacking one server somewhere, and now I get those thousands of systems, virtual systems, if you will.



STEVE:  When they come over and hook up to that central�location.



MARC:  Exactly.



STEVE:  I mean, you don�t think of it this way, of course.��But in the same way that IRC servers are used to collect zombies, you have the same sort of networking model where a whole bunch of browser clients are all connected to�a central server.  And, you know, you just send them all�a�vulnerable ActiveX control, which they�ll happily�instantiate...



MARC:  Exactly.



STEVE:  ...and off you go.



MARC:  Exactly.  So like I said, I think that�ll be interesting to see how that all kind of progresses and plays�out.



STEVE:  What do you think about Windows versus Mac security?



MARC:  Yeah, I mean, a lot of - some of the stuff in Vista, like address space randomization and the whole UAC annoying stuff and everything, I mean, some of it�s just real bad knockoffs of what has existed in the UNIX world forever.  You know, especially on the kind of user experience side of security.  The main thing that it still comes down to is, you know, personally I think the Mac is great.  I use it for all my music recording and all that.  But from a security perspective, Windows still is the 90-whatever percent of what the world is running on.  So you�re always going to have more Microsoft vulnerabilities.



The thing that I think is very sad about Apple is that Apple doesn�t write any more secure, or necessarily worse, but any more secure software than Microsoft�s or anybody.  Apple�s code is just as bad as anybody else�s.  But there is kind of the thought for most people that Apples and Macs are more secure.  Mostly again it�s because people in the research community, if I�m going to spend three weeks looking for a bug, I�m not going to do it in Apple because there�s not as much value compared to Windows.



STEVE:  Well, and you guys are also big in the enterprise space.  And, you know, enterprise is PCs running Windows.



MARC:  Yeah, exactly.  So, I mean, the point I was getting to on it being sad about Apple is that they really are at a point right now that, if they truly started to focus on security, they could actually get security right before people realize that they�re actually not as secure as all the ads and all the kind of the culture around it, the blogs and everything else would lead people to believe.  They do pretty much the same mistakes that, you know, Microsoft was doing eight, nine years ago, where security is more of a marketing problem.  You know, the way that they do updates and the way that they do the notifications is very flawed.  We�ve found a handful of Apple, like QuickTime and whatnot, flaws in the past.  And again, it was very much the kind of culture of Microsoft, you know, eight or nine years ago and�stuff.



STEVE:  And of course it�s no surprise that people think that the Mac is more secure than Windows because we see those two guys on our TV sets now talking about how...



LEO:  It must be, yeah, the ads say so.



STEVE:  One guy is able to get sick, and the other one can�t get sick.  And it�s like, okay.



LEO:  Yeah, I thought that was kind of asking for it, yeah.



MARC:  Exactly.  Oh, yeah.  I mean, I kind of equated that ad to, you know, when Oracle came out and did their whole "unbreakable" campaign, and Oracle went from not really a target to everybody went after Oracle for that.  Again, there�s a different value thing because Oracle is actually, you know, right there with SQL, number one database stuff.  So there�s value in finding Oracle flaws as far as the impact and what you can do and number of people affected.



With the Mac that statement still isn�t true.  But if they become more successful as a business, in the sense of gaining more market share and everything else, they will become more of a target.  And my real hope for them right now is that they pretty much are untainted.  Mac has a great perception of being secure and being better and all this stuff.  And if they really started now focusing on security, by the time that they get to the point where they have the market share that�ll cause them to be a target, they could be secure.  And the whole perception that exists now could actually be a reality, and it could be a great thing for them.  The part that is just on a random personal crusade level frustrating for me is most of the people at Apple still don�t seem to get that from a security perspective.  They�re actually kind of drinking their own Kool-Aid without actually doing some fact-checking.



LEO:  Well, I hope they�re listening right now.  Hey, one last question.  Yeah, please listen, guys, wake up.  Wake up.  Blink is not available right now for Vista.  Do you have plans to make it available for Vista?



MARC:  Yeah.  We�re shooting right now towards the end of the year, basically.



LEO:  Okay. 



STEVE:  And Leo, you know no security-conscious user is going to be using Vista now anyway.  So...



LEO:  Well, I don�t know if that�s true.  Is that really true?  Would you say that�s true?  Don�t use Vista if you�re worried about security?



MARC:  No, I wouldn�t say don�t use it.  If you have Windows XP today, from a security perspective there�s not that much compelling stuff that I would say upgrade because of security.  If there�s some features that you think are interesting, I don�t know what those would be; but if there�s some features you think are interesting in Vista, then maybe you want to upgrade because of that, or just go get a Mac.



LEO:  But you�re saying an important - get a Mac, right.  You said an important thing, which is don�t upgrade to Vista for security.



MARC:  Yeah.  I think that one of the interesting things with Vista in general is that there really isn�t a lot of compelling features to upgrade to Vista versus XP.  I mean, most of the stuff is the same or, again, very much a catch-up to the Mac.



LEO:  Things like UAC doesn�t make a difference.



MARC:  No, things like UAC don�t, I mean, things like UAC is�- there�s even a lot of internal stuff at Microsoft where�there�s...



LEO:  Mark Russinovich has been saying that.



MARC:  Oh, yeah.  It�s an annoyance thing.  It has no real value.  And so I don�t think, you know, you should run out and purchase Vista because you want to be more secure.  That�s not the reason.  If you�re buying a new computer, and it comes with Vista, you know, by all means go for it.  It�s definitely not less secure.  But the hundred whatever dollars it is to get Vista, to do it based on security, I mean, there�s not enough.



LEO:  Sounds like your most secure situation is to run XP or Windows 2000 and Blink.



MARC:  XP and Blink.



STEVE:  And tell us what happens after the first free year as a Blink user, as a Blink personal user.  Is it then something that is affordable from then on?



MARC:  Yeah, so after that it�s - and you can even buy it now if you don�t want to send, you know, anonymous stuff to eEye, and you want support.  I believe the specific price is about $26 or so.



STEVE:  Oh, my God.



LEO:  That�s a good deal, yeah.



STEVE:  Leo, I think we�re going to sell a lot of copies of�Blink.



LEO:  Yeah.  I think that it�s very compelling.  You can�t, I should just say, we have a lot of listeners outside the U.S. and Canada.  I presume this is for legal reasons, you can�t get it outside the U.S. and Canada for free.



MARC:  For the free version, exactly.  We do have a restriction on that for a number of boring legal reasons.



STEVE:  And it�s lighter weight than the Symantec or the McAfee security suites.  I mean...



LEO:  Sounds like it�s much lighter weight, yeah.



STEVE:  That immediately - that really perked my ears up�immediately.



MARC:  Exactly.  I mean, we use, you know, when I was talking about all the layers that we have, we�re smart where, depending on what application and what attack, the layers don�t overlap themselves as far as effort on the computer.  So it�ll use less, not only RAM, you know, memory and whatnot, but also - so as far as the CPU performance and that sort of thing.  And I gave you an - actually Blink Personal after the year, or if you want support now, it�s $24.95 for one computer, or three computers is $29.  So.



LEO:  It�s a very good deal.  Thank you for making that so affordable.  That�s great.



MARC:  No, definitely, definitely.  So I�m hoping my mom stops calling me about - it�s funny, when we�re building stuff, when we�re adding stuff in engineering for stuff like Blink, I mean, there�s just as much features as we want to get done and complete just for our own network and protecting ourselves, and then also all of our, you know, family members.  We�re like, no, no, we�ve got this great thing, you know, on a personal level.  So...



STEVE:  Well, Marc, this has been absolutely fantastic.  And I am so glad that we followed up on once a few weeks ago saying, hey, you know, we ought to have Marc on.



LEO:  Yeah, it�s been really great.



STEVE:  This has really been good.



MARC:  No, definitely, I mean, thanks for the invitation.  I always listen to you guys.  And when we got the offer I was ecstatic.  So, I mean, I�ve known you guys both before, and you guys are doing a great job, man.  Keep it up.



STEVE:  Thank you so much.



LEO:  That�s Marc Maiffret, and the company is eEye.com.  You can get Blink if you go to the eEye.com site, and you click the Products button and drop it down, Blink Personal is the free one for folks in the U.S. and Canada.  And then you can also buy a license if you�re outside.  And I think 20 - what�d he say, 22 bucks?  That�s not bad.



STEVE:  20-something 95, you know, the marketing guys have been into it, of course.  I�ve got to say, you know, I am going to start recommending this.  What he talked about, the architecture of Blink, is so correct compared to always following behind and doing pattern-based, you know, download the latest security update and you�re not safe until then, this thing preemptively protects people.  And what I love most, you know me, coding everything in Assembly language, is that apparently, from what Marc said, this is dramatically lighter weight than any of the contemporary monster security suites.  So I think this gives you, I mean, certainly you want to be behind - I guess you want to be behind a personal firewall.  We didn�t really ask him if it�s also doing firewall technology because he did mention that at the enterprise level it has that, too.  But, you know, anybody with XP and Vista already has one.  I don�t know if it does outbound protection.  I�m going to have to study it a little bit.  But, boy, Leo, I think this is�terrific.



LEO:  Steve, any other items?  Next week we�ve got our Q&A;�right?



STEVE:  Yes, we�re going to launch into our Q&A.  And then the week after that we�re going to continue with a never-ending stream of hopefully fun and entertaining and interesting security discussion.



LEO:  Well, more people are listening all the time.  I was just taking a look at the numbers, and great growth, and we�re really glad that you listen to the show, and we hope you will keep listening.



A reminder, of course, that GRC.com is Steve�s home on the Internet.  That�s where you can go to find 16KB versions of the show for the bandwidth-impaired.  You can get transcripts.  I think this would be a great show to get the transcript of.  We�ll make sure Elaine gets to work on that right away.  We also have notes there, and previous shows, and Steve�s great free security utilities, things like SecurAble, that�s the new one, Shoot The Messenger, Unplug n� Pray, DCOMbobulator, and then the world-famous ShieldsUP, rapidly approaching 50 million uses.  You going to have a party for that or anything?



STEVE:  Oh, we�ll say hi.



LEO:  Woohoo!  You should give something to the 50 millionth user.  We can work out something if you want.  You want to have a prize package for the 50 millionth user?  Would your logs be able to tell you who that was?



STEVE:  No.  We�re at 49.816 million.



LEO:  At the rate that you go, how soon is that?  A week?  Two?  Three?  You�ve got a couple hundred thousand?



STEVE:  No, we do about 25,000 a day.  So it looks like it�d be about, oh, yeah, about ten days.



LEO:  Holy cow.  Holy cow, that�s really neat.  A horn should go off, anyway.  GRC.com.  That�s also where you�ll find SpinRite, which is the ultimate disk recovery and maintenance utility, a must-have.  And guys on the Geek Squad, don�t worry, you can get a license.  Just go there.  It�s very affordable.



STEVE:  We�re big on forgiveness here, Leo.



LEO:  Amnesty program.  Anybody who�s got SpinRite and doesn�t have a license just...



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#92

DATE:		May 17, 2007

TITLE:		Listener Feedback Q&A #19

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-092.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 92 for May�17, 2007:  Your questions, Steve�s answers, #19.



Time for Security Now!, everybody�s favorite weekly look at the world of security.  Not just Windows security, but all kinds of security for technology for computers and the Internet.  Steve Gibson is our genial host, the security expert at GRC.com, the creator of ShieldsUP and so many great free security utilities and, of course, the great SpinRite hard drive maintenance and recovery utility.  Hello, Steve.



STEVE GIBSON:  Hey, Leo, great to be back with you again for, boy, we�re approaching 100 here.  



LEO:  Oh, we�ve got to do something for the 100th.



STEVE:  Yeah.  Well, actually I do have a surprise.



LEO:  Oh, good.  That�ll be fun.  Well, that�s not so far off.  But meanwhile, as every fourth episode, every mod 4 episode, we do our listener questions and answers.  We�ve got quite a few brilliant, inspired questions.



STEVE:  Actually I think this is going to be a really good collection of questions.  I assembled them, and we ought to mention that I had said last week that we�re going to begin doing sort of a mailbag-and-errata section at the beginning because I�m getting so many just nice, you know, they�re not questions for the Q&A, but they�re just informed comments and opinions on things.  So I don�t have anything other than a fun little SpinRite anecdote to share this week.  But in future weeks I�m going to take the time to read more of my mail and always have a couple fun things to share at the�beginning.



LEO:  Good, I look forward to that.  That�s great.



STEVE:  Someone named David Ward, who actually is with a computer company, WellMax computer, said, "I had a friend bring a laptop to me and tell me that the fan was failing.  The machine would freeze after about five minutes into the Windows XP boot process."



And my first thought was, okay, well, if Windows is taking five minutes to boot, the fan may not be your only problem.  But, you know, it does seem like...



LEO:  Five minutes into the boot process sounds like it�s laboring, yeah.



STEVE:  Five minutes into the boot, exactly.  So he says, "He had taken it to three other techs who all said the same thing, that the fan was failing.  I experienced the same problem.  However, after booting into safe mode and having the machine stay on for an hour, I knew it was not a fan issue, but a hard drive issue."



So apparently he was able to boot into safe mode and not encounter whatever driver was being loaded that was having a problem with the hard drive and causing this trouble.  So he says, "Sure enough, after running SpinRite" - get this - "for over 180 hours..."



LEO:  Oh, that�s dedication.



STEVE:  Yeah.



LEO:  It slows down when there are disk defects; right?  I mean, it has to work harder.



STEVE:  Yes.



LEO:  Because it doesn�t normally take that - I want to emphasize this.  It doesn�t normally take that long.



STEVE:  Oh, it�s often a few hours, maybe seven or eight.  But it is absolutely a function of the condition of the drive.  What�s going on is that while we�re doing data recovery, I suppress the drive�s normal intention to relocate a damaged sector somewhere else.  Because once it does that, that sector is then unavailable.  You can�t ever get the data back.  It�s gone.  So I do a bunch of low-level commands to say to the drive, okay, shut down relocation, don�t move this away till I�m through with it.  And the point is, I�m never going to have another chance to get the data back because ultimately I want to recover everything possible and then let the drive remove this damaged sector from use so that the data that I put back is being put back onto a swapped-in spare sector.  So there�s much more going on under the hood than is apparent from the fact that SpinRite just sort of scans over the drive.  But it will sometimes stop and just crank on a single sector for quite a while and then pick up speed again and typically finish much more quickly.



Anyway, of course, this story has a happy ending.  He says, "It finally finished and found many bad sectors."  Which is the point.  SpinRite was, you know, working hard.  He says, "However, it booted successfully then and ran very well.  All the customer could do was shake his head and utter the phrase, �Amazing,� several times."  Of course I guess the customer had to come back a few days later.  But at least he was amazed.



LEO:  180 hours later.  That�s like a week later.



STEVE:  So I just - I love the stories, so keep them coming.



LEO:  Shall we start with the questions, sir?



STEVE:  You betcha.



LEO:  Starting with John Jones from Willington, Connecticut.  He�s wondering about the future of IP, Internet Protocol.  He writes:  Now that we all know about IP addresses and networking, could you tell us about IPv6, what it means to the little guy?  Do we have to go out and buy new routers?  What is it?  How�s it going to affect us?



STEVE:  It�s a great question.  The good news is, I can�t imagine anything that will be more transparent.  Essentially, IPv6 does a number of things.  First of all, it dramatically expands the so-called IP space, that is, the number of bits in an IP address.  It takes it from 32 to 128.  So, now, because every bit you add doubles the number of total combinations, because you have all the combinations you have with the bit off, and now all those combinations again with the bit on, so each binary bit you add doubles.  So 32 compared to 128, I mean, even though it�s "only" four times longer, I mean, it is - I don�t even have the number on-hand, how many IP addresses that is.  It�s just a gazillion gazillion gazillion.  So whereas 32 bits, of course, gives us 4 billion, 4 gig, IP addresses.  And that�s kind of a familiar number.  That�s, for example, the most RAM you can put in a lot of systems is 4 gigs, so forth, because they�re 32-bit addressing.  So, first of all, it solves the concern that many people had a decade ago that the world is going to run out of IP space.



LEO:  I remember talking to Vint Cerf, the father of the Internet.  And that�s exactly what he said.  He said we have to go to IPv6 - this was probably about almost 10 years ago�- because we�re running out.  Turned out not, didn�t it.



STEVE:  Yes, yes.  What happened was NAT, Network Address Translation, that we�ve talked about so often, completely changed that landscape.  I�ve got, I don�t know, 13 computers here, Leo.  And they - actually I have a block of IP addresses because I�m not a typical user.  But...



LEO:  Well, use me as an example.  I have that Astaro Security Gateway and probably a dozen computers coming off of it with one IP address.



STEVE:  Yes.  And so the idea that you could use port mapping in order to disambiguate data crossing a NAT router, that really dramatically reduced the pressure on the IP space.  But again, it really looks like the Internet is here to stay.  It�s not a passing fad.  And so everyone figured,  hey, you know, let�s just solve this problem.  And they solved it by making the addressing space so big that no one ever needs to worry about it running out.



LEO:  I think Vint said that every molecule in the universe�- or, no, the galaxy - could have its own IP�address.



STEVE:  It�s on that level.



LEO:  It�s a large number.



STEVE:  Yeah.  So people will have no problem with IP-enabled refrigerators and washing machines and toothbrushes here, which, you know, Bluetooth stuff.



LEO:  I imagine that�ll happen, so it�s a good thing.



STEVE:  So the first thing it does, the first thing IPv6 does - I don�t know what happened to 5; 5 just never happened.  Because we�re on IPv4 now.  And also 1, 2, and 3 sort of happened without anyone knowing, before the Internet all actually happened.



LEO:  It�s off with 802.11c getting drunk somewhere.



STEVE:  Okay, good, I believe that.



LEO:  They never used us.



STEVE:  So in addition to a much huger addressing space, the only other real changes are that a number of things which were add-on sort of after the fact, things like IPSec security, which we�ve talked about extensively, which are not part of the IP spec, they were, you know, grafted-on protocol layers that would run on top of IP.  That technology and additional authentication technology has been sort of subsumed by the formal spec.  So good, useful things that no one back at the IPv4 era could have anticipated, with IPv6 they�re brought into and made standard in a robust fashion.  So that�s really good.



Now, the reason I don�t think this will ever be anything other than transparent is that we�ve still got a long way to go before IPv6 is what actually runs everything.  And it can be transparent because the existing IPv4 addressing space just tucks into one little itty-bitty corner of IPv6, which is to say that IPv6 was designed as an upward-compatible extension on IPv4.  So that even if you had an IPv6 for a so-called backbone, for example, running across the country, that IPv6 backbone can carry IPv4 packets with no trouble at all.  Basically you just put a whole bunch of zeros on the front, and IPv4 lives in a little corner of IPv6.  So packets can come in and go out of IPv6 with no trouble at�all.



Similarly, when consumer routers need to be upgraded, the consumer router can simply have a firmware update that does the same thing, that is, it could be IPv6 aware on the inside and the outside, and perform that cross-version transform easily in either direction.  So maybe at some future point, if you had an old IPv4 router and you were using some next-generation ISP, even if they needed you to be using IPv6, you could upgrade your firmware or go out and spend another 40 bucks to get an inexpensive router.  It�s not like there�s anything about IPv6 that is more expensive.  And Vista already fully supports IPv6.  That was an add-on in XP. You could add the IPv6 so-called stack into XP.  In the case of Vista, it�s right there, built in, and running all the time. So if you ever plugged a Vista system into an IPv6 system, it would just work natively IPv6 without even needing to perform the 4-to-6 and 6-to-4 translation.



LEO:  Whatever you say, I agree.



STEVE:  So there you go.  Basically it will have no effect on anyone.



LEO:  It�s just going to happen, and don�t worry about it.



STEVE:  I was just looking at the last line of John�s question.  He says, "What is it, and how will it affect us?"  So that�s what it is, and it�ll have no effect.



LEO:  No effect.  Rick in Atlanta says he has something to add about multifactor authentication, what we talked about last - actually two weeks ago now on the podcast.  Listening to the multifactor authentication episode - that�s Episode 90 - I wanted to bring attention to a method that was not mentioned, possibly because it may be unknown to you both.  It�s the method of using IP intelligence - oh, boy - geolocation, domain information, velocity checks and so forth to determine a risk factor for an online transaction.  And it all works transparent to the user, which should make Leo happy as it is his biggest complaint of SiteKey.  Do you know about this IP intelligence?



STEVE:  Yeah, it�s an interesting additional factor.  Now, of course two weeks ago we talked about multifactor authentication.  And in a couple weeks we�re going to have an episode titled "The Fourth Factor," which actually is different than this one.  But this is an additional factor.  Consider, for example, Leo, that you�re using a system, as you were with SiteKey, to hook onto BofA.  Well, we do know that they will prompt you if your IP address changes and if the Flash cookie that they�re using doesn�t match up.



LEO:  Right, yeah.



STEVE:  But consider that they saw you were connecting from China.  Now, I don�t mean to be a...



LEO:  That would be a bad thing.



STEVE:  I don�t mean to pick on China.  I mean...



LEO:  I might be going to China.  But in most cases it�s somebody else.



STEVE:  Yes.  And so what this IP intelligence is, is it�s a really interesting service that a number of vendors are offering as sort of a third-party provider where they�re able to say, do we believe this person is in Northern California?  No, this person appears to be on some island in the South Pacific somewhere.  So it�s like, whoops, wait a minute, we�ll provide that information to the party that�s interested in doing authentication, just so they know maybe to raise another red flag.  So it�s a very cool solution because, you know, we know that in general people are going to stay relatively local.  And so even though you�re not guaranteed of that, you could certainly factor that information into your decision about whether to trust somebody connecting based on where they�re located.



LEO:  He mentions velocity checks.  Does that mean something like how long or how many servers it�s going through or how long it takes the traffic to go from...



STEVE:  You know, I�m not familiar with the term.  I saw that, too, and didn�t take any time to look it up.  So...



LEO:  But it makes sense.  If something�s out of the ordinary about this transaction, put up a few extra questions.  And that�s exactly what Bank of America does.



STEVE:  Well, and the point is, why not take advantage of all the information you have?  Certainly the IP of the person connecting to you, that is something, as we know, that cannot be spoofed because you need a direct connection to your machine.  Now, you could be running through multiple layers onion routing, or any other kind of proxy server.  So that�s an issue.  Although, if it�s a secure connection, as we assume it would be, an SSL connection, that cannot be routed through onions because you need to have a matching certificate from the far end.  So that�s a non-spoofable IP address.  Why not factor the connector�s IP into the whole thing?  Thus IP intelligence.



LEO:  If I�m a good hacker in China, I�m going to be darn sure that my IP address doesn�t come from China.  But that�s another matter.  Listener Ian Williamson of Ottawa, Canada, has an important observation for us to share with our listeners.  He says:  Since making the changes to maintain WiFi radio silence - actually a term I think you coined.



STEVE:  I think that was, yeah.



LEO:  I have noticed, he says, that my laptop has much more difficulty connecting to and staying connected to a weak signal from an access point.  In other words, its wireless performance is poorer than the other laptops in the same situation.  By rechecking the box for "Connect even if this network is not broadcasting," I find that the weak signal performance is better.  Maybe there was some method in Microsoft�s madness of not making these updates standard issue.  You agree?



STEVE:  Well, I don�t know, but I wanted to share this with all of our listeners, since back - I think it was Episode 86 we were talking about how to get a laptop to be completely radio silent so that it would not be broadcasting the fact that it exists.  That�s the checkbox you need to turn off after you�ve updated yourself to the very latest set of software from Microsoft, their WiFi update, which is not part of the normal Windows Update process.  So it�s by turning that off, and that�s what you have to do to keep your laptop from having its own beacon where it�s broadcasting its identity.



Now, I can�t state why that would have an effect on connectivity.  I mean, you can kind of see, well, okay, maybe the access point, if you�re not sending out a beacon, the access point could be configured to drop you, except he�s saying that it�s a function of signal strength.  So it sounds sort of questionable to me.  But if any of our listeners have experienced the same thing, I absolutely wanted to share it.  And I�ll be looking for any additional feedback from people to see if other people can duplicate this, or if there are people who are not seeing it.  I know from my own experience I�ve not noticed that kind of issue.  And I�m using WiFi much more now that we have WPA and I�m willing to use it at all.  And it just works fine for me with all that stuff turned off.



LEO:  Anybody who has anything to do with RF knows it�s completely a black art.  No one understands why anything works or doesn�t work.



STEVE:  Well, Leo, radio can�t work.  I mean, figure it out.  You have no wires.



LEO:  There�s no wires.  And people, RF engineers, you know, and I�ve worked with them for years in radio, RF engineers, you know, these guys, they hear something new every week, you know, that just - oh, really, you�re hearing the station in your teeth, eh?  Okay.



Dave McGee of Toronto and various hotels, apparently, around North America, asks:  I have a question about unsecured wireless networks.  At home I use WPA with a 63-character PSK.  Obviously a long-time listener.  The issue is I�m never home.  I travel for work and rely on unsecured hotel WiFi for all my work and personal Internet access.  What would you recommend I do to secure myself when on these networks?  I�m guessing Leo could use some advice on this, as well, as he travels a lot.  P.S.:  SpinRite rocks.  It saved a drive at work.  Thank you, thank you, thank you.  Well, that�s nice.



STEVE:  Well, we certainly understand his problem, and we�ve talked about this before, but I thought it was worth reiterating.  If you�re on the road, even if you were able to use WPA, for example, to connect to a hotel�s wireless network, you�re participating in a massive network which is fundamentally spoofable.  The problem is, and we talked about this, as I mentioned before, is ARP spoofing, which allows one person in a network to potentially insert themselves as a man in the middle by sending packets to the various endpoints, tricking their ARP tables into believing that it is the holder of the IPs coming and going so that they send all their traffic through you.  It is a trivial thing to do.  It really exists.  There are free tools now on the �Net for allowing people in this situation to knit themselves in.



So the only thing you can do is make sure that your connections themselves are secure.  Meaning, for example, if you were using Google Mail, you want to use secure Google Mail, https://mail.google.com, or you want to use some sort of a VPN.  Ultimately that�s the right solution is to use one of the free or commercial third-party VPN solutions, where you have a VPN client running on your laptop in the hotel room.  It�s connecting out through the hotel network to a publicly located VPN server.  And we�ve talked about HotSpotVPN as one that Leo and I have both used with great success in the past.  That way your traffic is going through an encrypted tunnel until it gets way out of the hotel LAN environment, which is so vulnerable, and out onto the public Internet.  Then it�s decrypted, and your traffic then emerges onto the Internet well away from the hotel.  That�s really - a solution like that is the best approach.



LEO:  And if you�re a business traveler, often you have a VPN through your business that you could use.



STEVE:  Back into your corporate network.



LEO:  Right.  And then you could surf out from the corporate network.  But, yeah, it�s a little scary, I mean, the idea of using somebody�s open Internet access.  And as we talked about, hotels are crazy.



STEVE:  Well, and there have been security researchers who have just sniffed the traffic in their hotel room, and over the course of an evening captured 180 log-on names and passwords and servers from other hotel guests.



LEO:  Yeah, she�s famous for that.  Just for fun she does�that.



STEVE:  Exactly.  Remember that?  Just sort of plugged in to see what was going on.



LEO:  Moving on, A Student who loves Security Now! in rural Alberta wonders:  On SQL injection exploits, do scripting languages like, say, Perl, PHP, or VBScript have the language constructs to allow sanitization of users� input?  Yes, by the way, they do, in many cases.



STEVE:  Yes.



LEO:  Where do I find the links that you alluded to during the podcast?  On the dangers of cross-site scripting, would you be able to rate and compare the various popular scripting languages with regard to the degree of their insecurity, assuming it could be quantified at all?  This is one for Randal Schwartz, who is a regular listener and a Perl guru.



STEVE:  Well, and it�s a great question.  The only comment I guess I would have is that, first of all, yes, as you said, any language which is doing this has string operators and the ability to process strings and could be used to purify the user�s input data, which as we saw before when we were talking about SQL injection exploits, that�s where the problem occurs.  So any language can be used to do that.  If I had to respond to which language is better, I would say, well, there�s really no difference because every language is equally able to do this.  The only thing I would say is, well, it�s entirely a function of the programmer.  The safer language might be the one that tends to have the more security-aware programmers.



LEO:  It�s all about the programmer, absolutely.  Every language has the tools.



STEVE:  Yes.



LEO:  Perl has some great - go to CPAN, and you look at the CPAN modules, there are great modules for doing this, like LibWeb.  But, you know, a programmer has to use them.



STEVE:  Exactly.



LEO:  I remember talking to the guy from w00w00.  I can�t remember his name.  Like eEye.



STEVE:  You sure remember where he came from.



LEO:  Yeah, great security company like eEye, and he�s a young guy.  He said, look, it�s simple.  Instead of using strcpy, use strncpy.  I mean, it�s little things.



STEVE:  And Leo, I forgot to mention this.  I really haven�t had an occasion to.  But in reading some background that I was reading in the last few weeks, I ran across the formal statement that Microsoft went through, and in Vista they removed every single instance of strcpy.



LEO:  Because that�s clearly an invitation to a buffer�overflow.



STEVE:  Yes.  The idea is, for those who are not C programmers, or programmers with a similar API, strcpy stands for string copy, where you give it a pointer to the buffer containing a string, the pointer to a buffer of the destination for that string to be copied to.  And C strings are zero-terminated, that is, null-terminated.  So the strcpy command will copy all the characters from the source buffer to the end buffer, up to and including the final terminating null, or zero byte.  The problem is, you could see, if you gave it an extra long source string, and the program was expecting a shorter destination, it was expecting a shorter string so it gave it a smaller destination buffer than a source buffer, you could easily - well, the program would just keep on copying right over past the end of the destination buffer.  Strncpy has a third parameter.  You not only give it a pointer to the source buffer and a pointer to the destination buffer, but a maximum character count to copy.  So you give it the size of the destination buffer.  And no matter what, even if it hasn�t yet encountered a null-terminating byte in the source string, it�ll stop copying at the maximum character count that you give it.  So it�s really interesting.  I thought when I read this, it�s like, bravo, Microsoft.  I mean, that must have been a...



LEO:  It shouldn�t even be allowed.



STEVE:  Must have been a ton of work, though, to go back through and change all that.



LEO:  But at least that you could kind of do with a global, you know, searching for strcpy and find them all.  It was Matt Conover, by the way, from w00w00 who told me that.  And by the way, you use a language that is probably the most difficult to do this in, Assembly language, because you have to do this all by hand.



STEVE:  On the other hand, since I do have to do it all by�hand...



LEO:  You know exactly what�s happening.



STEVE:  Exactly.  And I�m always having to be aware of that.  So it�s not like I�m tricked into, you know, lulled into a false sense of security by, oh, well, I�m not really going to worry about this.  I mean, I�ve got to worry about everything all the time.



LEO:  You range-check everything.



STEVE:  Yes.



LEO:  Matthew Dwyer listens and writes from New Zealand.  He�s a Kiwi.  I�ve heard you guys mention you don�t run a software firewall at all, instead putting your trust behind  your external router - or in my case my Astaro Gateway - as a hardware firewall.  I have a properly configured external router, but I�m nervous about running without a software firewall.  Should I really get rid of the software firewalls on my LAN?



STEVE:  Well, this is a question we�ve had before.  But it keeps coming up.  Like you, Leo, I don�t run a local software firewall.  Although frankly, after...



LEO:  I turn on the Windows firewall.  I leave it on.  So that�s - maybe I�ve changed my tune.  But now that it�s on by default in Vista, I just leave it on.



STEVE:  No, I absolutely agree with you.  And in XP - it�s on on all of my laptops where I�m running XP.  There�s no reason not to do it.  The problem is that something like one of the big, heavy security suites is just so cumbersome now.  I mean, I really hear reports from people talking about how they removed - and I don�t mean to pick on McAfee or Symantec, but those are the big guys.  They removed them, and their system, it�s like young again.  So I guess my point is...



LEO:  ZoneAlarm has become like that, too, unfortunately.



STEVE:  Unfortunately it�s not something that I any longer can in good conscience recommend.  It�s certainly gone a long way from 2.61, which was, you know, the version I loved so much.  So a software firewall that does outbound blocking is really, I mean, that�s the key.  Everybody�s got incoming blocking, whether from a router or from your existing XP or Vista personal firewall built into the OS.  The real issue is outbound protection.  And there are lots of people who just love having it on their system.  They like the idea of needing to give permission to programs in order to get outbound connections to the Internet, which I fully understand.  I�m taking the gamble of being really careful that nothing evil gets in because my whole theory is, once that happens, it�s over anyway.  I mean, it�s too late.  So the issue is that.



Now, the one caveat is intra-LAN protection.  If none of your machines had any personal firewalls running, and something evil got on one of them, it could much more easily spread to the other machines on your LAN if you had no protection.  So I would say at the very minimum use the firewall built into Windows, into XP or Vista.  And if you wanted an additional layer of protection, add a software firewall.  But I really think, if you protect yourself, you�re careful about where you go on the �Net, what you click on, and what you do, you know, I just - I�ve never had a problem.



LEO:  So there are really two compelling reasons that you might want to run a software firewall.  One of them is kind of dubious, and that is for outbound protection.  But since many malware programs now look for the firewalls and around them, so forth, and because most people just go yes yes yes yes yes, or as our guest last week said, no no no no no, that�s of dubious merit.  The one thing that is of value, and the reason I turn on the Windows firewall, is this intra-LAN infection.  So if you bring an infected laptop into your office, well, it�s inside the router, and so it could infect all the computers unless they have firewalls turned on.



STEVE:  Exactly.



LEO:  So there is a good reason to leave the Windows firewall on.  And I don�t think outbound protection is - fortunately, I don�t think it�s particularly compelling�anymore.



STEVE:  Nope.



LEO:  Dusan Maletic of Babylon, New York raises a great - and distressing - point:  During your multifactor authentication discussion, one comment utterly surprised me.  Utterly.  Did I emphasize that sufficiently?  Utterly.



STEVE:  He picked himself up off the floor and went over to send us this note.



LEO:  You�re willing to provide biometrics for such low-priority needs as boarding the airplane.  Not only does this info contain essential personal identification - actually it�s not for boarding the airplane.  I�ll explain what it�s for.  But anyway, not only does this info contain essential personal identification, but it will be stored at such low security level that it�s almost certain this data will be stolen or manipulated at the servers for nefarious purposes.  A good point.  I won�t gainsay that.  I should mention that the - and by the way, it�s not a retinal scan.  I misunderstood that.



STEVE:  Yes, it�s an iris scan.



LEO:  It�s an iris scan.  A retinal scan is much more complicated.  But an iris scan.  And it isn�t for boarding the airplane, it�s for customs.  It�s for crossing the border.  Although, of course, you�re getting on and off an airplane often, but not necessarily.  Leading to the ultimate identity theft.  How to prove you are who you are if someone alters your biometrics data.  Oh, that�s - I didn�t think of that.



STEVE:  Yeah.



LEO:  Only the most - this guy�s been reading too much Philip K. Dick.  Only the most demanding security access should be associated with biometrics, if any.



STEVE:  So I think he raises a great point that I wanted just to discuss here.  And that is, as always, there�s the issue of risk versus reward.  There certainly, you know, you and I were talking two weeks ago during the multifactor authentication episode that, hey, it�s like, yeah, let�s all give, you know, random people our iris print...



LEO:  Good point.



STEVE:  ...so we don�t have to wait in line.



LEO:  Not a good idea, right.



STEVE:  And so the idea is - and again, I think he makes a�good point.  Consider the tradeoff, the idea that, well, yes, now...



LEO:  But which is easier to steal?  My passport or my iris?



STEVE:  Well, you�d really miss your iris if it were stolen,�Leo.



LEO:  No, I�m just saying that I think the passport is in even less secure hands.  Mine.



STEVE:  Yeah, well, but remember, that�s physical, and physical is always a different domain than electronic.



LEO:  True, but this is multifactor.  They want your iris and your passport, so...



STEVE:  That�s a very good point.  Although I guess the idea being that, you know, somebody could - if you were known to have your iris print on the server, and somebody wanted to keep you from going...



LEO:  They could mess with me, yeah.



STEVE:  ...to Vancouver, you know, they could put some dog�s iris scan in there, and...



LEO:  It wouldn�t match.



STEVE:  ...chances are it wouldn�t match.



LEO:  I wonder.  Nexus must have some procedure for that.



STEVE:  Well, and this guy talks about low security level.  And of course it�s going to get stolen.  It�s like, okay, well, yes, I mean, certainly after listening to Marc two weeks ago, I mean last week...



LEO:  Everything is going to get stolen.



STEVE:  It�s like, aagh.



LEO:  Well, and the TSA - this isn�t the TSA, again, this is Canadian government, Canadian Customs; and U.S. government, U.S. Customs.  But the TSA did, just a couple of weeks ago, lose a hard drive with all of their employees� information on it - Social Security numbers, name, address, everything.  So, I mean, the TSA is not so very different from what this is.  So he makes an excellent point.



STEVE:  You know, if they had to replace all those TSA employees because of their personal data being lost, that would be kind of okay.



LEO:  I have to go through the TSA checkpoint next week.  I�m not going to say a word.



STEVE:  Okay, cut that from the recording.



LEO:  You know, I�m sure there are TSA employees who listen.  And, you know, for the most part they�re very jolly, nice people.  I don�t blame them for the stupid laws that require me to take off my shoes.



STEVE:  True.  And, you know, I actually - I say, look, there�s no metal in them.  Let me just walk through your scanner.  It won�t even bleep at all.



LEO:  Do they let you do that?



STEVE:  Yeah, they do.



LEO:  They still won�t let you bring a bottle of water in,�though.



STEVE:  No.



LEO:  And, you know, that one baffles me.  Don�t get me started.  Don�t get me started.  TV Indy of Muncie, Indiana has a question about TiVo operation.  Steve.



STEVE:  Just to change the topic.



LEO:  Just a little light, upbeat subject.  I�m not sure what you said about TiVo in Episode 90 is correct.  Does it really write to the hard drive 24 hours a day?  My impression is the 30-minute buffer only exists in RAM.  It is only when you choose to record a program in progress that the contents of the RAM are written to the hard drive.  Unless the program�s being recorded and stored for later viewing, I doubt that anything�s being stored on the hard drive.  My parents have a TiVo that�s been running continuously for nearly five years, and it�s the original drive.  Would it even be possible for a hard drive to survive that long if the head stayed in continuous motion for that period of time?



STEVE:  I�m absolutely positive that the TiVo is reading and writing continuously.  Our listeners may not know, but I know you know, Leo, that I have three heavily hacked TiVos.  I�ve got original Series 1 TiVos with my own expanded Linux kernel that�s able to go beyond the 137 gigabyte boundary.  Each of them has a single 500-gig drive.  And one of the hacks you can perform on the TiVo is to change that 30-minute buffer so that, for example, it�s an hour or two.  Especially the Series 1 TiVo has very little RAM, just enough to hold the Linux kernel, and an hour or two of video at high quality is many, many gigabytes of storage.  So it�s absolutely the case that TiVos are continuously writing and reading to and from this buffer on the hard drive.  And, yeah, it does create wear and tear for the system.



One of the things that I do, because I�m sort of fanatic about hard drive life, is if I�m ever unplugging my TiVo, I will manually reset it and then pull the plug because I want to shut down the fact that it�s continually writing.  Otherwise you risk damaging the hard drive if it�s writing while you pull the power.  So I manually restart the TiVo, then pull the plug, just because, you know, why not.



LEO:  It�s really - it is amazing.  That�s probably one of the hardest environments.  Not only is it writing all the time, but it�s hot in there.  They get very warm, those�drives.



STEVE:  They do.



LEO:  There�s a little fan, but it�s a little fan.



STEVE:  All of mine have big copper heat sinks with a secondary fan, a heat sink on the back of the drive itself in order to pull the heat out of the drive so that the little case circulation air has a chance to keep things�cool.



LEO:  That�s a third-party add-on you did.



STEVE:  It�s a me party, yeah.



LEO:  He�s the third party.  What, did you cut up a car radiator?  What did you do?



STEVE:  No, I actually took P4 heat sinks.  And it�s all jury-rigged, but it works great.



LEO:  I�d love to see your TiVos.  Just there must be stuff sticking out all over.  Ted Hosmann of Monterey, California brought up a fantastic point:  I just listened to your multifactor authentication episode.  Loved it.  The process of swiping a badge and using hand recognition to enter a  building is the same process we use at my job.  I work in a  building that embosses over two million credit cards each month.  Whoa.  And we have about 15 million blank credit cards on hand.  Oh, boy.  Where is this?  A variance to the secure entry that we use is when we swipe our card it opens one side of a tube that we have to stand inside in order to have our hand scanned.  Once we pass the hand scan, the tube has another set of doors that open into the building.  Oh, that way you can�t have somebody follow on.



STEVE:  That�s exactly it.  And he�s about to explain that.



LEO:  One thing that most employees don�t realize is, once they step into the tube, there�s a weight sensor in the floor to determine if you�re letting someone tailgate into the building on your scan.  Wow.  It would be extremely difficult to explain to the security people why I weighed 350 pounds one day and 200 every day before and after that.��Wow.



STEVE:  Isn�t that interesting?  And it brings up a point that I had not mentioned.  But when I was setting up my account at our server facility at Level 3, coming up on two years ago - it was two years ago after Memorial Day - they specifically said, you know, you want to keep this place as secure as we do because your crown jewels are inside here, too.  So, you know, even if somebody�s getting out of a car and walking over with you at the same time, do not let them tailgate.  You know, you do your card, do your hand scan.  Then, you know, turn to them and say, I hope you understand, you�re going to have to do this yourself.  Walk through the then-unlocked door and close it firmly and lock it behind�you...



LEO:  It�s hard to do.



STEVE:  ...to force them to - it is.  But Leo, it�s happened a couple times, and they understand.  They appreciate that I�m keeping them safe and their equipment safe, just as I hope they will do the same for anybody else.



LEO:  Yeah.  Ryan Sullivan in New York is worried about and apparently having some trouble with WiFi security.  He writes, I listen to your show regularly.  And when you started talking about wireless security and how unsafe WEP really is, I frantically tried to change my wireless security to PSK-AES encryption that you were talking about.  That�s a form of WPA.  But I have one big problem.  Nothing can connect to my router when it�s encrypted in AES.  My devices can detect the network and then allow me to type in the new password, which I got from your passwords page.  But then after that they won�t connect to the �Net.  The main device that is annoying, since I use it most often, is my Nintendo Wii.  Oh, well, the Wii is notorious for not supporting WPA.  I always use it to watch things like YouTube videos on my nice big TV.  I�m paranoid about security and would hate to revert back to WEP now that I realize how unsafe it really is.  I have no idea what to do.  Any help, if it can be spared, would be greatly appreciated.  Well, I�ll just add that that is a problem with some hardware, including the Wii.



STEVE:  Yes.  Now, one of the things he said, though, which is the reason I wanted to put this in here, is that there are two versions, or essentially flavors, of WPA security.



LEO:  I�m sorry, the Wii does do WPA.  I was thinking of the Nintendo DS.



STEVE:  Ah, okay, exactly.  But there are still two flavors.  I don�t know if the Wii does both.  Because the original move from WEP to WPA, the people who architected this were very conscious of the fact that they wanted to fix WEP in the worst way because WEP is, you know, the worst WiFi security.  But they were conscious of the fact that low-end WiFi cards or hardware might not be able to support AES encryption just due to the substantial processing burden that AES imposes.  It is a lot more math to be doing compared to the relatively and extremely lightweight RC4�encryption.



Now, we�ve talked about RC4 encryption, how it�s a pseudorandom sequence generator which is part of the reason WEP is so badly broken.  This episode that he was talking about was, you know, how WEP is even more badly broken than we knew, and it�s now possible to basically, don�t even worry about the WEP key, just crack it in 60 seconds, and you�re onto the network.  So but the point is that the original WPA spec had something called TKIP, Temporal Key Integrity Protocol, which fixes the problem with WEP while still using the lightweight RC4 pseudorandom number generator to generate random bitstreams for XORing into the user data.  Which means that it�s very possible that lightweight older hardware and things that this guy may not be able to get to work with the stronger version of WPA, sometimes called WPA2, it would probably still work with TKIP.  So what he�ll probably find, if he�s got a device, is that he may have a choice, and certainly his router will, his wireless router, between TKIP encryption and AES.  Some would argue...



LEO:  The Wii does both, by the way.  The Wii does AES, WPA2, and TKIP. 



STEVE:  Okay.  So one thing I would recommend, then, is - okay.  So first of all, just to finish that thought, his wireless router will have TKIP and AES.  There is absolutely nothing wrong with using TKIP.



LEO:  Go ahead and use it, okay.



STEVE:  Yes.  It, too, was designed by the geniuses, the security guys who finally came along and said, okay, we really need to stop using WEP.  Let�s fix WEP completely.  And they did this in WPA, even in that first version that did not support the arguably stronger AES.  Again, TKIP is all you need.  It�s all I use.  And you know how frantic I am about the whole issue of WiFi security.



So the other thing I would tell Ryan is try using a simpler key first.  That is, I love it that he�s grabbed one of those humungo-jumbo 33-character monsters from my passwords page.  But it could be that some of his devices are not properly hashing that into the WPA key which is actually used.  So, I mean, try using your dog�s name for ten minutes.  It won�t hurt you to just try it for ten minutes.  No one�s going to do a brute force attack on you in that length of time.  Or just make seven or eight random characters.  That�s even better.  You know, your initials, your three best friends� initials or something.  Because that�s certainly going to be plenty safe.  Try setting things up with a simple key just to get everything working.  Then experiment with strengthening the keys, making them longer, making them contain more complex characters, until you discover what�s making one of those devices break.  And then back off to the best key you can use for that device.  And you�re still going to be safe enough.



LEO:  So the most important takeaway here, though, is it�s perfectly fine to use TKIP.



STEVE:  Yes.



LEO:  The key is WPA.  You don�t have to worry.



STEVE:  There�s no known weakness in TKIP.  People like AES because it�s, ooh, it�s new.



LEO:  Super secure.



STEVE:  It�s fancy.  But it�s like, okay, RC4 actually, once you allow it to get going, and it spits out 256 random bytes, from then on it takes something like 2 billion bytes of analysis of what RC4 is generating even to know it�s not truly absolutely random, even to be able to detect that it�s a pseudorandom sequence generator.  I mean, it�s really good.  It just needs to be used right.  And these problems were solved in WPA, even with TKIP.



LEO:  Russell Gadd in the U.K. writes:  Steve, you said you carry around your WPA WiFi password in a little file on a USB dongle, which you then cut and paste into Windows or your WiFi router when it asks for your password.  As you are exposing this file to your system for a while, and also passing the password through the clipboard, isn�t there a risk of it being cached somewhere on the system which could later be found by an attacker?  Isn�t this just as risky as storing your passwords in a plain text file on your PC?  I ask you, Mr. Gibson, maybe you regard this as no real risk, as someone getting into the files on your PC has already compromised your security?  To me it just feels a little less secure to open the file with some text processor and do this cut and paste, rather than remembering some difficult-to-guess password and typing it in directly.  What do you say to that, Mr. Gibson?  Mr. Security Expert?



STEVE:  I mean, he�s got a point, that I am using the clipboard.  Now, as it happens, I always overwrite the clipboard after I�ve done a cut and paste.  That�s just sort of something you learn from - I picked this up, I think actually it was TrueCrypt that first alerted me to the notion because those guys really thought of everything.  And they deliberately cleared the clipboard as one of the things that they�re taking care of.



So, yes, I am using the clipboard, rather unavoidably, in order to cut and paste my 63-character WPA password into whatever OS or router I�m configuring.  There just isn�t a way around that if I want to use a really hairy password like that.  And you could argue that, even if you type something in, I mean, we�re hoping that the other software does the right thing with the password you give it.  Sadly, it turns out there are many instances of security software storing on the hard disk, in the registry or one place or another, unencrypted passwords.  So again, this process is all moot.



Now, he brings up the point that, you know, am I not worried about this because, once something�s inside, then all bets are off anyway?  It�s like, well, yes.  I mean, the point of wireless is that you�re using your wireless password to protect your wireless domain so that nobody on the outside can connect to your network.  So there is no way for anyone to get your password unless they�re on the inside.  Now, backing off from that a bit, as Marc told us last week, Marc Maiffret of eEye, he�s all about all these basically internal exploits.  He recognizes that that�s the next frontier for exploitation, which really is what we�ve been talking about, and I have been saying, harping about browser scripting for so long.  I mean, clearly the problem now is people inviting these things into their systems unwittingly.  So you would like to not have software that got inside able to find your password and do something with it.



So all you can do is all you can do, which is, you know, get a good password and eliminate it from the clipboard because there have been exploits, in fact, where malware will export your clipboard, see what�s on your clipboard and send it out, just because oftentimes there�s something tasty that�s been sitting there for a few hours.



LEO:  All right.  But I think the real point is that, when we�re talking about wireless encryption, we�re really talking about protecting the broadcast.  If somebody has physical access to your machine, there�s a whole host of other problems you�ve got.



STEVE:  Yes.  And if something�s already on the inside, sure, you�d like to keep your wireless password secret.  But on the other hand...



LEO:  They�ve got everything else.



STEVE:  ...that becomes the least of your problems.



LEO:  The least of your worries.



STEVE:  And also notice that it�s not like having your WiFi password lets the guy in China - again, I don�t mean to pick on China, but that seems to be where all this is happening.  The fact that some Chinese guy has your WiFi password probably is not a problem.



LEO:  Because he�d have to drive to Irvine to get...



STEVE:  He�s a long way away.



LEO:  Right.  Or the U.K. in this case.



STEVE:  It�s a much bigger problem that he�s rummaging around inside your network from your computer.



LEO:  I have in my hands the last question.  Joseph Melanson of Syracuse, New York has a great question about what you�ve called, another coinage, another Gibson special, "Internet Background Radiation."



STEVE:  IBR.



LEO:  IBR.  You�ve mentioned in past episodes about IBR - worms that are no longer a threat, junk floating around the �Net.  Does this stuff cause slowdowns and bottlenecks?  Does this stuff cause potential damage to packets crossing the Internet, even if it doesn�t infect those packets?  I was wondering if there�s a way to build some kind of system to attract this stuff, trap it, and keep it from getting back on the �Net.  Could programs be written to seek these worms and viruses out and destroy them in the wild?



STEVE:  It was a great question because it is an interesting thing, you know, anybody who is looking at the logs from their routers, if they still haven�t turned them off, will see just all this junk coming down on to their IP.  For the most part, unless somebody is really targeting them directly, this is just Internet background radiation.  It�s some stuff somewhere emitting packets onto the �Net that happen to have your IP address.  And it could well be some old Blaster-infected server located somewhere.  It could be some random PC that just, you know, an innocent homeowner has some sort of Trojan installed on, and it�s out there hunting for other machines with the same vulnerability it has that let it get into this first person�s machine.



So the problem is, while most of the time the source IP will not be spoofed, meaning that they are actually trying to find you, they need a response back to them.  So it�s not like a denial of service attack, where just the act of sending a packet to you is the point.  The point is getting a response.  So they�re probably not spoofing their IP, meaning that if there were some sort of Internet background radiation cop, you know, somebody whose job it was to go track this down, and if they could somehow get the legal authority to do this because that�s the problem, and also you�d need international treaties that allowed this because you�d have to go wherever this IP led you, in theory, yes, you could backtrack all the way up, find the machine and, you know, pull the plug on it.  Then everybody else on the Internet would breathe a little happier because there�d be one less source of junk on the �Net.



At this point it�s really not causing a problem.  If you look at the rate of noise coming into a random IP, you know, it�s a few packets a minute.  It�s not overloading routers.  It�s not causing jams.  There are certainly heavily loaded routers that are, because of their centralized location, they�re dealing with a lot more of this junk than not.  But on the other hand, they�re much more powerful, and they have lots of bandwidth.  So it�s really, at this point, it hasn�t grown to the level where it�s a huge problem.



And I think we�ve probably even reached - I bet if you were to chart the amount of this gunk on the �Net over the last two decades, it would be an exponentially flattening curve.  That is, we�re probably to the point now where new sources of radiation come onto the �Net at about the same rate that old sources leave.  Somebody finally updates their machine, the machine just gives up and dies, they lose Internet connection, who knows what.  I mean, certainly there�s going to be some churn in the total source of this kind of radiation.  So I would imagine it�s about as bad as it�s going to get.  I don�t think it�s ever going to go away completely.  But I doubt that it�s probably going to get much worse.  And it�s not really at a level where anybody is motivated to go around and clean it all up because new sources are being created all the time.



LEO:  Right.  I suppose you could have some sort of scrubber worm.  But that could cause other problems.



STEVE:  Well, yes.  It�s illegal also.  Marc was talking last week about the problem he faces or foresees in trying to perform security analyses of web-hosted services on the Internet where he�s able to check Outlook Express, for example, to see what problems it has.  But if, for example, Microsoft did an Outlook Live version where people were actually using their web browser as their Outlook client, he�s unable legally to go probe Microsoft�s farm of servers because they�re not going to be happy that he�s out there looking.  I mean, you could imagine, Microsoft sees the work that eEye does, finding and reporting Windows vulnerabilities, as a mixed blessing.  It does blemish them, and but now they�re forced to acknowledge that there�s a problem and fix it in a few months and give us our Patch Tuesdays on the second Tuesday of every month.  So the fact that Marc foresees this future where they�re not going to be able to fix these things, and there are still going to be problems, that�s a little bit chilling.



LEO:  Yeah, yeah.  Well, we have completed our 12 questions for today�s episode.  I want to thank you for all your emails and thank Steve for his insight.  We can be very grateful to Elaine, who will make a transcription of this so you can read along as you listen.  And of course there are 16KB versions along with the transcripts and notes available on Steve�s site, GRC.com.  And that�s also where you�ll find his program, SpinRite, the world�s finest hard drive maintenance and recovery utility for the last decade or so.



STEVE:  No, Leo, 20 years.



LEO:  20 years?



STEVE:  Yes.



LEO:  So you have updated it.



STEVE:  Oh, yeah.  We�re at version 6.0.  Yeah.



LEO:  I�m just teasing you.  I don�t want anybody to think it�s a 20-year-old program.



STEVE:  Okay.  No no no.



LEO:  GRC.com.  He cleans it up all the time.  Always working to make it finer.  And by the way, while you�re there, check out Steve�s free security updates and utilities.  There are so many good little programs there, including ShieldsUP, which will be at its 50 millionth user in a day or so.  There�s SecurAble, the new one, and DCOMbobulator, Shoot The Messenger, Unplug n� Pray, many, many more.  GRC.com.  Any final thoughts, Mr. G?



STEVE:  I think we�re set.  I�m looking forward to, as I�m sure our listeners are...





Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#93

DATE:		May 24, 2007

TITLE:		Microsoft Patent Wars

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-093.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo tackle the past, present and future of software patents.  Their discussion of this non-security topic was triggered by Microsoft�s recent declaration that since free and open source software (FOSS) was infringing at least 235 of their software patents, someone ought to be paying them.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 93 for May 24, 2007:  Software Patents.



Time to take a look at security with our good friend Steve�Gibson the security guru, from his fortress, his lair, his shielded manse in beautiful Irvine, California.  Hello,�Steve.



STEVE GIBSON:  Hello, Leo.  Great to be back with you.



LEO:  And did we break 50 million?



STEVE:  Oh.  Yes, in fact, I meant to tell you.  Something happened about four weeks ago that another person in our newsgroup pointed out, because I chart - there�s a chart on the 12th original page of ShieldsUP which shows how many unique IPs we encountered every day.  And someone somewhere must have, like, written an article or something significant about ShieldsUP because we�ve been about double the normal rate of uses.  And it just blasted us through the 50�million�mark.



LEO:  Oh, excellent.



STEVE:  And I don�t - my first thing was I was a little suspicious of, well, could that be some automated thing which is, you know, pumping the numbers up.  Except that there is a standard weekly cycle of activity where you can see it.  It�s a seven-day period as people are - I think they�re busier on Mondays.  It�s like in the beginning of the week we�re busier, and less so as the week goes on.  And so it�s, like, amplified that - not only has it doubled the number, but it�s amplified the size of that sine wave of weekly cycles.  So it looks like these are really valid uses�of ShieldsUP, that something happened somewhere where it got a lot of extra attention, and it seems to be sustaining, so...



LEO:  It couldn�t have anything to do with the fact that you�re appearing on the radio show talking about ShieldsUP, could it?  Does it go up on Saturday or Sunday?  Does it go up on the weekend?  No.



STEVE:  I don�t - I never really actually looked to figure out which was the peak day.  So I�m not sure.  That would be really interesting.



LEO:  Congratulations on your 50 millionth.



STEVE:  Thank you.



LEO:  50 million systems tested by ShieldsUP.  GRC.com.  Whenever I get a new router or firewall, that�s what I try.  It�s absolutely free.  It�s marvy.



STEVE:  Well, it�s quick and easy.  I think that�s probably one of the nicest things about it.  It�s entirely client-side, you don�t have to load anything on your computer, you just go there and visit it with your browser.  And it just gives you a real quick thumbs-up.  In fact, I had an interesting dialogue with a tech writer for a paper in Houston who said that Apple�s AirPort was not giving him stealth.  It was showing closed ports.  And he had had a conversation with Apple, and they said, yes, well, you know, our AirPorts work that way, and we don�t think it�s a problem.  He talked to Bruce Schneier, and Bruce said, oh, you know, as long as you don�t have things open it probably doesn�t matter.  And he said, so, you know, what do you think?  And I said, well, what�s interesting is that Apple�s own firewall has a stealth option.  So, you know, you can tell Apple�s firewall not to return any packets in response to something coming in.  Don�t declare that you�re even there at that IP.  I said, so it seems interesting to me that Apple would take the trouble to put that in their own OS firewall, clearly seeing some value there, but not offer the same sort of opportunity in their AirPort router.  So I said, you know, and I don�t disagree with Bruce, I said, but it�s so simple for a router to be stealthful, even though it�s a technical breach of the RFCs, I mean...



LEO:  Oh, it is?



STEVE:  Yeah.



LEO:  Oh, I didn�t know that.



STEVE:  The formal specification says that a packet arriving at a closed port should return a reset in response to a SYN to say, I�m here, but this port is closed, thank you anyway.  And the reason is a stealth port will receive four SYN packets because the TCP stack at the sending end will send a packet, a SYN packet, and it will wait typically two seconds.  Then it will send another one and wait four seconds, send another one and wait eight seconds, send another one and wait 16.  Except that my math didn�t work right because it ends up taking - oh, no, maybe if you add them all up.  But not even then.  But it ends up taking, like, 45 seconds for a TCP stack to say I�m unable to open a connection because it will try four or five times.  And it exponentially scales the period of time it�s waiting each time.  So the nice thing about sending a reset back is that you affirmatively say, I got your SYN, I�m closed.  And so it does...



LEO:  That saves time.  It makes sense, yeah.



STEVE:  Yes.  It saves time.  It cleans up the �Net a little bit.  You�re not having these redundant SYNs.



LEO:  Go away, I�m not here.  But your point is that, if you say that, you�re telling a hacker you are there, you�re just not open for business.



STEVE:  Yes.  And so the point I made to this guy in Houston was, you know, I�m not here to preach stealthfulness, although it�s so simple to do that, I mean, it�s just so simple not to respond that, if you just gave a switch where you asked a user, would you rather that someone could see that you�re there but closed for business, or believe that, you know, you�ve unplugged your router and you�re not there at all, almost any user I can imagine would say I�d just as soon not be here at all.  So, you know, it�s simple.  So it�s like, okay, I can�t speak to why Apple�s not doing it, but I sure do know that all the typical commercial non-Apple routers certainly allow you to do that.  I mean, it�s something that they promote.  And it�s funny because he said, do you think you�re responsible for that?  I said, oh, as a matter of fact I�m pretty sure I am.



LEO:  Might be, yeah.  I don�t think anybody even - you coined the term "stealth," didn�t you?



STEVE:  I did coin the term "stealth"  because of course the whole thing, being a Trekkie myself, the whole - obviously ShieldsUP comes from "raise our shields."  And so when I was trying to think of, okay, we have open and closed ports, what would it be if a port didn�t respond at all?  And of course, you know, the cloaking generator that the Romulans always had, you know, you were stealthed.  So and in fact there were some notes on Linksys and Netgear routers where they were talking about - I remember seeing some firmware change notes where they said "fixes a problem with router not being fully stealthed for ShieldsUP."



LEO:  Oh, wow.



STEVE:  It�s like, yeah, I guess that�s...



LEO:  Somebody�s paying attention.



STEVE:  Well, because, you know, the end-users complained to their router maker, it�s like, hey, I�m not completely stealthed on ShieldsUP, you know, better fix that.  And it�s funny, too, because there have been firmware bugs where suddenly random ports stopped being stealthful, and ShieldsUP caught it, and then the router manufacturers were told by their customers.  So there�s a nice sort of closed-loop feedback system in place, too, where ShieldsUP ends up getting used to find problems in routers.  The customers then report, and the firmware gets updated.  So it�s a little nice ecosystem we have.



LEO:  So shall we handle some errata?



STEVE:  We�ve got a couple, well, actually just one little thing, and I had a fun...



LEO:  We never make mistakes, of course.



STEVE:  I had a fun little anecdote, again, a little bit of SpinRite.  In fact, even this errata is SpinRite.  You may remember that a couple weeks ago I read a note from a neat 12-year-old computer guy, Justin Gerard, who told us how his computer went wonky, and he called someone from the Geek Squad, which are the Best Buy people, who came out and ran SpinRite on his machine in order to fix it.  And that was really cool, except I made unfortunately the observation that, well, the correct observation that they don�t have any permission to run SpinRite.



LEO:  Whoops.  Whoops.



STEVE:  We do have an enterprise-class license that they could get.  You know, and like our Nerds On Site guys have an agreement with me that allows them to use SpinRite formally and officially on all their customers� computers, these guys don�t.  So I wanted to give credit to the Geek Squad for immediately following up.



LEO:  Oh, good.



STEVE:  When the broadcast went out, someone in the Geek Squad administration immediately contacted our office and said, we don�t have any record of fixing a Justin Gerard�s PC.  Could you find out any - could you get any...



LEO:  It�s probably his parents� name...



STEVE:  ...additional information, exactly.  And this person suggested, since he�s 12 years old, it�s probably in his parents� name.  Could you let us know, you know, who this is so we can track it down because we certainly don�t want any of our geeks using their own software in an unlicensed way as part of their - in their business dealings with us.  So I contacted Justin.  And it turns out that his note was a few months before.  He couldn�t find a receipt.  He didn�t know who it was, didn�t have any other information, blah blah blah.  And we both sort of expressed we didn�t really, either of us, want to get this particular geek in trouble for, first of all, saving Justin�s computer, which he did.  But, you know, at the same point I wanted to raise the issue that this was not something, I mean, this goes a little - this stretches my touchy-feely feeling about...



LEO:  You don�t want to give this - no, this is your job.



STEVE:  Yeah, exactly.  It really does pay the bills here.  So anyway, so I did want to share - I wanted to make sure we closed that issue, to know that the Geek Squad is...



LEO:  They followed up on it, which is good.



STEVE:  They followed up immediately and were as responsible as I could ask them to be.  So I really did appreciate that.



LEO:  Well, there�s one more thing they could have done is buy a site license.  But okay.  We won�t belabor...



STEVE:  That hasn�t happened yet, but that would be great.



LEO:  They should.



STEVE:  I think they should.  Obviously SpinRite works.



LEO:  It works.



STEVE:  And in fact, I got a note from a Dennis Constant, who I guess must be somewhere around me in Southern California because he says, "Steve, I recently flew from Southern California to Chicago to spend a week with my closest friend, who was recovering from heart surgery.  He was well enough to have me drive him to his office."  I guess he was well enough.  "And while there I learned that his old PC had problems.  Most of the time when he turned it on it would not boot, but produced a horrible click-click sound, which indicated that the hard drive was possibly dying."  That�s a good indication, yeah.  He says, "I had brought my laptop on the trip and had my trusty CD of SpinRite, and I ran SpinRite on his PC using Level 2."  Now, Level 2 is a read-only, like a faster read-only pass, which is used just sort of for seeing if there�s any glaring problems on the drive.



Anyway, so he says, "After a couple of hours, when the process was finished, I noticed that the PC seemed a little better, but still wouldn�t boot most of the time.  Before I left the office I started SpinRite again, this time using Level 5.  It ran all night.  The next day I left for Chicago.  When I called my friend a few days later and asked about the PC, he said it worked perfectly, almost like new.  He had no trouble getting the drive to boot, and the computer was faster than ever.  Once again SpinRite performed miracles.  Thanks and regards, Dennis Constant."



LEO:  That�s good, that�s good news.



STEVE:  Yeah, so that�s a nice story.  And keep those stories coming.  I love to get them.



LEO:  We do, we do.  So that is good news, a happy ending for the Geek Squad.  Shall we launch into patents?



STEVE:  Yeah.  Every so often something comes up or happens that has nothing to do with security, which is obviously the focus of where we spend most of our time talking these last 93 episodes.  But it�s something that is, I think, really interesting or really important or something that, you know, bears on us, Leo.  And so I take the opportunity - infrequently, but when I think it�s important - to sort of say, wait a minute, we�ll get back to security issues next week, but something bears discussing that I think is important.  And...



LEO:  Well, and you have some particular interest and expertise in this because you have patents.



STEVE:  Well, I never bothered to follow through because they weren�t things I was doing for myself.  They were things I was doing as a consultant.  And while pursuing the process, which is very lengthy, things changed such that it didn�t make sense to pursue them.  But I have had many involvements with patents.  I�ve also served as an expert witness, testifying in a number of trials that involved patents.  And software patents is something I�ve been very - it�s something I have very, if I may say, Richard Stallman-like feelings about.



LEO:  Uh-oh.



STEVE:  Okay, not as extreme as Stallman.  Nobody...



LEO:  But he�s very anti-software patent.  He thinks they�re the spawn of Satan, you know, I mean...



STEVE:  Well, and my problem is, it�s the test of non-obviousness.  Any patent - I guess we ought to step back a little bit.  In so many online postings I see confusion between patent, copyright, and trademark.  They�re, you know, those are sort of like the three pillars of intellectual property.  A trademark obviously is a phrase or a name for something which a company wants protection on so that nobody else can use that in a way that would confuse a consumer.  So for...



LEO:  We have a trademark on TWiT, for instance, so that - and that doesn�t mean you couldn�t have an ice cream cone named TWiT, but you couldn�t have a podcast named TWiT.



STEVE:  Yes.  And in fact I had an interesting event that not long ago - I have mentioned here that I trademarked the phrase "It�s my computer," sort of as a battle cry.  It�s like, you know, hands off, it�s my computer.  And we were challenged a few months ago by, unfortunately, Network Solutions, who has the - who said "Our trademark, "My computer," is too similar to yours, and we have preexisting usage of that.



Well, I�ve got a very good patent firm.  They�re the ones, in fact, that Apple uses, and Ashton-Tate used.  And it�s a good L.A. firm, and they also have offices up in Silicon Valley.  And so it turns out that, I mean, we did everything right.  I mean, I spent the money.  We applied for a trademark on "It�s my computer."  I showed use of it.   We even filed for challenge, which is something where in a national registry we say we�re applying for the trademark "It�s my computer."  Does anyone have any problem with that?  And so all the intellectual property firms are supposed to be checking that and saying, wait a minute, we have a client, Network Solutions, that has some intellectual property in the trademark "My computer."  You guys are in the same industry.  This is confusingly similar.  We object to that trademark.  Well, that didn�t happen.  No one raised an objection.  We got the trademark assigned, and I have a trademark.  Well, then along marches the law firm representing Network Solutions, saying you can�t have that, it�s too confusingly similar.  And in fact they hadn�t even applied for a trademark because we did a trademark search to make sure that there was nothing...



LEO:  But they don�t have to; right?  I mean, they can say you can�t...



STEVE:  That is true.  The bottom line is they...



LEO:  So if somebody�s been calling their podcast "TWiT" without trademarking it for years, they could contest my�trademark.



STEVE:  Yes, because prior use is the ultimate winner in this kind of dispute.  So essentially we were going to lose.  So I said, well, shoot.  I really like that trademark.  I like my little battle cry.  And so my attorney said, well, why don�t we tell them that they can have, you know, that we will stop using it and relinquish it for $5,000.  And I said, oh, I like that.  That sounds good.  So, you know, my attorney sent a note to their attorney.  Their attorney sent a note back saying, how about $2,500?  And so my attorney said, why don�t we say four?  I said, no, let�s say five.  They�re Network Solutions.



LEO:  They can afford it.



STEVE:  Tell them - exactly.  Tell them we�ll settle for five, and we�ll reconsider our options if that�s not okay with them.  So we got a check for $5,000.



LEO:  That�s fair.



STEVE:  And then I gave up my trademark, which I actually was going to, you know, if they wanted to fight me I was going to spend way more money than that and lose anyway,�so...



LEO:  But I presume you have SpinRite trademarked.



STEVE:  Absolutely.



LEO:  And there�s no contesting that.  And frankly, it wouldn�t be worth - it�d be worth a lot more than five grand.  I mean, nobody�s going to take that name.



STEVE:  Right.  Well, and I�ve got 20 years of prior use,�so...



LEO:  And frankly, nobody seems to want TWiT, so I think we�re safe on that.



STEVE:  Well, and it�s funny, too, because I did hear Kevin talking about Digg and how he�s had...



LEO:  He has to pursue them, yeah.



STEVE:  Yeah, I mean, the idea is, if someone is infringing a trademark, you have to stand up for your rights, or someone can come along...



LEO:  Defend it or lose it.



STEVE:  Yup, they�re able to say that.  So that�s trademark.  So copyright is what probably people are most familiar with, is essentially something saying, here�s a book, and I�m copyrighting it.  You cannot make a substantial copy of this piece of work.  And so of course copyright is one of the protections that all software seeks and obtains just to protect essentially someone from duplicating or substantially duplicating the entire thing.  So...



LEO:  You don�t have to apply for a copyright.  You get it.  Automatically you get a copyright just by creating a work.



STEVE:  That�s absolutely true.  In fact, you...



LEO:  You can apply, but there�s no real - I don�t think there�s really an advantage.



STEVE:  Right.  And essentially the only thing you need to do is you need to state on the work that you are claiming copy rights in the work.  And so you just say "copyright" and the little circle  C, and then the year that you�re making that claim.  And it sort of stamps it as, look, I�m asserting my ownership in this work, my copyright.  And that�s all you need to do.



So a patent, however, is completely different.  A patent is - the claim is that there�s something that has been invented, something that is, well, in fact, there are three tests for an invention.  It needs to be novel, it needs to be non-obvious, and it needs to be useful.  So the Patent Office, when they�re looking at these things, they�re saying, okay, is this new?  Is this something that has not been done before?  Would it not be obvious to someone trained in the art, is the way the actual language reads, meaning that, you know, for example in the case of software, some software guy says, oh, look what I invented.  And the question would be, would another software person think that was amazing, or would they go...



LEO:  You can�t invent a bubble sort.  It�s been around for years.  That�s non-obvious.  Or it is obvious.



STEVE:  Exactly.



LEO:  One plus one equals two, that�s obvious.



STEVE:  And just, I guess, to limit frivolous patents, the Patent Office also says, and it has to be useful.  So, you know, I guess - I can�t imagine, nothing occurs to me off the top of my head that would be like, why anyone would bother patenting something useless, especially these days when it is so expensive to patent anything.  But still, they certainly want, you know, those are traditionally the tests that are applied.



So my own problem with software patents has been that, when I�ve seen software patents, they�ve seemed obvious to me.  I mean, I�m obviously - I�m into software.  I love software.  I spend a lot of time in that domain.  I�m no super software genius, so I�m not saying that, you know, something that�s obvious to me would be non-obvious to other people.  I think in general most of what I see people saying they invented, I mean, often seems obvious.  Now...



LEO:  Well, a good example is Jeff Bezos and Amazon�s - this is one of the early software patents.



STEVE:  Oh, yes.



LEO:  The one-click patent.  Very controversial.  They claim that they own the rights to the idea that, if you see something, and you click one button to buy it, and it buys it automatically, that�s theirs.  That�s ours, we own it, we bought it, we invented it.



STEVE:  Yeah.  And I think that fails the non-obvious test.  Now, certainly something like crypto algorithms, it�s like, good, have that.



LEO:  Non-obvious.



STEVE:  You invented that, baby.  I look at those diagrams of S-boxes and rotations and scrambling things, it�s like, whoa.  Somebody did some serious work.  But what�s interesting is that even that, historically, would not have been patentable, although we now know RSA has patents and other people have patents on crypto.



LEO:  But in the past you couldn�t patent that.



STEVE:  True.  The idea...



LEO:  Because it�s software or...



STEVE:  No, because the original thinking about software was that software is math, that software algorithms are just mathematics.   And you cannot invent math.  You can discover math, but that�s not an invention.  And so the idea was that math, you cannot patent math because it exists.  I mean, it�s like it�s inherent in reality is one plus one, oh, yeah, is two.  So the idea being that the original feeling in the Patent Office was that no software could be patented because it was tantamount to patenting math because that�s what software was.



So for me, many years ago, probably 20 years ago, I did some consulting and was inventing things.  And the people that I was doing this work for wanted to acquire patents.  Now, I�ve never sought any myself.  I mean, arguably there are things in SpinRite that I invented.  I mean, there�s some very cool things in SpinRite.  But, I mean, it�s like practicing what you preach.  I don�t really see the value in that.  I mean, I understand politically what the value is.  But anyway, so on other people�s behalf I said, fine, I�ll work with your patent attorney if you want to protect this thing that you say I�ve invented.  Well, the patent attorney said, okay, here�s our problem.  The Patent Office won�t give us a patent on software.  Now, remember, this is two decades ago.  He said, so this is how we get around that.  He said, give me a description of what you�ve done in hardware because hardware we can patent.  And even though hardware is not what he called the "preferred embodiment" of this patent, of this invention, it�s not the preferred embodiment of the invention, software is, we�re going to get the patent on the hardware embodiment and say that, you know, this is an example of the invention implemented in hardware, and it may not be the preferred embodiment of the invention.  So that protects us from anyone doing the same thing in software, so essentially you�ve got a software patent.  And so I remember very well that those were my instructions then.



Well, the world has moved from that position incrementally over time to the point today, actually, I think things are relatively out of control.  I mean, I�m sure you�ve seen the little news blurbs about people discovering genes, you know, in the human genome, or chromosomes, and patenting them.  It�s like, wait a minute, this is in my blood.  How can you patent something that, you know, we all have?



LEO:  And they have a patent.  I mean, they�ve been able to do it.



STEVE:  I know, I know.  It is happening.  Now...



LEO:  It�s so weird.



STEVE:  Okay.  So that�s sort of the way things have evolved.  Now, what companies began doing as software patents became practical, I mean, possible to get, is they started amassing software patent portfolios.  IBM was the leader in this just because, you know, they had always been patenting all their hardware gizmos and widgets and things.  And so they were always, I�m sure, pushing on the Patent and Trademark Office, the PTO, to change the boundaries between software and hardware.  And no doubt they had attorneys who were giving them the same sort of advice I was given about how to get a software patent by showing an embodiment in hardware, and that would also protect you from software that did the same thing.



So over time the Patent and Trademark Office changed their approach.  IBM was acquiring tons of patents.  Other companies, of course, were doing the same thing.  Sun and virtually any computer company today has lots of patents.  And of course we remember the famous original Apple-Microsoft lawsuit years ago where they were fighting each other over things, you know, it wasn�t clear whether they were - I guess they were design patents.  They were saying, you know, this is our design of a desktop; and, you know, no one can infringe on that.  And so Microsoft and Apple ended up essentially smoking a peace pipe by doing what�s called a cross-licensing deal where they would each agree to cross-license the other�s patents and not bring any litigation against each other.  And so what�s happened is, as software patents became popular, computer companies turned, you know, spent some chunk of their money to build a patent portfolio, not necessary because they intended to sue anyone who infringed their patent, although that does happen, of course, we just saw - remember the case a few months ago with RIM, the BlackBerry company, and I think it was NTP was the company that was alleging...



LEO:  Yeah, sued and won.



STEVE:  Well, actually they...



LEO:  But some of their patents got invalidated.  It�s very�confusing.



STEVE:  I thought the way it turned out was that they settled.  RIM paid them a ton of money, even though it was believed that many of the patents would have been invalidated if they were challenged.



LEO:  Right, right.



STEVE:  And this is a perfect segue to talk about one of the biggest problems we have is that many people now agree that the Patent and Trademark Office is issuing patents that they should not issue.  The problem is that patent attorneys get involved in this process.  And of course patent attorneys think that patents are good, and more patents are better.  So there�s just lots of patents being issued.  The problem is you end up with arguably bogus patents which give a company essentially a government-sponsored right to sue someone else who they feel is infringing on their patent.  And I�ve been an expert witness in a number of lawsuits where my opinion as someone in the industry and somebody with some engineering background has been called upon to say, you know, what do I think about this.  And the problem is, I�ve seen many things that should have never had a patent granted, and now a company is - all this money is flowing to the attorneys, who roll up their sleeves and fight this.  Whereas, if the Patent and Trademark Office had just said no, this is obvious, then we would have never had this problem.



So, you know, and obviously here�s RIM that ended up having to pay a substantial amount of money, an amazing amount of money, to settle this infringement claim on patents that probably would not have been valid, but it would have cost them more money to get them invalidated and to fight against that than it did just to settle.  So, I mean, this is a problem in the industry.  So generally companies get these patents because they want to build a portfolio in order to smoke these peace pipes with other companies.  Basically they want to do cross-licensing deals.  And so that�s sort of been the way things have been going now for many years.  Microsoft was a little slow to get going on the patent thing, probably because once - I really want to say probably because once they had more ethics than they do today, but...



LEO:  Oh, yeah, ow, that burn.



STEVE:  ...that�s probably not fair.  But, for example, in 2002 Microsoft applied for 1,411 patents.  And by 2004 they had applied for 3,780 patents.  Now, I looked at one, out of curiosity, that was granted to them last week, on May 17 I think it was, a patent just issued to Microsoft.  And the patent is on how to make e-ink, electronic ink, flow more smoothly on a tablet PC.  And I thought, okay, that�s interesting, I wonder what they�ve done.  I read the patent.  And it�s not easy to read these things.  I mean, these make end-user license agreements seem easy.



LEO:  They�re often very convoluted.



STEVE:  Oh, my god, Leo.



LEO:  Talk about non-obvious.



STEVE:  Well, and the other thing that happens is that, first of all, companies that get into the software patent game end up telling their programmers, the software guys, let us know of anything you do that�s clever.  I mean, it�s like it becomes a new extension of the programmer�s job to inform legal...



LEO:  This is what cracks me up.



STEVE:  Yes, of anything that they invent.  And in fact it�s interesting because I was talking to our friend Mark Thompson at AnalogX about this a couple days ago because I�m pretty worked up about this whole issue.  And he made a very good point because I was telling him about this particular patent that I read about the e-ink.  And he said, you know, what normally happens, or what hopefully probably happens, is the programmers actually come up with something novel.  But one of the other goals of a patent attorney is to get the broadest patent possible.  That is, you start out with inventing something very specific.  And in the specificity you could argue you might have something novel, you know, a programmer in all good conscience really thinks he came up with something amazing and unique.  But then the patent attorney gets a hold of it and stretches this thing until, you know, because he wants the biggest umbrella he can make out of this in order to get as much breadth of a patent as possible because a broader patent is better.



And in fact that�s one of the main arguments the Patent and Trademark Office has, and I�ve had this experience with the patents that I have pursued, is again, I�ll express it like the way I really mean it.  Then my patent attorney just makes it so that it could be any color, and it could be chrome and black and blue and white, and it even does apply to banana splits.  And it�s like, and then I get it back, I go, well, okay.  And he�s, oh, this is good, Steve, broad is good.  We want the broadest patent possible.  So then it gets submitted to the Patent and Trademark Office.  They say, okay, this is overly broad.  This covers too much.  You need to narrow it.  And so there is this back-and-forth negotiation until one side or the other blinks, and then you end up with something that results.



Well, so I read Microsoft�s patent.  And I wanted there to be something amazing in this.  It�s like, okay, what is it, what�s the secret for making e-ink flow smoothly?  Turns out that Microsoft�s patent involves priority queues, where you put the e-ink events in a separate queue that the operating system treats with higher priority than all non-e-ink events.  That way the operating system will make sure to refresh the screen to show the e-ink before it does other things that it has to do like worry about updating the time of day and dragging windows around or whatever.  And it�s like, okay.  So then I read it again, trying to find what I had missed.  Because, I mean...



LEO:  That seems obvious to you.



STEVE:  Leo, not only is it obvious, it�s obvious to�everybody.



LEO:  Right.



STEVE:  And priority queues is one of the fundamental architectural components of any operating system.  I�m sure it predates - I�m sure IBM had them on computers with tubes.



LEO:  Any multitasking operating system would have to do it.



STEVE:  And this is not, I mean, I looked for something that was special, something different.  That�s all it is.  And then I got a little perversely curious, and so I looked at a few others.  There was another one where they were talking about a counter and how a counter goes negative, and then when it�s positive it means one thing, and then the mode changes.  And I realized this was so that you could use a stroke on the tablet to capitalize the next letter, and the counter would be incremented, and then you�d do the letter, and then it would decrement it and put you back into lower case.  And it�s like, oh, my god, they�re getting patents on this stuff.  I mean, just bogus patents.  And again, maybe once upon a time when this patent was originally created, that is, this idea happened, some programmer really did have something novel.  But what ends up getting issued is a nightmare.  And I think it�s a problem because a patent this weak just causes, as we said before, just causes real�problems.



LEO:  Well, it�s just asking for litigation.  And it�s inevitably going to go back to the courts.  But hasn�t the Supreme Court weakened this a little bit just recently?



STEVE:  Yes, actually there was a fantastic decision.  Actually patent watchers have been noticing that the Supreme Court has recently been taking up some cases in general about patents that they have not dealt with before.  Microsoft won an issue at the Supreme Court level against AT&T that was trying to claim that Microsoft�s admitted infringement of AT&T�s voice technology - Microsoft acknowledged that they were infringing in the U.S.  AT&T was saying, and everywhere else, and internationally.  And so AT&T was essentially trying to enforce United States patents on a global scale.  And the Supreme Court said no no no no no.  It�s U.S. patent system.  Your rights, AT&T, do not extend beyond the United States.  But the other really good decision was a bizarre case.  There was a company that was trying basically to patent the combination of two previously patented things.  They were trying - it dealt with an adjustable gas pedal and an electronic throttle.  And they put them together and said, look, this is our invention.



LEO:  The spork.



STEVE:  Wait a minute.  The electronic throttle has been invented and patented.  The adjustable gas pedal was patented a long time ago.  You can�t just put those together and call that an invention.  But it turns out that originally the Patent Office said no.  It was appealed, and the Appellate Court overturned the Patent Office decision and said yes, that�s an invention.  Now, the problem is, the Appellate Court are patent attorneys who of course think more patents are more better.  So it went to the Supreme Court, that said no.  And in fact the decision was written by Justice Anthony Kennedy, who said granting patent protection to advances that would occur in the ordinary course without real innovation retards progress.  And so he�s making the point that essentially we�re being in general too patent-happy in this country, and that�s creating a problem.  He also said that the results of ordinary innovation are not subject to exclusive rights under the patent laws where otherwise patents might stifle rather than promote the progress of useful arts.



LEO:  And that�s really the whole point and the balance of patent law is to promote these arts without stifling creatively and innovation from others.



STEVE:  Yes.  Now, what happened about ten days ago that made this an issue for many people, there�s been a ton written about this in the last ten days on the �Net, is that the senior editor for legal affairs of Fortune magazine, a write named Roger Parloff, did a feature story for the May issue - I guess it�s mid-May.  I don�t remember.  Actually I got a copy of it because I wanted to make sure that there was nothing additional in the paper copy that was not online, and there isn�t.  He did a feature story titled "Microsoft Takes On the Free World."  And essentially what happened was two of Microsoft�s guys, Brad Smith, who�s Microsoft�s chief counsel, and Horatio Gutierrez, who�s Microsoft�s vice president of intellectual property and licensing, they sat down with this guy at Fortune magazine to talk about patents and the fact that they feel that open source software, free and open source software - or FOSS, as it is now called, that�s the acronym that�s being used - is infringing on a ton of Microsoft patents.



And in fact for the first - now, Microsoft has made noises like this before.  But they�ve just said, you know, free software is infringing on our patents, grumble grumble.  Okay.  This time they said the free and open source software is infringing 235 of our patents.  And so they put a number to it.  They said that the Linux kernel violates 42 of their patents; that the user interface and design elements infringe an additional 65; that OpenOffice infringes 45 of their patents; and that email and other open source programs infringe an additional 83.  So Microsoft has clearly sat down with, I mean, taken the time to go through their own patent portfolio, which is no small job because they�ve been so patent happy.  And they�ve been scrutinizing free software, the whole open source software movement, and specifically delineating which of their patents are being infringed by open source software.



So, okay, so we have a couple problems.  First of all, remember, Leo, I�m sure - it was either you and I talked about it here, or you talked about it with your crew on TWiT back in November.  I remember there was discussion - I�m sure you and I talked about it - about this weird Novell/Microsoft deal.



LEO:  Yeah, yeah.  Well, we talked about it a lot on all the�podcasts.



STEVE:  Yeah, because, I mean, we couldn�t figure out what it was.  It was like, okay, what�s...



LEO:  Novell agreed to indemnify its users against lawsuits from Microsoft and ended up giving Microsoft a lot of money for that indemnification.



STEVE:  Well, and in fact, although Microsoft gave Novell more because what it was - yeah.  And it seemed really strange.  Why is Microsoft paying Novell more than Novell�s paying Microsoft?  The reason was that this was, like we talked about before, it was a cross-licensing deal where Microsoft wanted access to Novell�s patents, meaning that they wanted to know that Novell�s networking patents were never going to be a problem for Microsoft, and Novell wanted the same thing from Microsoft.  So they were cross-licensing their patents and agreeing, okay, we�re never going to sue each other on this basis.  And of course this inherently extends to each company�s customers because the way patent law works is I�m violating somebody�s patent, even if I bought the software legally or am using the software legally, if in that software somewhere is somebody�s intellectual property, protected by a patent.  I the user, because my software is doing that patented thing, I�m individually violating that patent.



LEO:  Isn�t that amazing.  So you�re liable, and you may not know anything about it.



STEVE:  Right.  Well, and in fact I�ve got to say that this Horatio Gutierrez, it sounds like maybe he�s been reading his own press releases a little bit too much.  He said something that just really made my blood boil.  He was quoted saying this is not - okay.  And he�s the Microsoft guy, I should remind our listeners, who�s in charge of their intellectual property and licensing.  He says, "This is not a case of some accidental, unknowing infringement.  There is an overwhelming number of patents being infringed."  Well, of course he should have said "there are an overwhelming number," but he said, you know.  So he�s saying the fact that it�s 235 means that it�s intentional.  It�s like, what a crock.  I mean, first of all...



LEO:  Well, worse than that, they�re not even going to say which patents are in violation.  You�re supposed to find out.  You�re supposed to figure it out and come to them.



STEVE:  Well, okay, now, that makes a couple really good points.  First of all, yes, you�re right.  Everyone has been saying, okay, which 235?



LEO:  Yeah.  I mean, prove it.  I�m willing to believe it if you could say show me the patents, and then we can judge whether it�s an obvious bad patent or whether it�s a good patent.  But they won�t even say.



STEVE:  Let me tell you, Leo, if one of those is the e-ink smooth flowing patent, I can tell you right off the bat they�ve got to drop that number to 234.



LEO:  And I think it�s likely.  I mean, I think it�s likely that they�ll be things like a stack, you know, things that of course all software uses, and the patent shouldn�t have been awarded, but it was awarded.  And they won�t even say.



STEVE:  That�s correct.  Microsoft is refusing to name any�of the 235 patents that they are now claiming are infringing.  And the point was they were saying, during this�Fortune magazine article they were quoted as saying we think people need to start paying for the use of our intellectual property.  I mean, that�s the bottom line.  They�re�saying...



LEO:  Just accept the fact that there�s violations, and you should just give us money?



STEVE:  Well, so of course here�s the problem.  I mean, look at me facing Network Solutions, saying, okay...



LEO:  Well, frankly, Steve, if they�ve patented some obvious things, maybe you�re violating their patents.



STEVE:  Oh, well, the problem is patents have been granted now with such abandon for the last decade that there�s no way anyone, first of all, can know if they�re violating someone else�s patents.  I mean, no one can know.  I mean, I can�t sit there and read all of Microsoft patents, all of Sun�s patents, all of IBM�s patents, and tiptoe through the tulips and somehow, I mean, first of all, I don�t even think I could write code that would not be in violation of these bogus patents.



LEO:  The other issue that Linus Torvalds brought up is he said, well, nobody in the open source community is going to look for these patents because looking for and the knowledge of them exposes you.



STEVE:  Well, what happens is, yes, if in court it can be shown that you knowingly violated a patent, then you�re subjected to triple damages.



LEO:  So you�re not going to look.  You don�t want to know.



STEVE:  Exactly.



LEO:  And if you accept, as I think everybody in the open source community does, that software patents are bad, have gone far too far, and it�s very risky because you may well have violated a patent because of this broken system, you�re not going to look.  It�s too risky.  So wait a minute, now we�re at a standoff because Microsoft�s not going to tell me, and I�m not going to look.  What�s supposed to happen�now?



STEVE:  Well, and so, okay.  So the problem is, here�s Microsoft, obviously the thousand-pound elephant in the room who�s just sort of - who clearly said to Novell, okay, look, you�re the number two distributor of Linux.  Obviously Red�Hat is number one.  And it�s interesting because Red�Hat�s guys have had conversations with Microsoft, and they�ve never been able to strike a deal, probably because the Red�Hat guys, frankly, are a little more savvy about this.  You have to imagine that Novell is wondering, you know, whether they did the right thing when they did this agreement in November.  But so here�s Microsoft threatening to throw their substantial weight around and basically intimidating other companies into doing these sorts of deals, into doing cross-licensing and ultimately paying money for something that probably is entirely bogus.  I mean, it is a problem.



Now, the good news is I think Microsoft probably waited too long.  I think that, I mean, the reason this is coming up at all is because Microsoft, I assume, is on some level unhappy that someone can use Linux and OpenOffice and have a very useful system that Microsoft believes - and I sincerely believe they believe - infringes their intellectual property, whether or not it actually does, and that this person doesn�t pay Microsoft any tax.  Basically Microsoft wants to tax free and open source software.



LEO:  Oh, they want to do more than tax.  They want to put it out of business.  They�d like it to die and go away, wither up.  I mean, that�s one of the reasons I think they�re not saying what these patents are.  They want to put them out of business.



STEVE:  Well, okay.  It�s very clear that if they enumerated these patents, the free and open source software community would have a field day attacking them.



LEO:  Exactly.



STEVE:  And that�s just it.  You end up with a distributed attack against Microsoft...



LEO:  Good point.  A distributed legal attack, yeah.  Tie them up for years.



STEVE:   Exactly.  Because every patent would get tackled.  People would be finding prior art because prior art is one thing that immediately invalidates a patent.  If you can demonstrate that somewhere someone did something prior to your invention, it�s called "prior art," and sorry, no more patent.  So there would be that.  And, you know, Linus would be happy to code the kernel around whatever Microsoft�s 42 claimed patents are that they say the kernel infringes.  I mean, so the fact...



LEO:  Well, if it�s priority queues they may not be able to code around it, but...



STEVE:  Well, but neither is that a valid patent.  So here�s what�s so frustrating, too, is that the fact that Microsoft won�t name the patents prevents anyone from curing the problem that Microsoft is complaining about.  So they really don�t want the problem cured.



LEO:  No.  They want open source software to go away is what they want.



STEVE:  Well, or, yes, in fact, I�m sort of worried because one of the side effects of the deal they did with Novell is that the idea is that anyone who gets Linux from Novell is protected because Microsoft and Novell did this cross-licensing deal.  So you could see that this could tend to bias people towards Novell, concentrating Novell as a�source.



LEO:  Which is I�m sure Novell�s interest in making the deal in the first place.



STEVE:  Probably was.  But it seems to me that�s dangerous.



LEO:  Well, a number of people, good quality people who worked for Novell, quit over this.



STEVE:  Yes, in fact, one of the main Linux kernel guys did.  I mean, he just resigned immediately when...



LEO:  He saw what Novell was trying to do, essentially.



STEVE:  Yeah, and I can�t really articulate why this feels dangerous to me.  But the idea is, I guess, as long as Linux is spread out as widely as it is, distributed as widely as it is, there�s so many different ways that substantial companies can get distributions, the broader it is, the less power Microsoft has.  If Microsoft can do something to focus the distribution of Linux through a fewer number of channels, to me that seems unsafe for the future of open source software.  I think it really needs to be kept widespread.  So, and Microsoft does think strategically.  We�ve seen many examples of that through the ages.  So anyway, it seems really clear to me that what they�re doing is not fair because they�re not saying we really want the problem solved.  They�re really saying we�ve created this problem, the U.S. government is backing us with the Patent and Trademark Office, and we�re so big you can never afford - even the U.S. government couldn�t prevail against Microsoft in the anti-trust suit.  So they�re saying, we�re so big, you can�t even think about fighting us and challenging us.  So believe me, you don�t want us coming after you.



LEO:  Yeah.  Yeah.



STEVE:  But the reason I think they waited too long is they waited this long because it took this long for the free and open source software movement to really achieve the critical mass it has today.  I mean, they talk about many of their enterprise, Microsoft�s own enterprise customers who have hybrid server rooms where they�ve got Linux servers and Windows servers that need to cooperate and live and work together.  And so that�s sort of the new model.  Well, you know Microsoft cannot be happy that their customers are using Linux servers for some chunk of their infrastructure.



LEO:  Now, it also gets complicated because - and we�ve talked a little bit about this on TWiT - because of the GPL, the new version 3 of the GPL, which makes this voucher program that Microsoft�s done with Novell backfire on Microsoft a little�bit.



STEVE:  Well, yes.  It�s interesting.  Version 2 of the GPL allowed Microsoft to do this deal.  But what Novell did as part of this deal in November was Novell gave Microsoft some number of coupons, basically for a free version of their Linux enterprise server.  Microsoft then sells these coupons or makes them available to their customers.  And their customers are able to redeem them for Novell�s Linux server software.  Well, it turns out that version 3 of the GPL that�s supposed to come into effect either in June or July, in a month or two, it closes a loophole that Microsoft was essentially taking advantage of that exists in version 2 of the GPL, which is what software is now being covered by, such that, if any Microsoft customer uses one of those coupons and redeems the coupon for a Novell copy of Linux, under version 3 of the GPL that makes Microsoft a distributor of free and open source software.  And as a distributor, part of the GPL requires that all patents be licensed for free.  That is, there are either no patents at all, or they are completely free patents.  And so that forces Microsoft to essentially implicitly turn their entire patent base into royalty-free licensed patents so that no user then of any version of Linux could be sued by Microsoft for eternity.



LEO:  I�ll put Eben Moglen against Brad Smith any day.  Eben is the lawyer who wrote the GPL 3.  I think he�s a very, very smart guy.  And clearly this was a very smart move.



STEVE:  Well, it looks like - essentially, I think Microsoft waited until now because they�re really beginning to see...



LEO:  They�re scared.



STEVE:  ...open source software getting traction.  I mean, it�s really getting - it�s gaining traction.  The bad news is they waited so long that many heavyweight companies like IBM and HP and Sony and Sun, you know, there are many major companies, basically anyone that�s not Microsoft, that are saying, okay, this is our alternative to Microsoft.  So they�re throwing their substantial clout behind free and open source software, and they�re going to defend it.  Let alone all the developers around.  So Microsoft can�t tell the world what patents it thinks - it�s claiming are being infringed because they know their case is weak.  And again, it�s doubtless possible to engineer around the patents and cure the infringement, even if the patent were found to be valid.  And Microsoft doesn�t want that.  They don�t want the problem solved.  They want this problem in order to use it as leverage.  It�s wrong.



LEO:  Well, it�s going to be interesting to watch.  I have a feeling this is actually going to just kind of fade away because there�s no way Microsoft can really pursue this without opening themselves.  It�s mutually assured destruction is really what it is.  And I have a feeling this is just a dumb move, one more dumb move from Microsoft.



STEVE:  Yeah, I think in retrospect Microsoft probably regrets that they had this discussion with Roger Parloff and Fortune magazine.  They regret what has happened.  And in fact I think that, in tipping their hand, they have put the whole open source software community on notice now.  For example, you�ve really got to wonder whether any other major company will follow in Novell�s footsteps after this article and after so much attention has been given to this.  And basically I think Microsoft�s bluff can now be called by anyone who wants to call it.



LEO:  Right.  Very interesting.  Now, I�m sure we will see a This Week in Law on this with actual lawyers and so forth.  And we should remind everybody that Steve and I aren�t lawyers.  But Steve obviously has a lot of experience in this field, and I have to agree with you in your analysis of it.  I�ll be interested to see what Denise Howell and her group come up with.  That�s why we have This Week in Law.



STEVE:  Well, and don�t forget, Leo, if Microsoft actually sued, they would have to name patents.



LEO:  Right.  Right.  It�s mutually assured destruction.  That�s what�s kept this thing afloat for so long.  I�m so glad we did this.  It isn�t exactly security, but you know so much about this subject.  And it really is important, I think, for everybody to know about this.  This is something that�s broken.  And if you use software, you need to know about it and maybe stand up and be counted.  Is Congress doing anything about this?  Are they aware of this issue?



STEVE:  Well, there actually is some congressional motion also.  The problem is that what we really want are less patents, fewer patents, stronger patents.  The problem is, for example, the pharmaceutical industry wants more patents, more easy patents.  So there are strong lobbying pressures that are pushing Congress in the direction away from what most people feel is healthy patent legislation.  And that�s a problem.



You know, my feeling is that things that are originally invented, sort of they have initial value, and that fades over time.  Once upon a time, you know, the idea of a bitmap and a cursor was like, whoa, my god, look at that, that�s so cool.  I mean, I remember looking at the first Macintosh and just moving the mouse around, and no one had ever seen anything like that before.  And now it�s sort of like it gets absorbed by the ether.  It just becomes so common, such common knowledge, such common practice, I mean, now everybody has bitmaps.  Everybody�s got cursors.  It�s like, you can no longer get money for that.  When it was very brand new and fresh you could get money just because you had a bitmap and a cursor.  Now everybody has them, so there�s no more value there.  And I think similarly there were original innovations in the industry that would qualify as being special enough that the company who produced it could get money for it.  And after a while they just became the way things are done.  And so people who are really anti-Microsoft say that Microsoft is beginning to turn to litigation because they�ve run out of creativity.  And so they�re going to do what old, mature companies do.



LEO:  Sue the mothers.



STEVE:  Exactly.  Which is, you know, if that ends up being a proper characterization, it�s really unfortunate.



LEO:  Yeah.  People might say, well, this is the way that all - this is when it began, the beginning of the end.  And I wouldn�t be surprised to see that.



All right.  We�re going to wrap this thing up.  I do thank you so much for joining us.  Steve, I thank you.  Next week another great Security Now!.



STEVE:  We promise.



LEO:  We promise.  We�ll cover whatever�s going on in technology and security.  If you want to know more, of course, go to GRC.com.  That�s Steve�s site.  ShieldsUP is there, all the free programs he does; SpinRite, of course, his great disk recovery and maintenance utility; and 16KB versions of the podcast plus transcripts, too, so you can read along as we talk.  In fact, Steve�s got really extensive notes for this particular episode with lots of links.  So if you want to know more, this is a good one to go research at GRC.com.



And of course TWiT.tv is the home of all these podcasts.  If you want to support them there�s a couple of ways you could do it.  Of course we�ve got great TWiT merchandise from the folks at SCOTTEVEST, and ThinkGeek hats and polos and fleeces.  Those new polo shirts are great for summer.  And you can also support us with your donations.  Your recurring $2 a month subscription really makes a big difference for us.  It keeps this little baby afloat.  Steve doesn�t need it.  We�ve got lots of advertising on this podcast.





Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#94

DATE:		May 31, 2007

TITLE:		The Fourth Factor

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-094.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Having discussed the first three "factors" in multifactor authentication (something you know, something you have, something you are), Steve and Leo explore aspects of the power and problems with the fourth factor, "someone you know."



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 94 for May�31, 2007:  The Fourth Factor.



It�s time to talk security.  And our good friend Steve Gibson is here from his Security Now! labs in Irvine, California, home of...



STEVE GIBSON:  My lair of security.



LEO:  Your lair, your secret cave, the bat cave, home of Security Now! and, of course, of SpinRite and SecurAble and Shoot The Messenger, DCOMbobulator, the famous 50 million-strong ShieldsUP!.  Did you ever figure out why you got a bump in ShieldsUP! last week?



STEVE:  No, but it�s still there.  Knowing that we were going to talk about it maybe today I looked again a few minutes ago.  And it�s consistent.  We�re, like, 49,000 uses of ShieldsUP! a day now.



LEO:  A day.  Wow.  Somebody�s got to be plugging it.  I guess it could be the radio show.  But I wonder if maybe now a router�s not saying, or some security software�s not saying, "Test us."



STEVE:  I think that�s probably exactly it.  Somewhere, someone with a serious following is saying, you know, use ShieldsUP! to go check things.  And but what�s really interesting is, as I said before when I mentioned this, and I saw it again profoundly, is this weekly cycle.  And it does look like it�s actually slower on the weekends and busy�- yeah, sorry, Leo, it�s not the radio show in this case - and busier, I mean, it�s a substantial population of people who are now, like, I mean, it�s a sharp peak.  It�s like something discovered it overnight.  So I�m sure you�re right.  Somewhere there�s some high-traffic site or facility�which is saying, you know, use ShieldsUP! to test yourself.  And...



[Talking simultaneously]



LEO:  ...because we certainly have - we�ve mentioned it from time to time, but we�ve been harping on it a lot because of the 50 million.  It could even just be the attention this podcast generates.



STEVE:  You saw the chart.  In fact, why don�t you bring the chart up right now?  Go to GRC.com and go to ShieldsUP!, and then click on that first entry button to get into where it sort of shows, you know, it says, "Greetings," and then you see that first chart.  You see the first set of buttons.  And then scroll all the way down to the bottom of that to item no. 12, which I think is labeled "Site History."  And if you click that, you�ll see I build a little...



LEO:  It�s neat that you put that up.  That�s great.



STEVE:  Yeah, I build a little dynamic chart that shows.  But, I mean, it�s overnight.  I mean, in one day...



LEO:  Oh, yeah, it�s very visible on this.



STEVE:  ...it doubles.



LEO:  Because it�s very consistent, too.



STEVE:  And you can see there used to be a sine wave, historically, which is our weekly, just the standard weekly cycle.  And this is - so it�s more pronounced now.  The sine wave is a higher amplitude.  But something happened in one day where suddenly and consistently now the traffic doubled.



LEO:  Wow.  It�s very clear, yeah, when you look at that you know that something happened.  Wow.  Anyway, 50,597,626 shields tested.



STEVE:  And counting.



LEO:  And counting.  By the time I read it it�s much, much higher.  We want to, before we get into our subject, today we�re going to kind of do a follow-up on our three-factor authentication discussion.



STEVE:  Yeah, actually I think of it more broadly than that, Leo.  My feeling is that authentication is going to become nothing more than increasingly important in the future.  I mean, as online banking happens, as our identities are - as it�s more important for people�s daily lives that they be able to prove over the Internet that they are who they say they are, I mean, that the applications are expanding, and as that happens it becomes increasingly important to be able to prove you are who you say you are and for someone you�re proving it to to be able to trust that proof.  So I want to expand on and talk some more about some specific issues of authentication.  But this is more than, you know, we certainly opened the topic broadly when we, four weeks ago, talked about multifactor authentication.  Of course we started off the series 94 weeks ago talking about passwords, which is sort of...



LEO:  Right, right, that�s right.



STEVE:  ...the classic, easiest, and most familiar form of authentication.  So I think our listeners should assume that authentication is going to be an ongoing sort of topic thread for us, probably for the foreseeable future.



LEO:  It�s critical.  It�s a critical subject.  And Steve has discovered a fourth factor.  So it�s exciting stuff.



STEVE:  The Fourth Factor.



LEO:  That�s what I�m going to call this one.  First of all, when you say "authentication," just to make this clear, what do you mean when you say "authentication"?



STEVE:  Well, it�s about proving that you are who you say you are, authenticating that you are - that, well, and okay, authenticating that you are you, and doing so to somebody remotely.  I mean, that�s where the challenge comes in.  Remember that when we talked four weeks ago about multifactor authentication, we started off talking, for example, in the olden days, I think we used some examples from characters from "Andy of Mayberry," where Opie would go into the drugstore, and he could be allowed to pick up Aunt Bee�s medication because the druggist knew him, and so he knew it was Opie coming into the store, and that Opie was trustworthy and would go straight home and take Aunt Bee her pills.  And so four weeks ago we talked about the three factors of authentication being something you know - meaning, for example, like a password; something you have...



LEO:  Something you and only you know.  It�s private to you.



STEVE:  Good point.  And in fact we drew the distinction then that we�re talking about discriminating, that is, something you know that no one else knows, meaning that that factor can be used to discriminate you from anybody else, given that you�ve kept this information to yourself.



LEO:  And that�s exactly what a password does, I mean, it tells the website or your software that it�s you and nobody�else.



STEVE:  Right.  And then of course the something you have is a physical token of some sort.  And of course the popular one that a lot of our listeners, I was surprised how many people wrote in and said, hey, we�re using SecurID, which is an RSA token which we�ve talked about now several times.  It displays a periodically changing, multidigit number in a little LCD screen.  And so it�s the kind of thing you have on your keychain, and it�s always showing some number, and every minute it goes to a next one.  And then by hooking that into an RSA server, the server knows the seed that your particular token is set with, and so it�s able to determine what number you�re seeing, so it�s able to verify that, well, somebody has your token, and we�re hoping it�s you.  And so it�s funny because a number of our listeners who wrote in said, hey, not only do we have to give them that token number, we also have a PIN or a password.  Apparently that�s software configurable.  Some companies use PINs, short numeric PINs.  Others allow employees to use regular passwords of some length.



LEO:  So that would be dual factor, so it�s something you know and something you have.



STEVE:  Exactly.  And that solves the problem of your token getting away from you and it being used for some mischief.



LEO:  That�s what a bank card does with an ATM card,�exactly.



STEVE:  Exactly.  And in fact there�s another, much more common example of two-factor authentication.  Now, the ATM card has the limitation that you have to be at an ATM machine.  And that�s why this RSA token is cool because, since it�s an LCD display, and you�re entering the data on a screen on a website, you�re able to get hardware token two-factor authentication that way.  Whereas the only way to do that, for example, in a PC format would be if you had a mag stripe reader hooked to your PC.  Then you�d use your ATM card to do a card swipe.



LEO:  And there are Smart Cards to log onto machines, like Power LogOn, that do exactly that.



STEVE:  Right.  And then finally the third factor is something you are, which gets us into another large topic that we�re going to be spending some time on in the future because I think it�s fascinating and also really interesting.  And that is, you know, things like the whole idea of biometrics, that is, something bio, that is about you, and metric, that is to say that can be measured.  And so there�s retinas and irises and hand geometry measurements, and of course very common is fingerprints.



It�s funny, Leo, I�ve been using now for several weeks the fingerprint scanner on my IBM ThinkPad, and I really like it.  It has support in the BIOS, and it uses the TPM, the Trusted Platform Module, built into the ThinkPad, which is another topic we�re going to be talking about in the future because it�s been controversial in the past due to the possibility of its being abused.  But I really like the idea that my hard drive is locked so that no one who even took the drive out of the laptop would be able to read it until I swipe my finger as the laptop boots up.  And the BIOS, an interaction between a processor in the fingerprint scanner and the BIOS authenticate me in a truly secure fashion using the Trusted Platform Module that�s built onto the motherboard of the laptop.  Only if that succeeds will it then dynamically unlock my drive as I boot to allow there to be any chance to boot an OS.  And then Windows comes up knowing that it�s me that has turned this laptop on.  So it�s a really nice solution.  If I were more concerned, I could go for two-factor authentication and have to provide a password and my fingerprint.  But I�m careful about my laptop, and I�m not traveling...



LEO:  Let�s not go crazy here.



STEVE:  ...blah blah blah, exactly.



LEO:  Right, all right.  So you�ve discovered, now that we know what authentication is and we�ve got the three different factors, you�ve discovered a fourth factor.



STEVE:  Well, yes.  During the research I was doing four weeks ago I stumbled across something that just caught my eye and, you know, grabbed some references to it and have spent some time thinking about it more.  And that is, the fourth factor turns out to be sort of a return to the past.  But, for example, in this RSA research paper, these guys have put some science to it.  The fourth factor is someone you know.  So of course that�s the pharmacist and Opie example, that is, the pharmacist trusted Opie because he knows him.



Now, in an electronic mode, of course, how do you prove that you�re someone you know?  That is, the idea being we�re still talking about trans-Internet authentication.  Well, in the RSA research paper - they�re of course a little RSA-centric.  We can�t fault them for that.  So they talk about a model for the fourth factor involving their SecurID token.  The way this would work is, imagine that Sally - we�ll just make up a Sally - has lost her token, but needs to authenticate herself in her corporate environment.  So there�s a formal structure to allow someone Sally knows who has not lost their token to extend the authentication through his trust and his knowledge of Sally.  So what happens is, Sally calls Bob and says, Bob, I�ve done it again, I�m sorry, I�m so ditzy this morning, I left my SecurID token at home.  I need you to authenticate me.



LEO:  Uh-oh.  That�s the kind of thing a spy would do.



STEVE:  Well, now, that�s a very good point.  And this is one of the weaknesses that this RSA security paper - and I will have a link to it in our show notes so people can dig down into this if they�re interested.  It�s one of the weaknesses that these guys not only qualify, but quantify, in terms of how does this weaken the system.  Because they talk about, for example, if Sally sent Bob email to say "I left my SecurID at home," that�s obviously very weak form of someone you know because email is so easily spoofable.  And so they design a system where, in a drop-down list box, in order for Bob to authenticate Sally to his corporate network infrastructure, for example, there�s a drop-down list box where there�s a number of choices of how Bob knows this is Sally.  And it says, "Talked to her," or "Met her face to face," "She called me on the phone," "She sent me email," or, you know, a number of other things.  And so the idea being that even things that might be disallowed are listed there so that Bob doesn�t lie, so that Bob is encouraged to say, oh, she sent me email.  Well, then when he tries to submit this...



LEO:  [Buzzer noise].



STEVE:  Exactly.



LEO:  Sorry, Bob.



STEVE:  Sorry, Bob, that�s not okay.  Tell Sally she�s going to have to do better than that.  She has to prove herself.  And so what they�ve tried to do is, because this is obviously about human factors, and anything like this is prone to social engineering attacks, they�ve tried to give Bob the opportunity to tell the truth about why he believes this is Sally so that he won�t just say, oh, it�s probably�Sally.



And now the other good thing is that - so, okay, just to close this loop.  So Bob, believing this is Sally, the way this works is Sally has said to the system first, I don�t have my token.  Give me a one-use password that I can use in order to get myself authenticated.  So the system gives her some sort of - a token of some sort.  She then provides that to Bob and says, Bob, I left my token at home.  Could you get me on the network, please?  Can you authenticate me?



Bob says, well, this really does sound like you, Sally, so yes.  He has some credible reason to believe this is she.  So he goes to the system and says, hi, this is Bob, and I�ve got my SecurID.  So he goes through the normal protocol of authenticating himself to the system so that the system knows this is him.  And he says, here is the token that you gave Sally a couple seconds ago, which she needs to use to authenticate.  So he provides that to the system.  The system says, okay, this is what we gave to Sally a minute ago.  We know you�re Bob.  You�ve proven that to us.  So here is the matching, like, magic token that you are to give to Sally to prove that you�re who you say you are, and you�re known to the system.



So the system gives something back to Bob, this matching token, which he then gives to Sally, and Sally then provides to the system.  So what this does is this securely and, in a one-time-only use, it creates a series of chains where the only thing you really need to depend upon is that Bob and Sally are in agreement that they know each other; or, more specifically, that Bob is sure this is Sally who has made the request.  And so Sally, in returning this token that she received from Bob, verifies that she�s had this dialogue with him.  The system verifies that this matches the temporary token it initially gave to her, and the only way that can happen is if she�s been the recipient and this thing has flowed through Bob to the system and then back through Bob to her.  So, I mean, it sounds confusing.  In practice it�s not very difficult.  And...



LEO:  Is this the web of trust that they talk about?



STEVE:  Well, no, that�s - we�re going to get to that in a�second.



LEO:  It�s not, okay.



STEVE:  And I expect you have much more experience with that, Leo, than I do because you have been for many, many years a PGP user.



LEO:  Right, right.



STEVE:  So this is not a web of trust.  This is sort of a fallback solution for what happens in - or a solution to the problem of the strength of a two-factor system losing its strongest factor, meaning the something I have, unfortunately I left it home, so how do I authenticate myself in an online fashion, in a secure fashion, in the absence of one of these tokens?  And the idea being that, if the players play by the rules - and of course that�s the weakness in this is, again, we are talking about the human factor side.  But any system like this that is strong needs to have some sort of - well, and to be practical, needs to have some sort of fallback methodology.



The classic example is when we use passwords to authenticate ourselves onsite when we�re signing up with our account, they�ll often say, well, to give us some personal information about yourself, what was your favorite teacher in high school, your first pet�s name, you know, what city were you born in?  And of course those questions are used exactly in this fashion as sort of fallback password-recovery options.  The problem there is, the weakness of that is those can often be determined through data mining.  For example, it�s possible to find somebody�s mother�s maiden name on the Internet through data mining.  And unfortunately, you know, mother�s maiden name is the classic fallback authentication recovery approach.  And it�s...



LEO:  And everybody knows it.



STEVE:  It�s terminally weak, yeah.  I mean, it�s really�not...



LEO:  First of all, it�s easy to find somebody�s mother�s maiden name.



STEVE:  Right.  And the other problem with that is it�s inherently static.  Everyone has one mother, and she had one maiden name, and it�s not changing.  The nice thing about the model that the RSA guys came up with as a fallback solution for the temporary loss of a token is it does use one-time-only identifiers, so it�s not subject to any kind of a replay attack.  That is, it�s not possible for someone else to use the token they got from Bob or that Sally wrote down on a pad of paper or something and use it as a single-factor authenticator to the network.



So it�s a cool system, and it demonstrates, again, a way that it�s possible to use someone you know who is essentially vouching for you.  The point I was going to make also is that Bob knows he�s on the hook for having authenticated Sally.  So given that logs are being made - and logs are always made in these sorts of secure authentication scenarios - there�s a log entry that says Sally was authenticated through Bob at this time.  So if it turns out that Sally has done something wrong to the system, or it turns out this wasn�t Sally, Bob knows he�s responsible to the powers that be, basically, of providing the credentials, the temporary credentials that this person who claimed to be Sally was.



LEO:  Had.



STEVE:  Did.



LEO:  Some word in there, a verb.  We�ll just put "your verb�here."



STEVE:  Exactly.  Now, the web of trust is sort of a longstanding variation on this.  The idea - we�ve talked about the public key infrastructure, or PKI, in the past.  And we�ve discussed it extensively as regards the signing of security certificates.  You know, GRC, my web server, supports a secure sockets connection, an SSL Secure Sockets Layer connection.  And we enforce that at any time during, for example, our customers� use of the ecommerce system for purchasing SpinRite.  My certificate is signed by VeriSign, that is a trusted authority and that signs many people�s certificates.  So the idea being that the browser trusts VeriSign to do its due diligence in verifying that anyone applying for a certificate for Gibson Research Corporation really is me, essentially, chief honcho at Gibson Research Corporation.  And I do have to go through a bunch of hoops, you know, verifying phone numbers and addresses and Dun & Bradstreet listings and that kind of stuff in order to get my certificate every couple years when I need to renew it.  So there the idea is we have a central certificate signing authority, a certificate authority that signs certificates.  And so our trust of them is extended through their signing action to the certificate.  Well, Paul - it�s not Paul Zimmermann.  I�m blanking on his name.



LEO:  Philip.



STEVE:  Phil, Phil Zimmermann.  I knew it was a P.  Yeah, Phil Zimmermann, when he created PGP, he wanted to create a public key infrastructure; but he did not want to tie it to a similar sort of central signing authority.  So his idea was to create a so-called "web of trust," the idea being that you could have people sign each other�s public keys, their PGP keys, and thereby in doing so saying I assert that this person is who he is.  And then the idea being that, in the ideal case, for example, I may not know - we�ll stay with Sally and Bob.  Sally may not know Bob.  But Sally knows Jeff, and Jeff knows Bob.  And as it happens, Jeff has signed Bob�s key, his PGP key, and Sally has signed Jeff�s.  So there is a three-person chain involving two signatures that create this three-node chain.  So the idea that, if Sally trusts Fred because she knows him, and Fred is asserting by having signed Bob�s PGP key that he knows him, she can be very sure that she has the key that Bob is�asserting.



LEO:  Right, like Bob and Carol and Ted and Alice.



STEVE:  Exactly.  And...



LEO:  Bob knows Ted, and Ted knows Carol, and Carol knows...



STEVE:  Exactly.  Now, the problem of course with this is, as the chain gets longer, again we�re still basically in a social engineering mode.  That is, as is always the case in any authentication scenario, the trust that you can have in the authentication provided is only as secure as the weakest link.  So if you did extend the trust really much further beyond this two-link example, suddenly you�re probably trusting somebody you don�t know.  So you don�t really have personal verification.  See, in the simple two-link model, Sally does know Fred, and so she knows how trustworthy he is.  And she knows he would not assert that he knows Bob unless he really did.



LEO:  Unfortunately, we live now in such a fast-paced world that, especially with PGP, you don�t know everybody personally, directly.



STEVE:  Right.  Well, and you�re certainly not - not only do you not know everybody personally, but you certainly don�t - you aren�t just so-called two degrees of separation.



LEO:  Many, many more.



STEVE:  Exactly.  And in theory, of course, I think studies have been done, and in fact we talked about at some point during our 94 episodes this notion of six degrees of separation.  Studies have been done that show that, in most real-world social networks, any two people on the planet are connected by only six links.  There�s six degrees of separation between any two people in general, you know, on average.  So the beautiful concept of this notion of a web of trust would be that, if PGP were pervasive enough, and everybody got keys and signed them and had everybody that they communicate with sign their key, and they signed theirs, that you would end up with a very useful and robust web of trust.



Now, again, trust is the key because every link in that web needs to be a trustworthy link and to be worthy of the parties trusting each other.  If that�s the case, then you really are asserting through, technically, any distance, any number of links - obviously, if every single link is something you can count on, then even though you might be ten steps away from someone else, if every one of those links is trustworthy, then you can be absolutely sure, to the degree of the least trustworthy link, that ten steps away this is really somebody who is asserting that they are who they are.



LEO:  One way they - I think in the early days - of course, I mean, there are some obvious problems with this.  For instance, my keys are signed by hundreds of people, probably none of whom really know that that�s my key, because they got an email from me; or they saw the key, and they assumed that that was emails from me, and they signed it.  And I�ve done the same for others.  But really, in the old days you might actually, in fact I think they still do have key signing parties, you might actually physically meet up.



STEVE:  I was just going to say that, yes.



LEO:  And that solves that problem.



STEVE:  Yes.  Many times you�ll have SIGs, you know, Special Interest Groups in computer clubs, and they�ll get together, and they�ll show each other their driver�s license to say, look, this is really me.  See?  This is my photo, and here�s my name.  I want you to sign my key.  Because essentially the more people who sign your key, the more valuable that is because there is integrity associated with it.  So there you don�t necessarily have a connected web between points, but you�re able to get somebody�s key and see how many people have said this is really him.  And so you say, okay, what are the chances that all these people are wrong?  And so there you...



LEO:  Right.  It�s certainly possible if they�re all befuddled and fooled, but...



STEVE:  Yes.  And that�s a very good point.  It would be certainly possible for some bad guy to go around with a fake ID and use key signing parties to get a ton of people agreeing with him that he�s bad - I mean, that he is who he is when in fact he�s not, and then take advantage of this robust impersonation to do bad things.  It�s funny because an example of this, the same sort of social networking is what we see with eBay purchases being verified by a chain of people you�ve bought things from before.  I know that, when I�m buying things on eBay, I always make a point of checking out somebody�s reputation.  So reputation systems are sort of a softer...



LEO:  Same idea, aren�t they, yeah.



STEVE:  Exactly, the same sort of thing.



LEO:  And we�ve seen them fooled before.



STEVE:  Yes, and in fact there are bot networks now that are�designed to create spoofed reputation of bad guys on eBay by...



LEO:  They sign each other�s certificates, in effect.



STEVE:  Essentially do that, exactly.  And so they create a fake internal web of trust which unfortunately is extended into the normal eBay web because they�re able to create a deep and rich-looking background of successful purchases of something, basically a penny each were the purchases, so not much money got spent.  And that same penny probably went back and forth within this network of bots.



LEO:  Exactly.  Well, so you could see the problems inherent in this.  It�s not exactly a perfect form of authentication.  But I guess for PGP and the purpose of PGP it�s sufficient.



STEVE:  Well, yeah.  And it is - exactly.  It�s not like you�re going to rely on this absolutely.  What you really want is to meet up with the people you care about, like you�and I, Leo, you and I get together physically in�Vancouver...



LEO:  We should sign our keys.



STEVE:  We sign each other�s keys, and game over.  There�s no way now that anyone could spoof you to me or me to you.



LEO:  And it would be sensible at that time to look at a driver�s license or some other form of authentication, maybe more than one, to make sure that that�s the case.



STEVE:  I suppose that would be true if you and I...



[Talking simultaneously]



LEO:  ...know you.



STEVE:  Yeah, exactly.



LEO:  But we don�t even need to meet up because you could say, okay, right now I�m going to send you an email with my key in it, would you sign it.  That would work, too.



STEVE:  That would work, you�re right.  Because I was just trying to think whether any man-in-the-middle attack could attack that.  But no, because I�ve signed my own key.  So you could get my public key and verify that that�s my signature on my own key, and nobody else would be able to spoof that.



LEO:  Right, right.



STEVE:  So you�re right, you could establish trust in that�fashion.



LEO:  Cool.



STEVE:  It is.  And I found something that I�m excited about.  I�ve got one on order.  And I�m excited about it because it�s cool and it�s cheap.  I found a - it�s like a $20 1-gig USB storage device with a built-in fingerprint�scanner.



LEO:  Oh, clever.



STEVE:  $20.  Anyway, so I need to check it out and see how it works because they talk about how it only really works on Windows 2000 and XP.  It�s like, oh, okay, well...



LEO:  I�ll tell you why.  We�ve actually shown that and demonstrated it in a lab.  And it�s because it�s got software on it; right?  And so I don�t know if it�s a U3, same concept as a U3 USB key.  But it�s the same concept.  Whether it�s the same software, I don�t know.  But it automatically launches the authentication software.  And it has to run - it just has to run on XP or 2000.  There�s no reason it couldn�t run on Vista.  They just apparently haven�t written it for Vista yet.



STEVE:  Okay.  What I was hoping was that this thing did this internally, which would have been so cool.



LEO:  Well, it does have an internal encryption key, a unique internal encryption key.  So, yeah, but software running on the key, I guess not.



STEVE:  And in fact I intended to spend some time talking about U3.  The problem is, it gives me a queasy feeling to stick a USB dongle into the system...



LEO:  It should, it should.



STEVE:  ...and have it launch software, and for there to be no means for me to override that.  It�s just...



LEO:  Right.  In fact, we�ve seen that demonstrated.  I�ve seen hacker attacks that involved putting on a U3 USB key a hack keystroke logging software, rootkitted, so forth.  You plus it into a machine.  The software checks to see if it�s been installed yet.  If it hasn�t, it installs itself.  The hacker walks away.  This happens within 30 seconds.  Then comes back a week later, same key, checks, says, ah, I�ve been installed, let me download the database of logged passwords.  So this is a very, very dangerous technology.  And if you use a machine in a library or an Internet caf�, I think you should assume it�s been compromised in this way.



STEVE:  It�s probably the perfect example of the reason why�that�s too convenient.  I mean, we talk often about the tradeoff between convenience and security.  And it�s like, yeah, it�s really convenient to plug this thing into a�computer...



LEO:  Really dangerous.



STEVE:  ...and have it launch.  But oh my goodness, is it�dangerous.



LEO:  Really, really dangerous.  Well, you know, I guess I would hope there would be some way to disable that autorun in Windows.  But I�m not counting on it.



STEVE:  There must be, although in my looking at it, it creates a virtual CD drive and then another data drive.



LEO:  Okay, good.  Because you can turn off auto-mounting�CDs.



STEVE:  Right.  And in that case, so that�s the technology that it�s using in order to take over.  So, yeah.



LEO:  Very dangerous.



STEVE:  Although I think to remove it you need, at least when it was in, I needed to use their removal software to remove it, which of course is the first thing I did is I get this thing - this is a bad idea.  Get this off of this dongle.  I want all my four gigs back.



LEO:  Anyway, that�s right.  So don�t buy a U3 key, and disable it on all systems that you want to keep secure.  And by the way, if you�re a hacker, you can check out, I think it was Hak.5.  And Darren Kitchen told us how to do this, so go to Hak.5, Darren will tell you exactly what you need to know to make a bad, bad thing.



STEVE:  Well, in the future we will be covering various aspects of authentication.  And you know, Leo, I�ve got to say, the more I think about this SecurID token idea, the more I like it.  I mean, I�m wishing, for example, that there were a way to use - that individual end-users could get something like the SecurID token, and that there would be a service offered that websites could use to authenticate people, that is, rather than using my email address and a password, which continually makes me feel uncomfortable because I�m using static information to authenticate myself.  It�s difficult not to reuse that on other websites, I mean, it takes tremendous discipline not to.



Imagine if instead, like all websites - well, that�s not going to happen, but a large number of websites, or maybe some trusted entity provided a service where websites could say, okay, prove you are who you say you are, very much the way that this RSA model follows.  They give you a token.  You use some little app on your PC - again, obviously you�re on the Internet already.  You authenticate on the fly with some third-party authentication service that would use something like this kind of a time-varying token.  You provide that service with a token the site you want to authenticate to has provided you.  The service encrypts it or signs it or mutates it after authenticating you.  You then provide - you just cut, copy, paste.  You drop it back into the website.  So the website knows more securely that you are you than if you had given it your email and password because the website has no idea who�s just done that.  And you�re more secure because you�ve not had to give it anything that you�ve used anywhere else.  And it�s never the same twice.  It�s one-use authentication.  I just...



LEO:  I think we�re very close to that.  In fact, it may be somebody�s already doing it, and we just don�t know about it.  But, you know, the OpenID infrastructure could absolutely support that.  And right now most of the OpenID providers I know of don�t have a really good, secure authentication system.  You know, they just do it by email.  But it would be great if somebody came along and did that because there is the infrastructure to use an OpenID site as an authenticator.



STEVE:  Right.  And so the idea would be, if a user didn�t want super-secure authentication, they wouldn�t have to purchase a hardware token.  But I�d do it in a heartbeat - they�re not that expensive - in order to have the ability to log onto sites in a secure way that strongly authenticates me because of something I know and something I have.  And even if the site, I mean, the beauty of using a third party is then not every single site has to support all of the�infrastructure.



LEO:  Yeah, it�s very simple, they just support the OpenID infrastructure, and that would do it.  There�s got to be an OpenID provider that�s doing this.  And if not, there�s a really good business opportunity.



STEVE:  I think so, in the future, without question.



LEO:  I�d do it.  Yeah, I would do it.  This authentication stuff seems like it�s so important, and it almost in some way seems like it�s in its infancy.  And yet of course there�s a lot of work been done.



STEVE:  Right.  The beauty is, as we talked about many, many, many moons ago, crypto is mature enough now, it is in the public domain, we know how to do crypto.  And crypto provides so many beautiful solutions.  I mean, the idea that you could have a certificate, that somebody can sign it, and that that extends their credentials to your certificate; the idea that you�re able to publish a public key, and people can use that to encode and encrypt things that only you, who have the matching private key, can decrypt.



LEO:  So elegant, so beautiful.



STEVE:  It�s just, yeah, beautiful building blocks.  And I really believe, Leo, that downstream, I mean, I can�t think of anything more mission-critical than continuing to move forward on secure authentication technology.  I can foresee the day when a huge number of people will have little tokens literally on their key rings and just use them as part of going about their normal day.



LEO:  Might be how you get in your car, for crying out loud.



STEVE:  This is something I have.



LEO:  Yeah, I think it�s just great.  Well, thank you, Steve.  A fascinating subject.  And there�s obviously room to talk more about it, and we will.  And we�ll talk more about security in general every Thursday on this show.



You can get a copy of the 16KB version, for those of you with dialup connections, at Steve�s site, GRC.com.  It�s also where he puts the transcriptions so you can read along, show notes, and more.  That�s GRC.com.  And also find, of course, ShieldsUP! and all his free security software there, and the great SpinRite, the ultimate disk maintenance and recovery utility.  It�s a must-have for everyone�s toolkit.  That�s at GRC.com.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:		#95

DATE:			June 7, 2007

TITLE:		OpenID

SPEAKERS:		Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-095.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo examine the open, platform agnostic, license free, OpenID secure Internet identity authentication system which is rapidly gaining traction within the Internet community.� It may well be the "single sign-on" solution that will simplify and secure our use of the world wide web.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting. This is Security Now! with Steve Gibson, Episode 95 for June�7, 2007:  OpenID.



It�s time to talk about security, everybody.  Yeah, gather �round the radio.  Uncle Stevie�s Security Hour has come.  Every Thursday...



STEVE GIBSON:  There�s a new one, Leo.



LEO:  How do you like that?  That could be a new title.  Uncle Stevie�s Security Hour.



STEVE:  Yeah, I think we better just drop that now.



LEO:  Steve Gibson�s here from GRC.com, the creator of SpinRite, everybody�s favorite - certainly my favorite - hard-drive maintenance and recovery utility.  He creates all those great free security programs like ShieldsUP!, DCOMbobulator, Shoot The Messenger, Unplug n� Pray, the Click of Death - that was one of the first ones - and on and on and on.  And today we�re going to talk about - you said�OpenID.



STEVE:  OpenID, yes.  In fact, you referred to it when we were talking in our multifactor authentication, one of the two recent episodes where we talked about authenticating people.  And we were talking about, remember, I was making the wish, boy, wouldn�t it be cool if there was some third party, for example, that could take something really secure like RSA�s SecurID token, which uses the combination of a PIN and a slowly changing number, a number that changes once every minute, and so you had, like, really strong authentication, yet not every individual place you would want to use it would need their own authentication scheme.  Essentially there would be some third-party provider who was doing the authentication with you, sort of as a proxy, and then being able to say to this target site, yes, we�re sure this is Steve or Leo or whomever, and so it would sort of offload that.  Well, it turns out that is exactly what OpenID is and does.  And so we�re going to explain it all in the next hour.



LEO:  I think it�s great because I�m a kind of a fan of OpenID.  And I�d like to see it in more widespread use because all of these technologies, you know, aren�t meaningful unless - especially OpenID, but many of them are not meaningful unless everybody uses them, or a large percent of people use them.



STEVE:  Well, I�ll tell you, this thing has all of the feel of the way it should be done.  And it�s got also this - it feels very much like the way the web was originally designed.  It�s got the characteristics in every way I can see of something that�s going to be very successful.  There�s a little bit of intellectual property encumbrance that seems yet still to be resolved.  I think it�s a Danish company, has about a six-year-old - some intellectual property patent claims over something like this.  It�s like, oh, no, you know, please just give it away.  And in fact the OpenID.net site talks, explicitly says, you know, we want this to be as unencumbered by any intellectual property as it�s possible for us to have it be.  So, you know, let�s hope that gets resolved.  But I guess my point is that this thing has the feeling of the one that�s going to win.



LEO:  Shall we wrap up, before we go into this OpenID thing, wrap up anything from previous episodes?



STEVE:  Well, yeah.  I have a couple things.  I�m sort of - remember that I referred to the fact that we�re beginning to get comments, I mean, really interesting and useful comments from listeners, not just questions.  So I�m sort of calling this the "mailbag� portion.  And we went a couple weeks...



LEO:  We need a jingle.



STEVE:  Exactly.  I went a couple weeks without opening the mailbag, just because I�ve been running around at my wit�s end at this end and haven�t had a chance really to go back and do a lot of reading.  And now that I�ve done that, I don�t know, I�m wishing we were somehow able to share more of this than we can.  There�s just...



LEO:  Well, next week we get a question-and-answer session.  But I agree with you, I think we get such great mail.  It�s so fascinating.



STEVE:  It really is.  Anyway, Brad Berk- I want to say his name right - Brad Berkemier in North Sioux City, South Dakota, writes sort of very coincidentally - I tossed this in because of what we�re going to be talking about today - he says, "Show 94 really sparked my imagination.  I�d absolutely love to run my own OpenID server with SecurID authentication.  But the problem is, how much does a SecurID installation cost?  Will RSA even sell it to me without being a business?  I�m guessing there�s a software package you have to purchase, and then you can purchase SecurID tokens as needed individually or in packs.�



LEO:  I never thought of all this.  But he�s right, yeah.



STEVE:  Yeah.  He said, "I�d love to know more about that, if you have any idea.  If this isn�t possible to do on a personal scale, Steve should start his own OpenID plus SecurID business.�  He says, "I�d buy.�



LEO:  You don�t have enough to do.  You need to start a new�business.



STEVE:  That�s right, I don�t have enough projects in the queue.  Anyway, I wanted to share that because his note was echoed by a number of other listeners.  And I�m guessing that he�s right.  And I haven�t researched it relative to RSA�s SecurID, but I�m guessing they�ve got it locked up, it�s proprietary.  You need to use something that they�ve got complete intellectual property protection wrapped around and probably dripping in crypto so that it�s not possible to do sort of a free, open version that uses their tokens.



The tokens are so cool that I just purchased a bunch of them.  They�ve got credit card ones; they�ve got credit card ones with a little 10-key pad on them.  I mean, I�m not going to be able to use them for anything because I don�t have all the other software.  But just the idea of something, you know, a little key fob that�s got a six-digit number that changes mysteriously every minute, I just kind of liked that.  So certainly, you know, high geek factor.  But, you know, what the heck.



Anyway, Lars Solberg in Norway is using the USB fingerprint device I talked about wanting last time.  You may remember that I talked about one that I�d seen that was very inexpensive.  I think it was $30 or something.  It had a fingerprint scanner that apparently unlocked its contents.  But you had mentioned that you guys had looked at that, probably the same one, on the Lab With Leo.  This one was made by SanDisk.



LEO:  Yes, yes.



STEVE:  It happened that the day we recorded that podcast I found the box on my doorstep.  And sure enough, exactly as you said, Leo, this thing was dumb inasmuch as it only worked with Windows.  The good news is, I did plug it in, it�did launch itself, which, you know, always gives us a queasy feeling...



LEO:  U3, yeah.



STEVE:  ...when, you know, software on the dongle runs�itself.



LEO:  I think they�re using a U3-like system, but not U3�itself.



STEVE:  Well, it�s not.  Because I have looked at U3, and that just gives me the willies because, I mean...



LEO:  That�s really scary, yeah.



STEVE:  ...it�s really invasive.  It�s popping up menus and stuff, and you can�t get rid of it easily.  Anyway, at least the SanDisk solution is lightweight.  But it still is heavily dependent on the PC.  Well, Lars found one, and I will have a link in our show notes.  It�s at BioSlimDisk.com, so www.bioslimdisk.com.  And they�ve got one that is what I was hoping for.  It�s entirely self-contained, no drivers, OS independent.  And let me just read Lars� note.  He says, "Longtime listener, first mailer. During the last podcast you said that a USB stick that could just work everywhere with fingerprint authentication would be so cool.  Well, I�ve got some good news.  I have that ultimate USB stick, and I use it every day.  You can find it at...� then he gives the URL, BioSlimDisk.com.  It encrypts with AES 256, if I remember correctly, onboard.  So there are no extra drivers or anything that needs to be installed, and it works with every OS and device that supports simple USB sticks.  He said, "I even have used it on my TV, which has a USB input on it.  I just love this thing.�  He said it was hard to find it, but he did find it, it came in the mail, and he�s had it ever since.



LEO:  BioSlimDisk.com.  BioSlimDisk.  Oh, Bio Slim Disk.



STEVE:  Oh, you�re right, it�s Bio.



LEO:  I�m looking at the capitalization on the website.  It�s Bio Slim - you heard the music from the website.  Bio Slim Disk.  So now we know.  Not Bios Lim Disk.



STEVE:  Yeah, which doesn�t make nearly as much sense, although it does say BIOS, which you just sort of tend to lock onto.



LEO:  BioSlimDisk.  Okay, got it.  Good.



STEVE:  So, finally, I got a really neat SpinRite testimonial that I want to share with people from, again, a Security Now! listener, Russ Suter, who wrote, "I�ve been a regular Security Now! listener since about Episode 15, and I�ve loved it.  To show support for the show and for a little extra piece of mind, I purchased SpinRite a while back without any immediate need for it.�  And we know where this is going.  He says, "It sat on my shelf for a while until a good friend of mine who�s a CPA called me on Friday March 23rd, in the middle of tax season, telling me that his server had crashed with all his important client documents still on it.�  He said, "I rushed over and checked his backups.  They hadn�t run successfully in two months.  But with the hustle of tax season he hadn�t bothered to check�them.�



LEO:  Of course not.



STEVE:  "So I dusted off my copy of SpinRite and put it to work on the poor, tired, antiquated, SCSI drive inside his four-year-old server.�



LEO:  SCSI, wow.



STEVE:  Yeah.  He says, "It took until midday Monday...� - I don�t know what day that was he started.  But he says, "It took until midday Monday before it finished its job, and there were a whole lot of red U�s showing up.  But there were a lot more recovered sectors.  When it had finished, I took out the SpinRite CD; and, sure enough, the system booted up, and everything was running again.  It lasted the rest of the way through tax season, and by April 15th we were installing his new Dell server (with a RAID 1 mirror) and a complete offsite backup system with reporting, and copying all his data from the old server without any problems.  On behalf of my friend and the hundreds of customers who now have their 2006 tax returns filed on time, thank you.�



LEO:  And who probably never knew how close they came.



STEVE:  Well, actually you can tell that they really, you know, they saw the end of their life here.  Because, I mean, then he went to a RAID 1, full mirroring, and offsite backup.  And, you know, that happens often is that people will get SpinRite because they�ve had, like, a near death experience.  And it�s like, oh, thank god we�re, you know, all they needed was, like, one massive save.  And then they�ve learned their lesson; and they�re, like, never going to be in a situation, even though now they�re glad they have SpinRite, they just - they recognize because they came so close to complete loss of everything that now they�ve got to do something so that they�re not as dependent on any single point of failure as they were before.



LEO:  Very good.  Well, that�s a nice story with a happy ending.  Although I�d like to see RAID 5, not RAID 1, but that�s another story entirely.



STEVE:  Yes.



LEO:  Let us move on to the subject at hand, shall we?  I�m very interested to see what you make of OpenID.  We�ve interviewed a couple of OpenID people.  In fact, we did on net@nite a couple of months ago.  And I use a number of different OpenID services.  And so I�ve been intrigued by this for a while.  But it seems early days.  It seems like it�s not quite useful yet.  But you�ve done some research on how it works.



STEVE:  Well, it�s certainly, I agree with you, it�s early days inasmuch as I don�t think I have yet encountered a single site in my limited browsing, you know, I�m not nearly the pervasive web surfer that you and Amber are, Leo.  But I don�t think I�ve ever seen a site, or at least I�ve never noticed it.  Now, of course, it�s just like anything else, you know, you learn a new word, and suddenly everyone seems to be using that new word.  And you think, was no one using this word before I knew what it meant?



LEO:  AOL�s going to use it.  Digg�s using it.  We could use it on TWiT.  It�s actually available as a Drupal module.



STEVE:  Well, now, wait a minute.  Is Digg actually using it?  Because I went to Digg...



LEO:  They�re supposed to be.



STEVE:  ...hearing that Kevin had announced he was going to earlier this year.



LEO:  Yeah, they may not have implemented, yeah.



STEVE:  And it�s still not there yet.



LEO:  Yeah.  I think AOL is using it now.



STEVE:  Well, actually AOL definitely is using it.  And it turns out that the way they implemented it, and I�m going to explain how this is possible, is they�ve said any AOL existing users, that is, your existing log-on credentials, can be used as an OpenID authentication.  So...



LEO:  If you have an AOL account, you�ve got an OpenID.



STEVE:  Exactly.



LEO:  Neat.



STEVE:  Exactly.  And AOL ID is an OpenID server, which we�re all about to explain.  So here�s the idea.  First of all, OpenID allows what�s known as a single sign-on capability.  Without something like this, we�re where we are today, where every site we go to wants our userID - sometimes it�s our email address, for example - and then a password.  And as we�ve been preaching for a long time, Leo, in order to minimize the risk of a single site being malicious, it�s good practice to come up with different passwords, maybe different usernames, and not heavily reuse those because, again, the danger is you�re authenticating yourself with each site you visit one-on-one.



The reason I was so stoked about the idea, for example, of a SecurID base, that is to say, RSA�s secure token, is that, first of all, it gets the strength of multifactor authentication by bringing something you have, meaning the token, and something you know, which would be your matching personal password or PIN.  It would bring that multifactor authentication to the concept of single sign-on, meaning that there�s some other entity than the website you want to authenticate yourself with.  That entity is the one that you build an identity and a trust relationship with.  And then the site you want to authenticate with asks that third party, is this really that person.



LEO:  So this isn�t anything new.  In fact, Microsoft did this; AOL has done this before.  Microsoft�s Passport is still around, although not particularly vital, but I still use Passport on a few sites.  That was the idea; right?  You�d have a Passport account with Microsoft, and then log into Expedia and various other sites using that.



STEVE:  Yes.  So you�re right, it�s certainly not a new idea.  What is fantastic about OpenID is that, as I mentioned before, is it is absolutely open.  I mean, open, open, open.



LEO:  It�s not Microsoft�s; it�s not AOL�s.  Nobody owns it.



STEVE:  Right.  The protocols are all absolutely in the public domain.



LEO:  Yeah, I like that part.



STEVE:  Hopefully this isn�t going to run afoul of anyone who comes along and says, well, we actually invented this, because you know how I feel about people inventing things that are neat but sort of obvious.  Hopefully there will be some clear prior use of this concept, even if not in this exact implementation, that would water down and hopefully prevent somebody from locking it down.  But, for example, there are implementations of this in C#, in C++, Java, Perl, Python, Ruby, PHP, Cold Fusion.  You know, and looking at the list I�m thinking, wait, no Assembly language?  Waits...



LEO:  I think you could implement it.



STEVE:  I think I could probably handle that.  But, okay, so one of the reasons that this, for example, this differs from Microsoft�s Passport is that, you know, that was all about Microsoft.  OpenID is not.  And in fact, Microsoft is one of the major people embracing OpenID and planning to integrate it into the system that they have got, which is CardSpace for Vista.  And that�s one of CardSpace and Windows will be a topic that we are going to be covering here before long . But so even Microsoft is saying, okay, Passport didn�t really take.  And of course nothing that is sole provider is going to.



One of the so cool things about this is that any user can have total control.  There�s no centralized authority.  Users can choose their own authentication servers.  Now, I�m avoiding all of the jargon of OpenID because there�s a ton of jargon, and that�s just confusing.  So I�m going to use general terms that we understand.  I�m sure this will not be the last time we�re talking about OpenID.  So we�ll drill down into the specifics over time.  But in general I want to explain how this works, why it�s so open, why I really think this is the one, and basically what problems it has and the different modes it has of operation.  So again, the idea is that the single sign-on model which is the goal, exactly as you said, Leo, with Passport, is that you would, well, as this becomes more prevalent, sites would offer you the opportunity of using your OpenID if you had one.



LEO:  So you could, for instance, come to TWiT.com, and we would say use your TWiT password; but, if you have an OpenID password, you can also use that instead.



STEVE:  Exactly.  It�d be like we will accept that, too.  Now, an example of this that many people may be familiar with, for example, is PayPal.  I am a heavy web commerce user, and I absolutely look for a PayPal option if I�m buying something on the �Net from some random site that I�ve never worked with before.  I will always try to purchase from Amazon because I would rather lump my trust with a single big provider who has a ton to lose if they ever screw up the security side of things.  I mean, could you imagine a bigger disaster than Amazon�s user passwords and database and purchasing patterns and credit card information and everything escaping?



LEO:  Say it not.



STEVE:  Right.  So one imagines they are being really, really, really responsible.  Now, you compare that to some random Mom-and-Pop site somewhere.  And I just, I do not want to give them my credit card information.  Hopefully enough people feel that way that that puts pressure on them to accept PayPal.  And so on sites where I can use PayPal, I never fail to do so because there I am giving them - essentially, PayPal is exactly this kind of solution for my credit information, where I end up bouncing, you know, they bounce me to PayPal, I log in there with my PayPal credentials, say to PayPal, yes, I�m me.  And what happened was the site where I was sort of sent some shopping cart information along with my bounce, my redirection to PayPal.  I�m talking about this because this is also very much the way OpenID works in a couple of its simpler modes.



So now I�m at PayPal.  I log into PayPal, choose the way I want to pay, do I want to use my credit card, my bank account, whatever.  Say yes, I want you to send money, PayPal, back to the site where I was.  So PayPal takes the money from my card, verifies it, and then bounces me back to the site where I was.  And that site, having got authentication from PayPal that basically the money is now theirs, says oh, good, we�re going to ship your goodies to�you.



And, now comparing this, I want to make one more comparison because I�ve recently become a fan of Google Checkout.  And I prefer it to PayPal because Google has more information that they�re able to provide.  And that is, specifically, I don�t have to fill out all the other stuff about myself because Google�s got my shipping address and my billing address; whereas PayPal is limited just to the financial transaction.  So if I�m somewhere and Google Checkout is offered, I find that even nicer because I log into Google, and I don�t have to fill out all the other information.



And again, I mention this because that�s also something that some OpenID extensions will be, well, currently do and will be used more in the future, that is, you�re able to control a flow of information that you control back to that website to, for example, populate forms with all of your standard boilerplate information after you�ve authorized that site to receive it.  So I really see an evolution here.  And OpenID, I�m guessing, is going to be the one that wins because it is�nonproprietary, it�s completely open, and it�s extremely�lightweight.



Now, the way this works in practice is an OpenID, that is, this token, this string that a user uses to identify themselves is just a URL.  It�s a URL of a page on the web that they control, they or a friend of theirs, you know, Uncle Steve or Bob or somebody.  Or maybe it�s a blogging site that offers the ability to host OpenID stuff.  One way or another, it�s a URL of a page.  Now, what I liked about it, you�ve heard me complain about the http://www nonsense.  In the OpenID spec you specifically don�t need to provide that because the recipient of this token knows to stick all that junk on because you�re giving it a webpage URL.



So I�m going to a site where I want to authenticate myself using the OpenID system for whatever reason.  So I put in this string, which is basically somehow to a page that I control.  It can be my own server, it can be somebody else�s, doesn�t matter.  So that site pulls that page from the Internet and looks for essentially a tag in the header.  It looks for an OpenID tag which will contain the URL for the server I have assigned as my OpenID authentication server.  So there�s sort of a level of indirection, meaning that I give a tag pointing to my page.  My page provides the URL for the server that I want this site that I�m wanting to authenticate myself to to go query in order to authenticate�me.



LEO:  Yeah, I�ve done this with - so you�d have an OpenID provider, but you could have it be your own site that you supply when you log into an OpenID page.



STEVE:  Well, yes.  And in fact, I mean, all of this is open source.  So there are already, I mean, there�s a ton of servers written in PHP and Java.  There are servers, you know, anybody - you could run one on your computer at home with a serving port 80, a standard web port open, and easily create your own little personal OpenID server.



LEO:  Yeah, but then it�s not trustworthy, is it?



STEVE:  Sure, because...



LEO:  It�s you.



STEVE:  Yeah, exactly, you�re controlling it.  Now, one of the things I want to be clear about, and we will as we go through the way this protocol works, it is a barebones protocol.  And it�s why I think it has a chance of succeeding, much as the original HTML was, oh my goodness, compared to today�s web pages, you couldn�t do anything like that.  But it�s because it was so simple, and it was easy to implement, and inexpensive, and nobody claimed ownership of it, those are the things that blasted the web into existence.  And people could, like, copy other people�s web pages and say, oh, I�m going to change the color to green, but otherwise, look, my web page is already done.  I mean, it was so simple.  And this protocol has all of those characteristics.



So the site that I�m wanting to authenticate myself to gets a page whose URL I have given it.  From that it gets the URL of the server I have chosen as my OpenID authentication server.  Now it takes my little handle and some other information about the transaction that is sort of a blob of stuff.  And one of the things it gives the server is the page it wants the server to come back to, which will make sense in a second.  Anyway, so basically it responds, and I should first say that there are several operating modes for OpenID.  I�m going to first run through the simplest that requires the least intelligence and implementation overhead on the site that I�m wanting to authenticate to.  And it�s very much like the model with PayPal.



So essentially, when I submit my token, my authentication name to this site I want to authenticate to and click the button, my browser is redirected - after that site picks up the URL of my OpenID authenticator, my browser is redirected to that server, carrying with it a bunch of extra information from the site that I want to authenticate to, including that URL to send me back to when we�re done.  So basically now my browser is at my authentication server, and we can do whatever we want to authenticate.  And this is one of the beauties of this, one of the reasons this thing is so open is that no one is saying what I, my browser and my OpenID server, need to do.  It could be as simple as establishing a secure connection and using my, for example, an SSLD client-side certificate to prove, you know, which contains my own public key, which has been signed by a common certificate authority.  It could be something like that.  I could be prompted with another log-on username and password.  I could be asked to stick my SecurID USB token into the computer or swipe my finger on my PC�s fingerprint scanner.  I mean, virtually anything.



So that�s one of the cool things about this is that now I�m having a dialogue with whatever authentication provider I�ve chosen, using whatever level of authentication I care about.  Remember that this is a service for me, so no one is imposing any criteria on this.  Certainly, if this is an ecommerce system, or I�m wanting to authenticate to my bank, then I want a very trustworthy third-party authenticator and whatever level of trust and authentication credentials I think is sufficient.  But again, it�s all up to me.



So once that�s done, once I�ve satisfied the authentication server that I really am me, then the authentication server uses some crypto stuff and the information that was provided by the site I�m authenticating to, basically to re-redirect my browser back to that original site.  So in that sense it�s like the trip you make to PayPal to authenticate yourself with PayPal.  But in this case it�s not an ecommerce transaction, it�s sort of a generic authentication�transaction.



So now I�m back; my browser is redirected back to the site where I want to authenticate myself.  It is able to look at, essentially, the data that came back with me, which it presumes is the information that came back from this authentication third party.  But there�s one weakness in the system, and that is that all of this came through my browser.  So we want to make sure, over on the site that I�m wanting to authenticate myself to, we need to make sure that this really came from that third-party authentication server.  So now the site I want to authenticate myself to creates a direct connection to the authentication server and asks that server to validate the signature that it has that has come through the browser, and does it directly.  That prevents the client-side of this, this whole little redirection bouncing, from being corrupted undetectably.  At that point the site that I want to authenticate knows that the server I chose to do the authentication has said yes, this is this person who wants to authenticate, and by having a direct connection has verified the credentials that came back from the browser, and I�m logged in.



LEO:  So there�s three sites - let me see if I get this.  There�s three sites here.  There�s the site I�m trying to get into.  There�s my site, which is where I store a credential for myself.  Although this is unnecessary, but you could have your site be doing this.



STEVE:  Yes, you could, and that could be the same as the security provider.



LEO:  OpenID site itself, yeah.



STEVE:  Exactly.



LEO:  So I use ClaimID.com, which is one of many OpenID - but there�s a lot of these guys, and they�re all trying to have certain value-add features on top of the OpenID.  There�s Jyte.com, there�s ClaimID, there�s quite a few.  Anyway, I use ClaimID, among others.  I use Leoville.com as my server.  And so let�s say I�m logging into TWiT.tv using OpenID.  Instead of providing it with other credentials, I would just give it Leoville.com in the OpenID space.  It would then go through Leoville.com to my OpenID provider, ClaimID.  Which would then put up a log-in page using the ClaimID log-in and password.  I�d enter those credentials.  ClaimID would then say to TWiT.tv, yup, he is who he says he is, and I�m logged in.



STEVE:  Exactly.



LEO:  There�s a little back-and-forth going on there.  I�m just trying to simplify it.



STEVE:  Right.  Now, there is a nicer mode, I mean, one of the things that�s cool about this is what I just described was sort of like the simplest, least technology required anywhere approach.  If you allow some scripting to go on, server-side and maybe client-side scripting, as well, you�re able to make a quicker process, where, for example, in the model I just showed, you�re always bouncing to your authentication server, so your whole web browser goes bounce over to the authentication server, where you authenticate yourself, and then you�re bouncing back.  There is extensions to the protocol which allows that process to be bypassed.  It�s possible for the site you want to authenticate to to create a direct connection initially to your authentication server, providing it with your ID, saying do you authenticate this person?



Now, for example, you could provide a list of sites where you just want de facto authentication, or a timeout from the last time you authenticated yourself, you know, any kind of features.  And again, what�s so cool about this is that it is wide open.  It is a fertile ground, sort of a basic structure to support this fertile ground of innovation and value-added and services-added, exactly as you were saying, Leo, with ClaimID, where any way people want to have this work, there�ll be someone providing it, and you could easily do it yourself.  So the mechanism, for example, might be where for certain sites that you�ve identified you don�t want to be forced to go through a reauthentication.  And if, for example, a timeout has expired, then instead a small log-in window, a little browser pop-up window could come up where you do have a connection to your authentication server and log in in order to prove you�re you; and then the site you�re wanting to authenticate to is able to get that updated authenticated information, confirm it, and log you in.  So it can be nicely transparent.  And I�m sure that Microsoft will be moving in that direction with Windows where the transaction to the third-party server could probably use your Window log-on credentials, maybe other things on the fly.



LEO:  Oh, that�s interesting.  That�s a good point.  So if you�re logged on to your Windows account, you wouldn�t have to enter anything more.  It would just say, okay, there you�go.



STEVE:  Exactly.  And so...



LEO:  Oh, that�s kind of neat.



STEVE:  Well, it�s going to be, I think, really cool because over time it�s going to get easier to use, and we�re going to begin to see spreading adoption of this.  Just as PayPal is becoming more popular and Google Checkout is becoming more popular because people are more comfortable trusting single sources, this kind of single sign-on will end up changing the way people use the web.  And of course at some point it will acquire critical mass, and so there will be websites under pressure to support this.  Users are going to say, look, I don�t want to have to come up with a username and password for your rinky-dink site.  I want you to support OpenID.  And it�s going to be so easy to do so, no cost incurred anywhere, and a fundamentally very securable�technology.



Now, there are some scary things.  For example, this is all DNS based, and we know that DNS isn�t the most secure of all protocols, which is putting it mildly.  I mean...



LEO:  So there could be a man-in-the-middle attack here?



STEVE:  Yes.  And so, for example, there is the use of strong crypto where necessary.  OpenID does specify a Diffie-Hellman key exchange at one point in one of its modes.  And I would argue that you want an SSL connection so that you avoid man-in-the-middle attacks, and you�re going to want to verify certificates.  So but none of that is required, which is sort of good and bad.  I�ve seen some people on the web complaining that it�s possible to run OpenID in a nonsecure, in a non-bulletproof mode.  And you could say, well, yes, fine, if I�m just wanting to go to some other blogging site to post a comment, and I don�t want to have to create a log-on account for some random blogging site, I�d like to use my credentials at my main blogging site, you know, in a transportable fashion, you could say, okay, so make the technology scale with the amount of authentication security that you need.



And again, for something really secure, where you�re doing your online banking and you�re not wanting to have to again authenticate individually, well, there you�d want your authentication server to require contact over SSL by the site you want to authenticate to, require SSL in its interaction with you, if any.  And so again, that�s up to the user.



What�s so beautiful about this is it is, you know, that kind of burden, that kind of cost, for example, SSL certificates, I mean, I have to buy one every couple of years from VeriSign, and I grumble every time I do, it�s worth it for me because I want, of course, secure ecommerce for GRC.  But the nice thing is there are free, non-SSL OpenID servers that are very useful, so long as users understand what level of security they are providing.  And certainly there are commercial ones.  I mean, VeriSign has one.  And there is a�- I�ve got a bunch of links that are in the show notes, Leo.  So for people who are interested in this, by all means check out the show notes for this episode because there�s lots of places - and again, you�re already an OpenID user,�so...



LEO:  I have about four of them.  But I�ve ended up settling on ClaimID.



STEVE:  I was going to say, that�s a little against the principle, Leo.



LEO:  Well, I try stuff out.  You understand.



STEVE:  I do.



LEO:  And each of these OpenID providers has, as I said, as a kind of a come-on to use their service, they offer different things.  Like ClaimID, for instance, has a whole page where you can say "I claim these pages on the web; these are not mine.�  So I use that service.  And so the OpenID is kind of a side benefit to it.



STEVE:  Yeah, it�s one of the things that the OpenID system identifies itself, and it�s very clear to explain, that this is about identity, not trust.



LEO:  Oh, yes, and that�s good, that�s good to make that distinction, isn�t it.



STEVE:  Yes.  Because trust requires identify, but not the other way around.  You have to be sure about who it is that you�re trusting.  But in order to identify someone uniquely, that doesn�t imply anything about trusting them.  That just means who they are.  So by making that distinction very clear, that�s one of the ways that the OpenID system has sort of kept itself at a lowest common denominator, completely open source, completely open spec.  As you said, there are hundreds of servers all over the world.  Many of them are, well, probably I�m sure most of them are free.  Even the secure ones are free.  Anyway, I think we�re going to see this is the system that ends up taking hold.  And it has been thought through carefully.  It�s got the feel of lightweight, Internet-style protocols.  And it�s so open that people are going to be building more onto it.



LEO:  I wish Microsoft and Apple and Linux would support this in the operating system.  And that would really be fantastic.  Then when you log in with your secure credential on your operating system, you�d automatically have an�OpenID.



STEVE:  I think it�s just a matter of time.  It is relatively new.  It�s only a few years old.  It�s catching on fast.  And I look for the day when we�re no longer sitting here jumbling individual passwords, coming up with personal password protocols and all the stuff we�ve talked about for managing the fact that, to be really secure, you want to not share your ID.  This allows exactly what we�ve been talking about where you establish a strong identification, authentication relationship with one server; and then, using an open, free protocol, all the other sites on the �Net are able to ask it if you�re who you say you�are.



LEO:  Now, I just want to underscore - and you said this, but I want to say it again.  This is not identity verification in any way.  You can create an OpenID that says you�re Steve Gibson.  It�s just a way of having a single password for all the sites you visit.  It�s not like a PGP signature.  There�s no web of trust, as you point out.  There�s no verification.



STEVE:  Well, now, a perfect example, though, of an extension to this would be you could imagine a commercial service that wanted to provide exactly that, you know, full industrial-strength identify verification.  So it would claim that that�s what it�s going to do.  It�s not going to ever say it has identified someone where that person hasn�t first gone through some rigorous protocol for establishing their true identity with that service.   So in the same way, for example, that GRC every few years, in order to get an SSL certificate, I have to really prove to VeriSign that I�m me, Gibson Research Corporation, a corporation still in good standing in California, blah blah blah and all this stuff, in order to get that GRC.com certificate that allows me to establish a secure connection so that people who connect to my server know that it�s really me.



Similarly, you could have a service that is going to go put users, end-users, I mean, you know, individual people through some sort of similar wringer so that, if you use them as your authenticator, and the only way they will authenticate you is if they�ve proven your identify beforehand, then that�s a perfect example of additional features built on top of this system.



LEO:  Right, right.  So that�s exciting.  I hope it does take off.  Of course it�s meaningless unless sites start using it.  If Amazon starts using it, and Travelocity, and Expedia, you know, the sites that you shop at, L.L. Bean, wherever it is that you go, then that becomes exciting.  I�d love - and if Amazon would get behind something like this, I�think that that would be enough to kind of put it over the�top.



STEVE:  Well, it certainly does need that kind of ubiquitous support.  But I remember, as I�m sure you do, Leo, the early days of the web before virtually everyone in the world was on the web.  And it was like, well, remember we used to talk about the chicken and egg.  Well, yeah, maybe this will take off; but unless the things I really want are on the �Net, then why?  And why are people going to go on the �Net, put themselves on the �Net before it really exists?  How is it going to achieve critical mass, blah blah blah?  Well, it just happened because it was so inexpensive to do it.  And at some point companies had to be on the Internet or they were going to get left behind.  And although there isn�t the same sort of you�re-here-or-you�re-notness to this, and there are, like, other ways to authenticate, I can see that pressure will be put on sites once OpenID becomes the way people want to authenticate themselves.



LEO:  So next week we�re going to answer questions.



STEVE:  Q&A Episode #20.



LEO:  Yay.  I�m so happy.  I love doing those Q&As.  Meanwhile, you can, of course, get a 16KB version of this show, as always, from Steve�s site, GRC.com.  He has transcripts there, show notes, and more.  That�s GRC.com/securitynow.  You can also, of course, get his great program SpinRite, everybody�s favorite, my favorite, disk recovery and maintenance utility.  SpinRite.  It�s available from GRC.com.  While you�re there, check out ShieldsUP! and all those free security utilities.



Steve, we�ll adjourn and get back together with Uncle Stevie�s Hour O� Security.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:		#96

DATE:			June 14, 2007

TITLE:		Listener Feedback Q&A #20

SPEAKERS:		Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-096.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 96 for June�14, 2007:  Your questions, Steve�s answers, #20.



It�s time to talk security with our friend Steve Gibson, from his highly secure and unknown workplace somewhere in Southern California, tempest protected.  Here he is, Steve Gibson.  Hello, Steve.



STEVE GIBSON:  Hey, Leo.  Great to be back with you again.



LEO:  This is a question-and-answer session, and we do love doing those.



STEVE:  This is our 20th question-and-answer session, and people - really, I get lots of good feedback from people.  In fact, now they�re writing notes in saying, okay, this is for - and they�re, like, telling me which one they want to appear on.  It�s like, uh, okay.



LEO:  It doesn�t quite work like that.  However, I bet there are a few people who want to appear on the next one, which will be Episode 100.



STEVE:  Ooh, yes.  Oh, that�s right, that�s a Q&A.



LEO:  Yeah, hmm, mod 4.



STEVE:  Gee, is 100 evenly divisible by 4?



LEO:  Not if it�s a leap year.



STEVE:  I think it is, yeah.



LEO:  Anyway, let�s get on here.  I�ve got a PDF open that�contains...



STEVE:  Well, I�ve got a couple mailbag pieces here.



LEO:  Oh, good, all right.  I didn�t even know we did mailbags on the Q&A days.  I thought we�re already answering questions.  But we have a mailbag.  We might as well do our�mailbag.



STEVE:  It�s quick, it�s just two things.  Justin Alcorn of Cleveland Heights, Ohio writes - he had a number of neat points.  He said, "A couple of quick points on your Fourth Factor episode.  First, I�m glad you�re covering these authentication issues.  Too many people assume that a username and a password is two-factor authentication, including a government agency that lost a laptop and assured the public that it was secure because it was protected by two-factor authentication."



LEO:  Oh, man.



STEVE:  Meaning the normal Windows log-on.



LEO:  Oh, man.  I hope that was not disinformation.  I hope that was just ignorance.  Or maybe not.  Actually, which is�worse?



STEVE:  It certainly sounded good.  Then he says, "There is a wonderful add-on for Firefox called PasswordMaker.  It allows you to use a single password, and it hashes your password and the domain name of the site you are currently on to create a unique, random-looking password for each site.  Since the hash is created the same way every time, you can get your password from any computer with the browser, or use the online JavaScript version if you are on a different computer."



LEO:  I use something similar from Zarate Labs, same exact�idea.



STEVE:  Yup, and I like it.  And for what it�s worth, there is also an add-on for IE.  They don�t have screenshots of it.  They�ve got screenshots of the Firefox version on PasswordMaker.  But I just wanted to - I thought that was a cool thing, and I�ve heard about it, so I wanted to relay that from Justin, our listener.



LEO:  That�s a good way to do it.



STEVE:  And then he says, "When talking about the PGP web of trust, there are two things you didn�t mention."  Actually there�s a lot of things I didn�t mention because I was trying to keep it somewhat simple and maintainable.  He says, "You can choose how much you trust each signatory of a certificate.  If you know people who just sign anything presented to them, you can trust them only a little.  If you know people who are very careful, you can trust them a lot."  Then you can sum up the trusts of people who�ve signed a given certificate - I added that part for clarity - to determine if you trust the certificate of a new contact.  "Also, when determining whether to sign someone�s key, you should verify the key fingerprint to make sure you�re signing the correct key and not one that was presented to you by a man in the middle."  And of course he�s absolutely correct about all of that.  So there was more complexity, a lot more, actually, to the whole mature implementation of the PGP web of trust, specifically this notion that you get different sort of point credits for who signed it and how much you trust them.  You then can, like, create rules in your system that�ll automatically decide whether this is trustworthy enough or not.



LEO:  Right, right, right.



STEVE:  And then Christopher Adams, also a Security Now! listener, he wrote, "We have Albuquerque�s largest Christian home school association meeting next week at the church I work for.  And right on cue, the laptop that contains all the data for this event crashed."  He says, "The backup was stored in the North Pole with Santa, where the Easter Bunny and the Keebler Elves are keeping it company."



LEO:  What he�s saying is there�s no backup.



STEVE:  Either that, or when we went to look for it, we couldn�t find it.



LEO:  Oh, boy.



STEVE:  So he says, "Now, there were no problems with the hard drive, just a problem with the power adapter.  So we simply needed the data quickly so we could move on with our work.  I popped the drive into a USB enclosure, and sure enough, the drive failed."  And so he says, "I guess having the power abruptly cut on a regular basis was not good for the laptop drive."  And actually I chose this one because this actually perfectly fits with one of the questions in the Q&A.  So he says, "After fighting through numerous error performing in page operation errors and learning that the solution was to buy a new hard drive, I quickly put the hard drive in a desktop case via a nifty $5 adapter, along with a CD containing SpinRite.  Four and a half hours later, the service of this 60-gig laptop drive had been refreshed, and it now worked perfectly."



LEO:  Wow.



STEVE:  He said, "I�ve been anxiously awaiting a moment like this where SpinRite paid for itself, and am happy to say it was worth every penny.  And we bought four copies for a site license," exclamation point.



LEO:  Oh, that�s great.



STEVE:  So he had actually written this to Sales at GRC.  And he said, "Thanks, everyone.  I cannot describe how much this has helped us.  And it is a great case study for when I propose a file server with RAID and a backup system, instead of relying on individual hard drives."



LEO:  That�s what I like about you, Steve.  You don�t mind reminding people that they wouldn�t need SpinRite if they would just back their stuff up.



STEVE:  Yeah, I mean, I�m happy to be the solution that saved them the one time they desperately needed it and to suggest, you know, I hope to be able to help them a second and a third and a fourth time, and of course we�ve got owners whose butts have been saved by SpinRite throughout, you know, its 20-year life.  But really, for mission-critical stuff, you don�t want to rely on a single spindle because, as we continually prove, they�re just not safe�enough.



LEO:  Spindles die.  Let us get to our questions, shall we?  We have so many of them.



STEVE:  Our typical 12.



LEO:  Our typical 12, starting with Mark Brown of Cumming, Georgia, who says:  I listened to Episode 90 - that was the one we did on multifactor authentication, the first three factors.  And I wanted to know how to check for the certificate when I�m going to my banking site to make sure I�m really on the correct site.  So he�s in his browser.  He�s gone to his banking site.  How does he know?



STEVE:  Now, we�ve talked about this many times, but I don�t think this is something I could say often enough because I�ll tell you, Leo, I mean, you know me.  I�m not running AV.  I�ve behind NAT.  I don�t do scripting.  I guess my point is, you know, I�m security conscious, but I feel that I�m generally pretty safe.



Well, having said that, one of the things I always do when I find myself about to enter my credit card information somewhere is I first make sure I�ve got https, and that the browser thinks I�m secure.  Then I right-click on the page, choose Properties, and then choose View Certificate to make sure that, I mean, just to verify that no new phishing scheme has come along which is spoofing this page.  And I always do this on PayPal because, of course, the larger the target is, the more likely it is to be spoofed.  And so I make sure that the certificate that I�m viewing for the site is https://www.paypal.com.



So you want to right-click on the page, then tell the browser, you know, look at the page properties, then click on View Certificate to see the certificate.  Then the one other thing you want to do is look at the chain of trust, that is, look to see who signed that certificate.  Because if it�s Boris Badenov that signed it, then the certificate means nothing.  The certificate is only as useful as the entity that is vouching for it, specifically, you know, someone like Equifax or VeriSign or somebody who is a standard signing authority.  If your own, for example, if your corporate - if you had a browser had a corporate certificate installed in it, then your corporate proxy could be decrypting your connection, looking at it, and then reencrypting it.  And so that�s something you might want to know.  So you want to make sure that your certificate, that is, the certificate of the site you�re presented with has been signed by an authority you trust and that you�ve got a certificate for that site.  And that will verify you�re actually connected to where you think you are.



LEO:  Now, it�s a little different, slightly but not significantly different, in Firefox.  You still right-click.  And by the way, you have to be at https; right?  I mean, otherwise there won�t be a certificate.



STEVE:  Correct.



LEO:  So I went to Amazon.com, and normally it�s http.  I added the "s."  Now I�m at https Amazon.com.  I right-click on the page in Firefox, select Page Info, and then click the Security tab, and you can view the certificate from there.  And it�s RSA Data Security.  Are they okay?



STEVE:  I think we trust them, yes.



LEO:  We trust them.



STEVE:  We trust them.



LEO:  That�s who you get yours from; right?  Or is it�VeriSign?



STEVE:  I�ve always been using VeriSign.  It�s like, eh, why not, I�ll stay with them.



LEO:  Very good question, though.  And I think it is well worth saying again and again.



Paul Dickson of Phoenix, Arizona is concerned about biometrics.  He writes:  I�m of the opinion that gathering biometric data for identification purposes should be illegal.  It�s fine you have the data on your notebook locked with your fingerprint, but can you or your estate survive if the data becomes inaccessible?  If you�re in an accident where you lost a body part, are you prepared to not being able to access the disk contents?  Of course backups would help, but what about changes since the backup?  Disk recovery is going to be extremely costly.  Alternatively, if you�re separated from your notebook, no one would be able to access your data until you�re rejoined.  Not even trusted family can help.  I�ve been told by someone who no longer has fingerprints, it�s quite common for nurses to lose their fingerprints.  The fingerprint scanner might - must be the caustic chemicals they�re using or something.  The fingerprint scanner might not be very useful for them.  Then there�s a problem of whether a replaced fingerprint scanner on your notebook will scan your finger in the same manner.  Steve, raises some interesting questions.  I�m not sure making it illegal is - I think that�s going a little far.  But he makes some good points.



STEVE:  He really does.  So I wanted to bring up - it brings up a couple things.  First of all, for what it�s worth, the fingerprint scans, for example, that I use for my laptop is a convenience measure.  If I�m unable to authenticate with my fingerprint, I can always fall back to a password.



LEO:  Oh, it doesn�t eliminate the password.



STEVE:  Exactly.  So basically, if my fingerprint matches what it expects, then it�s providing the password to the BIOS in order to unlock the machine and to unlock the hard drive.  And on this note I wanted to mention that, when I was doing some research into this stuff a couple weeks ago, I discovered Hitachi has announced and will soon, if not already, they are shipping, I mean, the galactic perfect solution for laptop hard drives.  It has bulk AES 256 encryption built in.



LEO:  To the hard drive.



STEVE:  So that it�s not just locking the hard drive.  You have to give the hard drive, any time you power it on, the cryptographic key that it will then use for all communication with the magnetic surface.  Which means, I mean, this is what you want.  Which means that all the data on the hard drive is always encrypted, not just locked, but a lock in the hard drive�s own BIOS, where you could have a data recovery company get past that and then access it.  I mean, we�re talking strength that is absolutely transparent.  They�re doing bulk encryption that does not slow down the drive at all.  That is, it�s on-the-fly encryption to the surface.  I mean, this is exactly what you want.  Then, if you lose control of your laptop, it�s like, well, that�s too bad, but at least nobody can get to the data.



LEO:  But what about Paul�s point that nobody can get to the data?  What if something happens to you, and your family needs to see the data?



STEVE:  Well, for example, in the first place, you know, when for example I authenticated a number of my fingers, just in case, if something did happen to one of them, to my right hand, I can authenticate with the other.  And being me, you know, I sort of alternate consciously just to make sure that both of my index fingers stay happy.  But again, in the worst case I�ve got a password.  I don�t want to, because as you know I�ve got a super strong password, so I�m not going to be typing that in easily all the time.  And in fact, because my fingerprint can help me type in my super strong password, I was able to use a much stronger password than I would normally have bothered to.  So but again, you could certainly - you could answer Paul�s concern just by knowing that you always have the password as your backstop for your fingerprint.



LEO:  I think he didn�t know that.  So that�s good to know.  I didn�t know that.



STEVE:  Yup.  And that was the point I wanted to make.  That and to remind - I forgot to mention this Hitachi drive, and I�ve been wanting to because, oh baby, I mean, that�ll end up being standard equipment on laptop drives before long, and it really provides us with the security that we need.



LEO:  Yeah, interesting.  John Everett writes from Virginia:  I just finished listening to your SQL Injection Security Now! podcast.  When you get to the point about how a hacker could get an improperly configured machine to divulge a list of all usernames and associated passwords, I had to write and ask, do people really stand up production websites that record passwords in plaintext?



STEVE:  Uh-huh.



LEO:  I�m no security expert, but I thought the days of a passwd file - these are the UNIX passwords, p-a-s-s-w-d file - or equivalent were long gone.  Isn�t it standard practice now to hash the password plus some salt into a key that�s stored?  They call these encrypted password hashes.  So even if a hacker got a list of usernames and the keys, that wouldn�t be of immediate use because you can�t enter the key directly into the website.  Maybe you were glossing over this aspect in the podcast?  In any case, I heartily agree with you, SQL injection remains a frightening vulnerability on the web.  You were giving that as a example.  It�s not the only thing you can do with SQL injection.



STEVE:  Well, correct.  But the point I wanted to make, the reason I brought this up, was that the insecurity is not only in the SQL injection problem, but in exactly what he says.  That is to say, when he talks about there are well-known ways to do this right, he�s absolutely correct.  It doesn�t mean that random Joe PHP programmer who just bought "PHP for Dummies," and it turns out that book is unfortunately correctly named in his case...



LEO:  Aptly named.



STEVE:  ...it doesn�t mean he is going to do it right because he�s the coder.  He can do anything he wants.  He can store them in a text file and look them up, you know, have the passwords in plaintext.  And so this is the message that I want to remind people of.  It is incumbent upon the developer to implement security.  The nature of Web 2.0 stuff is that this is a responsibility of the developer, and there are no requirements.  Nothing in the language suggests it.  If you have a developer who isn�t aware of storing hashed passwords and then comparing the hashes rather than the passwords, which does create exactly the enhanced security that John�s talking about, you have a programmer who just doesn�t know about that, then you�re not going to have it.



LEO:  So, yes, it�s just one more area of insecurity.  Thomas Brock of Santa Monica wonders:  As both a longtime SpinRite user and an employee of a large computer security company, I really enjoy listening to you and Leo.  I have used and developed for Windows machines since Windows 2, 386 edition.  I purchased my first Mac about a year ago.  I really like it.  One thing I�ve never wrapped my head around, though, is the Keychain.  Every time I get a "Something wants to access your blah blah keychain," I always click Allow because I don�t know what�s going on.  Could you please explain the Mac OS X Keychain?



STEVE:  And Leo, this one is for you.



LEO:  Oh, thanks.  No warning.  Well, I think Keychain is actually one of the nicest features of OS X.  It is a secure store of your passwords.  When you use Safari on the web, it stores the passwords in this secure store.  The store is unlocked by default when you log in.  If the Keychain has the same password credential that you use when you log in, it will automatically unlock the Keychain.  So that�s nice.  You can change the Keychain password or, conversely, change your master log-in password to your account, and then you�ll have to provide a separate log-in to open up the Keychain.



But what he�s talking about is a second layer of security, which I think is a very valuable layer of security.  When you change a program, a program hasn�t been used before with Keychain, when you update the program or reinstall it, the first time it tries to access the Keychain, and this is one of the reasons the Mac is more secure, the Mac says this program wants to access the Keychain, is it okay to do so?  So just as with all of these alerts, Windows, too, with UAC, you�ve got to pause when you see that message and say, hmm, why is the Keychain being accessed, who�s doing it, and does it make sense?  So if you - and by the way, most Mac programs do use Keychain.  Any program that has a password, for instance, like Safari, will use Keychain.



So here�s kind of what happens.  You updated Safari using, you know, Apple Update, and you use it.  The first time you launch Safari, it says Safari wants to access the Keychain, is this okay?  Now you think, well, I just updated Safari.  I used Safari.  Safari used Keychain.  Yeah, okay, go ahead.  And I think that�s the point on all of these alerts is you�ve got to think about who�s asking for permission.



STEVE:  Yup, in fact it�s funny, you and I were talking before we began recording that I just updated my Skype from 2.0 something or other to 2.6 something or other.  And sure enough, I got exactly this dialogue saying, hey, Skype wants to access the Keychain, do you want to give it permission to do so, now and in the future?  And it�s like, okay, yup, I know why it�s asking, so let�s go ahead.



LEO:  And you can safely say no, in which case Skype won�t provide your password for you automatically.



STEVE:  Right.



LEO:  So I think, you know, this is actually kind of a response to your previous question.  Apple has, I think, done passwords right.  They don�t store passwords in clear text on the drive.  They store it in a secured store that is highly secure, using strong encryption, and that�s what this Keychain facility is.  And it�s a very useful facility.  There�s a lot of features in there people don�t know about.  It will generate secure passwords for you automatically, automatically store them.  It�s like a password utility, the kind you�d go out and buy, but it�s built into OS X.  I think Keychain is really cool.  Where you get into trouble is where you�ve changed your password on your master log-in or you move a keychain from one system to another.  Then people get annoyed by it because it keeps asking for a password.  You can also change the default behavior.  Normally Keychain will stay logged in the entire time you�re logged into your system.  But you can change that.  You can say after 30 minutes ask again.



STEVE:  Oh, very nice.



LEO:  Probably not a bad idea to do that.



STEVE:  Well, and clearly the OS X also has a Keychain API that the applications are aware of and are able to access.  And Windows has nothing like that.



LEO:  No, I think this is a great idea.  If you open - it�s in the Utility, Applications Utilities folder, Keychain Access.  You can see all the programs that use Keychain and what they�re storing in there.



STEVE:  Very nice.



LEO:  And that�s where you would also change your preferences.  And they have a First Aid and so forth.  You can clear the log.  You can synchronize the log-in password.  There�s a lot of Keychain settings you can change, as well.  I think this is really great.  It uses certificates; it uses standards.  This is an example of where Apple has done things right.  And, as a result, this is one of the things I think that makes OS X more secure.



STEVE:  Well, I would say that Thomas Brock got a beautiful answer to his question.



LEO:  Well, good.  I made it up as I was going along.  Bob�G. of Auburn, Alabama is worried about the health of his DVR:  In Q&A 19 you talked about how the drive in a TiVo constantly spins.  More than that, it constantly writes.



STEVE:  Exactly, it�s constantly recording.



LEO:  Yeah.  The DVR that Charter Cable uses is a Moxi box DVR, works similarly to a TiVo.  It would have to.  If it has the ability to pause live programming, that�s how it does it.  During the podcast you said something about how a user should be careful when turning off a DVR to reduce the impact on the drive.  Because we have short power outages of 15 to 20 seconds in my area - oh, that�s nice - I�ve gotten UPSes for my desktop PCs and network equipment.  Should I get one for the DVR?  I asked when it was installed and was told no.



STEVE:  Well, of course he was told no because, you know, people look at it and think of it as just sort of a consumer appliance.  And so I put this in here when I ran across Bob�s question because I�m - and I even defended it once because I think we had another listener who said, I really don�t think it�s recording all the time.  Well, we demonstrated that it must be because it�s storing 30 minutes, and the TiVo and other DVRs don�t have nearly that much RAM.  So it�s got to be recording it on the hard drive.



LEO:  Let me - I just want to point something out because I think this is really important.  It is perfectly possible to hear a question like that and say, well, let me find out and go research it.  But I like how you work.  You used logic.  You thought about it.  And this is, I think, what distinguishes somebody like you from a rote computer expert.  You understand kind of the rationality of this, and you�re able to think about it and quite quickly say, oh, no, there�s no way it could because this is how it would have to work.  And I like that.  I mean, we could verify it, and I know it�s true because it�s completely logical.



STEVE:  Yup, so he does want, I mean, if he�s concerned about this, a UPS makes a lot of sense.  These devices can survive, obviously, some power outages because there�s no on/off switch on them.  You plug them in, and they�re just on, just like a cable box is pretty much on all the time.  In fact, even when you turn your cable box off it�s still showing you the time of day, and it�s on inside.  Because you know when you plug them in they take about five minutes to boot themselves up and loading their code from over the cable.  So these things are going all the time.  And we do know that if you suddenly power down a hard drive when it�s in the middle of writing, it will destroy the sector or sectors that it�s on top of.  And that�s going to give a little road bump at that point when it comes around.



Now, they�re built to be tolerant of that.  But over time this adds up.  So I would say give yourself a UPS.  And maybe, after you put it on a UPS, if you can - often these cable boxes have all kinds of security, funky triangular-headed screws and things.  But of course I�ve opened mine up and modified them extensively.  If you can, take the drive out and, well, unfortunately, I didn�t mean this to be a SpinRite commercial, but I don�t know of anything else other than SpinRite that would do the right thing, and that is, run it on SpinRite - maybe Bob already owns a copy of SpinRite, in which case definitely run it on SpinRite to clean the drive up after you put your DVR on a UPS, and you�ll be in good shape from there on.



LEO:  You know, thinking about this, I would imagine that, and I don�t know for a fact, that DVRs would use a journaled file system.



STEVE:  They don�t.  In fact...



LEO:  They don�t?



STEVE:  ...I can only speak for the TiVo because I know TiVo cold, and it is a standard ext2...



LEO:  It�s not using Reiser or something.  Huh.



STEVE:  Yup, Linux file system.  And it�s an old version, an old kernel of Linux, and a small one, not a big fancy one.



LEO:  I remember.  Now, ext3 and Reiser and other file systems are journaled.  OS X is journaled.  NTFS is journaled.  This is a bonus question.  Doesn�t that give you a little bit more reliability in cases like this?



STEVE:  Kinda.  The problem is, all of these systems are trying to be error tolerant, but they�re relying on the drive to be the sole store of their state.  What NTFS�s system, for example, guarantees is that the way it writes, the file system structure will be maintained, but not the data.  And nothing can solve the problem that, when you pull the plug and power fails during writing the sector, that that sector cannot have a proper checksum at the end, and there may be some power glitch happening.  So the system is not going to be happy about it when it reencounters that again.  So NTFS, and in fact this is something people don�t understand, NTFS protects its structure, but not the users� data.  That�s not protected.



LEO:  Right.  So a journaled system writes the data out in a batch.  Is that what it means to be journaled?



STEVE:  Yes, the idea being that it�s creating a journal of changes so that, if something happens, it�s able to roll back to a point where the hard drive and file system were in a consistent state.  And it may then be able to roll forward from the journal, given if the journal is also being written to the hard drive, it can roll forward to recreate the transactions which may have been damaged during the problem that occurred while it was journaling.



LEO:  So it�s more robust, but not impervious to problems.



STEVE:  Well, and again, nothing can solve the problem that power failure during a sector write will make a bad sector.  It absolutely will.  And then when the system encounters it again, the question is, what does it do?



LEO:  Right.



STEVE:  And it happens to be that�s one of the things that SpinRite fixes.  It, like, fixes all the checksums on all the sectors on your drive.



LEO:  Interesting.  Now, of course when you�re playing back stuff on a DVR, a bad sector here or there just means a glitch in the video.  It�s not the end of the world.



STEVE:  It�s not.  But of course they�re cumulative.  And here in Auburn, Alabama, where Bob says he gets power outages constantly, it will add up.  And I believe he�ll end up seeing some problems.  On the other hand, he can just tell his cable company, hey, this thing went bad, give me another one.



LEO:  He�s only renting it.



STEVE:  Exactly.



LEO:  Lars Solberg listens in Norway.  He�s been comparing podcast advice.  He�s a bit confused by some apparent discrepancies.  Well, we�re always right, so I�m just going to say that right now.



STEVE:  When in doubt, ask.



LEO:  I�m a long-time listener of the Security Now! podcast.  I also listen to a bunch of other podcasts.  One of them started talking about data backup and how long-time archival data can be safe on a hard drive that was turned off, just sitting in a closet or a safe.  So I thought, well, I already know this, Mr. Gibson already told me, right?  But they said on one of Norwegians� biggest IT podcasts that a hard disk drive is going to live longer if you keep the power on than if you use it as a backup solution.  I clearly remember you and Leo talked about this, but I�ve been searching and reading through the text versions, I can�t find it.  Have I been dreaming?  Can you clarify?  How long will a powered-off hard drive live?



STEVE:  That�s a great question, and I think what�s happened is Lars got a little tripped up in some detail of what we�re talking about, which is why I thought this was a great question because, Leo, I actually get a huge number of people wanting to talk about backup solutions.  And it�s something I�ve been avoiding because we�re Security Now!, and I don�t want to be too much pandering to SpinRite and backup stuff.  But at some point we�re going to have to do a show on hard drive backup solutions because it�s a question that we�re getting all the time.



In this case, the danger that a hard drive has - okay.  First I�ll just say we�re both right.  The major Norwegian biggest IT podcast is right and we were right because what neither or us were talking about is power cycling.  That�s the danger for hard drives is turning them off and on and off and on and off and on.  I work to minimize the power cycling on all of my computers, where if I know, for example, that I�m not going to be using a computer for several days, then I�ll turn it off.  But I will never turn a machine off if I know that I�m going to be back on it in another hour because it�s the thermal heating and cooling, heating and cooling, power on/power off, power on/power off that�s the problem.



So I presume the guys who did the Norwegian podcast were talking about keeping a drive running all the time being better than powering it on and off.  That�s absolutely true.  I was talking about putting the drive on the shelf, which obviously keeps it powered off all the time.  And that�s better than powering it on and off.  So either extreme - all the time running, like the drives at Level 3 on GRC servers are on all the time, or all the time off - much better than power cycling constantly.



LEO:  The heating and cooling is bad for them.



STEVE:  It really is.



LEO:  Now, if you - and I know a lot of people do this.  In fact, a lot of video production facilities, because hard drives are cheap and big, will just put data on them, they�ll wrap them up in bubble wrap and throw them in the closet.  Do you have to worry about things like stiction, bearings kind of getting gooey, things like that, if they�re not used for a long period of time?



STEVE:  Well, decades maybe.  I mean, but for really, really good archival storage, all the studies show that hard drives will last a long time, but also recordable DVD, recordable media - in fact, I bought a bunch the other day.  It was an archive-grade DVD that is a gold - it�s, you know, gold gold.  It will only record at 1X.  It won�t let itself be recorded any faster than that.  And it is built for 100-year storage and, you know, made very stable.  So certainly decades, I think, are safe.  I�ve got old original v1 IDE drives that I use for testing new versions of SpinRite.  And�I don�t dust them off very often, but they still fire up�when I use them.  So problems like stiction, I think, have been largely solved.  And taking a drive and just putting it on a shelf for many, many years is the best thing you can do for it.  It�ll still be there when you plug it in again.  As long as you still have an interface that�s compatible with...



LEO:  Exactly.  I think really the truth is, in the case of backup, no backup lasts forever.  And as you point out, no medium will always be readable.  So probably the prudent thing to do, if you do have something you want to keep a hundred years, is every decade or even more often you want to copy it to a more modern medium.



STEVE:  Yup, because, for example, try to find an ESDI�controller.



LEO:  Yeah, yeah.



STEVE:  You know, that was something that didn�t last very�long.



LEO:  The heck with ESDI.  Try to find a SCSI controller these days.



STEVE:  Right.



LEO:  I mean, it doesn�t take long.  You got some stuff on ZIP disks, good luck.  Orb?  Good luck.  I mean, that�s the problem with this stuff is it changes.  A decade is probably even too long.  Maybe every five years.  Then you refresh the data, you make sure it�s good, you put it on something that�s more modern that you can read.  And I would guess, as time goes by, these archival solutions get better and better, too.



STEVE:  And of course the point is, if this stuff, if this data is really that important, then you do need to be aware of it and to give it the attention it deserves if it�s that�important.



LEO:  Most stuff isn�t.  I can�t - not much of what I do is worth saving a hundred years.



STEVE:  You know, and I�ve got - I have original - I have drives that I�ve pulled from old machines, carefully labeled, you know, here�s 1988, my C drive.  It�s like, you know, maybe a walk down Nostalgia Lane would be interesting.  But it�s clearly nothing I need on that drive.



LEO:  Your msdos.sys file.



STEVE:  Well, remember the days when we actually knew what all those files were, Leo.



LEO:  Wow, look at that, it�s an autoexec.bat file.  Bruce in Gilbert, Arizona worries about sticky fingers.  He says:  Steve, I have a question on the security of a fingerprint scanner on a laptop.  You state it�s all you use to protect your laptop for log-in and to decrypt your drive for it to boot up.  I�ve read that these scanners are pretty easy to fool with a copy of a person�s fingerprint.  Somebody did a test, you could make it out of Play-Doh, and it worked pretty well.  I�ve read that these scanners - oh, we just said that.  Would it be easy to get the person�s fingerprint from a lost or stolen laptop merely by dusting it for prints?  Sounds like a "CSI" episode.  Your fingerprints would be all over it from handling it.  You can also tell which finger is which by the prints left on the keyboard home keys, if that made any difference.  Interesting idea.  What do you think, Steve?



STEVE:  There are two classes of fingerprint scanner.  The scanners which have a large, rectangular array, where you push your fingerprint against it, are inherently insecure for exactly that reason.  You can make a Xerox, a static Xerox copy from an image and push that on the scanner, and it�ll go, wow, this guy�s got a high-contrast thumb.  But it�ll work.  What I like, the only fingerprint scanners I trust, are the dynamic ones, not static, where they have either a two- or four-pixel-high optical array.  And actually they�re not even optical.  They�re actually capacitive.  The...



LEO:  Really...



STEVE:  ...fingerprint, yes, the fingerprint scanners that�you see now on laptops that are that little strip that�you...



LEO:  It�s just a bar, yes.



STEVE:  Yeah, the little bar that you wipe your finger across, they are not optical, they�re capacitive.  They work on the same principle as those stud finders, you know, those yellow stud fingers, you scan them across the wall, and it�s able to tell when the density behind the wall increases.  That uses a capacitive technology, which is the same thing that these dynamic fingerprint scanners use.  So, for example, you could not swipe a Xerox of the image over the scanner.  You actually have to have a 3D creation of the fingerprint.  So not only does it have to be 3D, but it�s got to be dynamic.  You�ve got to move it across this scanner.  And so using this several pixels� worth of - I�m sorry, I keep saying "pixel."  Well, I guess they are pixels.  They�re not optical scanner pixels, they�re capacitive scanner pixels.  So using that strip, it�s able to track the motion, seeing the image move from one row to the next.  So it knows how far and how fast your finger is moving, but it�s not using light, it�s using the differences in capacitive reactance in your finger, which is much harder to fool.  So not only dynamic, but capacitive.  And that�s a pretty secure way to pick up a fingerprint.



LEO:  Fascinating.   Alex Banks, writing from Los Angeles, asks:  Back in Episode 68 - 68, wow - Q&A, a listener wanted to know about dual quad-core Intel processors.  You and Leo commented this is probably overkill and that dual dual-cores were sufficient.  What about heavy VM applications?  These are the virtual machines that we�ve talked so much about, things like Parallels and VMware.  Would the additional processing power greatly enhance VM performance?



STEVE:  Well, this is an interesting question from a couple points.  First of all, the big load in VM is RAM because virtual machines essentially have to just take a chunk of RAM out of the hosting system and commit it to their own OS.  That is, when you�re running, for example, Parallels on a Mac, and you�re running Windows, there isn�t a practical means for Windows to share the main system memory in its virtual machine with the host�s memory.  It has to have all whatever it is, 512 megs or a gig or whatever.  So heavy VM uses, that is, where you�ve got multiple VMs, they�re all going to be grabbing a static chunk of memory from the main system.  So really memory is the problem there.



Now, having said that, of course the more processors you have the better.  Except that what you quickly run into is resource starvation in other places than processing power.  For example, you can end up where, as I said, you don�t have enough memory, or you can�t get enough access to the hard drive because you�ve got processors that are doing so much, suddenly they�re not the bottleneck.  So as in any examination of a system, it�s always the weakest link or the biggest bottleneck that causes the problem.



LEO:  And often that�s I/O.  I mean, frequently that�s I/O.



STEVE:  Yes, that�s exactly the direction I was going to go in this.  When we were being DDoS�d, being hit with Distributed Denial of Service attacks, you know, six or seven years ago, I did some study of what it would take to build a system that could respond to that.  And it turned out that the PCI bus was instantly bottlenecked, that is, I couldn�t get, no matter what fast code I wrote in the processor, no matter how fast the processor was or how many of them I had, I could not get a useful amount of bandwidth across the PCI bus to the network adapter.  The PCI bus was the problem.  So again, at some point you just end up with too much engine and not enough wheel.



LEO:  I like that.  I love that, in fact.  Now, you used to drive, so you know what that means - too much engine and not enough wheel.  I don�t know what it means, but I like it.  I have to say I have a quad-core Mac Pro, run Parallels all the time, runs swiftly, beautifully on that.  And I don�t think having an eight-core, which is what he�s talking about, the dual quads, I don�t know if an eight-core would make much of a difference, frankly.



STEVE:  Well, I built a machine not long ago that I think I�ve referred to here.  I did get myself a quad-core Pentium.  And boy is it fast for compressing media.  Oh, my goodness, I mean, it�ll spoil you in a heartbeat.  I mean, as long as you�ve got a media compression technology that understands multiple cores and multiple threads, it�s just shocking how fast it is because there you are massively compute-bound.  Of course, now I�m going to get a call from the SETI@home guys, who are going to say, c�mon, get your screensaver going, Gibson, we want to use those quad cores to find the aliens.



LEO:  Well, that�s what they found with the PlayStation 3s, which have these new cell processors.  And effectively I think they have eight or nine cores.  They really do very well with these distributed computing applications.  They rack up CPU cycles fast.



STEVE:  Well, in fact I�ve been messing around with AVID Liquid 7, doing some DVD production for my homeowners association.  And many of the special effects systems, that software itself requires that you use a powerful video card because what they�re doing is they�re now offloading a lot of this work into the GPU, the graphics processing unit, because our graphics systems have become so powerful now.



LEO:  And I run all the time a little CPU meter in my menu.  It�s a Mac program called Menu Meters.  And I rarely, I have to say, peg it.  But it is when you do things like rendering, transcoding video, things like that, where it really is processor intensive.  It�s hard, though, to get four processors pegged.  I have to say, 2.something gigahertz processors, that�s a lot of processing power.



Continuing on, Mike in Long Island has been experiencing email grief:  My ISP provides email via POP and SMTP, as most do.  However, they�ve caused much grief of late due to the following situation.  The email addresses that my wife and I present to the world are in the form of myfirstname@lastname.net  This domain is owned and maintained by my brother for various members of our extended family, as well as some of his customers.  However, he�s not in a position to provide storage, merely forwarding.  Mail that goes to that address is then forwarded to the real address given to me by my ISP.  The problem is my ISP seems to have some sort of antispam policy in place and appears to be bouncing some emails that are referred through this family domain.  I�m very curious because I do the same thing.  Evidently some sort of ham-fisted attempt to protect me.  Well it�s not ham-fisted.  You�re going to see more and more of it, actually.  Worse still, they refuse to admit they�re even doing so, making it impossible for me to convince them to whitelist this domain.  I�m considering signing up with an email hosting service like FastMail and referring my emails there in the hopes of better results.  Can you recommend any other courses of action?  What�s going on, Steve?



STEVE:  Well, it�s exactly as you said, Leo.  It is ISPs finally beginning to do what they can to minimize email abuse in the form of spam.  The problem is, there is no good solution for him except to use an ISP that would be friendly to the idea of receiving this relayed mail.  We�ve talked about before the SPF framework, which is becoming increasingly popular, or even Yahoo! uses domain keys.  I think Google is able to use both.  The idea being that you authenticate the server as the source of your email.



So the problem is, this guy is trying to send email from his ISP that has a different domain than the ISP.  For example, if I were steve@cox.net, I would be using Cox�s SMTP server to deposit my mail.  It would then connect to another server somewhere and say, hi, I�m smtp.cox.net with mail from steve@cox.net.  Well, due to this new antispam approach, the remote server would say, I really want to make sure that you�re a qualified sender for email from cox.net.  And Cox would say, yes, that�s what I�m doing, I�m going to stand behind any cox.net email.  Now, what Mike in Long Island is doing is he�s sending email through Cox�s server.  So now when his email tries to go somewhere else, that somewhere else is saying, wait a minute, is this a valid source of�mail?



Now, the good news is, I don�t know what his brother who�s providing this forwarding service, what capabilities his brother has.  But potentially, if this were a problem with SPF - SPF is a DNS-based authentication system.  If his brother has control of the DNS for this hypothetical domain lastname.net, his brother could put an SPF record, add an SPF text record to the lastname.net domain, authorizing cox.net as a valid emitter of email for the lastname.net domain.  So it�s very possible that this problem could get solved by essentially, at the lastname.net domain, adding some SPF records to allow, essentially to permit Cox to be a sender of this guy�s email.



LEO:  Microsoft has a wizard that will create this SPF record that you add to your DNS.  So if you want to know more about that, do a Google search for "sender ID framework record wizard" on Microsoft.com.  And you could fill it out, and then it gives you this little snippet...



STEVE:  And you just drop it in your DNS.



LEO:  Yeah.  Of course you have to have access to the DNS to do this.



STEVE:  Right.



LEO:  So, and this was - I never quite understood this.  By the way, Microsoft describes this, actually has diagrams and stuff, at Microsoft.com/senderid.  I never understood this.  So which end - do both ends need this modified SPF record?



STEVE:  It�s the sender end that needs somebody to represent that it�s a valid sender.  So, for example, when email is trying to go to a remote server, the remote server sees firstname@lastname.net.  The remote server then asks for the text records of lastname.net to find out who lastname.net has authorized as an originator of outbound email.



LEO:  So it would say cox.net, or whoever his cable provider is, as one of the authorized senders.  See, I need to do that because I use leo@leoville.com, but it doesn�t come from leoville.com, it comes from other - and so actually what I do in the reply-to field is I use the real ISP address in the reply-to.  Which sometimes confuses people because they say, well, what is this I�m sending it to?



STEVE:  Right, right.  And in fact, I mean, the good news is that the SPF protocol is very rich.  You�re able to give IP ranges.  You can give network addresses.  You can do comma-separated lists.  You�re able to really specify in a very nice and rich fashion what set of machines on the Internet are allowed to be senders of email from your domain.  And it�s really cool.



LEO:  And really complicated.  And one of these days I�m going to understand it, and I�m going to fix it.  But meanwhile, if you don�t get email from me, it could be that�s why.



STEVE:  At least you tried, Leo.



LEO:  At least I tried.



STEVE:  It just bounced around the �Net a while.



LEO:  Yeah, I mean, I am completely sympathetic with the ISPs.  But so many of us now use this kind of forwarding technique.  It�s just I don�t know what this - I don�t know.  We�ve got to find a way.



Del in Wyoming, Michigan - and if that�s not confusing, maybe his question will be.



STEVE:  I know.  Wait a minute, Wyoming, Michigan?  And sure enough, there is a town with a state name in Michigan.



LEO:  I�ve been hoping to hear some follow-up on eEye�s Blink program, now that there�s been a few weeks to test it out.  Does it work as advertised?  How much does Blink slow down a system, if at all?  Any noticeable failings, or is more testing required?



STEVE:  I have to defer to you, Leo.  I know that you had installed it for a while.  I just haven�t gotten around to it.  And so I wanted, for Del and everyone else who�s probably wondering the same thing, I wanted to say I don�t know yet.



LEO:  It�s a lot like a firewall in the sense that, when it sees outbound traffic it doesn�t know about, it asks for permission, so you get those pop-ups initially.  I have done very limited testing on just one or two machines.  Here�s what I�ve found so far.  It does seem to slow the machine down appreciably.  As you would expect.  It�s doing a lot of security.  It�s doing a lot of stuff.  It can be intrusive in the sense that it�s a very strong firewall.  So for instance, I was using a Synergy KVM system that uses Ethernet to pass a mouse back and forth between two different systems.  That of course was immediately blocked.  And I had to go in and say, okay, no no, I want that port to be open.  But it does seem, I mean - now, here�s the problem.  And I�m not equipped, and I don�t know if you are, to test how well it provides security.  I�m just saying, I didn�t get any bugs while I was using it.  But there are suites, you know, leak test suites and so forth - you do one, I know, Steve - there�s other ways to test these things against viruses and against attacks and against leaks, and I haven�t done that, so I don�t know.



STEVE:  Well, I do know from looking at some of the feedback in the GRC Security Now! forum - which I will again commend to our listeners.  You need to have a newsgroup reader configured to news.grc.com to get there.  But it�s a fantastic newsgroup.  I mean, I depend upon it for sort of a real dynamic real-time feedback from the group of people who both listen to this podcast and hang out on our newsgroup server.  They immediately jumped on Blink.  And there were, you know, I�ve had good reports and bad reports.  There was someone who complained that Blink didn�t like the protocol that his newsgroup reader was using.  Some of the packets were being flagged as potentially hostile by Blink.  So there was an instance of a false positive.  Some people did notice a performance hit.  Others, whether there was one or not, didn�t notice or complain.



So, and there was one problem, and that is that apparently in some independent analyses Blink did not fare well in the classic leak test tests because it�s really not trying to compete in that category.  You know, it�s working to prevent bad stuff from getting in, rather than trying to, after something gets in, create containment for something that gets in.  So the leak tests that are checking it for, like, cross-process vulnerabilities and code injection exploits, there are programs that will do a much better job of that because that�s what they�re trying to protect against.  Whereas Blink is saying, you know, we�re going to protect you from unknown vulnerabilities.  And the bad news is, that�s a hard thing to test.  I mean, I know that the eEye guys have a suite of junk that they blast at their machines.  Typical users don�t.  So it is hard to independently verify it, exactly as you said, Leo.



LEO:  Yeah, the tests you�re talking about I think are from Matousec.com.  And they rated Blink very poor, along with a lot of well-known firewall programs, including ZoneAlarm Free, and say that the free Comodo is the best anti-leak�protection.



STEVE:  And unfortunately what has happened is, Comodo, while it�s the best, it has been written to be the best.



LEO:  Right.  It�s designed for leak tests.



STEVE:  Exactly.  They went in, and they deliberately fixed every type of exploit that was being tested for.  So it doesn�t really mean anything except that it�s the best solution for leak tests.  It doesn�t say anything about what would happen if a bad packet, an exploit, came in through a protocol that you were deliberately allowing and took over your machine.  That�s what Blink blocks.  And as far as I know, nothing else does.



LEO:  Yeah, that�s difficult.  It�s so hard to test security applications.  It�s just really tough.  And I don�t even attempt to do it.  I would say my impression of Blink is, if you have a relative who you really want to lock this person down, maybe it�s a teenager who uses filesharing software, maybe it�s your mom who�s just not that sophisticated, and they can tolerate a little bit of slowdown, Blink is probably the best way to just kind of lock their machine�down.



STEVE:  Well, and given its track record, which I think is proven, where it is preemptively blocking things months, I mean, many months, not quite years, but chunks of years, in advance of their being fixed, I think it�s still valuable�protection.



LEO:  Brandon, writing from an undisclosed location, asks:  A few weeks ago I remember hearing an episode that talked about a program that would show hard drive usage by program, but I can�t remember the name.  Do you remember what that�was?



STEVE:  I really do, and it�s something I rely upon.  It�s free.  It�s called SpaceMonger.  He wants the free version, which is v1.4.  It got up to v1.4, and then Sean, the program�s author, decided, okay, I�m going to start again, I�m going to really do an amazing one, which is not free, it�s v2.something or other.  I find that the free 1.4 is everything I need.  What I love about it is that it gives you a graphical map of your hard drive, where you can see, using a series of nested rectangles, where your hard drive space went.  You know, it�s like, wait a minute, I have a 120-gig drive, and now I�ve only got 10 gig free.  Where did it go?  And so with this thing you instantly see, for example, those nine DVDs at 4.7 gigs each that you ripped onto your hard drive and then forgot about, because they�re sitting there occupying a huge rectangular chunk of your screen.  And you go, oh, and right-click on it and delete them right there.  So it�s a very cool tool, and it�s free, and I just love it.  SpaceMonger.com.  Or I think it�s SpaceMonger in Google...



LEO:  It�s called Old SpaceMonger.  That�s the 1.4.



STEVE:  Right.  And I�m sure he wishes I weren�t telling everyone, it�s all they need.  But unfortunately he wrote a really good one before he tried to obsolete it.  And it just works beautifully, and it�s free.



LEO:  There are a number of other programs that do this kind�of thing.  In fact, there�s an open source one on SourceForge.  I�m trying to remember the name of it.



STEVE:  Yeah.  But Leo, I don�t like it.



LEO:  Oh, you tried it.



STEVE:  I tried to use - it�s not nearly as nice.  Yeah, it just, it doesn�t - I was using something called DiskMapper from the guy who originally created Instant Recall, I think that was the tool.  It was something, it was an old DOS app I was using as my general repository of all information, really cool tool.  And he came out with it with DiskMapper, which I purchased years ago.  But it really hasn�t kept up.  And again, this thing is free, and it just works perfectly.



LEO:  SpaceMonger.  And there are equal programs on OS X, as well, as a matter of fact, but I don�t remember their names, either.  Somebody called the radio show, and I�ve been trying to find them every since.  A number of people emailed them, and now I�ve forgotten again.  So anyway, but you�ve got one, SpaceMonger.



Jeff B., being irradiated by his city somewhere in Tennessee, writes this long but terrific note:  I�m wondering what you guys think about the ever-growing implementation of public WiFi...



STEVE:  Thus the irradiation that he...



LEO:  I get it now - both by cafes and such, as well as entire cities.  I keep hearing about places that are putting it up for the public to use, but I rarely see anyone talk about the security or lack thereof.  Well, you must not be listening to our show.



STEVE:  Except of course here.



LEO:  Yeah, or my radio show, or any of the other - that just plain bugs me, to be honest.  Worst yet, it�s almost like some places try to cover up the security implications just to make the whole thing look better.  Case in point, my town is implementing a citywide WiFi access.  My town is doing the same, as a matter of fact.  It�s been boasted about on the news and newspaper as a great way to attract more businesses to the area and such.  I think that�s true.  Sounds like flawed logic, but whatever.



Anyway, I got tired of the total lack of the security aspect being covered, and I responded to a story about it on the local newspaper�s website in the comments section, pointing out some of the implications to not being particularly careful when on public WiFi, ways to protect yourself.  I was careful to sound polite and helpful.  But despite other comments showing up, mine never did.  Only ones praising it ever appeared.  People are thinking and being fed that it�s just the best thing since sliced bread, who then think it�s fine to go and do everything they do at home over it, having no idea that all normal traffic can be snooped in general, along with more directed methods such as ARP poisoning, SSL man-in-the-middle attacks, et cetera, et cetera.  Even various folks that think they�re being careful by not doing things such as banking don�t realize that every time they load a page they�re throwing cookies out at every http request to a site.  Depending on the site, that makes it incredibly easy then to hijack their accounts.



Also - shall I go on? - also they pointed out in the paper that this city WiFi isn�t made to replace their home Internet, in one sentence toward the bottom of the article.  But you know as well as I do, as soon as people can pick it up from their homes they�ll drop their cable/DSL in a heartbeat.  I don�t know if I have a point to this message, other than expressing my utter dismay at the lack of protecting people�s privacy.  But obviously it�s not just a local problem, and it�s only going to get worse as more places think it�s a great idea to slap some WiFi repeaters up around town in an effort to make themselves seem more technological or whatever nonsense.  The end.  Signed, Jeff�P.



STEVE:  Yeah.  We�re not sure where he is, but he�s probably out on a sidewalk somewhere in Tennessee.



LEO:  He has a good point.  I mean, certainly we talk about it a lot.  I probably talk about it every other show on the radio show because that�s really the best platform I have for getting information out about securing yourself in WiFi.  I mean, the radio show is listened to by a much more general audience than this is.  If you listen to Security Now!, we don�t have to tell you about this stuff.



STEVE:  Yeah, and I guess it must be the case that any really public WiFi system that is spread like that, there�s no protocol for security; right?  It�s an all open system.  And unfortunately, unless the users use VPN tunneling in order to tunnel themselves through a secure tunnel out of the wireless domain onto a wired backbone, which then goes to the Internet, everything they do is wide open.  And, you know, his point about grabbing http session cookies is really a good one because it�s so easy to hijack someone�s session if the server is relying on a cookie to identify them.  And those are, unless they�re over an SSL connection to the website, those are in the clear and, I mean, easily�sniffable.



LEO:  Right.  And then you could use it to have a pass- his password could be there...



STEVE:  Well, and just imagine the horror stories we�re going to start hearing after this becomes widespread, Leo.  And, you know, people are just sitting there, sucking in public traffic, you know, everywhere in a city, and going to�town.



LEO:  Although I know that a number of these providers are looking, and I�m not sure how it works, but they�re looking at ways to make these things more secure.



STEVE:  Well, I�ve had a T-Mobile account for a couple months now.  And I have to say I was very impressed.  First of all, I was obviously very skeptical when I went to the whole notion of a public WiFi, public hotspot.  But they do nothing but full WPA encryption.  That is, you cannot set it up open.  You cannot use it with WEP.  They have their own little client, and it is WPA.  So...



LEO:  But that�s a paid service.



STEVE:  Yes, it is.



LEO:  And that�s the key there.  And if you�re going to do an open hotspot, which is what municipal WiFi frequently is, that is inherently insecure unless they�ve come up with something to make it more secure, but I don�t know - I mean, I read about this everywhere.  We talk about it all the time.  I don�t think the message gets out to most people.  I don�t know, it�s a very - it�s an interesting question.



STEVE:  Yeah, I mean, the only thing I could see that would  be practical, because we know now that WEP is so badly broken that it takes a minute to crack, would be some - well, actually there isn�t a good solution because, even if everyone had a WPA key, if it was the same WPA key, you would just log in and be able to decrypt all the traffic then.  So you would need enterprise-class WPA where you�re doing per-client passwords so that no two clients on the same access point are using the same key.  But now you�re talking a seriously expensive infrastructure.



LEO:  Yeah.  I don�t know what you do.  I think really the word does need to get out.  And maybe free or inexpensive WiFi security has to be made available, you know, VPN has to be made available if a city�s going to do this, set up a�VPN.



STEVE:  Yeah, but then again you�ve got people who won�t bother.  And, you know, if you let them get on the �Net without security, I think we�re going to maybe go through a period where there�s a lot of pain and this gets a bad reputation before it finally gets fixed.  Because, again, I think the barrier to entry for wide adoption has to be very low, or people won�t use it.  And very low means open.



LEO:  It means insecure.



STEVE:  It means insecure, exactly.



LEO:  Well, once again, with that we have come to the end of 12 good questions, and even better answers.  You�ve done it again, Steverino.  I don�t know how you do it.



STEVE:  I chose the questions.



LEO:  Oh, that�s how.



STEVE:  I think that helped a little bit.



LEO:  Yeah, that would have something to do with it.  Well, I�m glad we did talk about all of these subjects.  As usual, it�s fascinating stuff.  You learn so much.  We�ll do this again on our 100th episode.



STEVE:  Oh, and we�re getting such great, great, great, great questions from our listeners.  So I do want to continue to encourage people to go to the bottom of the page, the ever-lengthening long page, GRC.com/securitynow.  Find your way to the bottom, and there�s a form anyone can fill out.  And unfortunately some bots are doing that now, too.  So I have to...



LEO:  Oh, man, I hate that.



STEVE:  So I�ll have to do that, I�ll have to fix something to stifle the bots.



LEO:  Use a CAPTCHA or something. Every time you put a form�online...



STEVE:  Well, actually that�s going to be one of our future podcasts is titled, "Are You Human?"



LEO:  Yeah, yeah.  There�s some interesting things going on to verify that.  That�s a huge problem.



STEVE:  Very cool thing.



LEO:  Can you believe it, it�ll be our 100th episode the next time we do this.



STEVE:  Yeah, very cool.



LEO:  We�re going to have to do something special.



STEVE:  Well, you know, I�ve been talking about having a special plan, but I�m a little worried about time getting away from me.  I�ve been asked to keynote a conference at Harvard on spyware in a couple weeks, but the plan I had for the special 100th episode is going to take a lot of time, and other things have been burning up my time until then,�so...



LEO:  You know what, don�t worry about it.  We�re not doing anything special for TWiT, either.



STEVE:  We�ll get there.



LEO:  We get these milestones.  The milestone is, in and of itself, the success.



STEVE:  Well, it�ll be fun to be there at 100 in four weeks,�Leo.



LEO:  We�re going to beat you, though.  TWiT�s going to beat�you.



STEVE:  [Grumbling].



LEO:  I know, I know.  You thought you might.  It was a horserace.  Well, who knows, anything could happen.  It�s not done yet.



STEVE:  How far behind are we, because...



LEO:  You�re four behind.



STEVE:  Ooh.



LEO:  By the time this comes out - we�re recording this a little early.  By the time this comes out, TWiT will have done its hundred.  Sorry.  Sorry, Steve.



STEVE:  Ah, well, wait till we get to 200.  We�ll lap �em.



LEO:  All right.  For more information about the things we talk about, and of course 16KB versions for the bandwidth-impaired - transcripts, too, for those who like to read along - you can go to GRC.com, that�s Steve�s website, where you�ll find all sorts of information about Security Now!.  That�s GRC.com/securitynow.  You�ll also find ShieldsUP!, his great program to test - and his own LeakTest program, too - to test firewalls; all the great security programs he offers for free; and his bread and butter, the great SpinRite, the ultimate disk maintenance utility.  GRC.com.  Steve, have a great week.  We�ll see you next Thursday.



STEVE:  You know, Leo, you mentioned my own LeakTest utility.  Mine is the dumbest one of them all.



LEO:  And he�s proud of it, folks.



STEVE:  It is so dumb, and it is the number one most downloaded thing I have.  I mean, I�ll come up with some new security thing, and for a couple weeks it�ll be number one, and then it slips back right down.  And LeakTest just sits there, just being - I don�t know who�s downloading it.  But, I mean, it�s so dumb.



LEO:  Well, now you know why the people like Comodo and the other firewalls are tuning their firewalls to be resilient to leak tests.  It�s because of you.



STEVE:  People really do care, yeah.



LEO:  There�s something about leak tests, the people get it, and they want it.  Whatever it is, I don�t know what it does, but I want it.



STEVE:  Well, believe me, they�ve got it.  Because, I mean, I don�t even know what the count is now, but it�s a phenomenal number of...



LEO:  You should have charged for it, Steve.



STEVE:  A friend of mine said just get a dollar for each one.  It�s like, you don�t understand the amount of overhead associated with getting a dollar.  I mean, it�s...



LEO:  The transaction costs, exactly, yeah.



STEVE:  It�s really substantial.  In fact, it�s funny, one piece of email that I read while I was preparing for this Q&A asked me a really interesting question that I think I  might actually do a whole episode on.  He said, you know,  Steve, you�ve mentioned several times that you wrote your own ecommerce system from scratch.  What are you most proud of and least proud of, that is, like, did you make any bad mistakes?  And I did make one that�s really kind of funny.  And he said, and what are you most proud of?  I thought, well, that�s really an interesting question.  But it wasn�t something that I can cram into a few minutes, and I think people would find it interesting.  So we�ll probably - we�ll do that one of these days.



LEO:  I think that�d be a great subject.  Let�s do it.  Well, I�m most proud of bringing hundreds of thousands of people to this show every week.  I think it�s a really great public service, and I thank you so much for doing it.  We�ll adjourn, but we�ll be back, reconvene next week for more security information.  Thank you, Steve.



STEVE:  Okay.  And in the meantime, Leo - I�m not letting you go.  In the meantime, I had the chance to bring up the download page.  LeakTest has been downloaded 6 million, 6 hundred - more uses than ShieldsUP!.  No, no, ShieldsUP! is 50 million.



LEO:  50 million, yeah.



STEVE:  But still...



LEO:  Now, if you charged a buck you�d be doing okay.



STEVE:  6,661,892 times.  And about a thousand a day.  Just mind-boggling.



LEO:  Everybody who has used ShieldsUP!, just send Steve a dollar, will you?



STEVE:  No no no no no.  Buy SpinRite because it�ll... 



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#97

DATE:		June 21, 2007

TITLE:		Operation: Bot Roast

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-097.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss the recent news of the FBI�s announced crackdown and pursuit of "bot-herders" who individually control networks of remote control DoS and Spam zombies numbering in the many tens of thousands.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 97 for June 21, 2007:  Operation Bot Roast.



Time for Security Now!, everybody�s favorite security podcast - are there any others? - featuring the great security guru, my personal friend and hero, the man, the myth, the legend, Steve Gibson.  How are you today?



STEVE GIBSON:  The myth.  Yes, I�m just a...



LEO:  The mythical Gibson.



STEVE:  ...figment of everyone�s imagination.  Actually, you know, from the email that we receive, I know that there are other security podcasts.  In fact, there�s one that was...



LEO:  There�s quite a few.



STEVE:  Yes, exactly.  But I do hear people saying that the one stands alone from the others.  And actually I�ve been driven to be a little bit curious about what they have meant by that.  And so I�ve listened to some of the other ones.  And, you know, they�re different than ours in...



LEO:  They�re different, that�s it, exactly.



STEVE:  Yeah, they�re different.  And so, you know, to each his own.



LEO:  And it doesn�t hurt, you can listen to as many as you want.  CNET does a security podcast.  I have a friend actually in town who does a security podcast.  So there�s, you know, everybody needs to get as much information about this as they can.



STEVE:  How many gigs do you have free?  We�ll fill it up.



LEO:  Plenty.  So today we�re going to talk about - in just a bit we�re going to talk about an FBI operation that just recently came to light, and some amazing statistics.



STEVE:  Yes, Wednesday before last the FBI broke the news of what they called "Operation Bot Roast," which is...



LEO:  In an uncharacteristically humorous thing.



STEVE:  Yeah, it�s good.



LEO:  I�m impressed.  You don�t think of the FBI as being jokesters.  Operation Bot Roast.  Do we have any addendum, errata that we want to cover before we go to the subject at�hand?



STEVE:  We do indeed.  There was an errata that I picked up from Justin Alcorn.  And he�s in Cleveland Heights.  He writes, "During Episode 96 Q&A you answered a question about SPF."  And of course I remember that.  He said, "Everything you said about SPF records was correct, except you didn�t answer his question.  He had the opposite problem.  His problem was that his ISP was dropping email to him because his ISP had implemented an SPF check on incoming mail."  You may remember that this was a guy whose brother had, like, created a family domain.  And his brother�s server was simply redirecting the email from it to the ISP.  I�m�surprised...



LEO:  Yes, I think I twisted it around because my problem is the opposite.



STEVE:  Yeah, and I was going to say, I�m surprised I got that wrong, you know, because I�m pretty clear on what the problem was.  But anyway, Justin goes on and says, "So the ISP implemented a check on incoming mail.  Anyone who has sent an email to his forwarder that had an SPF record was dropped because the DNS record told the ISP that it was spoofed, which of course exactly is what SPF is for."  So Justin says...



LEO:  But he wasn�t losing all his mail, just some mail.



STEVE:  Right.



LEO:  Okay.  Wouldn�t this be something we would all have happen to us?  Because for instance I have my mail sent to leo@leoville.com, but it�s not arriving at leo@leoville.com, it arrives at FastMail, you know, through a forwarder.



STEVE:  Yes, forwarders are the sort of the Achilles heel of�- well, that�s not really the right expression.  But forwarders represent a serious problem for SPF because what SPF sort of relies on is this old notion of mail forwarding, where you could just send your mail towards your destination.  For example, if the actual server that was supposed to receive it was busy or offline, you could go to a backup MX server, as it�s called, and put the mail there; and then that backup MX server would forward it on to the destination and, like, do retries and so forth.  So the whole idea with SPF is it�s a way of authenticating the originating email server to the destination which implies  no middlemen.  But middlemen have always been part of the way SMTP, the Simple Mail Transfer Protocol, worked.  So forwarding, which is what is going on here, is a problem.



So anyway, to get to Justin�s point, he says, "Either have the ISP whitelist the email forwarding service," and he says, parens, "(not likely), or have his brother implement a Sender Rewriting Scheme, SRS, which will change the envelope �from� address to a domain that is allowed to send from that server."  And so essentially this is the way SPF can be altered to be forwarding friendly, although it may be actually doing more than his brother is able to do.  The idea being that his brother�s server would receive email and then, rather than just sort of blindly bouncing it onward to the ISP, where you have a problem, that essentially the brother�s server would rewrite the envelope to set it as the apparent source, which would then have a matching domain.  And presumably his brother�s server would also have an SPF record that said we are the authorized originator of the following mail.  So there are ways around this.  I just wanted to clarify that for the record.



LEO:  Okay.  And I don�t know why I�m not having the problem because I do the same thing.  So I guess just not everybody pays attention to this stuff.



STEVE:  Well, that�s exactly what�s still happening is, for example, if a recipient of email who has SPF technology has it active, for example, they�ll query the originating server�s DNS records to attempt to get a list of IPs or machines that are valid originators of mail from that domain.  If that sender has no SPF record, which is still very much the case, then most ISPs will say, oh, well, we didn�t get any information one way or the other, so we�ll allow it.  But if there is a DNS record, it either matches the incoming mail or doesn�t.  If it matches, then you have a high degree of confidence that this mail is not spam and valid.  If it doesn�t match, you have a high degree of confidence that it is invalid and should probably be just dumped into the spam folder.  So but there is that middle ground which is no DNS record, no SPF support at the originating end, in which case most ISPs will say, well, okay.  We don�t know either way, so we�d better let it through rather than just drop it summarily.



LEO:  Right, makes sense.  So any other mail?



STEVE:  Well, I did have...



LEO:  ...mailbag thing we do now.



STEVE:  Yeah, I want to try to get more of our listeners� comments and things.  And I�ve got actually a couple for next week cued up.  But I didn�t want to do any more because I had sort of a longish but really sort of interesting SpinRite story to share with our listeners.  This is from a guy named Harry Liddenfeld.  And he says, "Steve, let me start by saying I�ve been a big fan of Security Now! with you and Leo since Episode 1.  Up until this past week I�ve  never had a need for SpinRite since I�ve listened to you and Leo about backing up."  So Harry�s into making backups, which we always say; and it the case that, you know, that�s really your first and best line of defense.  And he says, "I work at a courthouse here and inherited the security card access server and system for the courthouse from the county.  Their solution to backup was CDs on a CD writer.  The database has over 500 people in it."  And so this is like secure access control stuff for the courthouse.  "Their database has over 500 people in it, and the number of CDs required were getting out of hand..."



LEO:  Like thousands, I would imagine.



STEVE:  Yeah, "...and didn�t make any sense.  We had a computer crash about two years ago, and I gave the county the backup CDs.  They were unable to restore the database, saying that some of the CDs were corrupt.  So we had to manually reenter the complete database, which took days of painstaking work."



LEO:  Hey, at least they had it, they could do it.



STEVE:  Well, yes.  And he said, "I promise...."  They must have a hard copy if they�re having to hand enter it.  He said, "I promised that would never happy again, so I purchased Norton Ghost and another hard drive and ran Ghost.  Then I would do just weekly backups of data files.  Lo and behold, the main hard drive failed, and I rebooted the system off the ghosted hard drive and was up and running in minutes."  Okay.  "Two days later, that hard drive started to have issues, and I had not yet purchased another hard drive as the county still wants to use their CDs.  I was in fear of losing everything, so I purchased SpinRite..." he says, parens, "...(for myself because the county wouldn�t buy it)..." close parens, "...and immediately started it in Level 2 mode.  That was at 10:00 a.m., and it ran for just over four hours.  And by 3:00 p.m. that same day I booted the system back up, and everything was back to normal.  But here�s the best part.  The original hard drive that had failed and wouldn�t boot up any longer, after running SpinRite it booted up normally and faster than ever before."



LEO:  He fixed that one, too.



STEVE:  And he says, "SpinRite to the rescue once again."  He says, "I once again ghosted the main hard drive and also have a second ghosted hard drive offsite in a secure storage just in case.  Thanks again, Steve, for all your hard work.  You�ve saved me days, possibly weeks of data recovery."



LEO:  We might mention, by the way, that we don�t recommend SpinRite as a backup solution.  You should still back up.  But it�s sure nice to have in your toolkit.



STEVE:  Exactly.  Well, I mean, here�s a perfect example of some guy who was doing everything right.  He was backing up to a second hard disk.  He was making a full image of the drive and doing it every couple weeks, being as conscientious as he could.  But the drive he was relying upon essentially as his offline mirror, it began to fail.  And what was cool was that he ran SpinRite on that before it had died, and then...



LEO:  But it did fix the old one, which is...



STEVE:  Yeah, mostly out of curiosity he then ran, since he had SpinRite now, he ran it on the one that had completely gone belly-up, and SpinRite brought it back to life.



LEO:  All that data entry for nothing.



STEVE:  Yeah.



LEO:  Maybe that�s why they didn�t want to pay for it, they didn�t want to know.  They didn�t want to find out.  Well, that�s a nice success story.



STEVE:  I thought it was a really neat, interesting story.



LEO:  So, are you ready to talk about bots?



STEVE:  Well, what we learned last week - it was Wednesday before last, so eight days ago - the FBI made some real news with their announcement of several things.  They had arrested three, what they�re calling "bot-herders."  I mean, I have to say these press releases from the FBI are unlike their typical press releases.  They first formally called this, like an ongoing project that they have that they really have not talked about before, Operation Bot Roast.  And they are, in their press releases they talk about these bot-herders.  They have arrested a guy named James Brewer from Arlington, Texas; Jason Michael Downey in Covington, Kentucky; and Robert Alan Soloway from Seattle, Washington.  It turns out that they�re now saying, that is, the FBI is saying that they have confirmed at least a million consumer PCs are infected with bots of one sort or another.



LEO:  Yeah, although even this is a low number compared with�other estimates, like Vint Cerf�s estimate that it�s 160 million.



STEVE:  My goodness.



LEO:  But a million�s a lot.



STEVE:  Well, yes.  There are three major gangs of some sort that are now actually having turf wars over the bots.



LEO:  Oh, interesting.



STEVE:  Because they get paid by spammers based on how many bots they�re controlling.  And of course those who have the most bots get more money.  So essentially it�s like here�s these hundreds of millions of innocent PCs, Windows PCs - as far as I know all the bots, certainly all that I�ve come in contact with and have heard about, are Windows-based bots.  And so they�re like raw material for these gangs to now have turf wars over.  And what they�re in fact doing now is deliberately targeting each other�s bots and stealing already infected computers from each other, literally fighting over these things.  So...



LEO:   Wow, isn�t that amazing.



STEVE:  So what�s interesting, of course, I don�t know whether our listeners know that I got directly involved in this myself when on Friday, May 4, 2001, so a little over six years ago, I was sitting here working on a Friday evening, and GRC dropped off the �Net.  We just disappeared off the Internet.  And I had known theoretically about bot attacks and denial of service attacks and all that, but had never experienced one myself.  Of course those days are fond memories, when I still had my DoS innocence.  GRC lost that in spades.



LEO:  Maybe you should explain what all of this is, what a DoS is, what a botnet is.  I mean, we�ve talked about it before, but just for those who are just tuning in...



STEVE:  Well, certainly I think all of our listeners will understand that a DoS - DoS is an acronym standing for Denial of Service.  What it typically means in this day and age - which actually is somewhat different than what it meant 15 years ago or 10 years ago.  Today it�s essentially a flood of Internet traffic aimed at one or more, but only a few, targets.  And there are so many computers on the Internet now which are - many of them are on 24/7, you know, they�re always available, or they come and go, but at any given time many machines are obviously on the �Net at one time.  What happens is that those are used to send a high volume of traffic, each one sending pretty much as much as it�s able to, which coming from all directions around the globe focus their traffic to some site, an Internet web server, or in some cases an individual, or in some cases we�ve even had attacks against the main DNS servers that hold the Internet together, essentially, attacks on the Internet itself.  The FBI in their statement, in their advisory they said, because of their widely distributed capabilities, it says the government considers botnets now to be a growing threat to national security, the national information infrastructure, and the U.S. economy.



LEO:  Well, that makes sense because of how botnets are�used.



STEVE:  Well, and so to finish on this sort of explanation, what happens is, one way or another, people get themselves infected.  Now, obviously infections are not news for anyone on - really anyone today with a PC on the Internet.  There is spyware, there�s malware, there�s viruses, there�s all kinds of different malware of various sorts that you can get injected or loaded or invited one way or another on your machine.  One class of this bad stuff are called "bots."  What makes a bot special is that it is a piece of code which arranges to run, very much like a trojan, it arranges to run in your machine, to survive attempts at removal - I�ve got a friend, in fact you met him, Bob, who�s up in Vancouver, who does sort of IT work for various companies.  He got really fascinated by one particular trojan of some sort which got into one of the companies that he does consulting for.  Someone, some employee, you know, brought it in on his laptop from outside, and this thing immediately spread throughout the company.  And, you know, Bob�s been doing this stuff for about 20 years now.  He�s close to as good as you can come.  And he just, I mean, this thing�s been driving him nuts because he cannot get rid of it.  He�s gone through the directories.  He�s the kind of guy who knows what every file in Windows is for, I mean, he knows at that level of detail much more than I�ve ever bothered to.  And this thing, on one machine, it just keeps coming back.  And that�s really the evolution we�ve seen over the last five years.  And you�ve talked about this, Leo, about how it used to be that it was possible to remove spyware.  And now spyware has gotten so pernicious and so crafty at hanging on in a system that you often just have to roll back to a restore point that you hope was not infected or restore from an image at a time that you had no infection.



LEO:  It�s pretty hopeless.



STEVE:  Yeah.  So anyway, what happens is, what makes a bot a bot is it lodges itself in your system, virtually irremovably, and arranges somehow to enlist itself to receive commands.  The most popular, still to this day, means for doing so is that the bot will join into an IRC chat channel, a hidden, private, password-protected chatroom where all the bots of a given bot-herder, to use the term which is now becoming common...



LEO:  I like that.  It�s very descriptive.



STEVE:  It�s perfectly descriptive.  They�ll all convene.  Now, I want to point people to this document that I created after I rolled up my sleeves six years ago because what I ended up doing was essentially reverse-engineering a bot that someone provided and figuring out what it was doing.  Then I created my own pseudobot to emulate the protocol this bot was using.  I got the IRC RFCs, the specs for the way IRC works, which I�d never looked at before, and I quickly wrote a bunch of my own sort of benign bots to join in the party as if mine was a legitimate one that had infected a computer.  That allowed me then to watch what was going on and learn about what was happening.



And essentially I ended up being able to infiltrate this network and ended up having some conversations with some of these bot-herders about what they were doing.  And I�ve got all the transcripts.  I show a screen of all these bots checking in.  This particular one was called "evilbot."  And they literally, they logged into the chatroom and saluted and said, "Evilbot 3296 reporting for duty."  And so you could literally, I mean, I was actually watching the screen scroll as these bots were coming and going, as the users of the computers that had unwittingly been infected, as they turned their machines on and off, these bots came and went.  And at any time - in this case there were only a few hundred.  The frightening thing is that these networks have now grown to tens of thousands and in some cases hundreds of thousands of machines.



So you have all these machines all logging into a chatroom.  Well, then the bot-herder himself or herself logs in to the chatroom and issues commands which will be seen as chat operates by everybody logged in.  And so literally this person issues commands saying, okay, everybody, go attack a certain domain name, or go attack a certain IP, or here�s where you go to pick up a list of spam addresses, and I want you to all start sending spam.  So essentially it�s centralized control of a worldwide, massively distributed network of slave computers which could be used for many purposes.  It used to be they were only used for attacking because this thing all grew out of script kiddies, you know, sort of junior hackers home from school in the afternoon, blasting each other off the network, trying to obtain control of IRC chatrooms.  And so they were using their own IRC chat mechanisms which they had developed bots for to attack each other because, if you - I can�t remember the term now for the person who�s running an IRC server for...



LEO:  The mod, or the moderator, or the...



STEVE:  It�s the equivalent of a moderator.



LEO:  The channel op, channel op.



STEVE:  Channel op, that�s exactly it, yes.  And so if the channel op goes offline, then somebody else has the opportunity to come in and take over.  So they were literally blasting each other offline in order to sort of play capture the flag of these chatrooms.  And as a channel op then you have the ability to kick other users offline.  And so, I mean, it sort of started off being...



LEO:  Benign.



STEVE:  ...you know, horseplay among teenagers.  Unfortunately, even then this was all illegal because they were using other people�s machines, remote-controlling them in order to do their dirty work for them.  So what�s happened is it�s evolved now into huge spambot networks.  They are able, because they�re command driven, they�re able to launch denial of service attacks.  And now they�re renting out their DoS services to third parties who want - for example, gambling sites, someone who�s a competitor of a gambling site will hire a botnet service to blast the competitor off the �Net at a critical time during a horse race or a boxing match or something.  And, I mean, this is what�s going on all the time.



So what I�m really glad for is that the FBI has, first of all, it�s taken them, frankly, years to get themselves up to speed and organized.  But they clearly are now organized and are pursuing these guys.  So, for example, this James Brewer in Arlington, what got the FBI�s attention was that his bots infected a number of Chicago area hospitals.  And so critical PCs running intensive care software were being brought down and their bandwidth saturated, which they needed, by this guy�s bots.  And as soon as you start messing up hospital systems, that raises red flags at the FBI.  And so the FBI doubtless did something very much like what I did, was once they had their forensics guys up to speed and understanding how to deal with this, they sequestered one of these bots, grabbed it, probably deliberately infected a honeypot machine of their own, and then watched this thing connect into bot-herder central, wherever that was, and then began the process of backtracking the individual who was communicating with the�bots.



And of course essentially that�s the weakness of the system.  The IRC chat system is used obviously to create a layer of insulation between the bot-herder and his bots to hopefully keep him from being easily findable.  But the people who run these bots, they don�t know whose computers they�re commandeering.  Certainly this James Brewer guy didn�t know that a number of his bots were causing serious problems for Chicago area hospitals.  We could hope that he has enough morality to not have done that deliberately.  And in fact the way these machines get infected is just by visiting websites, by people opening malicious email, you know, all the standard means for infecting computers can be employed for distributing bots.



And so the point is that the bot-herders have no idea whose computers they�ve commandeered.  And what�s happening, now that the FBI considers this a serious threat to national security, is the FBI doubtless has lots of honeypots that they are deliberately infecting with these bots or allowing to become infected, and then they�re starting the process of backtracking the communications back to the bot-herder.  And, you know, this is not fun and games anymore.  This is serious business now.  And the problem, of course, is that there�s substantial economic benefit now to the bot-herders.  It used to be that it was, you know, teenagers blasting each other off the �Net to play capture the flag; now it�s I will sell you my network to use for launching - in fact, one of these guys, I think it was this Robert Alan Soloway in Seattle, tens of millions of pieces of spam sent from his�network.



LEO:  It�s amazing.  It�s really amazing.  I�ve seen these bot networks at work, too.  And what�s interesting is how quickly they fill up, as you mention.  It�s instant, boom boom boom, every second another computer is co-opted and joins the net.



STEVE:  Well, and in fact I remember when I was really involved in this - I am really no more now, I mean, it�s evolved to a whole different plateau.  But I got involved, as I said, six years ago, early in the game.  And I participated passively, just listening to dialogues among these bot-herders because I ended up tracking them down, following them around.  You would see someone refer to, oh, let�s go over here.  And they didn�t know that I was already there listening, so I�d follow them over there.  And I remember listening to them talk about putting out a new bot, like in the evening, and coming back the next day after school, and they had...



LEO:  School.



STEVE:  Exactly, I mean, they were in high school or junior high, you know, they�d get home from school in the afternoon, and that new bot would already have 3,000 hosts.



LEO:  Yeah, yeah.  That�s why a million is - so is the FBI, are they using any specialized tools to track these botnets down?  How are they going about this?  Have they talked about that at all?



STEVE:  No.  They�re being close-mouthed about it because of course they don�t want anything that they�re doing to be defeated by talking too much about it.  And as is always the case, there isn�t a single universal solution because, for example, in the case of these gangs who are fighting each other, they�re creating different bots and essentially anti-bot bots, and they�re spitting out, like, 20 new ones a day.  So the actual bots themselves are evolving at a very fast pace.  Ultimately, though, the Achilles heel, to answer your question generically, the Achilles heel is that there�s nothing to prevent good guys from deliberately infecting their machines with bots and then backtracking.



Now, you have to imagine - because Microsoft has been involved in this initiative, too, since 2004, so for the last three years.  And now of course we�ve got the Malicious Software Removal Tool as part of the Windows Update suite of software.  And I notice every second Tuesday I�m getting an updated version of that.  So at some point, once the bots that are malicious are known, I would imagine that information finds its way to Microsoft, and then Microsoft adds the signatures for removing these things to the degree that they�re able.  So there is a means for proactively dealing with the neutering and removal of the bots.



The problem is, and this is something that we researched extensively back in the, I think it was Code Red worm, there was no way for the FBI to directly remove this malware even though the FBI probably has the IP addresses of all these infected machines.  The reason the FBI says a million is they�ve been collecting IPs.  And so they know the IPs of the infected machines.  But as we know, that is, Security Now! listeners will know, just having the IP of the machine tells you little other than who the ISP is that the machine belongs to.  In order to push it further you�d have to get subpoenas, the FBI would have to give subpoenas to the ISP compelling the ISP to release the names and addresses of the owners of the IP at that given time.  The ISP may want to comply, but the terms of service gives their customers certain rights of privacy.  So the ISP needs the FBI to subpoena this information from them in order to cover them legally against actions by their customers.



So the point is, all of this is a moving target.  It�s happening quickly.  The bots are changing and literally evolving.  Users are hanging up, changing their IPs.  And essentially there�s no direct way for the FBI to access those end-users� computers because that�s illegal, even if it�s the FBI doing it.



LEO:  Interesting.  So that makes it difficult for them to pursue this, I would guess.



STEVE:  Yeah, no, they�ve talked about working with CERT, the group out of Carnegie-Mellon, to somehow notify end-users directly.  But I noticed in one of the reports, one of the main techies at the SANS Institute that also covered the story, who�s been very involved in this work, he says, well, you know, how are they going to do that?  We�ve been trying to notify users with their DShield service for years.  And they�ve learned how ineffective that process is because it�s not the smart users.  It�s not, frankly, the people listening to Security Now!, not the people within range of our voices, Leo.  It�s people who really aren�t paying attention to security who will glibly click on any link that comes in the email.  And those are the machines that are crawling around with this stuff.  They�re not going to DShield to see if their IP is listed as probably being a source of attacks.



LEO:  Well, imagine their reaction if they get a letter, an email from the FBI saying we think you�ve been compromised.  I think we�ve trained most listeners well enough to go, yeah, right, I�m going to click that link.



STEVE:  Well, and that�s exactly the problem, too, is armed only with the IP, there is no way that you can send email to an IP.  You can only send it, of course, to an email address.  And...



LEO:  Aha, good point.  But I think that�s why really the first line of defense should be, once again, the Internet service providers, that they could tell them, look, these IP addresses in your system are compromised.



STEVE:  Well, that�s a very good point.  And that�s something where, I mean, that�s an aspect of controversy.  Certainly you could argue that the ISP could see and will see an abnormal amount of outgoing traffic from specific customers.  If that customer did that a lot of the time over the course of a week, the ISP could reasonably assume something is wrong on this customer.  The problem is, that begins to involve the ISP in issues of quality of service.  And the ISPs are super reluctant to begin to say, well, we�re going to take any responsibility because, when they fail to do so, then potentially that makes them liable.



LEO:  Right, right.  I think that�s who really - once again, I mean, with spam, with this problem, it�s the ISP who really needs to step up and who seem to be so reluctant to do so.  But maybe someday.  These are the guys who are putting us online.  And I think they have some responsibility.  They know what�s going on.  They can tell there�s traffic like that going on if they wanted to monitor�it.



STEVE:  You absolutely could tell.  Now, you might also argue that there really isn�t the monitoring tools available to do this.  I mean, they see traffic going out through their router.  But they would need to log it over a period of time and then classify it to see that one given source IP or a collection of source IPs is sending a high level of traffic to a collection of destination IPs.  So that really requires some proactive steps on the part of the ISP.  Your point is exactly right, Leo.  Because the ISP is at the border, they are seeing all of the traffic transit their network.  So they potentially have the information.  But going from that to basically processing all of their logs for this reason really requires a next level of involvement.  And no one has compelled them to do so.  Now, if the FBI starts rattling sabers and saying, wait a minute, ISPs are enabling this - oh, and I forgot to mention, the FBI is also saying the majority of these bots are in the U.S.



LEO:  Yes, yes.  By the way, very important.



STEVE:  So it�s not like they�re all over in China somewhere, where we really can�t get to them.  They�re here.  And so you could imagine some Congressman gets a bee in his bonnet and floats some legislation to begin to try to increase, exactly as you say, Leo, the level of responsibility that ISPs have as the people who are providing the bandwidth for their customers to the Internet, what responsibility does the ISP have to take some measures to thwart this kind of activity.  Because that would do it.  That would end this overnight.



LEO:  Fascinating stuff.  And as always, you�ve exposed us to something new and interesting, the seamy underbelly of the Internet.  And, yes, go ahead.



STEVE:  I was going to say that I do want to recommend our listeners go over to GRC and add themselves to the already  million people that have downloaded the PDF I have there that tells the story of me learning about what this was in detail and then rolling up my sleeves and backtracking, basically infiltrating several of these networks and going about solving the problem and learning about what was going on.  I think people would really find it interesting.



LEO:  Yeah, yeah.  Steve Gibson is available, you can get that white paper, of course, on his experiences with DDoS attacks; but he�s also got, oh, so much other great stuff there, including his free security software like ShieldsUP!, DCOMbobulator, Shoot The Messenger, LeakTest.  I saw one the other day that I�d forgotten about, and I never mention, and it�s such a cool little program, it�s not a security program, but Wizmo.  I love the little Wizmo.  Really a great free program.  Lots of good stuff there, including 16KB versions of this podcast, if you�ve got a dialup system or you just want really small files; and transcripts, too, so you can read along.  Share it with your organization.  If you want to improve security in your organization, Security Now! is an advanced course in security.  Almost a hundred shows now.  And that�s GRC.com.  Were you about to say something?  I heard you take a deep breath, Steve.



STEVE:  I was just going to say that it�s been another great episode, and I�ll look forward to talking to you next week,�Leo.



LEO:  Good.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#98

DATE:		June 28, 2007

TITLE:		Internet Identity Metasystems

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-098.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss the user experience and operation of Microsoft�s "CardSpace" technology which hopes to completely change the way users identify themselves on the Internet by doing away with traditional usernames and�passwords.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 98 for June�28, 2007:  Internet Identity Metasystems.



Time for a little security.  It�s always nice to have a little security when you go out on the �Net.



STEVE GIBSON:  You can never have too much security, Leo.



LEO:  Our security blanket, Mr. Steve Gibson.  Some call you a wet blanket because you sometimes take the fun out of our surfing.  But it�s always good to know what the dangers are.  Mr. Security Blanket, Steve Gibson.  Hey, you�re actually not here right now.



STEVE:  Let�s hope that moniker doesn�t stick.



LEO:  You�re at Harvard right now.



STEVE:  Yeah, they asked me to come out and keynote the kickoff of a conference/symposium there that�s being hosted at Harvard Law on spyware.  And so I said, yeah, that sounds like fun.  I�m going to be on a panel and start off the�conference...



LEO:  What day is that?



STEVE:  ...on Wednesday.  So it�s...



LEO:  It�s already happened.



STEVE:  Yeah, it�s already happened.  But of course Wednesday is the day you and I are normally recording our podcast for airing the following Thursday.  So we�re recording this one early.



LEO:  But that�s fine.  Well, you will have already given your speech and have been a great success.  But I�ll tell you now, have a great time and - you know, I think Harvard�s doing a lot of really - they have the Berkman Center, which is an amazing center for the Internet.  They�re doing a lot of really good stuff in that area.  Good for them.



STEVE:  Well, the Internet turns out not to be a fad after all, Leo.



LEO:  Amazing.  Who�d a thunk it?



STEVE:  It�s here to stay.



LEO:  Now, today, and I don�t want to scare anybody away, we�re going to talk about Internet Identity Metasystems.



STEVE:  Yes, that�s a mouthful.  But actually it plays perfectly into the idea that the Internet is not a fad, and it also follows on what we�ve been talking about recently about the issues of authentication because this goes sort of the next step in that chain is sort of more robust identity, and even identity with content, which we alluded to a little bit before.



LEO:  Do we have any letters or email you�d like to take care of, addenda, before we get to the meat of the matter?



STEVE:  We do.  I�ve got a couple interesting notes in the mailbag.  Matt Sharp in, okay, now, I assume that his hands did not slip on the keyboard when he was typing where in the U.K. he is:  Aberystwyth.



LEO:  Wait a minute, I have to write that down.



STEVE:  Aberystwyth.  Give it a shot, Leo.



LEO:  Why, of course, that�s Abery-saint-eeth.



STEVE:  I�ll buy that.



LEO:  And it is a very well known, it�s probably - I don�t know where it is.  It�s probably Welsh.



STEVE:  You could probably put it in Google and be looking down at the top of his head.



LEO:  Yeah, right, because it�s probably just him.   You know, I�m going to put that in Google and see.  That�s very interesting.  Aberyst...



STEVE:  Meanwhile...



LEO:  What does he say?



STEVE:  He says, "Hi there, Steve and Leo.  I love Security Now!, and I�m a regular listener.  I believe in one of your recent shows you mentioned how to ensure that the web page you are visiting is secure by checking for https, the padlock, and that the signing authority is trustworthy.  However, I have a question about that last detail.  How can the average user know whether the certificate is signed by a proper authority?  I have seen..."



LEO:  Aha.



STEVE:  Aha.  He says, "I have seen IE7 showing its green bar on eBay and PayPal, which is great because you know you really are safe.  But what about all other sites that are signed by Authority X?  Is there...."  Well, I don�t think X, well, anyway, you know, of course he didn�t mean "X" literally.  "Is there any good way to know who is trustworthy and who isn�t?"



LEO:  Good question.



STEVE:  Well, it�s a great question, but this really brings home a peeve that I have.  That green bar is really cool.  And it costs any site that wants to provide it $1,500 a�year.



LEO:  You won�t be seeing it on my site.



STEVE:  It really - that really frosts me, Leo.  VeriSign has what they call their 128-bit SSL with EV.  You know, it�s like Techroline additive.



LEO:  With EV.  Now with EV.



STEVE:  Exactly right.  It stands for Extended Validation.  And all it is, is nothing.  All it is, is a certificate that they rake you over the coals...



LEO:  Because if you were a hacker, you wouldn�t have 1,500 bucks to pay for this.



STEVE:  Well, and Leo, I would buy it if I had to buy it once.  But that�s a one-year certificate.



LEO:  Every year.  Absurd.



STEVE:  If you go for two years, oh, they give you a discount, it�s only $2,695, that is $2,695 for two years.



LEO:  That explains why you�re not seeing a lot of green bars on the web.



STEVE:  It just really bugs me.  It�s like, hey, I want that, you know, I�ve got a 128-bit certificate.  But it won�t light up green unless I pay them a lot of green.



LEO:  That�s a scamola.



STEVE:  It really - it is such a scam.  That just really�bugs.



LEO:  And by the way, I completely mispronounced it, and I�m not going to try to mispronounce it.



STEVE:  Oh, believe me, I...



LEO:  It is Welsh, though.  It�s mid Wales�s main seaside resort, Aberystwyth or something.  It�s in the heart of Cardigan Bay, and it is the town of 50 pubs.  So there you�go.



STEVE:  Aberystwyth.  I think that�s exactly how you would say that.



LEO:  It looks like Aberystwyth.  But it�s in Wales, and nobody can pronounce - only the Welsh can pronounce Welsh names, I�m afraid, so I�m not going to attempt it.



STEVE:  Well, you did a good job.



LEO:  They have a website.



STEVE:  To actually answer Matt�s question, having gotten my rant off my chest - god, that just bugs me - essentially the way certificate chains work is that the root certificate, which is the signing authority, has to be installed in your browser.  It�s funny that he mentions this also because about a week ago, I don�t remember what led me to it, but I looked through under XP with IE7 the list of signing authorities.  Oh my god, Leo, the thing just scrolls on forever.  It�s phenomenal.



LEO:  Who certifies the certifiers?



STEVE:  Well, exactly.  I mean, certainly Microsoft is ultimately in control of the certificates for their browser.  Presumably the guys behind Firefox are gathering those together, and Opera and Safari and everything.  I mean, the browser vendor can set up the certificates that they want their browser to accept.  So to answer his question, you just can�t normally get a random bogus certificate into a browser without deliberately installing yourself.  And I have never heard of a situation where malware goes about doing that.  One hopes that the operating system and browser take some pains not to allow that to be an automated process, or you could imagine that you could start getting bogus root certificates.



On the other hand, there�s a mechanism called a CRL, Certificate Revocation List, which, if such a bogus certificate appeared, there are mechanisms for causing them to be revoked as soon as they are found.  So basically that part of our connection, the whole SSL stuff has been engineered very well by our vendors.  So it�s really not a big problem.  But boy, it bugs me that I can�t have a green bar without spending ridiculous amounts of money.



LEO:  Well, and I�m thinking only the biggest merchants are going to have green bars.  And I have to say it�s going to really eliminate the usefulness of this.  You know, I talked to somebody at Yahoo! the other night at a party, and they are implementing a SiteKey system, much like the Bank of America�s SiteKey system.  And I said, well, you really ought to listen to our podcast.  There seem to be some issues with the usability and - not merely usability, because I hate SiteKeys, but, frankly, the security offered by a SiteKey.  That�s the image that your bank displays, and you�re supposed to recognize it and so forth.  Fortunately Yahoo! is not going to make it a must.  But I�m a little disheartened to see them adopting - you know, the bank has to do it, I guess, just by law.  But Yahoo! doesn�t.  And I�m a little disheartened to see them adopting stuff like�that.



STEVE:  Well, what you�re bringing up, this issue of a SiteKey, plays right into today�s topic, as it happens.



LEO:  Oh, good.



STEVE:  But I wanted to mention, we had another reader - another reader - another listener, Richard Collette in Beaumont, California.  He said, "Hi, Steve.  I was just listening to you and Leo on the Tech Guy podcast."  So I�m sure he means - I guess you do a podcast of your Tech Guy�show.



LEO:  It�s the radio show.  And since you appear every week on the radio show, he�s hearing your segment on the radio show, on the podcast.



STEVE:  Right.  And so he says, "I heard you guys talk about passwords.  I thought I would share with you how I create passwords."  And the reason I�m bringing this up, Leo, is here�s one I�ve never heard before.  And he says, "I take the model number and serial number of my monitor, put them together, and I have a very unique, complex, and unforgettable password.  If I forget it, I just turn my monitor around.  This can be done with any device that is within arm�s reach of your computer.  If you want a unique password for each site, you can put the domain name part in the password, as well."  He says, parens, "(I put it between the model and the serial number.)  As long as you don�t forget the device you have used as the root of our password, you will never lose the password.  Just don�t tell anyone what the device is."



LEO:  Yeah, because they can just look on the back.



STEVE:  And actually it is pretty - it�s pretty neat because, you know, not that passwords have to be absolutely unique, but serial numbers are going to be unique within a given family and model number of a monitor.  So he�s come up with a way of creating a complex, unguessable, probably alphanumeric blob which, if he should forget it, he can always recover it again.



LEO:  Right.



STEVE:  So I thought that was kind of neat.



LEO:  Very clever.  Very clever.



STEVE:  And then I have, speaking of clever, I have one very short little blurb that I just got a kick out of this guy.  He�s a listener, Harvey Russ.  And he says, he starts off, says, "Okay, this was an emergency.  My TiVo puked."



LEO:  Oh, no, that�s terrible.



STEVE:  And I loved it that he�s like, okay, you know, his TiVo dying is more of an emergency than his PC dying.  He says, "My TiVo puked.  The WeakKnees tech support page said that the problem with my TiVo looks like a disk failure.  Well, I have the fix, SpinRite 6.  Yes, I resurrected the pair of disks in my Series 2 TiVo using the handy-dandy trusty SpinRite.  Steve, thank you for your knowledge in hard drives and technology in general.  I�ve been using SpinRite since v1.0.  Your faithful follower in technology, Harvey Russ."



LEO:  Lovely.  Lovely.



STEVE:  So I thought that was neat.  And I just got a kick out of, help, my TiVo puked.  Forget about my computer, I need my shows recorded.



LEO:  Now, that�s a Linux disk.  So it works fine on Linux.



STEVE:  It does.  In fact, what happens is, on Series 1 TiVos - and I�m not sure about Series 2, but I think it may be the same.  Those are byte-swapped systems, meaning whereas on Intel-based systems we have what�s called "little Indian format," where the least significant bytes come first, certainly on the Power PC that was used in the original Series 1 TiVo, and I think also in Series 2, those are "big Indian systems" where the most significant byte comes first.  This is important because, when SpinRite looks at the partition table on the drive, it will not find it on TiVos because the special signature word at the end of the partition table, which is a 55AA, will be swapped, and it�ll be AA55.  So SpinRite says, well, your disk is blank.  Shall I go anyway?  And so obviously Harvey said, "Please."  And SpinRite took off and just did the whole drive from front to back and resurrected his TiVo.



LEO:  Very interesting.



STEVE:  So, yup, works on TiVos.



LEO:  All right.  Now, you�ve got me with this title, and I have no idea what it means.  So maybe you�d better - maybe you�d best explain.



STEVE:  I�m going to �splain.



LEO:  �Splain to me.



STEVE:  It turns out that Microsoft has a guy whose title is 

Identity and Access Architect.



LEO:  Well, there you go.



STEVE:  His name is Kim Cameron.  And he wrote such a nice setup for this that I�m just going to read it.  This is in one of his blog postings.  And as I was doing some research for this, I mean, I could hear my own voice saying these things.  These will not be unfamiliar concepts for anyone who�s been listening to our podcast for a while.  But he just does such a beautiful job with it that I want to lead in with that.  He says, "The Internet was built without a way to know who or what you are connected to.  Since this essential capability is missing, everyone offering an Internet service has had to come up with a workaround.  It is fair to say that today�s Internet, absent a native identity layer, is based on a patchwork of identity one-offs," as he puts it.  You know, everyone just doing their own thing, basically.



LEO:  So this is exactly what we�ve been talking about, the authentication issue.



STEVE:  Yes.  He says, "As the web increases, so does users� exposure to these workarounds."  I�m sorry.  "As use of the web increases, so does users� exposure to these workarounds.  Though no one is to blame, the result is pernicious.  Hundreds of millions of people have been trained to accept anything any site wants to throw at them as being the �normal way� to conduct business online.  They�ve been taught to type their names, secret passwords, and personal identifying information into almost any input form that appears on their screen.  There�s no consistent and comprehensible framework allowing them to evaluate the authenticity of the sites they visit, and they don�t have a reliable way of knowing when they�re disclosing private information to illegitimate parties, i.e., like phishing exploits.  At the same time, they lack a framework for controlling or even remembering the many different aspects of their digital existence.



"People have begun to use the Internet to manage and exchange things of progressively greater real-world value.  This has not gone unnoticed by a criminal fringe that understands the ad hoc and vulnerable nature of the identity patchwork and how to subvert it.  These criminal forces have increasingly professionalized and organized themselves internationally.  Individual consumers are tricked into releasing banking and other information through phishing schemes that take advantage of their inability to tell who they�re dealing with.  They are also induced to inadvertently install spyware, which then resides on their computers and harvests information in long-term pharming�attacks.



"Other schemes successfully target corporate, government, and educational databases with vast identity holdings and succeed in stealing hundreds of thousands of identities in a single blow.  Criminal organizations exist to acquire these identities and resell them to a new breed of innovators expert in using them to steal as much as possible in the shortest amount of time.  The international character of these networks makes them increasingly difficult to penetrate and dismantle.  Phishing and pharming are now thought to be one of the fastest growing segments of the computer industry, if you can call it that, with an annual compound growth rate..." get this, Leo, "...of 1,000�percent."



LEO:  Oh, man.  That makes sense, though.  It�s growing�outrageously.



STEVE:  It absolutely does.  He says, "For example, the Anti-Phishing Working Group Phishing Activity Trends Report of February 2005..." so this is...



LEO:  Two years old.



STEVE:  ...two and a half years ago, yes, "...cites an annual monthly gross rate in phishing sites between July through February of 26 percent per month, which represents a compound annual growth rate of 1,600 percent.  Without a significant change in how we do things, this trend will continue.  It is essential to look beyond the current situation and understand that, if the current dynamics continue unchecked, we are headed toward a deep crisis.  The ad hoc nature of Internet identity cannot withstand the growing assault of professionalized attackers.  A deepening public crisis of this sort would mean the Internet would begin to lose credibility and acceptance for economic transactions when it should be gaining that acceptance."



LEO:  That�s the big cost of this stuff is email and the Internet become less useful.



STEVE:  Well, in fact, I�m sure - I�ve heard reports, I�m sure you have, Leo, and our listeners probably have, or know people who have stopped using the Internet because they�ve been put off by it as a consequence of all this.



LEO:  Yeah.  Very scary.



STEVE:  And so he concludes by saying, "But in addition to the danger of slipping backwards, we need to understand the costs of not going forward.  The absence of an identity layer is one of the key factors limiting further settlement of cyberspace.  Further, the absence of a unifying and rational identity fabric will prevent us from reaping the benefits of web services.  Web services have been designed to let us build robust, flexible, distributed systems that can deliver important new capabilities and evolve in response to their environment.  Such living services need to be loosely coupled and organic, breaking from the paradigm of rigid premeditation and hard wiring.  But as long as digital identity remains a patchwork of ad hoc one-offs that must still be hard wired, all the negotiation and composability we have achieved in other aspects of web services will enable nothing new.  Knowing who is connected with what is a must for the next generation of cyber services to break out of the starting gate."



LEO:  Now, this is coming from Microsoft.  I hope that this doesn�t mean another proprietary single sign-on initiative from them.  They�ve said they�re supporting OpenID, haven�t�they?



STEVE:  Well, that�s where we�re going today with the podcast.  Because of course many people will be familiar with exactly what you were alluding to, which is the hopefully defunct, if not still on its way toward defunction, and always having achieved dysfunction...



LEO:  Passport.



STEVE:  ...Passport.  I mean, I tell you, for a while there was a - you had to create a Passport account to be an MSDN subscriber, which I am.  You know, I pay my 2,500 bucks a year to receive DVDs of Microsoft�s latest and greatest.  And it just irked me.  And...



LEO:  That�s still true, by the way.



STEVE:  Yes, exactly, although I guess I just must have one installed now...



LEO:  It�s automatic, and it just signs you in.



STEVE:  ...and it�s automatic.  But, I mean, talk about a dead-on-arrival solution.  The problem, of course...



LEO:  But not misguided.



STEVE:  No, no, not misguided at all.  Microsoft was right.  The problem is, thank goodness there are some things which are proving to be bigger than Microsoft.



LEO:  Right.



STEVE:  And of course...



LEO:  Thank goodness is right.



STEVE:  Yes, you know, even we were talking last week in one of our errata about SPF.  Or was that today earlier?  The Sender Provider Framework.



LEO:  Yeah, that was, I think, last week�s podcast, yeah.



STEVE:  Okay, right.



LEO:  I can�t remember, you know, it�s blurring together.



STEVE:  The whole SPF deal.  Microsoft tried to come out with their own that they were going to license and said, oh, well, but it�ll be a free license.  And fortunately the industry, again, you know, email is bigger than Microsoft, and Microsoft ended up having to compromise and basically, you know, meld their solution in and sort of, they never really wanted to admit it, but, you know, they ended up adopting that protocol and saying, okay, fine, you know, we�ll do something that is interoperably compatible.



Now, the real catalyst for today�s topic was something that has appeared in Vista which has the strange name of CardSpace.  And in fact, I say "strange," I think it�s a bad name, especially when it was originally named InfoCard.  For several years during development it was called InfoCard, which actually I think is a better name for it.  Maybe it wasn�t available, they couldn�t get a trademark, or who knows why they ended up changing it from InfoCard.  That was the internal project name.  But it�s called CardSpace.  What it is, is essentially Microsoft�s version of what we talked about a couple weeks ago with OpenID.  You�ll remember that OpenID promises, and the good news is it is delivering on this promise because this is so cool, it promises to allow people a means for having a single authentication system which is completely open source.  And, in the case of OpenID, it is URL based.  You give your identity as a URL to a page which you control.  Either an identity provider provides it to you, you have your own page on MySpace, or what�s the one you like now?  Facebook?



LEO:  Oh, Facebook, yeah.  What�s the one I like now.  Let�s see, what week is it?  Who knows by the time this airs.  It could be anything.



STEVE:  And so the page you control is looked up, and the identity server you have assigned, the URL for that is obtained.  The site you�re wanting to authenticate with then sends your browser over to there, along with some other information that it provides.  You authenticate with that third-party service.  Then it sends you back to the original site you wanted to authenticate to, having signed essentially the package that that first site provided.  And so that�s a way of using a single point of authentication among many different services.  And it�s very cool.  The problem is, it really doesn�t provide a mechanism for providing those sites with granular information about you which you are able to control.  And it�s sort of inelegant.  Your browser�s bouncing around the Internet, and it�s not quite as seamless as it could be.  There are means to cache credentials and to involve more scripting to make that process more transparent, but still it�s really not�seamless.



Well, what Microsoft has done, and the reason this is called a metasystem, is they learned from their mistake with Passport.  They said, okay, oops, why did that not work?  Well, everyone would immediately say, well, because it was yours.  You know, and sorry, Microsoft, we�re sort of stuck using Windows and other stuff that you provide, whether we like to or not.  And a lot of Microsoft stuff is as good as anything else, but we don�t want to have to.  We want choice.  And so what Microsoft did was they created a metasystem which explicitly allows other sorts of authentication frameworks to be put underneath the users� experience.  And I would be less enthusiastic about this if it were only on Vista because, you know, I�m not there yet, and I know a lot of the world is waiting for the first Service Pack or longer.  The good news is, it will be - this CardSpace technology will be back-ported to IE7 on XP.  And there�s already support for it, for example, in the open source community on Linux and in Safari and coming for�Firefox.



So what is it?  Okay.  What this thing essentially does from a - let�s talk about the user experience first, then we�ll talk about what�s going on underneath.  In a CardSpace environment, that is to say, running on Windows or in Safari�- and by the way, it is Safari on the Mac that there is a CardSpace-compatible experience now.



LEO:  Yeah, �cause there�s no IE on the Mac anymore, so they�don�t...



STEVE:  Correct.  So say that I�m an eBay auctioneer, and I have an eBay auctioning client that I use for managing my multiple auctions on eBay.  So I want to authenticate myself to eBay.  So I launch my client, this eBay-aware client.  It connects to eBay and gets from eBay a list of authentication parameters, given that eBay were a system that supports this technology.  So essentially it says, what protocols do you support for authentication?  It asks, what trusted ID providers do you support, like Thawte, VeriSign and so forth; and what information would you like from us?  So there�s a protocol established that allows a client running on my system to basically sort of get an authentication requirement package back from somebody we want to authenticate with, all transparent to the user.



What happens then is there is a hardened, secure UI system or subsystem in Windows called CardSpace, which the client is able to hand this packet to.  CardSpace then presents essentially a very simple and elegant UI to the user.  It pops up, and it looks like a series of credit cards.  These are cards that - and so think of cards as an abstraction for an identity that contains some information.  So what happens is the packet goes to CardSpace.  CardSpace looks at all the cards that reside on this user�s computer.  These may be cards that were issued by the government, by banks, and even by the user themselves.  You�re able to create your own cards.  They don�t have to come from some certifying authority somewhere.



So this packet says, okay, eBay trusts Thawte and VeriSign and Equifax or something, and would like to have our email address as the token it uses to identify us.  You know, for example, logging into eBay now you give it your email address and your - or your username and a password.  So CardSpace looks at the cards it has, finds the intersection between those cards and what eBay has said it wants, and presents that subset to the user.  The user is able then to choose the card that they use for logging onto eBay, which will be among those in the subset.  What then happens is that the CardSpace system goes to the provider, like Thawte or VeriSign, and sets up a secure connection, and says please get the user�s email address associated with this�credential.



So this is a key aspect of this, that personal information doesn�t even reside on the user�s computer.  That�s held securely, and doesn�t have to be held, but in this case is, by the provider of the identity.  So the bank or the government or whoever has issued this credential actually has the information.  All that�s in the card are some tokens saying, basically, the user�s email address, maybe your street address, your mailing address, your phone number, basically any information that you want associated with that credential can be.  But the content of it is kept outside the machine.  So it is not available for compromise because it�s not stored locally.  Merely sort of a tokenized representation is.



So the provider sends this back to the user�s machine.  Now, at that point - and here�s one of the critical aspects - the user is always provided with a screen showing essentially which information is going to be disclosed.  In this case it would just be his email address.  But one of the requirements for the system is that users always have complete control, the idea being this is not a system designed for the other party�s benefit.  This is designed for the end-user�s benefit.  The end-user selects the card and sees what information is going to be disclosed before anything that identifies them leaves the machine.



So essentially, although there�s a lot going on behind the scenes, it�s a very simple transaction.  You fire up your eBay client.  Up pops a screen with a few cards on it.  You click on the one that you use for logging into eBay.  Next thing you see is a confirmation screen saying is it okay for us to send the following information to eBay.  Oh, and get this, there�s even now an RFC, an Internet Request for Comments document, for how to securely embed logos, that is corporate logos, in X.509, which is the standard for security certificates.  So that you also see eBay�s logo with enough crypto wrapped around it that there�s no way for it to be spoofed.



LEO:  The logo helps a lot.  I think that�s important.



STEVE:  I really do, too, yes.  Because, I mean, it�s sort of like what you were talking about with SiteKeys, the idea being that it�s something visual that the user can lock onto and remember and just sort of expect.  He wants to see eBay�s logo when he�s about to click on a card and say, yes,�I want to send this information to eBay.  So he just says, yes, send it.  So CardSpace returns this to the client, that returns it to eBay.  All of this, of course, is wrapped in seriously strong crypto.  We�ve covered that aspect of these transactions many time in our past podcasts, so that our listeners understand that all of that is possible.  It�s very possible to authenticate and to protect this stuff so that the channels at each stage of the protocol are secure.  So from the user�s standpoint it�s a very straightforward transaction.



What this does more than OpenID in its basic form - OpenID, as we�ve talked about before, merely authenticates you.  But it does provide you the luxury of not having to create individual credentials on every site you want to visit.  You have a single point of authentication, and it�s all under your control.  Well, the good news is, Microsoft formalized their endorsement and support of OpenID as an underlying protocol for the so-called metasystem.



LEO:  Good.  I�m really glad to hear that.



STEVE:  Well, it�s perfect, Leo, because what it means is that we get, I mean, OpenID is already taking off, and CardSpace was just born.  And it would likely again be stillborn, much as Passport was, if they hadn�t learned their lesson and really taken their hands off this thing and did the right thing.



Now, you�ll remember that we�ve talked, I think it was on the Tech Guy podcast and your show last week, I mentioned how I prefer Google Checkout to PayPal from an ease-of-use standpoint because Google Checkout does contain and provide to the vendor my whole little packet of information that I have authorized them to make available so that I don�t have to fill out the form.  Well, this is the same sort of benefit here.  You can create your own info cards and say,�okay...



LEO:  That�s where CardSpace comes from, right, you have a space of cards.



STEVE:  Yes, exactly.  And I�ve seen it.  Microsoft has a nice little animated Windows video file that shows you this thing in use.  I mean, it is really a nice user interface, if this thing succeeds, and because it�s built on top of open source and OpenID.  And in fact, this thing is open enough that there is an Apache module in full open source, I mean, everything sitting there that allows it to be a client of Microsoft Windows CardSpace system.  So nothing has been, I mean, they�ve really learned their lesson.  Nothing has been kept away from the open source community, so that I really am excited about this.  I think this has a very good chance of succeeding.



LEO:  So it doesn�t supersede anything existing, it just coexists using OpenID as kind of the underlying common core.



STEVE:  Well, it doesn�t actually use it.  It can use it.



LEO:  It supports it.



STEVE:  Yes, exactly.  The idea is they�ve defined a number of things.  For example, they call the relying party, or RP, the relying party is the entity that wants to receive the credentials.  They call the identity provider, or IP, that party that provides the identity.  And of course you have the user sort of in the middle there, which is arbitrating the conversations that go back and forth.  And the crypto is used in order to allow all the parties to authenticate each other and to provide this in a secure fashion.



But it turns out that, thanks to the evolution of XML, there�s something called SAML which is another open standard, the Security Assertion Markup Language, which is an XML-derived protocol, essentially, that allows this information to be conveyed and encrypted in a secure fashion that allows these parties to conduct open source dialogues of this kind of information.  So essentially what it will mean is, as this spreads, as IE gets an add-on - I�m sure it�ll be an ActiveX add-on to IE, and there exists one now for Safari running on the Mac, it�s available under Linux, Apache�s got a module, Firefox will have one - this will provide a very clean sort of a front end which is arguably easier to use from a user standpoint than having to have sort of a funky-looking URL that you use to identify yourself.  And it sort of manages multiple identities at the same time.  There�s nothing that says you always have to authenticate with the same identity.  You could just, you know, since users are able to be their own IPs, or identity providers, you�re able to create an identity, you know, for example, over on Slashdot or over on eBay or over in random�bloggings.



And so, you know, again, the beauty of this is that we stay in control, but there are things that are very powerful.  For example, eBay, that is a so-called relying party, that RP, it could also be an identity provider if, for example, we wanted to prove how trustworthy and what our eBay integrity is.  Remember that eBay has that whole voting system and feedback system where sellers are able to demonstrate what good sellers they are, and buyers are able to demonstrate what good buyers they are.  Well, imagine that you�d like to establish your identity as someone trustworthy over on eBay, over on some other site.  This system essentially allows eBay to securely package your credibility, your identity that you have earned over time there, and export it to any other site that you ask them to export it to.  You can have them create the credential, which they�re standing behind, to allow you to essentially not have to have your identity fragmented all over the Internet, but be able to pull it together.



LEO:  Well, it seems like a good solution, especially since it�s integrated into Vista.  It makes it a lot easier.



STEVE:  Yes, exactly.  It�ll just be built in.  And what I like about it is we don�t have to, given that this takes hold, we don�t have to move to Vista for it because we will have it in IE7 running under XP, which is, you know, where I�m finally comfortable, and I�m in no hurry to go to Vista.



LEO:  It does concern me, though, because I�m, as a Mac user, kind of left out in the cold.  Well, I guess I can use Safari, that�s right, you told me that.



STEVE:  Yes, you absolutely will.  And there is, I�ve seen screenshots of the Safari plug-in, which is in beta now, but is running and is successfully processing credentials.



LEO:  I hope they put that on the iPhone.



STEVE:  So it�s going to be another step forward, Leo.



LEO:  Yeah, yeah, very good.  So CardSpace, that�s what Microsoft calls it.  But Steve just likes to call it Internet Identity Metasystems.  And I hope you�ve enjoyed this trip down Metasystem Lane.  If you want to know more, of course, go to Steve�s website, GRC.com.  You can get a 16KB version of this show for the bandwidth-impaired, and transcripts, along with Steve�s great program SpinRite, the ultimate disk recovery and maintenance utility, and of course all his free software.  So, Steve, have a great time at Harvard.



STEVE:  I�m going to.  We�re going to, a week from the time people are listening to this, we�re going to answer for Episode 99 the intriguing question, are you human?



LEO:  Aha, and how do we know?



STEVE:  Exactly.



LEO:  That�s great.  I love it.  All right.  We�ll talk again next Thursday and every Thursday.  Coming close to Episode 100, just a couple more to go.  For Steve Gibson, I�m Leo Laporte.  Thanks for joining us.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#99

DATE:		July 5, 2007

TITLE:		Trusted Platform Module (TPM)

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-099.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo explain the virtues and misbegotten negative reputation of the entirely benign and extremely useful emergent crypto facility known as the "Trusted Platform Module."



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 99 for the 5th of July, 2007:  TPM.



It�s time for Security Now!, the podcast that tells you why you should be afraid and what to do about it.  Steve Gibson�s here.



STEVE GIBSON:  Now, we don�t want to be accused of unnecessarily alarming people, Leo.



LEO:  No, no, but it�s true that there are things to fear.  Fear�s not the right word.  Things to prepare for.



STEVE:  You know, I have to confess, and actually I mentioned this during the presentation, remember I was off in Cambridge speaking to - I was actually the keynote speaker for a conference that Harvard was hosting last week.



LEO:  Wow, that�s pretty prestigious.



STEVE:  And I�ve noticed that my own awareness of these security issues is heightened as a consequence of listening to myself when I�m, you know, talking to you.



LEO:  Yeah, so you don�t normally listen to yourself.  No, it does, you know, and I�m not - "scared" is absolutely the wrong term.  We�re talking about what you should be aware of and what you should do prophylactically to protect yourself, that�s all.  And I think half of the value of this, maybe more, is just learning about all these interesting technologies, like crypto, that is useful.  We�re going to learn about one today that�s very interesting.



STEVE:  Well, we are.  And in fact I�ve had more and more people whose postings on the Security Now! page when they�re submitting things are saying, you know, when you and Leo wander off topic, it�s just fine.  So don�t let those grousy people who are complaining, you know, that you guys are talking about non-security stuff restrict you from doing so�because...



LEO:  That�s why we do podcasts.  If we wanted to keep on point we�d do it on the radio or on TV.  Or we�d give speeches at Harvard.  So today we�re going to talk about�TPM.



STEVE:  Yes, the Trusted Platform Module.  It�s something I�ve actually been looking into now for months in preparation for finally getting enough of a feel for it that I could characterize it.  It�s been an elusive thing for me to get a handle on because it�s not - I don�t know.  I mean, now I have it, and it feels like, ah, well, of course, now I can explain what this all is.  But for the longest time I just - I didn�t get what it really was, where the limits were, where the boundaries were.  I now understand it well enough, I think, to give people a coherent sense for what it�s all about.



LEO:  And it has been very controversial.  So we�ll talk about that, too.  Let�s...



STEVE:  And I know why, and I know why it was mis-marked.  So, yeah, we�ll definitely - don�t let me forget to talk about that.



LEO:  Yeah, we�ll address those controversies.



STEVE:  I have to say now that I�m, you know, well, first I should mention that you and I are recording two podcasts today.  We�re doing 99, which is this one; and we�re going to record next week�s immediately afterwards.  I guess are�you...



LEO:  I�m going to Canada, yeah.



STEVE:  You�re up in Vancouver doing...



LEO:  Steve is so dedicated.  Some of the podcasts, the news ones, when I�m in Canada we don�t really do.  But Steve is so dedicated that we do two ahead of time so that we don�t miss an episode.  Possibly because you want to get to 100.



STEVE:  Well, yeah, we are there now.



LEO:  We�re one away.  One away.



STEVE:  What I wanted to mention is, being 100 we�re at a mod 4 also, of course, so it�s going to be a Q&A episode.  And so this morning I was rummaging through and catching up on a lot of the postings to the Security Now! page.  And I don�t know what�s happened, Leo, but there�s been a clear increase in, I don�t know, our listeners� involvement and participation and feedback.  What I�m getting is so much good commentary that - so I want to share some of it today.  But what I�m thinking of doing maybe is we�re getting so much good feedback from people, I mean, really interesting stories and sort of tangents off of what we�re talking about that I�m - I mean, and so the mailbag is full to overflowing at this point - that I�m thinking maybe of doing mod 4 plus�2 would just be mailbag episodes.



LEO:  Okay.



STEVE:  So the idea would be...



LEO:  All mailbag, the whole thing.



STEVE:  Exactly.  Because, I mean, there�s a couple long ones that I want to share with people because they�re really neat.  And then we�ll discuss them, of course.  So it�ll be like, you know, interesting stuff that our listeners are providing for us to talk about; not just a question to be answered, but whatever it is they want to discuss.  And so we�ll alternate between regular shows and mailbag and Q&A, essentially.  So mod 2 plus 4 will be mailbag.  But in the meantime, you cannot believe how many people told us how to pronounce the unpronounceable...



LEO:  Aberystwyth.



STEVE:  Exactly.  And it�s Aberystwyth [aber-rist-with].



LEO:   Aberystwyth.



STEVE:  Aberystwyth.  And...



LEO:  Well, you know who grew up next door, our very own Will Harris.



STEVE:  Oh, no kidding.



LEO:  Yeah.  So he of course immediately called me and said c�mon, mate, it�s Aberystwyth or whatever it is.



STEVE:  It�s Aberystwyth, yes.  So I wanted to acknowledge everybody who posted, okay, here�s how you pronounce that.  So we now know.



A listener in Sacramento, who must have been anonymous or I would have put his name here, mentioned that referring to the - my mention that the - this was from our episode last, the identity metasystem stuff, where we were talking about�Microsoft�s...



LEO:  Meta authentication, yes.



STEVE:  Exactly.  We were talking about Microsoft�s CardSpace.  And I mentioned how I liked the prior name InfoCard better, that was their working name.  And he commented that InfoCard is an Apple trademark because there was something called InfoCard back in the iMac days.  He says he has an old copy of it, and that�s why Microsoft was unable to use it.



LEO:  Interesting.



STEVE:  Which, you know, it may be very true.  I don�t know that for a fact, but certainly sounds...



LEO:  I never heard of it, but I�m sure it�s, you know...



STEVE:  Plausible.



LEO:  Who knows, yeah.



STEVE:  Bill Holton of Gainesville, Florida writes that he is human.  And that reminded me that I had said, maybe it was in last week�s podcast, that this week we were going to be talking about CAPTCHA technologies under the title "Are You Human?"  And it wasn�t until I saw his posting that I thought, ooh, that�s right, that�s what we were going to talk about.  But I was all revved up and geared up to talk about TPM.  So we�ll perhaps do that next week.  Not really sure.  But anyway, he says...



LEO:  It won�t be next week, it�ll be two weeks because we�re doing...



STEVE:  Oh, there, thank you, Leo.



LEO:  So 101 at the soonest.



STEVE:  So, oops.  And that would be a mailbag episode already.  So anyway, but...



LEO:  We�re out of control.



STEVE:  Oh, no, wait, it wouldn�t be because of Q&A.



LEO:  No, it wouldn�t be, yeah.



STEVE:  Because mailbags are definitely divisible by two.  So Bill Holton says, not only is he human, but that most computers don�t think he is because he�s blind.



LEO:  Uh-huh.  CAPTCHAs are a notorious problem for people with poor vision, yeah.



STEVE:  And so he says, "The increasing use of CAPTCHA is locking me and others like me out of more and more sites.  When you do your �Are You Human� podcast, please mention the need to find non-visual-based CAPTCHAs, and ones for the deaf blind" - oh, that�s going to be a real challenge - "who can�t even use the audio CAPTCHA sites like Google and Yahoo! are adopting to help the blind get around the CAPTCHA problem.  You may want to try the audio CAPTCHA to see how unusable it is...."



LEO:  Oh, you want to hear the audio CAPTCHA on mine?  I�m using now for my emails, to avoid spam, I�m using the Carnegie Mellon one, which I know you�re going to talk about because it�s a really cool idea.  It�s the reCAPTCHA.  And I thought, oh, this is great, because I had been sensitized to the issue of CAPTCHA.  That�s where they put that weird text that you can�t - that machines supposedly can�t read, and humans barely can.  And you type it in, and then you know you�re not a machine.  But the problem is, of course, if you can�t see, you can�t type it in.  So this has audio.  But listen to this.  This is how they get around the machine reading the audio.



[Audio CAPTCHA]



STEVE:  Oh, my God.



LEO:  You can do it, though; right?



STEVE:  So they�ve done the same thing with the audio that they have done with the visual.



LEO:  Yeah, exactly.



STEVE:  Oh, my God.  I mean...



LEO:  But, you know, I could do it.



STEVE:  I�ve got to say, sometimes I cannot type in the visual CAPTCHAs correctly.



LEO:  Me, too.  They�re very difficult.  And I have to say the audio is difficult, too.  But that�s kind of the point.  I mean, I understand that it�s difficult.  You only have to do it once on my site.  You get the email address, and you can use it from then on.  But...



STEVE:  Not right.



LEO:  ...you know, it�s tough.  Accessibility on the web is getting harder and harder as we get more and more Flash and scripted stuff.  And it just - it�s difficult.  But it�s certainly worth doing.  We�re redesigning the radio show site, and that�s one of the things that has a very high priority is to make sure it�s accessible.  A lot of blind people, of course, listen to the radio.  And podcasts, I might add.



STEVE:  Yeah, that really does make sense.  Okay.  Last mailbag submission.  It was a long one, but interesting.  Jeremy Clark of Ottawa, Canada says, "I love the podcast, and I listen to every single one.  I think you have got EV certificates all wrong, though."



LEO:  What�s that?



STEVE:  Now remember the EV, I mentioned and was grousing about it a week or two ago.  Those are the things that are super expensive from VeriSign which are what enables you to get the green background in IE7 as a phishing preventer.  And the idea is that, you know, I�m already unhappy that this whole certificate thing just seems like such a scam, that they expire every couple of years, and I�ve got to pay $700 or something like that for another two years.  Their EV is Enhanced Verification or some acronym of that sort, for which they get a ton of money.  Anyway, he says, "EV certificates are a signal of legitimacy, not of security."



LEO:  Yes.



STEVE:  "And they were created specifically to combat�phishing."



LEO:  Right.



STEVE:  "In the days before international banking, banks would build elaborate buildings.  The reason for this is often considered by non-economists to be competitive.  However, economists know that if it were out of competition, there would be similar architectural arms races in other industries.  Yet banks were different somehow.  The real reason is that the bank could afford to build beautiful buildings, while the fraudsters, who would open a bank and then skip town with the money deposited, could not.  A baroque building was a signal of legitimacy.  These scenarios are called �signaling games� in economics and game theory that only a legitimate bank could afford to send.



"The problem in the online world, as you well know, is that people use the same rationale.  If they go to a phishing site, and it has a nice layout with scripting and menus and animation, they assume it�s real.  Enter EV certificates, the online equivalent of building a nice bank.  It only makes economic sense to get one if you plan on sticking around.  A nice website is a signal that anyone can duplicate, and therefore it isn�t a good signal at all.  An EV-enhanced certificate that costs $15,000 per year is not easily duplicated and therefore is an effective signal.  If you are legitimate and can�t afford one, you probably are not a target for phishing in the first place."  Which actually I thought was sort of a really good point that he made.  "If you don�t have the same need to signal your legitimacy as PayPal, eBay, Amazon, or an online bank, all of whom can afford one."  And then he says, "I�ve written more on this exact topic if you�re interested," blah blah blah.  But anyway, I just - I loved what he said.  I mean, this is the kind of really good stuff that�s appearing in the mailbag now, so...



LEO:  Yeah, it�s fascinating.  There is, I think, a flaw in the logic there I have to point out, which is that because maybe - and maybe it�s a flaw in the way it�s been communicated what that green bar means.  But as long as you�re doing that green bar, pretty soon people associate it with safe.  And as he points out, you know, you can be safe and not be able to afford it.  Unlike a bank, where you�re saying, well, if he�s a big bank he�s going to be able to afford a nice building.  It�s not necessarily the case.  So on a website, you know, you could be legitimate.  And he says, well, it doesn�t matter because nobody�s phishing you.  But it does matter to the end-user because they pay attention to whether there�s a green bar or not.



STEVE:  Yes, exactly.  And that�s, of course, the foundation of my gripe is that...



LEO:  Right.  You�re legitimate, but you can�t afford it.



STEVE:  Well, I don�t want to.  Because, I mean, it�s just�extortion.



LEO:  But he makes a good point.  Nobody�s going to phish GRC.com.  Actually, I take it back.  And that�s the other flaw in this, is he�s assuming economic gain.  And if it�s pure economics, that�s true.  But people might phish GRC.com to put a fraudulent security program out.



STEVE:  Sure.



LEO:  So that isn�t purely economic.  So there are some flaws.  This isn�t exactly analogous to the bank.  I think your gripe still stands.  People would want to phish GRC because they could say, hey, get our free new security program, and it�s a Trojan horse.



STEVE:  And if were something I could buy once, if I could get a lifetime - well, in fact that would create the kind of lock-in that VeriSign would like to have with their customers because, you know, in fact, they sent me a questionnaire the other day saying oh, how happy are you with our certificate services?  And I just - I took the opportunity to tell them exactly how I felt about the fact that I was having to fork over all this money every couple years.  I said, you know, I like your service.  I�ve used it for years.  But boy, if anyone came along that offered, you know, the same thing for less money, there is not much lock-in here.  But as I was going to say, I would buy it once.  I�d even spend 15 grand one time, if then I could have, like, a reduced annual rate and still get the greenness, having paid for it once.



LEO:  Well, and again, I think there are people who are giving away good, free, legitimate security software who might be phished who have no economic value and no economic incentive and still can�t afford this for a very good reason:  They�re not asking people to pay for it.  So I think this is a particularly capitalistic point of view on the situation and doesn�t really address the real issue.  I agree with you, Steve.  I don�t even think it should be $15,000.  I understand; but, you know, there are ways now to validate somebody without making them pay a lot of money.  That�s pure greed, I�m sorry.



STEVE:  Yeah, I know.



LEO:  That�s pure greed.  We�re not in the 18th century�anymore.



STEVE:  And I think Jeremy did have a typo.  I think it�s 1,500, not 15,000.



LEO:  Yeah, it�s not 15,000, yeah.  But even that�s a lot.



STEVE:  I did have one more note here.  I scrolled down.  That one was so long.  I have Eric Espinoza of Pasadena in the mailbag.  He says, "I�m a systems security guy for a government organization."  And actually his email gives it away, he�s a well-known propulsion laboratory.



LEO:  Oh, okay.



STEVE:  So he certainly does know his technology.  He says, "...and have followed your podcast since the beginning.  I usually recommend this podcast to people showing interest in technology.  There are a few things we disagree on, but for the most part we�re on the same page on everything.  Just wanted to give an anecdote about how checking the certificate for a VeriSign or Thawte or {insert your trusted provider here} is not enough to ensure integrity of the site.  My girlfriend, after seeing �Blood Diamond,� which is a recent movie, is not any longer into mined diamonds."



LEO:  Awesome.



STEVE:  "She prefers lab diamonds..."



LEO:  Good for her.



STEVE:  "...and asked me to get her a pair of earrings from a site she saw advertising in the L.A. Times called �Diamond Essence.�  Turns out they misrepresented cubic zirconia as lab diamonds, but that�s another story.  I did my usual checks before putting my credit card in, which are as follows."  I mean, this guy is way thorough.  "Typed in the  name into Google.  Looked for horror stories.  Checking the cert.  Checked the CRL," that is, the Certificate Revocation List, "for the registrar involved.  All looked good, so I proceeded.  When I woke up the next day I got a call from my credit card company asking about various charges.  My card had been hit by ten different places trying to rack up over $2,000 in charges.  Fortunately, the bank blocked all but $10 of those transactions.



"Not being sure that this was the place where the whole thing originated, I decided to try one more time.  This time I used a PayPal one-use virtual MasterCard."



LEO:  Smart.



STEVE:  And I didn�t even know that PayPal offered that.  But now that I know, I�m going to look into that because that sounds like a cool thing.



LEO:  Many Visa and MasterCard people do, and that�s really  neat, yeah.



STEVE:  Yeah.  He says, "I had loaded up just the appropriate amount into my PayPal account and didn�t allow the thing to pull from any other of my other accounts in the case of overdraft.  I put the virtual MasterCard number into the site and, bam, got hit with a ton of charges that were immediately declined."



LEO:  Interesting.



STEVE:  "I called up the company, asked to speak with management, and told him what had happened.  He, probably oblivious to the situation, insisted that the problem was probably due to spam infection and so forth," you know, blah blah blah, not our problem, not our fault.  "I informed him that I had already passed the info along to my bank, and that he should expect a call telling him that I wasn�t being malicious, but had facts to back up that his site has been hijacked or hacked or something."  And he says, "Anyways, I have tried contacting VeriSign to let them know of the incident, and today they are signed by Thawte.  Not sure if they�re still hacked," but I guess that means that they changed their certificate as a consequence.  He says, "The point is, a valid cert is not enough certainly in every case.  Unfortunately, there isn�t anything better.  I�m not here promoting PayPal or anything, but I think the use of one-time cards with simple dispute procedures is what is needed online.  That way one can severely limit the amount of damage done.  Since most hackers use a $1 charge to ensure the card is active, they�ll take at most $1 from your�account."



LEO:  Right.  Wow, very interesting saga.



STEVE:  So, I mean, we�re just getting such good postings to the page that I think, you know, it may very well be that there�ll be enough things to share.



LEO:  Starting with 102 we�ll be doing mailbag episodes.  That�s great.



STEVE:  And speaking of good things to share, I do have one of my really fun and interesting SpinRite success stories to share.  This is from Aaron Jensen in I think it�s Lumby, British Columbia.  He says, "Hi, Steve.  I�m a computer systems technician for a large manufacturing company.  But like many others in this field I also support a few smaller clients and my family members in my off hours.  I�ve been listening to Security Now! since the beginning and don�t think I�ve missed a single episode.  I must be honest and admit that, before you started talking about SpinRite success stories on the podcast, I was only familiar with GRC for the ShieldsUP! utility which I had been using for years in the past."  So that�s very cool that, you know, we�re able to use this to get the word out.



"It was early into the Security Now! episodes when I had my first occasion to run SpinRite on a laptop owned by a customer�s daughter.  The system was only partially booting into Windows and then rebooting itself.  This of course caused an endless loop many techs are familiar with.  The daughter is an artist, and her laptop was the only storage location for gigabytes� worth of photos.  Many of these photos were of her artwork that had long since been sold, and now the photos were her only record of these paintings in her portfolio.  Needless to say she was terrified that all these images had been lost.  I went online and purchased my first copy of SpinRite, ran it on the drive overnight, and the next day the system booted without even an error.  We immediately backed up all her artwork photos, and she�s still using the same hard drive to this day."  Which I guess must be, like, more than a year ago since he�s talking about early on in the podcasts that this began.  So he says, "She�s still using the same hard disk to this day, although she backs it up much more often."



LEO:  Good.



STEVE:  Yeah, good.  "Later I kept the copy of SpinRite for myself as it was licensed to me, but I went online with her parents and had them purchase another copy for their own use, just in case her laptop drive had more problems down the road."  Then he says, "In the last year or more I�ve had three to four other occasions where my copy of SpinRite really saved the day.  And in each case I went online with the computer�s owner and helped them purchase a copy of the program.  I wanted each of them to have a copy of SpinRite because it�s so easy to use if they ever needed it again.  Plus I really wanted to support you and the incredible job you�ve done with this application.  These days, larger software developers seem to spend a lot of time trying to design the ultimate application for everyone.  It has to do lots of things for lots of people so it can have the largest potential sales opportunities.  But in my experience, I�ve always found that when a developer like yourself sinks tons of time and experience into an application that is designed to perform pretty much just one job, it almost always does that job better than anything else.  In every case where I�ve had a need to run SpinRite, it has done the job better than I could have ever expected.  Even my mom has all of her data on her new computer because SpinRite saved it all when her old computer�s hard drive crashed."



LEO:  Well, there you go.



STEVE:  "Keep up the good work with SpinRite and Security Now!, and congratulations on the recent milestones hit by ShieldsUP."  So...



LEO:  That�s neat.



STEVE:  ...really nice, really nice posting.  I thank Aaron�for...



LEO:  It�s nice to have good customers.  I like that.



STEVE:  Yeah.  Well, and he is, I mean, I couldn�t ever ask for anything more than him using his copy - which I have no problem with - to fix somebody, and then helping them to buy their own.  You know, that�s the perfect model.



LEO:  Are we going to - I�m trying to think.  Maybe we should do Nerds On Site and then we will get - no, you know what, I want to get to TPM.  We�ve been waiting long enough, and I want to hear about it.  We�ll talk about Nerds On Site in a bit.



STEVE:  Okay.  TPM.



LEO:  Trusted Program Module?



STEVE:  Trusted Platform Module.



LEO:  Trusted Platform, okay.



STEVE:  Okay.  So what TPM is, basically it all comes down to being a chip.  It is a chip on the motherboard, that is to say, on the platform.  And now this doesn�t have to be, though, a PC.  It�s entirely foreseeable that these things will be in PDAs and cell phones in the future.  It is meant to be tightly integrated to the platform, that is to say, soldered onto the motherboard, although as it turns out it is on a small daughter board, even on IBM�s ThinkPads, which are TPM-enhanced laptops.  So it doesn�t necessarily have to be non-removable, but it�s certainly not user-removable.  That is, it�s not, you know, behind a door that anyone can open the screws and pull out.  It�s meant to be integrated onto the platform.  So the reason it�s called Trusted Platform Module is it is a component, like the processor chipset and so forth, that is not user-removable.  And that�s part of the benefit it provides.  So it is inherently just a microcontroller.  It�s a smart engine that has a number of characteristics.



The good news is, it is completely open.  The specification is open, freely downloaded.  There is source code now that is completely open source and GPL�d.  And, for example, Linux has drivers that can use the TPM.  It got off to a somewhat rocky start because when Microsoft announced Palladium - that is, you may remember, Leo, their very controversial, we�re going to lock the system down so tight that nothing will be able to escape it, and we�ll know exactly what�s going on.  I mean, Microsoft�s Palladium announcement raised a ton of controversy in the industry.  Well, TPM is related very peripherally, if you�ll pardon the pun, because it is an enabling component of Palladium; but in no way is it Palladium, nor is it DRM.  One of the other concerns was that Palladium was like another march forward in Microsoft�s DRM-directed campaign.  So TPM, the Trusted Platform Module, got discolored as a consequence of...



LEO:  Palladium.



STEVE:  ...its sort of, yeah, exactly, it being something that Palladium could use.  Now, Microsoft actually called their hardware side an SCP, a Secure Crypto Processor.  And so that was the acronym that they were using, saying that Palladium would be software and hardware, and on the hardware side would be an SCP.



Now, what�s interesting is that Microsoft has also just patented their approach upside down and backwards and sideways.  So they�re saying, oh, no, this is not just us, you know, other OSes could use it.  But it�s entirely clear that they could also foreclose that from happening by leveraging their patents.  And of course we�ve just recently talked about Microsoft and their patents.  So...



LEO:  Right, and their leverage.



STEVE:  Exactly.  So it�s very clear to me that TPM is - that�s the solution that�s probably going to win because it�s going to get industry support, and it�s going to get multiplatform support.  You know, I have it on two machines.  I have it on a motherboard that I recently purchased that�s�- I think I�ve mentioned my quad core machine that has TPM, and my ThinkPad T60 laptop has it.  And I�ve got it enabled.  It�s worth noting, and this is in the spec actually, that it is disabled by default.  So it is normally turned off because of the sensitivity there is to issues of privacy relating to this, even though I really think those are misnomers.



Okay, now, what is it?  What it provides is a number of basically crypto services.  The beauty of it is that there are things that you would like to do in crypto that you would like to shield from malicious software.  And that�s really all it is.  It�s the movement of some sensitive cryptographic operations into hardware for the sole purpose of preventing malicious software from having access to those operations.  So it has non-volatile memory.  So again, it�s a chip.  And it�s like a little coprocessor.  It�s got non-volatile memory.  And the user is able to say "flush yourself and re-init," and it will do that.  And you normally do these things from the BIOS.  So you�ll have a TPM-enhanced BIOS which understands that it�s got the TPM hardware there with it on the motherboard.  And you�re able to disable it completely, in which case all of its BIOS support and functionality and access by the operating system�s drivers are also disabled.  Or you�re able to reinitialize it, basically saying forget everything you knew, I want you to restart.



Well, one of the things it has that we�ve talked about before that is very cool is a true random number generator, not a PRNG that is a pseudorandom number generator, true random numbers being what you are able to generate in hardware, taking advantage of things like thermal noise in the chip itself, like literally electron migration or electron tunneling or clock jitter, where it�s able to use just things that are non-algorithmic in order to generate its random numbers.  So it�s even a better random number generator than anything that software could do because, as we know, as we�ve said before, software is 100 percent deterministic.  So there isn�t a way that software can generate random numbers because it�s designed not to.  It�s specifically designed not to.  So an algorithm can�t be random.  It can be very good pseudorandom, but not truly�random.



Well, the TPM has true random number generation capability.  It also has both volatile and nonvolatile memory so that it is able to store things persistently until such time as the user or the various APIs that are used to access it tell that to change.  One of the things it has, for example, is a monotonic counter, which is also very useful.  So it�s got a counter which counts up forever, meaning that it�s able to solve problems with any kind of replay attacks by having a counter which just starts at zero when it�s born, and it never wraps around.  It�s got so many bits in the counter that it absolutely positively can never wrap around.  And anytime the chip feels that it�s about to lose power, as soon as there�s, like, a power loss line, then it writes that counter into nonvolatile memory.  It doesn�t continually write it because, as we know, EPROM technology wears out over time.  So you would not want to be continually writing into the EPROM or the chip would burn itself out.  But when you shut it down, then it stores the current state of the counter into nonvolatile memory so that when you power up again, it starts up where it left off, therefore guaranteeing that it will never reuse the same number again.



It also has full support for RSA asymmetric encryption.  So RSA-compatible, you know, public key crypto.  It�s able to generate public and private keys.  It�s able to perform RSA operations.  And any one of these you�re able to tell it what bit-length you want; but the spec requires at least 2,048 bits of equivalent RSA key length, so next-generation key length, aimed at the future.  It also has built-in SHA-1 hashing of 160 bits minimum.  So, for example, one of the things that the chip does is, when you initialize it and you say, okay, go, it will use the true random number generator to generate a public and private key pair, that is, an asymmetric key pair.  And part of the coolness of this is there is nothing you can do, no commands you can give it, that will ever cause it to export its private key.  So it�s got this magic 2,048-bit private key which it generated using its true random number generator, and there is no way you can ever force it to reveal it.  No monitoring of the pins with the scope, no...



LEO:  I�m always suspicious when I hear "never," though.  I mean, hackers are so ingenious.



STEVE:  No, but, I mean, the technology doesn�t permit it.  There�s no - well, okay, sure.  You could have a bug in the chip.  There could be a mistake in the microcode.  There could be that kind of thing.  But the specification does not allow for this private key to ever leave the chip.  And all the crypto has been designed so that it doesn�t need to.



So essentially the chip has a number of features.  It is a secure place for crypto to be done by the host operating system where there is no danger, at least for the crypto operation itself, of that being intercepted and abused in any fashion.  But it also has a number of other things.  There�s something called "hardware platform attestation" that is attesting to the hardware.  The hardware has, like, any hardware has a whole bunch of settings in the BIOS.  You�ve got hard drives with serial numbers.  You�ve got a bunch of things about the platform at any given time.  It�s possible for you, and the chip has this technology, to take a snapshot of the hardware platform, and the chip will then�- it will hash that down into 160-bit hash representation of the current hardware platform settings.



And you�re able then, if you wish to - and again, all this is under software control, but you�re able to have the TPM chip attest to the state of the hardware and essentially certify that no changes have been made from now compared to the time that this hash was generated, so that you�re able to say the hard drive hasn�t changed; settings haven�t changed.  Whatever characteristics of the platform you want to be attestable, this will verify that.  And you�re also able to do the same sort of thing during the OS boot process.  And, for example, the Linux implementation of this has that now, so that Linux is able to interact with this hardware during the boot process and essentially generate a series of hashes of the kernel as Linux boots so that you can absolutely verify that no change has been made to any of the Linux modules from the time that the snapshot was taken.  So it gives you a means of booting into a secure known�state...



LEO:  That�s nice.



STEVE:  ...that prevents - oh, it�s way cool, Leo.



LEO:  Yeah, yeah.  It sounds like a really great idea.  And the security, I mean, the issues that people are coming up with were more about things - and I think it was maybe more Palladium implementation of it, but things like revoking documents or revoking emails after they�d already been mailed.  But that�s not part of TPM, per se.



STEVE:  Well, and that�s a perfect segue into my noting that, yes, people have been concerned that, for example, it could be used to give you better DRM, you know, Digital Rights Management, something more serious for software to lock onto.



LEO:  Uncrackable.



STEVE:  Well, except that - and here�s the point.  There�s no protection from the user.  The protection is from malicious software.



LEO:  Ah, okay.



STEVE:  And that�s the key.  The TPM specification does not try to protect itself from the user, from the owner, from someone having physical presence.  It�s designed to protect from malicious software.  And so it�s really not enhanced DRM because you could reset your TPM chip and say, okay, look, now I need to reauthorize myself.  So it�s not that.  And several of the people that defend the spec make the point of saying, look, all this is, is better security.  Sure, you can use better security for pro-user or anti-user benefit.  But it�s not the security�s fault.



LEO:  It�s not inherent in security at all.



STEVE:  Precisely, in the same way that the Internet, you know, the Internet is not bad just because bad things can happen with it.  It�s just a capability.  So and what I like about TPM is that it moves the sensitive operations out of software, where they are fundamentally open to compromise.



Now, certainly you still need a secure interface to TPM.  And there are, there�s some scenarios where, in fact, in order to make changes, the OS has to lose control, that is, you go through a full hardware reboot that takes you back into the BIOS, where you�re back in control of a limited environment where you�re got much better guarantee of a secure path between the keyboard and display and the TPM, in order to do some things.  And then you go back into the operating system.  So, I mean, there are scenarios that will be developed in the future where things that were not used to being done now will be done with TPM because the hardware platform support provides it.  And I just think of it as an overall good thing.  Once I understood what it was, I enabled it on my platforms.  And as you know, for example, I�m using a fingerprint swipe on my ThinkPad which unlocks both the BIOS and unlocks my password-protected hard drive, and all of that is stored in the TPM chip.



I should mention a little bit more about the nonvolatile memory side.  It�s able to store the keys and certificates and other data that you would like stored in a way that nothing can get to it.  The problem, if you store the stuff on a hard disk, is that it�s there on the hard disk.  But if you store your passwords and your certificates in this nonvolatile memory, and you lock it so that it requires a boot-time, power-on-time unlock, then there isn�t any way for this to get compromised.  It won�t let that stuff out until you�ve provided it with something that hashes down to the same value it�s got stored in this single chip.  And nothing comes out of its pins until you�ve said, it�s me, I need access to this stuff.  So, I mean, it�s like a very secure hardware-enforced crypto vault that is part of the�hardware.



And, you know, when we�ve talked about multifactor authentication, we�ve talked about how single-factor username/passwords, something you know, is not safe; that really something you have would be nice to have added.  Well, TPM provides very carefully designed second-factor authentication of something you have.  You have the laptop.  You have the cell phone or PDA or whatever the TPM chip has been installed in.



LEO:  So a weak password would still have the same consequence if somebody stole your laptop, though; right?



STEVE:  Yes.  Again, there�s no way to prevent against that except that the TPM also, in the spec, at least in 1.2, the�most recent version, they�ve got dictionary attack prevention.  So it will shut itself down if it sees someone trying to guess your password.  It will first lengthen the response time, and then lock out.



LEO:  TPM is from Intel and Microsoft, or who was involved in TPM?



STEVE:  120 different companies...



LEO:  Oh, interesting.



STEVE:  ...are involved in this.  I mean, virtually, it�s a Who�s Who.  It�s from the TCG is the Trusted Computing Group, which is an unaffiliated independent alliance of more than 100 companies that have gotten together and said we want an open spec, an open platform, and agreeing on what the functionality should be when we create what Microsoft calls SCP, the Secure Crypto Processor.  Well, I�m really glad this wasn�t done and spec�d by Microsoft.  It was done independently.  And, for example, yes, Intel�s newer chipsets have all the TPM functionality built right into them.  So...



LEO:  But many other people make TPM microcontrollers.  So it�s so open that even other hardware manufacturers are involved in it.



STEVE:  Oh, exactly, it�s multiplatform and evolving, complete open spec, all the PDFs are there.  I think it�s at TCP.org, the trustedcomputinggroup.org has all this.  So, I mean, this is our foundation for moving crypto onto hardware and being able to securely store stuff we really want to be kept safe in a way that nothing that happens, no kind of system subversion is able to get there because it�s implemented in hardware.



LEO:  And you�re using this on your T60?



STEVE:  Yes.



LEO:  And it hasn�t hindered you in any way, and it�s worked reliably and...



STEVE:  No, I just like knowing it�s there.  I love...



LEO:  So you don�t see it, really.



STEVE:  Yeah, I love that when I swipe my fingerprint, the characteristics are found, they�re hashed down, they�re given to the TPM chip.  It compares them with the various fingerprints because I�ve got two fingers from each hand.  Which is actually a good thing because I�ve got a Band-Aid on my right forefinger right now, and I realized, wait a minute, I can�t log in.  Oh, wait a minute, I did my left hand, too, so, yeah.



LEO:  Whew, a close thing.  And how many manufacturers, I mean, so you can get it on your Lenovo.  Dell, I think, is offering some machines with it; yes?



STEVE:  And Dell is definitely in the...



LEO:  They�re a big part of it.



STEVE:  ...Trusted Computing Group, yes.



LEO:  Right.  So you should probably look around, especially if you�re getting a laptop, this is really important, and look for one that has TPM enabled.



STEVE:  Yes.  I think for portable computing it offers the potential for really good security.  And I can foresee the day where PDAs and cell phones will have a little fingerprint swipe sensor, and that�ll go right into a little TPM chip integrated into the electronics to say, yes, this is me who has this device.



LEO:  That�s neat.  That�s neat.  All right.  Let�s see, I think we�ve wrapped this up.  We�re going to do a question-and-answer session next week for our 100th episode.  I apologize, I didn�t get balloons or streamers or anything.



STEVE:  Never missed a week, Leo.



LEO:  That�s pretty impressive because there�s no other podcast that can make that claim.  No other TWiT podcast, and probably not many other podcasts, either.  That�s pretty�impressive.



Well, good job.  We�ll celebrate next week.  I hope you�ll join us.  I�m Leo Laporte.  Don�t forget to go to Steve�s site, by the way, GRC.com.  That�s where you can get 16KB versions of this show, the low bandwidth versions.  You can also get transcripts and all the show notes, and participate in his great security forums.  That�s GRC.com.  It�s also where you�ll get SpinRite, the world�s best, the one they�re all copying, the finest disk maintenance and recovery utility in the world:  SpinRite.  GRC.com.  Also great free security programs and ShieldsUP!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/








GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#100

DATE:		July 12, 2007

TITLE:		Listener Feedback Q&A #21

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-100.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 100 for July�12, 2007:  Your questions, Steve�s answers.



It�s time for Security Now!, our 100th episode.  We need streamers.  We need - we�re actually recording this on the 4th of July.  You�d think there�d be some fireworks.  But no.  Nothing.



STEVE GIBSON:  No.



LEO:  Unlike some of the other shows, we�re just going to go along about our business.  But congratulations, Steve.  My deepest thanks for allowing us to carry this on the TWiT network.  It is absolutely, after TWiT, the flagship podcast, it�s the one everybody talks about.



STEVE:  Well, I�ve been really, really happy that we did it, Leo.  I wouldn�t be doing it were it not for you because, you know, you make me get up...



LEO:  I think you were the second one we did; right?



STEVE:  You make me get up every morning and think about, okay, what are we going to do next week?



LEO:  I�m sorry.  I put you to work.



STEVE:  I think it�s valuable.  I found out when I was doing the keynote at Harvard, I was very surprised by the number of people who are Security Now! listeners who were in the audience.  I mean, sure, it�s that kind of audience.  But�still...



LEO:  No, that�s encouraging.  That�s really neat.



STEVE:  This matters to people.  And they really enjoy it.



LEO:  I�m thrilled.



STEVE:  I�m here.



LEO:  Good.  Well, it�s a question-and-answer mod 4.  If you divide 100 by 4 you get 25.  So we�ve got our 21st question-and-answer session.  You want to read a question or two from the mailbag before we get to our official dozen?



STEVE:  Well, you�re going to be doing most of the reading this episode, as you do on our Q&As.  So rather than doing mailbag - and in fact, some of these are mailbag-esque questions, again, because I was just finding so many good�stuff.



LEO:  I guess what you�re saying is, instead of it being a question per se, it�s a statement or an observation that is of great interest.



STEVE:  To some degree, yeah.  But I will read something which, of course, I always love to read.  I got a really interesting and fun piece of feedback from David Mitchell.  And the subject was "You are the man," with about 15 exclamation points after it.  And at first I thought that, you know, he was telling me that I�m the man.  But it turns out that�s from his mother.



LEO:  Awww.



STEVE:  Anyway, so he says, "I listen to Security Now! fairly often.  I�m a network admin part-time and full-time student.  I figured I�d give credit where credit is due.  I recommended SpinRite to my brother when his hard drive crashed.  It didn�t do much for him," and he says "(I suspected it was the hardware in his case, given the noises it was making, not much could be done.)"  But he says, "My Mom is a district attorney in Alaska.  When she had some power failures (a guy electrocuted himself and took out the power grid for the small town she�s in)..." I guess he must have been low resistance.



LEO:  Yeah, it went right through him, short-circuited the�thing.



STEVE:  So some poor guy electrocutes himself and causes a power failure, problems for his mom�s computer.  And he says, "And her Windows wouldn�t boot.  She had serious cases before a grand jury, and the IT department was no help.  Due to where she was, the best they could do was have her ship her PC to Anchorage for repair and perhaps total loss of her case files."



LEO:  Oh, yeah, almost certainly.



STEVE:  Yeah.  Well, I mean, they�re not going to care.  They�re going to say, oh, give �em a new hard drive.  "Since it didn�t do much for my brother, I figured she could use the copy he purchased" - he�s talking about of SpinRite - "since I figured it was her best chance, since I couldn�t do anything from the East Coast.  It�s a paid-for copy, and it stayed in the family, so I figured you wouldn�t be too miffed at that."  Of course not.  So he says, "You can read below to see how it turned out.  P.S.:  I�m going to get on her about doing backups after this."  And so this is where he attaches the mail forwarded from his mom, where her subject line is "You are the man," with the 15 exclamation points, referring to her son.  So this is from Susan Mitchell, who says, "After days of system failure, to the point where I broke down in tears on the phone with our office manager (in Anchorage, of course)..." and of course we don�t know what little podunk she�s in.  But wherever it is, if you electrocute yourself, the power goes out.  She says, "I was finally able to sit down today, on my day off, and get the SpinRite on a floppy disk (had to scrounge to find one) and ... it worked.  I then ran the original Windows CD to restore it, and I am back up and running.  You are the man," she�s saying to her son.  "I know I am your mom; but seriously, I can give you very high marks and recommendations on your work, and best of all your knowledge."



LEO:  Oh, isn�t that nice.  You know?  And is it okay, I mean, is a license like a family license, is that okay?



STEVE:  It�s the GRC tolerant license.



LEO:  I like that.



STEVE:  I don�t have a problem with that.  If you need to fix your mom�s computer, by all means.



LEO:  But if it fixes it, you know - I�ll tell you what.  Since it didn�t fix his brother�s, okay.



STEVE:  Yeah, completely.



LEO:  If it fixes two computers, then maybe you�d want to�buy a second license.  I�m trying to help you out here,�Steve.



STEVE:  Okay.



LEO:  Trying to make you some money.  All right.  Let�s get to our questions.  There�s 12 great questions, as always with our listener Q&As.  Starting with Evan Moore in Leesburg, Virginia, with an authentication puzzler.  You know, I have to say parenthetically that the authentication episodes you�ve done, and now the TPM module that you did last week, has really been great, and obviously spurred a lot of interest.  It�s something that - you quantified something that we all kind of are somewhat familiar with and really explained why this is better than that, you know, two is better than one and so forth.  And it�s really been�great.



So here�s the situation.  See if you can untangle this one:   We have a password ID form for students/faculty to confirm their identity outside our campus if they need their log-in credentials auto-emailed to the email address we have on file.  In other words, they�re off-campus, they want the VPN certificate, and so they have to fill out this form.  Since we don�t tell the student what email address we sent their credentials to, some students don�t know what email address they should go to to locate their credentials.  Some students figure out on their own what email address we sent their credentials to.  This is going to be more of a problem has people get lots of mailboxes, actually.  But they may  not remember the credentials to get into mailboxes like Gmail or Hotmail.  And then there are those who forget what their security questions are in the third-party mail site, so they can�t change their credentials to enter their old mailboxes to get to our auto email.



So here�s the solution they�ve come up with:  So very soon our online university plans to implement a change in the forgotten password ID request form for students and faculty who have these issues requesting their log-on credentials.  The discussion that IT and academics have had on the subject would still allow a student or faculty member to confirm their identity outside the campus.  But the required fields we ask for would be their first and last name, date of birth, full social security number, and email address on�file.



The controversial new field on this updated form, which is why I�m writing, would be a field asking the student to enter the email address they�d like us to auto-email their credentials to if they enter all the fields correctly.  The question is, would you consider allowing the students the ability to enter any email address they choose to send their requested credentials to as a security risk?  Is that a security risk?  Would you be able to explain your thoughts on that?  Our concern is a few of us worry that, by allowing a student to send their log-in credentials to any arbitrary email address, we�re opening a security risk because, well, we�re assuming the student�s who they claim they are, but we�re not confirming if they have access to the email address on file.  Those of us who are concerned have never seen a form before that allows a user to send their log-in credentials to a different email on file without the vendor confirming the user has access to the email address the vendor has on file.  Apparently we get a lot of requests for ID/passwords from our student services department, so IT and academics are trying to devise a way to reduce these email and phone calls.



The problem is really that students often are using multiple email boxes and maybe not have access to the ones that you�re going to send the credential to, so.



STEVE:  Exactly.



LEO:  I understand the issue.



STEVE:  Well, and the really interesting point, the reason I thought this was a great question is, I mean, it�s a perfect authentication/verification/security question.  His point is, the fact that we�re allowing somebody whose identity we don�t know for sure to specify where their credential token should be mailed to, you know, that�s the gotcha because they haven�t verified that that person controls that email address.  And in fact, they haven�t verified that this is the person.  They�re assuming you provide your first name, last name, social security number, and then provide the email address you want the credential sent to, that that�s, you know, authenticating you to the system.



But they�re concerned that they�re allowing the credential to be then sent to an email address provided at the same time on that form.  And I agree, that really does create a gray zone.  And you might - and he refers to saying, well, how do we know they control that email address?  Well, that really isn�t germane either because, if some bad guy wanted to obtain these credentials and log in as somebody else, they would of course create some random Yahoo! account.  They would provide that information on the form.  The credentials, even if you had an email feedback loop where, for example, the server then sent a verification to that Yahoo! account, you know, click this link to confirm you are who you are, well, the bad guy who created the account would also have provided that account�s email address, to which the verification would get sent.  So he�d go there, click on it, and confirm the process.



So the point is, this is opening, you know, doing this opens up a clear breach in what would be otherwise the security that they had in place before, which assumed, for example, that the physical person was in the office at the university filling out this information where they wrote down the email address to which they want any lost credentials to be emailed.  You know, there, where you have physical identification and proximity, it�s certainly reasonable to ask for that information.  But as soon as you allow it to be done with no other verification, you�re in trouble because, for example, we�ve talked about all the problems with site injection, you know, various types of remote code injection.  There could be some sort of a glitch somewhere that would allow people�s social security numbers to get out.



And of course we�ve seen that.  We hear about that all the time.  So if the university lost control of that, and the student�s name and social security number were all that was necessary in order for someone remotely to provide a new email address, basically they�ve commandeered that student�s account.  So I think it really does represent a problem.



You know, the only thing I could say is that, you know, they�re softening their existing security to make up for the fact that faculty and students aren�t taking enough responsibility for their own security, like forgetting which email account they use.  It�s like, come on.  I mean, I understand people are going to forget things.  But the user has to have some responsibility.  Otherwise you�re going to compromise security.  And I really think this makes a substantial, a substantive change in the protocol that they had deliberately established.



LEO:  And I also don�t like the idea of using a social security number for an identifying strip anyway.



STEVE:  No, that is creepy.



LEO:  That�s a problem in a lot of different ways.  I mean - anyway.  So you�re saying don�t do it.



STEVE:  I�d say that I think the concern that he expresses is that something feels wrong to him.  It�s like, okay...



LEO:  He�s right, yeah.



STEVE:  ...he�s right that there�s something wrong.  It is a fundamental change in the security architecture that they had established.  And it�s a change not for the better.



LEO:  Yeah.  Paul in Edmonton, Alberta writes:  In Episode�96 you answered a question on resource depletion using VMware.  I thought I�d tell you, you can buy a multiprocessor, multi-core computer, from Polywell, for instance, with eight dual-core Opteron processors, up to 128 gigabytes of DDR2 RAM.  Works well for VMware.



STEVE:  I just love that.  You know, because remember that we were talking about the problem with virtual machines is that, because they think they�re in the equivalent of a real machine, they assume they have access to all of the RAM.  So when you create a VM, you need to give it, you know...



LEO:  A lot of RAM, yeah.



STEVE:  ...half a gig or a gig or a gig and a half, whatever.  And in doing so, you have taken it away from your host system.  I mean, it�s just gone.  And so of course the Opteron is the AMD 64-bit processor.  And here he�s talking about having 128 gigs of RAM.



So the thing I thought was interesting about this is that it�s - 32-bit address space we know is limited to 4 gig.   You�re only able to address 4 gigs with 32 bits.  So by going to 64 bits, you break out of the 4-gig barrier.  And so, yes, you could certainly be running a 64-bit multi, or even single, for that matter, Opteron system with much more than 4 gigs, and then have many more VMware systems emulating a 32-bit environment.  So basically you�re using the 64-bitness, not because you need 64-bit operations, but just because you�ve gone VM happy and you�d like to have, you know, 20 or 30 independent machines, each with their own 4 gigs running at the same time.  So that is a very cool platform.  You know, a little overkill, maybe, but certainly very cool.



LEO:  I�m pricing one out right now.  They�re really designed for servers, obviously.  They�re not designed for desktop computers.



STEVE:  Yeah, but, I mean, it�s a perfect host for multiple�VMs.



LEO:  I guess, if you�re willing to spend the money.  Chris Rydin of Troy, Michigan, has been flooded with bot spam.  He says:  I�m the tech guy for my company.  I noticed yesterday our mail servers were being bombarded with spam letters, much more than ever before.  When looking at the spam in my quarantine, I noticed they all had nearly identical headers.  "You received a postcard from," and then it adds a random prefix like "a neighbor" or "a friend."  It tells you to click on a link to catcher.hk, which installs a worm on your system.  This is spam you can get a virus from, much like the real spam.



I noticed our email servers, which support many, many companies, reported more than - oh, get this - half of the total mail it rejects, including regular spam, was from this site.  Half.  It sends mail from spoofed headers to make it look like it comes from reputable companies.  Upon talking with friends and coworkers, they say they got this on their home email, too.  However, I find very little about these attacks being reported.  The virus it said it detected was html/postcard.N@trojan.  And the few sites that actually adhere to this name report that they, too, are seeing very high traffic of this worm.  What�s going on here?  I�m not familiar with this one, actually.



STEVE:  Well, this is a classic spam-sending botnet.  Basically this is exact - you know, the way that his server is able to see such a high incidence of this and, at the same time, other people scattered around the Internet are seeing this, is that some large botnet was contracted with to send this out.  Or it is very likely, since he talks about this thing having a link to some site in .hk, so in Hong Kong, that is probably the botnet trying to spread itself.  And remember we talked about, when we talked about the whole bot roast FBI effort, that now we know that large gangs of bot herders are competing with each other, trying to take over bots from each other.  So networks are being used to promote their own bot, using their own network.  So to do that they spray massive amounts of spam, which they can do because they�ve compromised hundreds of thousands of end-user systems.  They spray this spam that�s got links.



Now, the problem is that Hong Kong site will be taken offline very quickly, so there�s a short window of opportunity during which, you know, before the site is taken down through some cooperative effort of law enforcement, the trick is how much spam can we get out to how many people who will say, oh, I got a postcard from a friend, and click the link and infect themselves with a bot.  Maybe their system is already infected, in which case this bot will try to take over from any bots you had before, to now you�ve got bots having war on your own machine.  But, you know, that�s what�s happened here in this case.



LEO:  And by the way, I�m just scanning through news stories, and this has been going on for years.  I mean, I�ve found stories about a postcard trojan from 2004, 2005.  This has been going on forever.  And, you know, it�s funny that I think nowadays you don�t see as many alerts going out because everybody�s got pretty effective spam filters and antivirus filters.  And, you know, I for one, I never see a single one of these because I�m sure they�re getting filtered out by my antispam service.



STEVE:  Well, exactly.  And that�s the point was he was looking at the server.



LEO:  He was looking at the antispam server.



STEVE:  Yes, and noticing that more than half of what the server was filtering.  So it�s exactly as you say, Leo, it�s the case that not that many of these actually make it�through.



LEO:  We hope.



STEVE:  But again, it�s a numbers game.  So the more they flood out, the more are going to get through.



LEO:  I�ll have to ask my antispam guys at MailRoute if they�re seeing a lot of them.  Mark in Wapakoneta, Ohio asks:  Are hard drives getting less reliable?  I�ve been the computer fix-it guy for my family for a number of years now.  I�ve noticed a lot of hard drive failures recently.  Most of the time when one of my family members has asked me to fix their computer, it�s been the standard spyware/virus stuff they always seem to be infected with, or at least that used to be the case.  Up till six months ago I�d never run across a dead hard drive.  But the last four computers I fixed have all needed new hard drives.  Of these, three were laptops, so maybe it�s the increase in laptops that�s leading to more drive failures.  In any case, I�d like to hear the opinion of a hard drive guru on the subject.  I�ve been listening since Episode 1 and using ShieldsUP! for years.  Well, you are that.



STEVE:  And we do know that, from the article that - or the report and study that Google did, and we did a podcast on this some months ago, that in fact hard drives are certainly less reliable - I think, if I remember right, by at least a factor of nine - than manufacturers are stating.  And it does seem that newer drives are failing more often.  I�m always worried about hard drives in laptops, in the same way that I�m worried about hard drives in iPods, that they�re inherently susceptible to physical abuse.  And I�ll see people take a laptop running - and I hang out at Starbucks, which tends to be laptop heaven because they�ve got T-Mobile service there.  And they just, you know, pick up their laptop, and they don�t drop it hard on another table, but they just...



LEO:  There�s a clunk.



STEVE:  Yes.  They don�t get it that inside is phenomenal technology which has enabled a few small spinning metal platters to store literally tens of billions of bits of data.  I mean, I can�t believe this stuff works, and here they are, just clunk.  And I just shiver whenever I see it.



LEO:  It�s not just that, it�s also a lot hotter in those hard drives.



STEVE:  Oh, in fact, heat is a real problem for laptops.  And in fact, you know, me being aware of this as I am, I set my laptop - first of all, I try never even to move it when the hard drive is spinning.  But if so, I put it down one corner at a time, first one corner, then one side, and then I slowly tilt it back down.  I mean, I�m maybe a little carried away, but I�ve never had a laptop hard drive die on me.  So I do think people really need to be very conscious of the fact that there is a delicate, spinning piece of phenomenal technology inside there.



LEO:  I haven�t had a hard drive die in a while.  But the most recent one was an iPod, just a few months ago.  Or even a month ago.  And I�ve been lucky with the other hard drives, though, so far.  You know, parenthetically, my new iPhone, which is not using a hard drive, as far as I know, I�m pretty sure it�s solid-state memory, gets very hot, when it�s charging particularly.  And of course it�s a hot day, it�s about 90 degrees right now, and it�s pretty warm.  Is there the same problem for solid-state memories with heat and getting banged around?



STEVE:  Well, electronics really doesn�t like heat at all.  But there�s no problem with it physically.  And in fact, this is why the only iPods I have ever owned are the solid-state ones.  I just...



LEO:  They�re very reliable, yeah.



STEVE:  Yeah, I was just too freaked out by the idea of having a little hard drive in something that just sort of seems like you ought to be able to not treat it with kid gloves every single second.



LEO:  Well, you�d better believe for 600 bucks I�m treating my iPhone with kid gloves, regardless of its hard drive.  Nitin Saini of Tampa, Florida - I know I�m mangling your name, but I apologize.



STEVE:  Well, but we tried valiantly.



LEO:  We tried again and again - prefers TreeSize to SpaceMonger.  Remember we were talking about ways to look at your hard drive space.  That was on 96.  He says:  I have one comment.  You mentioned SpaceMonger, which I�ve looked at in the past, wasn�t so much impressed with.  I�ve been using TreeSize, which also has a free version and can be downloaded as a standalone exe, less than a megabyte.  And he gives us the link, it�s jam-software.com.



STEVE:  And I should mention that I am also a TreeSize user, and I have a paid version of it that I like very much.  They�re very different.  SpaceMonger is so cool because it gives you a visual, graphical, nested rectangle-like map over your entire screen of the layout of your drive in terms of the size different areas occupy.  I really like that to give you a quick sense of what�s going on.  What�s cool about TreeSize is it very quickly parses your entire drive and will give you a list sorted from largest to smallest of the largest hundred files on your drive.  And it has lots of other features, too.  It�s got cool little bar graphs, and it�ll do graphics of the distribution of file size by type and a bunch of other stuff that I really don�t care that much about.  But it is just nice to be able to instantly get a sorted list by size of the biggest files on your system because invariably you�ll find stuff there, it�s like, oh, I don�t need that anymore, and look how much space it�s taking�up.



LEO:  Oh, yeah.



STEVE:  So I like them both.  But they�re very different, and they serve a different purpose.



LEO:  On the Mac I use a similar program called Disk Inventory X.  It�s free.  It gives you a color graphical map as well as a list of files.  Disk Inventory X.



Geoff in Ottawa worries about unchangeable biometrics:  I have a question regarding the use of biometric data as a form of authentication.  I recently had a discussion with someone who�s much smarter than I in questions surrounding technology.  He was presenting the argument that retinal scans or some other personally unique biometric factor is the way of the future.  None of us will carry credit cards or similar tokens in ten years.



My response?  Well, there are two kinds of data in this world, data that�s been lost or stolen and data that will be lost or stolen.  Ooh, this guy�s a pessimist.  The retinal scan, for instance, is just a series of zeros and ones that are structured to represent the unique pattern of blood vessels in my eye.  If a bad guy were to gain access to that digital representation of my eye, would he not have my password forever?  That�s the point here.  Isn�t it better to use tokens that can be reissued if compromised?  For instance, the credit card numbers we now carry?  He felt this could never happen, what with the strong encryption algorithms and such we have today.  Never is a long time.  Am I missing something here, or do I lack some specific knowledge that will make it all work beautifully?



STEVE:  Well, it�s a great question, and it comes up often when we�re talking about biometrics.  And the point of course is that, if we lose control of our credit card or if we lose control of our password, we�re able to change our password.  And of course best password practice says change it every so often even if you don�t think you�ve lost control of it, just because it�s a good thing to do.  Maybe you have and don�t know it.  But you can�t change your fingerprint.  You can�t change your iris or your retina or your DNA.  You know, ultimately we can presume that�ll be what we�re locked onto.



So people are concerned that, wait a minute, I don�t want my retina scanned and essentially then moved out of my control because what if some bad guy did something wrong with it?  You know, it�s then don�t they have me, my essence essentially, forever.  And I guess actually if they had your DNA they could just clone you, and they could get your fingerprint that way.  Here�s an eyeball.  So it�s an interesting point.  The one mitigating factor here is that these technologies will generally not save the retina scan of your retina in the same way that they don�t scan and save your actual fingerprint.  What�s done is what�s called "feature extraction," and that�s the key.  That�s what makes this not such a bad thing is that - oh, and the case would be the same for DNA likely.



But in the case, for example, of a fingerprint - and in future podcasts we�re going to talk in more detail about how this stuff works, but the idea is that the image of your fingerprint isn�t saved.  I mean, it�s not really the way you see it on CSI where they�re flashing all these fingerprints by because that�s a phenomenal amount of data.  What�s done is the fingerprint image is analyzed for features.  There are places where you have dead ends in your fingerprint, places where two ridges merge, places where a ridge stops.  Anyway, the idea is that an analysis is done, and the actual image is reduced to a series of much smaller and simpler characteristics.  And then what is done is this is hashed into a 128, 168-bit hash.  And so that�s what is stored.  That�s why it�s safe is that the hash - as we know, a hash is a lossy, one-way function.  And so from the hash number there is no way to go back.  So you couldn�t even go back to the features that were used in order to synthesize a representative fingerprint that would hash back down to the same value.  There�s no way to go back.



So all these various biometrics, given that they�re implemented correctly - and of course, with anything dealing with security you�ve got was this done right, was this done wrong, were passwords stored or were their hashes stored, for example, on the server, as we�ve talked about recently.  In this case you�re using the same thing.  You�re taking the biometric data, and you are doing a feature extraction.  Then you�re hashing those features into a token which is a unique representation of the person without being directly connectable to the physical representation of the person.  So that�s why it�s a good thing.



LEO:  It�s turtles all the way down.



STEVE:  There you go.



LEO:  I guess, I mean, I guess the features would be immutable, though; right?  So if they got your eye, they got your features.



STEVE:  Yes.  Okay, right.  If there was a place somewhere�between the scanner of your retina and the hash coming out...



LEO:  The database.



STEVE:  Well, no.  The hash is the database.  The database would just be a hash.  But if there was a...



LEO:  Oh, I see.  And the hash is not reversible.  So what you�re really saying is the system�s secure.



STEVE:  Yes.  But it�s certainly the case, if someone got the actual image of your retina, on the other hand, then the question would be how would they...



LEO:  It would have to be pretty severely compromised.



STEVE:  ...synthesize a retina that would fake a scanner.  I guess what they�re saying is, okay, if you had the database of hashes of retinas, then you�d have...



LEO:  You could reverse it.



STEVE:  ...everybody�s hash.  And the point is that the technology would - every time the technology�s applied, the same retina would generate the same set of extracted features that would generate the same hash.  Although that�s not necessarily the case either because different features could be brought out.  So you�d have to have...



LEO:  Right.  Some hashes, you know, one machine might work differently than the other.



STEVE:  Exactly.  And so you would have a different mapping of physical features into hashes, depending upon technology.  So that means that, even though you�ve got one single finger, the different scanners would extract different features in a different way or choose different features to hash.  And so there again you have a one-to-many mapping.  So that it�s not just like once something is compromised, it�s compromised forever.



LEO:  Makes sense.  Robert James - huh?



STEVE:  So again, it�s a good thing.



LEO:  It�s a good thing.  Robert James in San Francisco wonders about ID Vault:  I�ve been wondering about the ID Vault I keep hearing advertised by Kevin Mitnick and Leo.  I did one ad once on KGO in San Francisco.  But now I�m - this is the problem with doing any ads on the radio at all.  Is this basically like Roboform or Keepass, or is it something even more secure?  Would you be able to address it on your Security Now!?  The link is guardid.com/idvault.



STEVE:  And here, Leo, I figured you were an expert, so this was a question for you.



LEO:  Well, you know what, actually you�ll be interested in this.  And really their whole premise is exactly what you were talking about.  In fact, if you go to their website, they�ll say, "Security experts have long known that two-factor authentication, which requires both something you know and something you have to access your online accounts, is much more secure."  They obviously listen to the show.  What it is, is it�s a smart card in a USB dongle.  So it�s coded to you.  It is not a thumbprint recognizer or anything like that.  But it is a second form, it�s an additional form of authentication, equivalent to an ATM card.



STEVE:  Okay.



LEO:  So that makes sense; right?  And then they add software on top of it so that it does things like remember passwords and so forth.  And that password database is stored on the computer - I believe it�s stored on the computer.  I don�t believe it�s stored on the ID Vault.  But it�s encrypted by the key in the ID Vault.  So you�ll see these on USB keys sold by other companies, as well, where there�s some storage on the USB key, and that�s encrypted by hardware in the storage.  Same idea.  In this case it�s just a key on a card, and it�s a second form of authentication.  So you add it to your password, which you know; right?  Something you have and something you know, and you�re that much safer.



STEVE:  So it�s two-factor authentication where you�ve got a portable key ring hardware token.



LEO:  Exactly.



STEVE:  Neat.



LEO:  Yeah.  And it encrypts all of your identity information, passwords and so forth, on the hard drive of the - again, this I�m not sure about, but I believe it does that on the hard drive of the computer.



STEVE:  Okay.



LEO:  Well, wait a minute.  No, I�m sorry, it does have storage on it.  So you take it on the USB key.  So it keeps a database - it�s like Roboform AI, but it keeps the database on the USB key with that secure chip, and it�s secured there.  So you plug it in, you choose your account, you enter your PIN, and then you�re signed on, and you�ve got your passwords with you.  Does that make sense?



STEVE:  You know, Leo, as we�ve been talking about this, and as I talk about these questions, I just - I cannot wait for the day where we have OpenID-style sign-on of some form.  It is just going to be so nice.  I think, in fact...



LEO:  This could do that, of course, because this would be your OpenID key, basically.



STEVE:  Yes.  Exactly.  You could have it set up so that your OpenID authentication server looked for that information on the USB dongle and got your physical presence verification there.  But, I mean, just to have - I don�t even care if it�s literally OpenID, where I�ve got my own token.  Just to use the same token to log in anywhere, oh, that would be so nice.



LEO:  Wouldn�t that be nice?  I guess really the main thing about ID Vault is that they have a million-dollar guarantee.  If someone steals your financial credentials and uses them to access your financial accounts, they will reimburse you up to a million dollars.  So if nothing else...



STEVE:  I�d like to see someone try to collect on that.



LEO:  Claim that?  Yeah, that�s true.  I don�t know if they have any examples. 



STEVE:  And the problem is that there are so many ways that that process could go wrong that you�d have a hard time proving to them that it was theirs...



LEO:  It was their fault, yeah.  Yeah, that�s a good point, yeah.  Moving on to Laura in Arbor Vitae, Wisconsin.  I�m sure I�m pronouncing that wrong, but that�s how you would pronounce it if it were Latin.



STEVE:  If it was career vitae; right?



LEO:  Yeah, curriculum vitae, yeah.  Arbor Vitae in Wisconsin has a VPN question.  She writes:  Here�s your background for my question.  When I connect a VPN to my employer it disables my ability to print to my local network printer, which is a 192.168, because I�ve been assigned an IP in my company�s scheme, 172.16.  I understand why this is happening, but here�s the question:  If I use Hamachi or OpenVPN at home when I travel, will I have access to my other devices - TiVo, printer, other computers - on my home network, or just the one I�m VPNing into?  Oh, she�s got a little idea here.



STEVE:  Well, it�s a great question, and it brings up two things.  First of all, Hamachi of course, as we remember from our classic "Hamachi Rocks" episode, Hamachi runs on the interesting five-dot network, which is not formally available, but it�s an unassigned IP space on the Internet.  So Hamachi gives every single machine that�s running Hamachi its own 5.x.y.z IP address.  But for exactly that reason she is restricted to only accessing that machine through the Hamachi network because, when she�s accessing that machine, the machine is, for all intents and purposes, on the five-dot network.  And therefore she�s unable to access devices in her home 192.168 network.  Although, if the printer were connected physically to that machine, then she would be able to access that machine that way.



Also the other nice thing about Hamachi is that it is a bridge for MAC addresses, I mean, yeah, for MAC addresses.  That is to say it is a MAC layer, Ethernet layer link, not an IP layer link.  What that means practically is that network broadcasts, that is to say, ARP broadcasts of MAC addresses are able to flow across Hamachi.  So things like Windows filesharing and printer sharing are able to work across Hamachi.



Now, OpenVPN is a different animal.  And in fact, you know, I promised a year ago, a year and a half ago I think it was, that I would have the OpenVPN how-to assembled.  I�ve gotten stalled on that because OpenVPN feels to me like the wrong solution.  I�m trying to find something that works much more easily and does the same thing.  But OpenVPN can work with what�s called a "tap driver," or a "tunnel driver," tap or tun.  In the tap case you�re able to get the same sort of functionality that Hamachi provides, where a machine connecting to OpenVPN appears on your network like another machine on your network, and then you can see all the network resources that are available.  I�m sorry, it�s more like what her VPN would see, not what Hamachi does.  In the tunneling driver you don�t have that kind of capability.



Anyway, so unfortunately there isn�t a super simple, clean and clear answer.  I�m trying to find a solution that will provide users with exactly the capabilities that she wants.  You can get it with OpenVPN if you set it up for a tap driver.  But it requires bridging the OpenVPN adapter to the system adapter.  You need third-party software to do that under Windows 2000.  You can do it under XP.  Presumably you can also do it under Vista, although I haven�t verified, but I�m sure you can.  But it�s really complex, much more than I would like it to be.  And OpenVPN is, too.  So I�m looking right now for a better solution for that.



LEO:  So I imagine that IT guys often do that, though, in the office because they want you to be able to use the network printers and so forth once you�ve VPN�d in.  Yes?



STEVE:  Yes, exactly.  You VPN into your corporate network.  Now your remote machine is exactly like it�s on the corporate network.  And you�ve got access to the internal IM and chat and printers and all the resources, so just like the machine were on that network.



LEO:  But that doesn�t happen when you log in via VPN to your system.



STEVE:  Well, it can, if you set up OpenVPN correctly.  And it�s not the default way.  You�ve got to fight everything in order to make it work.  So it�s like, okay, rather than trying to explain this, maybe I�ve just got to find a better solution.  So I�m looking.



LEO:  Seems like there ought to be, yeah.  Jim in San Diego writes:  A lot of IE vulnerabilities have been related to ActiveX.  Do Firefox add-ons present the same potential danger as ActiveX, or are they inherently more secure?



STEVE:  Well, that�s a great question.  Okay.  Backing up a little bit, remember that ActiveX is Microsoft�s OS integration technology.  It�s really just a DLL implementing their original protocol for essentially creating components.  So it�s a componentized DLL.  The thing that�s most frightening about ActiveX is that, until very recently, Windows and IE would download these in their default configuration on the Internet and instantiate them, that is to say, download and run them in the default configuration without the user�s knowledge.  Finally with IE7 you�re given a bar at the top of your screen when a site tries to run an ActiveX control on your machine.  And I see that all the time.  So it demonstrates how much of that was going on.



LEO:  I think it used to ask you for - didn�t it ask you for a certificate or something, or show you a certificate and ask for your approval in the past?  I think it was supposed�to.



STEVE:  Whatever it was...



LEO:  It wasn�t effective.



STEVE:  ...it was happening in such, yeah, things like CoolWebSearch, which was a notoriously horrible ActiveX control, was finding a way onto users� browsers all the�time.



LEO:  I think the design was that the user still had to approve it.  But it wasn�t as clear about what you were�doing.



STEVE:  Well, and there were things...



LEO:  And there were holes.



STEVE:  There were things like, do you want to download and run ActiveX controls?  And so, okay, if it�s not signed, don�t.  But, you know, bad guys would sign theirs.



LEO:  Right, exactly.



STEVE:  And then it would be signed.  So it was like, thanks a lot, that provides me no help.  Anyway, getting back to Jim�s point, having completely beaten up on ActiveX now, a Firefox plug-in has potentially the same problems because it is software that you are running, and it�s in a very dangerous place.  The browser is a dangerous place to have add-on components.  Even the browser itself has enough trouble staying secure.  Now you�re talking about adding third-party components to a high-traffic, Internet-exposed, dangerous place that�s running on your computer.  It scares me a lot.  So I think, yes, although we see more problems with Active X because of Windows and IE still being the majority platform, there�s as much a danger theoretically over on the Firefox side.



LEO:  I�m going to give you the alternate point of view, though.  Because remember, Steve believes that JavaScript is dangerous.  So, I mean, all of these controls on Firefox are running in XUL.  So essentially they have the same permissions JavaScript does.  They�re not ActiveX.  They�re not DLLs.  They�re running in a scripting language.



STEVE:  Oh, okay.  In that case that is potentially better, although again...



LEO:  Same risk.  Same risk as JavaScript.



STEVE:  And scripts have buffer overflows all the time, too.



LEO:  But it�s my understanding, and I may be wrong, but it�s my understanding from talking to Firefox developers that these extensions are running as XUL.  It may be possible for you to attach an application to it.  That�s an interesting question.  But it�s my understanding that it�s really running in a markup language, basically.



STEVE:  Okay.  Well, what I would recommend - and, you know, certainly anytime you�ve got things going on with your browser, protecting your system from that is a good thing.  One of the plans I have in the future is to get the author of Sandboxie on to spend an hour with us talking about Sandboxie.  I�ve contacted him; he�s interested in doing so.  It�s just a very well-behaved, very nice sandboxing tool that is not in your way.  It�s much lighter weight than having to deal with a virtual machine and running your browser in a VM.  There�s a lot of overhead associated with doing that, as is the case with any VM where you�re running a whole �nother instance of an OS in the VM.  I want to talk about sandboxing because I think it is potentially the not-received-enough-press-yet solution for all of this.



LEO:  Right, right.  I agree.  Moving along to Ipigi of Montreal, Canada - Ipigi, that�s probably it, Ipigi:  I�ve been working at an ISP for the past five years, three of these as a customer service representative and now as a technician.  I also have my own small business on the side where I troubleshoot computers, be it just basic support, all the way up to virus and spyware removal, data recovery, network layout, and security.  My comment is about Episode 97, the bot roast.  You mentioned that more responsibility should be assigned to the ISP - I said that, I�m not going to put that on Steve - in helping to track down users with an infected computer or even actively intercept and log traffic to make sure none of their users are infected with network-aware malware.



There are two problems I see with this.  If the ISP is small, it probably does not have the infrastructure required to intercept such traffic and scan it efficiently.  Not only that, but I�d be surprised if they even had the financial resources available for such hardware and manpower to be made available to them.  In the case of a large ISP that it would be nearly impossible to log and inspect all traffic from their users.  The mere size of the traffic logs would quickly be unmanageable.  As an example, our company logs every connection and disconnection from our service.  It logs the name of the client, the IP address assigned to that client, the phone number of that client, date and time, as well as the IP address of the hardware where the client is currently connected to internally.  This information alone in a text file generates around 20 megabytes of log files a day.  Just imagine if all traffic had to be logged for every single user.  Imagine if a large DSL or cable provider had to do the same.



In my opinion the FBI and ISPs should instead make an agreement.  The FBI should provide the IP addresses and times where malicious traffic was detected.  The ISP could then inform its clients in any way they deem necessary that their computers have been compromised, ask them to have their computers checked for malware.  If a client did not comply and further infractions reported, then the service of that client should be suspended.



Finally, it�s also my opinion that computer owners should be responsible for their own computers� health.  Good luck.  To make a comparison, you would not blame a mechanic if the owner of the car did not take good care of it and bring it in once in a while for a checkup.  In my experience, most people believe they have virus and spyware protection when in reality they are running an old version of Norton Antivirus that expired three years ago and is severely out of date.  I agree with you on that.  I�ve been confronted many times by clients who said they had proper virus protection, lulled into a false sense of confidence by the free antivirus trial that came bundled with their system.



STEVE:  Well.  When I�m talking about ISPs taking responsibility, I�m not sort of referring to them doing it in what I guess I would call an "old school" fashion.



LEO:  I don�t think they should be logging all traffic.  I don�t think anybody�s proposing that.



STEVE:  Exactly.  What I meant, and I guess I wasn�t clear enough about it because I�m sure that he would have heard me if I�d said it...



LEO:  Well, we made an off - I think it was probably me.  I made an offhand comment that really all of this could be eliminated if ISPs would pay attention.



STEVE:  Well, okay.  What I think we need, we need another class of hardware at the border.  We need something like a router, but basically an anti-traffic flood router.  I mean a router which itself is watching all of the traffic that is crossing its boundary and keeping some track of it.  And there is technology like that.  It�s certainly available.  I didn�t mean to say that, for example, logs should be generated and then parsed and action should be taken because, frankly, by the time that�s happened, the damage has been done, and it�s over.  What you want is you want technology very much like sort of bandwidth-limiting technology where users are able to send a certain amount of data per interval, and beyond that they can�t.  I mean, essentially, you know, most users have not only higher bandwidth downstream, but most of their use is downloading stuff.  Much less is going in the other direction.  Certainly filesharing is an instance where you have more symmetrical flow, or email.  But in the case of email, and certainly in web surfing, your upstream bandwidth can be much smaller because you�ve got much less data transiting in the other direction.



So I guess what I�m talking about is - I mean, and we�re years away from this.  But it�s entirely possible to have equipment that the ISP runs which is next-generation router equipment that is itself responsible for detecting when one of their customers, or more at the same time, of course, is sending out a massive amount of anything, whether it�s ICMP pings to DoS somebody, or spam, you know, out to remote port 25 in order to spam somebody, and just say, whoops, this is a violation of our terms of service, and disconnect it.  As somebody has said, I think, that we were responding to in the posts, you know, route that person to a web page so that anywhere that customer goes, they go to an ISP web page that says, we believe your computer is infected with something malicious.  Please contact our support people.



LEO:  There are all sorts of issues with this.  I mean, as soon as Comcast started blocking port 25 we heard a lot about it.  People get upset about it.  So it�s tricky.  I understand it�s not easy for ISPs.  But I think there are things they can do.



STEVE:  Yeah.  And the idea that the FBI would work with the ISP, there again, there�s too much delay.  There�s the need for too much interaction and too much time passage.  But more importantly, then the FBI would only be dealing with the machines that were attacking end-users that the FBI was involved in pursuing, rather than a solution that basically  nips it in the bud, that prevents this stuff from having a damaging outbound effect from the ISP on, which really is the right place to do this.  We just need some hardware that can automate the process.



LEO:  Yeah, yeah.  And I�m sure that that hardware even exists.  I just think that ISPs do bear some responsibility in all of this.  How much and how they implement it, of course, is up in the air.



STEVE:  And also, to address his last point, I agree with you, Leo.  I mean, yes, it would be nice...



LEO:  It would be great.



STEVE:  ...if users were taking more responsibility.  I mean, I have to imagine that anyone hearing our voices over Security Now!...



LEO:  They know what they�re doing.



STEVE:  They�re not bot infested themselves.  They may be seeing other people who are and dealing with their friends� malware infestations.  But again, it�s not the responsible people, it�s the irresponsible people that get this stuff hosted on their machines.



LEO:  And Steve and I both make it kind of our goals in life to help people, to teach people, to explain all this stuff so that they can do it.  Certainly that�s why I go on the radio six hours a week.  I spend a lot of time - and why you come on the radio show.  I mean, last week on the radio you talked about making good passwords.  I mean, we try to teach people this.  But I am not at all confident that the majority of users will ever get good at this.  And that�s why, unfortunately, the burden rests on people upstream - the ISPs, Microsoft, and on and on and on.  Or maybe you should just take computers away from people and just, you know, they should have to take a test before they get one.



STEVE:  Yeah, then how will they listen to our Security Now!.  Oh, I guess we wouldn�t need Security Now! then, would we.



LEO:  We wouldn�t need it.  That�s exactly right.  We didn�t need it...



STEVE:  Let�s go back to the Stone Age.



LEO:  Chris Grant in Riverside, California wonders about phone radio network security:  Is there good, reliable security implemented on GPRS/EDGE networks that AT&T uses?  I�m suspicious that devices like my 2125 WM5 Smartphone - that�s a Windows Mobile.  That actually is a really nice one, the Cingular - or for that matter the new iPhone, most likely transmit passwords for email via clear text.  What is the security of this EDGE network we are using?



STEVE:  Many, many people have asked questions about wireless telephony security.  And it�s something I�ve been poking around in, trying to get some good answers to.  So I can answer the question, is this stuff going into clear?  The answer is no.  All of these connections, these digital telephone connections are absolutely, definitely encrypted.  I just haven�t been able to find any good information that talks about how.  It�s an outstanding issue for me to research.  When I finally track it down, we will certainly do a podcast about it because it interests me greatly, too.  I would like to know every little dirty, nitty-gritty detail about the encryption used on our cellular systems.



LEO:  But we don�t right now.



STEVE:  But we do know that it is encrypted, and his stuff is not in the clear.  Of that I�m sure.  We just don�t know if it�s absolutely unbustable for anybody listening in.  I have a feeling a good job has been done on it because it�s recent enough that there would be no excuse for it not to have been done correctly.



LEO:  Yeah.  Ryan Jones of Melbourne, Australia wonders about fingerprint capture:  You guys have been talking a lot about bio security lately, and I have a question for you today that came from a customer of mine when I was at work.  What is in place to stop someone from accessing your fingerprint that is stored on a laptop that has a fingerprint scanner on it, especially when a lot of machines have been compromised with trojans and so on?  I imagine it could be detrimental if someone got your fingerprint, especially with it being used as a common method of security.  Well, this is kind of the same question, isn�t�it.



STEVE:  Well, it�s a little bit related.  He�s asking about, if it�s stored in the laptop, what prevents it.  And I love this because it exactly speaks to last week�s topic of the Trusted Platform Module, the TPM, the idea being that that sensitive stuff is unavailable to any sort of external theft.  It cannot be stolen because our favorite functions, our one-way hashing functions are used to say, here�s a fingerprint I�m submitting for comparison to the one that you have stored.  Is it the same?  And by taking the one that�s stored, hashing it through a one-way function into a hash, and the one you�ve just swiped on the sensor, and similarly hashing it down, you then compare them and say, oh, look, same guy, here�s the password associated with it, which then it provides to the BIOS to unlock the BIOS and the hard drive.  And at no point could any of that be stolen.  It�s very cool stuff.



LEO:  You�re safe.



STEVE:  Indeed.



LEO:  You�re protected.  And we want to thank you all for writing.  We appreciate it.



Well, we�ve completed a hundred episodes, Steve Gibson.  Amazing, amazing stuff.



STEVE:  Yeah, I�m really glad, Leo.



LEO:  And then he passes out dead.



STEVE:  We�re on for 101 next week.



LEO:  101, and what are we going to cover next week?



STEVE:  I think we�re going to get to CAPTCHA.  I think that�s a really interesting question, proving that you�re human.  And boy, that audio that you played last week, you know, I�m not even sure I�m human if I have to listen to that and figure out what that was.  Wow.



LEO:  Should be a lot of fun.  We thank you all so much for listening.  We thank you for your donations, which starting from day one have kept this podcast afloat.  We also thank the great folks at AOL Radio who have been giving us bandwidth since day one.  I should add it up someday, but it is hundreds of thousands of dollars, literally, in bandwidth absolutely donated from them.  So we really than AOL for 100�episodes.



STEVE:  And you know, given that we�re on our 100th episode, thank you.  I want to thank, I mean, I really want to deliberately and explicitly thank our listeners for supporting me and my efforts at GRC with the purchase of SpinRite.  I hear from people all the time who say, hey, I bought a copy of SpinRite because I want to support what you�re doing.  And, you know, then my hard drive died, and boy did I need it.  So again, I don�t want anyone to spend $89 just for no reason or for support.  But it can come in handy.  But I just really wanted to say thank you to our listeners on the occasion of this 100th episode.  I absolutely acknowledge and I feel the support because it�s had a clear effect on SpinRite sales.  And so...



LEO:  We love doing it.  We love doing it, and that�s really the bottom line.



STEVE:  Yeah.



LEO:  Thank you, Steve.  We�ll talk again next week.







Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.








GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#101

DATE:		July 19, 2007

TITLE:		Are You Human?

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-101.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm



DESCRIPTION:  Steve and Leo explore the Internet�s rapidly growing need to automatically differentiate human from non-human automated clients.� They discuss the advantages and limitations of many past and current approaches to this problem while paying close attention to the most commonly used visual "CAPTCHA" solutions.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 101 for July 19, 2007:  Are You Human?



Time to talk about security, everybody�s favorite subject.  Well, maybe not everybody.



STEVE GIBSON:  Well, certainly, what, about 140-some�thousand?



LEO:  150,000, something like that, yeah.  All the people who listen to this podcast, anyway.  We�re so glad you�re here.  Steve Gibson is here from GRC.com, the able man behind SpinRite, the disk recovery and maintenance utility that we talk about all the time and all those free programs like SecurAble.  You know, somebody told me - we�re going to talk in just a little bit about "Are You Human?," which will be fun.  But somebody told me that one antivirus...



STEVE:  Oh, it�s AVG, Leo.  And it is driving us out of our�mind.



LEO:  It�s a false positive; right?



STEVE:  Of course.  And it happens with my security stuff from time to time that AV software will get tripped over my programs because very often the same sort of code sequences that I�m using to check something about security or to turn something off or on, that�ll naturally be the same sort of references that malware would have for doing the same sort of thing, but for its own malicious purposes.  So it�s incredibly annoying.  Greg, my support guy, has been getting flooded with literally hundreds of reports, hey, you�ve got a virus in SecurAble; or, you know, AVG pops - it�s like,�no.



LEO:  I�ve only gotten one, and of course that�s what I said.  These are false positives.  It�s not just Steve�s software, it happens in other programs, too.  And antivirus companies do their best to avoid them, but there�s inevitably some overlap, and that�s what happens.



STEVE:  So for what it�s worth, if we have any listeners who have and use AVG and get a false positive for SecurAble, I would love it if you could put some pressure on AVG to fix their program, their virus patterns, to remove SecurAble from their list through whatever means they have for doing that because...



LEO:  I think we probably have a very high percentage of AVG users listening to the show.  I don�t know if that�s because they�re cheapskates or what.



STEVE:  Well, smart.



LEO:  Smart.  They don�t want to spend money on an antivirus, and AVG�s good enough.  They know what to do to keep themselves clean anyway, so that�s all they need.



STEVE:  Exactly.



LEO:  That makes sense.  So, good, I�m glad we got that out of the way.  And let�s get a couple of more letters from the  mailbag.  Do you have any addenda, too, we should talk about�before...



STEVE:  I do.  I wanted to announce, since we�re going to be now doing - we�re getting a little more complex with our mathematical formulas, Leo.  We�re going to have the mod 4 plus 2 episodes are going to be mailbag episodes.



LEO:  That�s next episode, then.



STEVE:  Exactly.  That�ll be 102 will be the first mailbag episode.  I wanted to give people an alternative way, an easier way for sending stuff to me.  At the moment all I�ve ever talked about is having the web form down at the bottom of the Security Now! page.  Actually, however, that web form has always simply done an email to [ADDRESS DELETED DUE TO SPAMBOT DISCOVERY], with no exclamation point.  So anyone who wants to just send feedback about Security Now! issues, you can write to [ADDRESS DELETED DUE TO SPAMBOT DISCOVERY], and it�ll come right to me.  I did the web form initially because I really wanted to stress that people were welcome to be completely anonymous.  And of course a web form rather than someone�s email client is an easier way to anonymize yourself, which I wanted to promote.  But for people who don�t care, and we of course have lots of people who are happy to acknowledge their listenership, you can certainly just use your email client and write to [ADDRESS DELETED DUE TO SPAMBOT DISCOVERY].



LEO:  [ADDRESS DELETED DUE TO SPAMBOT DISCOVERY], all right.  That�ll qualify you for the mailbag, but no guarantees.



STEVE:  Exactly.  Okay.  Something else very cool happened in the last week.  Well, it started with something not so cool.  About two weeks ago I was at Starbucks using my T-Mobile account and my laptop to piddle around the �Net, doing whatever I was doing.  And I think I did something with PayPal that upset it.  And because later that day or the next day or something, I tried to do something from home, and it said, oh, we�ve flagged your account for alert status.  We think somebody was trying to hack into your account.  So you have to jump through these nine hoops in order to - and it was about nine.  I mean, it was like, oh, what is all this?  I mean, I had to go through all kinds of rigmarole to pacify it.  And of course I got freaked out that maybe somebody really was trying to hack my account.  But I looked at the date, and I said, wait a minute, I think yesterday at Starbucks I did this.  I was the one that was "hacking" my own account, just who knows why, what I did to set it off.



But the point is, I discovered that PayPal has full multifactor authentication.  I now have exactly one of these cool six-digit numeric token pieces of hardware from SecurID, get this, for $5.



LEO:  I should do that right now.



STEVE:  Everybody should do that.  I wanted to let everybody know who uses PayPal that you can get a secure key from PayPal.  You just log into your account.  Over on the left you�ll see Secure Key.  It�s only $5.



LEO:  We use PayPal for donations.  And I get every week or so somebody says, I can�t do it, I�m not going to do it, I don�t trust PayPal, I�ve had bad experiences, and so forth and so on.  But I have to say, PayPal, especially since eBay bought them, has completely turned around and refocused.  And I think people should give them a little second chance.  Things like this, I mean, very impressive.



STEVE:  Well, it�s very cool.  Now, I have heard, as I�m sure you have too, Leo, of horror stories with PayPal.  They have sort of the flavor of, well, everything�s great until it goes bad.  And when they go bad, it goes really bad.  So who knows.  But for people who use PayPal who are listeners of Security Now!, who care about the security of their use of computers, I wanted to say, hey, for $5 - well, I mean, first of all, you don�t even have to authorize the key.  You can buy it for $5 and just have this very cool dongle which, I mean, it�s neat.  It�s got a button.



LEO:  Now, I�m looking at my PayPal account.  I�m wondering if that�s because you had this problem because - this is on the front page of PayPal?  I don�t see it.



STEVE:  No, you have to log into your account.  And then over on the left-hand column it says "Secure Key."



LEO:  I don�t have that.



STEVE:  I think that�s what it says.



LEO:  I don�t have that.  So I wonder if that�s because at some point you...



STEVE:  I don�t think so.  I got the sense that it was...



LEO:  Well, let me do a search.  I�m on the new PayPal.  Maybe if I go back to the original PayPal site it�ll be - you know, we use PayPal quite heavily.  We have a lot of money going through our PayPal account.  And I�d really very much like to secure it in any way we can.



STEVE:  I got the strong sense that anybody who wants to do this, can.  And as I was saying, you don�t have to follow through and attach it to your account.  You could just have it as this very cool SecurID dongle for $5.  And so you press the button, it gives you a six-digit number.  And exactly as we were talking about, every 30 seconds it will lock that number on the display.  But if you press the button to turn it off and then press it again to turn it back on, and if you cross another one of these 30-second boundaries, you get a completely different six digits.  Then once you add this to your account, you know, they mail it to you, it takes about 10 days, a week to 10 days.  You then, basically you do it, you use it to authenticate yourself, to prove that you have logged on and you received the key.  And then the way it works from then on is you simply append those six digits to your password.  So it creates an always varying, never the same one twice, and a multifactor authentication because you have to actually have this in your possession.  And once you�ve done that, then if you lose it or don�t have it with you or whatever, then you�ve got to jump through even more hoops to prove to them that you are who you are because they want to make sure that, again, that your account is hardened against anyone taking advantage of that.



LEO:  Well, that�s cool.  I�m glad to see that they...



STEVE:  But you still can�t find it?



LEO:  No.  I�ll find it.



STEVE:  Shoot.  I think it�s there somewhere.



LEO:  I believe you.  I�ll find it.  It�ll be here�somewhere.



STEVE:  Okay.  Also we have to talk about a book you turned me onto.



LEO:  Uh-oh.  You know, because Audible is sponsoring - by the way, Audible is not sponsoring Security Now! for one reason only, because I said they couldn�t, because we already have two commercials on Security Now!, and I never want to have more than two on any podcast.  They very much wanted to be on Security Now! because they know we talk about books all the time.  But that�s one of the - I think one of the most fun things about this Audible thing is that we�ve been talking about books on all of the podcasts.  And I know which one you�re going to talk about, and that�s - it was one of our early picks.  And it�s just great.  So you liked it.



STEVE:  Oh, well, I�m not through with it yet, Leo.  But I am really having fun with this book.  First of all, I had a couple of experiences.  Okay, the book is titled "On Intelligence."  "On Intelligence" is the title, by Jeff Hawkins, who - as a Palm follower, as I am, I knew the name immediately.  And I can�t wait to get his new Palm gizmo, the Foleo, because I think for me that�ll be a really nice add-on to my Treo.  But I�ve been a Palm user forever.  Jeff is the inventor of Graffiti, the designer of the whole family of Palm things.  He then created Handspring, where of course the Treo was born.  And then that all merged...



LEO:  And you love your Treo, too.



STEVE:  Love my Treo.  Okay.  So it turns out that Jeff Hawkins has a strong - has always had for his whole life a strong interest in brain function, how the brain works.  Well, nobody knows it, but I have always had that, too.  I  mean, back in high school I read everything I could about neurons and synapses and axons and all that.  And so what gives me goose bumps is that here he is, basically an engineer, a computer guy, who�s been successful in Silicon Valley, who has now founded a company, I think it�s Numenta, to work on creating intelligent machines.  And so this book - and the reason I�m talking about it is I can, even though I�m not finished with it, I�m about I think maybe somewhere between a third and a half way through, what I�ve read already allows me to commend it to our listeners.  It is just riveting.  So if anyone is interested in sort of having a contemporary, easy to read, really engaging look at what we currently know about intelligence and how our brain functions at the cellular level, and from Jeff�s standpoint, you know, why it is that AI has failed, how things function�- as I was saying to you, Leo, before we began recording, I also don�t want to talk about it too much because I don�t want to be a spoiler for what the book has in it.  But I just - I really, really like the book.



So it�s funny, too, because I have it in both Sony eReader and in Palm eBook.  And I have a physical copy that I got because I have a friend actually who�s my second employee at GRC who�s a gifted hardware engineer and software guy who ended up leaving because I just didn�t have enough to keep him busy.  And I�m glad because I kicked him out of the nest.  And I was the first job he ever had.  And he and I had actually worked together years before on the light pen stuff.  He did some light pen work for me.  And anyway, I�m going to have lunch with him and give him this book and probably seriously damage his life.



LEO:  Why is that?



STEVE:  Because he�s going to read this, and he�s going to have a hard time remembering what it was he was doing before he started reading this book.  I mean, I know him...



LEO:  Is he in this field?



STEVE:  Yeah, yeah, yeah.  Actually he went into gaming, where he�s won awards and started companies and sold them and done a lot.  His name is Steve Ranck.  He�s just one of the brightest, sharpest, neatest engineers I�ve ever known.  And Steve will, I mean, it�s going to be hard for him not to have to go build an intelligence brain after...



LEO:  Good, good.



STEVE:  Oh, I know, I know.  And in fact that�s sort of what Jeff is promoting and soliciting.



LEO:  Yeah, you get to the end of the book, one of the things he says at the epilogue is, if you are a high school student reading this, please make this your field.  This is where we want to go.  We need this.



STEVE:  Yeah.  The book is just so full of stuff.  One of�the cool things is, I mean, we all have a brain, pretty�much.



LEO:  Some of us.  Some don�t.



STEVE:  And there�s enough new stuff in here that as I�m reading it I�m thinking, oh, yeah, I never really thought about it that way, but that�s exactly right.  And again, it�s just "On Intelligence" is the book.  You can get it, as we know from you, Leo, in Audible format if you want to listen to it.  You can get it in Sony Reader format, if you want to play with the E Ink reader that you and I are both using, or in Palm, or eReader.  You can read it on Windows because of course there is eReader for Windows.  And the physical paper format is also accessible.  I should mention that I got it also back on my Palm because I wanted to try falling back from the Sony to the Palm that I was using so extensively for years, and I decided I can�t.



LEO:  Oh, interesting.  You�re spoiled



STEVE:  Yes.  Well, first I picked it up on the Sony.  And I found myself frustrated by the low contrast of that screen.



LEO:  I know, I know.



STEVE:  And that�s the problem with...



LEO:  They�ve really got to do something about that.



STEVE:  Yeah, that�s the problem.  And it�s like, gosh darn it, I mean, the Palm screen is just vivid black and white, and of course you have a backlight, so it�s really bright white.  Because I read inverted.  I read white text on a black screen on the Palm and love that.  But the problem is now I can�t have a smaller screen.  The E Ink, the Sony screen is so much nicer and more page size that it�s even worth tolerating the lower resolution, I�m sorry, the lower contrast of that medium.



LEO:  The contrast is bugging me, though.  I have to agree with you.  I can�t wait till they get a paper white screen.  Then that�s a product that I would, I mean, already, right, it�s a good product, and I�ve been reading a lot of books on it.  But I just - my eyes as I get older, I need more contrast, I really do.



STEVE:  Well, it�s not just your age, Leo.  Well, actually I guess maybe we�re the same age, so...



LEO:  We don�t know, we�re the same age, yeah.  So maybe younger people don�t have this issue.  I don�t know.



STEVE:  I did notice also, when I went back to Sony to poke around to see whether "On Intelligence" was available from the Sony Connect site, that the price has fallen on the eReader.  I think it was three something, and it�s now 299.



LEO:  Maybe they�ve got another one coming.



STEVE:  It might have been 349.  Anyway, it has had a price reduction, which to me sort of speaks of, oh, maybe they weren�t selling so well.



LEO:  Yeah.  No, I�m sure they�re not, despite how much we�ve talked about it.  It�s too expensive.  It�s not quite the technology it needs to be yet.  But we�re early adopters, you know.



STEVE:  Okay.  Mailbag.  I got two pieces of interestingly related mail.  Remember Justin Gerard, the neat 13-year-old kid who had somebody from an outside service come in to fix his computer and discovered that they were using SpinRite.  And I don�t remember if he was going to try to get his dad to buy him a copy or what.  But I found a note from him saying, "Hey, Steve, I found out that Nintendo has partnered with Astaro to provide..."



LEO:  What?



STEVE:  Yup, "...to provide optional content filtering via a proxy for the Nintendo DS web browser.  Just thought you  might like to know."  And apparently Justin, by the way, has a podcast called Gamer�s Edge podcast.



LEO:  Oh, I know that podcast.  Okay.



STEVE:  Well, that�s Justin, yeah.



LEO:  I�ll be darned.  All right.



STEVE:  And then we also got a note from Terry, it looks like Terry Sheltra of Charlottesville, who writes, "I just thought I would share something interesting with the two of you about the new Nintendo DS browser.  Included in the package is an insert that offers content filtering provided by none other than Astaro, free of charge.  Since they�re a big sponsor for your podcast, I thought I�d share the news with you."



LEO:  So that wouldn�t mean that they put Astaro on the DS.



STEVE:  No, it would mean that somewhere there�s a proxy server that Nintendo is offering that people can route their Nintendo DS web browsers through, and Astaro is the content filtering and protection technology that Nintendo chose.



LEO:  Makes perfect sense.  That�s what I�d choose.  Of course I�m a little biased.  All right.  So that�s the mailbag out of the way.  Remember again...



STEVE:  Almost.  I�ve got one last little blurb here.  A David Lee, who�s an MCP Small Business Specialist in Ottawa, Canada, he wrote to me with a little fun blurb about SpinRite.  And I bring it up because he asked two questions, one of which I hear a lot, so I wanted to answer it on behalf of our listeners who are now SpinRite users in case they encounter this.  He says, well, his subject was, "Hello, Steve and Leo, another testimonial to hitch to your belt."  And he said, "I�ve been an owner of SpinRite for about a year now and have used it a few times to improve performance on my machines, but until yesterday had not had any catastrophic failures from which to recover.



"Enter the BSOD," you know, the Blue Screen of Death.  "Upon rebooting after installing Adobe 8.1 Reader update, my laptop provided me with the gut-wrenching �unbootable drive� message.  Neither safe mode nor last good configuration boot options would work, either.  Knowing I had SpinRite in my �back pocket,� however, gave me some immediate comfort in the knowledge there was a better than good chance it would get me back up and running.  I ran it on Level 2, and 45 minutes later (on my one-year-old Fujitsu 80-gig 2.5-inch drive) it was stuck on an obviously bad area of the drive.  With a couple of red U�s on the screen, I had confirmation the issue was hardware related, as I had suspected.  I left it to run overnight and am writing to you this message from my now working laptop."  So, success, thank you.  And then he says, "Two questions for you.  What is the best practice for replacing drives that exhibit unrecovered data errors?"



LEO:  That�s a great question because we talk about recovering these drives, and everybody says, oh, we�re working along, and it�s just fine.  But it always makes me queasy.  If you had a problem before, should you keep using that drive?



STEVE:  Exactly.  He says, "In your SpinRite episode on Security Now! this was not addressed, i.e., should a drive that has had these types of errors be replaced ASAP?  Or with the sectors now marked as bad, is it likely safe to continue using for the foreseeable future?  Anticipating a couched response to this," he says...



LEO:  Couched?  Couched?



STEVE:  And there�s a little smiley face here, "...what would you do if it was your hard drive?" he says.



LEO:  Okay, no couching, Steve.  I want you to say it out.  Sing it out.



STEVE:  Well, there are a couple of reasons that SpinRite will give you a red U.  And we can divide it into two categories.  First of all, the U means that no matter what SpinRite tried to do - and, I mean, it will sit there and crunch on a sector for a long time - it was never able to completely recover the sector�s data.  Now, that can be a defective sector, which should normally not surface on the drive; or it could be one that was miswritten, for example, if the drive lost power during a write.  Then you will cause an unrecoverable sector to be created...



LEO:  Because is it a head crash or...



STEVE:  Well, no, it�s not a head crash.  It�s just that it never had a chance to finish writing the sector and update the error correction code, the ECC, which is sort of like a very powerful checksum.  And so it just sort of half wrote the sector.  And so when you then run SpinRite over it, no matter what SpinRite tries, it just cannot get this sector recovered.  It says, look, there�s nothing I can do to tell you what this data is supposed to be because in this case it was only half written.  So it doesn�t necessarily mean that the drive is having a problem.



Now, another non-power failure event can occur, which is that in general defects grow over time.  And as anyone who�s looked at the videos that you and I and that I and Patrick Norton made, where I was on yours and Screensavers TV shows showing SpinRite work, drives are doing data recovery sort of silently all the time.  So-called Error Correction Code is being employed constantly because the data densities have gotten so high on our drives that it�s no longer the case that sectors read perfectly.  So what happens is the drive is making corrections just because the density is so high.  And the drive is watching how long the error bursts are, that is, if it�s a few bits, the drive�s like, okay, fine, this sector�s still okay.  But over time these tend to grow.



And so what happens is, at a certain point a threshold is reached where the drive becomes uncomfortable with its continuing future ability to perform on-the-fly correction of this sector.  And so what it�ll do at that point is it will get a correct read, that is, correct the errors in a sector, and autonomously remove that sector from service, swapping a spare into its place, and then rewrite the data that it correctly read back onto the swapped-in spare sector.  So what can happen, if you don�t allow the drive to see given sectors often enough, you haven�t given the drive the chance to recognize that some sectors are approaching its tolerance of its ability to correct them.



Which is one of the reasons that just running SpinRite at Level 2, which is a relatively quick read pass, essentially what that does is that forces the drive to read all of its sectors.  And even though SpinRite won�t show you that it did anything good - and this is one of the sort of the dilemmas, the mixed blessings of using SpinRite, is people will run it all the time, and they�ll go, well, you know, I�ve never had a drive give me any problems, and I run SpinRite every few months, but I don�t know that it�s really doing any good.  Well, one of the reasons they�ve never had a problem is that SpinRite is actually letting the drive assess its own sectors and swap them out before they become problematical.  So if someone didn�t do that, they might find that SpinRite would show them a red, uncorrectable sector because the sector had gone too long without being read, so the drive wasn�t able to say, whoops, this is getting to be problematical.  I can still read it, but barely.  So while I can, and while I can read it and correct it, I�m going to swap in something that�s in better shape.  So that�s all sort of going on behind the scenes.



And then the third and final problem is drives can run out of spares.  And at that point, if you actually have a defect which is not readable, and there�s no spares left for the drive to use, it has no choice but to just say, sorry, here�s a problem sector, and I�m out of spares.  And that does happen.  So at that point you certainly would want to say bye-bye to that drive.



LEO:  Okay.  But how can you tell that?



STEVE:  Well, running SpinRite a second time after you�ve had - see, once SpinRite gives up on a sector, marks it has uncorrectable, shows it that way, it will then rewrite the sector with whatever data it was able to recover.  That�s why I don�t give up easily.  I try 2,000 times - well, I in the guise of SpinRite - 2,000 times, and use every trick in the book, moving the head different distances in each direction and then coming back at it so that I�m arriving in slightly different positions, do all kinds of things to really, really try to read that sector.  When I finally can�t, after 2,000 attempts, I will rewrite the sector with what I was able to read.  And that process fixes its unreadability and then allows the drive to maintain it from there on.  But if you then run SpinRite a second time, and you�ve still got a problem, that means the drive was not able to even correct from a rewritten, correctly written sector, and it�s time to take the drive out of use before it really goes belly up.



LEO:  So you didn�t couch too bad on that one.  The bottom line is that there is some slack in all drives, and some room for error.  But when it gets to the end of that rope, that�s when you have to replace the drive.



STEVE:  Yeah, actually I would say a lot of slack and room for a lot of error.



LEO:  It�s normal.  There�s no drive made that doesn�t have some problems.



STEVE:  Not anymore, unfortunately.  And then his second question, which I got a kick out of, was "Why hasn�t anyone bought your company?"



LEO:  Security Now!, you mean?



STEVE:  No, no, bought GRC or bought SpinRite.  And he says, "A la the old Chrysler commercials, �I was so impressed, I bought the company.�"



LEO:  I bet you�ve had offers.



STEVE:  Well, Peter Norton offered to buy SpinRite shortly after I created it, about a year and a half later, I think.  He said, Steve, I�ve got the Norton Utilities. Everybody I talk to just wants me to add SpinRite capability to our stuff.  I want to buy it from you.  And the best thing I ever said to Peter was no thanks, Pete.



LEO:  This is your life�s work.



STEVE:  Yeah, so far.



LEO:  Can�t sell your life�s work.



STEVE:  So far.



LEO:  On the other hand, everybody has a price.  If somebody came along and offered you a billion dollars, you might take�it.



STEVE:  Yeah, yeah.  I�d still do the podcast with you, however, Leo.



LEO:  I would hope so.  Because at that point you could do it from your yacht.  In the Caribbean.



STEVE:  Exactly.  And I�d create my own satellite network so that we had low latency.



LEO:  All right.  Let�s get to the meat and potatoes of our discussion today.



STEVE:  I forgot what we�re talking about.



LEO:  Are you human.



STEVE:  Oh, that�s right, that�s right.



LEO:  Are you human.



STEVE:  What I love about this is that this is a type of authentication other than what we�ve talked about before.  Of course we�ve really clearly covered the issue of are you a specific human.  That is, you know, the multifactor authentication like what we were talking about earlier with PayPal and so forth was which human are you.  And so what I like about this is that this is not who you are.  This is are you a who.



LEO:  Okay.  Are you a who?



STEVE:  Are you a who, not...



LEO:  Sounds like a Dr. Seuss story somehow.



STEVE:  Exactly.  It�s not who you are, it�s are you a who.



LEO:  And that�s important because...



STEVE:  Well, what we�ve had, of course, is the rise of the Internet robots.  Back in the early days of the Internet there were just people using web browsers and using services and things.  But what began to happen was we introduced - probably I guess the first real instance was free email accounts.  It became clear that it was possible to do browser-based email, where companies like Yahoo!, who may have been the pioneer of web mail, they said, hey, you can create an account, and it�ll be susiejones@yahoo.com or whatever, just to make up a name.  I hope Susie forgives me for using her email address.



LEO:  She�s probably pretty used to it by now, with a name like that.



STEVE:  And so everyone said, hey, this is cool, then I don�t have to be at my computer, I don�t have to use an email client.  Any web browser anywhere I can log onto my email account and check my mail and send stuff.  Well, the bad guys, the spammers said yes, and so can we.  We can create endless email accounts at Yahoo! with random names or made-up names or names composed of words in dictionaries or whatever, and use it to send our spam because who would know that we were spam.  And that way, you know, the beauty is - this was back in the early days where we had the blacklisting of spam servers.  So the problem was those servers that were blacklisted could no longer send spam with sufficient reliability because they were becoming known.  But by using Yahoo! sort of as their third party, as their intermediary, using the web interface, they were able to cause Yahoo! to be a spam forwarder, and so that�s what�happened.



So, and then of course even more recently now with all of this Web 2.0 stuff, now there�s so much more, this whole notion, and we�ve talked about it with regard, for example, to cross-site scripting vulnerabilities and various problems associated with accepting input from users.  Now the web is much more bidirectional than ever before with Facebook and MySpace and all the blogging that�s going on.  And one of the newest trends you see are articles online that then want feedback from readers.  They have posting comments at the end of articles.  And so what�s happened then is that, if high-profile sites like NBC and ABC and CNN and so forth, that is, sites that are highly ranked in search engines, spammers will now - that is to say, website spammers will want to put their own links into blogs and into comments because then search engines will say, oh, look, here�s a highly ranked site that has a reference to this other site, which turns out to be a yucky site that people really don�t want to know about.  But that�s a way of them elevating themselves in search engine rankings.



So it�s the same story as, like, virus/antivirus, malware/antimalware, spyware/antispyware.  There are useful services that have unfortunately been abused by people on the dark side who have said, hey, we can pretend to be human and abuse the system in various ways.  So...



LEO:  But they can�t prove that they�re human if you can come up with a scheme.



STEVE:  Well, yes.  What�s really interesting is that the first time I encountered this notion of needing to prove that I�m human, it�s like, oh, what an interesting, kind of cool problem.  And your first thought, my first thought as a computer guy, and any of us are to some degree, well, to probably a complete degree computer users.  Any user sort of thinks, huh, how would I solve this problem?  And at first it doesn�t seem to be such a hard problem.  It�s like, well, it�s got to be easy to figure out the difference between a computer and a human.  But it turns out it�s less easy than people might think because so much of the sorts of things that are feasible to do, computers can be programmed to get�around.



So this notion of some way to solve this problem turns out to actually have a deep history, which is sort of interesting.  There was something known as the Turing Test, T-u-r-i-n-g, which was originally proposed by an early researcher in computers named Alan Turing, who was also the father in some senses of modern computing, or at least of�algorithms.



LEO:  He also helped crack Enigma, the German codebreaking device, World War II.



STEVE:  Yes, exactly.  He worked at Bletchley Place, or is it Plaza or Place?



LEO:  Place.



STEVE:  Bletchley Place over in England, and was involved in the codebreaking of the German Enigma code during World War II.  And he was, well, first of all, he was recognized at a young age as being a genius.



LEO:  Brilliant guy.  Brilliant guy, yeah.



STEVE:  Yes.  He really is regarded as that.  He tackled the question of computability, that was, what did it mean for something to be computable, and that is to have, like, an algorithmic solution.  And in fact he formally laid down this notion of an algorithm.  And the formalization of it took the form of something called a "Turing Machine," which he formally proposed and laid out in a paper that he wrote early on.



LEO:  Couldn�t be built at the time, in the �40s.



STEVE:  Well, and in fact it�s more of a theoretical machine.  I mean, people have built them for fun.  But the idea of a Turing machine is that it, sort of using the�jargon...



LEO:  Bletchley Park, by the way.



STEVE:  Oh, that�s right, Park, right.  Using the concepts at the time, the idea of Alan�s Turing Machine was that you�d have a paper tape which was theoretically infinite in length.  It had a starting place, but it never ended because, you know, this thing, in order to do useful work, might have to have a very long tape.  Because the idea was that it was a series of very simple steps.  Basically you had a read head that was positioned at some location on the tape.  And each cell in the tape could contain only a one or a zero.  So he had this notion of binaryness back then.  And based on - oh, and the machine also had some state.  So it had a well-defined state which was not specified, but it was just some number of bits or something that defined the current state.  And the way he defined it was you had the current position of the head, which was able to read or write to a one or a zero to the cell, and then cause the tape to move to the left or the right and change the state, that is, update the state to state plus one.  And basically that was the definition of this machine.  And he managed, through a series of very careful mathematical proofs, to show that this machine could solve any problem that any computer could solve.  And in fact there was something known as the...



LEO:  At the time a computer was a human.



STEVE:  Exactly.



LEO:  Was a woman, usually, who was doing computations.  So�he�s talking about a machine that replaces a human computer, basically.



STEVE:  Right.  And then there was this notion of the UTM, the Universal Turing Machine, where he said, okay, you could define a machine on the tape, which on the tape would then be followed by a problem.  And so this created this notion of a Universal Turing Machine because you could then - you could use it as, like, a universal emulator for any other machine.  So he basically said, okay, this is how computers can be simplified down to this.



Well, amid all of this, actually toward the end of his life, which wasn�t very long, unfortunately, he only lived - didn�t quite make it to the age of 42.  So he was quite prolific during his first 41 years.  He ended up saying, okay, thinking about intelligence, how can we determine if a machine is intelligent?  How do we define intelligence?  And he had a very 1940s, early 1950s definition.  He said - and this was the so-called "Turing Test."  He said, if you put a human in one room and a machine in another, and you ask them both questions, that is, a human being asks both of them questions but doesn�t know which room contains the human and which room contains the machine, that is to say, the AI, the artificial intelligence, if the person asking the questions cannot reliably determine which room contains which entity, then that is said to pass the Turing Test for determining whether this is a machine or a human.  So again, it�s a sort of a thought experiment.  It�s a simple formulation for asking the question.  But that�s deep in the history of�computing.



LEO:  Just some little footnotes on that, in "On Intelligence" he�ll talk about - you haven�t gotten there yet, but he talks about the Turing Test and why it essentially will never be solved.  That�s kind of in some ways the premise of "On Intelligence."



STEVE:  Well, I think he also talks about John Searle�s Chinese room thought experiment.  Anyway, there�s a bunch of stuff in this book that I really recommend to our listeners.



LEO:  A second footnote, before you go on.  It�s appropriate to mention, and it�s very sad, that he in fact committed suicide after being prosecuted for being gay.



STEVE:  I know.



LEO:  It�s just a great tragedy.  I won�t belabor it, but read the article in Wikipedia about Alan Turing�s life.  And there�s some excellent books on Turing.  And he actually appears in "Cryptonomicon," another favorite book of ours.



STEVE:  Yes, he does.  Right, I forgot about that.



LEO:  Yeah, Bletchley Park is a big part of that whole book.  But anyway, so that Turing Test is the first case of a human-machine challenge, I guess.



STEVE:  Well, it is.  And it bears on what we�re talking about because the rather lengthy acronym for the whole class of currently most popular approaches to differentiating people from computers, that is, who you are or are you a who, involves this Turing Test phrase.  What happened is, about seven years ago, in 2000, Carnegie Mellon University, a researcher there, Luis von Ahn - and for Elaine�s sake, who�s transcribing this, von Ahn is two words, v-o-n, and the second word is A-h-n.  He got serious about CAPTCHAs.  And actually that�s their acronym.  And believe it or not, Carnegie Mellon has a trademark on the word CAPTCHA.



LEO:  Really, it�s an acronym?  C-A-P-T-C-H-A.  I always thought it was just "capture" mispronounced.



STEVE:  Well, get this.  CAPTCHA stands for Completely Automated Public Turing Test to tell Computers and Humans�Apart.



LEO:  I�ll be danged.  So Alan Turing is memorialized in the�CAPTCHA.



STEVE:  Yes.  And now people know, if anyone has the memory to remember Completely Automated Public Turing Test to tell Computers and Humans Apart, now you know what a Turing Test is and who Turing was who came up with this test.  So that�s what CAPTCHA stands for.  And the university, CMU, has a trademark which they�re obviously not being jealous about.  I�m sure they trademarked it so that, well, because they had come up with it.  They thought it was cool, and they wanted some credit for it, but not to prevent others from using the word because it�s widely used, and no one from CMU seems to be causing any upset about that.  So the most familiar CAPTCHAs, and I would imagine by this point everyone around, that is to say everyone listening to this podcast, has encountered some.  You and I have in fact talked about them from time to time briefly in prior podcasts, Leo, where they�re these wacky-looking images where you are asked to basically decipher a warped and deliberately obscured chunk of text or letters and numbers or something, you�re asked basically to solve some sort of problem, the idea being that this is something that would be easy for humans and hard for computers.  Well, it turns out that computers have gotten so good that, in order for it to be hard for computers, unfortunately more often than not it also has to be hard for�people.



LEO:  Right, unfortunately, yeah.



STEVE:  And, I mean, I have encountered CAPTCHAs, visual CAPTCHAs, that I have not been able to properly enter the proper code for, which is really annoying.



LEO:  I do it all the time.  You know, I have a lot of difficulty with Digg�s.  I just sometimes cannot read Digg�s at all.  They invoke the CAPTCHA if you try to enter your password and fail once.  Then they want to make sure you�re not a machine.



STEVE:  Okay, that sort of makes sense.  In fact, one of the things I want to talk about here is this notion of the cost of CAPTCHAs because it�s very interesting.  I want to make sure that people know that the show notes for this episode has a bunch of links.  Wikipedia has an excellent page on CAPTCHAs, lots of coverage, lots of good references.  And on the show notes for this episode, Episode 101, I found some interesting CAPTCHA-cracking sites that have really good technology for and pictures of many popular CAPTCHAs, showing basically what it is about them that isn�t hard enough.  And there are some CAPTCHAs that have solved at 100 percent, some at 88 or 89, meaning that algorithms have been created which are specifically designed to crack the visual complexity that people have put into these things in order to, again, differentiate between human and computer.



The problem, of course, is that - as I said, this is the best set of puzzles or problems that we�ve so far been able to come up with.  But the problem is computers have gotten so powerful and so good that there�s a very fuzzy line between computer and human.  Looking at these CAPTCHA-cracking sites, and specifically at the complaints the authors of these crackers have, they say, for example, using a constant font or even a small number of fonts allowed them to do a better job of cracking the CAPTCHA.



LEO:  Interesting, huh.



STEVE:  Or using all aligned or almost aligned characters allowed them to sort of analyze the characters and lock on to the relative alignment.  And that was an aid to them.  Or using constant character position.  There are some CAPTCHA generators that produce images where the characters are, like, scattered around, but they�re always scattered around in exactly the same location from one CAPTCHA to the next.  So somebody trying to deliberately crack a CAPTCHA-protected site would take advantage of the fact that, yeah, the characters are all kind of "cattywumpus," but they�re always in the same "cattywumpus" position.  So once the author of a cracker saw that by looking at several CAPTCHAs being generated by that site, they�d go, oh, well, sure.



And what�s interesting is there�s a perfect example of a mistake by the CAPTCHA maker because here you�ve made it really more difficult for the human because we�re just encountering that CAPTCHA probably once.  But here a spammer has - essentially what you�ve done is you�ve made it harder for the human by scattering the characters around; but someone cracking the CAPTCHA, writing code to crack it, once they recognize that the characters are always in exactly the same position, with the same orientation, well, you�ve made it no more difficult for the code, while keeping it difficult for the human.  So that was a bad idea not to move them around.  Also constant horizontal position, constant character rotation, no deformation, non-textured background, use of constant colors or weak colors - that�s easier then for the cracking author to lock onto - or no overall perturbation of the image.  So essentially what this means is that everything that is being done to make these things difficult for us does to some varying degree make it difficult for a program.  But unfortunately we�re seeing now that CAPTCHAs are to some degree being able to be broken.



Now, other sites have analyzed what it is that is the most difficult for computers to solve, that is, in terms of cracking these images.  And it turns out that dividing the individual glyphs, you know, "glyph" is the font term for an individual character, essentially.  So dividing these images into individual characters is something that we do pretty well.  But that�s one of the problems that computers have.  And so, for example, running lines through the characters really does bump the level of difficulty for automated recognition of the characters up rather substantially.  And so one of the things you will see in the most modern CAPTCHA technologies are words or phrases or sequences of letters and numbers which end up being obscured with lines running through them, and maybe not so much other wacky stuff that makes it really difficult for people.  I mean, again, Leo, I�ve run across CAPTCHAs where I�m thinking, okay, am I going to be punished if I get this wrong?  Because I don�t know if this is a Q or a bent-over R.  I mean...



LEO:  But you make an interesting point, that sometimes what�s hard for a human is actually not hard for a machine.



STEVE:  Right, exactly.  It�s not always the case that what some clever programmer has actually done something that is making it more difficult for a machine because what you�re generally having, and this is a function of value, which is one of the key points I want to make today also, is the CAPTCHA protecting Yahoo!, because Yahoo! has a high cracking value, you might very well have somebody who is willing to spend a great deal of time and effort writing a Yahoo! CAPTCHA-cracking technology.  Whereas some obscure, off-the-beaten-path blogging site, which has never had a problem with malicious posting to it, well, putting an extreme CAPTCHA on that site is...



LEO:  Is extreme.



STEVE:  Is extreme, exactly.  Here you�re hoping somebody is going to put a comment on your blog posting.  Well, raising the bar up too high for that poor human who is like, okay, do I have to stand on my head in order to decrypt this?  What is this CAPTCHA trying to say?



LEO:  I have to say, though, it�s so frustrating when you get spammed that sometimes you just say, screw it, I don�t care if it�s hard for humans, I just - I�m not going to let the spammer in.



STEVE:  Right.



LEO:  You wouldn�t believe, I actually have turned off registrations on TWiT.tv because these guys will go to the extreme trouble of creating an email account, signing up, waiting for me to send them the password via the verified email account, and then spamming.  So it�s very, you know, it�s a lot of effort they�re putting in, compared to how hard it is for me to block them.  It�s not very hard for me to block them, I just have to constantly do it.  And I finally just gave up, they were so...



STEVE:  Persistent.



LEO:  ...relentless, yeah.  So I understand why people might put really difficult CAPTCHAs.



STEVE:  Well, there have been some very, very clever hacks.  And I think one of my very favorite most clever hacks, and this was done as a proof-of-concept actually by somebody at CMU who was working sort of on the opposition team, I mean, he was on the side of CMU, and these have been major CAPTCHA innovators over the years, and we�re going to talk about a recent very cool concept that they came out with.  But in any environment you want somebody trying to break your solution.  And in the academic environment there were some people who said, I know how to break the whole CAPTCHA�system.



What they did was they created, or maybe they just borrowed or used, but anyway, there was an adult website that had very high traffic.  And what they did was they created a system which would - imagine going to Yahoo! and wanting to create an account.  You�re presented with a CAPTCHA.  On the fly, this bot took that CAPTCHA and stuck it on the log-in page on the adult website, where a human would solve the CAPTCHA problem.



LEO:  Oh, no.



STEVE:  So the bot would then take the human solution and feed it back to Yahoo!, thus solving Yahoo!�s original CAPTCHA problem.  Isn�t that just the cleverest thing?  I�just...



LEO:  So they basically used unwitting human helpers by just borrowing Yahoo!�s CAPTCHAs and keeping track of them.



STEVE:  Exactly.  There was enough traffic on the site, that is, on the adult website, that no CAPTCHA would remain unsolved for long.  And so it fit within the window of time that Yahoo! was allowing that CAPTCHA to be valid.  So on the fly, Yahoo! CAPTCHAs would be - or, you know, I would imagine the way it would work is this.  You would actually be - I�m just thinking of this on the fly here.  You would actually have your bot on the adult website.  Oh, no, I was going to say you would wait till they were presented with a puzzle.  Or maybe, yes, you go the adult website, and it says "click here to log in."



LEO:  Right.  And meanwhile it goes off to Yahoo! and gets a�CAPTCHA.



STEVE:  Exactly.  When the person on the adult website clicks here to log in, it�s about to present him with a CAPTCHA.  So the bot goes to Yahoo!, clicks to create an account, receives the CAPTCHA, forwards it to the adult site, that then presents that CAPTCHA to the human, who solves the CAPTCHA problem.  And then the bot turns around, solves the problem on Yahoo!, and is able to create an email account.  So I just, you know, that�s super clever.  And I just thought that was a neat solution.



LEO:  It�s also depressing because it really means it�s�hopeless.  I don�t know how you�d get around that.  I�mean...



STEVE:  Yeah, exactly, now what are we going to do?



LEO:  Now what do we do, yeah.  Because you�re essentially, I mean, you can�t get around the fact that they can enlist humans, as long as they�re willing to enlist humans to do�this.



STEVE:  Yes, exactly.  And that, by the way, is known in the CAPTCHA community as the so-called "relay attack," where you�re relaying the CAPTCHA through a site where you�ve got enough traffic in order to generate a useful number of CAPTCHA solution events on the fly.  And again, what are you going to do about it?



Now, CAPTCHA is a little bit controversial, also.  And I have a link on our show notes to the W3C�s, you know, the W3 Consortium�s anti-CAPTCHA page.  They just don�t like CAPTCHA because they feel that it very unfairly discriminates against people who have any kind of disabilities.  And they�re all about, and they want the web to be all about, being a nondiscriminatory system.  And they make the point that even if you have - and you talked about this before, Leo, the notion of an audio CAPTCHA, that is, the idea being your main CAPTCHA is a visual CAPTCHA, where you�ve got to figure out what this phrase or expression is.  But for blind people, of course, they�re not going to be able to do that.  So you have a backup solution, which is click on this to hear some...



LEO:  I�m going to play - this is the one - this is Digg�s.



AUDIO CAPTCHA:  J, P, N.



LEO:  The truth was, that wasn�t - I wouldn�t think a machine would have that much trouble.



AUDIO CAPTCHA:  F, F, J, P, N.



LEO:  It�s actually easier than doing it looking at it.  I�m going to use the listen to it from now on.



STEVE:  It actually is.  Now...



LEO:  Now, I played the Carnegie Mellon for you before.  You want to hear that one?



STEVE:  Sure.



LEO:  This is the audio - attempt to make an audio version of a CAPTCHA.



AUDIO CAPTCHA:  [Tone], 4, 1, 6.



LEO:  That would be tough for a machine.



STEVE:  Was that 416?



LEO:  I guess.



STEVE:  I think.  And, see, here�s the problem, is that we also have speech recognition.  I mean, we�ve been working on that for a long time in the computer community, in the same way that we�ve been working on optical character recognition and vision technologies.  So unfortunately the audio backup for the visual CAPTCHA also has to be deliberately obscured in order to make it, again, difficult for a computer.  And unfortunately there just isn�t enough difference today between computer recognition of audio and human recognition of audio for this to be a really great solution.  But the W3C page makes the point that even doing this discriminates because it�s a privacy problem.  Now you�re forcing blind people, people who are not sighted, to declare themselves as such on a site.  And you could argue that that is some loss of privacy because they�re not able to solve the visual CAPTCHA, they�re being forced to solve the auditory CAPTCHA.  Anyway, the...



LEO:  I�m not sure, I think that�s going a little - that�s a little scrupulous, but...



STEVE:  I know.  But the W3C page does - it�s very anti-CAPTCHA, and it makes a number of points, one of which...



LEO:  I would be more aggressive in defending CAPTCHA; but it sounds like, from what you�ve just described, it doesn�t work that well anyway.  Or it doesn�t necessarily work that well.  So maybe it�s not worth defending.



STEVE:  Well, there are problems with it.  Now, one of the coolest things you turned me onto a couple weeks ago, you just sent me a link in email, Leo, and you said "Isn�t this neat."  And it is just, again, I love clever stuff, and I love sharing cleverness with people.  And this of course is known as reCAPTCHA.  And this again is from our same guy, von Ahn, at CMU.  He recognized that there�s a huge effort underway to digitize books.  We are wanting to get books into digital form, rather than just scanning them and then, like, presenting scanned pages.  People can read scanned pages, more or less.  The problem is that a scanned page is a huge amount of data compared to a typewritten page.  And if we actually have it converted to text, then it could be eBook, it can be - you can use text-to-speech in order to automate the process of reading the book audibly, I mean, it�s just so much cooler to have these books in electronic form, I mean, in textual, you know, ASCII-style electronic form as opposed to scanned images.  But many books were published, I�m sure it�s probably most books were published before we had the technology to do it all electronically.  So we just - there is no original DOC file or TXT file to back up these books.  So here we�ve got this huge archive of scanned images.  Well, the cleverness of reCAPTCHA is of using single-word snippets from scanned texts and presenting those to users.  So in the process of solving the CAPTCHA puzzle, you are part of the solution of digitizing these�books.



LEO:  I just think it�s so elegant.  And by the way, I use that, if people want to send me email - now, here�s an example of why you might want to use a CAPTCHA.  I�m not going to put an email link on my front page, although at this point it�s pretty moot since I think I�m on every spam mailing list in the world.  But I thought, well, why make it any worse?  So I do have a contact link.  But in order to get the email address you have to fill out a CAPTCHA.  And I�m using the CMU CAPTCHA.  So if you go to Leoville.com or Techguylabs.com, and you click "Contact Leo," you�ll get a CAPTCHA.  And in the process - so do you want to describe how it works?  It�s very cool.  There�s two words you get.



STEVE:  Yes.  What they do is they show you two words.  These were both...



LEO:  They�re both English words.



STEVE:  They�re both English words.  They were also originally flagged as unrecognizable by the OCR software.



LEO:  So these are books they�re trying to scan, but they�ve had some trouble with.



STEVE:  Well, these are individual words from books they�ve tried to scan.  One of the cool things about OCR, contemporary OCR software, is it knows if it�s not sure.  That is, it knows, if it�s, like, eh, I really don�t feel confident, you know, you now get a confidence factor per word from OCR software, or at least this particular OCR software that�s being used.  So here�s the cool thing.  The word starts out as being unrecognizable with high confidence by the best OCR software we have.  So that�s a good start at something which no one else�s OCR software is going to be able to recognize, either.  Then it is deliberately warped, and a wavy line is run through it.  And as we learned, a wavy line, it now means that instead of having little islands of glyph which are easily identified and then can be chopped up and recognized individually, this turns it into one big blob of black.  And it turns out that it really hurts recognition, but not for humans.  Humans don�t have a problem with that.



And so the idea then is that two words are presented to you, and you�re asked to type them both in.  Well, you�re not the only person who receives this pair of words.  Enough people receive different combinations of them that by comparing what people put in, the back end software that is doing all this is able to arrive at a high enough confidence level that, you know, I don�t know what their numbers are, but maybe ten people all put in the same text for each of the two words appearing at different times in different contexts and in different pairs that they finally said, okay, we now know for sure what this word is.  So not only have you proven yourself to be human, but you�ve also helped OCR software digitize books.



LEO:  And I think it�s just so cool.



STEVE:  I love it.



LEO:  In fact, even if I didn�t really need it, I would still use it just to do my part; right?



STEVE:  Yes.  And, now, it is estimated that 60 million CAPTCHAs, visual CAPTCHAs, are currently being solved by humans every day.



LEO:  Wow.



STEVE:  And that about ten seconds or so of time is required for the typical CAPTCHA to be looked at and typed in.



LEO:  Oh, that�s a lot of computing time.



STEVE:  So ten seconds times 60 million a day is 600 million�thought seconds per day, which is to say 166-plus thousand hours.  So 166,000 hours are being spent now solving CAPTCHAs.



LEO:  Each day.



STEVE:  Each day.  So by using reCAPTCHA, that can be turned into 166,000 hours of people distributed over the entire world, digitizing books.



LEO:  I think that�s great.  I would love to see what the results are so far with this project.  I think that�s just�wonderful.



STEVE:  So absolutely, I want to commend people to take a look at reCAPTCHA.  If you go to CAPTCHA.net, www.captcha.net, it now recommends reCAPTCHA.  And reCAPTCHA�s just the same with an "re" on the front of it.



LEO:  Trivially easy to add to a website.  You�ll generate it, it�ll create a link, and boom, it�s done.  And by the way, they talk about the pornography attack in the other - this is really interesting how they�re doing it.  They point to a lot of the information that you�ve been talking about.



STEVE:  Right.  Now, one other - there are other things that have been done, in general solving - that is to say, have been done as non-visual means, or non-CAPTCHA - well, I guess CAPTCHA actually would encompass everything because it�s computer blah blah blah, whatever that acronym was.  But so anything that is trying to differentiate a person from a computer.  So we have the visual CAPTCHAs we�ve been talking about.  But, for example, you could imagine some sort of puzzle-solving solution.  There has been JavaScript created which asks simple, English-language problems, like what is one plus one, as a trivial example.  The problem is, again, it wouldn�t be hard to cause a computer to have, you know, there would be a limited enough vocabulary of permutations of questions that different numbers would get plugged into that you could write some code that would understand that limited subset of questions and be able to answer them.  So that�s not very exciting.



Then, and you mentioned this, I think, last week or the week before, there was this interesting notion of something called "KittenAuth."  KittenAuth was created a couple years ago.  The idea was it would show you a grid of photos, some of which were kittens, and you�d have to select those which were kittens and then click okay, the idea again being that only a person would be able to actually recognize what this was a photo of, and whether or not it was a kitten, and be able to answer it correctly.  There again, the problem is you would have a limited number of pictures.  And given somebody who was motivated enough to crack this form of CAPTCHA, they would simply capture all the pictures, flag them as kittens or non-kittens, and then be able to hack right through.  So that�s not going to work very well.



And the other thing is that CMU comments that that actually isn�t a CAPTCHA by their definition.  They want it to be a fully automated creation, that is, you�re having to take actual photos, and you�re going to have a limited database of those.  You�re not actually synthesizing something from scratch, which is what these visual alphanumeric CAPTCHAs are doing is they�re building the image from scratch, and you don�t have a limited domain of images from which to choose or, again, that would be very easy to hack.



So then another thing that has been suggested is somehow involve live operators, where you involve a human in the loop, sort of harkening back to the original Turing Test, where you did have a human making the determination.  And then there�s a whole domain of what we were talking about when we were talking about multifactor authentication, where you have specific ID authentication, that is, you�re no longer determining whether the person, an anonymous person, is a person or a human.  But you�re saying - you�re using single sign-on.  You�re using authentication like OpenID or CardSpace or something to say, okay, this is exactly who you are.  Maybe you�re using public key infrastructure for doing, for example, using certificate authentication or biometrics.  So it�s like, okay, computers don�t have thumbprints.  Although you could certainly imagine that computers could just create a fake thumbprint.  So those things seem not so useful; but, you know, they�ve been experimented with.  And then there�s also simple questions being asked, variations on, like, five words, and the question is which one of these does not have a sail.  And the problem again is you�re probably going to have a limited number of questions, which after a while all of those can be automated in order to crack the response.



So it turns out that this is a hard problem, like I said.  You think right off the bat, the first time you encounter it, it�s like, oh, how interesting.  Shouldn�t it be easy to tell people and humans apart?  But over an Internet connection it�s not so easy.



LEO:  Not so easy.  Yeah, very clever.



STEVE:  And then when you add this notion of a relay attack, where you�ve got people solving the same problem for a different reason, then it�s like, oh, very clever, and now what do we do?



LEO:  Yeah.  Well, they claim that the reCAPTCHA is not susceptible to that.  I haven�t read it, so I�m not sure�what...



STEVE:  They�ve got a bunch of crypto involved, where they use multiple servers, and it�s all free, but you get some tags that you use as part of this.  And so they are specifically working to liminate - to liminate - to eliminate and limit - I was trying to say eliminate and/or limit that vulnerability.



LEO:  Yeah, very interesting.  Well, that�s CAPTCHAs.  That�s how to tell if you�re a human.  Are you human?  Hmm.



STEVE:  Okay, Leo, now you�ve got to do this.  https://www.paypal.com/securitykey.



LEO:  Ah, okay.



STEVE:  See if that comes up for you.  I put in PayPal security key into Google.  It�s the first link that comes up.  Because this is just so cool for five bucks.  And it just, I mean, $5 to have...



LEO:  Oh, there it is, yeah.  All right.  Order your security key.  I don�t know why it�s not showing up on my front page.  But that�s great.  Oh, I�ve got to log in.  All right.  And I�m - so, now, you use this every time you use PayPal now?



STEVE:  And I forgot to mention, also eBay.  It provides security for eBay, as well.



LEO:  Yeah, because they�re owned by the same - see, five bucks, what a deal.  I�m sending it right now.



STEVE:  I know, $5.  I mean, who doesn�t want to have one of these cool crypto tokens for $5?  Anyway, I just - I wanted to make sure people knew because then, after you authenticate this to your account, you simply add, and you must add, those six digits, the six digits that currently shows, to the end of your password in order to log on to PayPal or eBay.  And I�m just so jazzed about this.



LEO:  That�s just brilliant.  Well, we use PayPal heavily.  And I am always a little nervous because I keep, you know, I keep all of our receipts from the TWiT Network in there.  And I�m almost using it as a banking account because you earn interest on it.  So I feel like, well, that�s a safe place to keep it.  But, boy, we could be wiped out if I weren�t careful with the password.  So this makes me feel a lot, lot better.



STEVE:  It is safer now.



LEO:  Yeah.  Because since our hosting draws directly from that account, all of our overhead pretty much comes directly from that account.  So if it were to suddenly go to zero balance, I don�t want to think about it.



STEVE:  I would not want to encourage people to create a bogus PayPal account just to get a $5 token.



LEO:  No.



STEVE:  But you could.  And it�s very cool.



LEO:  Well, you know, if you�re going to - here�s a way to do it.  Make a donation to TWiT.  As part of that you can set up an account.  You don�t have to tie it to your bank account.  You can use a credit card.  So you don�t have to feel like you�re somehow giving them something private.  I think that�s one thing that scares people.  Just sign up.  Give us a little donation.  Help the podcasts to stay afloat.  And then your little benefit is you get that $5 security key and be more secure.  I like it.



STEVE:  It�s just too cool, Leo.



LEO:  I just ordered it.



STEVE:  Cool.



LEO:  All right, Steve.  Boy, this is a long episode.  We had a lot to say.



STEVE:  Mailbag is next week.  So I want to again say [ADDRESS DELETED DUE TO SPAMBOT DISCOVERY].  That is mail that comes directly to me through no spam filtering or anything else.  The web form at the bottom of the Security Now! page at GRC.com sends email to the same address.  It does so anonymously unless you provide your name and location and email and so forth, which does allow me to respond when I�m able to, and I like to when I can.  But anyone who just wants to do an easier�way...



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#102

DATE:		July 26, 2007

TITLE:		Security Now! Mailbag #1

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-102.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo open the Security Now! mailbag�to share and discuss the thoughts, comments, and�observations of other Security Now! listeners.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 102 for July 26, 2007:  Steve�s Mailbag.



It�s time for Security Now! with Steve Gibson.  We�re going to talk about securing your computer, securing your access, securing your lives, locking things down.  Steve Gibson, today is our first Mailbag edition, yeah?



STEVE GIBSON:  Yeah, actually there was one - I got a piece of email that I just loved.  Unfortunately I read it a couple weeks ago, I think, and I can�t give credit to who wrote it because I don�t remember where I saw it or where it was.  But the subject caught my attention.  He said, so sorry you won�t ever do any mailbag episodes.  I was like, what?  So he made the very accurate comment that, when we refer to mod 4 episodes...



LEO:  Those are our question-and-episodes.



STEVE:  Exactly.  What we�re saying is, the episode number mod 4 equals 0.  That�s the formal equation.  So I�ve been calling it mod 4 plus 2.  So he says, okay, well, episode number mod 4 plus 2 will never equal 0.  It�s like, okay.



LEO:  No, he hasn�t put the parenthesis in the right place.  It�s (mod 4) plus 2.



STEVE:  Well, yeah.  He�s correct.  It ought to really be episode number plus 2 mod 4, yeah, equals 0.  So it�s like, uh, got me on that one.  So I got a big chuckle out of that.



LEO:  Oh, they are geeks.  They are.



STEVE:  Actually, in the mail I�ve been reading - I didn�t choose this one for today.  But some guy was saying, Steve, you are such a geek.  When I grow up I want to be as geeky as you are.  And then he had a bunch of examples of - and you were sort of lumped in there, too, Leo.  It�s like...



LEO:  I am not a geek.  I�m not in your class, anyway, that�s for sure.  Nowhere near your...



STEVE:  Is there a difference between geek and nerd?



LEO:  Oh, yeah.  We�re not nerds.  A nerd is, well, I mean, I don�t know what the technical difference...



STEVE:  You mean, like, thick glasses, antisocial person?



LEO:  When you talk about Nerds On Site, I think they think they�re geeks.  So I don�t know, you know, if we went to Wikipedia we might find a technical difference.  But in my mind, I�ll tell you what a difference is between a nerd and a geek.  A nerd is like a Stars Wars fan, the Harry Potter fans who lined up.  Those were nerds.



STEVE:  And that includes people who, like, have Captain Kirk costumes.



LEO:  Yeah.  And many of them are geeks, as well.  But not all geeks are nerds.



STEVE:  Oh, so we have a subset-superset situation here.



LEO:  Yeah.  And geeks, I always think of geeks as more technical, technologically focused.  So nerds are fans, sci-fi fans, so forth.  But that�s just in my head.  I don�t think there�s any - a geek�s a guy who bites the head off chickens.  It has nothing to do with technology at all.  So I don�t really know what the...



STEVE:  Okay.



LEO:  No, that�s the technical derivation of that.  You know�that.



STEVE:  It is?



LEO:  Yeah.



STEVE:  Geek means something - no, I never knew that.



LEO:  Those are - in carnie talk.  A geek is a kind of carnie.  The one in particular that bites head off chickens.  Now, let me go to the definitive geek resource.  According to Merriam-Webster, by the way, geek is, one, a carnival performer often billed as a wildman whose act usually includes biting the head off a live chicken, bat, or snake; two, a person often of an intellectual bent who is disliked; three, an enthusiast or expert, especially in technological field or activity.



STEVE:  Oh, good.  So it took us three down...



LEO:  We�re three down.



STEVE:  It took till the third one to get to us.



LEO:  And what a negative.  But until we took it back.��Right?



STEVE:  Right.



LEO:  And I think that that�s the thing, is we�ve taken it back and made it something positive.  But I think it was for a long time, it�s, ugh, a geek.  Now, I don�t know - I have to really see if they have - let�s see.  See also nerd.  A stereotypical, archetypal, and frequently used informally as a derogatory designation, refers to someone who passionately pursues intellectual or esoteric knowledge or pastimes rather than engaging in social life.  So, you see, there is a difference.



STEVE:  Yes, there absolutely is.  And you�re right, it is the sort of over-the-top fanatical fan person certainly fits in that, yeah.



LEO:  A nerd is often excluded from physical activity and is�also considered a loner, or often considered a loner by peers.  Dr. Seuss invented the word "nerd," did you know�that?



STEVE:  It�s a perfect Seuss word.  When you think about it, just that�s beautiful.



LEO:  In "If I Ran the Zoo," the narrator, Gerald McGrew, claims he would collect "a nerkle, a nerd, and a seersucker, too."  So there you go.



STEVE:  I confess to really being enamored of Dr. Seuss when I was that age.



LEO:  Me, too.  And that makes us nerds.



STEVE:  Those wacky machines.  I just loved those bizarre Seuss machines.



LEO:  Oh, yeah, absolutely.



STEVE:  Very neat.



LEO:  So a little more than we ever cared to know about nerds versus geeks.  So do you have any errenda or adata - errata or addendum?



STEVE:  Before I get into specific Mailbag issues, because this is our - with our modified formula, this episode has survived as our Mailbag episode.  First of all, a ton of this is about CAPTCHAs, that is, about our prior week�s Episode 101, because the response was just fantastic; but not only because of the fun stuff we had talking about CAPTCHAs, but also my own personal discovery - in many cases, I don�t know, I guess a few people knew about it among our listeners, but of that PayPal security key.  I got a ton of responses from people who noticed that during our recording, Leo, we couldn�t find the location of the key.  And I actually think...



LEO:  It was on your front page, but it wasn�t on mine.  That was the problem.



STEVE:  Right.  And so on the show notes, my show notes of 101, and I moved it also into this week�s show notes, up at the very top of the page is a link directly there.  Or it turns out it�s just paypal.com/securitykey.



LEO:  Well, that�s easy.  That�ll do it.



STEVE:  Yes.  That will take you directly to that page.  And so I wanted to make sure people knew where it was because there were a lot of people who - in fact, some thought that maybe we had slashdotted them, which is of course the industry term for drawing so much attention that they ran out of keys, because many people reported - actually I think it was only our Canadian listeners reported that PayPal was saying that the key was not currently available, I think was the exact language.  And so they thought, well, what, did they run out after Steve and Leo talked about the PayPal security key?  But I believe it�s just a Canadian exclusion for reasons that are not immediately clear, although I do have some Mailbag comments about that.  So I wanted to clarify that.  Also I had one really fun little SpinRite story, but it�s so horrendous in one particular way that I�felt I had to compensate with a second little quickie.��So...



LEO:  One happy, one sad.



STEVE:  You�ll see what I mean.  Well, they�re both good news; but, well, anyway.  So Michael Cann in Melbourne, Australia, and I put in here in parentheses "has plenty of patience," which I added.  He says, I run a small business in Australia fixing computers called The Computer Surgeons, and recently we had a customer who worked from home as an accountant who kept all his clients� bookkeeping records on his PC.  And of course we already know where this is headed.  His PC as at least seven years old, and his hard drive had decided to cease working.  He also had no backup from within the last six months.  So I quickly hooked up the hard drive to another PC, whipped out my copy of SpinRite, and hoped for the best.  Ha.  He writes...



LEO:  Why do you laugh?



STEVE:  Well, it was a long haul, but good things come to those who wait.  Three months and six days later I was able to recover all of his clients� files, and some files that he didn�t even know were there.  He now is recommending me to everyone he knows.  He says, thanks, Steve.  You and SpinRite made my customer�s day.  It has been one of the best investments I have made.  Regards, Mick the Computer Surgeon.  So I thought, okay, three months, that�s a little extreme.  But, you know, the guy apparently, I mean, who knows what happened to his hard drive.  But it must have really been in serious shape.  But on balance, Jeff Harrison in Kentucky wrote, I recently purchased SpinRite based on listening to it being discussed so much on the podcast.  I support our office and mobile users in my job and recently had one of our laptop users have their drive completely fail.  Of course they did not have any backup of their data, even though we had provided instructions and even USB drives to help them do it.  I decided this would be a good test for my new purchase, since I haven�t needed it yet.  It ran for about 1.5 hours.



LEO:  That�s not bad.



STEVE:  Exactly, and was able to recover all but one of the files.  And even then I was able to get the backup file that that application creates.  So they only lost about three days� worth of data in this one particular file, much better than losing everything.  I was happy to know that SpinRite works as advertised, and the user was happy to get their data back.  I enjoy the podcast and look forward to it each week.  Keep up the good work.



LEO:  Isn�t that nice.  Now, where was the horrific story?



STEVE:  No, it was the first one.  The first one ran - this thing cranked for three months and six days.



LEO:  Oh, I missed that part.  Three months?



STEVE:  Three months it took.



LEO:  Have you ever heard of it going that long?  I mean, the patience that person had.



STEVE:  Yeah, well, and it recovered the drive, and he got everything back.  So, as I said, he must have done something horrendous to the drive because SpinRite just worked and worked and worked.



LEO:  I must have - my mind mustn�t have accepted the three�months.



STEVE:  It couldn�t have been three months.



LEO:  I must have - I heard three days.  You said three months, six days.  That�s unbelievable.  What, he put it somewhere and just ignored it for three months?  Wouldn�t you have given up after a few weeks?



STEVE:  Well, I guess he must - well, you know, he�s a computer guy.  He runs this Computer Surgeons operation.  And he said he took the drive and stuck it on a PC.  So he has boxes around.  And probably he was curious, too, to see what would happen.  And so three months later he calls the guy up and says, hey, I got all your files back, and some you didn�t even know you had.



LEO:  Unbelievable.  So you knew that it could run that long?  Did you know that?



STEVE:  Oh, yeah, it�ll run until it�s done.  I mean...



LEO:  What�s the longest you�ve ever heard?



STEVE:  That�s pretty much up there.



LEO:  Got to be it.  I can�t believe it.  So what�s it doing for so long?



STEVE:  When SpinRite hits a troubled sector, as I mentioned in last week�s podcast, it will sit there and do everything it possibly can to recover the sector.  And that may take as many as - it�ll try up to 2,000 times in the so-called DynaStat mode, the Dynamic Statistics mode that SpinRite switches into.  And the specification states that after a failed read it is necessary to reset the whole hard drive�subsystem.



LEO:  Ah, okay, that could take a while.



STEVE:  Oh, it does.  And so it�s one of the things that�s really frustrating is that you really have to do a full reset in order to know that the next read could succeed.  I�ve been so tempted not to do that reset.  But then I�m not sure that the drive would actually fully recover from the prior failure, so maybe I would never really be able to catch the sector.  And my feeling is that I�ve got to follow the spec in this case.  So actually it�s not reading, like, boom boom boom boom boom boom boom boom boom, 2,000 times.  It�s reading, and it�s going through a complete upheaval reset before I�m really able to conscientiously try again.



So it does, I mean, it can run slowly on a drive which is really in trouble.  Some people have asked is there a way to speed that up.  In fact I did read a piece of email since I mentioned this last week who said, boy, you know, I don�t want to wait for 2,000 reads on a drive that is heavily damaged.  Is there a way to speed SpinRite up to get it past, like, a really bad part like that?  And you could do a couple things.  You can interrupt it at any time and then notice what percentage of the drive you�ve completed - and that�s accurate, by the way, to four significant digits - and then move SpinRite manually past that spot.  Or, if you have something where you have an editable medium, meaning a floppy drive or a USB dongle that you�re booting, SpinRite does accept a command line option.  You say SpinRite space  DynaStat space and then the percentage.  The normal default percentage is 100, that is, you�re running DynaStat at 100 percent.  But you could set it to 10, and it would only do 200 reads; or you could set it to 1, and it would only do 20 read attempts.



LEO:  Oh, interesting.  Oh, okay.



STEVE:  So you are able to sort of scale that up and down, if you really want to.



LEO:  Three months.  That�s kind of unbelievable.



STEVE:  Patience.



LEO:  And one hour, that�s a lot better.  But it is usually somewhere in between those two times.



STEVE:  Yeah, it�s normally a few hours.



LEO:  Yeah.  And I�ve run it overnight many times.



STEVE:  Yeah.



LEO:  That�s fine.



STEVE:  And that�s pretty much typical.



LEO:  Yeah.  Well, as drives get bigger, right.



STEVE:  So get a load of this.  Bob, whose last name I have, but I didn�t know that he�d want me to use it, so we�re just calling him Bob, is in San Jose, and he works for PayPal.  He says:  Thanks for the recent plug for the PayPal Security Key.  I�m the product manager for the program.



LEO:  Oh, that�s great.



STEVE:  I�ll be happy to answer any follow-up questions you may have.  Response to the program has been very positive.  It recently came out of beta in June.  Although I think mine�- I think when I got mine a couple weeks ago it still, I mean, I think it was in July, or maybe it was at the very end of June, and I think it still said it was in beta.  But anyway, he says it�s out of beta, and we�re planning marketing campaigns to let more users know about the program.  Which is a good thing because, you know, you were unable to find it, Leo, even when I told you where it was.  And in fact many people went on a hunt.  I mean, I think our mention of this certainly gave PayPal a boost because it�s such a cool thing, and it�s $5 to have this really neat security dongle.  But you really have to dig around.  And so I want to acknowledge all the listeners we have who sent in detailed navigation instructions for how to find this page, which apparently you can also go directly to, just by doing paypal.com/securitykey.



I wrote back to Bob and said, hey, the response has been fantastic from our own Security Now! listeners; and I�ve invited him to jump onto the show, maybe next week, to spend 5, 10, 15 minutes with us talking about this and answering some further questions.



LEO:  Oh, that�d be great.  I haven�t gotten mine yet, but I�m looking forward to using it.  And it�s a great way, for those who didn�t hear the show, you can now get one of those security dongles that generates new passkeys every few seconds, or few minutes, I�m not sure how often it is.



STEVE:  Every 30 seconds, I believe.



LEO:  30 seconds.  And you add that to your PayPal password to give you double factor authentication.  And really, I mean, that is a great idea.  No one can hack your PayPal account at that point.



STEVE:  Yeah.  I just, as a matter of fact, well, they�re unable to hack it from a position of...



LEO:  From logging in.  They can�t hack your password, let�s put it that way.



STEVE:  Exactly.  I mean, even if you had a bad password, your last name or something really, really obvious, like "password," your password could be "password."  But the addition of six digits to the end of it, which is the way you log in - oh, and by the way, I forgot that the other day, and I logged in just with my normal password.  And, well, what it did was it took me to a separate screen because it knew that I had now authorized myself to use and require the PayPal security key.  And so I got an intercept screen saying please type in the six digits currently showing on your security dongle.  So it�s like, oh, good, if I don�t - you can do it all in one phase by adding those to the end of your password.  But if you forget, then it�ll just say what�s your current six digits.  And of course if a bad guy ran across that, he�d think, oh, well, I�d better go somewhere else because I�m not going to guess some six-digit number that�s changing every 30 seconds.



LEO:  Yeah, I�m looking forward to getting it.  I worry about what happens if I lose it or I don�t have it with me, et cetera, et cetera.  But better to have that security.



STEVE:  It�s funny, too, Leo, because that�s exactly what I was feeling, too, when I authenticated myself and committed to always having it.  Because first it was sort of a cool thing to have.  And then I thought, okay, well, what�s the point of having it unless I lock it into my PayPal account, which you�re able to do separately from receiving it.  And then I thought, okay, but if I do this, then I just can�t use PayPal randomly wherever I am.  It�s like, yes, Steve...



LEO:  That�s the point, Steve.  I guess I�ll probably not keep it on my keychain because that�s too heavy.  I already have, like, 83 things on my keychain, including some keys,�actually.



STEVE:  Well, and we�re going to have some great Mailbag comments about that, too, so...



LEO:  All right, I won�t say anything, then.



STEVE:  Okay.  So Phil Aylesworth in Windsor, Ontario, Canada says, sorry about the email yesterday - that apparently he sent me - about the PayPal security key not being available.  A Google search reveals that it is only available in the U.S., Germany, and Australia right now.  Of course I said he�s in Windsor, Ontario.  He says, I�m in Canada.  I guess other countries don�t need the extra security.  And then he�s got a frowny face here.



LEO:  It�s probably, you know, this is encryption.  There�s just probably some export restriction, I would guess.



STEVE:  Yes.  And hopefully Bob who�s the product manager will know - I�m sure he�ll know exactly why.  And he says, it would have been nice if PayPal had told me why it was not available.  And in fact that would have been nice for hundreds of people who wrote to us, Leo, saying what happened?  It says it�s not currently available.  So, yeah.  So I hope we�ll get a definitive answer.  I presume you�re right.  But if it�s Germany and Australia, that seems - it seems strange that Canada would say no, or somebody would say no.



LEO:  It does seem odd.  I don�t know.  That is odd, yeah.



STEVE:  We�ll get the whole scoop, and we�ll let our listeners know.  Jim Kramer, who�s a listener, says I just wanted to let you know, I�ve also been - I just wanted to let you know.  Okay, that�s how he starts.



LEO:  Period.



STEVE:  I�ve also been very interested - oh, oh.  I�ve also been very interested in how the brain works and read Hawkins�s book - Jeff Hawkins� book that we talked about, "On Intelligence," last week - as soon as it came out.  I also bought the audio version.  I agree, it�s very well done.  I�ve been actively looking for information about how the brain works and have found many good pieces of information.  None, however, are as good as the information from Hawkins.  I recommend you check out the following videos after reading the book.  And then he has - he provided three links which I followed.  And each is to a really interesting presentation, very different from each other, and about an hour long each.



So obviously I can�t, I mean, these are links from hell, I mean, these are not links that I can even attempt to verbalize.  So for anyone who�s interested, they are on my episode notes page for this episode, 102, are the three links from Jim Kramer.  One is on the Numenta site itself.  I think the other two are Google videos.  So anyone should be able to watch them.  And they�re definitely interesting.  They�ll make much more sense after you�ve got the introduction that Jeff provides in the book.  But it is, you know, for somebody who�s not interested in reading a book, or if you�re curious about more of the content or what his whole HTM, the Hierarchical Temporal Memory architecture is, the videos will be a quick way to dip in.  And then you could decide, hey, I really want to start at the beginning and then read and understand this stuff.



LEO:  Yeah, it�s great.  When I talked to Donna Dubinsky, who�s his partner at Numenta and my Yale classmate, about it, she mentioned there�s a good white paper also on the Numenta site about what they�re up to, their specific implementation here.  So that�s also another place to look.



STEVE:  Oh, cool.  I�ll see if I can find that and link to�it.



LEO:  She said read that white paper before you interview Jeff.  You�ll have a very good idea of what we�re up to.



STEVE:  So listener Peter Lilley in Sydney, Australia, he prefaced his note saying is it safe to go without AV if you "know what you�re doing."  And of course I have sort of suggested that a number of times over the last year and a half, Leo, coming up on two years here.  He says, I wanted to share an anecdote from a few weeks back as it relates to something that�s come up on Security Now! a few times.  I�ve been working in enterprise software for some 15 years and consider myself pretty careful and conservative when it comes to security online.  I�m the sort of person who checks certificates, never opens attachments I wasn�t expecting, et cetera, because I don�t like inviting unknown people to come play on my computer.



So recently I was looking for information about a new component for my home PC online, using my wife�s laptop.  I visited the website of a large and reputable manufacturer, then clicked a link to get more info about a certain product.  Okay, so that took him to - he went from this large, reputable manufacturer to a specific product�s website.  Immediately avast! alerted me to a virus on the laptop.  I hadn�t downloaded any file, followed any external link, or clicked yes on any dialogue.  I simply viewed the page.  At first I didn�t think much of it and assumed the issue was with the PC and not the site.  I simply invoked my usual remedy of rolling the PC back to a disk image that I knew was okay, ran a virus scan, and all was good.  While all that was happening, I broke out my work laptop to continue my surfing.  I visited the same site and immediately Symantec corporate edition reported the same virus, now on my work machine.  I don�t remember exactly which virus it was, but my investigation into the virus indicated that it was some unpleasant file infection.  The infected file was in my Internet cache in both cases, meaning the actual file on the web server was infected, and I was downloading that file simply by looking at the page.



A moment of panic ensued.  I do not run any AV at all on my primary machine, as I, like you and Leo, believe my safe practices should be the best protection.  It seemed likely that I might have visited that manufacturer�s website from that machine at some point, so I ran a scan via the network, and, yup, that machine had been infected, as well.  Now, I have no idea how long that machine had been infected or how much time would have passed before I discovered it had I not happened to be using my wife�s laptop that particular afternoon.  I now run AV on all machines (by the way, I discovered NOD32, which is apparently written mostly in Assembly and feels very light) - and of course that�s one of our favorites, Leo - as I no longer believe that simply being mindful and playing safe is enough.  I guess the lesson here is even sticking to the reputable places on the web and being mindful of the dangers is quite - I think he missed a negative.  He says, I guess the lesson here is that even sticking to the reputable places on the web and being mindful of the dangers is not quite enough.



LEO:  Well, of course, in order for something like that to�happen you have to have a hole in your operating system;�right?



STEVE:  Well, yes.  What it probably means, given that...



LEO:  Well, of course if there were an infected image...



STEVE:  That�s what I was going to say.



LEO:  Yeah, go ahead.



STEVE:  And you�re right.  It would be an image which is exploiting, and of course there have been image-based exploits before.  I think there was a JPEG parsing error in�Windows...



LEO:  And the problem is it�s not just Windows.  It was in the Windows - the Visual Studio library file.  So it extends to many apps.



STEVE:  I think it was the GDI Plus file, if I remember.  And you�re right.  So in that case just viewing that image, which of course any browser will do, I mean, most users certainly do surf with images enabled, even if they�ve got Flash disabled and scripting disabled and everything else, generally you�re going to be surfing with images.  And so you�re right.  It would only be a problem if that was a known - if it was an unknown exploit that was - or unknown vulnerability that was being exploited, or if you had not patched your machine and then your browser displayed that. So, I mean, he makes a good point.  And that�s why I took the time to read his rather long note is, you know, going through his anecdotal report, here�s an instance where all of his machines had a bad image on them.  On the other hand, I would imagine that, if you and I were to scan our machines, and I don�t often enough, maybe we�d find something, you know, something...



LEO:  Well, but there�s a difference between a bad image in your cache and actually a virus infection.  In other words, that image by itself isn�t going to do anything.  It needs to inject some software in there.  And that�s my question.   He may have found that image; but if it infected his system, there�d be a trojan there, as well.  The image by itself is not the problem.



STEVE:  But displaying the image would have been the vector.  And so presumably when he went to this manufacturer�s website, he...



LEO:  No, I understand that.  But what he�s found, according to what he describes, what he�s found is a JPEG image in his cache.  That by itself is harmless.  That by itself is harmless.



STEVE:  Yes, given that his system is patched, and the image was not displayed.



LEO:  Right.  Well, even if it was displayed, if the hole was patched, which it may or may not have been, it would be harmless.  And what I�m saying is, if his antivirus only found that image, there�s two possibilities.  One, he didn�t get infected...



STEVE:  I see.  I see, right, because...



LEO:  Or the other, he did get infected, and it didn�t detect it.



STEVE:  Yes, I exactly see what you mean.  So it wasn�t also finding a trojan that the image was the entrance vector for.



LEO:  And that�s kind of one of the reasons that I am so emphatic on emphasizing behavior as opposed to antiviruses.  Because the antiviruses may have missed the trojan, frankly.



STEVE:  And behavior always protects you.  As long as you don�t misbehave.



LEO:  Right.  Good behavior protects.  You know, this has happened to Tom�s Hardware site, which is a very reputable site.  This has happened on MySpace, partly because these sites accept ads unverified from ad services.



STEVE:  Oh, very good point.  



LEO:  That�s the vector on these.



STEVE:  Anytime, yes, anytime your server has links to offsite images, you�re trusting that the image you�re sucking in is going to be okay.



LEO:  And so that�s what happened to MySpace, and they were using a service that wasn�t, you know, that allowed anybody to buy an ad.  The advertiser provided the image, and of course it was infected.  They estimate in that case that a million people got infected.  And the Tom�s Hardware, which is more recent, hundreds of thousands, they guess, because it was there a day or so.  So, yeah, that just points out that you can even go to a reliable, a presumably reliable site and have this happen to you.  I don�t know what the right answer is, frankly.



STEVE:  And it�s interesting, too, because the nature of the way this is being done, that is, the web page you�re visiting never sees that image.  The server never sees it.  The page contains a reference to the advertiser supplier.  So, for example, it�s not possible for Tom�s Hardware to somehow proactively take responsibility.  In order to do that, his server would have to be accessing...



LEO:  Serving the image, yeah.



STEVE:  Exactly.  His server would have to be serving the image and doing a virus scan of the image itself prior to offering it, which is typically not the way this is done.  Instead, his pages simply have links to that third-party server, and the user�s browser goes and does the fetch of the image.  So it�s really a difficult thing for the hosting website to take responsibility for the image content, even if it really wanted to.



LEO:  And that�s why this JPEG hole is such a significant hole, because you can patch Windows and still be vulnerable.  And it�s hard to know what applications you�re using have used that library with the flaw in it.  So it�s just a mess.  It�s just a mess.  I don�t know what the right answer is there because behavior may not protect you, and an antivirus  may or may not protect you.  I certainly don�t say don�t have an antivirus.  What I say is, don�t consider it your first line of defense.  But it�s a great idea to scan periodically, absolutely.



STEVE:  Yes, yes.  We have a listener, Nils Andersen, who comments that in our last episode, Security Now! 101, we mentioned the PayPal version of the RSA SecurID.  He says, I have a SecurID from E*TRADE, and it seems to me one SecurID should be usable on multiple sites.  I ordered the PayPal key, but I can envision a future where I�ll have a pocketful of dongles - there�s an interesting title for a song.



LEO:  [Singing] I�ve got a pocketful of dongles.



STEVE:  A pocketful of dongles, and have to hunt for the right one.



LEO:  Now, he�s a geek.



STEVE:  Yup, that�s a geek.  He says, got any information on sharing one dongle between sites?  And that would be a great question if we can get the PayPal product manager on because several people mention this.  It�s like, hey, you know, yeah, I�d love to have a dongle; but I�d only like to have one, thank you very much.



LEO:  But wouldn�t that - that would compromise your security because it would be a shared password among multiple vendors; right?



STEVE:  Yes.  Well, in fact this really harkens back to our recently discussed OpenID.  What you�d like to have is everybody using a common repository, an OpenID, and then you use your single dongle with OpenID to authenticate yourself to everybody else.



LEO:  Yeah, I like that.



STEVE:  So Bill Holton says - his subject line was "I�m still human."  And he says, I just listened to your podcast.  Actually I really liked his little blurb here.  He says, I just listened to your podcast about CAPTCHA.  And it occurs to me there�s a bit of confusion when people refer to CAPTCHA as a Turing Test.  My understanding is that a Turing Test puts a human judge in one place.  And he attempts to see if the judge can tell the difference between a computer in one room and a human in a different room.  CAPTCHA seems to turn this on its head and puts the computer as the judge and asks it if it can tell the difference between a human and another computer.  If we had the resources to put humans back into those rooms, I don�t think authentication would be a problem.  But so long as there�s the possibility that my computer is smarter than your computer, which I love that phrasing, he says there�s always going to be some way my smarter computer can trick your less smart computer into believing it�s human.  Or has this all just been some computer-generated response, he says, meaning to say he�s still human.



LEO:  Right, right.  So it isn�t technically a Turing Test; he�s right.



STEVE:  Yeah, really I thought that was kind of clever, that he�s correct in saying that we�re replacing the human judge with a computer judge.  And of course that�s the CAPTCHA server which is trying to make the decision between human and computer.  And basically you just need, you know, if you have a smarter computer, which again is what we�re talking about when we talk about all this work being done to crack the CAPTCHA, that�s exactly the case.  So I thought that was sort of a neat way to look at that.



Now, we�ve got a long posting, but I thought an important one, from Darrell Shandrow, who calls himself an "accessibility evangelist."  And it�s actually, Leo, somebody you�ve spoken with, as you�ll see.  He says, thanks for your Security Now! Episode 101 discussing CAPTCHA and multifactor authentication.  I appreciate your talking about the needs of people with disabilities, specifically those of us who are blind or visually impaired.  CAPTCHAs and multifactor authentication schemes that provide their output in only a visual format represent a clear and present danger to the blind, deaf-blind, and visually impaired.  Each time a CAPTCHA or multifactor authentication system fails to accommodate our needs, it results in our inability to participate.  At a minimum, this means a blind person can�t sign up for an account on a website.  On the other hand, it sometimes means we may be unable to make a purchase or even access the money in our own checking accounts.



Back in the �60s here in the United States we decided it was wrong to segregate African Americans from the rest of the population.  For more than 40 years it�s been illegal to deny service to African Americans in restaurants, schools, and other public accommodations based solely on skin color.  Similar protections are now in place to prevent discrimination against gender, race, religious preference, sexual orientation, et cetera.  We even have the ADA and other laws to protect those of us with disabilities, though their effectiveness is a controversial issue for quite another forum.  He says, many of us feel strongly that the way in which visual-only CAPTCHAs and multifactor authentication systems discriminate against us when no alternatives are provided to reasonably accommodate our needs for access is tantamount to the same type of segregation experienced in the past by African Americans.  Since visual-only CAPTCHA presents a clear and present danger to the blind and visually impaired, and since it is often used to protect resources we need or want to utilize, we are absolutely insistent that every CAPTCHA and multifactor authentication scheme reasonably accommodate our needs for accessibility.



It�s interesting, I�m going to interrupt here for a second, Leo, because I hadn�t considered the fact, but it�s certainly true, that the PayPal dongles and the SecurIDs that prevent a visual-only token are inherently discriminatory in that sense.  I mean, there isn�t - they don�t have a little audible speaker on the back of them, for example, that will speak out what the code is they�re currently showing.



LEO:  Yeah.  I think it�s really important to be sensitive to this.  And I think what the ADA requires in many cases is at least some form of access.  It may not be the same one.  So, for instance, PayPal is not forcing you to use the dongle, so they�re not discriminating against people who can�t see.



STEVE:  Exactly.



LEO:  But I can see that perhaps, as an example, there may be some sites that require this visual dongle.  And, you know, the CAPTCHA that I use has visual and audio, but he brings up the deaf-blind, or deaf-blind people.  And I don�t know what the answer is to that.  I�m baffled at that point, I don�t know what...



STEVE:  I was thinking about it also last week.  And it seemed to me that, as long as you have some accessible fall back, that is, for example, if you could use neither the CAPTCHA nor the audio version, then allow them to do an email loop or some less technical solution that has inherently lower bandwidth, but where at least they�re going to be able to do what they want.  If, for example, if GRC�s ecommerce system were protected by any CAPTCHAs, which it�s not at the moment because it doesn�t need it, it�s got all the ecommerce authentication there, I would certainly not want to lose sales to people who were being stopped by some sort of CAPTCHA system.  So I really can understand.



He says, at this point the state-of-the-art method of providing reasonable accommodations to CAPTCHA is, as you two - that is, the two of us - mentioned on the show, an audio CAPTCHA.  Over the past year there�s been an explosion of commercial and free products and services offering audio as well as visual CAPTCHA.  And some manufacturers of multifactor authentication schemes are now getting to the point they must become accessible.  At this stage I believe it is inexcusable for there to exist any CAPTCHA without at least an audio equivalent attempt to reasonably accommodate the needs of the blind and visually impaired.  And, I might parenthetically say, or some solution that would allow them to still use the site.  Companies like AOL, Google, and Microsoft now provide this accommodation.  And some of us in the blind community are working tirelessly to insist that others do likewise.



Aside from the privacy issue, which I don�t buy, since sighted people can also use the audio CAPTCHA, and that�s a point that I had made last week, the real problem with both audio and visual CAPTCHA and multifactor authentication is that it does not meet the needs of the deaf-blind.  Ultimately we need precise laws and regulations requiring accessibility combined with significantly more research and development to devise non-sensory schemes that can reliably tell computers and humans apart, while recognizing everyone�s humanity and discriminating against no one.  Then he says, Leo, in November of �05 you interviewed me live on TWiT at the Portable Media and Podcasting Expo...



LEO:  I remember that.



STEVE:  Yup, to discuss accessibility in general and CAPTCHA in particular.  You seemed to really understand the issue and get the reasons for the need to accommodate the blind and visually impaired.  I believe my appearance on your show, along with your linking to Blind Access Journal, helped to further spread the good word about accessibility.  Thank you for making that happen.



In January of 2006 I initiated a petition asking Google to make an audio equivalent of their visual word verification scheme available to reasonably accommodate the needs of the blind and visually impaired.  It was completely rolled out to all Google services by May of �06.  Earlier this month a blind man from Brazil started an online petition asking Yahoo! to make an audio version of their CAPTCHA available.  While Yahoo! does provide a form one may fill out to receive a call back, this promise is almost never fulfilled by the company�s personnel.  And most requests for help made by blind users of Yahoo!�s services have gone completely unanswered.  I am taking the lead in promoting this new petition and of course ultimately insisting that Yahoo! simply do the right thing by providing an audio CAPTCHA.  The petition is available at http://blindwebaccess.com.



Steve and Leo, I would ask that you mention this initiative, place your signatures on this petition, utilize your vast influence in the technology industry to convince Yahoo! to do the right thing, and that you link to both blindwebaccess.com and blindaccessjournal.com to help us attain more petition signatures and further spread the good message of equal access to technology for everyone, regardless of visual acuity.  I thank both of you for your time and anticipate your responses.  Keep up the great show.  Sincerely, Darrell Shandrow.



LEO:  I think most of the time Yahoo! does not have a CAPTCHA.  So I�m trying to think of where - I guess maybe it has a CAPTCHA sometimes?  I�m not sure...



STEVE:  Probably on subscribing for an email account, to prevent you from getting...



LEO:  Oh, maybe it does, automating that, yeah.



STEVE:  Yeah.  In fact, I think we talked about that last�week.



LEO:  Once you have an account, it doesn�t require it.  But I see as signing up it would.  In fact, let me just check that, out of curiosity.  Yeah, it does.  And it doesn�t - let�s see.  More info.  It doesn�t seem to have a audio version, yeah.  They really - that�s surprising, frankly.  I wish more people would just use the CMU reCAPTCHA, which has audio, and also has this additional feature, as you mentioned, of typing in books.



STEVE:  Well, yes.  And in fact, remember, too, that the benefit of that is by having everyone using a centralized source, what it essentially means is that, if bots become good at this, and in fact it�s one of the things that the servers are monitoring, the reCAPTCHA servers are monitoring the access patterns to detect whether it�s being cracked.  And the beauty is that they�ll be able to respond immediately, and everyone using their system immediately gets the distributed benefit of not only feeding information in about any hacking attacks, but getting any benefits of upgrades to the system as any are needed.  So I will absolutely, if at some point I do something where I need to have that kind of protection, I will use reCAPTCHA and have some sort of automated second-level authentication for people who are able to use either.



LEO:  What happens with SiteKeys?  I mean, SiteKeys are very visual.  Does that...



STEVE:  That�s a good point.



LEO:  All right.  Anyway, thanks for writing.  I think that�s good points, and we all need to be aware of accessibility.  And frankly, I fall down on this frequently.  Our website is not nearly as accessible as I�d like.



STEVE:  Matthew Middleton is a listener who just signed up for his first PayPal account thanks to us.  He says, hello, Steve and Leo, just wanted to let you know that after Security Now! 101 - that was sort of a fun numbering coincidence, Security Now! 101 - I am ready to take the plunge into online shopping.  Up to this point in time I had never purchased anything online from a place that didn�t take checks that I could send them because I have heard so many horror stories from people losing money through online�purchases.



To give you some background on myself, I�m a 22-year-old software developer who spends a good deal of time listening to tech podcasts (most from the TWiT network).  So I do have a good grasp on how online security works, or more appropriately, it�s supposed to work, as very few sites really provide the security that is needed.  So my fear of online shopping is based more on knowledge than ignorance.  This, however, all changed when I heard that PayPal now offers security keys you can purchase.  As soon as I listened to SN-101, I jumped on PayPal and set up my account, ordered the key, and am now waiting for it in order to make my first online purchase.  I�d like to thank you and Leo for all the information that you provided on Security Now!.  It has helped a lot.  Not only do I know that PayPal offers security keys, but I also know why that is important.



LEO:  That�s neat.  And, you know, I get a lot of email from people who say, I can�t contribute to TWiT because I don�t have a PayPal account, and I never will.  And I suppose I should look into other payment systems.  It�s just so easy to use PayPal.  And frankly, if you don�t want to donate, or you can�t donate because you�re uncomfortable with PayPal, that�s fine.  I understand.  Only about 2 or 3 percent of the listeners donate anyway.  It�s not going to - I don�t expect or hope for, even, anywhere near a hundred percent participation.  But I don�t know, I�ve looked at other systems, and I can�t find one that works as easily, so.



STEVE:  Yeah, yeah.  A listener, Robert Gauld in Aberdeen in the U.K., says, like you guys, I have a lot of problems with the visual CAPTCHAs, to the extent that I take my browsing elsewhere if I�m presented with one.  Take that, you nasty CAPTCHA.  He says, what I�m wondering is why they don�t just present the user with three pictures of things, for example, cat, dog, house, post office box, boy, girl, bird, dot dot dot and a selection of dropdown boxes to choose what each picture is showing.



LEO:  That�s a great idea because a computer would have a terrible time with that.



STEVE:  Well, except that the problem is, if the choices are limited, then the computer could be programmed to recognize each one.  And so it ends up being trivial, actually.  If you�re shown, you know, the same dog is showing all the time, or the same house, the same post office box or boy or girl, all you have to do is not even image recognition.  You just do a CRC or a hash of the GIF or the JPG which is being repeatedly shown.  A human goes through each of them one time matching up that this CRC or this hash is this answer to the question; and then, wham, you�ve got it cracked.



LEO:  You have an evil mind.



STEVE:  Well, believe me, the hackers do, too, so...



LEO:  Oh, I know, you need to.  Recently, I wish I could remember, and I can�t remember who it was, but I recently ran into a CAPTCHA that did an interesting twist on this.  But I think you�re right, this might have had the same problem.  Instead of showing you a CAPTCHA, they showed you four images.  And then below it had a key.  Now, the images change.  I�ve done it a couple of times, and so it�s always different.  But they had a key, you know, castle equals one, star equals two, and then you were to enter a number based on taking those images, figuring out the key, and entering the number.  It took some time, but it was a little more legible than a CAPTCHA.  And I presume they�re changing the numbers randomly so that it wouldn�t have this same issue, problem with yours.



STEVE:  And were the numbers in images also?



LEO:  No.



STEVE:  Okay, see, the problem is then the bot could read the text and see what the associations were.  And again, it would have it cracked, so...



LEO:  You�re right, never mind.



STEVE:  I mean, as we concluded last week, it is surprisingly hard.  Surprisingly hard to tell a computer from a person these days.



LEO:  Yeah, isn�t it funny.



STEVE:  Yeah.  Chris Ackerman is an IT manager in Plymouth, Minnesota, has an update and thoughts about AVG.  He says, I use AVG 7.5 Network Edition as my corporate AV solution.  With 300-plus users, the other antivirus (Symantec, McAfee, et cetera) have become absolute resource pigs, and the cost has become prohibitive.



LEO:  That�s true.



STEVE:  I switched from Symantec last year and find AVG to be much better, he says in all caps.  You sounded kind of upset with AVG for returning a false positive on SecurAble.exe.  AVG immediately removed it from the def�file.



LEO:  Oh, good.



STEVE:  I had SecurAble on my machine and was getting a positive hit for it.  AVG was showing it as infected with the sheur.apy trojan.  Anyway, AVG is no longer showing your program as a threat.  I�m not sure we would have received such a quick response for removal from - and he says "crappy" here - Symantec or McAfee.



LEO:  That might be true, too, you�re right.



STEVE:  Then he says, go easy on AVG.  They are the best thing going these days in the AV world.  So if I sounded upset, I apologize.  I certainly meant nothing against AVG because these false positives occur from time to time from everybody.  I certainly do appreciate knowing - and believe me, Greg, my tech support guy, will really appreciate knowing - that AVG updated their patterns, and people aren�t going to be worried that SecurAble�s got something bad going�on.



LEO:  Now, you make sure you update your virus, your�antivirus.



STEVE:  Yup.  Oh, and we had another person, whose name I�m going to pronounce Poojan Wagh of Chicago, Illinois.  He said, I heard you discuss on SN-101 that PayPal has security ID dongles available.  I wanted to let you and your listeners know that E*TRADE has offered RSA SecurID to their banking customers for quite a while now.



LEO:  Much better than a SiteKey.  Let�s all do this.



STEVE:  He says, I estimate a couple of years.  Then he�says, what would be great is if RSA/PayPal/E*TRADE would�allow you to register a single dongle with multiple�accounts.



LEO:  See, that�s the problem, because I don�t want to have ten of these.



STEVE:  Exactly.  And he says, I mean, who wants to have�both a PayPal dongle and an E*TRADE dongle on their�keychain?



LEO:  A legitimate thing.  But on the other hand, it compromises the security if it�s the same number for multiple sites.



STEVE:  Now, the only thing you could do, and there are some RSA SecurID tokens with this, and that is, they�re like a credit card with an LCD display, and they have a keypad on them.  And the advantage there would be that you could do a challenge response, so that when you were wanting to authenticate yourself, you would receive from them something to type in.  That would get mixed in cryptographically with what they know about your card and produce a result.  And so that would help to back off on that problem somewhat.



LEO:  Yeah.  Interesting.



STEVE:  Let�s see.  We�ve got, oh, this was funny.  A real quickie.  Simon in Exeter in the U.K., his subject was "Funny Error."  And he said, Steve was joking that they could clone you and get your fingerprint.  But clones and identical twins have different fingerprints.



LEO:  Oh, I didn�t know that.  You would think they�d have the same one.



STEVE:  I filed that under "good to know."  When we get to�the point where we�re cloning people, you�ll have different fingerprints.



LEO:  So your fingerprint is not nature, it�s nurture.  Or something.  Or a combination thereof.



STEVE:  It�s certainly not a pattern of cuts that I received on my finger as a child.  I don�t know.  But I guess, you know, Simon was so definitive, I�m going to take his word for it.



LEO:  I think I�d heard that about, well, I know that twins don�t have the same fingerprint, so that�s where that would come from, because identical twins are genetically...



STEVE:  And we of course know that clones are, by�definition.



LEO:  Twins, they�re twins.  Very interesting.



STEVE:  Dan in Oregon has provided us with some feedback.  He�s an avid TOR user.  We�ll remember that TOR is an acronym that stands for The Onion Router, which is a very powerful anonymizing technology where your traffic bounces through a series of publicly available onion routers.  And the technology is extremely neat and well implemented for preventing anyone from being able to backtrack those links in any feasible fashion.  So he says, hello, Leo and Steve.  I�ve been listening to you talk about IP spoofing on Security Now! and have been a user of TOR, The Onion Router, for several years.  And my IP address when using TOR shows up as the IP of my exit point from the routed network.  Which of course it would because that�s basically his public IP, that is, the IP of that router.  He says, with proper configuration you could choose to always use the same exit point and have a consistent IP that is not mine or even geographically close to me.  Your choices of IP addresses is limited, of course, to TORified systems that have a policy to allow them as an exit point from the network.  I have verified this on GRC.com, and you cannot detect my true IP address when I am TORified.  So that�s very cool.



LEO:  Okay.  Wow.  All right.



STEVE:  Steve Hiner in Phoenix, Arizona still doesn�t like biometrics.  He says, in Episode 100 I think you missed the point on one of the questions.  One of the questions was about the security of fingerprints and retina scans and whether or not we want something that permanent as a digital ID.  You came to the conclusion that it was okay because they will only store a hash of the data, so our fingerprint or retina can�t be reconstructed if a bad guy got to the data.  I don�t think that�s what the listener was concerned about.  I think his concern is that, if the bad guy got that close to the data, he could switch his hash code with mine, or duplicate his hash code into my records.  This could have two very bad results.  First, as far as the criminal database is concerned, I have become him and could get arrested for his crimes.  As far as the bank is concerned, he has full access to my accounts, since they will think the biometric information cannot be duplicated.  It would be the ultimate identity theft.  It�s already tough enough to convince a bank that you didn�t make a purchase, without them having proof that it was you because of more robust biometric data match.  What is a bank or a police officer supposed to believe, that you faked your driver�s license, or that you faked your iris?  I think you�d have a tough time proving...



LEO:  I faked my iris.



STEVE:  I faked my iris.  I think you�d have a tough time proving that your iris has been hijacked.



LEO:  I think you�re right.



STEVE:  Okay.  Well, first of all, what you would do, if it came to it, would be you would rescan your iris, which would then be rehashed, and you could then affirmatively prove that your hash was not the one in your file, and that someone had changed it.  So in fact, in this example, it actually gives you proof of identity theft rather than having less strong proof.  And again, the power is that this hash, it�s a nonreversible lossy process.  And you always keep your own iris, so you�re always able to reaffirm what your hashed value is in any given situation.  So anyway, I thought he had an interesting point, but we still are protected.  And in fact, in those examples, we end up being able to more affirmatively demonstrate to the cops that somebody else went to the trouble of pretending to be us because, you know, they don�t actually have our iris.  We can always reassert ownership of our own iris.



LEO:  Does your iris change over time?



STEVE:  I don�t know.  I hope not because then it would be a bad biometric.



LEO:  Well, it might change a little.  I know your fingerprint changes sometimes.



STEVE:  Oh, I got a kick out of this one.  Brian Hogg of Kitchener, Ontario, Canada...



LEO:  And a good friend.  He made a puppet of me, you know.



STEVE:  Brian Hogg did?



LEO:  Yeah.



STEVE:  Oh, well, you have - wait a minute.  For what purpose?  There�s that problem with voodoo, Leo.



LEO:  It�s got my perfect iris.  No, Brian is the creator of�the incredible dotBoom podcast, the video podcast with puppets.  And I�m...



STEVE:  There�s a Leo puppet jumping around some video�podcast?



LEO:  Next time you�re up in Vancouver, Brian sent it to me, I will show you.



STEVE:  Oh, cool.



LEO:  Yeah, I�m in a podcast along with - there�s a Kevin Rose and an Alex Albrecht puppet, and I think an Amber MacArthur puppet...



STEVE:  Oh, my goodness.



LEO:  ...is due for their season finale.



STEVE:  I hope I stay off his radar.



LEO:  We want a Gibson puppet.  You�re in trouble, Steve.  No, you�ll love it.  You�re just like a Muppet.  It�s very�cute.



STEVE:  Okay.  Anyway, he says, excellent show on CAPTCHAs.  I was just leafing through my spam folder, and I noticed one about Cialis.  We don�t wonder why he chose to open that particular one.



LEO:  I get them all the time.



STEVE:  But he says, it was just an email with product shot photos.  I noticed that the image itself had all sorts of visual distortion on it.  It looked like the image had been sprinkled by confetti.  Would this be the spammers attempting to subvert detection?



LEO:  Oh, interesting.



STEVE:  Isn�t that cool?  Basically perhaps by using the same method as CAPTCHAs.  And I thought, yeah, of course.  I mean, that makes - I don�t know that.  But I think his guess is exactly right, and it�s very cool.  So the spammers are doing image degradation because certainly antispam filters would lock onto the photo, a nondegraded photo, just like we were talking about before, and do a checksum of it and say, hey, any email containing an image that matches this checksum is absolutely spam.  So these guys are obviously throwing some confetti noise in the image in order to prevent it from being captured.  Or CAPTCHA�d.  Which I thought was pretty cool.



LEO:  No, they do all sorts of - if you want to know the cutting edges on this stuff, look at the spam.  These guys, I mean, because they have a lot of incentive in keeping one step ahead of whatever.  The filters.



STEVE:  Justin in San Antonio, Texas says, I think it would be great if you guys did a segment on digital signature/electronic signature technology.  Going paperless and addressing the approval process for security requests is something that would be of great interest to myself and other information security administrators.  Well, I wanted just to address the fact that we really did, Justin - we did justice, Justin, to electronic digital signatures back in our security series earlier on in Security Now!. So by all means go back and take a look at hashing and crypto stuff.



LEO:  You might want to look, though, I mean, we might want to update it because there are - for instance, Adobe Acrobat�now has a signature module in it for legal document�signatures.



STEVE:  Oh, could mean, like, legally binding document�signatures.



LEO:  Well, it said so, and it�s from Adobe, so I figure it�s probably widely adopted.  I don�t know.



STEVE:  But I guess I mean cryptographically strong.



LEO:  Well, I presume that you can�t tell because of course Acrobat does all its encryption internally.



STEVE:  Right.  For what it�s worth, I was going to follow up and explain to Justin very, very quickly that the way this is done - uh-oh.  That was somebody coming or going.



LEO:  Somebody�s calling.



STEVE:  Thought we�d lost you, Leo.



LEO:  No, I�m here.



STEVE:  Because that�s my Skype sound.  The way this is done is that you would take the document, and you would make a cryptographic hash of it, like an SHA-1 or some other strong crypto hash.  Then you use your private key to encrypt the hash.  And that is a digital signature.  And the idea then is anyone who wants to prove that the document is not changed, they acquire your public key, that is, the matching key to your private asymmetric key.  They acquire your public key because only your public key can decrypt what your private key encrypted.  So they decrypt the so-called signature and get the hash value.  They then perform the matching hash function.  And only if the document, this whatever it is, Adobe Acrobat or PDF or whatever electronic document, only if the hash exactly matches then do you know that it hasn�t been changed since it was signed, and you also affirmatively know who signed it because only the person who signed it would have the matching public key that would successfully decrypt the hash.  So that�s how signatures work.



LEO:  We should at some point look at what Adobe�s doing because as far as I know this is new in 8.  I hadn�t seen it�before, and it�s clearly for using Adobe Acrobat to distribute electronic documents where you certify the validity, and then you can sign and certify changes.  Looks like either you can get a certificate from a third party, or you can create your own certificate, which is kind of interesting.  You could certify the original document and then certify changes to the document.  It actually has a signature, like a hand signature, but I guess it�s attached probably to a digital signature, as well.  It�s interesting what they�re doing.  I mean, clearly they�re trying to set a�standard of some kind for commercial use of digital�signatures.



STEVE:  Right, right.  And it�s certainly possible for people to create a so-called "self-signed" certificate, like your own certificate, if you don�t want to get one from a certificate authority.  The advantage of doing the acquisition of a certificate from an authority is then that you�re having to prove to them that you are who you say you are, so they�re representing that this is signed, not just by somebody who claimed to be whoever they are, but that the certificate authority is saying, yes, we verified through some offline process that this person really is who they are claiming to be.  But it�s certainly not - you don�t need a certificate authority.  And so that was what you were referring to, Leo, the idea that you�re able to create, instantaneously create a certificate.  You could certainly do that because lots of code is able to create a key pair, an asymmetric key pair, one which you would keep private and use for signing, the other which you would publish and use for verification.



LEO:  Got time for a couple more, if you have a couple more to do.



STEVE:  Yeah.  We got two more, as a matter of fact, that I had.   We had actually 20.  And so we�re at - No. 19 is Will Morenz of Wheatfield, Indiana says, I just listened to Episode 100.  And about the listener who asked about the security of allowing users to enter any email when asked for a new password because the users might have forgotten the password to the email they had used.  Okay.  What he�s referring to was the question two episodes ago, remember, that somebody wrote in asking if we felt it was insecure - I think he was with a large educational, an academic environment, a university, and both students and faculty were forgetting their passwords, and then they were forgetting which email address of their many email addresses they used in order to perform the authentication loop.  So the university had taken to allowing people to enter an email address to which the authentication would be sent, along with some additional questions.  And the guy was asking do you feel that�s insecure.



Anyway, so Will suggests, why don�t they let the user verify multiple email accounts at a time, then give them a choice of those emails instead of using any.  They would also need to give them a way to deauthorize email when the user no longer uses them for one reason or another.  Of course, all of this would require that the user keep the email list up to date, but the people they�re trying to cater to might not do this.



Anyway, so I thought it was an interesting idea.  His notion was, instead of only having one email address which you register with, why not register all of them?  Then when you need to, like you do I forgot my password, please send me an authentication to my email address, well, it would send them to all of them so you don�t have the problem of having to remember which one you registered with.  I thought, well, that�s clever.  And I don�t really see that it significantly weakens the security.  It could be a one-time process.  As soon as any one of them is used, all the other ones become deauthenticated and cannot be used.  So it�s an interesting�idea.



LEO:  Yeah.  Our last email.



STEVE:  Yeah.  I end this on sort of an interesting sort of bizarre Catch-22.  Eric Sarratt of Asheville, North Carolina shares this AT&T statement on NSA warrantless wiretapping.  And this is, like, formally posted.  The AT&T statement on the NSA, issued in San Antonio, Texas on June 27th says:  "At AT&T we vigorously protect our customers� privacy and only share information as specifically authorized by the law.  The news media have carried reports alleging that AT&T is participating in an unlawful NSA terrorist surveillance program.  Unfortunately, the law does not permit AT&T to respond to those allegations.  The U.S. Department of Justice has stated that AT&T may neither confirm nor deny AT&T�s participation in the alleged NSA program because doing so would cause �exceptionally grave harm to national security� and would violate both civil and criminal statutes.  Under these circumstances, AT&T is not able to respond to such allegations.  What we can say is AT&T is fully committed to protecting our customers� privacy and would not provide customer information to any government agency except as specifically authorized under the law."   Thank you very much.



LEO:  Well, I�m glad we cleared that up.



STEVE:  Oh, yes.  We might be spying on you, but we can�t tell you whether we are or not because doing so would be bad, too.  So Catch-22.



LEO:  So I would just say assume they are.



STEVE:  I think probably, yeah.



LEO:  From that response, I think that�s the assumption;�right?



STEVE:  I think probably, yes. 



LEO:  Not that that�s a surprise, either.  Steve, you did it again.  I mean, this was a big, 20-question Mailbag, and a lot of interest...



STEVE:  Yeah, I just love our listeners.  We�ve got smart people listening, and they�re engaged and involved and have some interesting things to talk about.



LEO:  Yeah, I think it�s really good to give them that opportunity to get clarifications and so forth.  So I�m glad we�re doing that more often.  Next week do you know what we�re going to be doing, or will it be a surprise?



STEVE:  It�s going to be a surprise as much to me as it is to you, Leo.



LEO:  But we know we�ll be here; we know we�ll have a great show for you.  Episode 103 next week.  Thank you so much for joining us.  Make sure you check out the fine sponsors of this show and give them your support because they give us their support, and they make Security Now! possible.  And don�t forget, Steve�s site is GRC.com, and that�s where you can get your copies of all of his free programs, SecurAble, Shoot The Messenger, DCOMbobulator, of course test your firewall with ShieldsUP! and LeakTest, and customize your shutdown with Wizmo.  All sorts of great stuff.  That�s all for free, and then his bread and butter, the great SpinRite, the ultimate disk maintenance and recovery utility.  Even if it takes three months, six days, SpinRite can do it.



STEVE:  Right.  You use one of those old beige computers...



LEO:  Put it aside, put it in the closet, let it go.



STEVE:  Exactly.  The good news is, it�s normally a few�hours.



LEO:  Yeah.  That is definitely right at the end of the scale on that one.  Also by the way at GRC.com, 16KB versions of this for the bandwidth impaired, and a great transcript thanks to our friend Elaine, who writes this all up for us.  We thank you so much for joining us.  We�ll see you next time on Security Now!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/


GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#103

DATE:		August 2, 2007

TITLE:		PayPal Security Key

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-103.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo talk with Michael Vergara, PayPal�s Director of Account Protections, to learn everything they can about the PayPal security key effort and its probable future.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 103 for August 2, 2007:  PayPal Security Key.



It�s time for Security Now! Episode 103.  Hard to believe.  We�re just chugging along here.  Steve Gibson...



STEVE GIBSON:  Next week...



LEO:  ...from his fortress of security.  Next week what?



STEVE:  Next week, Leo, two years.



LEO:  Oh, really?



STEVE:  104 episodes, that�s two times 52.



LEO:  Makes it easy if you don�t miss an episode.



STEVE:  Yeah, I love it.



LEO:  You�re good at this.  We never even took Christmas off or anything?



STEVE:  Nope.



LEO:  That�s amazing.



STEVE:  Nope.  New Year�s, even when you�re out cruising on the water doing geek cruises...



LEO:  That�s right.  We get ahead just for those...



STEVE:  ...and Vancouver.



LEO:  You�re good, Steve.  So...



STEVE:  Even when my home is fumigated toward the end of this month, we�re going to not miss a beat.



LEO:  Are they going to tent your house?



STEVE:  Yeah, finally, the entire complex.  It�s 32 years old, and it�s never been fumigated.  So it�s time to kill off all those little wood eaters.



LEO:  Well, I�m going to just mention because you won�t, because you�re a shrinking violet, but this is happening because of you, Steve.  You actually actively lobbied the Homeowners� Association.  They needed to pass this assessment or it wouldn�t happen.  And you made a DVD.



STEVE:  It�s true, it�s true.



LEO:  A campaign DVD.



STEVE:  We made five - it�s my first experience creating a manufactured, you know, a glass master pressed DVD.



LEO:  Well, how many did you have to make?



STEVE:  500.  And we found a company that could do it in four days.  So, I mean, literally local, here in Tustin, Southern California.



LEO:  So did you make a little film that says "Why we need to tent"?



STEVE:  Oh, it was great.  I have a crystal logo, Homebrew, with little, you know, the little home moniker that I use.



LEO:  [Indiscernible].



STEVE:  And so basically it was an interview of everyone on the board, explaining everything that was needed.



LEO:  Oh, that�s great.



STEVE:  We ended up, I mean, no one believed it was possible.  But you�re right, I spent about the last four months doing little else other than marketing this thing, you know, marketing the assessment.  And we got 146 households out of 309 agreed to be assessed $25,700 each, that is, for the full 309, so we�re raising...



LEO:  That�s why you had to lobby.  That�s a big commitment.



STEVE:  That�s a big deal.  But I�m so impressed that our community understood the need for this, and so it worked.



LEO:  So we�re going to talk in a little bit to Michael Vergara.  He is responsible for security at PayPal, and I guess at eBay, too, and is the guy we can thank for the new dongle that we�ve been talking about, this little identity protection unit that gives you every 30 seconds a new log-in�number.



STEVE:  Right.  Oh, it�s neat because PayPal somehow found out about our mentioning the security key...



LEO:  Somehow?  Because they got a thousand orders,�probably.



STEVE:  Well, I hope more than a thousand because, I mean, we�ve had a lot of questions that came up.  And so we�re going to get Michael on the line here - as you said, he�s in charge of this aspect of PayPal security - to answer the questions that our listeners have asked.



LEO:  That�s really - that�s great.  And I think our listeners, like me, are just excited about trying it out because we completely coincidentally just completed this two-part piece on authentication.  And I think they were very curious to try this out.  So it was perfect timing.  It�s only $5.  We�ll talk about how you can get it and how it works in just a little bit.



Steve, any errata, addenda, letters, anything before we get to Michael?



STEVE:  Yeah, I�ve got a couple things.  One thing I thought was really interesting that I discovered, and I have an interesting SpinRite story from a very computer repair-savvy guy that I thought was interesting.  And it highlights something about SpinRite I�ve never mentioned before, believe it or not.



But the other day I was setting up a new machine.  And I needed to do some low-level packet I/O.  This is, you know, I have the technology, for example, on our GRC server for emitting packets, sort of very much like the raw socket interface.  And in fact I could have used that except it wasn�t available back when I was first writing ShieldsUP!.  It�s the technology ShieldsUP! uses.  There�s a very well-known library called WinPcap.



LEO:  Oh, yeah.  Oh, yeah.



STEVE:  Exactly.  I knew you would have heard of it, Leo.  So I went there just a couple days ago, and something caught my eye that was very cool.  There is now an AirPcap.  And there is a company, CACE Technologies, they�ve got some sort of affiliation with the WinPcap people.  I don�t know if they bought them or they�re a heavy-duty sponsor or what it is, exactly.  But the point is that this AirPcap is a USB WiFi gizmo made for sniffing what�s in the air.  And it�s...



LEO:  And you�re not talking about sulfuric acid.  You�re talking about the air of your Ethernet, the Internet.



STEVE:  The idea is that many WiFi cards cannot be put into promiscuous mode or their interfaces don�t allow you to get the whole packet, for people who really want to know what�s going on.  So for $198 you can purchase from this CACE Technologies a freestanding little gizmo.  It�s like, you know, a little WiFi unit that is a USB interface.  So it�s freestanding.  You can plug it into any system, your laptop or your desktop or whatever, and use it with a whole bunch of free and open source software.  They also, for $39.95, have this - they call it the Network Toolkit, which is all of the stuff.  I mean, even things like Aircrack that we�ve talked about, that will hack the passwords that are flying by and now do the high-speed WEP decryption to crack any password or WEP protection in about a minute.  They�ve got another one for an extra hundred dollars, for $298, that will both receive and transmit.



Anyway, I just - I don�t know what our listeners� interests are.  I immediately ordered one of these things because I - and I�ll give a report after I�ve had a chance to play with it because I just like the idea of, you know, going to Starbucks and easily being able to see what�s going on in the air around me.  I think it�s going to be fun.  And so if our listeners...



LEO:  Okay, now, we�re not saying to do this for any nefarious purpose.



STEVE:  Oh, no, no, it�s just for network monitoring and auditing and making sure that your corporate network is as secure as your IT people think it should be.



LEO:  But what it does very much underscore is the risk inherent in using an open access point.  Right?



STEVE:  Oh, yeah.  I mean, anyone listening to this podcast, I�m sure that they�ve heard...



LEO:  They know it.



STEVE:  Many of them, yes.  We�ve pounded that into them over and over and over.  And in fact I ran across a question when I was preparing our Q&A for next week that I couldn�t fit in, but it was so important I bumped it to the next one, some guy saying, hey, you know, I�m not using WEP and I�m not using WPA, I�m using MAC address filtering, and I turned off the broadcast on my access point, so I�m safe; right?



LEO:  Oh, please.



STEVE:  It�s like, no, go back and listen to some more Security Nows, please.  Anyway, for people whose curiosity has been piqued, it�s www.winpcap.org.  Or you just put WinPcap into Google, which is how I remembered where it was, and it�s the first link that comes up.  And you�ll see a little blurb over on the right that talks about AirPcap.  And you can follow the links to grab this little toy, which I think is very cool.



LEO:  Excellent.  Excellent.



STEVE:  Okay.  So getting to my little SpinRite story of the week, Steve Shank has a business.  In fact, his motto on the email that he sent was "Keeping clients� computers safe and profitable for over 20 years."



LEO:  I love it.



STEVE:  So he�s been doing this as long as SpinRite�s been�around.



LEO:  Long as SpinRite�s been around.



STEVE:  And it�s funny because his email, he�s an avid listener to Security Now!.  He�s using Thunderbird to send email.  And the subject was "SpinRite Testimonial with a Twist."  And he said, I figured I�d let you know what happened to me because it is different from the testimonials you have been reading, and I think it is important for listeners.  Also, I think it makes a good testimonial.



A client I�ve seen only once before calls with catastrophic failure.  Windows won�t boot, no safe mode, no last good configuration, just constant return to menu asking how to boot.  So I made a house call to their office.  I watched the process, and it said there was a bad Boot.ini file.  So I used the system restore disk to get to the Recovery Console and figured I�d delete the Boot.ini, then rebuild it with Bootcfg/Rebuild, then run Fixboot.  These are all MS tools accessible from the Recovery Console.  I thought I had at least a 50 percent chance this would work.  But the system would not let me change the attributes on the files so I could delete the bad Boot.ini.  In fact, I couldn�t find the Boot.ini file.  In fact, I couldn�t get a response from DIR.  Yup, no directory even.



So I took the computer back - this guy obviously knows what he�s doing.  He said, so I took the computer back to my office and ran SpinRite on it.  SpinRite said, and I don�t remember the message exactly, but this is the gist of it, that the disk was in such bad shape and had so many problems that it thought the disk was on its last legs.  SpinRite warned me to get my data off before running SpinRite, as the exhaustive testing SpinRite does might be the last thing this drive ever does.  He says, all the other testimonials you read are from people so happy with your wonderful product and how it saved them.  But this message made me feel really good.  Your program saw a possible problem and warned me off, saving my data by not running.  To me, this indicates a concern for your clients and honesty and integrity which is much more important than the fact that the program works when it can.  I do know that SpinRite works, he says, parens, I�ve used it for many, many years through many versions.  Then he opens parens again and says, I used to have to buy multiple licenses to use one on each client computer it worked on.  Now thankfully I can get a reasonably priced consultant license, and in my case a very inexpensive upgrade to the consultant license.  Then he closes both of his open parens.  And he says, and there are situations in which it would have fixed these problems.  But here it is warning me not to continue with the program.



LEO:  Isn�t that interesting.  You knew that it would do this, of course, you put it in there.



STEVE:  Well, actually I don�t know whether I said in that message, yes.  But what he�s referring to is the Smart Data.  SpinRite polls the drive�s Smart information and interpreted it before it even started and decided that, whoa, things are so bad that this is just not safe to proceed.  And so in that case SpinRite brings up a message and says, you know, we�ll help you, but things are looking so bad here that before we even start we know this disk is in trouble.  You really ought to pull what you can off before you go any�further.



Anyway, his message ends by saying that he ended up doing what we suggested and struggling to recover files, did get important files off, and then ended up replacing the guy�s hard drive, and actually sold him a new computer because it was time to do that, too, even though that wasn�t his first�choice.



LEO:  So there�s a case where Smart Data actually is of�value.



STEVE:  Yes.  There�s an all-or-nothing flag that Smart is able to bring up that says, I am in serious trouble.  And in fact some BIOSes check for that.  I know that there are people that have said, hey, my BIOS just told me my drive�s about to fail.  And that�s what the BIOS was doing was turning on the Smart Data and checking the BIOS.  Unfortunately, not all of them do that.  For example, this customer�s BIOS didn�t.  The drive had to go belly-up first.  And what�s really sad is that, you know, if anything had been run on this drive before it went belly-up, then that problem could have been found early enough to make the recovery much more easy.  So anyway.



LEO:  Very, very interesting.



STEVE:  Interesting spin on SpinRite.



LEO:  Before we get to our guest, again, Michael Vergara, any other thoughts, comments, suggestions, corrections?



STEVE:  I think we�ve got - we have a long conversation with him, so let�s get into it.



LEO:  All right.  So Michael�s on the line with us right now from PayPal�s headquarters.  Where is that, Michael?  I don�t know where that is.



MICHAEL VERGARA:  It�s in lovely San Jose, California.



LEO:  Oh, all right.  You�re kind of in the eBay building,�then.



MICHAEL:  Actually eBay has two campuses.  There is the South Campus near Campbell.  That�s where most of eBay is located.  And then we�re in the North Campus, which is right off 101 and 87, right near San Jose Airport.  And a lot of the PayPal people are there.



LEO:  Is your job a new job with PayPal, the Director of Account Protection? 



MICHAEL:  I started about a year ago; so, yeah, I would say it�s pretty new, dealing with really the authentication and now verification.  So it�s dealing with these new, cool devices like Security Key, as well as working on other products and policies we need to have to help reduce the phishing threat that many of our customers face.



LEO:  Was that what your mandate was a year ago when you�started? 



MICHAEL:  Yes, really to look into that, how do you create the right policies and products to do that, move it around, and make sure that our customers have both the education as well as products they need to be safe on the Internet. 



STEVE:  So of course this all began when I happily discovered that I could get the Security Key for my existing PayPal account.  And essentially we had talked a few weeks before about the whole multifactor authentication thing.  And it�s like, hey, for $5 I can add this to PayPal, which has been a revelation, and our listeners have just gone nuts over it.



One of the questions that came up was that some people were just being told that the key was unavailable.  They had thought, well, maybe our mentioning it on Security Now! had slashdotted PayPal so there were no more keys to be had.  But apparently it�s only available in some regions? 



MICHAEL:  Yes.  So let me give you a little background on what we�re doing with Security Key.  Security Key actually works on both your PayPal or eBay account.  You can use it on both or either one of those two combinations.  So it is truly a eBay, Inc. solution.  Also we have just been in beta up until eBay Live, which was last month.  So we�ve been pleasantly surprised by the amount of interest, the amount of customers out there like your audience that has come to us and said, please, I�m really interested in this.  Please, I want one of these type of devices.  Now, as any good kind of beta, we want to test the market, making sure that there is no bugs in the system, we have the right messaging or infrastructure.  We only ran the beta in three countries, that being the U.S., Germany, and Australia, to make sure we had good geographic distribution throughout the world, different shipping issues, different language issues, et cetera, et cetera.  And we went live in those three countries now.



So right now, regrettably, you have to live or have an account in one of those three countries in order to get one of the Security Keys.  But next year we will be expanding the footprint to offer more countries.  So I can�t promise you exactly right now how many countries it�ll be, but the goal is to whatever countries show strong interesting getting this, we will be working with our individual units in those countries to expand this program to them.



LEO:  I suspect you�ll see a lot of interest from Canada.



STEVE:  I was just going to say, Leo...



MICHAEL:  Yes.



STEVE:  ...our Canadian listeners will really be happy when we add them, so. 



MICHAEL:  Yes.



LEO:  Can you describe, Michael, just for those who didn�t hear us discuss it earlier, what we�re talking about here, and how it works? 



MICHAEL:  Sure.  Security Key is what they call OTP, or a one-time password type of device.  It is a little piece of plastic that has an LCD display and a secure chip and processor inside of it that gives you a random code every 30�seconds.  So if you think about it, think of it - the best analogy is to say it�s like a PIN that you would add to your normal username and password.  So a fraudster, a bad guy, needs to both steal this physical device from you, as well as steal your PIN, in order to be able to access your account.  So it�s the second factor is something you have, this little device, plus something you know, which is your normal password.



LEO:  So a couple of things came up for me.  I�m using one.  I know Steve got one.  And I love the idea because I have to say I have a lot of money - probably shouldn�t say this publicly.  But I have a lot of money in my PayPal account.  That�s where donations to TWiT go.  And basically, because I get interest on my PayPal account, I use it as a bank account.  Probably, again, not a good - well, all right, good, you don�t mind that, then.  But as a result I think the added security is great, and much better than a SiteKey or that stupid stuff that Bank of America is doing.  I frankly trust you now more than I do BofA.



But a couple of things come up.  What if I don�t have my dongle with me?  And in fact that happened to me last night.  I wanted to pay for something, and you ask for secondary information.  You say, you know... 



MICHAEL:  Yes.



LEO:  ...the secrecy, the security question.  Is that a kind of, I mean, in a way does that not undermine the power of the dongle? 



MICHAEL:  As you said before, you know, we�ve earned your trust over the years.  We�ve shown that you can leave money in your PayPal account, and therefore you know it�s trusted.  No one�s ever broken in and stolen, you know, into our network to actually steal all of our accounts.  So Security Key, you think of it as an extra layer of security.  It�s an extra protection if you have that concern or if you do a lot of traveling and maybe need to access in a lot of public networks, or if you�re having your computer go on the Internet to a lot of places that may get a lot of viruses, it�s probably a good way to have that extra layer.  But we don�t want to make it so onerous that you can�t use your account because you left your key at home.



LEO:  Which was - I was grateful because I leave my key at the office, and I was able to use it. 



MICHAEL:  Yeah.  But right now we�re just...



LEO:  But in other words it�s not really any different, though, than the way it�s been before because, I mean, if I forgot my password I could go through many of these same�steps. 



MICHAEL:  You could right now.  As we get feedback, and as we get a better understanding of our customers� acceptance and usage, we may be, you know, updating and changing some of those flows where you don�t have your key.  But right now we�re still, as I said, only in three countries right now.  And that�s kind of one of the reasons we�re limiting our launch in three countries is to get feedback.  Already our German audience has given us some feedback on this same process that we�ve made some tweaks based on their requests.  So we�re still kind of in that first step.  We�re only one month out of beta.  And we are making adjustments based on feedback like yourself.  So... 



STEVE:  I thought I remembered that the process of purchasing without the key required a telephone call from�PayPal to a phone number that was registered with our�account. 



MICHAEL:  That is one way we can do it.  There are different methods we can use, depending on what information you may have on file and what is your risk profile.  So there�s not a one-size-fits-all type of approach.



LEO:  Ah, I see.  So because I have a - I�ve been good, or my account hasn�t had a problem, you were a little more flexible with me than you might have been with somebody�else. 



MICHAEL:  Yeah.  So we have a variety of mechanisms we can use if the customer says, oops, I forgot it at home.  And that may be risk of transaction, risk of the profile.  There�s a lot of things behind the scenes we�re doing to do that.  And we�ll keep on - we will keep changing that mix to�improve it to make sure customers have a rewarding experience that is very secure, as well as doesn�t hinder just the needs they have to have.



LEO:  Well, it underscores the difficulty of doing something like this because you do face this convenience factor.  And anybody who wants to improve security then faces pushback from customers who say, but it�s inconvenient. 



MICHAEL:  True.



STEVE:  Yeah, the other, I mean, like, most often asked question we had was, hey, I really love this, but I have an E*TRADE account, and I use the same thing with them, and now I�ve got two.  And am I going to end up with a keychain full of dongles that I have to drag around with me everywhere I�go? 



MICHAEL:  I�m very familiar with the whole necklace problem, as we would call it, where you have too many key chains.  So one of the nice things about it, and one of the things that excited us most about Security Key, is we�re one of the leading members of the VIP Network, which is - we�re using VeriSign.  VeriSign is a provider and provides infrastructure for Security Key.  So other companies, other banks, other financial institutions may be involved.  So right now you can use our token on those other institutions.



LEO:  Oh, I like that. 



MICHAEL:  And so, you know, your same - so say whatever bank you want, whatever Web 2.0 company may be using it, any kind of institution you will be able to use this same token, and vice versa.  So if you go to Bank X, and they issue a token, you can use that along as a VIP token on our system, and you can take ours on theirs.  So we are eliminating the necklace problem because you should only have one token for all the VIP Network.



LEO:  That�s great.  So it�s kind of like a Plus Card network or so forth where people have all agreed to be�participants. 



MICHAEL:  That is correct.  So it is a very similar approach to establishing infrastructure so that everybody can confirm your identification and your strong authentication no matter whose dongle was issued to that.



LEO:  Well, I have to say I wish BofA would do this instead of this stupid SiteKey, which I know is insecure, doesn�t solve phishing issues because of man-in-the-middle attacks, and is a pain in the butt.



STEVE:  Well, and you know, Leo, the other thing that I remember is VeriSign is being aggressive with their support for OpenID. 



LEO:  Ooh, this could be an OpenID key at some point.



STEVE:  Exactly.  I mean, that�s what this means.  If VeriSign would be an OpenID authenticator, then that means that it�s not an expensive proposition for websites to begin to support this technology for authentication.  I mean, using the same dongle that, you know, we got for $5 from PayPal.  I mean, this is a major win. 



MICHAEL:  So, and I can�t speak for VeriSign, I�m not their employee.  But the goal is, you know, right now the VIP Network is a federated network, so you can use your identity and share that across multiple sites.  As that grows, and as we prove to customers this is the value you should have, this is why you should adopt it, then you really get excited because you can open it up to new things like OpenID or CardSpace, something else, because all of those models fit very well with a federated infrastructure.  So, again, the first step, I�m very excited by these new federated models; but we�ve kind of still got to prove the first step, customers want to use it, I prove to you, everybody else that this adds value.  Then once I do that, all these new great doors open up.



LEO:  I know our audience understands the value because we�ve done a whole two podcasts on multifactor authentication.  What has been your experience with the public at large?  Do they get this? 



MICHAEL:  We�ve been very surprised.  Again, so I�ve been in security for a while.  And I was coming in thinking that the interest, especially in the U.S., would be pretty small.  However, we�ve been kind of almost blown away by the amount of customers that have been really interested and excited by adopting this and want to take part in their security, take a more active role.  I think some of it is, like, really good form factor.  I think some of it is regrettably so much phishing news has been out there, so much other education has been done that people realize this extra layer of security is needed because the Internet may not always be the safest place people think it is.



STEVE:  And I�ll mention one thing, too, that happens as the single dongle becomes more useful, is then instead of it only being useful for PayPal, it�s like, you know, the way we do things.  Then, you know, Leo wouldn�t be leaving it at home.  It�d be worthwhile having it on your main key ring because you�re going to make so much use of it.



LEO:  Yeah. 



MICHAEL:  True.  And we�re also, besides that - and Leo may,�even if we can prove the value, may still forget things�because that may be a more fundamental flaw in his�character.



LEO:  How did you know? 



MICHAEL:  But we�re looking at other form factors that you could do that would overcome this problem, too.  And that�s something else we�re trying to do some testing on now and hope to have that next year also and to have more convenient form factors that leverage and may be embedded in some of the things you are going to carry with you, whether it�s your phone...



STEVE:  [Indiscernible], yes, yes. 



MICHAEL:  You got it.  So because, you know, everybody�s life now, they don�t live without their phone next to them or their iPod or something else.  So there�s different ways you can actually, instead of having to worry about something extra, embed it in something they know people will not forget.  And that�s also how we�re trying to expand this program and reach a bigger audience next year, too.



LEO:  Can you give me an example of how it might work on a cell phone? 



MICHAEL:  There�s a couple of different ways.  You could do something as simple as sending people an SMS message, so that instead of having your little dongle pop up with that number, you SMS somebody that number if they request it.  And that�s as simple as you get the SMS message and you type it in.  And [indiscernible] that.



LEO:  I�d like that.  That would be very simple.  It delays your transaction because you have to wait for the SMS, but usually that�s pretty instantaneous.



STEVE:  Well, but also, Leo, there�s nothing to prevent that crypto algorithm from running on the phone. 



MICHAEL:  That�s number two.  Thank you very much.  Or you could download, or you could put an application on the phone or have something that could be embedded when you buy the phone that actually runs it on the phone itself.  That�s why there�s kind of - there�s a lot of different things on the phone you can do, and SMS is a very simple way to go.  But there�s a lot more elaborate, even more secure, with some of the cool things you can do if you actually place the application itself on the phone.



LEO:  I�d love to see that.  Boy, that�d be fantastic.  But that also requires universal support.  You know, again, you�ve got to get the cooperation of all the merchants and so forth. 



MICHAEL:  Well, I mean, in that case, if, you know, all the different people in the VIP Network or other kind of stuff, if your - that same - whether it�s an application on your phone or an SMS message or any other kind of form factor, it would still work.  So... 



STEVE:  Right, because the idea is basically you guys are�not doing it yourselves.  You�re using VeriSign�s infrastructure and saying, you know, we want to authenticate this person, authenticate them using whatever message that that person has chosen. 



MICHAEL:  Yes.



STEVE:  And then it�s all handled by that third party.  And�they come back and say yes, you know, this person�authenticates. 



MICHAEL:  This is - you�ve summed it up very well.



LEO:  Well, I cast a vote.  I certainly think that�s a great�idea. 



MICHAEL:  Yeah.



STEVE:  We�ve got three votes here so far, Leo.  And we�ve got 150,000 other listeners who are voting, too, so. 



MICHAEL:  No, and that�s - we�ve also heard some of the similar feedback from our customers and beta customers about different form factors they want.  And that�s also what we�re trying to do, especially if you look at other countries that may have a wider adoption of mobile, and maybe a safer, more accepted use of things like SMS in applications.  How do I craft a form factor to meet their needs?  And that�s what we�re trying to do.



LEO:  Well, I�m excited.  I think this is going to be a real boon to everybody.  How widespread is the VIP Network?  Is it the kind of thing that really kind of is going to be universal, or are there competitors, and... 



MICHAEL:  There are - there�s a lot of companies that are involved.  Off the top of my head right now I can�t tell you all the key members that are public.  I know a lot of different financial institutions here, especially in the U.S., have been interested in looking in it and are doing certain pilots.  I don�t know how many of those are actually public, so...



STEVE:  There�s a lot of stuff going on that you can�t talk�about. 



MICHAEL:  I would say that for right now, to be cautious, I�d probably say that, yes.



LEO:  Yeah, that�s fair, that�s fair.  But it sounds like this is going to be kind of a big movement.  I mean, and that�s really going to be key, I think, to adoption of this.



STEVE:  And of course we�re all hoping that there�s not going to be another, you know, Blu-Ray versus HD or VHS versus Betamax.



LEO:  Uh-oh, I think you dropped out there, Steve.  We�ll wait a second. 



MICHAEL:  We agree with that.  We think that�s the key.



LEO:  Okay.  Hold on just a sec.  Hold on. 



MICHAEL:  Oh, can you hear me, or no?



LEO:  I can hear you.  Steve dropped out for a little bit.  Restate your question, then, Steve.



STEVE:  So I guess what we�re hoping is this is not going to evolve or devolve into a Blu-Ray versus HD or VHS versus Betamax sort of battle with other people trying to contend.  I mean, from what we�ve seen so far, the idea, for example, that you guys are using VeriSign, VeriSign is a provider in this VIP Network.  And we know that VeriSign is open to, if not already being an authenticator for OpenID, it looks like this is really achieving some critical mass. 



MICHAEL:  Yes.  I totally, completely agree.  And one of the things we�re so excited by this is this is going to grow and be powerful via the same network effect that made PayPal and eBay so successful.  It�s people using it, people telling their friends, people saying, hey, I can use this same thing on multiple stuff.  So we see that same network opportunity that we�re experts and knowledgeable in taking place in the VIP Network.



STEVE:  Very nice.  Well, it just - it really sounds like we�ve got, I mean, I�m glad you guys are doing this.  It makes sense that something like PayPal would be the launch point because PayPal already is being used so extensively.  And as you said, people have been made aware that the Internet�s got dark places and boogeymen lurking around.  And so there had - as you said, there�s a tremendous need that you�re answering.  And then all of the sites where this would be nice to have but wouldn�t have enough need for it to overcome inertia and to justify the cost of a dongle just for that, they get to come along for the ride and just enhance the overall value of the solution. 



MICHAEL:  Yeah.  And that kind of - that�s the reinforced network effect we�re so excited about.



LEO:  How many of your - you probably don�t want to give out numbers of how many people have asked for this.  Or do you? 



MICHAEL:  Right now I�d say we�re exceeding expectations, but we�re not in a position to give away hard numbers.



LEO:  Right.  Mostly PayPal people, or equal number of eBay�people? 



MICHAEL:  There�s been - equal.



LEO:  Interesting. 



MICHAEL:  So there�s been a lot of people on eBay because they want to make sure their eBay account, whether they�re a seller or a buyer, you know, if you have a few employees or you�re running a shop, you want to make sure that certain people get access to your account.  So we�ve seen a good adoption across both businesses.



STEVE:  Is there any way to associate two dongles with a single account? 



MICHAEL:  Right now that isn�t - right now you can only have one account per Security Key.  We will be updating that later this year, the current plans are, so you can have multiple tokens that...



STEVE:  Beautiful.  You know, because then you have one that you always leave at home, and you�ve got one that you take with you.  And so you solve the problem of, like, leaving that one in the car or something.  It�s like, oh, I�ve got my home keys I can use.  That�s perfect.



LEO:  Well, I don�t really even want to carry it around.  That�s exactly how I�d like to do it is one at home and one at the office. 



MICHAEL:  Well, I call it my husband-and-wife problem.  So my wife and I share a PayPal account.  And, you know, we don�t want to make sure she can�t get access to our account.  So having two tokens makes my marriage better.



STEVE:  And I�m sure I know the answer to this, but it was a question that we were asked.  Somebody was a little freaked out by the fact that there was, like, a serial number on the back of the key.  And they were concerned that that was giving away some sort of cryptographic information.  And I was sure that what that meant was that that serial number referred to a database somewhere that was owned by the authenticating agency, like VeriSign.  And so given that serial number, VeriSign has the ability to look up the actual crypto information to then apply it to the time of day and determine what the sequence should be coming from the token plus or minus 30 seconds, as opposed to that number on the back of the key being in any way directly usable by somebody. 



LEO:  Well, you use that number when you first activate the�key.



STEVE:  Right. 



MICHAEL:  Yeah.  So your explanation is basically correct.  There is no personal information all about the number.  All that number does is differentiate different tokens.  Because each token has its own random piece of information put in it.  So if I lined up all of our tokens together, they�re not going to be producing the same number, you know, at the same minute because each of them has a different random number that then produces a unique number every 30 seconds.��So...



LEO:  But you need to associate that serial number with my account so you know what my number will be. 



MICHAEL:  You got it.  That�s it.  So basically it�s, well, you know, there�s a 12345 token going to issue this number now, and what�s the next number, what�s the next number after that.  And that�s how those are correlated.  So the serial number just makes sure that you can track and know what is the proper random number for...



LEO:  If I lose my key, do you just send me a new one with a new serial number?  You don�t recreate that key. 



MICHAEL:  No.  We would take that off.  So if you lost it, we would eliminate that so no one else could use it.  Plus we would give you a new one that would have a new random number inside of there that�d be producing different�numbers.



LEO:  I think this is a big step forward.  I would love to see financial institutions do this.  It eliminates the phishing problem.



STEVE:  Okay.  And how can it be $5?  I mean, that�s what�s so cool about this is it�s five bucks.  And, you know, and not 50. 



MICHAEL:  We�re not - we�re losing money.  But that�s - the goal here isn�t to try to make money on this for security element.  The goal here is how do we make sure our customers have something they can use to add an extra layer of security to their account.  And in doing that, we believe that�s in our long-term interests to do so.



STEVE:  I think that�s just terrific. 



MICHAEL:  Yeah.  And kind of...



LEO:  You�re not losing a lot.  I doubt they cost that much to make.  I mean, it�s not like a hundred-dollar device. 



MICHAEL:  So also I�ve been asked a different question.  People say, why don�t you give them away?  If it�s extra security, you should give them to everybody.  And what our studies and what our beta trial showed us was that, if you give something to somebody for free, they value it how much they paid for it.  And that people that - a large number of folks that were given free didn�t use it compared to people that paid $5.



LEO:  So essentially the $5 is just earnest money saying, yeah, I really want this. 



MICHAEL:  Yeah.



LEO:  Yeah.  That makes sense, actually.  Whenever I get free tickets, I never go to the concert.  But if I paid for it, you better believe I�m there.



STEVE:  Well, no, and I think also it saves PayPal from, exactly as Michael was saying, of just having everyone click on, oh, yeah, I want one.  And because it�s so easy to click on a button if it�s free.  And then it comes, and it�s like, oh, you know, I�ll get around to it one...



LEO:  So essentially you are giving it away.  It�s just this is a token amount to assure the interest of the customer. 



MICHAEL:  Yeah.



LEO:  Yeah, I think that�s fair.



STEVE:  And what do we know about the lifetime of the battery in this little thing, which is not changeable? 



MICHAEL:  They last, I believe, over three years, three to four, five years, something around that line.



LEO:  I�ll lose it before then, I know that. 



MICHAEL:  Yeah.  And then if for some reason a customer, like it doesn�t work, you contact us, we�ll give you a new one.  It�s not as if, you know, if you say my token was working last time, and it�s no longer working, you know, the numbers aren�t coming up, we will - you can contact our support, and our support people will issue a new token.



LEO:  I can�t thank you enough for doing this.  It just, you know, early on, you know, we use PayPal for donations to the  TWiT network.  And we�ve been very happy.  We�ve been doing that for almost, well, over two years now.  And occasionally we�ll get, and it�s not very often, but people have a long memory, and they remember the early days of PayPal where there were difficulties, frankly.  PayPal was problematic.  And I have to say I�ve been so happy with how that�s worked for us.  And it�s little things like this that just kind of�- I think they�re important for PayPal to do.  I think, Michael, hiring you, establishing this kind of office, and doing these little dongles really does make a difference in terms of reassuring people that this - and you have to because this is a new way of doing business that people don�t understand yet.  And they�re not completely comfortable with it yet.  But you�ve done a lot to raise my comfort level.  I�m completely comfortable with it now.



STEVE:  PayPal has done something else that I stumbled on recently, and I just wonder if Michael has any involvement in this.  PayPal now offers a virtual credit card service. 



MICHAEL:  Yes.  I�m not directly involved in that, but I�m aware of the virtual debit card.



LEO:  Is that a one-time number, or what is that?



STEVE:  Yes, Leo, it is a one-time number.  It�s a little app that you install, a little client that you install on your machine.  It will...



LEO:  I bet it�s Windows only.  Yeah, yeah.



STEVE:  Probably is at this point.  Don�t know. 



MICHAEL:  I can double-check on that one.  I don�t know off the top of my head.



LEO:  What�s the URL if I want to use that?  Because I actually use a PayPal debit card.  I�d prefer to use a one-time use number.



STEVE:  Oh, Leo, it is very cool.  The way they�ve implemented it, it has both a form fill-in and the ability just to ask for a one-time use credit card number.  And so it allows you, for non-PayPal sites, of course, to securely give them a number that�s only good for that amount and that time, and then never again.



LEO:  I�d be very - I would use PayPal all the time for�that.



STEVE:  Well, I mean, it�s working.  I have it.  I�m using it.  It�s fantastic.



LEO:  So I have an existing debit card.  Can I start using this other system instead, or... 



MICHAEL:  Yeah.  Basically all that does is kind of obfuscate the card.  So if you�re using that on a site that doesn�t take PayPal, the transaction would go through, but the merchant would never get access to your true...



LEO:  I love it. 



MICHAEL:  So I don�t have the URL right in front of me, so I could just email that to you later.



LEO:  I�ll find it.  We�ll put it in the show notes.  The URL for the Security Key is very straightforward, it�s PayPal.com/securitykey.  $5, you have to be a PayPal or eBay member.  I guess is it eBay.com/securitykey, as well? 



MICHAEL:  I believe so.  You can link there from either the eBay or PayPal site.



LEO:  So if you go to either one...



MICHAEL:  Yeah.  Then they�ll redirect you to the order page.  So you have to order it.  And you can order it...



LEO:  It does, in fact, eBay.com/securitykey does work. 



MICHAEL:  Yeah.



LEO:  So I have an existing eBay account.  I could probably now just link it up to my key; right? 



MICHAEL:  You just have to activate, that�s all.  If you already have the same key, you should activate it on your eBay account.



LEO:  Excellent.  Excellent.



STEVE:  Very cool.



LEO:  Now if I could just get Bank of America to enter the 20th Century.  I don�t even care about the 21st.  Just the 20th Century would be a nice start.  Then everybody will be happy.  Are they a VIP member, do you know? 



MICHAEL:  To my knowledge, no.



LEO:  Yeah, of course not.  Whatever bank is, that�s where I�m going.  If there�s a bank that�s doing this, I would go there now.  I would change all my accounts, all the money that goes through Bank of America, I will go to this new bank, I don�t care who you are, just use this key.  That�s all I ask.



STEVE:  I mean, especially with all of the pressure there is now to push people out of the offices and get them to do this stuff online.  I mean, online banking, it needs to be made secure.  I think, you know, if this acquires critical mass, it�ll end up being, as you said, Leo, it�ll be something people choose because that�s - because they�ll choose their lending institution based on the level of Internet security they provide.



LEO:  And if they start using my cell phone, I�ll move there.  So there.  Hey, Michael, thanks so much for your time.  We really appreciate it. 



MICHAEL:  No problem.  Glad I could help.



LEO:  That was Michael Vergara, who is in charge of customer security at PayPal and doing a great job.  I don�t know, I feel like I was maybe over-effusive about the whole thing.  But I just...



STEVE:  No, Leo, I don�t think so.  I think this - I think the fact that it�s PayPal that is doing this, it�s not some random, obscure website that�s trying to get people to sign up.  I mean, these guys have a strong adoption rate.  Obviously we know, from all the excitement that our listeners demonstrated when I stumbled over this Security Key, that there�s a strong interest there.  And the idea that this is going to be a federated technology, I mean, I�m now, for a future podcast, I�m going to bring myself up to speed on what this whole VIP program is and find out what it takes to - like how expensive it is, for example, to use it.  The good news is, if VeriSign is, as I�m sure I read, I remember reading and mentioning even here on the podcast before, if they are friendly to OpenID, then they would be able to be an OpenID authenticator.  And I�m hoping that means that all of this would be available for free...



LEO:  Boy, that would be...



STEVE:  ...to a smaller website.  You don�t have to be a big�- a PayPal or an eBay or some big mucky-muck.  And then you�d be able to use the $5 dongle.



LEO:  That�s be super cool.  Super cool.



STEVE:  And I want to also mention, because we did talk a little bit about the virtual debit card...



LEO:  Yeah, while we were talking I tried to download it, and I can�t.  I don�t know why, I�m on Windows, I click the button, it keeps sending me to some other page.  So it�s maybe not as straightforward as it ought to be.  But it is an application Windows-only.  I did find that out.



STEVE:  Okay, and it is in beta.  It�s another one of these things where we�re jumping onto it at the beginning.  I want to make sure that our listeners understand what this is.  You know, you obviously caught it instantly, Leo, the idea being that - and as you said, other credit card services have made this available in the past.  The idea is this gives you a one-time use, sort of virtual credit card number to use at any site, as Michael mentioned, that isn�t supporting PayPal.  You�re able to ask PayPal for a one-time credit card number, which you give the site.  The site then essentially uses, right then on the fly, PayPal to transfer the funds.  But they never get your real credit card number, which is, you know, back tied to your PayPal account.  So again, PayPal is insulating you so that you�re not having to provide your sensitive financial information.  It�s just - it�s tremendous.



LEO:  And even if somebody steals it or gets it, it�s only good once.  So it�s...



STEVE:  It�s bogus from then on, right.



LEO:  They can�t do anything with it.  Which is great.  Yeah, I wish I could use it.  By the way, apparently you don�t need a PayPal credit card or debit card to use this.  It acts as if you have one, but you don�t need one.  And I don�t - I just tried it once on this XP system.  Maybe there�s something going on with it or whatever.  But I�m going to keep trying because I�d love to get this set up and use it because, frankly, I use PayPal for everything.  I really like it a lot.



STEVE:  Well, and again, for our listeners, if you put in "PayPal virtual debit card" into Google, up come a whole bunch of links.



LEO:  That�s how I found it.



STEVE:  And you can navigate around and find it.



LEO:  Steve, we�ve wrapped up another thrilling, gripping edition of Security Now!.  Next week we�re going to do our mod 4 episode, I think.



STEVE:  Our mod 4.  And we now know that the correct formula, as you mentioned, you reminded me again, is episode mod 4=0, so we can actually have Q&As.  Otherwise we would have never been able to have another one.



LEO:  You are a nerd.  You are a nerd.



STEVE:  And it�s going to be our episode, our big Episode 104, which is our two-year mark, so...



LEO:  Excellent.



STEVE:  That�s very cool.



LEO:  I�m very pleased.



STEVE:  And then somebody�s going to say, wait a minute, you really don�t have two years.  You�re not into your - you haven�t finished, you know, until 105.  It�s like, eh, okay,�fine.



LEO:  That�s true.  That�s true.



STEVE:  Yeah, I know.  I know, we have very attentive listeners, Leo.



LEO:  All right, Steve.  That wraps it up.  We thank you so much for joining us, and we will see you next time on Security Now!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#104

DATE:		August 9, 2007

TITLE:		Listener Feedback Q&A #22

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-104.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 104 for August 9, 2007:  Your questions, Steve�s answers.



Hard to believe it�s been two years, 104 episodes.  And since Steve Gibson is an engineer and never misses an episode, that means exactly two years, Steve Gibson, we�ve been doing Security Now!.  Hello, Steve.



STEVE GIBSON:  Unbelievable, Leo.  It�s funny because people who know me have said, okay, how is Leo getting Steve to do this?  Like...



LEO:  Really?



STEVE:  Oh, yeah.  I mean...



LEO:  Well, what do they know that I don�t know?



STEVE:  Just how busy I am and, you know, that it�s - it is a - it pulls me away from other stuff.  But I really do enjoy it, and...



LEO:  Well, now I�m feeling guilty, Steve.  I had no idea.



STEVE:  Nah, no, and it�s been great for spreading the word about SpinRite.  I mean, nothing has been so good for, you know, as allowing our listeners to tell us their stories.  I mean, that�s just - that rocks.



LEO:  Well, and I know you�re committed to security.  You have been ever since you first discovered spyware on your system.  And so this really is kind of the pro bono work that you�ve been doing all along with ShieldsUP! and Securable and all that stuff.  This is just an extension of�that.



STEVE:  Oh, and I haven�t told anybody yet, not even you, Leo, but I�m working on, or getting ready to start working on, my first commercial security thing.



LEO:  Really.



STEVE:  Oh, yup.  The first - if we discount ChromaZone that was sort of a wacky screensaver that I did, the first thing seriously I�ve done since SpinRite.



LEO:  Wow.



STEVE:  I mean, like a commercial security thing that GRC will be publishing.  So, yeah.



LEO:  When you first discovered spyware, you had started using ZoneAlarm, which had just come out at the time, and you noticed something was phoning home.  And you wrote an antispyware application, didn�t you?



STEVE:  Yes.  It was related to that.  It was, you know, ZoneAlarm discovered.  And of course we talked about this last week when we were talking about leak testing stuff because that was sort of the genesis of all that.  ZoneAlarm awoke me to a little piece of junk which the Windows version of WinZip had put into my machine.  And then a couple weeks later there was sort of an erroneous report of something that sounded much worse.  Well, it wasn�t as bad as it sounded, but it was really bad.  And, you know, for that of course I wrote OptOut.  But that was free also because it was just like, okay, get this off your computer, folks.



LEO:  That�s right, OptOut, I remember that now, yeah.



STEVE:  And actually that was the genesis of the term "spyware."  As far as I know, it was when Gregor Freund, one of the founders of ZoneAlarm, and I were on the phone, we said, you know, this is spyware.  So.  What a concept.



LEO:  And you then, because it became such a big area, a bigger area than you wanted to get into, you kind of ceded the concept to Ad-Aware - to Lavasoft, and they started doing Ad-Aware.



STEVE:  Exactly, exactly.  I said, as long as you guys will agree to keep it free, like just keep a free version, then I�d really not want - this is, I mean, it�s like being in the antivirus business where every day it�s something else.  And it�s like, I mean, that just doesn�t fit my approach to things, so.



LEO:  No.  And in fact now especially you�re probably thinking, thank god I didn�t get into that business.



STEVE:  Yeah.



LEO:  Hey, let�s - this is going to be a Q&A segment because it�s mod 4.  Or to correct our formula...



STEVE:  Mod 4 equals - or episode mod 4 equals 0.



LEO:  So let�s do a little - well, actually, I�ll tell you what, let�s do the errata because I know you have a tiny little fix and...



STEVE:  Yes, I�ve got two things.  One thing, now, people can check XP, but I was watching the security updates go into XP.  You know how with Windows Update you�re able to choose if you want to do an express update or the custom.  Well, I always click Custom just because, you know, I�m me.  I want to see what Microsoft is giving my machine.  Not that I really have any choice in the matter because, you know, it�s like, okay, fine, whatever you want to do.  Otherwise it keeps bugging you about, oh, you missed this important - it�s like, okay, fine.  But I saw something go by on an XP system about CardSpace.  And I said, what?  Wait a minute.  That�s Vista.  No no no, my friend.  Somewhere along the way Microsoft has slipped CardSpace into XP, and we all have it�now.



LEO:  Oh, wow.  Now, we talked a little bit about CardSpace, but refresh my memory.



STEVE:  CardSpace is Microsoft�s single sign-on solution, sort of the Microsoft does OpenID sort of deal.  And they�ve promised to be able to use OpenID as a back end.  So CardSpace is sort of - you can think of it as the UI for OpenID, and a very nice one.  And sure enough, on all of my XP machines, I�ve looked around, trying to find one that hasn�t been updated for a while because I�m trying to think, when did this appear?  When did they slip this in?  But on your Control Panel of Windows XP there is now a CardSpace item.  And you can go in and create your own information cards.  Remember it was originally called InfoCard, but we�re thinking that there was some sort of a trademark collision or something, or who knows.



LEO:  Oh, right, right, right, right.



STEVE:  Anyway, it�s in XP, which makes it very exciting because now of course everybody has it.  Either if you�ve got XP or Vista, then CardSpace is there.  And...



LEO:  How does it relate to Passport, the old single sign-on?



STEVE:  It�s hopefully something that won�t die.



LEO:  Because I use Passport still for Expedia, of all�things.



STEVE:  Well, exactly.  Some of Microsoft�s sites do require it.  And Microsoft�s goal, of course, was...



LEO:  And Hotmail actually, yeah.



STEVE:  Well, exactly.  Microsoft�s things do.  And their goal was for it to be like the ubiquitous solution.  But nobody else wanted it.  And so we�re hoping with something as open as OpenID behind it, this could be a very nice UI.  And what excites me is it�s like, okay, well, if Vista has it, I�ll care in a few years.  But XP has it now, which means that we all have it, essentially.



LEO:  Now, how do you get to it, I mean, how do you use it?



STEVE:  I don�t know.  No...



LEO:  No idea.  It was just there.



STEVE:  Yes, no, all I know so far is, if you go into your Control Panel, you�ll find CardSpace.  And you can open it�up...



LEO:  But it�s the funniest thing, they just snuck that in�there.



STEVE:  They just slipped it in, yeah.  And I only happened to notice it because I, in auditing the things they were going to put in, I think they�ve already been fixing a few CardSpace glitches.  I don�t think I saw the actual install.  I think I saw an update to it.  So it�s like, wait a minute, XP doesn�t have it.  Oh, yes it does.  So they just gave it to us.



LEO:  I�ll be danged.



STEVE:  And if you run it, you�re able to create cards.  Now, I don�t know anybody who uses them yet.  But certainly the hope is that, if OpenID can be a back end, then that makes it completely open and documented and no charge, no one�s paying anything, and potentially we�ll be able to begin using a single sign-on solution.



LEO:  Very, very cool.  Let�s see.



STEVE:  Okay.  So that was my first goodie.  And the second one was I had a really short, fun note from a Security Now! listener who wanted to chime in that SpinRite didn�t take long for him, either.  And remember, after...



LEO:  What was that, the three-month SpinRite...



STEVE:  Kind of knocked you out of your chair, yeah.



LEO:  Yeah, when it really sunk in that you meant three months, I was like, what?



STEVE:  Yeah.  His name is Dan Morales.  And he sent a note through our GRC support email.  And he said, his subject was, "I just purchased SpinRite 6.0, and my desktop was working in an hour."  And he says:  Hello.  I purchased a copy of SpinRite 6.0 this morning, 7/28/2007 - so that was just, you know, a couple weeks ago - one day after my Dell Dimension 8400�s Western Digital 160-gig hard drive crashed during a summer rainstorm.  So maybe the power went out briefly or something.  But whatever happened, he says it only took an hour for SpinRite to blast through the hard drive and clean it up.  After an auto reboot, my main XP desktop came up again.  I was so relieved.  It saved me almost 100 gig in music files, and the first three months of pictures of my nephew.  I looked at your testimonial page, and there haven�t been any new messages put up in a while.  Actually he�s right.  I�ve been discussing them here rather than posting them online, and haven�t been duplicating them.



LEO:  You�re talking about SpinRite.info.



STEVE:  Exactly, the SpinRite.info page.  And he says, I would love to see my positive story placed on your site.  I already sent an email to friends and family to spread the word and keep SpinRite in mind in case they have any hard drive problems.  Thanks so much.



LEO:  You�re starting a SpinRite cult.  It�s the cult of SpinRite.  Spread the word.  Tell everyone you know.  SpinRite.  That�s great.



STEVE:  Absolutely.



LEO:  But, you know, when something works like that, and other things do not, I can understand why people would get kind of excited and say everybody needs to know this.



STEVE:  And you know, the thing that troubles me is I look at how much benefit our listeners are receiving from learning about SpinRite through the podcast, sort of as a side effect of their listening to Security Now!.  And I think of, like, what a small percentage of all PC users you and I are talking to.  And so think of all the systems that are, like, oh, well, sorry, reformat your drive, you just lost all of your photos from your whole life.  It�s just...



LEO:  Well, I mention it all the time on the radio show, too.  In fact, I think there�s a drinking game involved.  You know how they have drinking games?  When did the drinking games start?  I can�t remember.  But if somebody says a word - I think it was the Bob Newhart show.  Whenever anybody said, "Hi, Bob," which apparently they said a lot in that show, you would take a drink.  It�s a college kid�thing.



STEVE:  Okay.



LEO:  So there�s a drinking game for the radio show.  Apparently every time I recommend SpinRite they have a root�beer.



STEVE:  Well, okay.  I think that sounds great.



LEO:  All right.  So are you ready for some questions, Mr.�G.?



STEVE:  Let�s do it.



LEO:  All right.



STEVE:  You were really funny when we were planning this issue.  You said, okay, now, this is the one where I get to read, right?



LEO:  Well, it�s important to me.



STEVE:  Because of course two weeks ago we had - I know, I think we�re going to have you read from now on.  You can do the Mailbag, too, Leo.



LEO:  I�m a trained professional, Steve.  I don�t want to say anything, but that�s what I do for a living.



STEVE:  And it shows.  I have to have a pop filter in front of my microphone.  But you somehow manage to enunciate without blowing any wind into the microphone, so.



LEO:  You were fine.  And I think it�s kind of a good way to distinguish the two.  But we�ll worry about that offline.  Question 1 from listener David Lauery, an interesting issue, actually, he says there are open source Free SSL Certs available from CAcert.org.  And I think Thawte for a long time, till VeriSign bought them, was doing the same thing.



STEVE:  Yes.



LEO:  And he wanted to know what you think of these free certs versus the very expensive certs offered by companies like VeriSign.



STEVE:  Well, it�s an interesting issue because, okay, first of all, let�s see, there�s about nine things I want to say about this.



LEO:  You want me to count off?  One.



STEVE:  First of all, it doesn�t actually work to have a certificate issued from somebody that your web browser doesn�t trust because, as we�ve talked before, the whole idea is that when you�re going to a remote website, and you want to establish a secure encrypted SSL connection, there are basically two things you�re getting from that.  You�re first of all getting your traffic encrypted, which is a really good thing.  But you�re also getting a verification that they are who they say you are, which - that is, they are who they say they are.



For example, you go to https://grc.com because I have a certificate which I got from VeriSign.  And actually he brings up the point because I grumble about how much VeriSign charges me every couple years.  But when I�m doing this, the certificate that the browser receives from my server is checked against the list of certificate authorities that the browser already trusts.  And it checks to see whether my certificate was signed by one of them, the idea being that they�re standing behind some process they went through for verifying that GRC.com really is, that is, the person asking for a certificate every couple years - and paying for it - claiming to be GRC.com really is GRC.com.  So first of all, the problem is that these guys are giving certificates away for free.  And it�s funny, on their web page they say, and we�re trying to or hoping to get our certificate authority installed in universal browsers.



LEO:  They�re nowhere in the chain of trust.



STEVE:  Exactly.  So their certs would not be trusted.  But Leo, I wanted to verify that.  Now, if you�ve got IE around, do you have it there...



LEO:  Yeah, of course.



STEVE:  If you go to, and our listeners, too, go to with IE�- or you can do it with other browsers if you know where.  Go to the Tools, then Internet Options, then click the Content button, and then - or the Content tab.



LEO:  Oh, certificates.



STEVE:  And then Certificates.  And then choose - slide over, I think it�s the fourth tab is Trusted Root Certification Authorities.



LEO:  Yes, you�re right, yeah.



STEVE:  What I was stunned by is look at, I mean, how many there are.  A few years ago that little scroll thumb wasn�t nearly so small.  Now you can hardly grab it, it�s so, I mean, there are so many of them.  And okay, now, I just - I wrote some of these down because, for example, there�s Direccion General de la Policia is a trusted certificate authority.  The Japan local government PKI application.  ChamberSign, chambers of commerce.  TW government root certification.  I don�t know if that�s Taiwan.  The Hong Kong Post Office has a certificate in there.  Post.Trust Root.  Public Notary Root.  And even the Turk Trust Electronic Islam [Hizmet Lari ph].



LEO:  So these internationally, I mean, they make sense, they�ve got to support international certification; right?  Now, by the way, if you want to see this in Firefox, go to the, again, Tools, Advanced, click the Encryption button, and then View Certificate.  No, that�s not it.  I wonder what - oh, authorities, there it is, yeah.  View the Certificate Manager, and the last tab is Authorities.  And it�s, by the way, Steve, it�s actually similar.  They�ve actually organized it, which is nice, into subdirectories.  But same one.  Chamber of Commerce Root, AOL Time Warner, they even have the Turkish one.



STEVE:  Well, okay, now, here�s what upsets me to some degree is remember that all these things, essentially they�ve been installed in Windows, and for our browsers to access.  And it means that we will trust without any warning messages, without any exclamation points, without any pop-up dialogues, nothing, we will trust anybody who is signed by any of these people.  So inherently the more of these people you�re trusting, the lower your security is.



LEO:  Well, presumably they validate this somehow; right?



STEVE:  Well, yes.  But, you know...



LEO:  But who is Autoridad de Certificacion Firmaprofesional CIF?  I mean, who is this person?



STEVE:  And certainly it�s the case that if somebody were caught doing something shady or underhanded, then their CA root certificate would be and could be removed from Windows and from our browsers.  But, you know, just sort of that�s one of the things that I�m noticing also as I�m looking every time Windows is updating itself.  I�m seeing root certificate updates are, like, being sent all the time now, meaning more random bizarre trust is being spread around.



LEO:  Well, also they expire.  So, in fact, I�ve had this happen where the root certificate has expired, and they have to be updated regularly.



STEVE:  Yeah, but in 2029.  I mean, it�s still a problem.



LEO:  Right.  Well, the thing that bothers me a little bit more is that somewhere like CAcert, which doesn�t want to charge, can�t set this up, that they�re not in there.  It�s people who have, apparently, who charge.



STEVE:  Well, and again, remember that, along with a certificate - and this really speaks against my arguing and grumbling about how much I have to pay, I mean, I�m glad VeriSign jumps through hoops to verify me because I want them to verify everybody else.  I mean, I want the idea that an SSL certificate is signed by someone to mean something, to mean that I have some reason to put my faith in them being who they are.  And so the reason it�s sort of a concern that there�s just this bizarre list and growing list of strange authorities which have the full trust of my browser, essentially, is do they have my full trust?  I mean, me the user.



LEO:  Well, you put your trust in a certifying authority.  I don�t know who that is.  Is that Microsoft?  Is that VeriSign?  Who is the ultimate authority?



STEVE:  Well, actually that�s the problem.



LEO:  Is it Microsoft?



STEVE:  Microsoft gives the certificates to Windows.  So hopefully Microsoft has decided this is a certificate they�re willing to have Windows trust.  And clearly, I mean, this is an explosion of certification authorities in the last five years.  I remember looking...



LEO:  Oh, yeah, it was just a handful, yeah.



STEVE:  Oh, you had VeriSign and Thawte and a few other well-known companies.  Now you�ve got Hong Kong Post Office.



LEO:  Well, of course you do.  You�re sounding provincial now, Steve.



STEVE:  I don�t mean to sound that way.  But again, it�s just so much.



LEO:  And who looks at these?  Nobody.  And we presume.  We just trust Microsoft.  And Firefox does the same thing.  I want to point out you�re trusting Firefox when you use their certificates.  By the way, they have at CAcert, they have a process where you could add their certificate to Internet Explorer.  But you would have to kind of trust them on your own.  And of course since most people don�t do that, then, and you use CAcert on your website, you�re not going to be a trusted site to them.



STEVE:  That�s exactly right.  You are - exactly.  And, see, the reason Firefox is showing the same things is that it�s actually not the browser.



LEO:  Oh, it�s the operating system.



STEVE:  Yes.  These are OS-level things.  And then there�s an API that allows the browser to sort of show them to you and interface to them because of course...



LEO:  I didn�t get that.  Okay.  So it�s all the same on Windows.  I was looking at the MAC list.  And so presumably Apple does the same thing.



STEVE:  Right.



LEO:  Okay.  Security Now! listener Wes Trexler has a note about LogMeIn�s two-factor authentication.  We were talking about that on a previous episode.  He says:  During the multifactor authentication episode, and then again in Episode 101 with the PayPal dongle, I thought I�d write you about what LogMeIn.com has been doing for a few months now that I really like.  Instead of having to carry around another dongle, LogMeIn allows you to use your cell phone as a second factor.  Oh, that�s clever.  When you log in, you can have it send a code to your cell phone by text message as further security.  Do you see any issues with this�method?



STEVE:  No, and in fact that�s one of the things that we talked about in our multifactor authentication episode was that there were already some people who were doing this.  And I think it�s a very clever and a nice way of operating. It means that, again, something you have, meaning your phone, is being used as an authentication technique.  And the value of that, the benefit is that you don�t have to have - not only do you not need another dongle, or as we were saying before also multiple dongles for multiple people, but you�re using not only something you have, but something you already have, meaning a cell phone - given, of course, that you do have a cell phone.



LEO:  Well, and there�s some verification, too, with your number.  I mean, they can - I don�t know if they can, but it is - that�s your number.



STEVE:  Yes, and I don�t know whether they look it up.  I would imagine they don�t.  But certainly when you�re creating your account with them...



LEO:  That�s when they get it, yeah.



STEVE:  You say, yes, I have a cell phone.  I want added security.  Here�s my cell phone number.  And so that�s the  number their server automatically dials and sends a text message to, which you then have to read from the screen and type it into the browser, very much sort of like an email loop, but using a cell phone.  So, yeah, I think it�s a tremendous solution.



LEO:  It is possible to spoof cell phone numbers, but I don�t think you can spoof incoming, only outgoing calls.  So it seems like that would work.  It would be secure.  A lot of cell phone-based services like ShoZu use this as a way of�verifying.



STEVE:  Yeah.  The hacker would need to somehow - who didn�t have your call, would need to somehow intercept a call going to you.  And, you know, that�s certainly beyond the means of most script kiddie sort of...



LEO:  Tom Cruise could do it in "Mission Impossible," but nobody else.



STEVE:  There you go.



LEO:  Alexander Wood writing from Google Mail asks:  I reformat the hard drive on my main system every eight to nine months in order to eliminate bit rot.  Wow.



STEVE:  That�s what he called it, yeah.



LEO:  Wow.  When I do, I do a full NTFS format, usually takes over an hour on my 240-gig RAID 0 array.  It�s two 120-gigabyte Seagate drives.  System�s almost four years old now.  Does this reformat force the drive to check every sector and ensure that my hard drives will last longer?  Interesting question.  Does it help the drives in any other way, or does it in general hurt them because of the heavy-duty writing and work the drive has to do during a reformat?  The drives, as he said, are four years old.  They seem fine.  Probably mostly because they�re well cooled, mounted, on an Alphonos suspension from Silentpcreview.com, and because the computer never gets moved and is in a location with good ventilation.  I do back up to an external drive whenever I create important data.  Which is of course a very good idea.



STEVE:  Well, this is an interesting idea.  Certainly this guy is being very careful.



LEO:  He just formats every few months, basically.



STEVE:  Yeah, about every eight to nine months he does a format.  Now, RAID 0 is the spanning RAID.  So he takes two 120-gig drives, and they�re merged by his RAID controller into a virtual 240-gig array.  Now, if you do a quick NTFS format, which is an option offered when you know your drives are good, basically all that does is it just builds the file structure onto a drive which it assumes is empty and all sectors are perfect, which all contemporary drives, of course, as we�ve talked about before, because they�ve got on-the-fly sector relocation, they look perfect from the outside.  But when you do a painful, as he said, multi-hour format, what�s going on is - and this, you know...



LEO:  As opposed to the quick format which you can do.



STEVE:  Exactly, as opposed to the quick format.  And this  hails from the original days when drives were not known to present a perfect surface, that is, where they actually had defects.  Original drives, old RLL and MFM drives, had bit flags in the headers of their sectors that said the following sector is defective, don�t use it.  So when you did a so-called "high-level" format, as opposed to a low-level format which is actually a physical format of the surface, the high-level format is the thing that builds the file structure on the disk.  When you do that, the system would go out and read every single sector to check for bad flags in the sector headers, and also just to make sure that it is able to read the sector without any errors.  So that�s what�s going on for the two hours is his drive is just sitting there going tick tick tick tick tick tick tick tick tick, you know, cylinder by cylinder, reading all the sectors, looking for any bad flag bits, which it will almost certainly not find.  But it is doing a read.  And as we talked about several weeks ago, if the drive has some correction which it is applying to the sectors, which grows beyond a certain point, that will flag the sector as needing to be replaced before it gets bad enough that it�s no longer�correctable.



So the answer to his question is, yes, when he refers to "bit rot," this is what he�s talking about.  And doing a full format, a full high-level format will force the system to read every sector and allow your drive, very much like running SpinRite on it does.  And it�s why SpinRite takes hours, too, is that it just, you know, it takes that long to read that much data, suck it through the bus, even if you�re not doing anything with it.  It just takes that long to read all that data.  In the process, the drive is given the opportunity of noticing that there�s a problem on a sector that it wouldn�t otherwise have been able to notice by itself, and that allows it to spare the sector out, removing it from service.  So it�s, yeah, it�s a useful thing to do, for sure.



LEO:  In the old days of pre-IDE drives, we�d be able to do a low-level format on these RLLs and MFM drives.  You can�t do a low-level format anymore.



STEVE:  Correct.  The command is still there.  And it�s supported.  But all it does is zero the sector in most cases.  It doesn�t actually rewrite the headers, which is what real low-level formats used to do.



LEO:  So the OS format is the best you can do.



STEVE:  Oh, well, actually running SpinRite is even...



LEO:  That would be even better.



STEVE:  Yeah, it�s made for that.  And it can then handle - the problem is, if you were doing a format, and you ran across a sector that you couldn�t read, now, presumably he�s backed up all his data, he�s doing a format, and then he has to restore it.  So that�s why SpinRite is a superior solution if what you want to do...



LEO:  You don�t have to do all the backup and restore thing.



STEVE:  Exactly.  Remember, a format says I�m wiping out my entire file system, and then I�m reestablishing it.  So he�s got to do a backup.  Hopefully he wants to ver- I mean, you would want to verify the backup to make sure that you really got it because you�re about to reformat the drive that that backup came from, deliberately erasing everything.  Then you are restoring in order to put everything back.  So, you know, SpinRite essentially folds all that into a single operation and certainly makes it a lot easier to do.



LEO:  Mark Schreiber in San Francisco has a common problem.  He uses a form on his website for email.  And he says lately spammers have figured out how to send spam via this email form.  He says:  I guess that�s why people use CAPTCHAs.  My hosting service won�t allow me to use a CAPTCHA.  He does have antispam, but a lot of it gets through.  He says:  Is there any way to outwit the spammers?  Is form mail dead?



STEVE:  Unfortunately, I�ve got to say that it�s a problem now.  Although I haven�t yet implemented myself reCAPTCHA, although I want to find a reason to.



LEO:  I have to tell you, just from my own experience, that spammers are not machines, that CAPTCHA doesn�t stop them.  Maybe they are using robotics.  I have spammers on TWiT.tv, it�s one of the reasons I�ve turned off comments, who would not only fill out the form, but wait for the email to come back to them, they actually have email accounts, for the - I was doing email validation, and they�d still spam.



STEVE:  And so, and this is like spam spam, or just like annoying people?



LEO:  And this is the thing.  I think I know what�s happening to Mark because we have a form for asking questions on the lab.  And what�s happening is, these spammers are hiring very cheap labor in third world nations to just look for every form and fill it out.  They�re really trying to do comment spam.  I bet you anything what he�s getting is a bunch of links.  And it�s not spam to him.  They�re hoping that it�ll get on a page somewhere.  Our form, for instance, on the lab, is an email form.  It doesn�t go on a page.  But we still get that kind of spam.  The kind of spam they�d like to have show up on a web page is a comment.  It�s called "comment spam."



STEVE:  Yes.  And of course you know why, it�s because you�ve got a highly ranked site.



LEO:  Right.  They want our Google juice.



STEVE:  Exactly.  So if their links appear on your site, the search engines assume that you�re explicitly linking to them because you think they�re good people.



LEO:  Right.  And I can tell you right now, CAPTCHA doesn�t stop them.  Even email validation doesn�t stop them.  And I�ve talked to many other people who say the same thing.  You know, to leave a comment on TWiT in the old days you had to register with a real email address, which I would then send a code to you, then you click the link and validate it.  They would do that.  Not only would they create these accounts, they�d sit on them for months, sleeper accounts, and then ladle the spam out.  It�s a very big problem.  So CAPTCHA�s not going to fix it.  Delayed email validation doesn�t fix - nothing fixes it.  These people are very determined.  And the truth is they don�t really care if it works or not.  They just do it everywhere.  You know, we use no-follow links, which means that they get no Google juice out of it.  Doesn�t matter.  They still do it.  They�re not smart, they�re just...



STEVE:  Just persistent.



LEO:  Just persistent.



STEVE:  And they�re just shotgunning everything.



LEO:  That�s the thing, that�s the point.  And I suspect that�s what Mark�s getting.  They see a form, they don�t care, they don�t pay attention enough to see whether it�s comment spam or going to you personally.  Going to you personally is worthless to them.  They don�t want that.



STEVE:  Right.



LEO:  Let�s talk about Chad in Charlotte, North Carolina.  Great place for barbecue, I can tell you.  He says he wants to increase his anonymity online.  He�s heard about using public proxy servers.  In fact, he�s been to those sites we�ve mentioned before where they have lists all over the world where you can use public proxy servers.  He says:  Is it dangerous to use these?  Plus is there an advantage to using different types?  There are anonymous; high anonymity, I guess that�d be like TOR; transparent.  Could you talk a little more about these proxy servers, public proxy servers?



STEVE:  Yeah.  Essentially, my sense is this problem has been solved, that is, this need has been addressed by, as you just mentioned a second ago, Leo, by TOR, The Onion Router system.  We�ve done an entire episode on TOR, Chad.  So if you�re listening to this, as I hope you are, check out our episode on TOR.  It�s a beautiful technology which is specifically for allowing people to be anonymous.  And it�s an open source effort.  The system is such that even malicious TOR servers aren�t able to really take too much advantage, although if you�re on - the server at the very edge of the network where you emerge from the onion router, it�ll be decrypting your traffic and, you know, and could be seeing what you�re doing.  But again, anonymity to third parties is generally what your goal is.  The reason I think this is superior to these lists of public proxy servers is there�s no way to know what the motivations are for those, and they could be bad guys who have gotten their proxy servers on these lists specifically because they hope people will use them, and they�re going to in one way or another abuse the trust of the proxy.  So...



LEO:  They may be watching the traffic that�s going through them, for instance.



STEVE:  Sure, they could be, absolutely.  I mean, literally, if you�re logging into your - they may be seeing your log-in passwords going by and have, you know, and grab your account and use it to spam.  So I would say, since there is a solution as good as TOR and no real strong reason not to use it because it�s configurable and it�s designed for this, and it does take measures to prevent any single bad TOR server from being able to abuse the user - again, we cover all this in our TOR episode.  I would suggest, Chad, that you listen to that and give TOR a try.



LEO:  Now, he was - and he does say he�s doing it for anonymity.  There is, I should point out, another reason why people use these.  And it�s not anonymity, it�s because they want - it happens a lot in Canada.  This is how I know about it.  They want to appear to be coming from another country.  In the case of Canadians, they can�t use - some software they can�t download or whatever because they�re not in the U.S.  So they�ll use a public proxy server that gives them an endpoint in the U.S., and then that way they can be an American.  But that�s a whole different purpose.



STEVE:  Well, and that�s a very good point, too, about TOR.  TOR has servers all over the world, and you are...



LEO:  But you couldn�t use it for that because you don�t know where you�re going to end up.



STEVE:  No, remember, we took a question in the Mailbag two weeks ago where the guy mentioned that you�re able to ask for a specific server to be your endpoint.  And he was talking about it from a standpoint of creating a static IP, that is, it was static and never changing and not his.



LEO:  Clever.  I think that�s what transparent would be, and then there�s anonymous and high anonymity.  Patrick wants to know more about this PayPal authentication process.  He�s worried if it�s vulnerable to a man-in-the-middle attack.  He�s writing from Sartell, Minnesota.  You know how, when you go to a website and pay with PayPal, it�ll bounce you to the PayPal site, where you enter your password, and then bounce you back to the originating site.  He says:  Could this transaction be hijacked, or could a malicious site in the first place act as a man in the middle between you and PayPal and steal your password info?  For example, he says, you go to badguydiamonds.com, try to buy a stone, a false PayPal screen, saying https, by the way, is shown and captures your info as it�s relayed to PayPal in the background.  Then you complete your transaction, and they�ve got your PayPal log-in.  He says:  Is https going to always show the true website in the URL?



STEVE:  Well, this is a great question because it involves a couple things.  First of all, we�ll mention, as we have, the very popular PayPal Security Key.  An advantage of that is that that number that you append to your log-in password is only valid for 30 seconds.



LEO:  So even if they get it they can�t re-use it.



STEVE:  Exactly.  That�s what�s so nice about this.  And I�ve got to say, though, I mean, he brings up a very good�point.



LEO:  I do this all the time.  Every time I buy from PayPal this is what happens.



STEVE:  Well, yes.  And when I�m using some third-party website, and they say would you like to use PayPal, I say, well, yeah, I want to.  I click on that option because I love the idea of not giving these people my PayPal information and using PayPal.  But then I�m redirected to PayPal.  And, I mean, I�m freaked out at that point because it just seems to me exactly as it seems to Patrick, that, you know, how do I know I really went to PayPal?  So this is�where...



LEO:  Well, he�s saying can you look at the address bar and trust it.



STEVE:  No.  I would say that the problem is that, for example, if something got into your local hosts file, or it was filtering your Internet traffic, that is, if something bad is on your computer, for example used a script exploit to get into your machine, your hosts file, as we�ve talked about before, is the first place that your system looks for the equivalent of DNS.  So if there was PayPal.com entering your hosts file, referring to a bogus IP, your browser could show PayPal.com and not be at PayPal, not have gone to one of PayPal�s IP addresses.  So, but again, it would have a difficult time...



LEO:  They�d have to get to your system, I mean, this is a complicated hack.



STEVE:  Well, but again, if they also put in a Trusted Root Certificate, which is available on your system, then they could sign the certificate of the bogus website pretending to be PayPal, and your browser wouldn�t even notice.  And as far as I know, nothing would notice.  So, I mean, again, you�re right, Leo, that it involves a client-side attack.  It involves doing things on your machine.  But you just do want to be careful about this.  I�m glad Patrick brings it up because, I mean, I always right-click on the page, make sure that I�ve got a certificate that is valid from PayPal and is signed by, you know, the Hong Kong Post Office.



LEO:  Now, if you get that certificate, and you look at it, then you feel pretty confident; right?



STEVE:  Yes.  Then I�m, you know, and I use a different email address always when I�m logging into these guys.  PayPal has, like, my main personal address, not the one I normally use.  So the fact that I�ve been redirected to PayPal and PayPal has found, knows my real email address, which they got from my PayPal cookie on my machine, I mean, it�s not in the cookie, but it allows PayPal to associate me with them.  It�s like, okay, this must be PayPal because they know things I didn�t tell this third-party site.



LEO:  You�ve got me scared now.



STEVE:  Well, it�s a little freaky.



LEO:  Got a letter from Yorkshire in the U.K.  Paul Elliott is wondering about what he calls "native hard drive encryption."  We�re talking about TPM.  We did that on Episode 99, which is the hardware chip that does encryption.  He asks how it�s used to encrypt the entire hard drive.  For instance, he says, in a standard encrypted file, if a single bit becomes corrupted, the whole file is lost just because the encryption breaks.  Is that true for hard drive encryption?  It�s quite scary to think about losing an entire hard drive from a single bad bit.  Or am I missing�something?



STEVE:  Well, there were a couple things that are sort of confused here that I wanted to clarify.  First of all, I did talk about hard drive encryption, referring to I believe it was Hitachi, who in rummaging around I had noticed they were announcing the very first native drive encryption technology, so that more than just locking the hard drive, this thing would actually require to be given a password at power-up from the BIOS, presumably, otherwise you wouldn�t be able to boot.  And then it would use actually a pass phrase of some sort.  It would use that as the cryptographic key to perform on-the-fly decryption as sectors come off the drive and as sectors go onto the drive.  So that no non-encrypted data is ever stored on the drive.  Now, that does require BIOS support.  And again, this is just leading-edge stuff.  None of this exists as far as I know.



But I was also talking about my ThinkPad, where I�ve got my fingerprint reader, and I�ve enabled the TPM system so that it checks my fingerprint.  And, given that it matches, it then uses the associated password as the password to unlock�the hard drive.  Now, again, that�s different than encrypting it.  Many laptops support the notion of locking the hard drive.  It�s something that is unlockable by the manufacturer.  But it�s, you know, it�s go through, get a court order, the FBI or law enforcement would be needed to say, look, we need to get the data...



LEO:  Oh, that�s interesting.  There�s a back door.



STEVE:  Oh, yeah, absolutely.  And there are data recovery companies that also have the ability to get past that.



LEO:  Oh, I didn�t know that.



STEVE:  So basically it just, I mean, it makes it much more difficult.  But it�s certainly not as strong as encrypting the entire drive, which is why I really love that idea.  And�hopefully...



LEO:  But how robust is that?  I mean, he�s worried about a bit corruption.



STEVE:  Ah, right, exactly.  The next point is this is always done on a sector-by-sector basis.  The drive doesn�t know about files.  The file system and the operating system know about files.  The drive just knows about sectors.  So each run of the 4,096 bits, or 512 bytes, of a sector would be encrypted.  And it is the case that, with this, if you had something that was uncorrectable, you would no longer be able to, for example, recover everything in the sector except that little run of bad bits.  So, for example, some of the benefit that SpinRite offers would be lost because it�d be no longer possible, basically the entire sector would have to be recovered at once, or at least up to the point - presumably you could be doing encryption until you get to the bad spot.  So the further down the sector it is, the more unencrypted data you would get.  So, you know, it is the case that there would be some fragility.  But it would only be 512 bytes, and only in the case that that sector was uncorrectable prior to doing the decryption.



LEO:  So it�s really no different than an unencrypted drive, really.  Right?  That�s roughly the same, yeah.



STEVE:  Right, yup.



LEO:  Moving along to question number eight from Leo, I like the name, Leo Sallen in Australia.  He wanted to listen to "On Intelligence," which is the book we�ve been talking about, the [Jeff] Hawkins book.  He says:  I love the show.  I own SpinRite.  I�ve even used it to save myself.  And he�s using it all the time, so he hopes he doesn�t have to use it again to save himself.  He went to look for "On Intelligence" on Audible in Australia.  You do get the free book, he said, but he couldn�t find the listing for the book or author.  And I, you know, we get this from time to time, I understand that - I�ll answer this one, Steve.



I understand that - and by the way, Audible doesn�t even sponsor this podcast, so it�s kind of - this is gratuitous here.  But understand that Audible�s just a book store.  And they are limited by what the publishers want to do.  In fact, it�s kind of interesting, if you�re in Britain and you want to listen to Harry Potter, you have to listen to Stephen Fry read it.  If you�re in the U.S., you have to listen to Jim Dale read it.  And that�s just because they�re different publishers.  So apparently "On Intelligence" either has a different publisher in Australia who doesn�t want to support audio books, or whatever.  You know, there�s some reason.  But it comes down to essentially the fact that unfortunately it�s not yet an international marketplace when it comes to books.  Same reason you can�t get the U.K. version of Harry Potter in the states and vice versa.



So Leo, my suggestion is, I guess you can�t listen to it, but you certainly could buy it, and I would look for it.  Hawkins, Jeff Hawkins is the author.  And I don�t know what the Sony Connect situation is with that.  They may or may not - they have the same restrictions, I�m sure.  They may or may not have an eBook version of it.  That�s where you got it; right, Steve?



STEVE:  Yeah.



LEO:  But you have to have a Sony eBook Reader.  Worth reading, however you get it.  And he says at the end:  Thanks again for the best podcast out there and for�SpinRite.



STEVE:  And I ought to mention, I did mention it before also, that I have Jeff�s book on the Palm, not surprisingly.



LEO:  Oh, you didn�t get it on the Sony Connect Reader, you got it on the Palm.



STEVE:  Exactly.  Well, I have it on both.  I�ve got it on the Reader.  Remember I wanted to see whether I could go back to reading on the Palm.



LEO:  Right.



STEVE:  Even though the screen is so high contrast on the Palm, but I just love the size of the screen on the eReader.��So...



LEO:  Where did you get it for the Palm?  What bookstore did you get that from?



STEVE:  It�s the main Palm - just ereader.com, and they definitely have it there.



LEO:  Well, they have it there if you�re in the U.S.



STEVE:  Right, exactly.



LEO:  That�s the problem is that it�s all, you know, it�s international.  You know, it�s tough because we�re an international podcast.  For instance, Vijay Albuquerque in London - or it could be Vijay London in Albuquerque, doesn�t matter - now has plenty of room on his drive.  He says:  Dear Steve and Leo, after hearing about SpaceMonger, which  by the way, Steve, I�ve been recommending everywhere, the original free version...



STEVE:  Yup, it�s so nice.



LEO:  I just recommended it on the radio show last weekend.  He says:  I�ve reclaimed virtually gigabytes of data from my hard drive.  It gives you a visual display of what�s wasting space on your hard drive, makes it easier to get rid of it.  He says:  Is there something for memory, for RAM?  He�s using the process monitor.  You hit Ctrl-Alt-Del to get the Task Manager, and then you can click Processes and see the list of processes.  But there must be a simpler, friendlier tool out there, something like SpaceMonger for RAM.  I like�it.



STEVE:  RAM Monger or something, yeah.  Well, it was an interesting question, so I wanted to explain that, you know, RAM is an entirely different animal than hard drive space because it is inherently dynamic.  So applications which are running will use differing amounts of RAM, but there�s really no way to tell an application to stop using that much memory unless it�s a sloppy application that, for example, you could have a photo editing program where you edit a big photo which takes up a whole bunch of memory, and then when you close that photo it doesn�t release the memory, for example.  So it�s possible that you could have apps which are misbehaving and essentially leaking memory.



But thankfully all Windows versions for the last decade have�cleaned up the so-called "resource leaks" when the application terminates and freed up anything, any resources that they had allocated.  So really just terminating processes, if you can, that is, if you don�t need them around, that are using up a lot of memory, will release their memory.  But there isn�t anything that you could run to really clean up memory.  There are some sort of hokey programs that are supposed to optimize your RAM.  But they�ve really got a bad reputation.  And really just, if you have this problem, just restarting Windows and getting things going again is the way to clear everything out.



LEO:  In the old days of Windows 95, 98, and ME, the memory�manager was pretty pathetic, and so you would have fragmentation of RAM, and you�d have some issues.  But XP�s memory manager is fine, and there�s no point in compacting�RAM.



STEVE:  Right, right.



LEO:  I think the memory manager does a pretty good job of getting rid of unused blocks.  It can�t solve a memory leak, but nothing can solve it.  If the operating system won�t get rid of that block, you know, release the block, no program�s going to come along and do it.  So...



STEVE:  Right.



LEO:  Bill Rakosnik of Bishop, Georgia has actually a very interesting question.  He says:  Can I get a virus by watching video on YouTube?  Can video infect you?  Is it an�executable?



STEVE:  It�s interesting.  Unfortunately, and I don�t know of any instance of this happening, but yes.  Actually there have been old instances.  I know that RealMedia years ago was having problems with malware, essentially, or malvideos.



LEO:  What�s happening is you have an executable program, like the WinAmp player, which had a problem also.  And you take advantage of a flaw in the executable program.  So the video itself is harmless, it�s the fact that it�s using a flaw in the video player.



STEVE:  Or even in some cases in the codecs themselves, that is, the actual decompressor which goes from the compressed format.  So essentially it�s not the case that any video could give you this kind of problem.  It�s that the video would be a way of getting code in your machine which is exploitable, that is, where there�s some sort of a security flaw in something not even about security, it�s about playing music or playing videos.  But they�ve found a way of sort of, for example, giving bogus data in the video to the thing that�s trying to play it back, which cause your typical thing like a buffer overrun or a stack overflow or something, that would then allow additional code contained in the movie file to execute.  And so, yes, you would essentially be infected by watching that video.  And again, it�s like anything else.  It�s something which, as soon as it�s found, it�ll be patched by the vendor of your OS.  And this kind of stuff is going on all the time.  So potentially it could be a problem.



LEO:  YouTube uses Flash.  I don�t know of any exploits with Flash right now, but of course there always could be.  Somebody could find a flaw in Flash.  This reminds me of the 

JPEG flaw we�ve talked about before.  Same thing.  JPEG itself is harmless because it isn�t an executable.  But the player, in this case your browser, whatever program is displaying the JPEG, could have a flaw that then the data in the JPEG file could be used to exploit.



STEVE:  Exactly.



LEO:  I think best advice is keep your codecs and your players up to date, you know.  But it�s harder because, you know, we keep our operating system up to date because it�s automatic.  You know, if you�re using the RealMedia player, I don�t know how automatic those updates are.  I guess until you run it you don�t know.



STEVE:  Well, it�s a very good point.  I mean, we�ve sort of touched on this issue tangentially before when we�ve talked about websites, for example, using old exploitable wiki code or something, where now we�ve got Macs updating themselves, Windows is updating itself constantly, I mean, it�s now we�re all running forward trying to keep our software secure, yet all of this sort of non-primetime code can sit on servers for a long time and be there years after exploits are known.  And it is the way people are now exploiting these sorts of systems.



LEO:  In fact, you made that point.  You made that point really well where you said that, well, now that Windows is in good shape they�re going to look for other vectors.



STEVE:  Yup, other low-hanging fruit, as they say.



LEO:  Marcus, I think it�s probably Kaczmarek in Kenai, Alaska, is worried, as I am, about U3.  That�s that new technology in the flash drives that automatically launch applications when you plus in the flash drive.  He wonders, if it�s insecure, how do I get it off my jump drive?  You said you�d cover this, but we haven�t covered it yet.  We�haven�t.



STEVE:  Yeah, in fact, you know, I was going to talk enthusiastically about U3 in the vein of it being a virtual machine sort of technology, the idea being that you could carry this around and plug it into a machine.  And so I got some.  I mean, I purchased them deliberately to experiment with them.  And I�ll tell you, Leo, I mean, for a security person, the idea that you plug this into a system, and without asking you it does a bunch of stuff to that machine.  I just don�t like it.  It ought to come neutered so that you have to manually enable features if you want them, rather than the other way around.  And so I just - I thought, I�m not helping these people.  This just is not right.



LEO:  You know, the easy way to do this would be to have an autorun.inf file on there.  And then you could disable it by just deleting that.  But they don�t do that.  They mount a disk, a bootable disk, essentially.  And there�s no way, as far as I can tell, there�s no way to disable that functionality in a U3 thumb drive; is there?



STEVE:  Now, well, the good news is that they provide the option for scrubbing themselves off of the thumb.  But of course that�s only after it runs the first time.  So we can presume there�s nothing evil about U3.  I didn�t mean to assume that there was.  I just dislike from a security standpoint the idea that - and I mean then, well, let me finish that thought - the idea that it�s enabled by default when all you�re doing is buying RAM.  I mean, you just want to buy a thumb drive.  You buy it from SanDisk, and it has U3.  And but all you want is two gigs or four gigs or whatever.  And instead, you get this thing that runs the moment, you know, the first time it has contact with your machine.  It�s like, okay, that seems backwards to me.



LEO:  So if you delete the U3 Launchpad, it won�t do that�anymore.



STEVE:  No.  It turns out it is pernicious.  You have to use it to delete itself.  And I�ve experimented with this because I have scraped it off of a couple of these thumb drives.  And so you can�t get rid of it easily.  You have to use it to remove itself because it needs to uninstall the mounted virtual CD which it uses to protect part of itself from accidental erasure.  It�s got to uninstall that and then delete itself and clean itself off.  And it goes through a bunch to remove.  So the answer to Marcus�s question is, just look at the menu that pops up.  There is a way to completely remove it from your system.  And I�m glad for that, but I sure wish they did it differently.  I wish they had it like, hey, you got a chunk of files there, and you run something to install it on itself rather than having it active when you buy it.  Because most people just want the storage space.  They don�t want this thing to take off and run.



LEO:  If you go to U3.com/uninstall, it says, wait, you�re about to throw out the part that makes your drive smart.  The Launchpad makes your drive more than a data storage device, blah blah blah blah blah.  If you�re uninstalling due to a problem, check out our troubleshooting page.  Removing the U3 Launchpad disables the smart functionality, so think before you click and make the smart choice.  Oh my�god.



STEVE:  Yeah, boohoo.



LEO:  Boohoo.  Finally they have links that say, tell me more, I�ll keep the Launchpad for now; or, finally, you can click the last one that says Remove Launchpad.  And then you provide the brand of the smart drive.  You have to give them a reason, although my suggestion would be give the reason "U3 Sucks," and then submit and continue.  You have to go through hoops.  And I really think it�s inappropriate for them to make this big deal about how cool, you know, don�t throw it out.  Unbelievable.



STEVE:  Yeah.  I mean, obviously you�re there at that page because you�ve made the decision.



LEO:  And what they don�t say, and I wish they would, they say all the benefits of U3.  At no point on this page do they talk about why you might want to remove it.



STEVE:  So we won�t be - we will not be promoting them as something that we think is wonderful.  And...



LEO:  And there�s use for it, but hackers have a great use for it, too.  So we should just point out that you can, there is kind of a generic U3 uninstaller, U3.com/uninstall.



STEVE:  And again, I�m sure we�re going to get mail from people saying, hey, I use U3 thumb drives, and I love them.  It does blah blah blah blah blah.  I�ve got all - I�ve got Skype, and I�ve got my applications, and I�ve got crypto stuff, and it�s so cool because I can go to anyone�s computer and plug it in, and it just takes over and runs, and I can do what I want.  And then when I unmount it and pull it out, my whole little U3 environment comes with me.  And it�s like, yes, I know.  And that�s what it does.  So there�s the only commercial I�m going to give them.  I just think that it is backwards that this thing is running by default and just goes the moment you first touch it to a computer, rather than, hey, if you want U3, have it installed, but have it passive until you explicitly enable it on that device.  Then it should come to life.  And clearly, the attitude you just displayed, Leo, reading that page shows that these people think differently.  So...



LEO:  Well, in their defense, you don�t have to buy a U3�drive.  But the problem is you get them - I got it by accident.  You know, you just say, oh, I�ll take a thumb drive, and you don�t see, oh, it�s a U3 drive.



STEVE:  Right.  Well, for example, SanDisk is promoting it as value-added to your four gigs.  It�s like, yeah, but I don�t want it.  But it turns out you can�t get rid of it until you run it.  And that�s wrong.



LEO:  Well, I�m not sure that�s true.  I�m looking at - PC Magazine has an article on, it says, "Keeping U3 Under Control."  It says, if you insert the drive and hold the shift key down, just like autorun, it won�t do the U3.



STEVE:  Okay, good.



LEO:  And at that point you can then go to the device�manager...



STEVE:  And format it.



LEO:  No, formatting it does not work, actually.  But you can right-click the U3 drive and choose Disable on U3 so that it will not automatically launch.  It doesn�t release the space, but at least it won�t automatically launch.  So I think that you - and then I presume you could run the removal tool that you�ve downloaded by pulling teeth at U3.com.  So I think you could actually get rid of it without running it at any one time.  It does, now, correct me if I�m wrong, but it does put stuff on your system; right?  The first time you run it, does it not copy...



STEVE:  I don�t think so.  I don�t think...



LEO:  It doesn�t, okay.



STEVE:  I think that that�s one of the cool things that, you know, that they�re promoting.  Although you do have to U3-ize the - unless the applications are specifically U3-aware, they may be mucking around making modifications.  So you have to, I mean, this is an uphill battle these U3 guys are promoting here.  And I did, I downloaded all the information once and read through it.  It�s like, okay, this seems like a lot to go through.



LEO:  Well, I mean, look, if you listen to Security Now!, you know it�s a bad idea to let anything install anything at ay time, period.  And so if you�re that kind of a paranoid person, there you go, that�s what you need to know.



Sam Osborne, Bathurst, New South Wales, Australia has been pondering CAPTCHAs.  Couldn�t CAPTCHA be more like a general knowledge question in an image?  See, everybody�s trying to think of new ways to have CAPTCHAs work.  So he�s saying, obviously the whole point is to disable or defeat AI in computers.  For example, he says, why don�t they just say what is the capital of Australia?  Or type in the word "enough" backwards?  Or spell out the number 8.  Oh, that�s an interesting idea.  A color that is between red and yellow that is also a fruit.  How could a computer - because a computer doesn�t understand a question like that and can�t get the context of that.



STEVE:  The problem is, I have a hard time understanding questions like that.



LEO:  C�mon, Steve.  A color that�s between red and yellow that�s also a fruit.



STEVE:  I hope Sydney is the capital of Australia.



LEO:  Enough, type the word "enough" backwards you could do.



STEVE:  Okay.  The problem is, first of all, okay, there are two classes of question he asked.  Some are knowledge, and some are puzzles.



LEO:  Can�t do knowledge.  I agree with you, you can�t do�knowledge.



STEVE:  Yes.  The problem with knowledge is that then the people have to know the answer.  And it�s like, you know, what�s Claus�s first name?  It�s like, oh.  Well, Santa.  Okay, well, that may be knowledge, but it�s also sort of a puzzle.  Or certainly type in the word "enough" backwards, that�s a puzzle, or spell out the number 8 is a puzzle.  But in what language?  So now we have language problems because these - and some people spell "colour" as actually he did.  I spell it c-o-l-o-r.  He spelled it in his email c-o-l-o-u-r.  So that�s a problem.  And so I assume that the fruit he�s thinking of is orange, which is between red and yellow.  But I�m not sure what between red and yellow means.  But mostly it�s not possible to have a large enough collection of these puzzles that some spammer�s not going to sit there failing the CAPTCHA, capturing the puzzles, and then building a solver that just knows all the puzzles that are�possible.



And this did also sort of come up in our CAPTCHA episode.  By definition, a CAPTCHA has to be a puzzle or a task that is fully automatable, meaning that no one sat down and came up with all of the possible questions and answers, but rather an algorithm randomly generated numbers and letters, turned them into a picture, messed up the picture to make it hard to automate, and then presented it.  So anyway, you know, you�re right.  Lots of people have been trying to come up with solutions.  But as he says, a general knowledge question, the problem is we don�t all have the same knowledge, and anything that has a limited domain of questions can be brute-forced.  And then, you know, goodbye�CAPTCHA.



LEO:  Right.  Steve, it�s always a pleasure talking to you.  You make this all clear.  I love it.



STEVE:  Well, it�s always fun doing this, Leo.  I really appreciate here we are at the end of our second year.  Not yet into our third year, end of our second year with Episode�104.  I just want to thank our listeners for being so great.  They send lots of email.  They�re posting lots of questions to the Security Now! page at GRC.com.  I really do appreciate people who are saying, hey, you know, I bought SpinRite knowing that I may need it someday and to support the show.  And of course I know that they are signing up for your PayPal donations over on TWiT.tv, Leo.  So we�ve just got, I mean, a ton of really great listeners.  And I love doing the show with you.



LEO:  You know, well, I love doing it with you.  Steve, I would be remiss if I didn�t mention GRC.com after all those nice things you said.  GRC is a great place to get free stuff like the Security Now! podcast, of course, in 16KB versions for the download impaired.  Also great transcriptions, thanks to Elaine.  But also all of Steve�s free software, like ShieldsUP!, Shoot The Messenger, DCOMbobulator, Wizmo, a ton of, I mean, Steve just writes all this great stuff that�s absolutely free.  GRC.com.  What�s not free is SpinRite, his great disk maintenance and recovery utility.  Every nerd ought to have one.  Actually all the nerds do have one, don�t they.  They have a...



STEVE:  They do, yeah.



LEO:  ...site license.  Well, Steve, thanks so much for a great two years.  And here�s to many, many more.  As long as you want to do Security Now!, as long as people continue to listen, there�s no reason not to keep doing it.  I just - I love it, too.  Thank you, Steve.



STEVE:  I�m glad, Leo, it�s my pleasure.  And next week we start into our third year with Episode 105.



LEO:  Happy Anniversary.  See you later.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#105

DATE:		August 16, 2007

TITLE:		Firewall LeakTesting

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-105.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss the history, purpose, and value of personal firewall leaktesting.  They examine the myriad techniques clever developers have found for accessing the Internet and sending data out of PCs even when�those PCs are being protected by outbound-blocking personal firewalls.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 105 for August 16, 2007:  LeakTests.



Hey, it's time for Security Now!, a chance to look at security in all its guises with the expert, Steve Gibson of GRC.com, now entering our third year of podcasting.



STEVE GIBSON:  That's right, Episode No. 105, which is this one, is the first episode of year three of Security Now!.



LEO:  And I understand we have some very good news...



STEVE:  Yay.



LEO:  ...to celebrate with.



STEVE:  Yes.  I absolutely want to start off by thanking our listeners.  It is clearly 100 percent their, I don't want to say "fault," but, you know, their work that has allowed us to take People's Choice Best Science & Technology Podcast for this year.  We don't know what the numbers are, that is, by how much we won.  But two weeks ago we did a quick little special podcast, Leo, when I realized that this podcast awards was up.  And it was, overall, it was up for 15 days.  The podcast award people report that 1.3 million unique people voted.  During one hour, the busiest hour, 22,109 people voted during a one-hour window.  The average person voted three times during that 15 days.  And of course, you know, multiple repeat voting was formally endorsed and allowed.  So I said to our own listeners, vote often, vote immediately, vote - every 24 hours you were able to log one more vote.  And so as a consequence - and I'm sure this wouldn't have happened if it weren't for our listeners and actually for us saying, hey, let's win this year because we haven't for the last two - we got People's Choice Best Podcast for Science & Technology category.  So...



LEO:  Congratulations, Steve.  You deserve it.



STEVE:  Well, I'm really happy.  The feedback we get is so positive.  And I just love it that we were able to ask our listeners for this, and they came through.  So...



LEO:  Well, and I also like it that we didn't have to ask more than once.  We didn't have to beg and plead and say, please vote for us every show.  We forgot.  We only asked once.  But that's good.  That's good.



STEVE:  Yeah, very cool.



LEO:  So you'll get your award at the Podcast & New Media Expo, I presume.



STEVE:  Yes, in fact, that's my annual opportunity to hang out with Elaine, as you know, our transcriber.  I hope and I expect that she will be able to make the trek out from her wilderness hideout wherever that is with the satellite link that's always giving her trouble downloading our audio files.  But you're not going to be there this year.



LEO:  I can't make it this year, I'm sorry to say.  But I wish you all the best.  And maybe now that I know you're winning an award I probably should come down at least that Friday.  The reason is it's over a weekend, and I have to do the radio show, so...



STEVE:  Oh, of course.  Well, and for me it's a drive.



LEO:  You're there.



STEVE:  For you it's a roundtrip flight problem, so, yeah.



LEO:  I'd have to fly down.  So I'm sorry I won't be there, but congratulations.  I think that's fantastic.



STEVE:  Well, I just, you know, when I saw that this was a possibility, it's like, oh, I want to win this.  And so we have, thanks to our listeners.  So I want to really thank them for that.



LEO:  Very good.  Well done.



STEVE:  In other errata, several people mentioned that - I don't know why, I mean, I don't even know what the capital of Australia is.  I think the only city I'm really even aware of is Sydney.  So without even thinking I said it was the capital.  I don't even remember now what the context was.  But...



LEO:  I know what it was.  We were talking about CAPTCHA, a different kind of CAPTCHA which asks you knowledge.  And we were talking...



STEVE:  Oh, that's exactly what it was, right.  Well, and...



LEO:  You would have failed that one.



STEVE:  Yes.  I said maybe not everyone knows that the capital of Australia is Sydney.  And sure enough, you�know...



LEO:  It isn't.



STEVE:  Yeah.  It's Canberra.



LEO:  I didn't know that either.



STEVE:  C-a-n-b-e-r-r-a.  So there is a finer point on why knowledge-based CAPTCHA is probably not a good idea.  Not if you want me to, you know, be able to access your website.



LEO:  Well, we'll know that from now on.  That's wonderful.



STEVE:  Also, you may remember that I, in one of the - I'm not sure whether it was last week or the week before, I was excited to have discovered that Microsoft's CardSpace, their UI for single log-on interface, which was always in Vista, I was excited to tell people that, hey, it has appeared in my Control Panel in XP.  And I said, you know, as long as your security patches are current, you'll have it.



Well, it turns out it's a little more involved than that.  It's a component of .NET, which actually is to say that it's implemented in .NET as more and more, apparently, things will be in the future because this is Microsoft's new API initiative for Windows.  And so it's only if you had gotten on the .NET bandwagon one way or another.  The .NET components are optional uploads, or downloads, depending on which end you're standing on, for Windows Update.  Many times you'll download some new thing that requires the .NET components in order for it to run.  So people may be already on that.  But if you went looking for CardSpace in your Control Panel, and your patches are all current, you may have wondered and been disappointed that you don't have it.  The reason you don't if you didn't is you probably don't have the .NET component.  So you need to install those, and then CardSpace will appear after you've done sufficient number of further updates.



LEO:  It's part of .NET 3.  But, you know, it's funny because I have it, and I ran it, and I filled out a Card, and that was about it.  There's not much to do with it at this point.  Don't go out and download it just so you can get it.  I mean, it's not...



STEVE:  Yeah.  We're definitely in that chicken-and-egg phase where people are waiting till it exists, and they're not going to, you know, it's not going to exist until enough people have it.  So ultimately I think it's a nice UI for things like the OpenID interface.  So I'm glad for that.



And here we are on Thursday the 16th, so it's worth pointing out that two days ago, on the second Tuesday of the month, that is to say, the 14th, Microsoft has dropped a bunch of security updates on us.  All kinds of stuff.  I think it's nine different updates.  There's some serious problems in the XML core library support that they've got.  And, you know, and a scattering of other things.



Also, in other news, Symantec had a bunch of problems in their various security suites.  There's one common control that all of the Symantec security stuff use that had a remote execution vulnerability that was discovered.  So you're going to want to make sure, if you're a Symantec user, that you update that.  But also certainly, if you don't already have automatic updates running, you'll want to go grab this stuff from Microsoft pretty soon because it was one of our, you know, a large month worth of fixes that were available two days ago.



LEO:  Weren't there also some Vista, for the first time some serious Vista flaws, as well?



STEVE:  Yes.  Actually it's a consequence of the fact that Vista is really just, well, it's more than a candy coat or wrapping on top of XP.  But Vista is built from XP inasmuch as most of Vista is existing code.  So anything that's being found in XP that shares a common code base with Vista, which is to say almost everything, that will be a problem, too.  It is the case that we have seen instances where Vista's heightened security and the evolution of this tightening that Microsoft is doing has prevented code that is vulnerable and would otherwise also be vulnerable in Vista from actually being exploitable under Vista.  But you're right, in this case, Leo, the exploits that were found probably on an XP platform did map into Vista.  And so Vista's stuff was not protecting people in that case.



LEO:  Although, you know, I have to say, given that Vista's been out now seven months, it's been pretty reliable.  We haven't seen a whole lot of critical flaws.



STEVE:  Well, and I don't think we're going to, frankly.  I think those days are over because we've got firewalls running.  As soon as we went to Service Pack 2 and the XP firewall was running by default, that really, I mean, it forever changed the landscape of Windows vulnerabilities because it was, you know, Microsoft was saying, oh, anyone who sets up their network stack and turns on networking, they'll run across the wizard for turning your firewall on.  And it's like, okay - that is to say, in XP prior to Service Pack 2, it's like, okay, if that's true, why are all these XP systems having their ports exposed?  I mean, that was the nature of all these problems that Windows kept having was that people were running XP without the personal firewall running.  Which of course, you know, Microsoft finally got a clue with Service Pack 2 and said, okay, we just have to turn this on by default.  The moment they did that, everything changed.  Now it really doesn't matter what nightmares you have in terms of, like, open ports and services running because they're going to be behind the firewall.  Now the problem, and this is now what we're seeing, in fact, are this next generation of, you know, you go get the problems yourself by surfing to unsafe websites.



LEO:  Right, right.  Oh, well.  That's what's interesting about this, as nasty as it is, it is always changing, and that makes it kind of interesting.  And I have to say I'm somewhat grudgingly impressed by the ingenuity of these bad guys.  They just keep coming at it.



STEVE:  Well, that's a perfect segue to today's topic, Leo, because ingenuity of bad guys is essentially what our listeners are going to really end up feeling when I wrap up a discussion of personal firewall leaktests, which is our topic for the day.



LEO:  All right.  I am prepared to hear about how leaky my system is.



STEVE:  Well, before I get into that, I did want to share a fun piece of email that came in to us with the subject "SpinRite Really Works."  And I'm only going to...



LEO:  Really, no kidding.  I'll be danged.



STEVE:  Where have we heard that before?



LEO:  SpinRite works?



STEVE:  I'll just give this guy's first name as Ken, for reasons you'll see here as I read this.  He says, "Hi, Steve.  I hope this the right address for testimonials.  If not, please forward this to Steve Gibson as I want to thank him personally.  I've been a loyal listener of Security Now! since Episode 1.  Keep up the good work.  I know it has opened my eyes to many different aspects of security.  However, this email is meant to praise SpinRite.  My father bought me a copy some time back, and I can thankfully say that personally I haven't had an opportunity to use it except for regular maintenance scans."



And of course, as we know, maintenance scans with SpinRite will very likely prevent him from ever needing to use it for recovery because it'll allow - SpinRite will work with the drive to allow the drive to discover problems before they've become critical.



And he says, "However, I work for a company that has employees that travel in Canada and Ecuador who depend heavily on laptops for communications and data analysis.  Well, Friday an employee who was working in Ecuador had his computer crash.  It would not boot Windows no matter what he tried to do, the lovely unmountable boot volume being the error of choice," says Ken.  He says, "I suspected a few bad sectors had developed on the hard drive.  And when they ran some diagnostics, it only further confirmed my suspicions.  Unfortunately, repair was not an option for a number of weeks.  So I felt that SpinRite was our best and only" - he says in parentheses with an exclamation point - "option.  I didn't have time to purchase a site license."  And he says, parens, "Sorry.  But after this I had no trouble getting approval for it!"



LEO:  Yeah, I bet.



STEVE:  "So I emailed my personal copy" - that was, you know, the present from his dad.  He says, "I emailed my personal copy to them with usage instructions.  Well, they ran the software on the machine this morning.  And about two hours later I received an email from our employee from his now-booting computer."



LEO:  Oh, hallelujah.



STEVE:  "Thanks so much for making a wonderful product.  Chalk up another win for SpinRite."  And he says, "If you choose to read my message on the podcast, please only use my first name (for security, of course)."  So he says, "Thanks again," and we'll just call him Ken.  And thank you for the report, Ken, I really appreciate that neat testimony.



LEO:  That's really great.  That's really wonderful.  I've had, I'll tell you, a lot of people love Security Now!, and even more love SpinRite.  So it's a nice combination.  We're glad that SpinRite allows you to do Security Now!.



STEVE:  I really am, too.  Okay.



LEO:  Yes.  Leaking.  Leaking testing.



STEVE:  Okay.  First of all, a little bit of history because I don't know whether our listeners know it or not, but I'm also the person who I guess coined the term "leaktest" because I wrote the first one that there ever was.



LEO:  Right.  Which is still your No. 1 downloaded program, I think.



STEVE:  Well, yes.  In fact, that's one thing that I wanted to mention is it has always been the most downloaded tool we have.  Which, as our listeners will understand in a second, this sort of strikes me as being sort of bizarre because my LeakTest is dumb.  I mean, it's just - it does what it does. But it's like, oh my goodness, I mean, if the firewall can't pass mine, it has no business occupying any code on someone's computer.  But I wrote it because once upon a time there was only one firewall that did pass, that is to say, which did not leak in the simple way I was testing.  But to make, well, to finish that aspect, LeakTest version, I think it's at v2 because I made some changes a while back, it has been downloaded 6,715,096 times.



LEO:  That's amazing.



STEVE:  So, and except for example when the Windows Metafile thing surfaced a year and a half ago, Leo, at that point then the MouseTrap tool that I created to deal with that, that briefly floated to the top of our most popular downloads.  Then it sort of sifted back down in the list and took its rightful place, LeakTest resuming its No.�1 position.  But I noticed just now when I brought the page up, the free popular page sorts the freeware that GRC offers by popularity.  For some reason at the moment Wizmo is in No.�1 place.  But it must - it could only be that someone somewhere wrote about Wizmo.



LEO:  I think we mentioned it on the show or something, on the TV show.



STEVE:  Ah, that would do it.  So at the moment it's outpacing LeakTest.  It's seeing 1,286 downloads per day versus 724 for LeakTest.  But Wizmo will calm down again, and LeakTest will once again be No. 1.



LEO:  But you'd like to tell people to stop downloading it.



STEVE:  Well, I mean, people do.  And if they want it, I'm glad that it's there.  it's another one of my - it's like 25KB in size.



LEO:  Well, there you go.



STEVE:  But here's the story of leaktests, that is to say, the very first LeakTest in the industry.  I was using ZoneAlarm at the time, when ZoneAlarm was very new.  It was out of beta, and it existed.  And the thing that ZoneAlarm did was something that many other firewalls at the time also did, which is, you know, the whole reason ZoneAlarm was cool was it gave you outbound protection.  That is, any firewall or NAT router or even Windows XP firewall will provide protection against inbound packets because, as any listeners of Security Now! will understand, the way that works is any unexpected packet, that is, a packet coming in that is not part of a connection that was initiated from the inside out, those packets will simply be dropped.  Well, that's the way NAT routers work, as we know.  Which is why the moment you put a NAT router in front of your computer, things get a lot quieter on your network because there's all this nonsense and, as I call it, "Internet Background Radiation," IBR, which is just junk packets floating around the Internet and old exploits that are scanning for still-vulnerable computers and so forth.  So, you know, the Internet's just now, unfortunately, in the last five years become full of this debris.  So a personal firewall, like even the firewall that's in XP, it'll block you from all that stuff.



But the real point of personal firewalls as such, the reason that people still install additional firewalls, even when they've got, for example, XP's firewall built in, is they want to know who is sending data out.  They want control over which applications are being permitted to use their Internet connection.  And you can argue that that's a really useful thing.  I mean, the fact is, that is the way that I discovered the little bit of spyware which WinZip, the Windows version of WinZip installed on my machine - I'm sorry, PKZIP.  It was a Windows version of PKZIP that installed some spyware on my machine.  When I was beta testing the very first version of ZoneAlarm, it popped up a note and said, hey, tsadbot.exe wants permission to use your Internet connection.  And I'm like, what?



LEO:  Who?  I don't think so.



STEVE:  And, you know, I had permitted Eudora and IE and a couple other net-using utilities.  So the whole idea was that the LeakTest - I'm sorry, the personal firewall was doing outbound protection.  And Symantec's did, and Norton's did, and Sygate's, and I mean, McAfee, you know, basically that was a feature that they were all boasting about.  And there was probably 15 of them around at the time.  However, I became aware of the fact that only ZoneAlarm was actually checking to see whether the application you had permitted to send data out of your computer was the one that was sending it.  In other words, we all know that Internet Explorer's filename is IExplore.exe.  So it turns out that fooling any of the outbound blocking firewalls except ZoneAlarm was as easy as a trojan or any other malware renaming itself IExplore.exe.  In which case it really was able to explore.  I mean, IExplore was the right name.



LEO:  So all it was looking at is the process name.  And once the process name had been approved, it didn't matter who it was.



STEVE:  Exactly.  It was just looking at the name of the executable that was running.  And in fact you could almost assume that IExplore.exe would be given permission, even if the person were, for example, a Firefox user.



LEO:  Well, that's a good point.  You just look at it and say, oh, Internet Explorer, I don't know why it's running, but I'm going to say okay.



STEVE:  Well, or you need to use IE for some things, you know, Windows Update and so forth.  So even if you're not using IE all the time, you've probably had an occasion to give it firewall permission.  So anything was simply able to rename itself to any application that had permission to exit the firewall.  And no dialogues would pop up.  Nothing would happen because the firewalls were just checking, as you said, the process name.



So when I realized that only ZoneAlarm was actually doing - I think it was in MD5 they were doing, as we know from our crypto series, that's a message digest.  They were actually checking - they were running a cryptographic hash on the actual executable program to see if it's the same as it was when you permitted it.  So, for example, if you said yes, IE�is able to use my Internet connection, at that point ZoneAlarm would take a snapshot of the executable code, reducing it to a cryptographic hash.  And it would store that along with the permission so that subsequently, when a program got itself going and tried to use your Internet connection, and it was called IE, ZoneAlarm would look in its list of permitted executables, see that IExplore.exe was permitted.  But then I'm sure the first thing it did was check the length, which is a very fast thing to do, to verify that the length is the same.  And if not, it would then generate a cryptographic hash and make sure that it matched the same file that had been originally given�permission.



So, I mean, this was, you know, this is what you would expect.  But it turns out not one other firewall did that.  So I wrote, in the course of a few hours because it's a trivial tool, I wrote the very first LeakTest, which it just said to people, look, try this.  Take any file you have and rename it to something that is permitted.  And in fact the idea was that LeakTest itself, LeakTest was a very simple, benign, outbound tool.  So the idea would be, you would run LeakTest, and up would pop a dialogue box that would say, hey, I'm LeakTest, do you want to permit me to use your Internet connection?  So basically there were many different ways you could use this.  But the idea was that it was able to test whether your firewall was simply verifying the process name or not.  Well, I got in trouble with Symantec.  They called because they were upset that I had...



LEO:  How dare you test our software.



STEVE:  Exactly.  They were really annoyed with me.



LEO:  How dare you.



STEVE:  And they were saying, well, wait a minute, this is irresponsible.  You've let everyone know...



LEO:  That we don't work.



STEVE:  And it's like, wait a minute, yeah, this is not a buffer overflow or overrun problem.  This is a feature which was implemented with no thought at all to actually preventing its exploit.  I said, I'm sorry you're upset.  Let's see how quickly you can fix it.  Well, what's cool is that, with ShieldsUP!, GRC was enough on the map at the time.  And the news of LeakTest just went like wildfire through the Internet, everyone realizing how dumb their firewalls were, if they weren't using ZoneAlarm.  I'm sure many people switched to ZoneAlarm.  But I also know that, within a very short time, every single other firewall fixed this problem.



Which is why I created LeakTest, was I wanted to demonstrate how trivial it was to bypass all other firewalls' so-called outbound protection, and in the process bring immediate pressure on them to get this fixed, which it was a couple weeks later all of them had released updates which added this very simple, you know, check the length, check the message digest, do a hash of the EXE and make sure that it's solid, and so this very obvious way for trojans to operate.  Oh, and we were aware of trojans in the wild that were using this approach, just renaming themselves as a permitted application in order to function.



LEO:  So now I see why you say who needs LeakTest, because that was an easy fix, and everybody's fixed it.



STEVE:  Yes, exactly.  I mean, and it's freaky to me that here we are five years later, and it's still the No.�1 downloaded tool, and we're...



LEO:  Well, I think people don't - now that you've explained it, I think just people just don't understand what it's testing and why you don't need to test it anymore.



STEVE:  Well, okay.  So here's the cool thing, Leo, is this�was just the beginning of leaktests.  There are now something like 15 of them, all of them more useful and also much more powerful, many of them very clever.  And what doe annoy me is, unfortunately, none of them have ever achieved enough real attention to cause firewalls to address them.  Meaning that even though, for example, there's a website, firewallleaktester.com, maintains a list of all of these leaktests, talks about what they do, and shows this massive chart.  And I've got links, by the way, in Episode 105 show notes to these things for people who are interested and concerned.  This site does an inventory of all known firewalls and, well, certainly the most popular firewalls, I mean, a huge list of current, contemporary personal firewalls, and shows what version was tested, cross-referenced by all these other leaktests, which show that right now these leaktests cut right through these personal firewalls that are saying they're blocking these problems which are well known, and they haven't bothered to fix them.



So, I mean, my conscience every so often is pinged a little bit by this because I think, wow, you know, if GRC were to publicize these problems, we might again be able to get those firewalls to get themselves up to speed because we have the security-oriented profile to bring enough pressure on the likes of Symantec and McAfee and Sygate and on and on and on.  I mean, just all of the firewalls.  I don't mean to single those guys out.  They just come to mind because they're so popular.  But to say, look, it's time now to fix these problems.  But I want to give our listeners a sense for how these other leaktests work, what they do, and essentially a little bit of a sense of the futility of this whole issue because the real issue is, and we've said this on the show so many times, but it's always worth repeating because it's such a truism, is once something is in your machine, it's almost too late.



Now, assuming that this something that malware, mal-thing that gets in your machine would trip an alarm on your personal firewall, then that's good.  I mean, you know that it's there.  And it's certainly better to know that it's there than not know that it's there.  On the other hand, what are you going to do about it?  Because these things are now virtually impossible to remove.  They sink their hooks so deeply into your machine.  Many of them are very sneaky and are really, as I said, they insinuate themselves at a level that makes it just so difficult to do anything other than roll back to a previous image.  And in fact even the Windows built-in restore points are now being infected by malware, so that that system can't be used.



So, okay.  One firewall that does something which was obvious but was not initially being caught is called TooLeaky.  And all it does is it uses a freshly launched instance of IE to send personal data out as parameters to the query, which is, you know, sort of clever.  That is, we know, for example, that when you have a URL and then the URL finishes, like .htm or whatever, and then you do a question mark, anything following the question mark are called "parameters to the query," meaning that the browser stops parsing the URL at that point, so it's bringing up the page that is defined up to the question mark, but it continues sending anything else after the question mark as part of the query.  Well, so if this is http://evilserverinrussia.com/randompage.htm, question mark, your credit card number, well, that's a problem.



So the idea is, what TooLeaky does is it just launches IE and puts that HTML parameter containing your data in the query, and out it goes.  So the problem is that your personal firewall may be set up so that it absolutely will not allow anything but IE to talk on the Internet; but this uses IE, the real IE, not a renamed IE, the real IE, to make a query.  And the moment that query is allowed out, your personal information has escaped your control.  So there's an example.



There's another one which was actually written by a friend of GRC.  Robin Keir hangs out in our newsgroups a lot.  He's a super sharp security guy.  He wrote, also sort of following on the concept of LeakTest, he wrote one called FireHole, meaning a firewall hole.  This demonstrates, and it was one of the very early demonstrations, something called "cross-process DLL injection."  The idea in Windows is that, back in the good old days when we didn't have security problems, Microsoft was creating all kinds of features into Windows API.  One of the things you're able to do in Windows is you're able to use a debugger to reach across process boundaries, that is, out of its own debugging process into another process.  And it's able to attach itself to that process.  You're able then to stop the threads of execution, basically stop that program from running and basically take it over, making the execution of that program go single step-by-step so you're able to watch it execute.  That's what a contemporary debugger is able to�do.



Well, one of the other things sort of in this mix of capabilities allows one process to essentially inject a DLL of its choosing into another process space, and cause that DLL to run.  Well, what that means is that Robin's FireHole program, it looks around, and it sees, oh, look, servicehost.exe is running.  Well, servicehost, for example, is where DNS queries come from.  So many people see servicehost.exe popping up and asking for permission to use their firewall.



LEO:  All the time.



STEVE:  All the time.  Exactly.  And so what Robin does is he injects his own - now, in this case it's not malicious, but in the case of malware it would be - he injects a small DLL into the servicehost.exe process and runs it.  Now what happens is, because the DLL, his own code is running in the context of that servicehost.exe process, which has permission, the firewall that is doing outbound blocking sees that it's servicehost.exe making an outbound query.  And that's permitted.  And so basically you've broken out, the malware has broken out of its own process space by injecting code into another process.  There's also one called YALTA, which is an acronym for Yet Another Leak Test�Application.



LEO:  But a good acronym.  I like it.



STEVE:  It's a good acronym.  PCAudit is another that also uses cross-process DLL injection.  There's one called AWFT.  It injects a thread into an existing running copy of a web browser like IE or even into Windows Explorer.  That's another thing you're able to do using the Windows API.  You're actually able to inject a thread of execution not requiring a whole DLL.  You're actually able to take a chunk of memory and map that memory into an unused area of another process, and then tell that memory to start executing a new thread of execution in that memory in order to get something to work.  There's another one called Thermite that's also a thread-injector.



And there's one called CopyCat that uses code injection without thread creation because some firewalls were becoming sensitized to the idea of threads being created by other processes.  So they blocked that.  But some guy said, okay, I can get around that.  So he writes CopyCat, which basically it borrows an existing thread from the application.  Basically, like a debugger, it stops that thread, notes where it was, saves the thread's registers and its so-called context, moves the thread over to its own code, runs that thread on its code, thus avoiding the need to create a new thread, then puts the thread back where it was and says, okay, go on about your business.



LEO:  Unbelievable.



STEVE:  So these are the kinds of things that are being done.  There's even one called MBtest, which uses the WinPcap drivers that I referred to a couple of weeks ago, very popular sort of raw packet monitoring and injection software which has been developed over the years.  It installs that down in the network stack below the firewall in order to bypass the whole process.  It just puts its own driver in the system.  Meanwhile the firewall is sitting there, you know...



LEO:  Everything's fine.  It's all good.



STEVE:  Exactly, watching all the traffic going by in the IP stack, but not being installed low enough in the system, and not doing anything to explicitly block that.



LEO:  How common is that exploit?



STEVE:  It was mostly done as a proof of concept.  You need to bring along a bunch of drivers.  And, for example...



LEO:  Pretty sophisticated.



STEVE:  Yes, a non-admin cannot install this driver on the fly.  So it would need to do a privileged escalation exploit in order to escalate its privileges to admin level.  Then it would be able to install this driver on the fly.  But the driver's actually very well behaved, and it's a beautifully written driver.  So, again, it takes advantage of that and just does something that the firewall was not set up to�expect.



There's one called WBreaker which uses Windows Explorer to launch Internet Explorer, or the command to launch Explorer, which then launches Internet Explorer.  The reason this chaining occurs, it's one of the things that firewalls do is look to see who is launching a permitted application.  Because notice that, remember earlier we talked about a piece of malware would be launching IE and using it to send its information out?  So again the firewall said, oh, we can fix that.  Some of them did.  And then the leaktesting guys just said, okay, we can get around that, we'll use Windows Explorer to launch Internet Explorer because that's normally what does launch Internet Explorer is Windows Explorer.  So that got around another set of firewalls that thought they had been tricky in preventing that.  It's like, nope, we bypassed that.



There's a second version of PCAudit that uses - because after some firewalls blocked PCAudit, which is one of those that uses cross-process DLL injection, the guy said, okay, I can get around that, and so he did with PCAudit2.  There is one called DNStest, which is very clever.  It uses the DNS client service, which is called servicehost.exe, it's one of the many things that servicehost.exe hosts is the DNS client service, well, your computer has to be able to make DNS queries because that's what it's doing all the time.  You go www.anything.com, and your computer needs to look up the IP for that.  Well, it turns out that you could make a bogus query which contained, for example, someone's credit card number as the URL domain that you're looking up.  And if it was set up right, it could be, for example, creditcardnumber.malwarerus.ru, and what happened would be malware, if there's a site malwarerus.ru were running their own DNS server, they would receive the query for the machine name within that domain, which is your credit card number.  And, for that matter, any other information that they want to tack on there because it could be credit card number dot expiration date dot residential address information or billing address dot dot dot dot, and send out a long DNS query that is your personal information.  And Windows doesn't know the difference.  It thinks that's a valid URL, and it slides right out through a DNS query.



LEO:  Unbelievable.  Wow.  There's no way to block something like that.



STEVE:  No, I mean, you would have to literally filter DNS and make some sort of heuristic decision about whether this looks reasonable or not, is that something that you want to allow to happen or not.  And, I mean, and the list goes on.  So, I mean, there's something called Surfer, there's Breakout v1 and v2, there's something called Jumper.  Oh, get this.  Jumper, for example, there's a registry entry called AppInit.  AppInit registry entry allows DLLs to be registered for automatic loading by Windows.  Well, now, there are reasons that would be useful.  For example, there are core DLLs in the system, like kernel,dll, user32.dll, gdi32.dll.  And those are fundamental parts of Windows.



Well, Microsoft thought, well, what if something comes along in the future that's another DLL that we just want any program to have access to?  So literally there's a registry entry called AppInit where anyone who wants to can add random DLLs to that.  And every time an application is initialized, Windows will dutifully look up the list of DLLs in that registry key and load all those DLLs into that application space.  Well, malware says, hey, what a cool thing.  Let's just register our self.  And the next time an EXE starts, we'll get our DLL loaded.  And that works.



LEO:  Unbelievable.  Just amazing.



STEVE:  So, I mean, it really is just phenomenal that essentially there are this many ways, known ways for malware to right now today get past every single personal firewall out there.  I will have the link in our show notes to this chart.  People can look up their firewall and see which of these exploits had even today never been handled despite the fact that all firewall makers know they exist.  It's very well known.  This site gets press from time to time, but never enough to force the firewall makers to fix the problem.  And their argument is that some of these things are outside the purview of a firewall.  They're more what's called HIPS, which stands for Host-based Intrusion Protection Systems, where the idea is something is in your system and is taking advantage, malicious advantage of features of the operating system for its own malicious�purposes.



Well, there are non-firewall HIPS management tools, which for example attempt to prevent these sorts of cross-process vulnerabilities from being exploited, basically by hooking and filtering the API themselves and verifying whether applications have a right to do this.  And it's worth noting that this is one area where Vista has really moved forward.  They have this notion of a protected application which is essentially beginning finally to put barriers around sensitive applications like your email application and like your browser, and preventing their exploitation by other processes.  And in fact we discussed this when we were talking about all of the additional DRM features that Vista has because that whole protected video and audio subsystem, it needs to protect itself from being, for example, debugged by debuggers who are going in and rifling through memory to find the HD-DVD decryption keys.



But I guess the point is that it's - I don't mean to raise a lot of alarm on behalf of our listeners, in our listeners' minds.  But the fact is, almost without, I think without a single exception, when I looked last, which was only a few weeks ago, there was no single firewall that was invulnerable to all of these known exploits.  Meaning...



LEO:  So the leaktest is kind of pointless.



STEVE:  Well, yes, that's the problem is that we have a fundamentally insecure operating system in Windows.  And you might argue that other operating systems that have not really rigorously maintained security as their No.�1 focus, they may similarly have become lax in various ways.  You could forgive Microsoft in the case of Windows for this because once upon a time security wasn't an issue.  Windows machines were not on the Internet.  There was no Internet.  And so what Microsoft's developers did was they said, wow, wouldn't it be handy if we could just run DLLs that we want to every time a process starts up?  Oh, yeah, let's add AppInit to the registry, and it'll do that.  Or wouldn't it be cool if we could, you know, we want to be able to debug any program in the system, not one that's, like, asking for us to debug it.  So let's just allow a debugger, which is to say any running program in Windows, to reach across into another process and take over its threads.  Whoa, wouldn't that be handy.



So, I mean, these things are very handy from a developer standpoint.  And they're your worst nightmare when you're trying to contain processes, and you want malware that gets into your system not to be able to really mess things up.  The fact is, Windows is insecure, and you might argue insecurable at this point because - and this is what Microsoft fears - if they lock it down too tight, it will break things.  And Microsoft never wants to break anything.



LEO:  Right, right, right.  So are you saying that there's no point in doing a leaktest anymore?



STEVE:  Well, it's why I have not taken the trouble to update mine, because you...



LEO:  You just can't test enough.



STEVE:  Well, yeah.  You get into that virus/antivirus, spyware/antispyware mode where it's like, okay, yes, I could write LeakTest 3 or SuperLeakTest or LeakTestPro or whatever you want to call it that does all these things, does everything I can think of.  The problem is there's still going to be other ways to bypass a personal firewall.  I mean, it's Spy vs. Spy at that point.  It's something in your system, and because of the nature of Windows there really isn't enough protection in the system to prevent malware from just doing what it wants to.



LEO:  Right.  Very interesting stuff.  I guess that - my sense is, if you can't test for leaks, a software-based firewall is kind of essentially worthless.



STEVE:  Well, we don't want to say that because it's certainly the case that, if you get a really good firewall which has taken the trouble to block many of these known exploits, then certainly it's the case that malware that is using those will be blocked.  Hopefully it raises an alert on your screen saying, whoa, something is trying to inject a thread over in Internet Explorer.  Here's the process name.  You need to go find out what that is.  So, I mean, and this, of course, this is what ZoneAlarm did for me when I was using the very first version in beta, was it said, hey, tsadbot.exe wants to use your Internet connection.



LEO:  Does sound like, though, that hackers and bad guys are well aware of this, and if they want to they can get around�it.



STEVE:  Yes.  Well, I mean, for example, just issuing a DNS query that sends data out as the DNS query.



LEO:  That's very clever.  You can't block that because DNS queries have to work.  I guess you could parse them somehow.  But even that wouldn't work because you don't know what a URL's going to look like.



STEVE:  Yup.  And again, they could also easily, you know, add ASCII 20 to every character or rotate the character so they no longer look like, you know, perform a simple encryption of your credit card number, turning it into other letters and characters.  And so it would no longer match, I mean, I've seen these firewalls, I just sort of shake my head, that would say, oh, enter in your personal information, and we're going to make sure...



LEO:  And we'll look for it.



STEVE:  Exactly.  We're going to look for it on its way out.  And it's like, okay, all you have to do is add "1" to every character, and it turns it into gibberish that then passes right through that filter.  So, I mean, that doesn't do you any good.



LEO:  Although on the other hand, I mean, you could make that argument about any security softwares.  Of course, once the software is out there, and bad guys see what it's doing, they can write around it.  And so that is that escalating, that vicious circle that you've been talking about.



STEVE:  Yeah, it really does.  And, I mean, again, what you want is you want to prevent stuff from getting into your machine.  Now that we've got firewalls up, we've got routers in place, we know that random buffer overflows that have existed and probably still do in all versions of Windows, those are not remotely exploitable because incoming unsolicited packets are dropped.



Now the problem is, as we've said, it's things like scripting exploits, the fact for example that Microsoft ActiveX controls can be instantiated by IE and run code in a way that is unsafe.  The way that happens is you've got scripting on your browser, or you visit a malicious site.  Apparently it's happening to people all the time.  So, you know, I would say the attack surface, as the term is, is much reduced in Windows, so that we're no longer seeing Code Red worms, you know, just literally exploding across the Internet in a few hours.  That's not happening.



But hackers are using everything at their disposal to still get into people's machines by having essentially themselves invited into the machines.  And once there, I mean, as these links on the show notes page demonstrate, there are ways around outbound through every firewall, which is not to say having a firewall there that's doing the best job it can is still not better protection than none at all.  It certainly is.  But I don't run one.



LEO:  I'll tell you what I run.  I run that Astaro Gateway.  That's what I run.  And I just cross my fingers.  But, you know, I have to say, I mean, I haven't been bit.  I think a lot of it is - in a long time, I mean, it's been years since I've had even a spyware infestation.  I'm sure that's true for you.  And I think so a lot of it really is user behavior and how you use your computer, what you do on the Internet.



STEVE:  Yes, it is absolutely a matter of recognizing and appreciating the dangers, as certainly our listeners do, and moderating your behavior so that you're doing, I mean, that you're acting safe.  I have to say, Leo, I mean, there have been situations where I have known I was going to be exposing myself to trouble, but I had to go somewhere unsafe.  I did it on essentially an expendable machine.  And sure enough, this thing downloaded a bunch of junk in, and I saw services starting up.  And, I mean, it was obvious to me that I had just done something really wrong, but I had to go where I needed to go.  In this case I used essentially a Typhoid Mary machine that was my disposal image, and then I re-imaged it afterwards, after getting done what I had to get done.



LEO:  That's another good thing.  Anybody who listens to Security Now! probably should have a operating system image that's clean, known clean, and can be quickly reinstalled.  And keep that up to date.  That's a very handy tool in this kind of thing.



STEVE:  Well, of course, and a true, a virtual machine that�is...



LEO:  That's a great way to go, yeah.



STEVE:  It's a safe place to play, yes.



LEO:  Yeah.  It's unfortunate, I mean, it's the people who get bit by this the most are the least sophisticated users, and those are the ones who are buying PCs that don't come with Windows install disks.  They don't know about making images.  They're the ones that are going to get bit, and they're the ones who are the least prepared for it, frankly.



STEVE:  Right.



LEO:  Anybody who listens to this show I think is probably safe.  But there you go.  Let me remind you that the place to go for all of your security software, and even LeakTest, should you decide to buy it, or download it for free, I should say, is GRC.com.  That's also where you'll find 16KB versions of this show for the bandwidth impaired, Elaine's great transcriptions so you can read along as you listen, and Steve's many free security problems besides LeakTest - Wizmo, Shoot The Messenger, DCOMbobulator, and of course ShieldsUP!  That's tested over 40 million PCs.  That's an amazing number.



STEVE:  Yeah.  I think we're at - I don't remember now what the number is.  I look every so often, so.  And again, I just want to say one more final thanks to our listeners for coming to the call and voting for this podcast, Security Now!, as...



LEO:  The best technology and science podcast in the world, ladies and gentlemen, and you're listening to it.  Isn't that great?



STEVE:  I love it.



LEO:  Nice feeling to get that.  Thank you very much to all the voters and to the PodcastAwards.com for giving us that award.  I mean, this is, I think, their third or fourth year that they've done this.  And it's just a - it's important, I think, to do this, to acknowledge all the hard work people put into their podcasts.  Or netcasts, as we call them.



Hey, thanks, Steve.  We'll see you next week will be our Mailbag episode.  Get your cards and letters in, folks.  Thanks for joining us on Security Now!.





Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#106

DATE:		August 23, 2007

TITLE:		Listener Mailbag #2

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-106.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo open the Security Now! mailbag�to share and discuss the thoughts, comments, and�observations of other Security Now! listeners.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 106 for August 23, 2007:  Mailbag #2.



Time to talk about security, and it�s a listener mailbag episode.  Steve Gibson is here from his secure lair, soon to be tented and fumigated secure lair, in Irvine, California.



STEVE GIBSON:  Yes, indeed.  I�ve got to tell you, Leo, when I�m going through the email we receive in order to pull questions and actually comments, listener comments for the mailbag, it gives me such a great feeling because we get so many people who are saying that this podcast matters to them so much.  I mean, I had one guy who just said, I just wait for Thursdays.  I look forward to�Thursdays.



LEO:  That�s so neat.  Wow, I love that.  Well, and that�s why it�s nice that you�re so consistent with it because nobody is ever left behind.  No podcast left behind.  That�s our philosophy here.



STEVE:  Yes, come rain or sleet, snow or termite fumigations, there will be a podcast.



LEO:  Now, are they doing poisons, or are you going to have, like, orange peel injected into your home?



STEVE:  No, it turns out there was a huge amount of anti-fumigation sentiment among the homeowners.  People just didn�t want the inconvenience of being pushed out of their home for a couple days.  And there are, it turns out, a whole bunch of spot treatment type things, one of which you mentioned is this orange oil.  And it turns out that spot treatments can function - unfortunately I�m way more of an expert on this now than I needed to be.  Spot treatments can function when you know exactly where the problem is, and if it�s a localized problem.  But you have to be able - first of all, you have to know where the problem is, and you have to have access to it.  There�s also actually an effective approach is heat treatment.  You can actually just heat the little buggers to a point...



LEO:  Right, cook �em.



STEVE:  ...where they, exactly, they get cooked.  And speaking of that, there�s microwaves.  There�s electrification.  You can...



LEO:  I�ve seen, yeah, there�s a lot of different things.



STEVE:  ...shock them.  But the problem is, nothing really deals with whole structure problems better than fumigation.  And frankly, we�ve got spiders coming out of the woodwork, literally, also, and those little mud wasp nest little things that...



LEO:  Oh, yeah, you know, it�s - yeah, don�t mess with it.



STEVE:  It�s just, you know, it�s a wild life over here.  So I�m really looking forward to, like, the day after I can come back in, I�m going to knock down all those little mud huts that the wasps have created because I know that they will be empty and/or deceased, and they�re not going to come out and get me for knocking their little igloos down, so...



LEO:  They won�t be mad.



STEVE:  Anyway, yeah, it�s never a dull moment.  So as a consequence you and I are doing two podcasts today, since next week I will be away from my machines.  Actually I�ll have a laptop at Starbucks, so I�ll be hooked into the world; but, yeah.



LEO:  You�re going to spend the night at Starbucks, as well, or just...



STEVE:  Actually I was joking with a friend who was saying, where are you going to be staying?  I said, oh, I�m going to stay at Starbucks. 



LEO:  Just keep those quinti venti lattes coming.



STEVE:  Exactly.



LEO:  Let�s see.  Do you want to do - I know we don�t have any errata from last week.



STEVE:  We don�t.  Although I did get a nice note that I wanted to share with people, sort of a reminder of an unusual application for SpinRite.  This was actually the result of a posting on our newsgroup server.  When I was up in Canada with Mark Thompson a couple weeks ago, one of the things that he brought up was he said, you know, Steve, you really ought to consider affiliate marketing for your stuff.  And it�s not something that I had thought about.  But I thought, well, let�s discuss it in the newsgroups because, I mean, the GRC newsgroups are just, I mean, I will again commend our listeners to think about it as a - if they�re interested in security and technology and this kind of stuff, it is a traditional news server, a so-called NNTP news server.  But anybody with Outlook, Outlook Express, what�s the - is it Thunderbird, I guess, is the communications tool like from the open source folks, you know, these are all very good, workable news readers.  I use Gravity, and just because I have for years, and it�s powerful and does what I need.



But anyway, the point is we�ve got a fantastic bunch of newsgroups and, mostly, people.  Of course it�s, you know, the people that make the newsgroups.  And so I said, hey, guys, this affiliate idea, the idea of giving essentially a commission to people who forward people to our site, who end up purchasing SpinRite or other stuff in the future, that�s sort of the concept, you know, what do you guys think about it?  Well, what ensued was a long discussion that ended up putting me off of the idea, just because to do it really right and prevent there from being a problem of, like, flaky affiliates, or spamming affiliates who would become an affiliate and then spam in order to, again, in a shotgun fashion, sort of get people to go to GRC, I certainly don�t want any affiliation - no pun intended - with such people.��So...



LEO:  And that often happens.  I have to say I�ve seen, you know, a lot of antivirus companies use affiliates.  And it tends - it�s hard to control them.



STEVE:  Yeah.  And that�s just not my thing.  I don�t want to, I mean, I love the fact that I�ve kept my life and my operations of my little company as simple as I have.  And, you know, just adding some wildcard that has a strong possibility for failing seems like a bad idea.  Anyway, Skip was responding in this thread and actually quoted me saying, "My feeling has always been that SpinRite was too narrow an appeal for shotgun marketing to work well enough."  And he responded, "Yes, always purchased in time of need."  He said, "Saved my hard drive when I bought SpinRite in distress, and two other family drives a year later."  He said, "Now for the testimonial.  My father bought SpinRite preemptively," he put in quotes, "because of my experience."  And he says, parens, "(It didn�t hurt that he was already a Steve Gibson fan for years, for reasons I am not sure of.)"



LEO:  I have no idea why.



STEVE:  We don�t know why, but he seemed to like you.  "Did not use it much, if at all."  And then Skip says in parens, "(He and I are like this.  Buy a good product on principle if we are likely to need it in the future.  In this case, he has never used SpinRite to recover lost data or fix a problematic hard drive.)"  So then he says, "Then his TiVo failed.  Random skips and jumps in recorded programs.  From Steve�s Security Now! podcasts, I suggested that my father dismount the drive from his TiVo box and run SpinRite on it.  Voila.  One VERY," in all caps, "happy father who did not lose a couple of programs he didn�t want to go without."  And he said, parens, "(And they are not soaps.  They�re science programs.)  And now a rock solid, fully functioning TiVo.  Without the Security Now! podcast �advertisements� about working even with TiVo, I would never have thought of suggesting SpinRite in this situation."



So that was Skip�s note.  And I just wanted to remind people of that.  The fact is that, you know, essentially SpinRite will run on any drive anywhere, and even in the increasingly popular DVRs that can get hot, that do tend to use their drives extensively.  And, you know, I�ve gotten lots of email from people who said, hey, you know, SpinRite fixed my DVR.  I didn�t know it would, but I�m glad.  So I just want to remind our listeners that that�s the case, in case people haven�t heard me mention that before.



LEO:  It�s operating system and file system independent.  It doesn�t operate at that level.



STEVE:  Right.



LEO:  Way below that.  And so, yeah, because people have used it on iPods, use it on a Linux box, doesn�t matter.



STEVE:  Yeah, in fact, in reading through email this morning to prepare the set of - I don�t want to call them questions.  Questions is what we tend to call them.  But mailbag are more sort of commentary stuff, you know, interesting things that our users are feeding back to us about their discoveries or their solutions or whatever.  But one of those was a guy who discovered that SpinRite would run in a properly configured VMware box on his Linux machine.  He was using Linux, and he had VMware running on it, and there�s a mode in VMware where you can give that virtual machine direct physical access to the drive, which is what SpinRite needs.  Now, this has raised a question that I haven�t answered, is would VMware running on a Mac so configured also allow you to run SpinRite on a Mac because the...



LEO:  Without booting out of it.



STEVE:  Well, the problem is the Mac is EFI based.  The Intel Macs use another generation of the BIOS from what SpinRite was born and bred on, the B-I-O-S, the basic I/O system, input/output system.  And SpinRite is still dependent on some of the BIOS functions which are not present in the EFI.  So you can�t boot SpinRite on an Intel-based Mac directly.  And what we tell people is, well, I mean, if you�re - well, of course it means that it�s very inconvenient to run it just occasionally to prevent, in a preventive maintenance fashion, to prevent there from being�problems.



LEO:  You�d have to pull the drive out.



STEVE:  Right.  And people do, and it fixes their Macs that way.  But it�s, you know, it�s a pain in the Mac, so...



LEO:  Right.  I don�t know.  We�ll have to try it.  This new VMware, I�ve been playing with it on the Mac, and it�s pretty impressive.



STEVE:  Version 6?



LEO:  Fusion, they call it.  It�s the Mac version.  And it�s�only $80, which is nice because the big boy VMware is very expensive.



STEVE:  And that�s different, obviously, than Parallels because I know that Parallels has this new feature where you can run Windows, like, windowed right there alongside your Mac application.



LEO:  And VMware does that, too.  They have a different name for it.  But it�s the same thing.  And I would say, feature for feature, VMware is pretty much identical to Parallels.  The only thing, of course, VMware adds is those appliances, that you could run the VMware appliances, which is kind of�neat.



STEVE:  And actually we�re going to have a mention of that in our mailbag.



LEO:  Well, let�s get to the mailbag.  This is our second mailbag episode, and Steve�s asked me to read the questions after the first one.  So I�ll be your voice.



STEVE:  You�re the reader, Leo.  You do a great job with�that.



LEO:  It�s my profession.  So Mike Gunn starts us off.  He listens in San Francisco.  And he says irises do change.  We were talking about irises as a biometric tool.  And he says, the last time I went to the optometrist with my kids, he told me that they suggest taking a picture of the iris.  As you age, things like diabetes and the like changes your iris and how it looks, and they can even see signs of disease by comparing the original picture, the baseline picture, with a new picture.  And he mentions Robert Heron, who came back, I don�t know, did he have a detached retina?  He had to have some sort of eye surgery.  So that would have changed his iris, I guess, as well.  He also says, you might ask the optometrist for a copy of your iris for an extra-special desktop picture.  Irises are pretty.  It would actually be beautiful, wouldn�t it.



STEVE:  Yeah, in fact there was a - I was looking at one the other day, coincidentally.  The most recent issue of Scientific American has an article about how the movement, the twitchy movement of our eyes which actually Jeff Hawkins talks about in "On Intelligence," and how it�s necessary that images be in motion against our retina, and our eye is constantly twitching in order to create a delta, essentially, a changing image on our retina, which is what our brain needs in order to process images.  Anyway, there this one photo of just a spectacularly, and I guess it�s unretouched, but it�s a spectacularly symmetrical-looking iris.  I know that when I stare at mine, as I do from time to time because I�m a hard contact lens wearer still, you know, my iris does have some character to it.  It�s, you know, it�s got some wigs and wags.  And, you know, I could see how mine may not look like anybody else�s.  But this one in Scientific American was just, like, just beautifully symmetric and clean-looking and different than mine.  Maybe it was a young iris, and mine�s getting old.



LEO:  And we should point out that your fingerprint changes also.  But I think it�s if they�re looking at basic fundamentals, then those don�t change significantly.  I wouldn�t - I don�t think they expect it to be identical any more than they expect...



STEVE:  Right.



LEO:  Martin Yeomans of Memphis, Tennessee has, speaking of Jeff Hawkins, an interesting question.  He says he�s an occupational therapist and a member of Mensa.  Big brain-type guy.  He had some interesting thoughts after reading "On Intelligence" by Jeff Hawkins.  He says he heard an article on NPR a couple of years ago about research at Dartmouth relating to the auditory cortex.  He actually gives us a link to the story.  It�s still up on the NPR.org�site.



[http://www.npr.org/templates/story/story.php?storyId=4533543]



But it�s interesting, what they would do is they would play music while monitoring the activity in the auditory cortex, the part of your brain that�s hearing the music.  When the music stops, so would the activity.  And except if you knew the song.  If you knew the song, your brain would continue along as if it were filling in the gaps.  Which is, I think, fascinating.  So he suggests this might be useful in national security.  Get this.



STEVE:  Uh-huh.



LEO:  While monitoring a subject�s brain waves, with or without his knowledge, expose him to iconic music from the various regions of the world - the U.S., Europe, the Middle East, China.  Determine which ones he�s familiar with, based on his involuntary audio cortex response.



STEVE:  Isn�t that kind of a cool idea?  I thought that was really interesting.



LEO:  It is.



STEVE:  It�s like a way of extracting whether somebody is familiar with specific music that they would be familiar with or not based on their history.  And it�s a way that your brain gives that away involuntarily.



LEO:  Well, and by extension, as you get better at monitoring the brain, there�s all sorts of things you can learn.  I mean, you could make a pretty good lie detector test that way, I would imagine.  Anyway, he says, do you think this technology could be used as part of a multifactor security system?  Instead of a password, get this, you learn a song.  When I want access, the system plays snippets of music to me and measures my brain�s reaction.  In a few seconds I can prove that I�m me in a way that could not be spoofed or defeated.  What do you think?



STEVE:  Well, I read the story, or I listened to the blurb on NPR and tried to poke around and do some more research so that I could find out exactly what it means to do a brain scan.  As we all remember, there is, like, you know, you can attach electrodes all over your scalp, and you can pick up so-called brain waves.  And we�ve all seen the medical shows where they say, oh, no, this person is in a coma, he�s got no brain activity because he�s got, you know, 12 lines are all flat, and there�s no little high-frequency or low-frequency stuff.  And then of course there was alpha waves that would show this, and beta and theta and so forth.  But in order to determine specific auditory cortex functions, you need either little probes that have been poked down into your gray matter or some sort of, you know, the article just refers to it as a brain scan, and there�s no other detailed�information.



So it seems to me this is going a little far to acquire something you know.  And actually he makes a point of asking the question, should this be considered something you know or something you are, because of course the nature...



LEO:  Right, it crosses the line.



STEVE:  Exactly, it really does because the nature of this is we�re asking your brain, which is something you have...



LEO:  And you are.



STEVE:  ...or I guess something you are, it�s asking your brain involuntarily whether this is something you know or not.  But anyway, I thought it was just a fun comment from a listener that I wanted to share because I think it�s impractical from the standpoint of we don�t currently have the technology to, without a great deal of inconvenience, do a scan of a particular region of the brain at the level of resolution and specificity that this kind of test would require.  But, you know, a cool idea.



LEO:  Interesting, absolutely.  Absolutely.  Daniel Barber must be a sysadmin because he�s worried about U3.  He�s even more worried about U3 than we are.  We talked about these USB U3 drives.  He says it�s even scarier, it�s possible - just to remind you, they�re the drives that automatically - the thumb drives that automatically load software using this U3 technology.  He says it�s possible to create a custom CD ISO, use the U3 updater application to flash the drive with that custom CD-ROM ISO, thereby allowing any application that can normally be run through the autorun command on a regular CD-ROM to be executed when the U3 drive is inserted.  Basically that�s how U3 works, is it mounts a CD-ROM ISO.



STEVE:  Right.



LEO:  He says there�s already an online community creating USB appliances using this technology.  There�s one called Switchblade that allows a user to quickly grab Windows logon hashes, stored passwords from IE and Firefox and so forth, and store that info on the thumb drive.  Another, USB Hacksaw - this is a good one - installs a compromised VNC server on the host machine, opening it up for further attack and remote control.  We�ve actually demoed this on Call For Help some time ago, over a year ago, with a U3 drive.  It�s really scary.  He reminds us about iPod slurping, too, which has been around as long as iPods have been around.  And for a while people would go into the Apple Store with their iPod, plug it in, and copy the software onto the iPod and then leave.  He�s looking into ways to disallow USB drives completely through group policy, GP edit on my network to try to mitigate the threat.  I agree.  I think an autorun, automount drive is not a good idea.



STEVE:  Well, and I guess this caught my attention because it brings up a good point, which is that USB - the whole USB interface, as convenient as it is, is also a potential serious security threat, which of course corporations are now becoming increasingly aware of as time goes on.  I mean, the drives are called thumb drives because, you know, obviously they�re the size of your thumb.  So they�re very easy to get in and out of somewhere.  And something like this USB Switchblade, where literally you could approach a machine, plug this thing in, thanks to the fact that it�s U3-based technology which automounts a CD, you could have that CD run anything you want to.  And in this case the idea is you approach a machine, you just stick this little USB thumb drive into the system, it immediately runs software which sucks out a whole bunch of potentially incriminating and private information from the machine, and then dismounts�itself.



LEO:  Well, it�s worse than that, Steve.  Actually Darren Kitchen on Hak.5 showed us a very common hack, where you walk up to a library, plug in this USB drive, it autoruns.  What it does is it copies a trojan onto the system which logs everything for the next week or whatever.  Then you come back, plug your drive in, it says, oh, the trojan is already installed, and then copies the data from the trojan.  So it�s an even worse attack because it�s basically a keystroke logger.



STEVE:  Right.  It seems to me, and I know of many corporations that are now deliberately disabling the oh-they�re-so-convenient USB interfaces on the machines that they deploy throughout their enterprise, you know, again because their policy is, look, employees, we do not want you bringing your stuff from home.  Of course a USB, even in a  benign application, is a potential vector for infection.  If someone brings infected applications or spyware-laden applications from home because they want the convenience of having access to those things at work, then USB is the means by which those can travel and transit.  And so it really does represent a growing security threat to machines that you want to have otherwise locked down.



LEO:  It�s fairly easy to turn off autorun, however.  It�s a simple reg hack, or you could do it in the autorun setup, and then it wouldn�t autoboot the...



STEVE:  Right.  And, you know, many security-conscious people, it�s one of the first things we do is we say, hey, I do not want a disk inserted in, even a regular CD, inserted into my computer to take off and run.  I want to have the opportunity to open a browser, you know, the Windows Explorer and look at the disk and then deliberately run what I choose to run.



LEO:  Yeah.  Abhi Beckert of Cairns, Australia says - he has a good point.  We talked a little bit about how videos and JPEGs could be dangerous.  We even speculated you could be infected by going on YouTube.  And of course he points out that that�s not possible.  He says, first of all, that sites that allow you to upload JPEGs often resize the JPEG and change the compression level.  And at that point that would damage any buried malware in there.  YouTube, of course, converts everything you upload to Flash.  So if you�re looking at a YouTube Flash video, it�s been munged enough that anything that was embedded in the original video would no longer be a vector of attack.



STEVE:  Yeah, I really liked his comment.  And he�s absolutely right.  And I thought it was very useful to sort of share this notion with our listeners, the idea being that what it is in a, for example, in a JPEG, we do know there are JPEG exploits.  And it�s certainly conceivable that there would similarly, and this was what we were talking about two weeks ago in Q&A #22, that there could be video exploits, the idea being that an otherwise valid image, for example, in the JPEG case, would have deliberately corrupted, that is to say deliberately designed data that would force a buffer overrun, a buffer overflow, just like data coming in over the Internet is able to do so in, unfortunately, so many Internet-connected applications and components.  So you would have something that looks like a JPEG image, inasmuch as its extension is .JPG.  When Windows then, or whatever operating system was the target of this, tried to display it, because of a vulnerability, a bug in the display code, this deliberately crafted, sort of pseudo-JPEG would allow program code contained in that JPEG file to be run on the computer.



So the point is, and this was the point that this listener was raising, is that when you do anything to this image which is going to reprocess it, for example you�re going to resize it, you�re going to change the compression level in the JPEG, you�re completely interpreting the image back into image form and then recreating it again in a valid format.  So that process of making any change to it would completely just blow out any malware that had been hidden in the image.  And so he really  makes a very good point.  He also says that, you know, if you went to some maybe off-the-mainstream site - he called it a "knockoff site," that, well, if they weren�t doing reprocessing, if they were just posting these things up, then you�d still have this problem.  But it�s certainly the case that any time you convert that to a real image and then recompress it, you know, the bad stuff is�gone.



LEO:  In the example we used, which was an embedded JPEG in a banner ad, the most notorious one is the one that happens on MySpace, but it�s also happened to Tom�s Hardware, those are being served up complete and full of the hack by the ad server, so...



STEVE:  Yeah, that�s a very good point.



LEO:  That�s very different.  So you shouldn�t assume that video is safe.  But you�re right, if it�s on a site where you upload something to the site, and the site modifies it, that modification kills any bad germs in there.



STEVE:  At this point it really would.  Now, it�s worth mentioning, just to sort of cover the bases, that from early 2006 the Windows Metafile exploit was not a buffer overrun, remember, it was a function of Windows Metafiles which had been designed in from the beginning.  So there�s an example of a valid image format which would survive this kind of�change.



LEO:  Oh, interesting, okay.



STEVE:  So I guess the point is that there are two types of problems.  There�s a valid use of something that Microsoft didn�t want to keep in that format, which was designed in from the beginning, which was always the point that I had made; and there are flaws in the image rendering code which can be exploited, which is a very different kind of problem.  And of course that would get completely pruned out.



LEO:  Right.  Jared in Calgary, Alberta, Canada has a clever web spam bot avoidance trick.  We were talking about CAPTCHAs as a way of avoiding spambots.  He�s come up with a solution that blocks 99.9 percent of the spam sent to his blog.  Well, wow.  I want to know about this.  So does the world.  He calls it a "double honeypot."  My online web form has three email fields, one that is hidden using CSS styles.  In fact, to add to the complexity, inherits it from a parent container.  So it�s not even immediately obvious what�s going on if you look at the CSS.  I found that most bots fill in all the email fields, just one, or just the first two it encounters.  The hidden one is the second one.  So, he says, if it doesn�t fill in the second visible email field, the form rightly complains, as if he were a regular user.  However, if the data is filled into the invisible field, which I guess only a bot can see, it will assume a bot, as there is warning text if the user has CSS disabled to not enter data into the field, and the form reports success in sending the comment even though it just goes straight into the bit bucket.



Now I don�t have to go to WordPress anymore to filter out the cruft nearly as often, it just automatically goes straight to the garbage.  The few spam comments that do make it through my honeypot I think are actually people plugging in the spam - by the way, it�s happening more and more, it�s not robots, but anyway - but I have the time to moderate those comments easily now.  I find this an ideal compromise that won�t turn away potential commenters with confusing and/or frustrating games.  Interesting idea.



STEVE:  I thought it was a cool idea.  So he clearly has the typical, put your email address in here, and then for confirmation put it in again, which we�re all used to because people have a tendency - in fact, Leo, you�d be surprised how often people don�t type their email address in the same way twice.  It�s...



LEO:  I�m not surprised.



STEVE:  It�s amazing.  Anyway, so he�s got that.  But what he cleverly did was he essentially created, in terms of the flow of his page, he has a second field in between the first and what looks like the second, but which is actually the third in terms of his actual HTML.  And naturally bots will tend to either fill in two or fill in all of them because they, too, need to confirm that they�ve specified their email address properly each time.  But by deliberately making the second one invisible, humans will only fill in the first and third, and the bot doesn�t know to do that.  Anyway, I just thought it was very clever and a sort of a simple way of dealing with at least bot spam on websites.



LEO:  Very interesting.  Brendan writes from Bismarck, North  Dakota with a discovery.  I discovered something that may be of interest to you.  You may recall the thumb drive discussion, it was unlockable via biometrics.  Here�s a thumb drive that is only accessible using the correct built-in keypad combination.  Oh, a combination thumb drive.  It�s a combination lock thumb drive called Flash Padlock, made by Corsair.  Any thoughts or opinions on a thumb drive like that?  Well, see, I think that would work great.



STEVE:  Well, actually it is pretty cool.  It�s either $29.95 for the one-gig version or $39.95 for the two-gig.  It�s got five buttons.  So you�ve probably seen those, like, door locks on cars where they have buttons, one and six share the same button, and then two and seven, and three and eight, and so forth.  So instead of being a ten-key pad, it�s a five-key pad.  It�s a dongle...



LEO:  Is that any better than a five-key pad, because it�s got two numbers on it?



STEVE:  No, no.



LEO:  It�s five keys.



STEVE:  Exactly.  I think the only reason they do that is that someone can say, okay, my combination is 32678...



LEO:  They can use all nine digits so that they can make it be something, anything they want.



STEVE:  Maybe they want it to be, like, their birthday or their date of birth or their social security number or something, you know, horribly insecure like that.  But still we want to give them all their numbers that are on there.  Anyway, so okay.  This thing, it�s a longer dongle, so that it�s got room for all this.  It incorporates a three-volt lithium cell.



I should mention, Leo, that I�ve ordered two of them, they�re now on the way, because I need one to play with and one that I�m going to open up because I just want to see what�s inside.  It doesn�t apparently actually encrypt the contents.  The company they got the technology from has a more fancy powerful one where the code you enter is used as the cryptographic key to perform on-the-fly encryption and decryption as the data is flowing to and from the flash ROM that�s also contained inside.  So this one is somewhat less secure in that I�m almost positive, although I couldn�t verify this from any of the documentation on their site, it basically functions as a traffic cop in between the flash ROM and the USB connector so that only if you enter all this in do you end up being able to connect to your flash drive.  Which would mean that, if the NSA or the FBI or somebody really, really wanted to get at the data on this drive, they would be able to do so by...



LEO:  They just open it up.



STEVE:  ...opening it up and then rewiring it and bypassing the out - there�s a little extra security chip.  But for many people I think this really functions as a very nice solution.  Of course there�s no software running on your system.  It�s platform neutral - Windows, Mac, Linux, anything.  You could plug it into a Coke machine that had a USB connection, and it would work just fine.  So it�s a neat idea.  It uses this little battery because sometimes it might be inconvenient to have to dial the combination when the USB drive is in its, you know, like mounted on the computer.  It might be behind your laptop or upside down or�something.



So the way it works is you�re able to press - there�s a sixth button that has a little key symbol on it.  So you press that to sort of wake it up and turn it on.  Then you have five seconds to begin dialing your combination, which can be up to 10 digits long.  I was very glad to see that.  It�s not like it�s a three-digit PIN or something.  It could be really hard to brute force.  And then, once you do it, that little - it�s got also three lights, a red, a green, and a blue light.  The blue is for access, and then the red or green have different UI functions, saying I�m locked or I�m not locked.  So it then unlocks it, and you then have 15 seconds, which actually, if you look at the clock tick, 15 seconds is a long time, to get this plugged into your computer.  So you don�t have to have it plugged in while you�re unlocking it.



Anyway, I really think it�s a cool solution that�ll have many nice applications.  So I wanted to bring it to our listeners� attention.  The company is Corsair.  And if you just put into Google, my favorite starting place always, you just put in "flash padlock," you get a bunch of hits.  I got mine from Amazon.  It�s actually more expensive on Amazon; but I like Amazon, and they know who I am and all that, so I was willing to pay a little more for the security.  There�s a company that I�ve used in the past, called ATACOM.com, is another good supplier.  And they�ve got them at that $29.95 and $39.95 price.  And, you know, on first blush, this looks like a nice little gizmo.  I�ll report back after I�ve received mine and had a chance to play with them.



LEO:  Miles Bosworth of Asheville, North Carolina says he�s dubious about PayPal.  He�s one of the people who, he says, purchased SpinRite without a need at the time I purchased it, but in appreciation of the effort you put into Security Now!.  Incidentally, since he�s purchased SpinRite, it�s paid off.  He repaired his wife�s laptop that wouldn�t boot and fixed a friend�s PC which was stumbling over multiple disk errors, so he�s glad he had it.



But actually he�s writing about PayPal.  We were talking about the PayPal Security Key, and of course I use PayPal for donations.  He says, as a very infrequent PayPal user, using it only for purchases that I make online, with no plans to sell stuff or transfer money to family, et cetera, I use PayPal only when it�s the only option, primarily because I disagree with their policy of arm twisting for me to submit what I see clearly as unnecessary and potentially dangerous, to me, information to anyone, including PayPal.  Specifically, why is PayPal so darn insistent about having me verify my account by sending them information about my checking account?  I only use a credit card for payments.  And there�s never been an issue with any transactions.  Yet I continue to be hounded by PayPal about verifying.  I noticed this myself.  They always ask you.



STEVE:  And Leo, the reason this is here is I feel exactly�the way this guy does.  But let�s keep going with his comment.



LEO:  He says, I have a very low comfort level with sharing additional financial account information, specifically my checking account, which in turn links to my credit and savings in the form of overdraft protection I have in place.  I�m not going to grant what I see as excessive and possibly very dangerous access to a checking account that�ll never be used in any manner in any transaction with PayPal.  I�m not even comfortable that, when I enter my credit card information, I don�t have the option not to add this information, which PayPal automatically retains.  I�m never given the choice.  I got into a fix with them several years ago where, after going back and deleting a card, I could not use that card again on PayPal.  I don�t know if they still enforce that silly little rule.  Otherwise I never leave my credit card info on sites that have that feature, such as Amazon, which gives you a choice at the time of purchase.  At the bottom of the last email I got from PayPal confirming my transaction - and he pastes in the whole "get verified" pitch, which basically means you give them checking account�information.



The way they verify it, by the way, is they deposit two random, very small deposits of just a few cents into your account; and then they ask you, did you get these deposits?  And if you say yes, then they say, okay, it�s your account.  Or something like that.  Or they ask you what the amount is, and if you tell them the proper amount, then they say, okay, you�ve verified it.  And he says, maybe I�m being a bit paranoid, but I�m not about to let PayPal or any other company have access to my accounts when there�s absolutely no need.  Multiple communications with PayPal questioning this has only resulted in some canned, boilerplate responses and nothing I would see as a valid reason.  You know, we should have asked that of our guest a couple of weeks ago.



STEVE:  Yes.  I wish we did.  This is exactly - this is what bugs me so much is I don�t understand - maybe you do, Leo - what it is about PayPal that has them desperate for my checking account information.  But there are sites that will, for example, only ship to a so-called "PayPal verified address."  And then there�s this notion of not being verified.  I finally had to do exactly what this guy did, which was, okay, fine, and gave them checking account information.  They did exactly as you said.  They deposited some little specific amounts into my account; I had to tell them that they had.  Well, then, I�m verified.  Yay.



Except that now this PayPal always defaults to wanting to pull money from my checking account, which, you know, which is a problem because my bookkeeper runs that for me.  I don�t want to have to be constantly telling her what I�m doing.  It�s so much more convenient to have PayPal pull from my credit card.  And, you know, once money is pulled from your checking account, it�s gone, as far as I know.  I don�t know how much, you know, insurance or protection PayPal gives.  But basically I don�t want money pulled from my checking account.  The problem is there�s no way to change the default that I have been able to discover.  And I�ve looked around PayPal�s site.  So every single time I now buy something from PayPal, I have to go in and, when I�m authenticating myself, change the funding options, go in, tell it no, don�t take it from checking, take it from credit card.  Then they give you like an "are you sure" screen, telling you why this is really not what you want to do.  I mean, it is just infuriating.



LEO:  Well, I could tell you a couple of things, not to justify it, but I can tell you a little bit about...



STEVE:  To explain it.



LEO:  To explain it.  First of all, they have to pay credit card fees, and so they prefer not to.  So the transaction is cheaper for them if it�s directly from your account.  So that�s the primary reason.  You�d think they�d offer you the option, and I see no reason not to.  The verification, I think is - they might have a case here for it being a legitimate security thing.  Remember, the biggest problem that PayPal and any system like this has to face is fraud,�somebody...



STEVE:  Credit card fraud, right.



LEO:  Yeah, and somebody posing as somebody else.  So the authentication really does then verify your person, who you are.  They�ve got your credit.  They�ve got information.  Right?  And I think that that�s, you know, that would be the excuse they would give.  I agree with you, and I wouldn�t verify for the longest darn time.  At some point they stop you from - they won�t let you do any more transactions.  You actually have to verify after some...



STEVE:  Or I think maybe is there a transaction limit, where you can only do a certain amount of money...



LEO:  Yeah, something like that.



STEVE:  ...unless you�re verified?



LEO:  Yeah, something happens.  I ran up against a limit.  And I think I finally verified.  And of course it�s been completely safe.  I think they have a safe system.  And I think the verification is one way they have of making it safe.  I mean, at that point it would be much more difficult to defraud people once you�ve been verified, right?



STEVE:  Yes, and I�m glad I�m verified.  I mean, it is a benefit to be that.  I just wish that they didn�t constantly fight you over where money is going to be...



LEO:  They should allow you to choose your default money source.  That�s ridiculous.  And frankly I think that that�s, you know, it�s unfortunate - I understand his reluctance to give that information.  I was very reluctant, too.  And PayPal has in the past certainly had not the best�- a checkered past.  And I think a lot of people still remember those days and aren�t sure that they want to trust�PayPal.



STEVE:  I do think they�re doing better.



LEO:  Well, they are.  And one of the ways they�re better is things like, you know, if you take a credit card out of the system, they don�t let you put it back in.  I mean, they�re a little strict.  And I think that�s one of the ways that they make it more reliable.  But I�m certainly not making apologies for them because I...



STEVE:  I would say that we�ve just made it very clear how we feel about that aspect of PayPal.



LEO:  And having said that, I verified, and you verified, and I never do - I only transfer money into my checking account.  I never use it to pay for anything.  Now, I have to think.  I pay from my PayPal account.  And so it never asks to take money out of my checking account because I have money in my PayPal account.



STEVE:  Ah, right, you have a positive balance in your PayPal account.



LEO:  Right.  And so it always uses that by default.  So I don�t have the same issue you do with it trying to take money out of my checking account.



Farren Constable of Manhattan, Kansas has a note about encrypted hard drives.  Just an FYI, he says, I seem to recall that when you discussed these new hard drives with built-in hardware encryption, you said they weren�t available and probably wouldn�t be for a while.  Just wanted to let you know that ASI, a computer distributor, is currently selling laptops with the encrypted hard drives.  He says, I seem to think that ASI had some sort of exclusive deal on these drives and/or systems.  Is that so?



STEVE:  Well, I wanted to mention, because I don�t remember predicting when they would be available, but I have one.  I discovered a few weeks ago that they existed.  This is the Hitachi drive.  I don�t know whether other manufacturers yet have those.  But you may remember that Hitachi purchased the hard drive business from IBM and for a while was still selling under the Travelstar label, but now it�s largely under their own.  Anyway, they�ve got a full range of standard laptop drives with this very cool, on-the-fly, built-in 256-bit AES encryption.



And anyway, the drive is here.  It�s still in its little static protection sealed plastic silver bag.  I have not yet had a chance to play with it and learn whether - the thing I want to find out is exactly how does it work, and does it require any BIOS support in order to be used.  I haven�t determined that one way or the other.  But that�ll be - certainly I will close that loop with our listeners as soon as I get there.  I did want to let people know, though, that they do exist.



LEO:  Excellent.  And would it be more secure because it�s built into the hard drive?



STEVE:  Oh, yes.  Well, the beauty is, somehow you give it a password, and maybe it�s the standard BIOS unlocking password.  When you give it that password, then it hashes that into a 256-bit encryption key so that every sector it writes to the drive runs through AES 256-bit encryption so that the data physically stored on the drive is encrypted.  And then of course the reverse process happens upon reading.



The point is that literally no force on earth can then obtain the data for that drive if the password is not known.  So unlike hard drives which lock themselves, I mean, that locking - in fact, we were just talking about this with regard to that Corsair flash padlock.  You know, it�s locking the contents of its EPROM, but it�s not encrypting the contents of the EPROM at this level, at this stage.  Similarly, the hard drives that have been around for many, many years, they have locking technology that will prevent somebody from easily reading the drive.  But at the "here�s a subpoena to the drive manufacturer, unlock this drive" level, that can still be done.  But not if you�re actually encrypting all the data that goes onto the drive.  And I just think it�s very cool, especially in a laptop mode, that that would be offered.



LEO:  Yeah, yeah.  Edward, just up the coast a little ways, about five miles, in nearby Santa Rosa, shares a discovery.  He says, just a quick note to let you guys know that VeriSign�s OpenID platform - that�s the one that we were talking about with the Security Key that comes from PayPal, it�s at pip.verisignlabs.com - now supports the use of PayPal Security Key.  Well, I think we knew that, didn�t we, that it was part of the PIP...



STEVE:  Actually I told you about this.  I wanted to share it with our listeners.



LEO:  Oh, okay.



STEVE:  And we�re going to talk about it in detail next�week.



LEO:  So here�s the email he got from VeriSign.  It says "...strong authentication support via second-factor credentials from the VeriSign Identity Protection Network.  PayPal tokens can now be used with PIP, along with the ability to have a one-time PIN sent by SMS or email if you�ve forgotten your credentials."  I like that.



STEVE:  Yeah, it�s very cool.  And again, I want to - it�s one of the two topics, or actually maybe three topics for next week.  PIP stands for Personal Identity Provider.  And I just wanted to give our listeners a heads-up about this.  Actually several people wrote in, so not just Edward in Santa Rosa, but a couple other people said, hey, I was poking around.  And you may remember that, when we had our friend on from PayPal - I hope he�s still our friend after what we just...



LEO:  Well, I�m sure he is.



STEVE:  I�m sure he is, too.  He was talking about how PayPal is essentially using the VIP, the VeriSign Identity Protection technology, as their backend behind their whole token deal.  And what I had mentioned to you, Leo, was that I did some follow-up research.  I found VeriSign Labs and the fact that they sell their own tokens, and I bought three more because they will sell you as many as three of them.  I don�t know if it�s three at a time or three total.  But what�s very cool is that you can register multiple tokens at the same time, and this solves the "I�ve got one at home and�one..."



LEO:  Ah, and they�ll work the same way.



STEVE:  Exactly.



LEO:  Ah.



STEVE:  Exactly.  So anyway, this will be what we�re talking about in greater detail next week.  But I just wanted to acknowledge the people that had written in and said, hey, I found VeriSign Labs is doing this stuff.



LEO:  He also says he�s now using pip.verisign.com as his primary OpenID account, changing from ClaimID.  I use ClaimID, too.  So I will switch over because that means when I do my OpenID verification I�ll use the dongle.  Right?  A�fob.



STEVE:  Exactly.  Whatever we call it.



LEO:  Whatever you call it.



STEVE:  There was some discussion about that, too, in our mail.  Apparently the official word is that a dongle is something that you plug into something, like the old parallel port dongles that were used for protecting high-value software, and in fact even to this day are still used for, like, expensive vertical market software.  Whereas a fob is a freestanding, you know, standalone thing that you don�t plug into something.  So, like, okay.



LEO:  That actually is what I thought.  Well, to me a fob is something you put on your watch chain or your watch.  But anyway, that�s another matter.



George in Ohio has discovered something great about our sponsor, Astaro.  He said, I�d like to point out there is a really positive piece of information about Astaro that you�re not mentioning in the advertisements Leo does in each episode.  Well, there you go.  I�d better find out, huh.  He says, I recently lost my long-running and until now flawless SmoothWall box.  Patrick and I have been talking about SmoothWall since Screensavers days.  It�s a great, great solution for an open source firewall.  He says his processor fan died, cooked the machine.  I thought this would be a good time to check out Astaro.  He has a faster machine he just recovered, so he put it on that.  He wanted to make sure he actually liked it before committing.



So while he was out shopping online for a hard drive to throw into it so he wouldn�t have to nuke the current OS, he dropped by the Security Now! page, Astaro.com/securitynow, to make sure the hardware would be compatible.  And I was actually going to mention this in the ad.  But he noticed that there�s a download option for a Virtual Appliance for VMware of the software.  So if you�re using VMware, there is an Astaro - in fact, it�s one of the most popular appliances.  He says he already has VMware Player, which is free, installed on the system for running Linux distros I�m testing, so I thought it was a perfect solution.  I downloaded it and ran it, and I like what I see.  I�m impressed that they had the foresight to package it that way for people like me who like to feel out the interface before we commit to installing it.  Bravo, Astaro.  Just thought you might want to mention that to your listeners.



I found that in fact this week, too.  When I was testing out VMware Fusion for the Mac, I noticed that I could run Astaro Security Gateway on it.  It�s like the No. 5 appliance of�all.



STEVE:  Oh, very cool.



LEO:  That�s neat, yeah.  In fact, you can try a lot of - that�s one of the neat things about VMware is those appliances.  And that�s something that they have over Parallels.  Parallels also might be in some doubt.  I think there�s a lawsuit over the Parallels technology.



STEVE:  Uh-oh.



LEO:  The company that the Parallels guys worked for before they worked at Parallels...



STEVE:  Oops.



LEO:  ...says that�s our software, what are you doing?  And now a European court has not issued a preliminary injunction against the sale of the software, but it�s something to be aware of.  At least we have a choice.  If you haven�t bought Parallels yet, I think VMware is a good contender.  I bought Parallels, so I don�t see any reason to run to VMware.  It�s very similar.  Although some say it might be a little bit�faster.



STEVE:  Actually that�s Mark Thompson�s contention, Mark Thompson my friend from AnalogX.  He believes Parallels just runs circles around VMware, although the performance is not something I have verified.



LEO:  I don�t know.  I don�t know.  They seem pretty�similar.



STEVE:  They really ought to be.  They ought to be.



LEO:  Yeah, I mean, it�s the same thing.  They�re both using this hypervisor mode and all that.  But I did see a number of comments from people who said VMware was faster.  So, you know, it�s one of those things.  There�s a lot of psychology involved in this.  If you feel like it�s going to be faster, it�s going to be faster.



Danny in Ogden, Utah enjoyed our last podcast about leaktest.  He said, I very much enjoyed the firewall leaktest issue.  One thing you might want to remind your listeners is that, while this is an important thing, it only applies to software-based firewalls.  I currently work for Juniper, one of the big companies doing this.



STEVE:  Router company.



LEO:  Yeah, he does tech support for their firewall and intrusion detection and prevention products.  I�m proud to say our firewalls are not affected by such tactics.  But then again, you already knew that.  Well, that�s why we recommend routers, frankly.



STEVE:  Yes, that�s exactly the case.  And I did want to mention that certainly Danny is correct, that by being a box outside of the PC, you get a lot more security from a standpoint of software not being able to go in and disable your firewall.  And in case of the router, that�s one of the reasons that I strongly recommend people disable the Universal Plug and Play support because that is a vector by which software running in a PC could disable the security prevention and features of a router by deliberately opening incoming ports statically on the router.  That�s what UPnP was created for.  And unfortunately it was created without any security model at all.  So it�s just - that�s just a sore point for me.



But on the flipside, the problem that external firewall hardware has is it can�t tell anything about what application generated the traffic.  So what we were really talking about in the leaktest episode was that the whole idea was a personal firewall, meaning a firewall software running on your PC, it had the ability to go back and figure out which process was generating the traffic and then check its configuration to see whether that process had been authorized to send data to and from the Internet, which of course isn�t something that an external piece of hardware can do because there�s no way for the hardware to know what process is emitting the traffic from the PC.  All it sees is packets coming out.  But it can�t tell where they came from.



LEO:  Although a high-end router like a Juniper certainly does monitor outbound traffic.



STEVE:  Well, it does.  But again, for example...



LEO:  Can�t figure out who did it, though.



STEVE:  Exactly.  And that�s the real leverage that people who like personal software firewalls get behind is they like the idea of knowing who was controlling or who was generating whatever traffic that they�re seeing.



LEO:  Even if a bad guy could be lying about it.



STEVE:  Exactly.



LEO:  Which to me obviates the whole point of it.  I mean, yeah.  Okay, cool.  It can tell you what the process is.  But it has no way of validating that that information is�accurate.



STEVE:  Oh, and the other problem is, when you have something like servicehost.exe, which is...



LEO:  Meaningless, yeah.



STEVE:  It�s just a container for a whole bunch of Windows services.  You lose the granularity of knowing, well, what service in the service host processor is doing this.  So, yeah, that�s a problem.



LEO:  Mark Paynter, Sydney, Australia, has an interesting observation, again about the fob/dongle/key.



STEVE:  Doohickey.



LEO:  Doohickey.  He says, I obtained a PayPal security fob dongle key, which is a good idea.  But it occurred to me that a spoof PayPal site could do a pop-up window for the key and simply accept any number that is entered.  The way to test it would be to enter a completely wrong number, and if it accepts it, then it didn�t check.  So security needs to be checked by using "not" logic rather than "and"�expressions.



STEVE:  I thought that was sort of an interesting observation.  Of course the point this brings up is that there are two different things that we would like to have happen.  The dongle fob key doohickey is used normally when you�re trying to authenticate yourself to the remote server.  Mark�s point is that, by lying, by deliberately lying to the site which may be spoofing, you�re authenticating it.



LEO:  Right.  Which is a good point.



STEVE:  Which is sort of an interesting point, yeah.



LEO:  I�d like to point out that most of the time when you do, if you were to log onto a phishing server, after you entered your name and password it really doesn�t go on.  It�s not like it says, okay, good, let�s do some more stuff.



STEVE:  Yeah, let�s enter your security key.  It�s glad to have you that far.



LEO:  Bye.  Thanks.  See you later.  And of course you�re protected if you have a dongle because even if you entered your dongle number it�s only good for the next 30 seconds.  I�ve shown my dongle number on our UStream feed during the radio show.  People go, what are you doing?  I say, don�t�worry.



STEVE:  And in fact you and I talked about this on your KFI syndicated radio show last week.  And we had fun reading off our numbers...



LEO:  Don�t worry.



STEVE:  ...as they changed.  It�s like, it�s okay because it�s not going to be good.



LEO:  I have to say I love that feeling.  That�s just so cool.  And I�m going to right away go to pip.verisign.com and make that my OpenID provider because that means - I�m correct in thinking that that means that whenever I did an OpenID login, I�d have to use the fob now; right?



STEVE:  You would have to use the fob, exactly, given that you use VeriSign as your OpenID provider.  Nothing would prevent you from having also a different OpenID provider.  And what I like about the VeriSign approach is that they do have the ability to simultaneously register multiple credentials and non-fob - I just hate that word, but you know - non-fob authentication alternatives also.  So, I mean, they�re really coming up to speed nicely.  And we�re going to be talking about it in greater detail next week.



LEO:  Cool.  Steve Gibson lives, breathes, and eats security at GRC.com.  That�s where you�ll find ShieldsUP!, Shoot The Messenger, DCOMbobulator, UnPlug n� Pray, Wizmo.  One day I�ll read them all.  One day I�ll read every single thing that you do, and this will be a three-hour podcast.  Also SpinRite, of course, his daily bread.  And that is SpinRite.  In fact, you want to read the testimonials, SpinRite.info.  Or just go to GRC.com.  That�s also where you�ll find 16KB versions of the podcast, transcriptions by Elaine, notes, and every Security Now! episode, all 106 of them, going way back two years.



STEVE:  And counting.



LEO:  And counting.  Congratulations once again, you are listening - you have the good taste to be listening to the�best technology podcast in 2007, thanks to the Podcast�Awards.



STEVE:  And I thank our listeners once again for making that happen.  That�s really cool.



LEO:  Yes.  Yes.  Okay.  Had a little macho moment there, but I�m feeling better.  I�m going to grab my fob, and we�re going to get out of here.  We�ll be back next week.  What are we talking about next week, Mr. G?



STEVE:  Next week we�re going to talk about, as we mentioned here in passing, VeriSign�s Identity Protection, the VIP program.  I also want to talk about some changes I recently  made to GRC�s very popular Perfect Passwords page as a consequence of some feedback that I received, and the fact that I�m currently dipping in and doing a whole bunch of work on the GRC site in general.  And so I�m going to talk about that a little bit.



LEO:  So you�re saying the Perfect Passwords page wasn�t�perfect?



STEVE:  They were perfect enough, but they�re even more perfect now.



LEO:  Even more perfect than ever before.



STEVE:  And in fact, if Even More Perfect Passwords wasn�t too much of a tongue twister and too long, that�s what I would have called it.  But obviously made it perfect.



LEO:  Okay.  Steve, we�ll talk again next week on Security Now!.  Thanks for being here.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#107

DATE:		August 30, 2007

TITLE:		PIP & More Perfect Passwords

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-107.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss two topics this week:  The availability and operation of VeriSign Labs' OpenID PIP (Personal Identity Provider) beta, offering many useful features for online identity authentication; and Steve�s recent redesign of the algorithms behind his popular Perfect Passwords page.



INTRO:  Netcasts you love, from people you trust.  This is TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 107 for August 30, 2007:  VeriSign�s OpenID and Toward More Perfect Passwords.



It�s time for Security Now!, everybody�s favorite security podcast and, thanks to your votes, the #1 technology and science podcast of the year, podcast award winner.  Steve will be collecting his award at the Podcast Expo at the end of the month.



STEVE GIBSON:  Yes, I will be...



LEO:  That�s pretty exciting.



STEVE:  Well, it�s my one chance really to annually hook up with Elaine, our transcriber.  I met her for the first time - even though we�d had about, I guess, a year and a half worth of relationship electronically, doing our transcripts, you and I both met her for the first time during the last Podcast Expo, which was really fun.



LEO:  That was fun, yeah.  I will not be there, but I wish you all the best.



STEVE:  You�ll be there in spirit, Leo.



LEO:  I will.  I will.



STEVE:  And none of this would be happening were it not for you and your spirit, so it�s true.



LEO:  Well, it�s my goal actually to win every year with one podcast or the other.



STEVE:  It�s all good.



LEO:  Next year it may be MacBreak Weekly because they were nominated this year, and I feel bad.  But, you know, you predate them, so...



STEVE:  Well, and what�s annoying is that your mainline TWiT podcast and MacBreak Weekly and Security Now! are all in the technology science category.



LEO:  Right.  And we can no longer win the People�s Choice Award because we�ve won that.  So we�re basically running out of ways to win.  But I�ll just keep making podcasts, find a way to win.



STEVE:  It�s not like that�s a problem.  I was over on your page the other day; and it�s like, my goodness, look at all these things you�re doing.



LEO:  Yeah, I�ve got to stop.



STEVE:  Busy boy.



LEO:  I�ve got to stop soon.  So today what are we going to talk about, Mr. Gibson?



STEVE:  Well, a couple things.  I want to talk about, in detail, the VIP program, which really first came to light publicly when our guest from PayPal was talking about how they�re using VIP, which is VeriSign Identity Protection, as their backend system behind PayPal and eBay�s authentication fob, which was, you know, the so-called PayPal Security Key that I thought was such a cool thing, and which I really do continue to think so.  What I did was I�ve plowed into that and found a bunch of cool stuff, told you about it, and now you know about it.  So now we�ve got to tell our listeners.  So...



LEO:  I�ve signed up.  I�m ready.  I�m using it.  I love it.



STEVE:  So I want to talk about that.  But also, because I didn�t think that would take a full episode worth of time, and because there was something else going on, I thought I would talk about something we�ve never mentioned before, a way of protecting the use of symmetric encryption, something called CBC, which is Cipher Block Chaining.  It becomes up because I implemented it recently for the Perfect Passwords, GRC�s Perfect - or our Popular Perfect Passwords Page.



LEO:  PPP.



STEVE:  Yes.  More than 3,000 sets of passwords are generated a day.  And I looked the other day, and more than three million sets of passwords have been generated total.  Just it�s very popular with people.  The Popular Perfect Passwords Page is very Popular with People.  And so now what we have is even more Perfect Passwords, which are the same number of passwords, but they�re even more perfect than they were before.  So we�ll talk about that.



LEO:  So, let�s see.  I know we do a mailbag episode now, every other episode; but do you have any quick emails you want to address or talk about?



STEVE:  I�ve got two things.  One is an errata, and one is - I keep trying to look for interesting SpinRite stories from our listeners that are not repetitious.  And I found one where a guy bought SpinRite by mistake, which I�ll explain in a second.  But I did want to mention that a couple weeks ago, on the second Tuesday of this month, you may remember that the week before last I reminded people to make sure they were up to speed with their Windows Update because Microsoft was pushing out nine different updates, so a little larger than usual.  What was significant is that - and this has actually created a lot of buzz in the security industry - is that one of those nine was a fix for three problems in the new Vista Gadgets.



LEO:  Really.



STEVE:  Yes.  And so, Leo, you have continued to talk, as we�ve talked about security issues, you�ve been focused on whether Vista would have been safe, whether this is different in Vista and so forth.  What�s significant is that Vista�s Gadgets, being Vista-only, represent a new problem that prior versions of Windows such as XP and 2000 and so forth would not have had because they didn�t have gadgets.  And the reason there was some buzz in the security industry is that one of these was a buffer overflow, i.e., you know, critically rated, take-your-computer-over remote control, blah blah blah, in the RSS feed reader gadget.  Which means that, had any bad guy been able to push a properly malformed content into any feed that was popular and that people had subscribed to, their Vista machines would have been commandeered.



LEO:  Wow.



STEVE:  So, you know, you can see why there was some buzz.  It was like, whoa, you know, here�s an example of something, a new feature.  And, frankly, this is what we were talking about here well before Vista�s release was new features are going to have problems.  And people go, oh, well, but we�re checking them, our whole new security profile, and we�re scrutinizing our code.  It�s like, yes, I know.  New features are going to have problems.  And that�s exactly what happened here.  So the good news is, Microsoft found it, someone reported it, Microsoft patched it and fixed it.  But this, again, it�s an example of standard sort of security philosophy that you just can�t get away from.



LEO:  Yeah, interesting.  And, you know, those are written in - I thought they were written in JavaScript, like most widgets and gadgets are.  But there must be some code in there, as well.



STEVE:  Well, you�re always dependent upon lower level stuff.  So it might have been in the JavaScript.  It might have been in a library that was called to parse some of the data.  You�d have to be really deep in this to know where the problem was.  But Microsoft confirmed that, yes, had you subscribed to a malicious feed, or a good feed that had mistakenly provided some malicious content, your machine could have been taken over remotely.



LEO:  Fascinating.  All right.



STEVE:  Anyway, we have a Security Now! listener, Rob McCall in Oakridge, New Jersey, who says - and I kind of liked this one because, again, it was a different kind of salute to SpinRite.  He said, "I�m a long-time listener of Security Now! and have learned much from your great podcast.  I�ve also been a long-time fan of your site, which has educated me to no end.  I�ve been debating whether or not to purchase SpinRite for quite some time.  I finally decided to buy it when I started having problems with my HP desktop computer.  Whenever I started the computer, it would rarely make it to the log-on screen.  And even if it did, I could not log on because the screen froze, and I could not do anything about it.  So I purchased SpinRite thinking maybe it was just..." he says.  Now hard drive problems are just a hard drive problem because we have SpinRite.  And he says, "...thinking maybe it was just a hard drive problem."  We can take care of that.  He said, "Sadly, it was a failure with another part of the system and not my hard drive."  So SpinRite was unable to help him.  He says, "Since then I have used SpinRite several times on my collection of old hard drives.  Much to my amazement, SpinRite was able to recover data from these drives that every other program and company had deemed unrecoverable.  This is one purchase I know I will be happy with for a very, very long time.  SpinRite is a cheap solution..." - well, I would rather call it an "inexpensive" solution...



LEO:  Inexpensive solution, yeah.



STEVE:  "...to services that many companies will charge several hundred, if not thousands of dollars to do.  I cannot thank you enough, Steve."  Signed, Rob McCall.



LEO:  Wow, that�s great.



STEVE:  So, Rob, thank you for listening to Security Now!, for visiting GRC, and for purchasing SpinRite.  Took a while, but you�re glad you got it, so I�m glad for that.



LEO:  That�s really neat.  All right.  Let�s get to our topic of the day.  Two of them to talk about today:  Practically Perfect Passwords...



STEVE:  You have to have much coffee in your system, Leo, as I do in order to handle Even More Perfect Popular Passwords.



LEO:  Whatever you say.



STEVE:  Or whatever that was.



LEO:  Whatever you said.



STEVE:  The Popular Perfect Passwords Page.  But first...



LEO:  Go ahead.



STEVE:  But first we�re going to talk about...



LEO:  We�re going to do this...



STEVE:  First we�re going to talk about - we�re going to step all over each other.



LEO:  So it�s PIP and PPP is what it is today.



STEVE:  There you go.  Yes.  Our PayPal security guy who we had on a couple weeks ago talked about how VIP was the back-end that PayPal was using, the VeriSign Identity Protection system.  So I did some digging around, and I discovered that there�s a program in beta which is called PIP, and that stands for Personal Identity Provider.  And that�s being hosted at verisignlabs.com, not VeriSign, VeriSign Labs.  So if our listeners go to - and in the show notes I�ve got links to all this.  So people who are just listening to this while they�re out jogging or driving around, if they go to the show notes they can pick up the links for this.  It�s pip.verisignlabs.com.  That�s the doorway to all this fun stuff.



And what�s so neat is that VeriSign labs, that is, this PIP, the Personal Identity Provider, which is what PIP stands for, is in beta, but it�s up and running and working.  And these guys are an OpenID provider, that is, they are an OpenID-compatible authenticator.  Now, you�ll remember that we talked about the whole OpenID system a couple months ago, the idea being that it would provide you with a single point of authentication, so-called "single sign-on" technology, where you would go to any other site that is OpenID-friendly, and you would be able to, instead of needing to log on and create individual log-on credentials for each such site, they would be able to ask a third-party server, in this case VeriSign Labs, to authenticate you.



Well, what�s so cool is that VeriSign Labs, that is, this pip.versignlabs.com, you�re able to create OpenID accounts.  And actually you can have as many of them as you want.  For example, I have stevegibson.pip.verisignlabs.com.  I got Gibson.  I got GRC.  I got SteveG.  I got a bunch.  And I would encourage our listeners who are interested to run over there and get their names in various flavors that they want signed up because this may well end up being something that you�re glad to have been able to get your name on.  Which if, you know, somebody else comes along and has the same name you do, would preempt you subsequently from doing so.



So, but the idea is you create these OpenID accounts.  Then you can associate them with multiple second-factor authentication, starting with the PayPal Security Key.  So you can give the serial number of your PayPal Security Key to this site as part of your account creation, and they will sell you more.  In fact, you can choose on the purchase form whether you want one, two, or three.  Now, these are not as inexpensive as the keys from PayPal because, as we know, PayPal is essentially covering the cost for this because they want to promote the use of their Security Key.  VeriSign doesn�t have the same motivation.  Their dongles - oops, I�m sorry, fobs - their fobs are $30 apiece.



LEO:  Ah.  But I can use my $5 PayPal fob with this.



STEVE:  You can use, yes, you can use the $5 PayPal fob that you already have.  But remember that we were also bemoaning the fact that PayPal would only allow you to register a single fob at a time, which prevented us from leaving one at the office and leaving one at home so that we didn�t have to worry about filling up our keychain full of these.  Well, first of all, the fact that VeriSign Labs has this program which is in beta, which is an OpenID provider, it�s beginning to solve the problem of needing individual second-factor authentication fobs or dongles or doohickeys or thingamajigs for every different provider because OpenID is clearly gaining strength, and they�re able to function as an OpenID authenticator.  So, and the fact that you�re able with VeriSign, not with PayPal and eBay - I want to make clear that that�s still a single-fob system.  But with VeriSign you can register as many of these as you want.  I�ve got four at this point just because, you know, just because I could.



LEO:  Why not?  Well, so I want to make this clear, though, you can use your PayPal fob with VeriSign, but you can�t use those extra VeriSign fobs with PayPal.  It�s a one-way street.



STEVE:  Exactly.  Or at least not at the same time.  You could probably deregister your PayPal fob and register a VeriSign fob because the fact is they�re all from VeriSign.  They look identical.  The VeriSign ones are a nice VeriSign purple color, whereas the PayPal uses that PayPal sort of, I don�t know, gray, yeah.



LEO:  Gray, yeah.



STEVE:  But otherwise they...



LEO:  So I just did this.  I signed up at pip.verisignlabs.com, created an OpenID account, and then I added it.  Now, they call it a certificate, though.



STEVE:  A credential.



LEO:  A credential.  So I added my credential, my little key, and now it�s working with that.  So that�s really cool.  So now one key works with OpenID now, too.



STEVE:  Yes.  So now you have very strong, not only something you know but something you have, two-factor authentication.  And so when you go to a site which is using OpenID - and in fact VeriSign Labs has a list of all the sites that are currently supporting OpenID.  And these are not sites that support VeriSign.  They just support OpenID.  So, for example, when Microsoft is, with Vista, supporting OpenID through their UI, you�ll be able to use that.  It�s also worth mentioning that there�s a nice Firefox extension - I know what a fan of Firefox you are, Leo - called "SeatBelt."  And SeatBelt allows you to automatically authenticate yourself with OpenID sites.  And in fact I learned about this from the PIP VeriSign Labs website, where they give you a link to go get the SeatBelt Firefox extension because this is all interoperable.



LEO:  Yeah, so I installed that.  And what�s nice is, once you log in to SeatBelt, you�ve got a little button on your Firefox toolbar that says PIP, and says your ID name.  And now whenever I go to an OpenID site I just - it�s one button, and it verifies.  Oh, yeah, okay.  You�re who you say you are.  We know you are.  And boom, that�s done.



STEVE:  Yes.  It is very cool.



LEO:  I just wish more people would support this.  That�s the only...



STEVE:  Well, you know, we�re on the leading edge of this stuff.  And I think it�s very clear that as, you know, again, we have a chicken-and-egg problem.  We need people to be asking for it in order for sites to go, okay, yeah, I guess.  At some point I think it�s easily foreseeable that a couple years from now OpenID will be the technology that won because it was completely open, it was well-designed, nobody�s trying to make any money from it.  It�s just like, yeah, we want to be an OpenID provider.  Or in the other case, we want to allow OpenID because we recognize it makes our site more easy for people to use.



LEO:  Well, I�ll make a little promise to you.  I�m upgrading my Drupal, and Drupal will support OpenID.  So at some point TWiT.tv will.  I�d like to get my forums to do that.  I�ll find a plug-in to do that.  And I know that - I do one WordPress blog for Munchcast.  We�ll turn on the OpenID plug-in for WordPress there.  So I�ll do my part to make my sites as OpenID-compatible as I can.  Because [indiscernible] idea, I mean, this is great.



STEVE:  Yeah, it�s the right thing to do.  Also there is an information card feature now.  I mean, I�m watching these features evolve on PIP just over the last few weeks.  For example, you just registered your cell phone as a secondary authentication, where they will send you an SMS message in order to verify that - again, something you have is the second factor of authentication - that you�re in possession of your cell phone.  So here again, that feature wasn�t available just three or four weeks ago when I was doing this research.  And now it�s online and up to speed.  So this stuff is happening very quickly.  But, for example, if I were to, after getting everything set up with VeriSign Labs, if I were to go to one of these sites that supports OpenID, I identify myself, for example, in this case as stevegibson.pip.verisignlabs.com.



LEO:  Now, that�s okay for you to give that out.



STEVE:  Yes, because there�s no way that anybody else can authenticate under my name because this will come back to VeriSign, and VeriSign will say, okay, what�s the six-digit code currently showing on any one of the fobs that you have registered?



LEO:  That�s really neat.  I really like - this makes, to me, OpenID really secure.  And I really like that.  And so you get the convenience of that one-time sign-on.  I mean, now with Firefox I�m signed on.  So it just does it automatically.  But it�s only while I�m here.  And as soon as I close Firefox, it�s gone.  And unless they have my fob, won�t do it.



STEVE:  Now, what I�m hoping is that, while this is in beta, we�ve got this somewhat cumbersome URL, you know, stevegibson.pip.verisignlabs.com.  What I�m hoping is that they�ve already nailed down some very cool top-level domain, you know, like VIP or maybe just PIP or MyID or something cool so that, when this comes out of beta, all of our existing accounts will also be valid at a much shorter URL, so it�s stevegibson.vip.com or MyID or something like that.  That would be very cool.



LEO:  Because it�s still a beta program, it�s still at verisignlabs.com.  But I presume they�ve got PIP or VIP or something.



STEVE:  Now, harsh as we�ve been about U3 in the past, it�s also worth mentioning that that is another option that VeriSign offers.  That is, you can install - I couldn�t quite understand whether it was something you had to install or was already present.  But they do also support the SanDisk USB Flash Drive in U3 mode.  So apparently there is something that they feel is secure enough that you can use U3, and there is a VIP credential software that is tied to the USB Flash Drive hardware that makes it secure enough that that�s another means of authentication, if you didn�t want to use the fob.



LEO:  So you would somehow put something on your SanDisk U3 key, which I have one in front of me right now.  That would be in lieu of logging in.  It would be your physical identification.



STEVE:  Yes.  And now of course the problem...



LEO:  Now it�s a dongle, by the way.



STEVE:  Oop, you�re right, it�s not a fob, it�s a dongle.



LEO:  So if you want to use a dongle instead of a fob, you can do it that way.



STEVE:  The problem, of course, is that you would need to stick that into whatever computer you were visiting.  And so that�s a little more invasive and intrusive than just having this fob on your keychain for your authentication.



LEO:  Right, right.  I�m just intrigued by this whole system.  By the way, once you sign up for your PIP account, you can add fields.  You can create an information card with information in it that you can then use.  For instance, I always use as a nickname "Chief TWiT" when I create a new account.  So it can actually populate that automatically.  You could say, yeah, use Chief TWiT as my nickname.



STEVE:  Yes, exactly.  And in fact the information card is essentially what we were talking about over on CardSpace under Vista, where you�re able to create information cards to contain different sorts of information.  The cool thing is that this information is not stored on your machine.  Rather it�s stored, in this case, on VeriSign�s servers.  So you authenticate yourself to VeriSign.  Then you log in with your VeriSign OpenID.  And then VeriSign provides the information directly to that third-party site that you have previously given to VeriSign with the instructions to provide that along with your OpenID.



The point is that this begins to make it substantially more secure to use computers you don�t have control over.  You could go, for example, to the library and do something that you would normally never do on a library computer, for example, because none of your information ever goes into that local computer.  It�s being handed off between VeriSign�s server and the site you�re visiting, rather than to that local machine.



LEO:  I�ll give you some other advantages.  They�re really doing this OpenID right.  They have a list on the VeriSign Labs site of your trusted sites, sites you�ve used this OpenID to establish a relationship with, and your activities.  So, for instance, I tried to log into the site with the wrong password.  It failed.  I have a record of that and when it happened.  So I think this is really a nice implementation of OpenID.  They also allow you to do your own SiteKey, to upload an image that only you know what it is, and presumably only you have access to, and add additional security by doing that.



STEVE:  Well, as a matter of fact, Leo, I�m looking at my page, and I�ve got that smug-looking picture of me...



LEO:  No one else has access to that.



STEVE:  That cartoon that you had done for Security Now!.  And I snipped it out and made it the right size.  And so the point is that, you know, when I log in, this photo of me is showing.  And that�s additional verification that I�m actually at VeriSign Labs and that there�s been no sort of spoofing going on because nobody else would have access to that picture.  Oh, and I will mention also that I smiled.  When you try to go there over a nonencrypted connection, that is, over just HTTP, it won�t let you.  It immediately moves you into an SSL connection so all of this is protected and is locked up by their certificates.



LEO:  Excellent.  Excellent.  It�s well implemented, I have to say.  And I�ve been critical of VeriSign in the past, at least as a registrar.  But they�ve done a nice job here.  Done a nice job.



STEVE:  Yeah, I really agree.  I think that this is - anyway, I wanted to bring it to our listeners� attention because, you know, here is a functioning, working, strong third-party verification system that is, I mean, it�s only running OpenID.  That�s the whole point of this is to be an OpenID identity provider and authentication service.  And it uses our existing PayPal Security Key and additional ones, and has other means for doing multifactor authentication than just the fobs.



LEO:  Right, right.



STEVE:  So it�s a win.



LEO:  I like it.  You started this page a while ago, the Perfect Password page.



STEVE:  Perfect Passwords.  And it�s turned out to be popular Perfect Passwords.



LEO:  Yes, it has.



STEVE:  About 3,000 sets of them are pulled every day.  And I hear from people all the time who just love the idea.  I went to extreme measures to make this safe to use.  Similar to VeriSign, you cannot display that page over a non-encrypted, non-SSL connection.  If you try, it switches you into that mode before it goes any further.  I also have a bunch of headers and code on the page that prevent the caching by any servers, even if the server could intercept it, which it probably can�t because it�s over SSL and so it�s not going to be running through a proxy.  So, I mean, it�s really, really safe.



Now, I was of the opinion that using RSA�s pseudorandom number generator would be all I ever needed.  Then, after I implemented that, I wrote a bunch of code to take it to the next level.  Well, I had thought that I put that code in place.  But it turns out that I had written it and assembled it, but never took it online.  So by just some bizarre coincidence, someone in the security field thought, I�m just wondering, you know, how random Steve�s passwords are.  So he wrote a bot to pound on the password page, that is, to pound on the Perfect Passwords page.



LEO:  Good for him.



STEVE:  And I knew something was going on because I saw this happening.  And it was over - there was, like, an initial little burst of insanity when, like, somebody was pounding on the page.  And then a couple days later it went on for 24 hours.  So this guy collected a ton of the passwords that were being presented by the page and then ran them through a statistical randomness tester.  And he came to the conclusion that these were not as - there wasn�t as much entropy in the resulting passwords as possible. 



LEO:  Oh, no.



STEVE:  I know.  I mean, okay, now, this doesn�t matter.



LEO:  They�re entropy enough.



STEVE:  Well, and as we know, it doesn�t matter that, if you got 100,000 of these and did an analysis of statistical entropy, whether I�m at 100 percent or 99.997 because...



LEO:  Or even 75 percent.



STEVE:  I know.  Because what you want is a password that you cannot guess.  And certainly, if you�ve ever seen any of these, they�re just insane passwords.  So anyway, so the trouble is he created a blog posting somewhere where he said - he talked about his analysis.  I mean, he�s a nice guy.  He and I have corresponded several times since.  His first attempt to process the passwords had some of his own bugs in it that made it look like it was really bad.  And that, you know, but then he fixed his own bugs.  And then he said, okay, this is not so bad.  But still it�s not perfect.  So it�s like, okay.  Maybe it�s not Perfect with a capital P.  But again, you have to have, like, 100,000 of these in order to detect any variation from them not being absolutely random.



LEO:  It�s Practically Perfect Passwords.



STEVE:  Well, I mean, it�s not even potentially perfect.  They�re essentially perfect for the...



LEO:  Good enough.



STEVE:  For the reason that we�re generating them.  But I thought, okay, fine, I�m going to fix this.  So what I did was I finally implemented the algorithm that I had written but not implemented, which I think our listeners would find interesting because it brings to light something that we haven�t discussed before.  First of all, I promised people that we would never be issuing the same password twice.  Well, given the fact that this thing is a - it ends up with a 256-bit result, it�s very certain that we haven�t done that.  But...



LEO:  You haven�t wrapped around yet, in other words.



STEVE:  Well, you know, my god, I mean, 256 bits, I don�t even, you know, it�s...



LEO:  That�s a ways off.



STEVE:  ...a ridiculously big number.  But what I decided to do was to implement a system where I would have a monotonic counter, meaning a counter that only goes up, never goes down.  Every time I increment the counter, I store that value.  And I�m actually storing it in a registry key on the GRC server.  And many different processes in my server use this.  For example, it�s the way my ecommerce system generates the thing I call a "cryptoken," which is a nonrepeating token that is used in order to hand our individual ecommerce users a token that�s only good once.  And so anyway, I�m using the same thing with the Perfect Passwords page.  And I�m using the state-of-the-art AES, that is, the Rijndael encryption, which is 128-bit block cipher, meaning that it takes 128 bits in.  And as we�ll remember from symmetric block ciphers, it turns that, using a secret key, it turns that 128 bits into a different 128 bits.  And it does so reversibly, meaning that, when you encrypt it, it goes one way, but you�re able to give the same key to the matching decrypter, and it will reverse the process.



Well, and this is the problem with using a symmetric block cipher is, okay, so I�ve got a counter.  So imagine that the counter starts at one.  And I encrypt that.  Oh, and this is a 128-bit counter.  The counter is actually 256 bits long because, you know, why not.  But I�m using the least significant 128 bits of that 256-bit counter because Rijndael takes in its 128-bit block symmetric cipher.  So imagine that my count is one, and I encrypt it.  Now, it�s going to turn it into basically 128 random bits.  I mean, that�s a good - good crypto does that.  It turns something not random into something random.  It�s not compressible.  It�s highly random.  Then I increment my counter to two, and I encrypt that.  Well, that�s going to turn it into a completely different-looking 128 bits.  So together we�ve got these - now we have 256 completely random sets of bits.



The problem is that an attack on this would be, if you were crazy enough to try to brute-force the key, if you knew that it was a counter, that is, a simple monotonic increasing counter, that was generating these, what you could do is take the output and start trying to decrypt it with every possible key.  And if by some chance you hit on the key - and again, this is a 256-bit key that is driving the mapping between the input 128 bits and the output 128 bits.  But, you know, okay.  Technically, if you knew that this was a counter on the input, then all you would have to do, you would know when you found the right key because successive decryptions of successive 128-bit outputs would suddenly result in two numbers that were one off from each other because the input was just a counter.



Now, in my case I�m using just a counter.  But in many other instances where you�re encrypting something you�ve got, for example, an IP packet where you�ve got a header that isn�t changing, or a header with known fields.  And we�ve talked about this earlier in our crypto episodes.  So there�s a problem with using symmetric crypto like this any time you either have repetitious data, as you would, for example, in the similar header of every IP packet that was being encrypted; or if you�ve got predictable input data, as is the case in my use, where I have a large counter which is feeding data into the crypto.



The way you solve this problem is what I wanted to talk about, which is called CBC, Cipher Block Chaining.  And this is, again, something super clever that the crypto guys came up with that prevents the reverse engineering through a brute-force attack like I�ve been talking about.  And it�s actually very simple.  The idea would be, say that we take my first value, when the counter is one, and we encrypt it, and that gives us our first 128 bits of random result.  That�s our first output.  But now we use that, and we XOR that using the exclusive OR operation, remember, and we�ve talked about this, where basically it�s conditional bit inversion.  We XOR the first output with the next counter value.  That is, the counter counts to two, we XOR that two, and that�s what we encrypt.



Well, now what we�ve encrypted is no longer predictable.  It is not predictable from a standpoint of being able to use brute force approaches to determine what our input was, no matter how many keys we try.  And so the idea is you just keep this process going.  You take the second output.  You XOR that with the third input to create your third output.  And what�s very cool about this is, if you start at the beginning, this is a reversible process.  But it�s only by having the proper starting point that you�re then able to move this forward in this iterative fashion.



Anyway, I�ve got a diagram of this algorithm on the new Perfect Passwords page.  I don�t have it up yet, Leo, at the time that we�re recording this.  But I will by the time that we hear this because I wanted to completely explain to people what this new algorithm is.  And rather than asking our intrepid security researcher to suck hundreds of thousands of new, different algorithm as perfect passwords off the page, he�s asked for, I think it was 16 meg of output.  So I�m providing him with a file of 16 meg of the new random data for him to analyze so that he will revise his page that he posted on the blog saying that GRC�s perfect passwords were not a perfectly random as, you know, given 100,000 of them and an analysis of entropy, as they possibly could be.  And I ought to also mention that he has continued using them even after his blog posting.  Because he says he has tools in UNIX that would generate similarly random stuff, but it�s just easier to go to GRC.com.



LEO:  It�s easier.  So now he trusts you.



STEVE:  Yeah.  Well, he always did.  And actually he got - it was really his, as I understand it, it was the early coding mistake that made him believe they were horribly nonrandom.



LEO:  And I should emphasize "his" coding mistake.  Not yours.



STEVE:  Exactly.  His coding mistake.  And I thought, okay, while I�m at it, I mean, I want to remove this blogging post from the �Net because, I mean, we have had people write to us and say, hey, what about this blog, this posting this guy made?  Are your passwords safe?  And it�s like, yeah, look, he�s still using them, they�re so safe.



LEO:  So they�re all right.



STEVE:  But it�s like, okay, fine, maybe I guess RSA�s random number generator isn�t as good as it�s possible to make one.  So now mine will be.



LEO:  Yes.  What a relief.  I now feel safe and secure.  You know, anytime I see a random, well, even nonrandom, but random-looking hash of 64 letters and numbers and stuff, I figure that�s good enough.



STEVE:  There is no way anybody is able to guess it.  It�s in no dictionary.  And now that I�m using a counter, a monotonically increasing, never repeating counter, there�s no chance that we�ll issue the same thing twice because that count will never be the same again.  And in fact, I have a - oh, I ought to mention.  I forgot to talk about the initialization vector.  Oh, horrors.



LEO:  Oh, well.  How could you not mention the initialization vector?



STEVE:  I know.



LEO:  Shocking.



STEVE:  It�s no good for even the starting point to be known because in my example I start the counter at one, and I encrypt it.  So what if somebody knew that, and they got the very first 128 bits that came out and then just started looking for keys in this huge 256-bit key space, and they found the key that would decrypt that first thing back to the number one.  Then they have, again, they have found the key.  Well, the fact is nobody knows what the counter is because I�ve been testing it a lot, and it�s up in some number somewhere, so there�s no way to know if you got it right.  But you could say, wait a minute, the count is probably still mostly zeroes in the most significant bits.  Right?  So you get a security key - again, you brute-force, reverse-decrypt the first 128 bits until you get a number for the counter which is small, and you could then use that to test whether your assumption that that�s correct is in fact valid.  Anyway, the initialization vector prevents that.  It is an absolutely random 128 bits that you first XOR with the first counter value.  Then you encrypt that, and that�s what you use for XORing from then on.



LEO:  So you don�t start with one.  You start with some random number, basically.



STEVE:  Exactly.  And it�s actually - and that�s what the initialization vector is.  So I�ve got 128-bit initialization vector.  I�ve got an unknown 128-bit counter value and an unknown, that is to say secret, 256-bit encryption key for the Rijndael state-of-the-art AES encryption.  I think we�re safe.



LEO:  Whew.  Okay.



STEVE:  And people are using it to protect their routers from neighbors who are trying to hack into them by mistake.  So I think this is plenty of security.



LEO:  More than enough.  Given its application, it�s probably overkill.  But there you go, you have it.



STEVE:  Why not.  And 3,000 people a day like to get passwords there.  And now I�ve decided I�m going to show the algorithm I�m using and make everybody happy about having obtained the highest level of entropy ever known.



LEO:  Yeah.  It�s cool.  That�s really cool.



STEVE:  Yeah, it�s doing it right.



LEO:  Ah.  Well, Steve, once again you have - you noticed I got very quiet during that description.  I was thinking.   Yeah.  No, you�ve made it perfectly clear.  And it�s actually a fascinating area of computer science is this whole issue of pseudorandom number generation.



STEVE:  And crypto.  I love that stuff.  And for people who have had their eyes cross a little bit by listening to this, do check out the passwords page.  It�s just GRC.com/passwords.  Down at the bottom, under a new section called "The Techie Details," I have a block diagram of the algorithm and describe it further, just because I thought people would get a kick out of knowing.



LEO:  Yeah, it�s fun.  And I have to say that you don�t have to use these, but the whole idea of playing with it is just great.  It�s just really a neat thing to have.  Who knows where you might find an application for a 64-character random string?  Just you never know.



All right.  We�re going to wrap this up.  Also, if you want to follow this a little bit more closely, you can also read the transcription, which might help a little bit.  Go to GRC.com, and full transcriptions of all of our shows are available there, as well as 16KB versions for those of you who want little tiny episodes, maybe because your bandwidth isn�t sufficient or you just want to share it with friends. GRC.com, that�s also where you�ll find SpinRite, Steve�s great disk recovery and maintenance utility, the best ever, still #1, no challengers.  SpinRite.info, if you want to see some testimonials to prove it.  And also his free programs, like ShieldsUP! to test the effectiveness of your router.  Whenever I set up a new router, first place I go is ShieldsUP!.  You can also download great programs like UnPlug n� Pray, Shoot The Messenger, DCOMbobulator, and the ever popular, although now we know useless, LeakTest.  Just for old times� sake, download it.



STEVE:  I actually received a piece of mail, when I was reading the mail last week for the mailbag episode, some guy saying, well, if LeakTest is so useless, like you told us all it was the week before, why are you still offering it?  And the problem is it�s well known, it�s linked to all over the Internet, and some 7 or 800 people a day download it just because they want to make sure that their firewall is doing the right thing, even to...



LEO:  It�s harmless.  It�s not like it�s dangerous.



STEVE:  Right, doesn�t hurt you at all.  And it�s additional verification that just changing the name of a program won�t allow your firewall to be fooled.  So it�s there because it�s still useful.



LEO:  Excellent.  Excellent.  Steve Gibson, wonderful job.  Good luck with the fumigation.  We hope the tent comes off, and the house doesn�t fall down.



STEVE:  And I�ll talk to you next week, Leo, for episode 109 [sic], which will be another of our Q&A episodes, which I actually get a lot of email from people saying they love the Q&A.  So we�ll plow into that next week.



LEO:  Excellent.  We�ll see you next time on Security Now!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#108

DATE:		September 6, 2007

TITLE:		Listener Feedback #23

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-108.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss questions and comments from listeners of previous episodes. They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world 'application notes' for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson for September�6,�2007.



It�s time for Security Now!, and we�re in September already.  Steve Gibson, the year is waning, fall is on its way, and the bugs are out of your house.



STEVE GIBSON:  I�m back in the house and hopefully breathing pure air.  I�m not really sure.  They say they mixed the - the problem is that this Vikane, which is the commercial name of the gas, I think Dow produces it...



LEO:  Well, they have a spotless track record, so I think you should...



STEVE:  Yeah.



LEO:  Nothing to worry about.



STEVE:  Nothing to worry about in terms of pesticides.  It�s odorless and colorless.  So you wouldn�t know if you were breathing a potent neurotoxin.



LEO:  That�s nice.



STEVE:  But they deliberately mix in tear gas, which you certainly do know if you�re breathing.



LEO:  Oh, that�s smart.



STEVE:  Yeah.  And that way, if you happen to walk into a house, I mean, it�s not easy to walk into a house that�s got notices posted all over the walls, and it�s under a tent.  But you would immediately know that something was wrong.



LEO:  That�s what they do with LNG, right, it�s odorless.



STEVE:  Exactly.



LEO:  Well, that�s encouraging, anyway.



STEVE:  Yeah.   So we have no more bugs here.  So I haven�t seen any, as a matter of fact.  In fact, this area geographically has a serious spider problem.  And so I don�t know that I had any termites, but boy do I know that I had spiders.  And they�re not moving around anymore, so.



LEO:  How do they clear out - so that�s interesting.  Because I thought they were using poisons that - this has now become the bug report.  But I thought there were poisons that had a short half-life.  But I�m sure tear gas does not.  So I wonder - they must clear it out heavy-duty; right?



STEVE:  Well, yeah.  In fact, it�s a three-day process.  You�exit your home in the morning.  They put the tent over and then fill it with this gas.  It spends 24 hours in that�condition.  Then they remove the tent, open all the�windows...



LEO:  Oh, that�s good.  Vent it right out into the�environment.



STEVE:  Exactly.  In fact, it�s funny because it�s heavier than air.  That is, the Vikane is - it settles to the ground.  So they also put some fans in your home to keep your air stirring around.  And one of the homeowners during one of these prep meetings were saying, well, you know, what about if I�m, like, living in a home below one that�s been fumigated, and then you take the tent off, and all the Vikane pours down the hill into my home?  And, you know, the poor Terminix guys roll their eyes and say, well, lady, you know, just exhale.



LEO:  They live with it.  I wonder...



STEVE:  Oh, as a matter of fact, that�s one thing that I felt good about was these poor guys, I mean, they�re in this Vikane environment all the time.  So I�m figuring, well, if they�re clearing it out - and they do go in with sniffers, they say, to make sure that they get no readings.  And the original label said it had to be as low as five parts per million.  And now they�ve changed it to one part per million.  And then the guy said, oh, yeah, but we always get zero.  And I�m thinking, I think that heater�s working.



LEO:  Zero.



STEVE:  How do you get zero?



LEO:  How do you get zero anything?



STEVE:  Maybe it�s just stuck on zero, yeah.



LEO:  Let�s get to security.



STEVE:  Oh, why don�t we.



LEO:  Enough of pesticides, although I find this fascinating.  But we probably should talk about security.  First of all, any errata, addenda?



STEVE:  Oh, I�ve got a ton of things, Leo.  Okay.  First of all, top of this episode I wanted to suggest a change in our format from now on.  During my reading of email, incoming email, I ran across sort of a grumbly note, actually it was grumbly phrased, from one of our listeners saying, essentially, or actually pretty much, why don�t you guys drop this artificial distinction between the Q&A and the Mailbag episodes and just call the even episodes - oh, and he was grumbling about mod 4 and still didn�t like our equations.  Just call the even episodes Listener Feedback, whether they�re questions or they�re comments.



LEO:  That makes sense.



STEVE:  And, well, I actually liked it because I have been having trouble, like, sorting out questions and comments.  And so, for example, many of these that we�re going to start our show with this week I actually found two weeks ago when I was only looking for comments and not questions.  So it hasn�t really functioned well at my end.  And frankly, also, so many people have written saying they love the Q&A episodes, I think we really end up with a nice mix because the Q&A episodes allow us to spend an hour talking about all kinds of different things, whereas the odd episodes are generally single topic or a low number of topics, at least, where we�re focusing in more depth.  So I really like that.  And if it turns out that we tackle some big issue that needs multiple parts, well, we�ll just drop a feedback for that one if we need to do several hours in a row.  So we�ll give ourselves some freedom.  But from now on, no more distinction, Mr. Grumbly, between the Q&As and the Listener Feedback, the so-called Mailbag.  They�re just all Listener Feedback episodes.  And we�re doing No. 23 today.



LEO:  Well, we thank you, Mr. Grumbly, for a good�suggestion.



STEVE:  Mr. Grumbly evolved Security Now!.  Okay.  Big correction to what I assumed incorrectly, and have since verified, last week.  I assumed that the fact that VeriSign would sell you three of their tokens, fob dongles, whatever we call them, deals, meant that you could simultaneously register multiples.  And you can�t.



LEO:  Oh.  Well, why do they sell you three, then?



STEVE:  I don�t know.  One of our listeners, actually very courteous, a Walter Soldierer I think is how I pronounce his name, he provided me with the name of the guy at VeriSign, and email address, who�s in charge of the whole PIP technology program.  His name is Gary Krall at VeriSign.  I sent Gary a piece of email saying, hey, I was really glad to get your name and email.  I�m told you�re the guy who would know this.  Is it in fact the case that it�s possible to register multiple "tokens," is the word Gary uses, although on the site they use the word "credential."  And this is the thing that we�ve been calling, you know, the PayPal fob or dongle or token or whatever.  So, and he said, oh, that�s an interesting idea, but no.



LEO:  No.  Nice try.



STEVE:  I mean, and he referred to many late nights.  So I have a feeling that he�s, like, really the guy on the front line of the technology.  And he explained that it would require a substantial change, like new database format update and things, to, as he put it, to "bind" more than one token at a time to the account.  So I wanted to correct - I mean, people were really excited about this, as was I.  And Gary did promise to add it to his list of possible updates.  But I didn�t get the sense that it would be happening anytime soon.



LEO:  All right.  Good to know.



STEVE:  So, yes.  Also I did mention the combination lock padlock gizmo last week, and that I ordered two.  They both came.  I was going to crack one open to see what it looked like in terms of how difficult it would be to work around the padlock.  I really like the device.  However, it is conspicuously larger than - actually larger than I expected it to be from the photos on their site, and certainly larger than a so-called "thumb drive."  This is a - I would call this a large middle finger drive.



LEO:  Okay.  Is that in terms of length?



STEVE:  Yes.  And, you know, when you think about it you really do need - it needs more panel surface in order to be able to host a five-key pad where they put zero and one together and two and three together and so forth.  So you have five combination buttons.  Then you�ve got a sort of initiate button that shows a padlock, I mean a key on it.  And then other little icons that light up when it�s doing different things.  So, I mean, this thing, it�s big, but I have to say I think it�s pretty cool.  I mean, if you have an application where, again, you�d like to store either one or two gig of data in a fashion which is not going to be easily read, for example if, you know, it�s around the house and you don�t want your kids to get it, or a coworker or so forth, I mean, this thing, it�s by Corsair, and they call it the Padlock, the Flash Padlock.  So it�s neat, but it is big.  It�s not a thumb anymore, it�s like I said, more like a long middle finger.



LEO:  All right.  And these things are getting smaller and smaller.  So if size is an issue, there may be some other choices.  And they put TruCrypt on it.  It�s just as secure.



STEVE:  Right.  And speaking of USB dongles, Sony, as you may have heard, Leo, has done it again.



LEO:  Oh, no.



STEVE:  Yes.  They�ve got a USB dongle that has a thumbprint�reader or a fingerprint scanner of some form on it.  Remember that we talked about SanDisk having one before.  Unfortunately, Sony�s has software which includes again rootkit.



LEO:  They can�t stay away from it, can they.



STEVE:  Ugh.



LEO:  You know they�re suing the company that did the rootkit, the original rootkit.



STEVE:  Oh, it�s been a big mess, yes, you�re right.  Sony is suing them because of course they got in a lot of hot water for doing this with their, as we talked about it back in, like, it was �05, the original Sony rootkit scandal.  Well, now they�ve done it again.  When you install this software, it installs a subdirectory underneath the main Windows directory which hides all the - it hides itself, that is, the subdirectory itself, and all the files it contains, and executable content.  So, and it hides it from the Windows API using rootkit technology so that - and it�s confirmed that virus scanners and malware scanners will not find things that are in there.



LEO:  So this is their - they keep coming back to this idea that the best way to be secure is to be rootkit.



STEVE:  Oh, I mean, it is just another - well, we know what a bad idea it is.  And remember that last time they did this with the Sony VCD stuff, it took about two weeks for malware to be written that would leverage the Sony rootkit in order to hide itself using that technology.  And so it doesn�t take much imagination to imagine, although this is, of course, being a USB thumbprint dongle, there�s going to be far less market penetration than there was of any audio music CD from Sony.



LEO:  Well, and you�re buying a secure dongle.  So presumably it�s a little different than sneaking this onto your system through a CD.



STEVE:  Like for example on - exactly right, Leo.  Any consumer audio CD.  So, but again, they apparently have not learned their lesson.  And...



LEO:  Hard to believe.  Hard to believe.



STEVE:  Just unbelievable.



LEO:  And again, part of the reason this was so easily utilized by hackers last time was it really had a big flaw.  It was very badly written.  Any file of a certain type, filename, was all of a sudden hidden.



STEVE:  Right.



LEO:  Maybe they didn�t make the same mistake, but I�m not going to count on it.  We don�t know exactly how dangerous it would be, I guess.



STEVE:  And then lastly I wanted to mention that, without reading endless individual emails, so many people agree with us, Leo, about PayPal.  I mean, that is to say about the negative aspect of this weird, you�ve got to register with a checking account in order to become authenticated, then there�s no way to - I mean, I got all kinds of email from people saying, yes, yes, yes.  And, in fact, some saying that, due to the fact that this is a default that cannot be changed, that is, that PayPal will force you to manually override their deducting from your checking account, one guy did in fact have a fraudulent transfer made and just went through all kinds of hell trying to get his money back.  Basically PayPal never was able to do it because it was gone.  It was out of his checking account, and they were not ensuring it.  But he had a third-party insurer of the transaction that ended up - he ended up being able to get restitution from.  But it was a nightmare.  So, I mean, I have read a bunch of horror stories and corroborations of, like, why is - this just seems like a bad and dumb thing for PayPal to be doing default-wise.



So, finally, I got - as far as I know this is the first, at least the first one I�ve seen, a report from a Nerds On Site nerd who used SpinRite.  And I didn�t really pick up on it at first.  He said:  Please - his name is Raoul Velez.  And Raoul said:  Please pass this to the feedback section of SpinRite.  So he must have sent email to my office, and they forwarded it to me.  So all he said was:  My name is Raoul, and I am a nerd.  And I thought, well, okay, you know, I am, too.  So nice of you to just step up and admit it, Raoul.  So he said, I�ve been a nerd since my retirement from the Navy three years ago.  And I thought, okay, well, he�s a late nerd bloomer.  But so he says, yesterday I received a call from a hotel in the Raleigh area that their server was down.  I went in, took a look, and after talking to the manager about what they have done and what they were heading, he wrote, or where they were heading, he says - anyway, he says, I decided that it was time to give SpinRite a chance.  The software ran for almost seven hours.  At the end, the server rebooted, and voila, it was working again just in time for the morning checkouts.  The drive has to be replaced, but we�ve been able to buy some time and back up critical files that otherwise would have been unavailable and would have had to have been recreated.  Needless to say, the front desk people were loving me.  It�s a great thing we have a site license.  And that�s when I go, ah...



LEO:  That kind of nerd.



STEVE:  This is a Nerds On Site nerd.  So he says, it�s a great thing we have a site license for this.  By the way, I also own my own personal license of the software.



LEO:  Oh, that�s neat.



STEVE:  And this is signed Raoul E. Nerd in Cary, North Carolina.  So we had a neat - we had a combination of a SpinRite success and a Nerds On Site story.



LEO:  Very nice.  Shall we talk - are you ready to go to our�questions?



STEVE:  Absolutely.



LEO:  And we do hold 12 fantastic questions.



STEVE:  Thanks to our fantastic listeners.



LEO:  Starting with Justin Teal.  He has a way not to use WEP or WPA.  We�re talking about wireless security here.  Wow.  He says - yeah, wow.  I like the idea.  He says rather than use WEP or WPA he just turned off wireless broadcasts.  That�s what broadcasts the name of the network.  And he uses Mac address filtering to only allow his machines.  He says:  Isn�t that sufficient?  For someone to get on my network, first they�d have to know it�s there.  Second, they�d have to spoof my Mac address.  I�m assuming it�s enough protection because I don�t know of any way for someone to get the name of the network or my Mac address.  Steve, would you like to enlighten him?



STEVE:  Well, Justin, okay.



LEO:  I�m glad Justin asked this because I�ll tell you what, this is a very common - and I still go to places that say we need your Mac address before we�ll let you on our network.  And I just - I have to laugh at them.



STEVE:  Yup, yup.  Because, you know, well, for example, Leo, following up them saying that, all you would have to do would be to turn on any of the many and multiple available�sniffers.



LEO:  Ping enable is a good choice.



STEVE:  Exactly.  See any of the Mac addresses which are flying through the air, and go, oh, there�s one, and then�just...



LEO:  I�ll use that.



STEVE:  Well, yeah, exactly, clone that Mac address for your�own, and you�re automatically given permission to use the network.



LEO:  And it�s not just the Mac addresses flying through the air.  The SSIDs are flying through the air.



STEVE:  That�s exactly right.  Even though you�re not broadcasting it in beacon mode, you are able to see the SSID as part of the protocol in the wireless packets.  So, Justin, I�m afraid to tell you that what you�ve done has a benefit, but not the benefit you�re looking for.  The benefit it has is it will prevent people from inadvertently using your wireless network.  We see this all the time with, for example, in apartment buildings or in condo complexes or in any situation where you�ve got, you know, many times people will turn on their Windows and look at the available wireless networks.  And you�ll see five or six of them at different signal strengths.  Well, you sort of choose which one you want to join if they don�t have security.  The point is that it�s often inadvertently the case that somebody would be using yours without your permission and even without their knowledge, just because their system would have said, oh, look, there�s open Wi-Fi.



Well, turning off the beacon prevents it from being seen in that mode where it�s just looking at all the available networks.  And turning on Mac address filtering will certainly prevent their system from inadvertently connecting to your wireless access point.  But anybody nefarious who actually still wanted to get onto your network could still do so easily.  As we just said, all you have to do is sniff the traffic.  The traffic shows the SSID, that is, the name of your access point, and the Mac addresses of all of the devices that are flying through the air.  So it�s very easy for someone to use an existing Mac address and be authenticated and authorized on your network.  So it will prevent people from using it by mistake.  But it certainly isn�t bulletproof if somebody wanted to get on your network without your knowledge or permission, and they certainly still could.  The only way to prevent that is through one of the encryption technologies.  And of course WEP still has problems.  Now WEP is so badly broken that someone with the latest WEP cracking tools, which are, again, freely downloadable and available on the Internet, it takes them about a minute to crack the WEP key on a WEP-encrypted network.  Only WPA is safe.  And any version of WPA is safe�enough.



LEO:  So that�s kind of the bottom line.  There is one thing that works, WPA, and that�s it.  And that�s pretty easy to remember.  David Johnston of Eufaula, Alabama, says:  I, like many of your listeners, am the tech guy for my family and friends.  He heals many an ill PC.  Actually wants to talk about virus scanning and removal.  To scan an infected PC drive I have a standalone beige box PC running Windows 2000 and Symantec AV 10 that I�ll install the infected drive in as a slave.  I then scan the, I�m presuming the master drive, for viruses and spyware.  So how effective and safe is this?  I�ve cleaned many drives and never noticed any ill effects on my PC.  Oh, I see.  He takes the - I get it.  No, he takes the infected drive and puts it in as a slave and then scans it.



STEVE:  Right.



LEO:  I�m wondering how likely it is that a virus will migrate from the slave drive to the master drive.  Thanks for the help, and keep up the great work.  Interesting�solution.



STEVE:  What�s interesting about this is that what he�s done is he�s avoided the possibility of viruses on the slave drive being live.  The problem is - if he were booting that drive and then trying to scan it on itself, the problem is you could have things that have antivirus scan technology.  But by pulling the drive out of its normal live mode, sticking it in essentially as a data drive, not as a bootable drive, none of the code on that slave drive ever has a chance to run, so nothing malicious has a chance to ever get going.  Now, he is assuming that, as he calls it, his beige box, his scanning machine, he�s assuming that that is clean and doesn�t have anything bad on it.  You certainly wouldn�t want it to have something bad on it that would then be able to clone itself over and jump onto any drive that was inserted, and certainly historically that�s been sort of a propagation strategy for viruses of the past...



LEO:  He can�t cross-infect from the slave drive, the one he�s put in, to the master drive.



STEVE:  Exactly.  Exactly.  And that�s the key.  There is, you know, he needs to be conscious of the fact that it could go the other way, that if something did get infected on his beige box PC that he�s using for scanning, that master drive could potentially infect the slave.  But his question really was can anything on the slave get over to the master drive?  And given what he�s talked about, I don�t see any way for that to happen.  So I think it is, it�s a neat idea to scan a drive that is not running so that it doesn�t have a chance to protect itself.



LEO:  I mean, it�s a lot of work because you have to pull the drive and put it in the beige box.  A lot of people will do this with a CD.  They�ll make a boot CD, which can�t be reinfected.  You know that�s clean.  The drawback to a boot CD is that it�s not always up to date.  You have to make it fresh every time to make sure it has all the updates.  I think F-PROT, the folks at Frisk have software for making DOS-based boot scanners.  And of course there�s plenty of Linux scanners, too.  But then you have to always update it, which could be a pain.



A listener named Dale has a blast-from-the-past question.  Episode 32, a ways back, we talked about bogon space and listed a bunch of IP ranges that are in the bogon space.  Is he talking about bogus?



STEVE:  No, bogon, in fact, yeah, bogon.



LEO:  They�re nonroutable.  So if 5. space is bogus, how come Hamachi, which uses 5., is workable?  5. lives in bogon�space.



STEVE:  Yeah.  So, okay, let�s back up a little bit and, since this has been a blast from the past, review from the past.  The Internet has a bunch of blocks of IPs which have even today still not been used.  And in fact there are - it�s a surprising number of IPs that are completely unusable.  So, for example, the 4. space is in use, but the 5. space, that is to say, any IP that begins with 5. and then its three other components, has never in history been used.  So, and there are many other similar so-called "Class  A" networks, that is, various numbers at the start of the IP address, so something dot something dot something dot something dot something, that first number has never actually appeared in use.  They�re called nonroutable because, if you happen to drop a packet onto the Internet at a given location, as we know from talking about how the �Net routing works in episodes in the past, a router would go, oh, here�s a packet that begins with 4.  And it would have tables, routing tables that tell it which direction the 4. network is in.  And so it would route that packet out of the proper interface toward another router that would have a similar table that would tell it where to forward that packet to.  So the packet hops from router to router, heading toward its destination.



Well, if you dropped, for example, a 5. packet onto any router on the Internet, the router would say, huh?  It has no instructions about where to send that packet because no 5. IP addresses exist.  Somebody owns that network space.  I think all of the space is owned by various people, or maybe just never assigned by the main signing authority, but still the point is that there would be no routing table entry telling the router where to send that packet.  So Dale�s question is, if that�s the case, how does Hamachi do this?  Well, what Hamachi does - Hamachi of course is a peer-to-peer networking technology that uses VPN-like technology to create sort of ad hoc peer-to-peer networks.  What Hamachi is doing is it�s actually using the normal routable IPs, that is, the normal IPs that the Internet is currently using and which Hamachi�s users currently have assigned.  It�s using those IPs to actually move the packets from machine to machine as required.  But once the packet arrives, it takes the envelope off of that packet, and that�s where the 5. addressing is.



So to say this differently, the machine that you are talking to has a packet with a 5. address, which is nonroutable.  What Hamachi does is it puts a packet around it, it encapsulates the nonroutable 5. packet in a standard Internet routable packet with the destination IP of the other Hamachi machine where this packet is bound.  So that packet it puts on the Internet, which is routed to that target machine.  When that machine gets it, it takes that wrapper packet off of the interior packet, which is addressed to the 5. address of that target machine.  So essentially the packets that Hamachi is routing are internally using this unroutable 5. space.  But externally they�re using standard Internet addresses.



LEO:  That makes sense.  The other unroutable spaces, the bogon space IP addresses are 192.168?



STEVE:  Well, of course, those are private IP spaces, like 192.168 and then 10. space, of course.



LEO:  Are those considered bogon or not?



STEVE:  Well, they�re really not bogon.  They�re privately, I mean, they�re well-known, in-use private networks, as opposed to...



LEO:  But they�re not routable.  They can�t be used on the��Net.



STEVE:  Publicly, correct.



LEO:  Mark Ryan of Agassiz, BC, Canada has a two-factor authentication system he�d like to share with us.  First of all he says:  Thanks for the work you do to make the Internet a safer place to roam in.  I�ve listened to all the Security Now! podcasts, and the information you provide has helped me keep the computers of mine and my own running with fewer problems for years.  He�s owned a copy of SpinRite for about five years, and he says:  I know it�s one of the main reasons my computers have continued to run smoothly for years, one for about seven years with no reformatting.  How often do you recommend running SpinRite?



STEVE:  Well, I would say quarterly is probably often enough.  I would say maybe once a year is not often enough.  We�ve run into many instances where people have run SpinRite and it�s found lots of uncorrectable errors.  It�s certainly the case that, had they run it more often, SpinRite would have worked with them to correct those before they became uncorrectable.  So, I mean, it absolutely is preventative maintenance.  And so quarterly is prob- once every three months or maybe every four months, do it three times a year.



LEO:  And it wouldn�t take seven hours if you do it all the�time.



STEVE:  No, it zooms right along when it�s not stuck on a�problem.



LEO:  If there�s something wrong, that�s when it starts to take a while.  We often say, oh, it took about - that one they said three months, and I think that scares people off.  That�s only if there�s a problem.  That�s only if you really need it.



STEVE:  Right.  And in fact, you know, it is interruptible.  You can stop it.  You�re able to start it past the prior problem if you don�t care about it fixing something where it�s stuck.  You�re able to kind of nudge it forward and say, okay, let�s get on with this.  So there�s all kinds of options while you�re running it.



LEO:  Rob Hartvikson writes from Italy...



STEVE:  Oh, we skipped the second part of that.



LEO:  Oh, there�s more.  Yeah, he mentioned a - I�m sorry.  I got so caught up in that, I forgot to mention his two-factor authentication system he uses.  His broker has introduced what seems to be a pretty slick system, a card with a unique eight-character ID number and 224 columns on this card containing three random alphanumeric characters.  To use the card I have to register it to my account.  And then when I log into my broker, I enter my username and password, and then the site gives me two numbers corresponding to the columns on the cards.  So you look down the column and along the row, I guess, and enter the two sets of three characters from the matching columns, and now I have access to my account.  So how secure do you think that is?  It�s better than a password alone, but what are the weaknesses?



STEVE:  Well, it�s a neat idea.  It combines - it sort of combines something you know and something you have because you�re being prompted by the site that wants you to log in for information that only you will have.  He talked about the card having a unique eight-character ID.  So clearly the card was algorithmically created based on that ID number so that back on the server they know the ID number associated with his account, which is the ID number on his card.  That allows them to know what his card contains.  So then he�s randomly asked to essentially read out part of the data on the card.



We mentioned this kind of approach briefly a couple months ago, and I wanted to bring it up again because I think it is really kind of cool.  It has the advantage of being extremely inexpensive.  For example, in this case I think his broker set him up with a card.  But there are systems where you print your own index.  When you�re signing up, it gives you a page, you print it, you fold it, you stick it in your wallet.  And this thing has essentially a ton of pseudorandom data.  It�s pseudorandom because it was algorithmically generated, not truly random.  Otherwise the server would have to maintain an exact copy of what it was that you were carrying.  And of course pseudorandom is no weakness as long as you don�t know what the algorithm was to generate it, and as long as no bad guy had the eight-character ID number.  And the eight-character ID number is not part of this challenge-response handshake, so that can�t be known either.  So it�s really cool because...



LEO:  Is it better, do you think, than the dongle?  Or, I mean, is it as good, I should say, as a dongle.  Or the fob.



STEVE:  I think one of the things I like about it is it has no batteries.



LEO:  Yeah.  You carry it in your wallet.  It�s cheap.



STEVE:  Exactly.  You can carry it in your wallet, it�s cheap, you could Xerox it.  Now, you might say, wait a minute, that�s a security weakness.  If somebody briefly got your wallet and Xeroxed the card, now they�ve got a copy of it, now if they had your username and password they can log on as you.  So that�s a problem, unlike the dongles and fobs which are, you know, you can�t Xerox those.  We don�t have teleporters that can do matter duplication at this point.  So there�s a weakness.  But on the flipside, it�s inexpensive, and it�s going to give you very good security.



So one vulnerability would be that somebody could record one transaction, that is, if they were monitoring through a man-in-the-middle attack of some sort, and we�re assuming that this would all be over secure socket layer connection with valid certificates and everything, so that would be ruled out.  But if there were something, for example, on your computer, upstream monitoring your screen and keyboard, for example, that was capturing your transaction, there is the possibility for a replay attack, where something sees you log on, sees the numbers you�re being given from the server, sees the alphanumerics that you returned...



LEO:  Because it would match every time, wouldn�t it.



STEVE:  Exactly, because the data on the card is static.



LEO:  There�s the flaw.  There�s the flaw right there.



STEVE:  Yeah.  The data on the card is static, whereas the dongle is a constantly changing number that never repeats.



LEO:  So if you had a man in the middle, all you�d have to do is watch.



STEVE:  Yup.



LEO:  Ah.  It�s still pretty good.



STEVE:  But still, absent that, it�s less expensive than hardware, and it�s really - it is certainly stronger than just a username and password because what you�re being asked to provide changes every time.



LEO:  Very interesting.  Now to Rob Hartvikson, writing from Italy.  He�s wondering about rotten bits.  I just listened to Security Now! 104 and your discussion about bit rot on Windows and using SpinRite to correct it.  If I understand correctly, SpinRite will deal with bit rot.  Doing a complete drive reformat is not going to give me better performance over just running SpinRite.  Oh, that�s interesting.  What if he�s willing to erase and reformat?  Is that just as good?



STEVE:  Well, I wanted to bring it up real quickly because we had a couple questions that were asking similar things.  A reformat is, except for the areas of the drive that involve the file system, where the directory and bitmaps and so forth that manage the contents of the file system, a format is only doing a read pass, given that you do a long format and not a quick format.  Most people these days just do a quick format because a long format is really a long format.  I mean, it�ll take a long time to format the drive.  All it�s doing, though, during that long time is reading all the sectors.  Well, that�s better than not doing that.



But SpinRite ups the ante one level because SpinRite in its normal mode is reading/writing, reading/writing, and reading the drive.  So it�s actually flipping all the bits twice, looking for any problems being reported by the drive, and giving the drive then the chance to recognize that there�s a trouble sector that it should map out of use.  So SpinRite will give you a better result than just reformatting the drive.  But reformatting the drive is better than nothing.



LEO:  Right, okay, cool.  Jeffrey in Columbia, Maryland is ready to defrag:  A while back you were talking about some of the free programs you use.  One of the programs you pointed out was SpaceMonger.  The other was a free hard drive defragging program.  What was the name of that defragging program you recommended?  He uses Diskeeper Professional.  His license is up, and he wants something free that works just as well.  Is there a free one?  I don�t remember mentioning that.



STEVE:  No.  I wanted to let Jeffrey in Columbia know that it wasn�t a free one I mentioned, it was a good one that I mentioned.  And actually I now have two favorites.  I think I referred to Vopt.  Vopt is very nice.  It�s at Version 8 now.  However, I�ve started using one called PerfectDisk.  And I bought it because I was very impressed with it.  It will do something that Vopt won�t, which is it will defrag the so-called metadata.  What I was talking about just a  minute ago when I was talking about the bitmaps and the directories and things, nothing is able to move those because those are locked by the system while the volume is in use.  PerfectDisk is able to do a preboot defrag of those and, for example, to defrag your swap file, which is another area that cannot be moved around while you�re running the swap file, running on the drive with the swap file.  So I like PerfectDisk, and I like Vopt.  And I also wanted to remind people, we got a bunch of other questions about what was that thing that allows you to see where your drive has gone, or how much space....



LEO:  Yeah, SpaceMonger, yeah.



STEVE:  And that�s SpaceMonger.  So I wanted to reiterate the name of that for people who were asking that question, as well.



LEO:  And there�s a free version, and there�s a newer version which is no longer free.  But we like the free�version.



STEVE:  Oh, SpaceMonger 1.4 is the last free one that Sean wrote, and it�s all I use.  I mean, his new one does all kinds of wacky things, but much more than SpaceMonger.  And for me, SpaceMonger is enough.



LEO:  And for the Mac there�s a program that does that, as well, I think it�s called Drive Space X, that is also free.  Is that it?  Oh, now, see, every time I do this I forget the name.  There is a Mac program, and I�ve once again forgotten the name.  For some reason I think it�s Drive Space X.  But anyway, good.  No free defraggers unless you send us an email and tell us about one.



STEVE:  Well, of course, you know, Windows has one built in.



LEO:  Oh, that�s right.



STEVE:  Under Accessories and System Tools is a defragger.



LEO:  Yeah, why not use that?



STEVE:  And it is, the technology was licensed from Diskeeper.  It is a nice defragger.  And that may be all you need.  What I like is that, well, first of all, PerfectDisk does defrag the so-called metadata areas, which nothing else will do because it does it as a boot-time defrag, like a preboot defrag.  But Vopt and Perfect Disk both do something else, and that is they look at the amount of use you�re giving to the data and arrange it for faster booting.  So, and again, PerfectDisk does an even better job than Vopt, which is why I bought PerfectDisk even though I owned Vopt already.  PerfectDisk looks at all the files that are used at boot time and moves them to the very front of the drive, and also looks at the frequency of use.  Files you don�t use very often it puts next.  Files you modify sometimes it puts in a big block after that.  And then files that are being modified all the time it puts right next to the free area.  The beauty of that is that it tends to centralize your fragmentation, which minimizes head activity, and it means that subsequent defrags run much more quickly because the files that are changing often are the ones that are getting fragmented, and they�re right next to the unused area in the drive, allowing them to be redefragged much more quickly.  So it�s really my current favorite right now is PerfectDisk.



LEO:  Good.  Very cool.  I have one questions, says Dennis Jones in nearby Carlsbad - nearby to you - Carlsbad, California:  One question I had about the PayPal Security Key, which I didn�t hear an answer to, is how do security keys stay in sync?  Because obviously PayPal has to have something that�s generating the numbers at the same time.  Generating a new key every 30 seconds requires the key to know what time it is within a second or two forever.  Do they have clocks that accurate to put on the key, or is there some clever way of keeping the key and server in sync?  That�s a good question.



STEVE:  It�s a neat question, and it�s cool because the answer is there is some window that the server allows for letting the key�s clock and the server�s clock be out of sync.  So, again, because the key is based on a pseudorandom sequence generator, and the server has the matching serial number for the key, and there�s a database at VeriSign or wherever which maps the key�s serial number to the cryptographic key which is being used to generate the pseudorandom numbers.  That means that the server can tell what the key�s number was 30 second ago, 30 seconds before that, 30 seconds before that, and what it will be now, 30 seconds in the future, 30 seconds in the future, and 30 seconds further in the future.  So that creates a window which really can be as large as somebody wants to allow it to be based on how long you want the key�s current number to be valid in the face of some time drift.



However, as soon as you give a number which is within the window, now the server knows within 30 seconds� range what time your key thinks it is.  So with every one of these accounts, not only is it storing the serial number, but it�s storing an offset from the most recent use of the key where the key clock believes time is compared to the servers.  And so every time you use the key it relocks or resynchronizes the key�s clock to the server�s master clock to keep them from drifting too far out of sync.



LEO:  Very clever.



STEVE:  It�s really clever.



LEO:  Yeah.  John Pearce posted this one in the GRC Security Now! newsgroup - highly recommended, by the way.  He says:  My PayPal and eBay accounts have secure passwords, that is, randomly generated using your site.  Oh, he�s using the first 30 characters, I guess, from your password generator because it�s 64 characters; right?



STEVE:  Yup.



LEO:  He says:  I have to use my Password Manager to use them since there�s no way to remember them.  It�s a bit of a�pain for me.  But I do it.  Once I receive the PayPal Security Key, will I still need a huge password that�s impossible to remember to be secure?  Or can I now use a relatively short, easily remembered password, combining that with the key digits?  It would seem logic dictates something�short and sweet would be fine.  However, I don�t trust myself to consider all possibilities.  He wants your�opinion.



STEVE:  Well, it�s a great question.  So what he�s saying is, before I had the PayPal Security Key, that is to say, given a two-factor authentication so that I have to have this thing in my possession, I was just using my username and password.  So now that I�ve got that, that is, I�ve got two-factor authentication, doesn�t that mean that I�m depending less on the first factor, which used to be all he was depending upon, now I�ve got two factors.  So can I weaken the strength of the first factor because now I�ve got something even stronger than the first factor ever was, which is this thing that I�m in possession of which is changing every 30 seconds?  And I would say absolutely.  That is, it is certainly the case that two-factor authentication allows him to weaken the first factor.



Now, consider that he has a burden of he�s been relying on an unmemorizable 30-character random text string that he got from GRC's password�s page.  So what he�s asking to do is, couldn�t I bring this thing down now to something I can remember so I don�t have to use my Password Manager?  And I would say absolutely.  But here�s the threat.  The threat is that he loses control of his second factor.  It is physical.  Somebody could borrow it or make off with it.  And then their challenge is, since they�ve essentially got the second factor, all they now have to crack is the first factor.  So you don�t want to weaken it so much that it would be possible to guess his username and password through traditional brute-force dictionary attack, any of those reasons that he was using his 30-character nightmare password in the first place because by somebody getting a hold of his second factor, they�ve taken that completely out of the equation.  Now he�s only being protected by his first factor, which needs to be strong enough to balance the possibility of him losing control of his security key.



So, I mean, practically, I would say yes.  Still you must practice safe single-factor security under the assumption that somebody could get a hold of your second factor, that is, of your security key.  But you don�t have to go way overboard any longer with a 30-character bizarro password.  Just do something that�s not in a dictionary, that isn�t prone to brute-force attack.  So it needs to be long.  It needs to combine words, maybe a couple special characters, and something that�s not going to be easily guessable.  And then I really think you�re okay.



LEO:  Yeah.  I mean, the other issue, of course, is that PayPal allows you to use your password without the dongle, but then you have to go through some additional security questions.  So if you weaken the password too much, I don�t know.  And then they go through the security questions, it seems like that might be another kind of reason to...



STEVE:  Another way in, good point.



LEO:  Michele Thomas in Olney, Maryland needs the URL - I need the URL.  I was listening to Episode 106 and heard you guys mention the VeriSign fob/token/key/dongle thing, but you didn�t give us a link as to where we can get them.  You talked about being able to order multiple ones that could all be tied together.  Well, we�ve destroyed that notion.



STEVE:  Yes.



LEO:  I went to the VeriSign PIP site to sign up for a PIP account.  That�s nice.  It�ll come in handy.  But I really would like a fob.  She already has the PayPal token, which I got after you mentioned it last month.  I like the - he or she.  I like the VeriSign idea to have multiples so I can keep one in my purse - she - one at work and one at home.  Or he.



STEVE:  Let�s not be discriminating here.



LEO:  I�m not going to make any exceptions.  So first of all we should say that, as Steve mentioned at the beginning of the show, that was an error.  You can�t get three and have them all be the same account.



STEVE:  Correct.



LEO:  Each token is a separate account; right?



STEVE:  Now, you know, I hadn�t thought this through.  I�m doing this on the fly here.  But if you had multiple PIP accounts, each single account associated with a different dongle, then we�re back in the game, Leo.  No one says you can only have one.



LEO:  Well, many people have many OpenIDs.  That�s right.



STEVE:  Well, exactly.  So all you need to do is have - hey, that works.  So you [trumpets].



LEO:  VeriSign may not like this, but yes.



STEVE:  Yeah, so you create multiple PIP accounts, and you give them, like, you know, for example, I�m stevegibson.pip.verisignlabs.com.  So I would be stevegibson1.pip.verisignlabs.com, stevegibson2.pip.verisignlabs.com, and stevegibson3.pip.verisignlabs.com, each one associated with a different dongle.  I then write a 1, 2, and 3 on the back of my three VeriSign dongles, have one at home and one at the office.  And when I want to authenticate, instead of having a single authentication URL, now I have one that matches each dongle.  But no problem because I just give each of those PIP accounts the same data to authenticate myself.  So we�re back in the game.



LEO:  Okay, good.  So, good, yeah.



STEVE:  We are recording now Episode 108.  Michele was listening to 106 where she was unhappy that she had no URLs.  In 107 we talk about this explicitly, and the URLs are all in the show notes.



LEO:  So go to the show notes for - it�s a long URL or we would give it out; right?



STEVE:  Yes.  And there�s a bunch of funky ones.  Now, here�s the other catch is that Michele already knows this, Leo, because she�s a loyal listener.



LEO:  She�s heard it by now.



STEVE:  Exactly.  So she sent in her question, frustrated after listening to 106.  And then she found that it was magically answered in Episode 107, even before I read her question for Episode 108, which is what she�s listening to now.  So everybody�s happy.



LEO:  Now, we should say that the show notes are on your site, GRC.com/securitynow.



STEVE:  Yes, under Episode 107.



LEO:  And there are show notes for a lot of episodes.  Look at it on there.  Wow.  Starting with "As the Worm Turns" in August 19, 2005, that�s Episode 1, all the way up to Episode 107, which will go up - it�s not on right now because we�re recording this early, but will go up any minute now, I�m�sure.



STEVE:  So just to deconfuse people who have just been crossed by all this...



LEO:  It�s a time thing.



STEVE:  At the top of this episode I reported and corrected the mistake of my assumption that because VeriSign would allow you to purchase up to three dongles at once - oh, and by the way, Leo, I have verified that you can get even more because I bought another three.



LEO:  Oh, wow.



STEVE:  Just because I love them.  I think they�re cool.  So now I have six of those.



LEO:  Do you give them out as party favors?



STEVE:  They�re just neat.  Actually I�m thinking maybe I�ll use them with my own employees for some future stuff, too.  So it�s just very cool.  So I corrected my assumption that you could, as the VeriSign guy puts it, bind more than one dongle at a time to a PIP account.  But nothing prevents you from having multiple VIP PIP accounts, associating one dongle with each, and just putting in the URL, which you�re able to create for yourself, put in the URL with a 1, a 2, or a 3, and write that on the dongle, and then we�ve solved the problem.  You�ve got multiple dongles.  She can have one in her purse, you can have one at home, one at work, wherever you - as many as you want them, and just set up a separate account for each one, and you�re good to go.



LEO:  That�s easier obviously with a PIP account than it would be, say, with a PayPal or eBay account because you only have one.  I have one PayPal account.



STEVE:  Exactly.



LEO:  But PIP it doesn�t matter, you can have as many as you�want.



STEVE:  Anyway, we did confirm with the PayPal guy that it is only a single dongle for now.  And now that we know that they�re using VIP, the VeriSign Identity Protection technology for the back end, it probably won�t be until they allow multiple token bindings that it would be possible for PayPal to do that, too.



LEO:  Of course they would keep their algorithm top secret because it�s probably tied to the ID in some way.  And so there�s no way you could use a dongle for your own purposes�because there�s no way you could regenerate those tokens programmatically.



STEVE:  Well, and not only that, but you do get - oh, actually when you - in this case you don�t get any documentation.  But I also got some SecurID dongles from VeriSign directly that use a different technology.  They�ve got a constantly changing display.  A little bar graph on one side has - it decreases to zero height, and then the number changes.  And I think it changes every 30 seconds.  So it�s every five seconds a little square disappears to give you warning of when the number�s about to change.  So that�s simply based on time.  But when you get those you also get a CD with a set of XML files giving you the cryptographic key associated with each of those.  Now, as far as I know they�re still not documenting the technology.



LEO:  They couldn�t because that would viol- then you�d have something completely insecure.



STEVE:  Well, no, it�s because there�s no way of knowing from the outside without that XML file what the key is.  So they are providing that to you.  Anyway, I�m going to do a little more research on this because, frankly, I would love to be able to use the dongles myself directly and not need to go through the VeriSign back end in order to make the technology go.  So that�s my next email to our VeriSign�friend.



LEO:  Yeah, yeah.  They can�t very - they could show, I guess, the code, well...



STEVE:  And remember that the back of the key, the back of the fob/dongle/doohickey/gizmo, it�s just a serial number.  That doesn�t give you any information about what the cryptographic key is.  There�s a database that they have that matches the serial number to the cryptographic key.  So even knowing the serial number and knowing the algorithm wouldn�t help you guess the next number because you would never know what that key was.



LEO:  Which is why I was wrong, you wouldn�t want to tie the serial number to your algorithm except internally in some secret way.



STEVE:  Exactly.



LEO:  Jeff Schmidt, traveling somewhere in Northern California, he wants to encrypt his laptop drive.  He says you briefly mentioned in 106 the Hitachi Travelstar disks with bulk data encryption.  I know you�ve only got a thousand different subjects or tasks competing for your time, but for what it�s worth I vote for hearing more of your thoughts on this.  What do you think?  Well, you like it; right?



STEVE:  I very much like the idea.



LEO:  It�s strong encryption; right?



STEVE:  Yes.  Well, it is Rijndael AES encryption, which is state of the art, I mean, that is the good crypto technology to use.  I should digress a minute.  When we were talking about the passwords page, I don�t remember whether I mentioned - oh, I think I did.  It was the first part of last episode that I talked about having rewritten the algorithm for the passwords page.  I submitted 16 megabytes of data to those security researchers who had decided that I didn�t have enough entropy in my passwords.  Well, they�re happy now.  I�ve got something like 7.999989 bits of entropy out of a possible eight, so as much as anybody.  But what�s very cool is I wrote my own Rijndael algorithm, that is, my own Rijndael cipher, in Assembly language.  And then they asked - but just because, you know, that�s me.  Then they said, how many - how fast is your password generator?  Well, it generated, I don�t remember the number now, but it was like 81 million bytes of pseudorandom data per second.  And on their chart it is the fastest pseudorandom number generator there is.



LEO:  Really.



STEVE:  Yeah.  So there�s Assembly language for you.



LEO:  Wow, really.



STEVE:  Yeah, the fastest one there is.



LEO:  That�s cool.  That�s really cool.  He also wants - he says he knows you�re a Windows guy, but he wants to know if the Travelstar would work in his MacBook Pro.



STEVE:  My mission...



LEO:  Go ahead.



STEVE:  My mission is to nail this down.  I tried to do some research so that I would have an answer to this question by the time you posed it to me, Leo.  And I cannot find any documentation over on the Hitachi site.  So I�m going to have to get a hold of someone.



LEO:  I�m sure it uses a Windows client to interface with the hardware.



STEVE:  Well, it can�t because the entire drive is�encrypted.



LEO:  Of course, it�s got to be in BIOS.



STEVE:  Exactly.  It�s going to have to be something that is done in the BIOS when the drive is initially being booted.  And I think that the way they would do it is that they would simply use the standard security technology that is a part of the ATA spec to, you know, where you lock the drive.  Rather than locking it, they would now use that, they would take the password you give the drive, hash it into a long key, probably a 256-bit key, which is what the Rijndael AES cipher wants, although it can operate in 128, 192, or 256 bits.  But I think I remember seeing that it�s a 256-bit key, and that that�s what they would use.  It�s got to be done at the BIOS time.  But I�m wondering if there�s a recent extension to the ATAPI spec, which is the protocol used to talk to the drive, which supports bulk data encryption.  That�s what I�m going to see if I can track down, in which case you might need BIOS support in order to get the benefit, rather than being able to swap it in.  Anyway, I�ve got one of these drives.  It�s on my list.  As he says, I�ve got a long list.  But I�m going to see if I can track this down.



LEO:  Sounds like something Apple would have to support in its EFI boot stuff.



STEVE:  Don�t know yet.



LEO:  Yeah.  Interesting.  Edward in Fort Collins - because Apple does use, I�m sure, standard ATAPI controllers.  So if it is an ATAPI spec, shouldn�t be a problem.



STEVE:  Yes.



LEO:  Edward in Fort Collins, Colorado raises a very good question about virtual machine use.  He says:  My wife is stationed in Korea for a year.  Before she left I installed VMware Player with an Ubuntu appliance for her to do her banking on.  Oh, that�s cool.  What a good idea.  She asked the question, if she has a keylogger on XP, or some other form of spyware, can the hackers see what she�s doing in VMware since it�s running with Windows at the same time?��Oh.



STEVE:  That�s why it�s such a good question, Leo.  And the answer is she�s probably vulnerable.



LEO:  Depends on the keystroke logger, of course.



STEVE:  Well, exactly.  But his point is exactly right, and this is why I wanted to bring the question up because it�s very good.  What we�ve talked about using virtual machine technology for is containment.  That is, in a VM you�re containing something bad from getting out.  You�re not letting it modify your global machine, your host machine.  You�re keeping it contained.  His question is, what if something - essentially he�s inverted that.  He�s wanting to use the VM to protect what goes on in the VM.  The problem is, it�s running, it�s on Windows, it�s hosted on Windows, meaning that anything it does needs to run out through Windows.  So, yes, this is not a safe thing to do.  We don�t know again that a keylogger that exists today could do this.  Certainly the VMware system is putting keyboard and drive and network drivers into your system in order to achieve its goals.  But there�s nothing to prevent something in the kernel from chaining onto that driver and capturing from the�VM.



LEO:  When the VM window is active, though, does it capture the key scans directly?  Does it go through Windows at all?  Doesn�t the VM window capture it?



STEVE:  Well, there is no "directly."  It�s going to be down�in the kernel, and there could be drivers in the kernel, and VMware does install drivers.  But drivers can be�intercepted.



LEO:  I�m just wondering, if the window�s active, does it bypass - essentially the way keystrokes work is that the scan codes are sent from the keyboard, as you say, to a driver that then interprets them as keystrokes.  Is the Windows driver active when the VM window is active?



STEVE:  Yeah.



LEO:  It is.



STEVE:  Yeah.  Oh, yeah.



LEO:  There�s no way to turn that off.  So when you switch the context, you�re not switching all the OS context.  You�re still operating within the OS.



STEVE:  Exactly.  And in fact the installation of VMware�s acceleration drivers is optional.  So VMware will run without installing any of its own special drivers.  Those just make things go better.  So without them you�re really vulnerable, but even with them you�re still in Windows kernel.  Windows kernel is hosting this session.  And you�re needing to run through the kernel and through Windows drivers in order to talk to the hardware.  So the real takeaway from this is inverting the model, that is, wanting to do something secure in a VM to keep it from Windows is not at all the same as doing something dangerous in the VM that you want to keep out of modifying Windows.  Those are two very different things.  One works; the other one really�doesn�t.



LEO:  So the way to do this properly would be make a boot�CD...



STEVE:  Boot CD, exactly.



LEO:  Yeah, a Linux LiveCD.



STEVE:  Yes.



LEO:  And if she has to save her banking information, then you�d have to solve that problem separately.



STEVE:  She could do that maybe with a dongle, for example.



LEO:  Right, encrypted drive or whatever.  But, yeah, that would be very secure then.  Unless there�s a hardware keystroke logger.



STEVE:  Oh, you�re right.



LEO:  In that case you�re out of luck.  They�ve got you.  If�they got in so deep that they put in - replaced your keyboard or put something in between your keyboard and the computer to log keystrokes, you�re out of luck.  Which is why, even if you used a boot CD in the library, it�s...



STEVE:  Sounds like maybe she�s using a laptop.  He says:  She�s stationed in Korea for a year.  Before she left I installed VMware.  So...



LEO:  A CD would be a way to do this.



STEVE:  A CD is a great solution, yes.



LEO:  Rob Strating in Hudsonville, Michigan has a great question for encrypted hard drive users.  Want to know if the decrypted contents of the encrypted information on a sector in your new Hitachi hard drive makes it easier to find the AES key to decrypt the entire thing.  Hmm, interesting.  I ask because in any Windows installation the boot sector of the hard drive is always a constant.  Back in the day, IO.sys and MSDOS.sys were written in known locations of the drive.  In modern times it�s the NTFS bootloader.  Would it not make the encryption infinitely easier to crack for that sector, and then the entire drive?



STEVE:  That was a really good question.



LEO:  Boy, they�re asking tough ones today.



STEVE:  Yeah, we�ve got great listeners, Leo.  As a consequence of the way the encryption is being done, there is really no solution other than brute force.  The reason he asked the question, and I assume he�s been a listener for a while, is we have talked about many instances where knowing what the so-called "plaintext," that is, the nonencrypted data is, knowing what that is would allow you to attack the key because there are - oh, in fact this was one of the main weaknesses in the original implementation of Wi-Fi encryption, the WEP encryption, was that many of the contents of the packets were not changing.  WEP used a pseudorandom sequence generator to generate scrambling data, essentially XORing pseudorandom data with the plaintext.  And the problem was, all you had to do was re-OR that, re-XOR that with the plaintext, and you got back the sequence.



AES, that is, the Rijndael cipher, is a symmetric cipher.  So, and it�s a block cipher that takes 128 bits at a time and maps it using the key, the secret key.  It maps that 128 bits to a different pattern of 128 bits.  So it�s certainly the case that, for example, take the partition sector.  If we�re encrypting the hard drive, we�re encrypting the entire hard drive.  So the very first sector on the hard drive is the partition sector.  Well, we know a lot of what the contents of the partition sector is in the drive.  So essentially you would know what the first 128 bits are, and you would - that is, of the partition sector.  And you would know what they mapped to in the encrypted case, that is, what they encrypt to through Rijndael.



However, you quickly get lost because Rijndael uses, and I was referring to this last week, the so-called CBC, the cipher block chaining.  When you actually employ symmetric encryption, you don�t simply encrypt each block of 128 bits by itself.  You take the result of the previous encryption, and you XOR that with the plaintext before the next encryption.  And actually I have a diagram of that process down at the bottom of the passwords page now, at GRC.com/passwords, if someone wants to see sort of a schematic of how that looks.  In order to make this work, there is what�s called the initialization vector that I referred to also last week.  And that�ll be an additional 128 bits of secret data.  And so you have that 128 bits plus the 256-bit key.  And essentially it means that you need to do a brute-force attack, even though you know what some part of the plaintext and some part of the encrypted data is.  The way this mixes the data together means that immediately as you start encrypting blocks of data, you�re reduced to a brute-force attack.  And that means you�ve got, what is it, 256 plus 128 is 384 bits of secret data that you need to brute-force attack and, you know, have a nice day.



LEO:  I like that.  And I think one of the reasons he asked the question is because in encryption techniques like DVD encryption, CSS, the key has to - same thing with HD-DVDs, AACS, the key has to live on the player.  And so maybe that�s why he�s asking this question is...



STEVE:  Yes, and that�s a very good point.  The key has to live on the player, or it�s often, as we know, it�s discovered in RAM because it�s being used on the fly to decrypt the data.



LEO:  It has to live somewhere to work.



STEVE:  Right.  And that�s one of the things that�s different about hard drive encryption is that the drive itself does not have the key.  It doesn�t know the key.  It needs to receive the key when it�s booted up and initialized.  But it never stores it anywhere on itself.  It lives on the drive where you can�t get it out.  And it�s being used to encrypt and decrypt the data on the fly.



LEO:  But where�s the key?  Is it in BIOS?



STEVE:  The key, well, it depends...



LEO:  It�s somewhere on the hardware; right?



STEVE:  Well, and that�s where the Trusted Platform Module comes in, because it�s going to be in the Trusted Platform Module where, again, you cannot get to it.



LEO:  We hope.  I would never assume it can�t be gotten to.  Hackers are very determined.  But there�s less incentive.  I mean, really, frankly, it was one thing to figure out how to crack DVD encryption.  It�s another thing to figure out how to crack hard drive encryption.



STEVE:  Well, and also remember that, for example, the user has many modes of operation.  They could use their fingerprint scan to unlock the Trusted Platform Module, which then unlocks the key that goes into the hard drive to unlock the drive.  Or if they wanted more security, they could not use the Trusted Platform Module and have to type in, manually type in their password every single time they start up or resume the drive.  And so they would be typing in the password.  That then gets hashed to generate the long�key which the drive uses.  So literally you could set up your laptop so that it is not stored anywhere in the�hardware.



LEO:  Interesting.



STEVE:  So, I mean, it can be really secure.



LEO:  That�s pretty darn secure.  All right, Steve.  We�ve come to the end of this fascinating episode.  Boy, I thank our listeners for sending in such great questions.  Fascinating.  Tough ones, too.



STEVE:  Really.  And they covered the gamut, I mean, all just, you know, large range of questions.



LEO:  They do, indeed.  Yeah, the VMware Fusion just came out, and I really am very impressed.  In fact, in some benchmarks it�s faster than Parallels.  So there�s another way you can run Windows on your Mac.  All right, Steve.  We�ve wrapped this puppy up and tied a bow on it.  I think we�re done.



STEVE:  We�ll have a podcast for all of our listeners, without fail, next week.



LEO:  Yes.  I�ll see you in Vancouver next week, which is coming right up.  Thanks for coming.  We�ll see you next time on Security Now!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.








GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#109

DATE:		September 13, 2007

TITLE:		GRC's eCommerce System

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-109.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo delve into some of the non-obvious problems encountered during the creation of a robust and secure eCommerce system.  Steve explains the hurdles he faced, the things that initially tripped him up, and the solutions he found when he was creating GRC's custom eCommerce system.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.

	

This is Security Now! with Steve Gibson, Episode 109 for September 13, 2007:  Steve's eCommerce System.



It's time for Security Now!, everybody's favorite security podcast, the number one tech podcast in the nation.



STEVE GIBSON:  [Trumpeting] Thanks to our listeners, yeah.



LEO:  Part of the Podcast Awards.  You're going to go down and get your award in a couple of weeks.



STEVE:  I absolutely am looking forward to it.



LEO:  I will be in Vancouver, so I can't come congratulate you.  But it's ironic.  You'll be in Ontario, California.  I'm going to be in Vancouver, Canada.



STEVE:  That's true.



LEO:  But congratulations.  I think that's just really wonderful.  Really great news.



STEVE:  Well, again, we owe it to our listeners because I didn't even know the competition was happening.  And then we pushed out that quick little quickie short podcast saying, oh my god, you know, everybody please vote for us, I would love to win this.  And our listeners made it happen, so.



LEO:  Well, you know, I make a point of not, you know, most podcasts are always lobbying to get, you know, voted up in Podcast Alley and stuff.  And I - we did it once just to prove we could do it, and then I made a point of not mentioning it ever again because, you know, we know you love us.  We don't need to win any popularity contests.



STEVE:  I want a whole shelf full of trophies, Leo.



LEO:  It's nice to have the awards, though.  That's different, you see.  That's - I think that's nice.  And, you know, I've got my little shelf.  Not a big shelf, but I've got my little shelf, and I'm satisfied.  So now it's your turn, Steve.



STEVE:  Okay.  Well, I'll happily do that.  And our listeners, if they keep supporting us, then I'll be, you know, super delighted, so.



LEO:  So now it's time to talk about security and all its many guises.  Today we're - actually this is going to be kind of fun.  I'm looking forward to this.  We're going to talk about something Steve did.  Steve is a developer.  I mean, that's really what you are first and foremost.  You're famous for GRC, not only for your commercial product, SpinRite, but for all the little free programs you write.



STEVE:  Oh, Leo, when I can arrange my life so that I can just go hide in a corner and code, I am never happier than then.  You know, it's just...



LEO:  I'm sympathetic.  I feel the same way, really.



STEVE:  Oh, it's just - I love coding.  And, yeah, so...



LEO:  I just never do it, so I'm so rusty it's not worth the energy anymore.  It takes me a week just to figure out what I forgot.



STEVE:  Oh, yeah.



LEO:  You've got to do it all the time.  Do you code every�day?



STEVE:  No.  I wish.  I mean, I really, really wish.  But there are, like, days I'm - at the moment I'm working on implementing a round of sort of internal updates to our eCommerce system.  Sue, my operations gal, had said hey, you know, it'd be nice to be able to search on email domain names, not just email addresses.  And, you know, I had just - I thought, oh, okay.  And she'd asked for that a while ago because, for example, people at IBM want to know if, like, who else at IBM has purchased copies of SpinRite.



LEO:  Oh, interesting, yeah.



STEVE:  And she had no way to do that because I'd written everything, you know, to do specific types of searches that we thought would be useful.  Anyway, so I'm doing a bunch of those.  And I thought, you know, in going back into the code, I saw some things that I had sort of forgotten that I had done that I really liked a lot.  And also someone once asked us, and I had referred to this in an earlier podcast, like, you know, what's the thing I'm most proud about in my eCommerce system, and what's the, you know, were there any sort of anecdotal mistakes I made.  So I thought that would really be a fun thing to talk about since I'm all sort of back into it at the moment.



LEO:  Cool.



STEVE:  But we've got a bunch of feedback stuff I want to cover first.



LEO:  Let's talk about addenda, errata, and anything else you want.



STEVE:  Miscellaneous flotsam and jetsam.



LEO:  Flotsam and jetsam.



STEVE:  Okay.  First of all, one of the more popular things on our Security Now! page is that feedback form down at the bottom of the page.  I think it was Episode 101, so about two months ago I commented to our listeners that, if it were easier for them to just send the email to the same email account that the web form sends it to, that they could, and that it was securitynow@grc.com.  Well, about 24 hours later we began getting spam on that.



LEO:  Really.  Well, that's because spammers listen to the show, I guess.



STEVE:  Well, okay.  I actually think spam comes from a couple sources.  For one thing, Elaine, our fantastic transcriptionist, dutifully transcribed the email address, which of course went onto the web in four different fashions, you know, HTML, TXT, and PDF.  And so maybe it was scraped off of there.  But the other thing we've seen through the years is that we'll get spam, for example, on our corporate accounts, presumably because people get some infections on their machines, and these trojans will suck up all the email addresses in their email client and then start sending spam to those.  So it may have been that securitynow@grc.com ended up being in people's email outboxes and got picked up that way.  Anyway, one way or another, yeah, one way or another it was a disaster.



LEO:  But a feedback form wouldn't be in their email address, so that's something else.



STEVE:  Right, right, no, it was the fact that I told people the direct address.



LEO:  Oh, you gave them an address, okay.



STEVE:  Exactly.  Anyway, so I've had to shut that down.  Anybody who does try to send email there will get a polite bounce message saying, well, we're sorry, but the bots found this account, so we've had to close it.  What I did, what I've decided to do, though, because that Security Now! page has gotten quite long, is I decided to move that feedback form to its own page.  So I just wanted to let people know that there's a new page.  It's actually only linked at the moment from the bottom of the Security Now! page in case people are used to going, digging all the way down to the bottom, scrolling down to the bottom of that long page.  And I've got to do something about that.  That's part of the project I'm on now in sort of fixing a whole bunch of things that have been loose ends on the GRC site is I'm going to reorganize our Security Now! page because it's just, you know, right now it's a huge, long page of 108 individual podcast notes.  So I'm going to do something to fix that.  But GRC.com/feedback.  I know you like the nice, short URLs,�Leo.



LEO:  I'm not the only one.



STEVE:  So in your honor, GRC.com/feedback is a feedback page which replaces the form that used to be at the bottom of the Security Now! page.  And I did something this time different, and that is I added a subject line to the form.  It used to be that there was just sort of a big box where people could write what they wanted to send, and then optionally provide their name, their location, and email address so that we were able to say, hey, you know, Bob in New Brunswick has written to us, has a question and so forth, to allow people to put that stuff in if they wanted to.  But in the email that that form sent me, I had just a sort of a default Security Now! feedback subject line.  Now the user can put that in.  And oh, I tell you, I mean, I've been getting the feedback, and it's so nice to sort of just be able to scan the subject lines and see what people are writing about.  So it's an improved feedback form in addition to being a little more bot-obfuscational.



So I experimented actually with putting reCAPTCHA on there.  And the reCAPTCHA API turns out to be very easy to use if you've got scripting enabled.  But it sort of fights you if you don't have scripting enabled.  And I didn't want to require our users to have scripting enabled.  So I ended up just sort of abandoning reCAPTCHA for the time being.  And it doesn't seem to be a problem with form spam here anyway,�so...



LEO:  No.  As you and I both know, CAPTCHA doesn't [indiscernible].  So it's just a nice - I still use it just because I want people to help write books, type in books.  But it's not, you know, it's not the best way to fight spam.  I like what you've done.



STEVE:  Yeah, I think it's going to be good.  So we'll see how it goes.



LEO:  You've cleverly crafted this so that - because I get a lot of form spam, comment spam.  But if you cleverly craft your form, you don't get that.



STEVE:  Well, yes.  And it's worth mentioning to people what I did.  I don't think that we're going to have any listeners who are going to be spamming me.  But, for example, in the prior form I labeled with text, I used text to label the fields.  And I thought, well, that's a problem.  So now I'm using images to label the fields.  I've reorganized them, and there are some dummies in there, also.  So, for example, it's going to be much less easy, much less automated for something to come along and fill out the form and have it send email to me.  So anyway, so I did a little, I mean, I didn't want to go overboard.  But it's a little, you know, it's a little bot-hostile without making a big deal about it and without being at all user hostile, which I'm really happy about.



LEO:  That's great, yeah.  No, I think that's neat.  In fact, at some point it'd be great to - did you make this stuff up, or was there somewhere you went that documented some ideas about this?



STEVE:  Oh, Leo, it's assembly code.  I just wrote...



LEO:  But you thought about the ideas of moving forms around and fields around and obfuscating and so forth.



STEVE:  Yeah.



LEO:  You should document that at some point.  You don't have to give away your particular secrets, but I think it'd be a good idea to help others do this.



STEVE:  Yeah.  And it is nice to have something that doesn't run the users through the hassle of CAPTCHA, yet still is moderately resistant.  On the other hand, I really do think that this is a function of, as we talked about before, it's a function of the value of cracking the form.  Certainly this is completely crackable, if somebody really wanted to go to the trouble of doing it.



LEO:  Yeah, but they don't do that, right?



STEVE:  Exactly.  Because it's not like I'm giving away Yahoo! email accounts.  That's just, you know, send me your comments sort of thing.  So it's a relatively low-value thing for someone to try to crack.



LEO:  Right, right.



STEVE:  In talking about defragmentation, we talked - it may have been a comment last week, in last week's podcast, where a listener asked what was the free defragging tool that I had mentioned.  I said, well, the one I had mentioned wasn't free.  I had mentioned Vopt at v8, which I really like.  Wait, I think it's at v8.2.  But the one I'm using now is�PerfectDisk.



Well, it turns out that, first of all, I got two things.  Someone calling himself BotSing posted in the GRC newsgroups that there was something that Mark, our old friend Mark Russinovich, had done at Sysinternals, who of course has now been purchased by Microsoft, so it's over on the Microsoft site.  He's got something, a piece of freeware, called PageDefrag.  So if you just put PageDefrag into Google, the first thing that comes up is Microsoft's instance of that.  And it does, for free, does a defrag of the swap file, your registry hive files, event log files, hibernation files.  And basically those things which are in use at the time that you're defragging which would not otherwise be defraggable.  So if you were to use that and any other defragger, for example Vopt, then you sort of get the best of both worlds, even though PerfectDisk, which is really my current favorite, does that as well, and does a bunch of other things also.  Then we got a note...



LEO:  So that doesn't - it doesn't do your whole drive.  It does the key things, though.



STEVE:  It just does those main system files which are  normally not movable while the system is in use because they�are in use.  And so Mark came up with a way to make that happen.



LEO:  That's free.  Microsoft offers that for free.  If you do a search for Microsoft and Sysinternals, you'll find that there's, like, a lot of programs there.



STEVE:  Oh, yeah.  Those are all of the things that Mark has done over...



LEO:  Great stuff, yeah.



STEVE:  ...the years.



LEO:  So I presume it's there as part of that package.



STEVE:  Yup, it is.  And then we had a listener named Donn Edwards, who - I guess he's a longtime defrag fanatic, is the way I - I don't think he would mind me describing him that way.  He is also a listener.  And he made a blog posting whose title was Mr. Hard Drive - meaning me - "Mr.�Hard Drive Uses PerfectDisk."  Which turns out to have been his favorite defragger after extensive defragger analysis.  I'm mentioning this, and we will have a link in our episode notes, because he's got extensive reviews of 20 commercial defraggers and 20 freeware defraggers.



LEO:  Wow.  I didn't know there were that many.



STEVE:  It's unbelievable.  And a little bit of the history here, I sort of browsed around trying to understand, sort of to get an overview so I could explain this to our listeners.  He also was a PerfectDisk follower, that was, with all of his reviews, I mean, like, seriously, 40 defraggers, both commercial and freeware, as I understand it, PerfectDisk was his chosen defragger.  Then he heard me mention Vopt and took a look at Vopt.  And he decided, wow, I like that, too, because Vopt is faster, whereas PerfectDisk is more thorough.  So his solution...



LEO:  He uses both.



STEVE:  ...is to use, exactly, is to use Vopt, like, more frequently to keep things under control, and then PerfectDisk occasionally to do major deep cleaning sort of�defragging.



LEO:  Before we get too much farther, do you really think this is necessary?



STEVE:  No.  I just...



LEO:  Okay.  I've been saying for years defragging is overrated.  There's some people who need it if you're, you know, if you're digitizing video and you have big, large files and you need a lot of space, okay, that have to be read and write very quickly, okay.  Maybe every six months, every quarter you can optimize.  But people do this daily.



STEVE:  Well, I've got to say, Leo, with what Microsoft is doing now with their continual patching, they're patching system files all the time that would normally not be moving.  And so it really does create a much greater level of fragmentation on your drive than in the old days, where you installed the OS, and it just sat there happily.  And of course Microsoft's OSes are getting bigger and bigger and bigger.  I don't know.  For me it feels good to have it defragged.  You know, there have been benchmarks that sort of come out either way, like, yes, it speeds things up; or no, it really doesn't; or you're having to do it, you know, they tell you defragging is more wear and tear than just letting the frags sit where they may.



So I don't know.  I just like it.  I like the idea of pulling things together.  What I normally do is I will do a defrag before I do an image because I like the idea of sort of creating a nice, compact image, even though the images are obviously smart enough to handle fragmentation.  It's like, well, why do I want to make an image of a fragmented drive?  I'd rather make an image of a nicely, all set to go, kind of cleaned out drive.  That's also an opportunity to delete, you know, this huge amount of cookies that tend to accumulate, to delete all the junk out of your temp directories, and just sort of do a little housekeeping before you do a - and then you do a defrag, then you do an image.  So...



LEO:  Okay.



STEVE:  That's my approach.



LEO:  Yeah.



STEVE:  And then, lastly, I found out that our podcast has a lot of reach relative to all the talking we've been doing about multifactor authentication.  It turns out that PayPal felt a huge event from our talking about my original discovery of the PayPal Security Key.  And similarly VeriSign.  Apparently we just drove them right off the charts when we...



LEO:  Sorry.  Sorry.



STEVE:  No, I mean, they're really happy about it.  But, I mean, we came to their attention so much so that they're playing snippets of the podcast mentions of VeriSign in their upper-level management meetings.



LEO:  Really.



STEVE:  Yeah.



LEO:  Wow.



STEVE:  They're interested in somehow using, sort of leveraging the podcast to sort of extend the reach of their VIP Security Key tag thing.   And they're going to sort of put together a deal where, if our listeners will go to their page and sort of fill out a questionnaire, in return they'll make the VeriSign fobs available at a reduced price.



LEO:  Oh, that's great  Now, all they have to do is buy a little advertising, and we could put it network-wide.  I guess I should call them.



STEVE:  Yeah.  Or next time I talk to them, I mean, I want to keep our and my enthusiasm for...



LEO:  Well, it wouldn't run in yours anyway.  You're sold�out.  So it would have to run in other podcasts anyway.��But...



STEVE:  Okay, yeah.  I just wanted - I want to make - I want to keep us, you know, clear in terms of, like, what's being paid for and what's not.  I just think...



LEO:  You know I do, too, yeah.



STEVE:  Yes, yeah.  Anyway, what I found out was...



LEO:  So they purchase no advertising; they're getting this plug absolutely free.  Aren't I happy.



STEVE:  So it turns out that some people who've been writing in have been unhappy that the VeriSign fob is only available to domestic purchasers.  So I asked the gal who I've been talking to over at VeriSign what's the deal with that.  And she said, well, it just - it's only temporary.  It's just that their current fulfillment system only runs in dollars, dollar-denominated transactions, and they just haven't put together everything they need in order to sell these things globally, although the VIP system is running globally.  And, I mean, their infrastructure is ready to go global.



She was down doing some meetings in Brazil.  And what she told me was sort of interesting. She said that it was much - they quickly achieved a lot of traction in Brazil because the consumer protection laws that we have in the states and that we sort of - I actually sort of take them for granted.  For example, we know that if your credit card gets compromised, you have a very low liability.  I think it's $50, and normally even that is waived.  That is, if you challenge charges on your credit card, and you validly charge them and can show that these were not your purchases, they're just taken off your credit card.  Not so in Brazil.  In Brazil you are liable for those charges on your credit card.  So you can imagine that consumers are substantially more leery of eCommerce fraud and really want all the additional protection that they can get.



LEO:  Right, right.



STEVE:  So anyway, good things are happening with VeriSign.  Obviously they're set up to be an OpenID provider.  I had asked the question, is there any way that a smaller guy can also take advantage of that VIP system.  And so that's what we're going to pursue.  And just to sort of - I think it would just be fun to be able to, like, have a page where people could play with their tokens on GRC.  So I'm going to see if I can do that.  And also they want to - they're working to move forward with other avenues like PayPal.  In fact, it turns out that your favorite company, Bank of America, has just added, and just announced a couple days ago, that they will be offering multifactor authentication, no longer just your favorite SiteKey technology, Leo.



LEO:  Yeah, which drives me up the wall, yeah.



STEVE:  I know it does.  But and they've chosen a different form factor.  They're not going to be using a fob.  Apparently you can also do some sort of a credit card form factor, where it's got a little LCD in a window, and a button that you press in a credit card form factor.  I guess they think it's nicer that it kind of goes in your wallet and looks like a credit card.



LEO:  Right.  And apparently will also send you this number via cell phone, which is what's most interesting to me.  They said the card is delayed till next month.  I just got an email.



STEVE:  Oh, okay, cool.



LEO:  That's going to be very interesting, yeah.  I'm glad.  Thank you.  I mean, that's really an improvement.



STEVE:  That's going to be really nice.  And again, that's - the whole cell phone thing is another one of VeriSign's means for doing authentication.  They are planning to come up with something even better, which is a software implementation, a pure software implementation of essentially the crypto that's in the fob, so that it could be installed on cell phones and just be built in at zero cost.  So, I mean, this - I'm just excited about this notion because I think all of this provides a tremendous amount of leverage for the need for secure authentication, which is obviously not going away.  I really believe it's just going to be something we need more and more in the future.



LEO:  Very cool, yeah.  As soon as I get mine, I'll give you a report on it.



STEVE:  Cool.



LEO:  Yeah, yeah.  Do you have any mail that you want to - I guess we're kind of responding to mail right now, aren't we.



STEVE:  Yeah, and I do have a fun SpinRite success story.  Actually the subject was "SpinRite Success Story With a Linux Twist."  I try to find testimonials that are a little bit interesting and different from sort of the, well, SpinRite did it again sort of thing.  This is Matt actually from New Brunswick.  I think that's why I used New Brunswick earlier as an example, it was in my head from finding this one.  Matt from New Brunswick, Canada dropped us an email.  And he said - and the subject was, you know, "...With a Linux Twist."  He said, "I've been a long time Security Now! listener and have heard the numerous reports of SpinRite success from your other listeners.  I recently ran into uncorrectable error hard drive problems on my Linux machine."  He says, "I was more annoyed at the expense of replacing drives than worried about data loss.  Every night at 3:00 a.m. everything's backed up to an external drive, and I've got full monthly backups on DVD-Rs."  He says, parens, "(I'm the paranoid type)."  And he says, "Naturally I turned to SpinRite to fix the errors, knowing that it supports Linux partitions and correctly assuming that it would fix the problems.  The twist is that I found out the SpinRite executable works perfectly under the Win32 Wine emulation program."



LEO:  Oh, that's interesting.  Did you know that?



STEVE:  I think I remembered that during our beta testing, but it's not something I had ever mentioned before.



LEO:  Wow.



STEVE:  And so he said, "I thought I'd share this in case other Linux users are also running into hard drive problems�and are on the fence over buying a non-native Linux�program."



LEO:  So you run it in Linux under Wine.



STEVE:  Exactly.  So when you run SpinRite, the same SpinRite EXE that you normally boot and run, when you run it, it sees that it's being run under Windows or in a Windows clone environment.  It pops up its little graphical dialogue, and that allows you then to tell it to burn or to create for you an ISO image.  Then you use your regular Linux DVD or CD, I'm sorry, CD-R burning software to burn the ISO onto a CD, and that gives you a bootable CD that allows you to then run SpinRite on Linux, needing no Windows�anywhere.



LEO:  So it's not for running SpinRite, it's for running the installer so that you can burn the CD, then you can run it.



STEVE:  Right.  Because SpinRite does not run under any OS.  It brings a little copy of FreeDOS along for its own environment.  But you don't need Windows in order to run SpinRite.  And that was the point that Matt here was making was hey, you know, I ran it completely under native Linux, under Wine, and it allowed me to make my bootable CD.  Or for that matter you can make a bootable floppy, too, which is a lot easier for people who still have floppy drives on their machine.  And I do because I can't - I don't know, not�having a floppy drive just really always makes me�uncomfortable.



LEO:  Right.  Although you're going to be out of luck soon.



STEVE:  I know.



LEO:  I don't think anybody - in fact, I wonder how many machines are sold with floppy drives at all.



STEVE:  Yup, it's certainly endangered at this point.



LEO:  Yeah.  Okey-dokey, let's talk about your eCommerce�system.



STEVE:  Well, it's funny.  When I was getting going, many people said, wait a minute, you're writing an eCommerce�system.



LEO:  You know there's a thousand prepackaged eCommerce systems out there.



STEVE:  Yup.



LEO:  Plenty.



STEVE:  And so first and foremost was, yes.  But, you know, they're not mine.  I mean, I wanted to write one just because I never had before.



LEO:  And I should say it's not just because you don't trust the other ones.  You may not.  But it's also, as you just said, you enjoy programming.  And I think you enjoy learning about the problems that need to be solved to do this.  It's not, well, you reinventing the wheel.



STEVE:  Well, okay.  To be fair, there was some of that.  But we were, you know, being involved in security, I was seeing constant reports of flaws being found in the so-called "shopping cart" systems.  So my question was, how can I trust, I mean, how can I trust and expect my customers to trust some software that I did not write?



The other thing is there are third-party services like Digital River.  And unfortunately Digital River are just horrible people.  I've had bad experiences with them.  They pursued me for years to let them sell SpinRite.  They want to take a huge percentage of the retail sales, like 30�percent they take.  They also - I've had to buy other software through them, and then I start getting spammed by them because I have to give them my email address when I use them to buy somebody else's software.



LEO:  So you're protecting your users, too, really.



STEVE:  Well, exactly.  Exactly.  I don't want my - there's no way that I want to use a third-party to do any of my, you know, to capture my data or have anything to do with order fulfillment because how can I trust what that third party will do?  And I wouldn't be at all misunderstanding of users who said, gee, Steve, we wish you didn't have to bounce us over to this horrible third-party site in order to buy SpinRite.  That just doesn't feel like the right thing.  And then, finally, I wanted it to work my way.  That is, I really dislike this thing that so many eCommerce sites make you do, which is the, quote, "create an account" with them.  You know, it's like, wait a minute.  I'm buying a widget of some random type.  I will never be back here again, I promise you.  Why do I have to create...



LEO:  I know, I hate that.



STEVE:  Agh.



LEO:  I just want to buy this.  Even if I, you know, maybe I am going to be back.  I don't want to create an account.



STEVE:  Yes, that whole notion of, like, needing to go fill out all this paperwork and questionnaire on the web to create an account.  It's like, ugh.  So there are sites that are - that give you the choice.  You can create an account, and they'll, like, hold onto some of your stuff to make it easier if you come back later.  Or they'll allow you to, like, bypass the create-an-account phase.  And I'm always so glad when I'm given that option.  Well, I thought, my system isn't going to have any of that nonsense.  You provide only the information that we need in order to process the purchase transaction and nothing more.  So that's the way I designed it.  Because I was writing it myself, I was able to do this exactly the way I wanted to.  So that was the final reason really for doing this.  And the problem has been also that people have liked my system and have wanted to buy it.��And...



LEO:  That's interesting.



STEVE:  ...it's not for sale.  I mean, I didn't...



LEO:  Then you know you're going to get a spate of requests after this comes out.



STEVE:  Well, yeah.  That's why I'm saying upfront here that it's not for sale.  Because it does some cool things that I have never seen anyone else do.  And I'm going to explain it all and, you know, give them to the world.  So anybody else who wants to write their own eCommerce system to do this is welcome to.  But mine's not for sale because, frankly, I can't charge enough for it to make it worth my while to package it for sale.  I mean, this is not the business I'm in.  I'm in the business of doing these podcasts and developing software, you know, like for individual end-users.  That's really my focus, not for other companies that want to sell stuff.



So anyway, I did, in thinking about how I wanted my system to work, there were a couple very cool things that I came up with.  For example, my system doesn't use or require cookies, and doesn't use or require scripting, and has no messy URLs.  That is, as you're using it, the URL is just sort of a generic, I mean, it looks sort of per-user, but I think it's an eight-character little bit of junk at the end of the normal URL, which actually is just sort of the ID for the page.



The question then is, how am I saving state?  And let's step back a little bit from before we answer this to remember what the model is for so-called Web 2.0, that is, the idea that browsers are no longer just receiving information from people.  You're no longer just putting in a URL which is the address of a page, which the browser then sends you, and you read that, and maybe you click a link and go to some other page.  Now there's much more interaction between the user and the remote server, much more like an application where you're doing things.



But inherent in the browser, sort of the client-server model is the notion that there's a transaction, meaning that you're looking at a page, you do something, maybe you fill out some information and then you submit it.  Well, that all goes back to the server.  But due to the heritage of the way the web works, even when you're sending information back to the server, it's actually in the form of a query because the web was built on browsers querying servers.  That's all they were able to do, really.  So when I fill out a form and submit it, it's actually sent as a query, and I'm waiting for a response.  That's why, you know, users will be so used to seeing in IE the little globe spinning, or the flag waving, or whatever.  Or in new IE, the little sort of blue disk spinning deal.  Or, you know, whatever mechanism the browser has for saying I sent the query on to the Internet, and we're now waiting for the response.



The model is that a connection is created to the server, the query is sent at the beginning of that connection, and then the connection stays open while the browser is waiting for the response, which is the next page.  So there are several ways that, in this model, in this query/response model, that people have come up with for maintaining state, meaning - and by "state" I mean that there's, like, a memory of what you have done before.  Now, the classic means is cookies.  And it's because of the need for maintaining state that Netscape originated the notion of a cookie, the idea being that the server would send back to the browser literally a cookie, which is - well, I don't mean literally.  I guess that's, you know...



LEO:  Here's a chocolate chip cookie.



STEVE:  Chocolate chip or, yeah, or molasses, sugar and molasses or something.  A cookie in this case is just sort of a chunk of text.  It could be English readable, but most often it's some sort of a token that has meaning only to the server.  And that's the point, and the reason it's called a cookie, is it doesn't have to have any meaning to the user.  It's not visible normally to the user.  The idea is that the browser will accept it from the server.  And then any subsequent queries, that is, any subsequent connections and submissions of a query for a next page that the browser gives to the server will automatically include just an echoing back of that cookie.



So the idea is, in an eCommerce model, you go to some page, and you fill out a form.  And then so you've got the form filled out.  You then press the Submit button.  And the form content is sent back to the server as a query.  So what the server's going to do is it's going to look at the form data.  And maybe, you know, often you'll receive it back in response to submitting it, sort of as a, okay, here's what we got from you, check out your information to make sure that it's correct before you commit to buying this.



So now you've got that information.  Well, say that you say yes.  Okay, if you say yes, then the question is, yes to what?  Because you no longer have a form.  You just have a button saying yes.  So the server needs to know who among all the people maybe purchasing things at the same time is saying yes.  So what that requires is that the browser have cookies enabled so that you're able to - when you say yes, the cookie goes back.  The server then looks up what user is associated with that cookie and gets the data in some sort of a temporary database of, like, purchase transactions that are someway along, and then processes it further.



So the point is that you need to have cookies enabled in order for this to work.  Well, as we know, some people just don't like cookies at all.  They've got them turned off.  So rather than that breaking eCommerce, and actually sometimes it will, then scripting has been used in order to provide this same sort of functionality, where you've got some sort of scripting, you know, code running on the page which is involved in providing cookie-like behavior, even though you're not actually using the cookie mechanism in the browser.  But as we also know, scripting is sometimes turned off.  I keep recommending that people not use scripting, although, again, it can be the case that turning scripting off will break things.



So one of the other mechanisms that is used for basically tracking users is what's called "URL munging," where - and this is what we'll often see.  For example, if you go to Amazon, bang, you know, you go to www.amazon.com, what you see almost immediately is some bizarro URL.  I mean, it's got all this junk in it.  And so what's happening is, basically they're saving state in the URL.  That is, all the links on the pages will be relative to that wacky URL so that, when you do something, you're sending back a different URL, even if you're on that page, than somebody else who's looking at the same page.  Because Amazon, after logging you in, is basically giving everybody custom pages for everything they're doing.



Well, I looked at all those mechanisms.  And I said, you know, I don't like any of them.  I don't want to require my users have cookies enabled because I discourage cookies, although actually I think first-party cookies are fine, that is, cookies that you're sending back to the browser that you're visiting, not to some third-party advertising site.  Third-party cookies I see no valid purpose for other than tracking.  First-party cookies are okay.  But if people have them turned off, I don't want that to break my eCommerce system.  I clearly don't want to require people to have scripting because here I am saying to everybody, oh, turn off scripting, it's evil, it's bad, except when you want to buy SpinRite, then you have to turn scripting on.  It's like, no, that won't fly either.  And I really just sort of dislike the whole URL munging problem because you can end up with cached pages in your browser that end up having URLs in it, or you might mark the page and give the link to somebody else, and so they're basically capturing something that was like your cookie in your URL.  So that's a problem, too.



So, and the overarching problem is this notion of the server having to know something about incomplete transactions, meaning when you start to purchase, the way most systems work is they'll create sort of a record or a database entry or something for this not-yet-purchased event while the user moves through the web forms and provides the information that confirms their email address, however many stages this purchasing transaction is.  The user is interacting with the server over time.  And the problem is, what if someone goes a couple stages in and changes their mind?  And they hit their home page, and they disappear.



Well, over on the server, the server's waiting for them to proceed.  It's waiting for them to press the next button, move to the next stage in the purchasing transaction, give them back the cookie or the URL or whatever it is that the server is using in order to deal with it.  So that requires some sort of temporary storage at the server end.  And it requires that you do something about it at some point in the future, that is, you expire it somehow.  You say, well, this got to be an hour old, and we don't think this user's ever going to finish with their sale.  If they happen by some bizarre chance in the next, you know, at some point in the future to press the button, then we're going to say, we're sorry, we don't know who you are anymore because we expired your purchase.  The point is it's just messy to sort of have to have this data sitting there in an incomplete state and then make a determination about when you're going to have it expire.  And most people think, well, okay, how else could you possibly do this?  How could you not require that the server have any storage about this potential purchase as it's moving forward?  Well, I solved the problem.



LEO:  Of course you did.



STEVE:  My system has no storage on the server side.  Instead, what I do I've never seen anyone do before.  But it's worked out really well, and I think it's really neat.  And that is that we'll start, for example, at the first form page.  The user fills out their information and submits it to the server.  So that goes to the server.  The server, because I'm requiring no scripting, the server runs through the data that they've submitted, makes sure that their email address looks like an email address, makes a quick check of their credit card number to make sure that it passes the Mod�9 credit card number check, which we've talked about a long time because it turns out that there's a simple formula you can run on a credit card number that will catch digit transpositions, and basically that's pretty much all it's useful for.  But it does, if you just had a typo in the credit card number, it would catch that.  Basically it's sort of a first pass to make sure that the fields we need to�be filled in are filled in and that the user has, you know, is on their way, as far as we can tell, to a successful transaction.



Okay.  Upon submitting that data - remember that that's a query that goes to the server.  And the browser's little globe is spinning, or whatever that it's doing, saying, okay, we're waiting to hear back from the server in response to our query.  Well, in my case what I ask for is - I want to show them everything they submitted and ask them again for their email address.  Because it's frankly surprising, Leo, I'm sure you've seen all these systems that ask your email address twice.  And it's annoying.  It turns out people really don't give you the same email address twice.  It's unbelievable how necessary it is to ask for it a second time.  And I didn't want to put it on the same page because I know what I do, I type it wrong once, then I cut, copy, and paste.  I mark and copy it and then paste it into the second field because I don't want to have to type it again.  But if it's wrong twice, then it's really wrong.  So I wanted to put it over on the second page.



So I show the user everything that they filled in in the forms, sort of in a confirmation.  And I say, you know, please provide your email address again to confirm.  But that's all I'm asking for is the email address.  So what I do, which really worked out well, is I take essentially a binary image of all their data, of their purchase data.  And I encrypt it using a secret key on the server.  Then I digitally sign it using a cryptographic hash, as we've talked about before, tacking that on the end.  Then I turn it into ASCII so it's all just characters and numbers.  And I send that back to the web browser as a hidden field in the next form the user is going to fill out.



So all I'm asking for on the second page is their email address.  And that would be one field.  But then there's a hidden field which is this ASCII blob which is completely secure because it's encrypted, and it's digitally signed.  Basically what I'm doing is I'm handing back to the user all of the data that would normally be kept temporarily on the server.  And I'm keeping nothing on the server.  I have no record at all that this user has ever done anything because�there's...



LEO:  Do you think that's typical?  Is that how other commerce systems work?



STEVE:  No, I've never seen this done.



LEO:  They're all keeping it on their own site.



STEVE:  Well, yes.  If you turn off scripting, and you turn off cookies, basically they'll just break.  They will tell you you have to have cookies enabled in order to buy something from this site.



LEO:  That's right, yes.



STEVE:  And I'm sure you've probably seen that before.  Because the point is they're relying on cookies, and they're having to maintain the user data in some temporary form at their end.  Well, I just don't like that because, first of all, there's a more clever way to do this, and that is to basically hand back the current state to the user's browser and make it be responsible for sending it back to you as you move to the next step in the process.



Anyway, so that's basically what I do.  And it's worked perfectly.  When they give me their email address, and they press yes, I want to - I'm confirming my purchase, here's my, you know, gosh darn it, here is my email address again.  I'm typing it again for you correctly.  Then what I do is I receive their email address and this blob of data.  I verify the digital signature.  Then I decrypt it back into their purchase record.  So I have not had to store it in the meantime.  Meaning if they unplug their computer, they change their mind, they wander off somewhere, then that's fine because I'm not needing to hold that, wondering what happened to them.  I don't care at all.  If they do go to the next step, then they're providing me with all of the data for their purchase as that next step.  And I just pick it up from there.



Now, I do have some things like a timestamp in what I call the "envelope," which is this binary thing.  And so just for the sake of not purchasing two hours later, because that seems like an unlikely thing to have happen, I will expire the envelope.  If I receive it back, for example, three hours later, it's like, eh, for the sake of making sure we're doing the right thing, I return them a screen saying, hey, this is now three hours old.  This may not be what you intend.  Let's start again.  Sorry for making you do so.



LEO:  But you'll show them what they ordered three hours ago, or...



STEVE:  Yes, exactly.



LEO:  See, I like that.  It gives you the choice.



STEVE:  Yes, exactly.



LEO:  Because a lot of sites just throw it out.  Or they keep it for days, you know.



STEVE:  Yeah.  And what's very cool then is that, from my standpoint, basically I'm using the client-server model, and I'm using the browser to save the state of the purchase as we move forward, never needing to store anything at all on the server.  And just it really has worked out well.



Now, one of the other things that was a bit of a runaround was I'm sure you've seen on many eCommerce sites these warnings on the final purchase confirmation button about only pressing this once and then waiting, or you may be double-charged.  I know I see that all the time.  Well, you�know, this was my system.  I didn't want to have to have�that.



LEO:  It happened to me the other day with Apple's system.  I bought two copies of something.



STEVE:  Yup.  Now, the first thing I did was I said okay, I'm not wanting to admonish my purchasers to only click once.  So I'm going to take responsibility if they double order.  And so from the beginning I had a - I have an intercept page which comes up and basically warns them if it looks to me like they're about to purchase something that they may not be intending to.  So, for example - and I grabbed this off the screen earlier so I could share it with our listeners.  If you, for example, were to get back on your browser a couple times, and then you deliberately tried to purchase the same thing again, you get a screen from me that says "Your card has already been charged," is the title.  "Our records indicate that this credit card was recently used to successfully purchase one or more of the same products from us, less than..." and then I fill in, in this case it says two hours and four minutes ago.  "While we certainly do not wish to discourage the purchase of our products, we absolutely do want to eliminate any inadvertent purchases and unintentional charges to your account.  If some glitch in our system prevented you from receiving web page confirmation of your previous order, please do not proceed.  Instead, check your email for your purchase confirmation receipt and software download instructions.  If you are deliberately purchasing additional copies of our software, we thank you very much for your honest patronage and support of our work.  Please click the Confirm Similar Order button below to proceed with the processing of this additional order.  If this reorder is a mistake, please click the Do Not Repeat Order button below, then choose among our other site locations."



So I deliberately intercepted anybody where I was seeing another purchase come in after, you know, within I think it's two days.  I think within 48 hours I decide, you know, let's make sure they're really intending to do this.  Okay.  Even with that in place, every so often we would get a double order.  And it was, I mean, for the first year it just drove me nuts.  Sue, my operations gal, would say hey, Steve, we double-charged somebody.  And that's like, how can that be happening?  I mean, before I'm accepting a second order I check the database to see whether that credit card has been charged.  But every so often it was happening.



Well, I figured out what was going on finally and ended up fixing it.  And as far as I know, nobody else again on earth has ever done this.  Because it is really hard.  It's really tricky.  It turns out that some people double-click a button that you don't have to double-click.  Just, I mean, a lot of us get into...



LEO:  My mom does that.  She thinks everything on the computer must be double-clicked.



STEVE:  I was just going to say, yes, you often see...



LEO:  And that's not her fault because it's not clear.  Some things are double-click; some things are single-click.  

Which should it be?



STEVE:  Exactly.  And it's very much the case that you'll see sort of, like, neophyte users double-clicking on things.  If I'm watching someone use a computer, and like they double-click the Start button, I think, ugh, no.  But again, it's not clear at all which it should be.  So what was happening was people were double-clicking the final purchase confirmation button.



Now, here's what happens when you do that.  The first time you click, because this isn't a button that requires double-clicking, we send the final purchase confirmation transaction to the server.  The server sees, okay, we're ready to go, we're actually going to perform this purchase.  Now, the server takes the information and sets up a communications connection with the credit card verification company.  It happens that I'm using VeriSign.  I wasn't always using VeriSign.  I was using something called Payflow Pro, and I can't quite remember the company that used to own that.  But Payflow Pro is like the back-end provider.  I have a merchant relationship with them.  And so they're the people who actually perform the credit card processing with the electronic funds transfer system in the U.S.  And so the server, while it's got the connection open to the user, waiting to confirm their purchase, it turns around and opens a connection to our transaction provider and begins processing the credit card.



Now, what would normally happen is we would get a response, yea or nay, from that back-end provider.  And then the GRC server turns around and either says we had a problem processing your card or, congratulations, you just bought yourself a copy of SpinRite.  But if the user clicks again prior to that page coming back to them, what browsers do is drop the current connection and send the query off again.  So they abandoned that open connection they had on which they were waiting for a reply, and they just started up again.  So what would happen would be, this purchase confirmation comes in, and we go, oh, okay, this guy wants to purchase.  Well, what do I do?  I check the database to see whether we charged that card.  But we haven't yet because we're still waiting for the first response to come back from the credit clearinghouse to see whether this card can be charged or not.  So even though I'm looking to see whether there's already a charge, because this double-click happened so quickly and the back-end credit processing is relatively slow, I would look at the database, not see a charge, and launch a second purchase.



LEO:  Okay.



STEVE:  And this is what everybody does.  So the first one would clear.  The second one would come back.  And I would respond to the customer that they had purchased SpinRite successfully, when in fact a double charge snuck in.  And that's why all these sites say make sure you only click this button once.



LEO:  It's intractable.  It's a tough problem to solve.



STEVE:  Well, and I did solve it.



LEO:  Oh.  I guess it's not so intractable.



STEVE:  What I do is, I have what I call "in-flight orders."  That is, I basically - I separated the user-side link from the back end.  So what happens is I'm tracking the orders which are in-flight, meaning from our server to the back-end credit processing server.  And I'm tracking any connections from the client.  So what I ended up - the way I ended up solving the problem is you say that user clicks first of a double-click, and the order is launched.  I then log this in a server data structure saying, okay, we have an in-flight order to the credit processor.  Then the user clicks a second time.  Well, now I can see that we've got an in-flight order already, that is, I'm now looking for anything�pending.



The problem is, and here was the tricky part, is that in the second click I dropped the first connection, the one that initiated the order, and now I'm waiting, I have a new connection to the server, and that's the connection that needs to receive the response.  So what's funky about this is that the query that initiated the order to our server is different from the one that needs to get the response.  And so by separating the relationship between the user's browser and our server, and the set of in-flight orders that may be underway, once I get confirmation back from the credit processing, I then have a list of potential queries.  A user could, for example, click 10 times, bang bang bang bang bang bang bang, and that would set up 10 connections to my server.  Because I'm now checking for duplicate in-flight orders, only one order goes back to VeriSign for credit card approval.  When the response comes back, I don't know for sure which connections are still alive because the browser will only have the most recent one.  So what I do is, I attempt to give all of them the good news or bad news, knowing that all but one will fail.  But that's okay because I want to get the answer back to the user.  And the whole system works, and we've never had another double charge in the last several years.



LEO:  That's very clever.



STEVE:  Yeah.  It ended up really working well.



LEO:  You're doing this all in assembly, right?



STEVE:  Yup.  Although, you know, just because that's who I�am.



LEO:  It's your language.



STEVE:  You could do this in any other language that gave you the kind of control you want.



LEO:  And it gives you an EXE which IIS can run.



STEVE:  Yes.  Well, in fact, that's one of the cool things that I did.  The other thing that I wanted was anytime you're using some third-party processing, you need to somehow separate your program download from, like, the registration, typing in a code kind of thing.  I mean, virtually every time I buy software it's, you know, go download the file, and then we're going to email you your passcode or your registration information or whatever.  Because those things are always separated because you're just not - you're not downloading the code that is, like, already set for the user.



Well, that's one of the things I wanted to achieve with my own eCommerce system, and I did, meaning that when you successfully purchase SpinRite, you are given a download link.  And that link is absolutely unique, and it's already customized for you.  When you click on it, the version of SpinRite you receive knows your name, has your serial number and other data already built into it.  So it is yours, and it's essentially sort of prelicensed for you, which I just really like.  There is no secondary rigmarole about receiving your registration code and needing to fill in some form.  That's all done.



Now, one thing did catch us right off the bat which I never saw coming, and that is, I wanted to give people a link which would be good forever, that is, I want it in their email receipt, which we do send them, here is a link you can use to download SpinRite.  And the idea was there would be a funky-looking cryptographic token embedded in the link that would forever allow them to download SpinRite.  And actually we ended up with a system that allows that.  That's one of the other things I wanted was, for example, if somebody was traveling, they didn't have their copy of SpinRite with them, but they got into trouble, they're like, hey, I need SpinRite.  Well, if they bought it, I wanted them to be able to have access to it.  And so our system will allow anyone who has ever purchased SpinRite, you know, five years after they've purchased it.  There's no expiration.  I mean, it's like we have this relationship with our customer that we want to preserve.



However, something messed me up in the beginning, and that is it turns out there are parallel downloaders, you know, so-called "download accelerators" that not only open multiple connections, which I have no problem with, they also spy on their users and send the URL of anything the user downloads back to the mothership.  And the idea is they  build - they're trying to say, oh, this is value-added because you can go to our website and see the most popular things being downloaded.  What was happening was this link, which was meant to be private and never, ever shared, was being published behind the user's back by their parallel downloader, by their downloader accelerator.  And so a couple very early copies of SpinRite escaped onto the Internet.  And, now, we know - we knew which users had this happen because their names were in the program.  So anybody else who clicked the link got their copy of SpinRite.  Which was not a good thing.



LEO:  Something you want to avoid, yeah.



STEVE:  So what happened is we quickly contacted those people.  We invalidated their licenses, which I already had the facility to do built into...



LEO:  See, you were smart.  You built this all in ahead of time.  The person's name was in there, and their license was�there.



STEVE:  Right.  Right.  Although of course they weren't happy that their copy had gotten loose.  But we said, well, it's not your fault, it's your download accelerator is spying on you and basically reporting to this third party every single thing they downloaded.  I mean, basically their privacy was being violated by this.  So anyway, what I did was I realized, okay, I can't ever allow a download link to be used more than once.  That is to say...



LEO:  Ah, of course, yes.



STEVE:  ...if they're going to be spied on, then they click it, and it downloads.  But in the act of clicking it, it has to expire it right then.  The only way to avoid this.  So I quickly did a rev of our eCommerce system.  And now the links it issues, they are - literally, you can click it once, and it's dead.  Now, you're able to ask for as many of them as you want.  That is, if you want to, you can just refresh the page, and it gives you another one, and then you can click it once.  But nothing you have ever clicked can ever be clicked again.  That is, no URL for downloading SpinRite can ever be used twice.  And I also expire them.  The actual funky-looking URL that I embed in there has a timestamp in it.  So it self-expires, I think it's after, like, 15, maybe 30 seconds.  I mean, I went a little overboard.  But after this experience with our customers being spied on by their own download accelerator, I thought, well, better safe than sorry.  And that was all right at the point that SpinRite 6 was released.  Oh, no, I guess it was SpinRite 5 because we were initially selling SpinRite 5 through the new system.  So it was, like, three years ago, and it completely solved this problem, and we never had that happen again.



LEO:  Interesting.  Interesting.



STEVE:  And then my final little quick story of the thing I messed up on that was, well, I thought it was humorous, but a couple customers didn't.  I had this generic hacker lockout, that is, I thought, you know, no matter what anything else is going on, I want my system to be a little - because it's an eCommerce system we want to take it seriously.  I want it to be intolerant of people screwing around with it, you know, like filling out the form, guessing credit card numbers, you know, finding a stolen credit card number and trying to guess the street address, you know, that kind of thing.  And I recognized that valid users might need - might trip themselves a little bit.  It turns out that people often use the wrong address.  They'll use their home address rather than the billing address, if the home address different than the billing address and so forth.  And since I'm not physically shipping any product, I'm only electronically delivering, I don't do that whole billing address/shipping address thing.  All I want I the billing address because that's what the credit card companies are locking to as part of their, it's called AVS, Address Verification System, in order to reduce credit card�fraud.



So what I decided was I would have some fixed number of transactions with the eCommerce system, that is, those being clicking a button when you've got a form filled out.  For people who were upgrading from an earlier version of SpinRite, they receive an intermediate form where they provide the serial number of their down rev copy of SpinRite, which we then log in order to qualify them for the discounted upgrade price.  Anyway, so that number, we've moved it around a bit.  But I think it's at 12 right now.  So 12 interactions with our system, and then I simply lock them out.  I give them a page and I say - and this was sort of a stern page because I don't expect anybody to hit this by mistake.  It's like, you know, your conduct is incompatible with this eCommerce system's policies or�something.



LEO:  They get spanked.



STEVE:  Exactly.  I do a little bit of a swat.  And so I figure 12, I mean, you have to really try to hit that by mistake.  Okay, but get a load of this, Leo.  I forgot to reset the counter when they successfully purchased SpinRite.



LEO:  Oh, that's not good.  So you're spanking people for buying too many copies.



STEVE:  No, no.  Here's what happened, was they would try to fill out their information.  Maybe they use their home address first, then they'd use their billing address, then there was no more - there wasn't enough headroom on that card, so they would need to use a different card.  So they'd go back, and they'd start again with a different card.  And then anyway, so here they're as exhausted as we are at this point.  And on their final confirmation, they press the button, and it's like, yay, you've successfully purchased SpinRite [trumpeting].  Here's your download link.



LEO:  Whoops.



STEVE:  So we've charged their card, everybody is celebrating, and we're exhausted, and now we won't let them have it.



LEO:  Oh, that's cold.



STEVE:  Because, in fact, not only that, when they try to download it, I insult them by saying, you're a hacker, you know, you're abusing the system.  And now that we've got your $89, you can't have SpinRite.  So anyway, that happened to a couple people.  And I thought, oh...



LEO:  You heard about it very quickly, I'm sure.



STEVE:  I heard about it very quickly.  And it's like, Gibson, I mean, again, it was trivial to fix.  I fixed it immediately, of course.



LEO:  This is what happens.  It's hard to test a system like this.  In...



STEVE:  Yeah.  You have to put it into service, let everybody pound on it, and you quickly learn some lessons.  And I did.



LEO:  I want to say in vitro as opposed to in vivo.



STEVE:  Exactly.



LEO:  Yeah, right.



STEVE:  Exactly.



LEO:  Hey, you've got very nice users, and I'm sure they were very tolerant.



STEVE:  Yeah.  We'd say, oops, sorry about that.  And I quickly went in, I mean, it took me two seconds to change the code so that, upon successfully purchasing a product, I removed them from my hacker tracking queue, and then they're�able to actually download the product that they just�purchased.



LEO:  Cool.  There you go.



STEVE:  And anyway, I haven't been back in the eCommerce system for several years because, knock on wood, after getting those first little glitches out, it's just been performing flawlessly for us.  And it was really - I'm really glad I wrote it.  And again, it's one of the nice things about having my own is that it acts exactly the way I want it to.  I'm not having to beg some third party to add a feature or to fix something, nor are we having to go through a third party to, like, deal with somebody who doesn't recognize what this charge is on their card.  I mean, it's just us, and we're a company that takes responsibility for making sure that everyone we've got and come in contact to ends up being happy.  So...



LEO:  That's great.  That's great, yeah.



STEVE:  I thought our listeners would get a kick out of a�little bit of behind-the-scenes of a real-world eCommerce�system.



LEO:  And now it's working flawlessly.  When's the last time you had a bug you had to go in there and fix?



STEVE:  It's about, as far as I know, well, actually I never have.  It's like SpinRite that hasn't had a byte change ever since SpinRite 6 was launched two and a half years ago.  I haven't - I ought to tell people, the system's name is Bam�Bam.  I've been avoiding saying that all during this podcast, even though that's how I refer to it all the time.



LEO:  Bam Bam.



STEVE:  Bam Bam.  The reason is that our original management system that was written by a gifted programmer, I didn't write it, it was written in FoxPro for DOS.



LEO:  Wow.



STEVE:  20 years ago.  For some reason we called it Dino.  And I don't know why.  But Dino Dinosaur, for some reason.  And so when I was going to be, finally after - this would have been, like, after 16 years, because I think it's about four years ago that I wrote Bam Bam, I needed a name for the new system.  Well, I didn't want it to be Fred or Wilma.  Those weren't very catchy.



LEO:  Pebbles isn't so good.



STEVE:  Pebbles is not that good.  But I thought, hey, wait, what about Pebbles' boyfriend Bam Bam?  I just sort of liked Bam Bam.  So anyway, that's the name of the new system, the replacement for Dino, which believe me, four years ago we were still running FoxPro for DOS in order to manage our stuff.  And so it really was a dinosaur by contemporary measures.  And so anyway, yeah, I've not changed a byte in Bam Bam for, like, four years, ever since those first little glitches got taken care of.



LEO:  That's truly amazing.



STEVE:  Because I love to code.  And I love getting it�right.



LEO:  What fun.  What a fascinating story.  I think this is great.  Someday I would hope, when you're old and gray and you no longer care, you might open source this, at least let people look at the source code.  No.



STEVE:  Yeah.  I think...



LEO:  He's not going to do that.  Doesn't want to get into that, I can tell.



STEVE:  Or maybe make it available on some terms, I don't know.  I mean, the problem is, everybody else will want it to do their own different thing.



LEO:  Well, you just say, I'm not going to support it.  I'm not going to do anything to it.  This is for your educational purposes only.  You know.



STEVE:  You're right.  I can just give it away.



LEO:  Yeah.  Or just leave out something so they can't use�it.



STEVE:  Yeah.  Although - yeah, you're right.  No, I wouldn't do that.  I mean, I guess they - I don't know.  



LEO:  It's not like you're selling it.  And I know that you're not embarrassed, as I would be, at how bad your code is or how bad your commenting.  Do you comment?



STEVE:  No, actually - oh, I comment like crazy.  I mean, it's funny, too, because over the years I've learned how.  It used to be that I would write comments that I was sort of writing because I felt like I should.  But two years later I'd come back, and I'd look at it, and I'd go, okay, what?  What am I trying to say here?  I mean, this doesn't tell me anything.  And so I really - I've been much better later in life in recognizing that I'm not going to understand what this is two years from now.



It's like, I don't know if you're this way, Leo.  But when I need to take something out of the house, I now put it in front of the front door.  I make it so I'm going to fall over this thing.  Otherwise I just won't remember.  I just - I know that I won't remember to do something unless I prevent myself from being able to forget.  Because I'll just be in a different mindset.  And it's about mindset.  And so several years from now I will forget the mindset that I had at the time I was writing this.



And in fact I've had this experience just recently because, as I was saying, I'm back in adding a bunch of features that Sue has asked for in Bam Bam for quite a while.  I'm finally making a lot of her little dreams come true, extra stuff that she's figured out that it would be nice to have Bam Bam do.  And so I've had to - now you can see why I've been avoiding calling it Bam Bam for the last hour.



LEO:  You have to say Bam Bam.



STEVE:  Anyway, so I've had to go back in, it's like, okay, what was I doing here?  Why was I doing this?  It's like, okay.  So, I mean, yes.  Comments are absolutely crucial.  Although I have to say my assembly code looks so different from anybody else's.  In fact, I think I will stick - because I've been talking about this, I'm going to put a screenshot of a chunk of this eCommerce system on the episode notes page.



LEO:  Oh, I'd love that.  I'd love to see that.



STEVE:  So people can see what it looks like.  Because I look at other people's assembly language, and it's this absolutely opaque-looking stream of op codes running down the left-hand edge of the page.  And, I mean, nobody could figure out what this is.  Mine actually looks much more like high-level language.  I use long variable names, long subroutine names.  I mean, it's really, I think, readable.  And anybody who wants to see what readable assembly language looks like, take a look at our episode notes, and I'll put a screenshot of the way I edit.  And I'm still in a DOS box.  I'm using Brief as my editor, in a DOS box...



LEO:  Brief, wow.



STEVE:  ...because I use WordStar keystrokes, believe it or not, for...



LEO:  You could program Briefs to have anything, to do�anything.



STEVE:  Yes.  Super macro-programmable.



LEO:  Now, what assembler do you use?  You use MSM?



STEVE:  I use MASM, yeah.  I use Microsoft's assembler.



LEO:  And do you have - have you written a lot of macros so that you can just code stuff that you do over and over again in a few words?



STEVE:  Not really that much because it's one of the ways that I'm so different from Mark Thompson, for example.  Mark Thompson describes himself as lazy.  And you will never, as long as I live, hear me use that word to describe myself.  I just cringe when I...



LEO:  Well, he uses libraries a lot.  In fact, really, writing code for him is assembling libraries together.



STEVE:  And that's my point is he's got this thing called Emucore, which is this amazing proprietary library of stuff that he's written over the years.  And so all he does now basically is call into his library of functions in order to do stuff.  But I'm just different.  I love to code, so much so that I just - I don't mind writing the same thing over and over and over because every little instance is a little bit different.  And it's just joy for me to write.  But there are some macros that I've got, for example, the way a programmer will zero a register is you XOR it with itself, because it's very efficient.  You could move, like, zero into it, but that ends up taking up more bytes of code than XORing, for example, the EAX register with the EAX register.



LEO:  And you just have to know that.  You just learn that as you use assembler after a while, you just know what works and what...



STEVE:  Yes.  And in fact we've talked about XOR, and we know that an XOR will give you a one if either of the inputs is a one, but not both.  So if you think about it, XORing something with itself always makes it zero, because if it's zero, then the result of it XOR'd with itself is zero.  If it's one, then the result of it XOR'd with itself is still zero.  So it ends up all being zero.  Anyway, my point is that I have a macro called Zero, and that expands to XOR R1 with R1, what the - so for example, in my code, you'll see me say Zero EAX.  Because that's what I'm intending.  So rather than saying XOR EAX, EAX, I say Zero EAX.



LEO:  So that's a macro you've defined, then.



STEVE:  Exactly.  But the beauty of that is it's much easier for me to see, for my mind to get, that my intent here is to zero EAX.



LEO:  It's semantic.



STEVE:  Exactly.



LEO:  It's a code that does what it says it does, or says what it's...



STEVE:  Exactly.  And if I didn't do that, I'd have to see whether I was using the same register both times in an XOR, rather than using it only once and saying the word "zero."  Anyway, I'll stick a screenshot of some of my eCommerce system up on our pages.  I think people would get a kick out of it.  It just doesn't look like assembler.  It's why I'm so comfortable writing this way.



LEO:  Well, I've noticed that, even when I, ages ago, was writing in assembler, that that's where a good macro assembler can really help you.  It can just make it look much more English language like.  That's why I asked you if you used a lot of macros.  So you do.



STEVE:  Yeah.  I use a few, actually.  I use a few, a lot.  But I don't use a lot of macros.  Although MASM has a very  nice feature for allowing you to call the Windows API, and I use that.  And it also has nice conditional instructions.  I'll find a snippet of code that demonstrates all of this stuff and stick it up on the page.



LEO:  Love to see that.  Well, Steve, it's really been fascinating.  I just - I want to thank you for sharing a little bit of insight into how you work, which is so cool, so interesting.  I'm thinking that one of the downsides - I know you love your assembly language, and it's so efficient and so compact.  How big is SpinRite?



STEVE:  SpinRite, because it's got the whole Windows side, it got a lot bigger.  I think it's maybe 97K now.



LEO:  I have images bigger than that.  97K.  But you were about to say it's not portable.



STEVE:  Yes, exactly.  It's not portable.  And that's something that I have - I've regretted a little bit that I'm, well, I'm going to have a problem...



LEO:  Yeah, I was going to say, because you're x86-specific.



STEVE:  Yeah, exactly.  As 64-bit begins to happen more and  more, it's like, agh.  Although, you know, Intel's really good about making sure, and Microsoft is really good about making sure that older code continues working.  So I think I'll be able to stay in 32-bit mode for, you know, at least for a long time.



LEO:  What would going to 64 do?  Would the op codes change?  Would the language change?  Or is it just you have to think in 64-bit registers?



STEVE:  Yes.  You have 64-bit registers.  The op codes do change.  I've seen 64-bit assembler.  I'm trying to remember now what they did.  I think they use R.  So RAX for Register�AX.



LEO:  You'd have to rewrite everything.



STEVE:  That would be - oh, yeah, yeah.  I mean, there's no way I'm source-level compatible.  Of course I never have been.  When I went from 16 to 32, it used to be you had the AX, BX, CX, DX, for example.  Then it's EAX, which is the extended, and then they went to RAX, which is the 64-bit register.  So it's sort of the same architecture, but just everything's a lot bigger.  And I've got to say, though, Leo, I mean, for the stuff I'm doing, I barely need 32 bits.



LEO:  Right.  [Indiscernible], yeah.



STEVE:  Yeah.  Although it is really convenient to use 32�bits.  But, you know, the world moves forward.



LEO:  Well, I wrote some assembler, 8086 assembler, in the good old days.  And then I moved to Mac and was writing 68000 assembler.  And it was, I hate to say this, but it was so much cleaner because you don't have to worry about extended registers.  You don't have to worry about the  memory issues.  And it seems like just such a nice assembly language.  You could learn another assembly language.  It wouldn't be that hard.



STEVE:  Oh, yeah.  Oh, you know, I'm sure I can.  I wanted to correct something I just said, too.  I just checked the exact size of SpinRite.  I was thinking of the DOS kernel portion, not the whole thing.  Because I talked about, you know, with all...



LEO:  You're talking about the actual program SpinRite, which is...



STEVE:  Well, it is only one EXE.  But there's a Windows portion and a DOS portion.



LEO:  Right, right, right.



STEVE:  Anyway, the entire thing is 173K.



LEO:  Damn that Windows.



STEVE:  173.



LEO:  Talk about bloat.  It doubled the sizes.  Come on, Windows, come on.  I still have images bigger than that.  I think my home page on my website, my home page image is bigger than that.



Oh, Steve, you're great.  I love - you know, what's fun is this is - it's a little old-timey, and I'm sure in time it'll seem a little archaic.  But this is really how it got done for so long, and still gets done among the pros.  This is real software kung fu here.



STEVE:  Well, I love it.



LEO:  Yeah.  Steve Gibson, we'll see you again next week for another episode of Security Now!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/








GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#110

DATE:		September 20, 2007

TITLE:		Listener Feedback #24

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-110.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss questions and comments from listeners of previous episodes. They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world 'application notes' for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 110 for September 20, 2007:  Listener Feedback 24.



It's time for Security Now!, everybody's favorite security podcast, in fact the number one tech podcast in all the nation, according to the Podcast Awards.  Congratulations, Steve Gibson.



STEVE GIBSON:  Thanks to our listeners, yes.



LEO:  You're getting your award next week.



STEVE:  Yes, in fact I have a note here for next week's podcast to mention that I'll be picking up the award the following day after that podcast comes out.  And I had a note here to thank our listeners again, so you've given me a perfect opportunity to do so, Leo.



LEO:  We'll just keep thanking them until next year, when you'll win again.



STEVE:  That's my plan, as a matter of fact.



LEO:  So if you're going to be in Ontario, California, on the 28th is it, yeah, of September, go to the Podcast Awards.  They're usually towards the end of the day, so it'll be 5:00, I think.



STEVE:  Yeah, it's between 4:00 and 5:30, they said.  And for what it's worth, the show is open and free to the public for the random walk around the aisles and see what's going on in podcasting land.



LEO:  Yeah, so if you want to learn about how to podcast, this is the place to do it.  Everybody's there.



STEVE:  Yup.



LEO:  So - I didn't mean to scare you.



STEVE:  Agh.



LEO:  It's definitely a great - I will not be there.  I'm going to a different expo the following month, and I have actually commitments on the 27th in Vancouver, so I can't get to Ontario.  But I wish you the best.  I'm sorry I can't be there to applaud you.  But I'll be there in spirit.



STEVE:  Ah, well.  You and I have done it the prior two, that is, the first two of those.



LEO:  Yeah, yeah.  When I won, you were there.  So, well, I think we're both winning for this, so I feel good about it.



STEVE:  Oh, yeah.  This wouldn't be here, this wouldn't be happening, Leo, were it not for you, so...



LEO:  I'll take a little...



STEVE:  That fact never escapes me.



LEO:  I'll take a little credit.



STEVE:  Well, and vice versa, I suppose.



LEO:  Yeah, I think you should take a lot of credit.  So this is a listener feedback episode.  We've got a lot, 13 questions, 12 good ones and one wacky one.



STEVE:  Yeah, the wacky one, we're getting such fun feedback.  I had a hard time literally pulling myself away from my email client this morning when I was going through these.  I just - I did not want to stop reading them.  But we got one that was just so bizarro, I thought, well, it's perfect that it'll be number 13.  So it'll be the wacky 13th�one.



We have a bunch of errata, well, several bits of errata that I wanted to share with everyone.  First of all, I wanted to just do a shout-out, as I think they use the term, to the two little bots on Mars, Spirit and Opportunity.



LEO:  Oh, tell me about this.  I guess I haven't been following it.  What's going on?



STEVE:  Well, they had what was originally planned to be a three-month mission.  They are now both in their 43rd month.



LEO:  Holy cow.



STEVE:  They are still going strong.



LEO:  Oh, I remember these guys, yeah.  They weren't supposed to last very long.



STEVE:  Right.  Spirit and Opportunity were these two bots.  And, I mean, they landed literally 43 months ago, bounced around in their little balloon landing pods, and then unfolded and came to life.  And they've just been doing fantastic science for far longer than anyone expected them to last.  There was a big global dust storm last month which obscured the sun and brought the power levels that they were able to obtain through their solar cells down to a very low level.  And the guys at JPL were worried that that might do them in.  So they put them to sleep into a very, very low power mode, where they stopped doing any science, they just sat there, and they only sort of pinged their radios as little as necessary.



Well, the storm passed, they did have a bunch of sand on their solar panels, but some wind picked up and blew that off.  And they just took off rolling around again.  It's just so cool.  You know, just these two little bots roaming around Mars, just continuing to go far, far longer than they were expected to last.  And, I mean, there are all kinds of�- like there was a long wish list of things that NASA wanted, if they had their dreams, these things would be able to be done.  And the bots are just tackling them one after the other, just sort of cruising around.



LEO:  Yeah.  Well, good for them.



STEVE:  That's just so cool.



LEO:  Good for them.  I'm proud of them.



STEVE:  Yeah.  So I just wanted to give them a little shout-out.  I'll kind of keep my eye on them and let our listeners know if they continue trucking along or if something finally�- I mean, I would think that, if they fell into a hole or something or, you know, got tipped over, that'd be the end of the story.  But they're just - they're doing a great job.



LEO:  That's called over-engineering, and it's the way to go.  I think it's fantastic.  That's really great.



STEVE:  Many, many, many, many, many listeners...



LEO:  Many.



STEVE:  Many commented that the idea that I talked about last week that I had 

come up with for storing the state of eCommerce transactions in a variable that I gave back to the browser each time was something that Microsoft has offered in their ASP.NET suite for a long time.  There was an article in 2002 that I found, just to give it some sort of date reference.  So, and this is called View State.  So I just wanted to acknowledge all of the many, many, many, many, many, many listeners who said, hey, Steve, cool idea, but you didn't invent it.  Well...



LEO:  I don't think you claimed to invent it.



STEVE:  No.



LEO:  It's the idea behind cookies in general.



STEVE:  Well, exactly.  Or behind saving state.  And I just wanted to talk about the solution I found.  Several other people wrote, in fact I have - one of our Q&A guys I have a comment about his approach.  So we'll talk about it a little bit more.  But I just wanted to acknowledge that, yes, I didn't intend to claim that I had invented, it's just, I mean, I invented it for myself.  But it's sort of the nature of the question of what's invention and what's engineering, which is why patents are so questionable, is some things are�just the way you solve the problem if you're schooled in�the art.  Anyway, so I wanted to acknowledge all of those�people.



Also I mentioned when we were talking about the Personal Identity Protection, the PIP program offered by VeriSign through their VeriSign Identity Program, VIP, I talked about�how it was my hope that at some point in the future�the wacky URL that we had right now, like steve.gibson.pip.verisignlabs.com, would be made shorter.  Well, the technical guy at VeriSign listens to the podcast, or at least he does now.  And so he dropped me a note saying, hey, Steve, I wanted to make sure you knew that the OpenID system allows something called "delegation."  And I had originally talked about that when we discussed OpenID.  And the idea was that a user, that is, an end-user who wanted to use OpenID could put on any web page that they control, that is, their own blog page, their own MySpace page or whatever, any page that they have control over, they're able to put a tag on the page such that they refer to their own page as their identity, and then the server pulls that page, looks for the tag, and then uses the contents of the tag as the target for their identity server.  And so the point of that is that, in fact, I could use something like GRC.com to replace that entire long nightmare, steve.gibson.pip.verisignlabs.com.  So I could log onto an OpenID site just using GRC.com.



LEO:  That's the whole idea of OpenID.



STEVE:  Exactly.  And then that site would go to GRC.com,�look for the tag, find buried in the tag steve.gibson.pip.verisignlabs.com, and then go there in�order to start the validation process.



LEO:  Yeah.  That's what I do.  I use Leoville.com as my base OpenID page.



STEVE:  Well...



LEO:  The code [indiscernible] sitting there.  If I had thought of it, I would have mentioned it.  That's kind of the premise of OpenID is, if you have a site, you can do�that. 



STEVE:  Exactly.



LEO:  If you don't have a site, you can't do it.



STEVE:  And then we have a listener in Toronto, or who has returned to Toronto, Michael Walker.  He says he was recently flying back to Toronto from London.  And he wrote, "I thought that you would like to know that while on an Air Canada flight from London, England, back to Toronto, there was an ad for Nerds On Site."



LEO:  Oh, that's neat.



STEVE:  "It was at least a full minute ad on the in-flight television."  And so he says, "Well, on the screen you can see the nerd working on the computer.  But on the computer screen, and very clearly seen, is..." and he puts in parens "(wait for it...) SpinRite."  Way too cool.



LEO:  Ah, that's neat.



STEVE:  So, yeah, I really got a kick out of that.  Apparently the Nerds On Site guys have an ad that runs on Air Canada's in-flight TV.  And they figured, well, what are�we going to put on the screen?  Let's put SpinRite on the screen.



LEO:  Well, they're proud of the fact that they offer a license to SpinRite, so...



STEVE:  Yeah, exactly.



LEO:  So we've got 13 questions.  I suppose we should get started.  Do you have a SpinRite anecdote you'd like to recount, or...



STEVE:  Actually I do.  I found one from a month ago that sort of follows on what we talked about last week.  Remember that last week we had a listener who wrote in saying that he�had used SpinRite in Wine, under Linux, on the Windows�emulating...



LEO:  Oh, yeah, and it worked.



STEVE:  And it worked.  Well, this has been taken to an extreme now by Eric Greve, who wrote on August 21st, he says, "Hi, Steve and Leo.  I've been a SpinRite user for quite a while, and it has saved my bacon more than once.  Whenever I buy a new hard drive I plug it in and let SpinRite have at it.  I seem to be addicted to buying hard drives, so this happens more often than you'd think."



LEO:  That's good, though.  I mean, that's who should have SpinRite.  Anybody who uses a lot of hard drives, that's really where you get your value out of it.



STEVE:  Well, yes.  And in fact, I mean, maybe it's a holdover from the old days when I used to buy hard drives, and the first thing I would do was run SpinRite because back then hard drives were dumb.



LEO:  You had to, yeah.



STEVE:  They didn't have all this brain power that they do now.  Which I think, you know, moderates the need to run SpinRite on a brand new drive...



LEO:  Steve.



STEVE:  ...although I do.



LEO:  This is your business here.



STEVE:  I do.



LEO:  Don't tell them they don't need it.



STEVE:  So he says, "I just bought a new drive again, and I thought I'd try something new.  You see, I've also been experimenting with virtualization using the free VMware server on Linux.  While looking around the options, I saw that I could give full control of a physical hard drive to a virtual machine.  They warn that this is advanced" - ooh, watch out - "and maybe dangerous, since both virtual and real OSes could use the drive at the same time if misconfigured."  He says, "I figured I'd give this a try with SpinRite."  And I love what - he went all the way.  He says, "So I configured a new virtual machine, gave it the SpinRite ISO file..."



LEO:  Oh, there's a good idea.



STEVE:  Isn't that cool?  "...as its CD drive image..."



LEO:  So it's tied in.



STEVE:  "...and full control of the new drive as its sole hard drive..." and, he says in parens, "(the other ones being all in use by the Linux system)..."



LEO:  This means that I could use it on the Mac.



STEVE:  Yes, actually.



LEO:  I like this.



STEVE:  Then he says, "...making sure to turn off all caching and snapshotting."  He says, "I'm happy to report SpinRite worked flawlessly in its own little world as I was using the real system normally."



LEO:  Wow.



STEVE:  "I just wanted to..."



LEO:  That's a great solution.



STEVE:  Isn't that cool?  He said, "I just wanted to let you know about this maybe unusual use, and ask if you knew of any caveats with using this method for testing my drive.  Thanks for the great software and podcast.  Eric from Montreal, Quebec, Canada."  So you're right, Leo, I mean, it does mean that in VMware, and remember that the VMware server is free, that...



LEO:  On PCs.



STEVE:  Exactly, for PCs.  And what about for Linux?



LEO:  No.  Yeah, maybe it is for Linux, yeah.



STEVE:  I would imagine it would be.



LEO:  Not for Mac, unfortunately.



STEVE:  Anyway, you can run SpinRite in a VM.  And the other cool thing about this is...



LEO:  It's a great idea.



STEVE:  ... SpinRite is an assembler, and all it's really doing is data transfer.  I mean, it's not making intensive use of the processor.  Most of the time it sits around doing�nothing.



LEO:  It's the controller, really, that's doing all the�work.



STEVE:  Exactly.  So you're issuing a read or a write.  So that means that it's not going to suck up a lot of your machine if you want to be running SpinRite on a drive that you've given it exclusive access to, sort of in the background.  I mean, it's not something that would slow down your foreground use because SpinRite's not sucking up much of your processor.



LEO:  Yeah.  Is the only call you make to N13?  Is there still an N13?



STEVE:  Yes.



LEO:  Is that what you use?



STEVE:  Yes.  I use the N13 BIOS, which is - and the BIOS is fully emulated by VMware.  In fact, you can sort of see the little BIOS flash screen start up, or splash screen start up when you initiate a virtual machine.  And the other cool thing is that, since this is just DOS, it doesn't need gigabytes of RAM.  In fact, it doesn't even need megabytes of RAM.



LEO:  It needs kilobytes.



STEVE:  Yes.  You could give it 640K, a 640K virtual machine, and it would be just, I mean, it would be absolutely happy running in a 640K virtual machine.  So it wouldn't even take up much of your RAM, I mean, less than an app would.



LEO:  Oh, this is really good.  So I'm going to make - what I'll do is I'll make a VMware virtual machine that's a SpinRite machine.  Obviously you can't distribute it because it's a commercial program.  But I can keep that and use that whenever I need to check a drive.  Just pop the drive in and boom, there I go.  Wow, that's great.



STEVE:  Exactly, give the drive...



LEO:  It has to be full access, yeah, right.



STEVE:  Yup, in order to have full physical direct access to it.  But then, you know, it'll work.



LEO:  Very cool.  Coolness personified, impersonated, I don't know what that is.



STEVE:  Whatever we're talking about.



LEO:  Whatever it is.  All right, let's get to our questions.  I have them in front of me in my hot little hand, 13 good questions for you, Steve.  Are you ready?



STEVE:  Well, 12 good ones and one wacky one, so.



LEO:  You got your thinking cap on?  Starting with Kevin in California, he's asking about why we don't do Security Now! in other audio formats:  I've been listening to Security Now! for about a year.  I was wondering if you were considering making an Ogg Vorbis version of it.  He uses open source software every day, and he's trying to distance himself from proprietary formats like MP3 or WMA.  He points out that Ogg is unpatented, royalty free, delivers superior quality to MP3.  More info and encoders are available at Xiph.org.  Thanks for your time.  I get this question all the time.



STEVE:  And so I wanted to voice it and have you answer it for us.



LEO:  We do, you know, the only podcast - we do two podcasts in multiple formats.  One is TWiT, which for historic reasons - and I deeply regret these, by the way - we do high, medium, and low MP3; we do an AAC version; we do an Ogg version.  And it's a pain in the butt.  It actually adds�- probably doubles the amount of time it takes to produce the podcast.  And I'm frankly thinking of phasing those out.  We also do - now, FLOSS we do in two versions.  One is MP3, and one is Ogg.  And the reason we do Ogg is because many of our listeners on FLOSS Weekly are Linux users.  And they can't use an MP3 player without signing a license, which many of them are not willing to do.  So we do�- and maddog pointed this out.  So we do an Ogg version of it.  I really don't want to - the reason we use MP3 is every player plays it.  Very few players play Ogg.  Almost always you're going to be playing it on your computer.  And it just adds considerably - we're already producing a high and low version, and ad-free versions we produce of this show.  And it's just - it adds considerably to our production costs and time.  So...



STEVE:  That makes total sense, Leo.



LEO:  When I look at the number of downloads for the Ogg versions of other podcasts, it's in the hundreds.  I mean, TWiT, which has something like 150,000 downloads a week, there's hundreds of Ogg downloads.  It's just a lot of work for a very small number of people.



STEVE:  Very little return on the amount of work it would take.  And also, as you said, most of what people are doing I'm sure is not listening to these things on their computer, although certainly some are, but the vast majority of people are using podcasting in the original iPod podcasting mode, where they dock their hardware, and it downloads into the hardware, and all the hardware out there plays MP3s.



LEO:  Right.  So I chose the lingua franca.  Kevin, I understand what you're saying, and you're right.  I would prefer - I'm not a fan of proprietary formats.  And MP3 is technically a proprietary format, although it's in such wide use that it's kind of - that's kind of moot.  I just can't add the extra time.  And I know he's going to say, oh, you can write a script, and you can automatically do it.  In fact, I have scripts to do it.  But then they have to be tagged, and that has to be done by hand, and they have to be uploaded, and we have to find storage for it.  And it's just, I'm sorry, it's just not going to happen.  In fact, I wasn't doing a low-quality version until Steve asked us for a dialup version, and I agree.  Almost all the other podcasts are one version only, MP3 at 64 kilobits.



STEVE:  And so it is the case that all these players that are playing MP3 format, they're sending a little royalty check to the MP3 gods somewhere?



LEO:  Well, the rules are complicated and unknown.  Fraunhofer owns the - and Fraunhofer was acquired, I think by Lucent, and it's very complicated.  They invented it, and they won the rights to it.  And if you make - I can't remember what the rules are.  There's a certain length and blah blah blah, and it goes on and on and on. So it's complicated.  It is encumbered.  It is not a free and open, license-free - I think, for instance, Winamp, for instance, probably pays an MP3 license.  And that's why you see a lot of software that's for audio, I think, doesn't support MP3 directly.  So...



STEVE:  Interesting.



LEO:  Yeah.  It's kind of people act as if it's open, and it's not.  So if you want to read all about it, go to mp3licensing.com.  Thomson now owns the license to it.  You can read all about the cost of it.  And in fact the codec is a buck 25 a unit, or $90,000 one time only for the decoder.  So, but I don't - but I think there are rules about who has to pay for it and so forth.



STEVE:  Interesting.



LEO:  Ultimately we may be forced into a situation where we have to stop using MP3.  You know, the right to distribute MP3-encoded data has another license.  And...



STEVE:  But these are, okay, these must be patents; right?



LEO:  Yes.



STEVE:  And so they're not going to last forever.



LEO:  Right, thank goodness.



STEVE:  So just like the old Lempel-Ziv compression, where, you know, I mean, that's now...



LEO:  That's right,  yeah.



STEVE:  That's now in the public domain.  So it seems to me at some point, probably before this gets any worse, it'll end up being finally free.  And then Linux people will be able to get MP3 files and players and everything.



LEO:  Yeah.  Well, and they can now.  So it's more about purism than it is anything else.



STEVE:  Yeah.



LEO:  And I'm sorry, I just have to be pragmatic.  And I understand, Kevin, I completely understand.  I get this request fairly frequently.  But when I look at the numbers, not that many - truth is, you know, a lot of people talk the talk, but very few walk the walk.  It's very few people who actually download the Ogg versions.



Question 2, an anonymous listener complains, comments, that GRC's redesigned feedback form is not screen reader friendly.  What about that?  Boy, this is complaint central�today.



STEVE:  Well, yes.  I wanted to respond to that because he's right.  But unfortunately he's right by design.  That is to say, when I took the form off the bottom of the Security Now! page and gave it its own location, and just to remind our listeners it's GRC.com/feedback, what I was trying to do was to moderately obscure it from spambots.  We had this problem where that page had attracted some spambots, and it had begun getting spammed just by bots that were filling in the form.  My guess is that nobody deliberately targeted some specific bot at the form.  That is, I don't think a bot was designed or scripted to send me spam.  I wasn't getting that much.  But what must happen is that there are just bots out there, in the same way that search engines are, crawling around the web, looking for forms and going, oh, do I recognize the field names on this form?  If so, they dump their spam in and push the button.  And whoever it is who's reading it gets spammed, which is really annoying.  And this may be a variation on, like, the blogging spambots that put spams on blogs.



So my sense was, okay, I don't think we're a high-value target.  I didn't want to inconvenience our users by requiring them to do a CAPTCHA.  So I figured, I'm going to just sort of make it less obvious that this is an email submission form by moving the labels of the fields from text into images.  You know, not a big, super-secure thing to have done.  But all the spam is gone for now, and it just solved the problem.  And I'm not needing to ask our users to jump through hoops by figuring out, you know, a CAPTCHA every single time they want to submit something.



LEO:  But if they're blind it doesn't - they can't see it with their screen reader.



STEVE:  And that's the problem.  Well, and here's the point.  He says it's not screen reader friendly, and that's precisely the point because to be screen reader friendly would be bot reader friendly.



LEO:  So if you put alt tags in, for instance, which makes it screen reader friendly...



STEVE:  Exactly.



LEO:  But then the bot could read it.



STEVE:  Exactly.  The same things that the screen reader would key on in order to allow it to be friendly to them would make it similarly friendly to bots.  And so, again, if we start getting spam on it, I'll do something else.  But unfortunately I did have to move it away from being screen�reader friendly because I wanted it to be moderately bot hostile.



LEO:  There's always tradeoffs.



STEVE:  Yup.



LEO:  Jim Wilson in Southeast Kentucky - and I'm sorry for our blind listeners, and I know we have quite a few.  Is there any way around that?  Can they send you an email?



STEVE:  They could certainly send us email, and it'll get sent to me.  Or if there's any way for them to look at - I mean, I don't know, to have someone look at the form and tell them what the fields are, then once they know, then everything would work just fine.



LEO:  It doesn't change.



STEVE:  Exactly.  I'm not dynamically scrambling things up.  I'm not changing anything else.



LEO:  Well, tell us what the fields are just for now, so they can jot it down?  Do you have a copy?  Is it GRC.com/securitynow?  No, it's just /feedback; right?



STEVE:  Yeah, yeah.



LEO:  So let me - I'll read them out to you.  I'll be your screen reader.  So if you do it by tabbing, the first tab will be to the subject.  Second tab will be to the body of your message.  Third tab is your name.  Fourth tab is location.  Fifth tab is email.  And then there's a button which you can read which says Send Us Your Thoughts.



STEVE:  Yeah.



LEO:  So subject, body, name, location, and emails.  Make a note of that, and when you go to GRC.com/feedback, you tab once, you go to subject; and you tab twice, the second time is body; name; location; email.  That should work.



STEVE:  Perfect.



LEO:  There you go.  And it doesn't change.  And we're sorry�about that.  There's a reason for it, though.  It's not unconscious.



Jim Wilson in Southeast Kentucky found an eBay CAPTCHA cracker.  It's an add-on for Firefox.  Great.  Great.  I've been a Security Now! listener since around 77, and I just found this Firefox add-on I thought you might find interesting.  It solves eBay's CAPTCHA issue.  It's add-on�4381.



STEVE:  Yup.  I checked it out, and it looks like it's legitimate.  There's a word back from the Mozilla developers, who looked at it and sort of are vouching for it.  They say, yes, you know, it looks to us like this thing works.  And...



LEO:  What does it do?



STEVE:  I just got a kick out of it.  It literally, when you go to log onto eBay, eBay now, along with asking for your eBay userID and password, gives you a CAPTCHA in order to make logging on more difficult.  Well, somebody got annoyed by that...



LEO:  Vladuz.



STEVE:  ... and they created an add-on that recognizes where you are and decodes the CAPTCHA on the fly and automatically fills in the CAPTCHA challenge box.



LEO:  Wow.  If they could do that in XUL, it mustn't be too hard.  In fact, the developer says this is only a proof-of-concept of how insecure eBay's CAPTCHA is.



STEVE:  Yeah, I don't know, maybe eBay is doing something dumb like they're putting an easily de-obfuscated link that actually has the CAPTCHA code in the link.  I mean, I don't know that it's actually reading and doing an OCR number on the image.  There might be some other thing that eBay's doing where looking at the text of the page you're able to determine what the CAPTCHA equivalent text is.  I mean, I didn't look at it that much.  But I just thought that was a real kick that, you know, we've talked about CAPTCHA and cracking, and here's an add-on that just says, oh, I mean, you use Firefox, and it just fills it in for you.



LEO:  I wonder how it works.  That's amazing.  I mean, they must - wow.  I'll have to look at the source code at some point.  Mike Shaver, as you say, from the Mozilla Foundation�- and I know Mike, great guy - says we checked the source code, it's harmless.  Doesn't do anything to you.  eBay may want to fix its CAPTCHA.



Brian Clark in the U.K. had an interesting malicious JPEG question.  He points out that we've talked about how a malformed JPEG can trigger a trojan horse, he says, and that malware would get squished when it's resized or otherwise manipulated.  He says:  Is there any way that in general use, resizing, et cetera, malware could evolve due to the random changing of the contents when resizing, or is it not that sort of compromise?  I'm just wondering if malware or bad effects could come about in this way, or would files have to be purposefully grafted to behave as malware.  Crafted, I think is what he meant, not grafted, to become malware.  You can't - they're not going to evolve.



STEVE:  Exactly.



LEO:  Not a genetic experiment.



STEVE:  I got a bit of a kick out of it because we've had some similar questions in the past where people were worried that something malicious could sort of happen by mistake.



LEO:  Right.



STEVE:  And of course this is also a variation on something we discussed a couple weeks ago about this notion of malicious video uploads.  And we talked about how, for example, in the process of any kind of transcoding from one format to another, or even changing the size of the file in order to make it a fixed bitrate or a fixed physical image size, any of that would just blast any malicious stuff into history.  The same is certainly true with malicious JPEGs.  First of all, remember that JPEGs are only capable of being malicious if there's a known and unpatched vulnerability in the JPEG interpreting code.  And so, I mean, that has been the case in the past.  It was possible briefly to do malicious JPEGs, to craft malicious JPEGs in Windows before that known vulnerability was patched, as it has been.  But even so, it's just like with video, any resizing, reimaging, remunging of the JPEG would lose that because inherently the process would produce a valid JPEG, and none of that code would survive.



Now, the one exception might be if there was explicit tagging in the JPEG that would survive, the so-called metatags where you add extra information.  If that were to persist through the image or reimaging of the JPEG, then you could imagine that, okay, that might not be changed by something that was just changing the resolution or the level of JPEG compression.  So conceivably something could stay.  But he's sort of wondering if it could evolve as a consequence of random changing.  So the point I wanted to make there was that, I mean, okay, we've heard the example of a million monkeys all banging on keys randomly on typewriters, and one of them produces a Shakespearian work.



LEO:  Yeah, but it's an infinite number of monkeys typing for an infinite amount of time.



STEVE:  Yeah, and so you've got to have an infinite amount of patience, too, and read a whole bunch of nonsense before you end up with Shakespeare...



LEO:  A nearly infinite amount of garbage.



STEVE:  Yeah.  So it's virtually impossible that that would happen.  While not being absolutely impossible, it's just not the case that random bit migration would do anything useful.  It would just - in the best case it would crash your system rather than do something malicious.



LEO:  Yeah.  You know, I think - my daughter's taking statistics this year in high school, AP statistics.  I'm so proud of her.  And one of the reasons I encouraged her to do it is because I think that there's a certain amount of - John Paulos calls it "innumeracy."  It's the numeric form of illiteracy.  There's a certain amount of misunderstanding of math and statistics and so forth that goes on.  And I wanted her to understand it better.  And this is an example, which is just because it could happen randomly, you have to understand the vast unlikely, you know, improbability of this.  Highly improbable.



STEVE:  Well, and literally, in a block of code, one bit that is changed will...



LEO:  Breaks it.



STEVE:  Yes, exactly, will break it.  So literally a single bit.  There might be a couple bits in a 4 kbit block of code, or a more reasonable code, size is going to be - 4�kbytes is 64,000 bits.  You might have a couple bits you could change that would not collapse the code.  But most of them absolutely have to be the way they are.



LEO:  Kind of like saying I'm going to put a bunch of carbon, hydrogen, oxygen, and nitrogen molecules in this cocktail shaker and shake it really hard and maybe a monkey will pop out.  It's just not - it's not that likely.  Okay?



STEVE:  A guess.  Yes, you're right.  That's a good example.



LEO:  Dennis Wright in the U.K. - I'm sorry.  I don't want to - I'm not being harsh.  I understand.



STEVE:  I don't mean to be laughing at Brian.



LEO:  We're not laughing at Brian at all.



STEVE:  The monkey coming out of the cocktail shaker, that's a great visual, Leo.



LEO:  Yeah, well, sometimes it takes a good visual to [indiscernible].  It's funny, I really think that this is the kind of thing they should be teaching in schools.  It's kind of critical thinking, especially with numbers, because we get lied to a lot with graphs and polls and statistics.  And the ability to look at that and kind of do some critical thinking and go, that doesn't make sense.



STEVE:  Well, and actually it is a known - it's a known fact that people are not very good about statistics.



LEO:  No.



STEVE:  That is to say, that is, we don't think...



LEO:  It's not intuitive.



STEVE:  Exactly.  We do not have an intuition about probability because it's just not the way we were built.  People, for example, assume that, if you toss a penny in the air - and we'll state that pennies have an even chance of coming up heads or tails, in fact there's a slight bias...



LEO:  But that's due to the weight of the penny, it's not�-�yeah.



STEVE:  Exactly.  So the idea, if you throw a penny up in the air, and you do the heads or tails thing, and like five times in a row it comes up heads, there's this intuitive sense, which is wrong, that we're owed some tails.  Like, oh my god, if we had five...



LEO:  [Indiscernible].



STEVE:  Yeah, exactly.  If we have five heads in a row, then whoa, there's like this built up need for us to have some tails coming up.  But it just isn't the case.  In fact, it's extremely unlikely that you'll get five heads in a row.  But it can happen.  In fact, we know from binaryness that there's a chance of one in 32.  So in fact it's less unlikely than you might think because one in 32 odds is not that bad.



LEO:  No.



STEVE:  It's like three out of a hundred, essentially, it's close to that.  So you're not owed tails just because you got a bunch of heads.  But we sort of tend to think that you�are.



LEO:  We think [indiscernible], yeah.  You hit a hot button, obviously, and I probably shouldn't belabor it.  But I think that it's important.  There's a lot of superstitious thinking that goes on because we just don't get this very well.  And, you know, things like thinking you're going to win the lottery when you have a greater chance of being hit by lightning.  You know, we don't understand that.



STEVE:  And then what of course is annoying is every so often someone does.



LEO:  Well, somebody's always going to win it.  That's right.  But it ain't gonna be you.  Sorry.  The chances are very slim.  It's what built Las Vegas, ladies and gentlemen.



Dennis Wright in the U.K. has been programming web forms, too, something like what you've been doing for your eCommerce.  He says:  I was listening to the fascinating episode on your eCommerce system.  I think I may have beaten you to the session management scheme.



STEVE:  Dennis and the rest of the world, apparently.



LEO:  I don't think - I'll have to listen to it again, but I don't think...



STEVE:  No.



LEO:  ...you claimed that you invented this.



STEVE:  No, I just came up with a solution that worked for�me.



LEO:  Yeah.  Almost all websites use some form of session preservation using cookies.  I mean, that's just kind of common.  Anyway, he says:  As you were talking, I could see where you were heading because I'd been there myself.  I'm an actuary - interesting.  Now, here's a guy who understands statistics.  But he's interested in IT.  Some years ago he created an interactive online retirement modeling system for the place where he worked.  I had the same issues.  You can't assume cookies or JavaScript are available, and you didn't want an overcooked database solution.  So he had the data items, which were few and not needed to be recorded permanently, shuttling back and forth between client and server using the query string and hidden form fields.  Oh, that's a good way to do it.  I skipped the encryption because the whole thing was running under SSL.  No doubt�you'll tell me that was a mistake.  No, that sounds�sensible.



STEVE:  Well, I wanted to put this in here because there were so many people who mentioned the idea that I talked about last week not being unique to me.  Apparently there are books on CGI programming that talk about maintaining state this way, too.  And so...



LEO:  Most programs have to solve this problem.  State is important in a program.



STEVE:  Well, yes.



LEO:  And in a client-server environment you have to figure out a way to do this.



STEVE:  Exactly.  So there's storing cookies, formal standard HTTP web cookies on the browser.  There's various ways you could use variables in JavaScript.  Or you could go with standard straight HTML, which is what I did, and just return the contents in a hidden field in the form in order to pass the state back to the browser, which it then passes back to the server when the user adds some more information to that form and then resubmits it.  And I did want to talk about his comment about not using encryption because it was running under SSL.  And he says no doubt you'll tell me that was a mistake.



Well, what SSL of course did was, for Dennis in this case, was it prevented anyone from sniffing the transaction as it was passing back and forth on the line.  My concern, and the reason I encrypted this blob of data and then signed it and made sure, was that the signing, of course, verified that it had not been altered because essentially I'm taking all of the state of my eCommerce transaction and hanging it, transporting it out of the server off to a client somewhere.  Now, I'm assuming he's on my side, that is, you know, this is his eCommerce transaction, after all.  And he wants it to work out well.  I'm not giving it to some bad person.  On the other hand, I don't know that I can trust this person not to screw around with my server.



So when I hand them back the blob, I don't want them to be able to, A, modify it in any way, not do any sort of like delayed replay.  Replaying the data in the future is something that I also prevent by putting in a transaction count as part of the encrypted data to prevent any kind of a replay attack.  Nor do I want them to be able to decrypt it, see what's going on, and figure out anything they might be able to do with it to mess with GRC or eCommerce or whatever.  So because browsers might be caching those pages, even though I explicitly expire the pages and have "no caching" tags all over the place, it's theoretically possible.  So, and the fact is there's no vulnerable data, other than the users' own data that they have submitted in the form, ever coming back to me because all I'm doing is carrying that through a couple pages.  But, you know, I thought, what the heck, I might as well make sure this thing is locked down.  So aware of the dangers, even though we also have an SSL connection which is enforced through all this, I thought, I just don't want anyone to screw with this.  This is my blob, not their blob.



LEO:  Not your blob.  Hands off my blob.



STEVE:  So I'm going to encrypt my blob, and I'm going to digitally sign it, and I'm going to put serial numbers in it, and I'm going to do everything I can think of so that the blob I give you is your data, but I've made it mine.  And all your browser knows to do is send it back just the way it is.  And then I'm going to take a look at it and make sure that everything about it makes sense before I trust it.  And that's what I do when the data comes back.  I deblobbify it and then look at it, make sure it all makes sense, and then proceed to process that next submission from the user.  And it works.



LEO:  Yeah.  That makes perfect sense.  I mean, I think probably any book you look in is going to talk about some way to do this.  And cookies are obviously the way everybody uses, just because it's there.



STEVE:  Although apparently Microsoft does have this thing that they call State View, which is built into their ASP.NET system, that makes it very easy for programmers to carry state from page to page in a fashion very much like this.



LEO:  But I'm thinking it's cookies; right?  I mean, if you're storing something...



STEVE:  We have to be careful about that word, though, because cookies are sort of a reserved word.  Cookies means a blob stored on the server that's associated with the site.



LEO:  No, on the client, on the client.



STEVE:  I'm sorry, yeah, of course.  Erase that.  Stored on the client that's associated with the site.  So a cookie is a specific thing.  This is not a cookie.  This is an opaque token which is sent back and is part of the page itself.



LEO:  Yeah, okay.  So it's not stored.



STEVE:  Exactly.



LEO:  On the client side.



STEVE:  It is not stored on the client side.  It's on the�page.



LEO:  Right.  If it's stored client-side it's, you know, cookies were created by Netscape, and originally they were called PCSSIs, which is not very catchy.  Client side, what does it stand for, Persistent Client Side State Information.  And so anything stored on the client has state information.  That's a cookie.



STEVE:  Right.



LEO:  But I guess since you're - yours are not persistent.  That's the difference.  It doesn't persist through the�session.



STEVE:  Well, and but there are also non-persistent cookies.



LEO:  Right.



STEVE:  I think what the real difference is that I'm storing it in the page.  So the page that comes back to the user, it's actually in the HTML is this blob which is a field in the form that I'm next asking them to fill out.  And so it just, you know, I'm not having to keep any memory of this on the server at all.  When I'm done with it, I send it all back to the user.  If they want to continue or proceed with the transaction, they click on the button or fill out the form or do whatever, and then all of that state information comes back to me as part of the next stage in the transaction.  So...



LEO:  Right.  It's a session - it's effectively what a session cookie does, which is it's not saved.  It's just for the session.



STEVE:  Well, except that a session cookie is normally a token that does refer to state information saved on the server.  So this session cookie comes back to the server.  Then the server looks up what the - like the bulky session state that that cookie refers to.  Instead, all of that data is what I'm sending back out to the browser, and it all comes back to me.  So I have nothing - so it's not a pointer to data on the server.  It's all the data.



LEO:  Well, I mean, I've used session cookies in programming, and most programming languages support this kind of [indiscernible] you can [indiscernible] me.  Essentially a lot of times it's just, okay - I just pressed a button or something, lost my audio.  Lot of them it's just you're setting a date or a time, and it's programmatic, I mean, it's a hash of something.



STEVE:  Right.



LEO:  That the program did.  It's not like the server's doing a lot of work.



STEVE:  Right.



LEO:  Joe Gajewski of Buffalo, New York is worried he's running on borrowed time.  Steve writes these teasers, by the way.  I just want to give you credit because they're really good.  I love Security Now!, says Joe, and I've been listening since day one.  I heard you say a few times SpinRite's going to work on TiVos.  But I own a Dish Network DVR.  Can I use SpinRite on my Dish hard drive?  He says, you know, it's old, and he knows it's going to fail eventually.  But he hasn't been able to figure out if the Dish drive can be replaced by anybody but the Dish Network.  What makes it so difficult to clone this hard drive?  I'm not concerned with extracting programs, just backing up the drive so, if and when it fails, I can restore it myself.  Oh, interesting.



STEVE:  Well, it's a great question.  I know that DirecTV's DVR is TiVo based.  So DirecTV...



LEO:  Actually, no, they have two.  One is and one isn't.



STEVE:  Oh, okay.  So...



LEO:  They've gone to a company DVR as well.



STEVE:  Okay.  Well, the original ones were.



LEO:  Right.



STEVE:  So the older ones probably are.  And that means that they're Linux based.  I don't know anything about Dish Network's DVR.  But I'm absolutely sure that SpinRite could run safely on the hard drive.



LEO:  You're independent of the file system.  You don't care�what...



STEVE:  Exactly.  Exactly.  In fact, in the PowerPC TiVos, which are the ones I use and the older original ones, the bytes are swapped on the drive so that it just looks like gibberish to SpinRite.  SpinRite just tackles it one sector at a time, you know, as fast as it can, and plows through the drive.  And it's also able to talk to the drive's - the extra ATA or IDE data, you know, the SMART data and all that stuff.  So it's able to extract that from the drive and monitor it while it's doing this work, regardless of how the drive is formatted, or even if it's not formatted at all, like we talked earlier about some guy who bought a new drive and runs SpinRite on it.  Well, he doesn't even have to format the drive to run SpinRite on it.  So it's certainly the case, if you're able to open up your Dish Network DVR and get at the guts inside and pull the drive out and mount it on a regular PC motherboard, you'll be able to run SpinRite with no trouble.



LEO:  Interesting.  You know, I don't know anything about how Dish does it.  I did write a book on the TiVo.  And they're basically standard drives with - at the file system level, at the data level there's encryption and blessing and so forth.  But SpinRite's not going to be a problem, and you should be able to ghost it as long as you use something very low level that's just doing a sector copy of it.



STEVE:  Exactly.  In fact, there are a bunch of Linux command that are very good about doing just pure sector-by-sector copies.



LEO:  In fact, that's what we do on the TiVo before you mess with it.  You use DD to do a dump of the data.  I think that if you want to read more about this, there's good forums on this subject at DealDatabase.com.  It's DealDatabase.com/ forum, and they talk about, mostly about TiVo, but they do talk about the Dish DVR.  It's not as hackable, I know, as the TiVo.  But I'm pretty sure you can make an image backup of it.



STEVE:  Yup.  And in fact DealDatabase is the right place, Leo.  I've done extensive hacking on my TiVos, as you know; and that is, like, where I go.



LEO:  But nothing was as easy to hack as a Series 1.  They've gotten so much - it's just they've messed it up, basically.  Which was their intent.



William Dittmann in Northwest Indiana raises an important point:  I just wanted to tap the brakes a little bit on your talk about VeriSign's PIP system.  The VeriSign system you describe bears an evolutionary resemblance to Passport.  We mentioned this, that's the Microsoft single sign-on.  While I'm sure VeriSign's been diligent in their system, it's still a federated ID system which has the side effect of severely impacting privacy and anonymity concerns.  If you use this system, you're essentially making VeriSign a party to all your web memberships/transactions.  In essence, everything is traceable back to me as an individual.



While this type of solution is very good for solving the problem of proving who I am, the problem for most people on the Internet is more like proving I'm the one that opened this account.  And not related to the guy who opened the other account.  I thin it's important to point out to your listeners that this is actually a concern with these kinds of systems.  It's a privacy issue.  And it concerns me because federated ID systems grow in popularity, and alternatives that may solve the other problem will not be developed.  As I see it, federated ID systems are information brokers' dream come true.  While I know I can create multiple IDs, there's little benefit because an information broker is more capable of managing multiple identities than most people are.  He raises an excellent point which we didn't address, this issue of privacy.



STEVE:  Yes.  And in fact I've got on my notes here in my outline for future episodes, coming up very quickly I'm going to do - we will really talk about this.  I call it "The Dark Side of OpenID" because it's not just VeriSign.  Even OpenID has this issue that is really worth, you know, mentioning and talking about, and that is that what we've been talking about, we're talking about a three-party system where you've got the end user, the site you're wanting to verify yourself to, and then a third party that provides this centralized credential verification service.  I mean, the value of it is that you are able to authenticate yourself with a single site.



The problem is, in this scenario, as we'll remember as we talk about OpenID, you're authenticating with, well, you're going to a site you want to log on to.  Then that site sends your browser to this third party, well, and to use William's word, ID federation site.  And then it gets - so you verify yourself with that site.  Then your browser is sent back to the site you want to authenticate to.  And then that site checks in with the federation server to verify that this all went as your browser says it did.



The point is that that single point of contact is the value of using a system like this, but it's the vulnerability.  Because just as we've talked about, for example, using third-party cookies and web ads, where you're able to be tracked on the Internet, essentially whatever server you use for OpenID, whether it's VeriSign or any other system.  That server knows you because you've established an account and some sort of identity with it.  And it knows every place you log onto using it because it has to have a connection as part of the protocol to the site you're logging onto.



Now, what's very cool is there are solutions to that which we'll be talking about in the future.  There are ways for identity to be verified that don't use this, like, this lovers' triangle, essentially, where everybody has to know everybody else in this three-party system.  There are ways to avoid that.  But OpenID doesn't do it.  So it's something to be conscious of.



LEO:  So what are the other ways?  Now you opened up a whole�new...



STEVE:  Oh, it's very cool stuff, Leo.



LEO:  Let's do another...



STEVE:  Oh, yeah, believe me, it's not something we can talk about now.  There's a category of techniques known as "zero knowledge proofs" where you're able to prove that you know something without giving away any of what it is you know.



LEO:  I remember these going back a ways, actually, there were some systems to do that.  And you know what, our correspondent may be right, William might be right that all the attention on these single sign-on solutions may have eclipsed interest in these zero knowledge solutions.



STEVE:  And as a matter of fact that was one of the things that he said that I did want to point out.  I'm glad you brought us back to it.  I think that was a very salient point he made, and that is that by this growth in popularity of something like OpenID and VeriSign's PIP solution, which it's here, it works, it's easy to get excited about it.  It's very convenient, but recognize that there are some privacy aspects to it that you just need to be aware of.  Again, I'm not saying that it's like, oh, no, this is evil and bad.  It's like just, you know, recognize that that's what's going on.



LEO:  Yeah, yeah.  Boy, somebody's mad at you.  He says you're extremely arrogant, Steve.



STEVE:  I know.



LEO:  I don't even want to read this.



STEVE:  Yeah, it's okay.



LEO:  You're very patient.



STEVE:  I chose it.



LEO:  You did.  This is somebody from North Carolina who does not give their name, and you'll see why:  Steve, why don't you - I'm going to read it in his character.  Why don't you put your eCommerce system up for sale?  There are a lot of people out there who'd kill to have such a secure eCommerce system other than PayPal and Google Checkout.  And not offering it up for sale is extremely arrogant.  I believe that eCommerce is the future, but most eCommerce systems these days are exactly how you described them.  Not everyone has a sophisticated eCommerce system, so they use the next best thing, PayPal.  Heck, I'd tell my friend who runs a pet supply website to use your system and make things much easier on her because she had a really bad security issue with PayPal.  Long story short, she got caught in a PayPal scam.  If more websites used secure eCommerce systems like yours, it'd make things about 3,000 times easier on everybody.  Please excuse my annoyance, but I can't stand it when something far better comes along, and the guy or gal who invented it says, oh, I'm not offering it for sale.  There.  I'm done.  Signed, Anonymous.



STEVE:  Well, I really didn't mean to come across arrogantly.  But it's the case that I have a model for GRC which is working.  I really have an individual end-user orientation.  That is, what I like to do is solve problems for the listeners of our podcast.  And I've got nothing against pet supply stores.  But...



LEO:  Can I answer this for you?



STEVE:  The problem is that, I mean, and I've had other friends who have said, hey, Steve, why don't you just charge $2 for all of your freeware instead of giving it away for free?  And the problem is there are, you know, money is not free.  You pay a price for doing these things.  And there's just - it's not practical to sell freeware for $2.  It doesn't make any sense.  Similarly, on sort of the other side of the scale, it's just not practical for me to sell an eCommerce system.  We would probably sell maybe ten copies, yet it would take me a year to package it and support it and document it and add all the features that other people would�want.



I wrote something that works just perfectly for me, for me, and not as a general purpose solution.  So the fact is it wouldn't work for other people.  For example, I imagine that pet supplies need to be shipped somewhere.  But I don't do taxes on my system because software is a nontaxable transaction, and so I don't have to worry about dealing with collecting tax, worrying about what county people are in.  In California, sales tax differs depending upon what street you live on.  I mean, it's a real nightmare.  So I wrote something specifically for GRC that works perfectly for us.  And I wanted to share the problems I encountered and the solutions I came up with as part of this.  But it would be such a different problem offering a solution for sale than it was just for our own purposes.



LEO:  I'm no Objectivist.  I'm no Randist.  But this letter is a perfect example of what Ayn Rand talks about.  Just because somebody is capable of writing a system like this doesn't mean he owes it to everybody else.  It's not trivial to take Steve's - what you just said, which is it's not trivial to take your system and make it available.  And it changes his whole life.  Suddenly your business is selling an eCommerce system.  And you have to support it.  You have to keep it up to date.  I mean, if you choose not to make that your business, I don't think anybody has any right to expect anything else of you.  So I don't think it's arrogant in the least.  I think in fact it's the opposite.  It's arrogant for anybody to say, well, just because somebody has something or can do it, he has the right to give it to everybody else.



STEVE:  Or the obligation.



LEO:  Or the obligation.  Not right, yes, obligation.  Again, I'm not an Ayn Rand nut.  But that's an example of where Objectivism is absolutely right on.  Write it yourself, folks.  You want something better, do it yourself.



STEVE:  And in the last episode I told you how.



LEO:  Yeah.  It's not like Steve's hiding stuff.  By the way, do recommend you go to GRC.com/securitynow and read the show notes for 109 because he's put some source code on there.  And I just think that's just a work of art.



STEVE:  Oh, thank you.



LEO:  I mean, it's really - one of my favorite books of all time is called "Programmers at Work."  It's I'm sure out of print right now as Microsoft...



STEVE:  It's a great book.  I have a copy.



LEO:  Remember that?



STEVE:  Yup.



LEO:  And one of the things, it talks to all these great, famous programmers, like Gates is in there, Charles Simonyi of Microsoft, just these great programmers.



STEVE:  Wozniak.



LEO:  Wozniak.  And it gives code samples.  And they talk about their craft.  And it's just - it's inspiring to read what these great artists do.  And when I look at your code, it reminds me very much of that.  It's just a work of art.  Programming is wonderful.  If nothing else I think in the last episode you might have inspired some people to turn to programming because it...



STEVE:  Oh, we actually did have some feedback from people who looked at the screenshot of a chunk of code from Bam Bam where I deal with the way I handle encrypting and decrypting the Payflow Pro password, which is what we use as our merchant services for credit card clearing, because I didn't want the password to be sitting in the registry where, if anything ever crawled into the server, it would be able to see that.  So the user can - the actual administrator, you know, me, I put the password in the clear.  The first time the eCommerce system starts up, if it sees that it's in the clear, it encrypts it and then puts it back encrypted, and then it gets it and decrypts it.  So it's just a cool little bit of code.  But we did have a lot of people, I mean, a surprising number who said, wow, I didn't realize that Assembly code could look that way.  I'm going to go take a look at it again.



LEO:  Yeah, yeah.  It's fun writing in - I've written some stuff in Assembler.  It's very satisfying.  Because it's bare metal.  You're right there with the machine.



George in Texas wonders about the security of TOR, The Onion Router.  He says he saw an article on Ars Technica about a security researcher who used five TOR exit nodes to collect logon passwords from unencrypted traffic.  What's the deal?  I thought TOR was safe.  I'm going to add something to this because we've now heard reports of at least one, I think two TOR administrators, one TOR administrator in Germany who was subpoenaed by the German authorities, they took his machine and all the information on that machine.  Of course the authorities had no clue what to do with it.  In fact it was worthless to them.  But it does raise the issue of people can get these individual machines.  Does that compromise�TOR?



STEVE:  Well, and in fact the guy you're talking about in Germany, this was the second time he had been harassed by the government.  And he said, I'm sorry, but I'm no longer going to be able to host an endpoint node on the TOR system because of the problems that it creates.



LEO:  And by the way, the German police got nothing from this.  They're at the wrong point.



STEVE:  Well, so, okay.  So let's explain what's going on�here.  First of all, this rather irresponsible security�researcher, I mean, it's www.derangedsecurity.com.  I consider him a little irresponsible, maybe a lot�irresponsible...



LEO:  That should tell you something, just the name.



STEVE:  Yeah, DEranged Security, because he was running - he runs a bunch of TOR nodes.  And he specifically wrote a packet sniffer to find high-value email logon credentials, that is, username and passwords for, for example, governments and embassies and other high-value targets.  He put these sniffers on five TOR servers, and they collected thousands of email name/logon password combinations.  Then, because he didn't feel that anyone would take this seriously unless a lot of noise was made, he published these things that he had gathered publicly on the basis that, first, nobody would pay attention to this problem otherwise; and that, well, these were all in the clear anyway, traveling around the Internet, so what's the big deal?



Well, the big deal was the U.S. government immediately stomped on him and had his site taken down.  All kinds of people were really upset.  And essentially he published the email logons for a bunch of embassy, government embassy email accounts, and a whole bunch of problems resulted, as you can imagine.  So...



LEO:  But underlying that, did he point up a security issue?



STEVE:  No.  What he did was - and this is valuable.  The reason I wanted to put this question up, first of all, a lot of people picked up on it and wrote to us about this, so I wanted to address it directly.  What TOR does is it anonymizes users of the Internet.  It does not provide end-to-end security, meaning that, for example, SSL, Secure Sockets Layer we've talked about often, it provides end-to-end security, meaning that when I use - when a GRC customer buying SpinRite wants to buy SpinRite, the first thing that happens is an SSL connection is created, securing all of their traffic from their machine to the GRC server and back.  So nothing can be seen.  TOR doesn't provide encryption except between TOR server nodes.  But on the final node, after your traffic is bounced around between TOR servers, where it is encrypted, and the TOR protocol makes it extremely hard to backtrack, once it finally is done bouncing around, playing ping-pong around TOR nodes, the final TOR node decrypts it the last time, essentially takes it out of the final encryption envelope, peels that layer off the onion, so to speak, and the traffic is then emitted or injected onto the Internet in the clear, that is, as�plaintext.



So the mistake that these embassy people were making is they may have believed that all of their traffic was encrypted by using this system, when in fact all that was being done was they were being anonymized, meaning that potentially they could not be backtracked.  On the other hand, their email had their client IP and server name, and everyone knew, anyone who looked at this would know where they were logging onto and what was going on.  And all their email even was in�the clear apparently, the actual content of their email.��So...



LEO:  So he just pointed out how insecure their system was,�really.



STEVE:  Well, he pointed out that people were using TOR for the wrong reason.  They were - and that...



LEO:  Yeah.  They were assuming they were secure.



STEVE:  They were assuming, exactly, that it was providing them absolutely security on the �Net, when in fact all it was really doing, all it was meant to do is to provide anonymity services.  Now, the reason the guy in Germany has gotten into trouble several times is that it was for child pornography that he was arrested.  What happened was that government officials were tracking back the IP of somebody who apparently was pulling child pornography off of a child pornography site.  Well, this child pornography viewing end user was using the TOR system to provide him or her with anonymity for this web surfing that they were doing.  And what happened was the child porn IP was terminating on this TOR endpoint, where it then became encrypted and was then�anonymized.



So somebody on the outside of the TOR system saw that this node was apparently making these child porn queries, when in fact they were being made on behalf of somebody using the TOR system for anonymity.  And you can't blame them in this case for wanting to be anonymous.  I mean, they understood clearly that this is what TOR was used for.  So the authorities went to this endpoint and arrested this guy, unfortunately.  He did nothing wrong except he was running a TOR node endpoint.  And this in fact is the great danger of running TOR node endpoints.  It's actually there's a double-edged sword here.  If you run the endpoint, then people on the �Net will believe that it's your machine which is making these queries of potentially bad stuff, when in fact your machine is making them on behalf of somebody who wants to be anonymous specifically because they want to do things which are in many cases and many countries and locations illegal to do.



The other side of this is that all of the traffic which is coming and going from that endpoint can be scrutinized by anyone running the endpoint.  And in fact something that is useful is that this DEranged Security guy has a list of example exit nodes that can read your traffic.  And so he says nodes named devilhacker and hackershaven; node hosted by an illegal hacker group; major nodes hosted anonymously dedicated to TOR by the same person or organization in Washington, D.C. - each of these are handling five to ten terabytes of data every month; a node hosted by Space Research Institute/Cosmonauts Training Center controlled by the Russian government.



LEO:  Wow.  The Russian government runs a TOR node.



STEVE:  Yeah.  Nodes hosted on several government controlled academies in the U.S., Russia, and around Asia; nodes hosted by criminal identity stealers; nodes hosted by Ministry of Education in Taiwan, you know, run by China; node hosted by major stock exchange company and Fortune 500 financial company; nodes hosted anonymously on dedicated servers for TOR, costing the owner between $100 and $500 every month, meaning presumably they're getting some value in return; nodes hosted by the Chinese government officials; nodes in over 50 countries with unknown owners; and nodes handling over 10 terabytes of data every month. So the point is that, you know...



LEO:  10 terabytes.



STEVE:  Yeah.  People are using TOR to do things anonymously.  But you're using - when the traffic egresses from the TOR network, you don't know who owns the node that it's egressing from, nor do you know what purpose they're using the node for.  So it's worth mentioning that, once your data egresses the TOR system, it is no longer encrypted.  It has been anonymized as the TOR system provides.  But depending upon what you're doing, you may still be giving your identity away.  And people of unknown ambition and goal could be looking at it.



LEO:  I think that's the bottom line, the really most important takeaway from this is that TOR is for anonymity, not encryption.



STEVE:  Yes.



LEO:  Dave Solon in Amish Country, Manheim, PA, has a tip for our listeners.  He says:  Thanks for mentioning the PayPal/eBay security key.  As soon as you did I snapped one up at $5, a great deal.  I've been using it in the past week with no problems.  Today I couldn't get onto eBay.  It kept asking for a key number, I kept pushing the button, kept entering the new numbers.  He tried PayPal, same problem.  PayPal, however, lets you enter two sequential key numbers, and then let me in.  I almost disabled the key but decided to try something at eBay.  I remember you saying you could enter your password, it then prompts you for the key number.  I did that, it prompted me for my key number, I entered it, and voila, I was in.  So I just wanted to mention this experience.  I hope it may help others with the same problem.  Thanks again for your great show.  Love Security Now! and This Week in Tech.  Can I pull a Dvorak and plug k12geek.com/blog?  Yes, you may.



STEVE:  I checked it out, it's a nice little blog, although it's a slow blog, so if too many people who are listening go there.  But it's for K12 interested stuff.



LEO:  Neat.  He must be a teacher.



STEVE:  Yeah.  So relative to PayPal and eBay and the key, it sounds to me - and this is just decoding what he said - as though maybe eBay has some sort of problem with the password/key number concatenation.  Remember that you are able to enter your username, and then in the password field you type your password and immediately add the current six digits showing on your token.  By the way, Leo, I've decided to formally call these "tokens" now.



LEO:  I like the name "token."  That's good.  They're not a�fob...



STEVE:  Not fob...



LEO:  They're not a dongle...



STEVE:  ...dongle and everything else.  They are tokens.  So what may happen is that there's some sort of a parsing problem on the way eBay's servers are handling this.  So I did want to pass this tip on to our listeners, much as Dave had suggested.  If you don't append the six characters to the end of your password, then you will be prompted for it in a next stage.  And as Dave reports, that allowed him to get through and get logged onto eBay.  So just a little tip.  And maybe it's a function of his password.  If his password had some digits on the end of it, I'm just thinking that now, that might be the reason that he had a problem, so...



LEO:  Yeah, yeah.  He might always have to do it that way.



STEVE:  It could confuse eBay.



LEO:  I have never had any trouble with it concatenating.  I don't use it on eBay, though, so I don't know.



STEVE:  Nor have I.  It's worked for me every time I've used�it.



LEO:  Anish in Vestal, New York has a RAID question:  RAID-1 is supposed to protect against catastrophic drive failure.  In the event that a drive fails completely, the other drive is still available as an up-to-date copy.  This is the Striped RAID as opposed to...



STEVE:  Actually that's mirroring.



LEO:  Oh, RAID-1 is mirroring.



STEVE:  Yeah.  RAID-0 is striped...



LEO:  That's what I've got.



STEVE:  ...where you get twice the size.



LEO:  What am I saying.  Mirroring, of course.  What happens if the initial drive failure is a slow, gradual process of an increasing number of unreadable sectors?  Wouldn't these bad sectors also be copied over to the RAID-1 drive, making it unreadable, too?  And what about running SpinRite?  What if it corrected bad sectors on one drive and not the other?  Could that render the RAID configuration useless?



STEVE:  Sort of an interesting question that I hadn't thought about or run into before.  The good news is RAID-1, that is mirroring, will do the right thing.  The idea is you've got a controller, the so-called RAID controller, which will read from both drives.  Normally it's reading different data.  If it's a smart controller, and you make an access, like for some block of sectors, the RAID controller may read the first half of the block from one drive and the second half of the block from the other, so that it's able to give twice, in theory, twice the reading performance.  When you write data, it then writes the same data back to both drives.



But what this means is if in Anish's instance or example, one drive was failing to offer sectors that were being requested.  The RAID controller simply asks for those sectors it could not get from the first drive.  I mean, that's the whole point of having a so-called mirror.  You have a mirror image of the second drive, and it will then pull those sectors from the second drive.  And anything written will still be written together to both drives.  So there is no way for unreadable sectors on one drive to contaminate those sectors on the other.



What we suggest people do when they want to run SpinRite on a RAID is to temporarily take the drives off of the RAID, that is, just remove them from the RAID controller, stick them on the motherboard, normal non-RAID controller, and run SpinRite on each drive individually.  The problem is it doesn't make sense to run SpinRite on the RAID while it's still in a mirroring configuration because, for example, those unreadable sectors would be deliberately obscured by the RAID being a RAID, but it's doing what it wants to do, which is...



LEO:  They'd always be readable.



STEVE:  ...the good data from the other drive, exactly.  So in this case you really - you want to remove that redundancy and that error correction by design from being an intermediary between the drive and SpinRite.  You want to give SpinRite direct access to the drive so it's able to fix things up and also show the drive where it's got problems so that the drive can relocate those bad sectors.



LEO:  So if you corrected that on one of the two RAIDs and then put it back into the RAID array, it wouldn't screw up the RAID array somehow?  It wouldn't....



STEVE:  Correct, because SpinRite will never change the data on the drive.  So it will not break your mirror.



LEO:  Huh.  Interesting.  And you've done this.



STEVE:  Oh, yeah, we've got users doing it all the time.



LEO:  It's just that for some reason it seems counterintuitive to me, like somehow they're just going to - anything that changes that first drive is going to confuse the array.



STEVE:  Ah, because it's not changing the physical sectors.



LEO:  But it might move a sector around; right?



STEVE:  Well, no.  It would - it's sparing it out.  It puts a new good sector in the same location.  So it never does move the data to a different sector number.  It changes the sector underneath the data.



LEO:  Okay.



STEVE:  It's very, very cool the way it works.



LEO:  All right.  I guess that makes sense, yeah.  Dale in Saginaw, Michigan, quite frustrated:  When I went to log in to a major credit card bank today, it insisted I provide the answers to three personal questions.  I get this all the time.  Get this all the time.  It drives me crazy, too.  Is it not enough that sometimes I don't know the answers to any of the questions it offers?  So today, when I finished giving and recording the answers to three of the questions and clicked Continue, I received this reply:  "Please note:  There was a technical problem in our system that prevented our storing the answers to your security questions.  Since we were unable to record them today, we will ask you to select a new set of security questions at another time.  You will not need to remember exactly what you had entered here.  We sincerely apologize for the inconvenience."  I'd change banks.  That's it.



Has anyone ever considered that this whole process is just a continuing escalation?  The more private information we give to all those databases, the harder it will be for us to verify information that someone else doesn't already know or have access to.  Why don't I just give them my FOB number and be done with it?  I don't know what an FOB number is.



STEVE:  I think he's talking about a fob.



LEO:  Oh, my fob number. 



STEVE:  Yeah, he's talking about...



LEO:  Oh, but we've changed the terminology.  It's now a�key.



STEVE:  It's now a token.



LEO:  So I've had this happen, this happens to me anytime the bank just feels like it, just decides, you know, for any apparent reason it'll ask me these questions again.  And I never get them right.



STEVE:  You know, the first thing that occurred to me was, if I got something that said there was a technical problem with our system that prevented our storing the entries, blah blah blah, I would make sure I was not being phished.



LEO:  Oh.



STEVE:  Because, I mean, certainly it's the case, I mean, it could be that something's wrong with their server.  But...



LEO:  We've seen this, you're right, yeah.



STEVE:  It could also be that somebody wanted to get information from you that they might be able to use in the future.  But since they weren't actually talking to the real server, they weren't able to store that information on this credit card banking location.  So, I mean, again, it's certainly the case possibly that there was a technical problem.  But if you get something like this, as a Security Now! listener...



LEO:  That's a red flag.



STEVE:  It is your duty as a Security Now! listener to run through the things you would tend to do to make sure you were not being phished, meaning you might try to go back to that prior page, make sure that you have an SSL connection, verify the certificate, and follow the chain of trust on the certificate back to somebody that makes sense to have signed that certificate, you know, not the Hong Kong Post Office - actually I'm kidding there.



LEO:  That's probably safe.



STEVE:  That actually probably is.  But I would, if I got something like that on a banking site, it would immediately raise a red flag, not just that their database was screwed up and they needed better programmers on their server, but just make sure a little phishing is not going on, and maybe in fact make sure that's really the site that you were on.  But again, certainly I agree with Dale's point, and that is that this kind of nonsense is in fact spreading personal information around, and we know that it's not safe to tell everyone the name of your first pet or your favorite high school teacher or...



LEO:  Although I should point out you don't have to give it the same answer every time.  You just have to keep track of what you've told them.



STEVE:  Exactly.



LEO:  Probably would be prudent not to.  My favorite pet changes every time.



STEVE:  I have a lot of them.



LEO:  But then you have to keep track of it some way.



STEVE:  Oh, and then it's worse than passwords.



LEO:  It's worse than passwords.  Are you ready, Steve Gibson, for the last question?



STEVE:  It's wacky number 13.



LEO:  You know, we should do this every time.



STEVE:  I think so.  We have wacky ones.  I love the idea.



LEO:  Well, we're going to get them now.  This is from an anonymous listener in Arkansas because we don't want to name names:  I've been thinking about this since your TrueCrypt episode.  After I heard that episode I downloaded and installed TrueCrypt.  We recommended it.  It's a free encryption program for Windows.  While going through the process of setting up an encrypted volume, TrueCrypt complained that my standard password wasn't long enough.  Okay.  I complied.  I created a longer password I thought I could remember.  And there's a big word, "thought."



Weeks later I went back and tried to mount the volume I'd created, and I wasn't able to remember the password.  Now, fortunately there wasn't anything of value in that volume.  But it got me thinking, how do I go about securing my digital documents with some kind of securely complex password that I wouldn't be able to forget?  Also, what if I have head trauma and can't remember?  Or worse yet, what if I die and my family needs access to my documents?  Which is a really important question.  Here's what I came up with.  Oh, boy.  A tattoo.



STEVE:  He really wrote this, Leo.  I'm not making this up.



LEO:  Not just any tattoo, my friends, a blacklight tattoo.  My idea is to take one of your generated passwords and have it tattooed on a rarely exposed part of my body with ultraviolet ink.  This would - talk about a private key.  This would allow me to always have my password with me, but it wouldn't be visible in normal light.  I also thought it would be good to split the password up into eight eight-character chunks.  All over his body.  And then he could create passwords out of different chunks.  And all he'd have to remember is, like, wrist, toe, ankle.  And he'd have a good password.



Steve, what are you talking about?  This is a brilliant idea.  He says:  I know it's not good for a spy or someone hiding from the government.  But I'd like to hear what you think for your average Joe that wants to keep his tax return private.  Love the show.  Now, I'm sure it's a little tongue-in-cheek.  But that's an interesting idea.



STEVE:  Okay.



LEO:  Well, the problem is you can't change it...



STEVE:  Can you imagine, you go to the GRC Perfect Passwords page and get one of those 64-character nightmares, and then chop it up into eight eight-character chunks...



LEO:  See, that's what's inspired to me.



STEVE:  And then maybe like an eight-by-eight block.  And then you go to your local tattoo parlor...



LEO:  Yeah.



STEVE:  ...and say, okay, do you have any UV ink?



LEO:  Here's what I want.  Now, you have to trust your tattoo guy.



STEVE:  Oh, you sure do.



[Talking simultaneously]



LEO:  ...you go to eight different tattoo guys.



STEVE:  What kind of a lun- oh, yeah, good point, because you - no, but the problem is the eighth tattoo guy, in order to tattoo you with UV ink, you need to do it under black light.  So he'd be seeing...



LEO:  Well, you keep your pants on.



STEVE:  Ah, that's - no.  Now this is a reason - you're right, Leo - for putting them in different locations.  So you say, okay, now, I want you to tattoo these eight characters on the bottom of my left foot.  And the other guy does it on the bottom of my right foot.  And in my left armpit - I guess you'd have to shave for this...



LEO:  I'm not thinking it's such a bad idea, Steve Gibson, I might just do this.



STEVE:  Quite strange, Leo.



LEO:  Better than getting a Nike swoosh tattooed on your�hip.



STEVE:  Oh, god.  And then when it comes to actually, you know, mount your TrueCrypt volume...



LEO:  Oh, wait, excuse me, I have to take off my pants here.



STEVE:  Depending upon how secure your password is, you might have to completely disrobe in order to get access.



LEO:  And find an ultraviolet light.



STEVE:  Yeah, that's a very good point.



LEO:  Might be easier just to write this down.



STEVE:  Yes.  Anyway, it's an interesting thought.



LEO:  Actually the real problem is it's too permanent.



STEVE:  Well, exactly.  It's very permanent.  That's the other thing that I thought of, you know, very much like a retina scan or an iris print or fingerprint.  It is something that's very permanent.  Also there aren't that many permutations of eight by eight, you know, what is it, eight times seven times six times five times four times three times two is the number of possible sequences of eight chunks.  So if you got knocked on the head or die, first of all you'd have to explain to your attorney, I guess, okay, now if anything happens to me...



LEO:  Look under my - look at the corpse.



STEVE:  Take all my clothes off, shave my armpits, get a black light, and here's the sequence.



LEO:  Oh, and you'd better hope you don't sag.



STEVE:  Right foot, left foot, right pit, left pit, and�then...



LEO:  I don't think so.



STEVE:  ...on from there.  So anyway, I did want to share that because this actually was posted by a listener in�Arkansas.



LEO:  I love it.  I think it's hysterical.  And I'm sure he was tongue-in-cheek when he wrote it.  But it's very funny.



STEVE:  It's definitely an interesting concept.



LEO:  This is why we love our listeners and I look forward to these Q&As.



STEVE:  Why I couldn't stop reading them today, Leo.



LEO:  I love them.  Steve, it's so much fun.  I do thank you�so much for joining us, as always, and talking about security.  And I congratulate you once again on making the very best, the very best tech podcast in the nation.  In the world.  Let's say in the world.



STEVE:  You know, I'm just annoyed that TWiT and MacBreak Weekly and Security Now!, basically a bunch of your podcasts are all in the same category, so we had to fight each other in order to get this.  It's just, you know, I wish there were a different arrangement of podcasts.  But again, I thank our listeners.  They are the ones who made it happen.  And hopefully they'll do it again next year.



LEO:  Okay.  They will.  I'm sure they will.  Yeah, it's great.  Well, we kind of own the category, I would say.



STEVE:  And I'm going to say, Leo, among all of these emails that I'm reading, there are so many people who are saying please, please, please never stop.  Never never ever never stop doing this weekly podcast.  They are loving it.



LEO:  So, life sentence.



STEVE:  Rest assured, listeners, we're enjoying it.  So it's fun for us, too.



LEO:  All right.  Hey, Steve, a great pleasure.  We'll do this again next week.  Thanks for joining us, everybody.  We'll see you next time on Security Now!.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#111

DATE:		September 27, 2007

TITLE:		OpenID Precautions

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-111.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Having several times addressed the value and potential of the open source, open spec., and popular OpenID system, which is rapidly gaining traction as a convenient means for providing "single sign-on" identification on the Internet, this week Steve and Leo examine problems and concerns, both with OpenID and inherent in any centralized identity management solution.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 111 for September 27, 2007:  OpenID Precautions.



This is Security Now! Episode 1-1-1.  That seems like either an ominous or an auspicious number.  I can't quite figure it out.  Maybe Steve Gibson, our security guru, can [indiscernible] with the numbers.



STEVE GIBSON:  Well, we know me with all of the Pretty Perfect Passwords and all that stuff.  I do like alliteration.  So I suppose 1-1-1 is alliterative.



LEO:  And it's binary, what, 16?



STEVE:  And 7.  And 7.  Yeah.  If we ever get to binary�16...



LEO:  That's 65,635 podcasts, ladies and gentlemen.



STEVE:  It'd be podcast 1,111.



LEO:  Oh, that's right, it would be, wouldn't it, yeah.



STEVE:  It could happen.



LEO:  It could happen, if we keep up this torrid pace.



STEVE:  I'll tell you, our listeners want it, so...



LEO:  There you go.



STEVE:  ...what the heck.



LEO:  So today we're going to talk about what we've talked about before, OpenID, but maybe some caveats.



STEVE:  Yes.  I thought long and hard what to call this episode.  And after putting it all together I thought, okay, "precautions" is probably the right word.  So we'll do that.



But I've got a couple errata, little bits I want to get to first.  As I said last week when we sort of covered the issue prematurely, the day after people are listening to this, that is, on Thursday, the day after on Friday I'm receiving, thanks to our listeners, the People's Choice Best Science & Technology Podcast Award.



LEO:  Woohoo!  Woohoo!  Yeah!  All right!



STEVE:  I want to thank everybody again.



LEO:  It's a party, you're a party, yes - okay.  I'm sorry I'm not going to be there.  I'm celebrating now.



STEVE:  That's good.  And...



LEO:  That's really great.  I'll be thinking of you on Friday when you get that award.



STEVE:  Speaking of alliteration, we have John J. Jost, I guess that's how I pronounce his name, JJJ.  He posted in the GRC newsgroup just a little snippet that I thought was kind of fun.  He mentioned that - he said actually ultraviolet, UV tattoos, which was what we discussed last week in our wacky number 13, are visible in ordinary light.  "My son and I were just at a tattoo shop, and he asked about getting one.  The shop owner recommended against getting it in any place that was visible anyway for �job application' reasons.  He said that the tattoo would be dull but still visible."  And so John says, "So I wouldn't recommend getting a tattoo for security purposes."  And then...



LEO:  We need to find an invisible ink tattoo technology.



STEVE:  There you go, exactly.  And then a great friend of mine and past collaborator, Jon Lundell wrote to me.  He and I correspond by email a lot.  Sort of with his tongue in cheek he said, "Regarding tattoos, password revocation could be a literal pain in the butt."



LEO:  And that's all.  That's all you need to say.



STEVE:  Exactly.  Get your butt cheek tattooed, and you do not want password revocation for that.



LEO:  I love it.  Is that it?



STEVE:  Yup.



LEO:  Boy, that was easy.



STEVE:  Well, you and I are on a tight, tight schedule today�because we're doing two, and then you're off to Vancouver, so...



LEO:  Yeah, Amber and I are reunited tomorrow.



STEVE:  Oh, how cool.



LEO:  As this airs, we'll be doing a kind of a mock debate.  I don't know how you can debate the subject of LCD versus plasma, but she's going to take the LCD side, and I'm going to take the plasma side.  And I'm betting Amber, knowing her, was probably a college debate champion.  She's probably going to run me into the ground here, but it'll be fun.  It'll be interesting.



STEVE:  She's probably doing lots of research.



LEO:  Yeah, knowing her.  Anyway, that'll be - if you hear this before 11:30 a.m. Pacific time, and I'll make sure the podcast goes up before then so you have a chance to, tune in at FutureShop.ca.  They're going to webcast it.  And I think a thousand people, they can handle a thousand people.  Past that I don't know if they'll...



STEVE:  Uh-oh.



LEO:  But that'll be fun.  So I'm just going up for the day.  And then I'm coming back on Friday, and then I'm going back up on Monday.  Fortunately it's easy to get to Vancouver, as you know.



STEVE:  So we're squeezing two recordings of podcasts in before your plane leaves in about an hour and 50 minutes.  So our listeners don't have to worry about another 90-minute�podcast.



[Talking simultaneously]



LEO:  Let's see.  You want to talk about SpinRite a little bit here?



STEVE:  Well, I don't want to slow things down because we're on limited time.  Certainly all of our listeners have heard lots of testimonials.  And I'm getting lots of them, which I really appreciate.  Let's skip it this week and get right into our content.



LEO:  Well, we'll just say:  Buy SpinRite.  That's all I need to say.  If you, you know - it's the ultimate disk recovery and maintenance utility.  It's really good.  Maybe next time then I'll talk a little bit about - I had a caller call in the radio show with a question that I think SpinRite was perfect for.  But anyway, we'll talk about that in a�bit.



STEVE:  Okay, cool.



LEO:  Today OpenID is our topic.  Now, we have talked about OpenID a couple of times so far.



STEVE:  Well, we've talked about, yes, about OpenID specifically, about various OpenID services, about VeriSign, about their PIP program which is in beta as an OpenID authentication or so-called identity providing service for OpenID.  And mostly I've been jazzed about the idea that we're beginning to see some sorts of solutions, good solutions, for the problem of authentication, the idea being that the existing model is people are having to create usernames and passwords to identify themselves uniquely from all other users on the Internet for this rapidly proliferating number of websites where people want to be participating in social networks, they want to be adding comments to blogs, they just want to be interactive.  So...



[Talking simultaneously]



LEO:  ...called a single sign-on.  And that maybe is a little bit easier to understand in that context than OpenID, the idea of a single sign-on that applies to all of these�sites.



STEVE:  Right.  Well, what happened was that a recent article that was put up, a blog posting essentially was put up by what is arguably a competitor of OpenID.  There is a commercial service called Credentica that is an industrial-strength, not free, patented eight ways from Sunday, these guys have eight patents that just lock up their technology.  And one of the guys that works there did a blog posting where, I mean, the guy must have gone a lot of Google searching because this is a long posting, full of all the horrors of OpenID.  And OpenID is becoming popular enough that something like this that tends to throw a lot of water on the concept came to a lot of people's attention.  Digg picked it up, and it got well dug.  I've been bombarded with people saying, hey, Steve, did you see this, did you see this?  Yes, I've seen this.



Well, I've since researched every single issue carefully, and I want to address this because so many of our listeners have been specifically concerned about this blog posting.  But moreover, I mean, it certainly does bring up some points that are worthy of discussion, which is why I wanted to title this OpenID Precautions, as opposed to, for example, I don't know, death, end of life, nightmare, I mean, things more extreme.



LEO:  Well, I think it's great that you have a lot of review of these kinds of things from a lot of experts.  I mean, if it's a competitor, especially if it's a commercial competitor, well, you have to take it with a grain of salt.  But hey, let's address these issues.  I mean, I think that is perfectly appropriate.



STEVE:  Exactly.  And there's certainly more than a grain of salt.  I'm going to read from the top of Stefan Brands' posting just to give our listeners some quick sense for his take.  He says, "OpenID was designed as a lightweight solution for �trivial' use cases in identity management.  Its primary goal is to enable Internet surfers to replace self-generated usernames and passwords by a single log-in credential, without needing more than their browser.  Concretely, OpenID aims to enable individuals to post blog comments and log into social networking sites without having to remember multiple passwords.  (Of course local password store utilities already do that.  More on this later.)"



And, he says, "Beyond this, OpenID is pretty much useless.  The reasons for this are many.  OpenID is highly vulnerable to phishing and other attacks, creates insurmountable privacy problems, is not a trust system, suffers from usability problems, and makes it unappealing to become an OpenID consumer.  Many smart people have already elaborated on these problems in various forums.  In the rest of this post I will be quoting from and pointing to their critiques."  Which is what Stefan does.  And he does so effectively because I don't argue with any of the things he said except that they've really been sort of taken out of�context.



So let's step through some of these issues and precautions because certainly our listeners ought to understand what's going on with OpenID, what is the downside of using it, what are the dangers and precautions.  And it's also worth noting that there is some fundamental trouble because not everyone on the Internet is listening to this podcast.  And as we'll see here in a second, it is easy to be, unfortunately, lulled into a false sense of security to believe you're getting more than you really are from OpenID.  And that's really the only problem I have with it.



So first of all we know, just to recap briefly, how the OpenID system works.  In wanting to identify yourself to a website, you give that website your OpenID URL, which is what they literally look like is a dot-separated set of tokens like a URL.  So you say, you know, this is who I am.  You submit that, and the site you're at then sends your browser through this process of redirection that we've talked about before, sort of in the same way that buying something through PayPal redirects your browser over to PayPal, where you authenticate yourself to PayPal, and then you go back to where you were, taking the information that you have paid along with you, and then the site is able to verify and so forth.  Similarly, OpenID, the way this works is the site you want to authenticate to bounces you and your browser over to the place where you have said your OpenID credentials live.  Essentially the idea is you authenticate yourself with this third-party site.  And then, having done so, it bounces you back to the site where you wanted to log in, and everything proceeds from there.



Well, it is probably the case, given that here we are on Episode 111 of Security Now!, that about half of our episodes have been about problems with browser security and scripting and cross-site scripting and all these problems.  It's probably the case that the phrase "web browser security" is an oxymoron.



LEO:  Yeah.  I mean, that's really becoming the number one vector for infection is the web browser.



STEVE:  Because it's so popular, it's the way people view the Internet.  And unfortunately, many of the things we want to use are inherently hard to secure, difficult to secure.  And we know that security is not black and white.  It's all just kind of goo.  And so things that are harder to secure tend to be less secure than things that are easy.  So the browser is an inherent problem.  And unfortunately the power of OpenID is that it uses the browser, which we all have, and the browser experience, which we all have, to perform what it would like to have be a lot of security.  But it's using the browser.  So there we are sort of with this conundrum that it's just difficult to have a browser be�secure.



Now, the perhaps number one complaint people have with OpenID - and that's not just Stefan, but many of the links he provides are people who for whatever reason are upset about OpenID.  I'm sort of glad they're upset because it's certainly not a problem to raise these flags and to work to get the OpenID system bolted down tighter and to spread the news that people need to be concerned about the security of this.  But, for example, everyone talks about phishing attacks, how OpenID is, like, made for phishing attacks.  The reason is this whole browser redirect thing.  We know that phishing attacks are, for example, you get a link in spam email saying, "Click here because Bank of America needs to update your log-on information."  When you click the link, you don't go to Bank of America, you go to a Bank of America clone site which is hoping to trick you into giving them your Bank of America log-on information.



Similarly, there's clearly an inherent vulnerability with this OpenID approach where you are bounced to a third-party site.  If you are bounced to something that looks like your OpenID authenticator, how do you know it really is?  Well, one simple thing, and that is, SSL, secure socket, HTTPS protocol.  We've talked about this over and over and over about how you can avoid the phishing problem by making sure you've got a secure connection, the page is secure, and the credentials for the site match the certificate.  There is no effective way for that to be subverted.  And that one fact is never mentioned in all of these examples and attacks on OpenID from a phishing standpoint because they all know, if we prevent phishing, then there's no way a site can pretend to be something it's not.



LEO:  Furthermore, if SSL is vulnerable, then we're really�in big trouble.  I mean, OpenID is the least of the�problems.



STEVE:  Well, and it's not vulnerable.  And that's the point.  But here's the problem.  The onus is on the user because we know how many people get phishing attacks.  And so, I mean, this is really worth making sure we understand, and that is that, because we're browser based, that's convenient; but it's also a problem because obviously the whole browser experience is not very secure.  So if users did not verify that they were actually giving their credentials, that is, logging in, giving their OpenID verification to their real provider, then it absolutely could be a phishing attack where they went to FreeFlowersRUs.com that said, oh, give us your OpenID.  Well, that could be a malicious site.  And but here's�what...



LEO:  Let me ask how the mechanics would work because the way I use OpenID is - maybe it's more secure, but I have, as we mentioned, an OpenID token on Leoville.com.  So I go to the flowers place, and all I do is give them Leoville.com.



STEVE:  Right.  Except, okay, so you give them Leoville.com. They go to Leoville.com.



LEO:  Oh, they have to spoof my OpenID provider.



STEVE:  Exactly.



LEO:  So they'd send me back a page not SSL encrypted that said, I am VeriSign.  Give me your PIP key.



STEVE:  Exactly.



LEO:  This is why, by the way, the little key thing is great.  Because even if I do get phished, it doesn't - it's only temporary.



STEVE:  Well, that is exactly right, Leo.  And that's a point I was going to bring up later.



LEO:  I'm sorry.  Okay.



STEVE:  No no no, because one-time passwords solve this problem except for that one log-on.  That is, so imagine like a super phishing server that you get sent to.  It knows where you were really going to be sent.  It turns around and sucks down the page from your real OpenID provider...



LEO:  Spoofs it.



STEVE:  ...on the fly, and then, exactly, and then presents it to you so that, I mean, so literally it's able to pretend to be any OpenID provider because it just grabs the page just like your browser would, then turns around and gives it to your browser.  So...



LEO:  So let's say you don't have a token.  So now you've given it your password.  But then you say the onus is on the user to notice that you're not on an HTTPS page.



STEVE:  Correct.  Correct.



LEO:  Well, that is the flaw.  I mean, a lot of users won't notice that.



STEVE:  Yes, it really is a problem.  I mean, and so it is really a precaution that comes along with this is people need to understand that - and I think this is people looking�properly into the future as OpenID gets more traction, as it becomes more valuable, it's protecting not just blogging posting but more and more assets, as will inevitably happen unless the whole OpenID movement collapses.  And at this point there's more than 5,000 web services now using OpenID, giving users the option of using OpenID for their authentication.



So this thing, I mean, the reason there's so much fur flying here is that it is gaining traction.  It's taking off.  It's a valuable thing.  The problem is we need to understand what the limitations are to essentially use it responsibly.  So we've got the fundamental problem of using a web browser and the problem with phishing, which is truly a concern.



Now, there's sort of an overall problem which is not OpenID's fault at all.  It's just it comes along with the problem of identity centralization.  And that is, you're inherently putting a lot of trust in this, well, in the hands of your identity provider.  Essentially, you're concentrating trust in a single point of failure where, if that point failed, it would be much more devastating than creating individual credentials for every site you visit, which is inherently a distributed trust model where, if one password and username got compromised, well, as long as you didn't use it anywhere else, you're not vulnerable beyond that single location.



So there is a problem that's inherent in the benefit.  I mean, we want centralized identity management because that's the power of this approach.  But inherent in that is what happens if that breaks, what happens if it fails, what happens if it gets compromised.  So you want somebody you can trust with strong technology.  Again, I think one-time passwords is really the way to go for this approach.  And I've got a fun surprise in two weeks for people because I've come up with a free one-time password system that we're going to be talking about in two weeks.



But the one-time password solution which you briefly mentioned, it solves the problem because your credential cannot be reused.  That is, if you were intercepted, and you logged on to a spoofed phishing OpenID page, well, it would get your log-on credential once, but it would never be valid again.  So some damage could be done based on where you were logging on.  But it wouldn't be an epidemic of you completely having lost control of your identity, which frankly, if your password and username for logging onto an OpenID server were not really protected, and it did get away from you, then users wouldn't be looking at having their identity lost.  And we know what a problem that's been for people who have been subject, for example, to real world identity theft that, you know, it takes them years to�recover.



LEO:  Isn't it - I guess part of it is right now we're not using it for anything really serious.  I guess it becomes much more serious when we start using OpenID for banking and stuff like that.  But nobody's doing that yet.



STEVE:  Well, and you might argue, too, that maybe we never should.  That is, maybe OpenID needs to sort of be given the proper place in a hierarchy of authentication.  That is, well, okay, it's probably the case that we have a pyramid, that there's a vast number of low-value sites that we authenticate ourselves to, like all the social networking sites and blog postings and all that, and many fewer high-value sites.  I would argue that, if nothing else, it's premature at this point to trust OpenID with logging in there.  And frankly, I'd be very surprised if you see Bank of America with an OpenID log-on unless there's backup verification of some sort to lock this down and prevent abuse.  So I'd be surprised if very high-value solutions were using or even offering OpenID.  I mean, it certainly makes sense as a convenience.  But there is this downside.



Now, another aspect of identity centralization trouble is the problem of identity server becoming unavailable.  If you are trusting an OpenID identity provider that is a constant victim of denial of service attacks, or they've got their own server problems, or their server is overloaded or whatever, suddenly you're unable to log into any of the sites using that identity provider.  Now, the good news is, because the whole system is open and free, nothing says you can't have three or four identity providers, that is, three or four different URLs referring to different providers, and have credentials with each of them.  So that, again, it's easy to have a backup to work around this problem.  This problem is posed as, oh my god, this is a reason why OpenID you can't rely on.  It's like, okay, well, fine, but it's easy to work around that one, at least.



LEO:  All right.



STEVE:  Now, another problem, and this is serious enough that we're going to do a podcast, actually I've got it set up for No. 115, and the title is Third Parties.  I mean, just the whole problem of third-party involvement.  And this is a problem from a privacy standpoint because, if you think about it, that OpenID server knows everywhere you go and log in because you are bounced to it from the site you're logging into.  If it cared to do any sort of aggregation of that information, it's certainly able to do so because your browser's coming from that site and is being sent back to that site.  So it's inherent in the OpenID model that the server you use for providing your identify credentials knows every site that you use it with, wherever you go on the Internet.  Again, maybe that's a concern, maybe not.  I'm sure this varies depending upon the sites that you're going to log into and just sort of individual users' feelings about that kind of privacy issue.  But again, it's something that people need to be aware of is that, again, it's a matter of trusting this identity provider.  You really do want to have trust there.



Now, one interesting problem that had never occurred to me, but I'm glad that I looked through this downside of OpenID posting, and that's the idea of OpenID URL recycling.  Apparently major OpenID providers will make old URLs available after they've expired, after they haven't been used for some length of time, just so that, for example, John Jones, who once created an ID there, if he goes away or changes providers, the site may not want John Jones' log-in to forever be unavailable.  So after some length of time, a site can recycle John Jones' name, making it available to someone else.



The problem is, that's a URL, johnjones.myopenid.org or whatever, which is used to identify not only the new John Jones, but the old one.  So if new John Jones went to a site where old John Jones had a history, maybe all of his photos uploaded or what else, since that's the token which is being used to identify the user, there is a real re-use problem because that site, unless there was some sort of one-time number or an incrementing token or some other means for identifying the account at the OpenID provider other than just that OpenID URL, you'd have a serious problem of confusing the John Joneses, and old John Jones could find new John Jones having access to his Internet assets, where he doesn't want that to be the case.



LEO:  Clarify for me, this is because the OpenID provider�maintained this account even after it was closed or�moribund?



STEVE:  Well, yes.  Say, for example, that we had myopenid.org was an OpenID provider.  And John Jones comes along and creates an account there.  Well, then his identification is johnjones.myopenid.org.  That's the URL that he uses to identify himself to all these different sites on the �Net.  So he then changes OpenID providers and creates an account somewhere else.  Then the original OpenID provider, myopenid.org, sees that this John Jones hasn't logged in or used his identity for a year, say.  I'm just making that up, but for some length of time.  And they decide, oh, let's just cancel that account.  We don't want to store any more information about this.  And in the process, that becomes available again.  Now a new John Jones creates an account; but his URL, johnjones.myopenid.org, is the same as the other guy.



LEO:  So how do OpenID providers handle this right now?  Do�they deprecate the use of that name forever afterwards,�or...



STEVE:  Well, you would like no one to ever be able to use the same account again.



LEO:  I think they need to do that.



STEVE:  Yes, exactly.  I mean, it really does represent a problem.  And the final real issue, well, it's sort of another one of these, is that OpenID users would like sites to require nothing but their OpenID.  That is, you know, you go to a site that says, oh, you can log in with OpenID.  So you put in your OpenID, you'd like it to just be bang, you're done. People are complaining that they're still having to give an email address, and then have an email address loop where they're having to deal with CAPTCHAs and the traditional things.



Well, the problem is, OpenID does not by itself solve the bot problem.  So OpenID solves the I'm asserting this is who I am when I'm here and when I come back.  But you still have to deal with the problem that bots can certainly have OpenIDs.  Nothing prevents them from doing that.  So the same things that are in place now using email loops where you give them an email address, they send you a link that you have to click on in order to verify that you own that email address and authenticate yourself, or CAPTCHAs that we've talked about so much.  These things are still necessary, at least initially, to establish a new OpenID at a given site where you visited, which annoys people because they thought that's - they thought incorrectly that that's what OpenID was going to solve.  They were going to eliminate all of that.  In fact, it doesn't.  It eliminates the notion of needing individual, decentralized authentication with individual usernames and passwords.  It does not eliminate the problem of verifying that you're human as opposed to being a bot.



LEO:  Right, right.  Well, these are, I mean, on the face of it these are obvious flaws.  There's nothing surprising here.  He's not saying the underlying technology is somehow flawed.  These are just potential, I guess almost implementation issues.



STEVE:  Well, it's why I think the proper name for this episode is OpenID Precautions.  You know, they're issues that OpenID users should be aware of.  I regard this whole technology as still immature.  It's got a ways to go.  The OpenID spec has been moving through versions.  There's a 2.0 on the way.  It's been through several 1.x versions.  I think there's clearly a place for it.  But like everything else in security and the technology of the Internet, we want to make sure that it's understood, that is, that the things it offers are understood, and the limitations and vulnerabilities are understood.  And certainly it's the case that unaware users could be bitten by this simply because, due to the fact that it is web-centric, there are too many ways to fool people who are using browsers on the web.  And OpenID, again, because it uses this technology, it's potentially prone to be a victim.



LEO:  I'm sure you'll put a link to the Credentica blog posting on your show notes.



STEVE:  Yes.  In fact, I've got a whole series of links of this stuff for people who are curious to perform some further research.



LEO:  So GRC.com is the place to go for Steve's website, and that's where you'll find the show notes.  That's where you'll find links to a 16KB version, all the links that we talked about, and transcripts, too, so you can kind of read along.  And a lot of times I think we get so meaty on these that it's useful to have a transcript to get the - to tease the details out.



STEVE:  Oh, yeah, a lot of people really rely on the transcript in order to kind of go over it at their own�speed.



LEO:  Absolutely.  So all of that is available at Security Now!'s website, GRC.com/securitynow.  By the way, Steve also at that site has, I don't know, more than a dozen free security utilities, including the world-famous ShieldsUP! to test your firewall.  It's just a really useful site that you ought to know about.  GRC.com.  And of course that's where you'll find SpinRite.  He doesn't want to talk about it, but I'm going to do it anyway.  It's the world's finest disk recovery and maintenance utility.  If you're not using SpinRite, you're missing out.  Nerds, by the way, also get a SpinRite license, which is kind of nice.  GRC.com.  So next week, Steve, we've got a Q&A section and lots of great questions.  If people want to add their questions to the mix, how do they do that?



STEVE:  They can just go to GRC.com/feedback, and that gives them a form where they can submit questions that come directly to me.



LEO:  Good.  Well, thanks for this update on OpenID.  I'm still going to use it, but I'm going to make sure that I pay attention that, you know, SSL is turned on when I enter my password.  But you should do that anywhere you enter your password, I guess.



STEVE:  Absolutely, that's a habit you want.  And really, if you do that, all of this other stuff is - it just falls away.  That really is the only real problem is, I mean, the major problem is phishing.  And the rest are just sort of, well, that we talked about are inherent aspects of the benefit of concentrating your authentication with a single provider.  I would just say you want to choose that provider�well.



LEO:  Well, and that's the balance.  Again, convenience versus security.  Sure, the best thing would be to have a 64-byte, completely random numbers, letters, and punctuation password for every site you visit.  I'm sorry, ain't gonna do that.  And for most people the alternative is far less secure.  They use one password for all sites, one easy-to-remember password for all sites.  And I don't think anybody would deny that that is a bad idea.  All right.  We're going to wrap this thing up.  Thank you, Steve.  We'll see you next week on Security Now!.







Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/








GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#112

DATE:		October 4, 2007

TITLE:		Listener Feedback #25

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-112.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is�TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL�Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 112 for October 4, 2007:  Your questions, Steve's answers #25.



It's time for Security Now!, everybody's favorite security�podcast, now officially the best security podcast of the year...



STEVE GIBSON:  [Trumpeting]



LEO:  Thanks to the folks at the Podcast Expo and the - I don't know, who does the voting?  Is it...



STEVE:  Well, thanks to our listeners, Leo.



LEO:  Oh, you're right, the voters are you, the listeners.



STEVE:  Yeah.



LEO:  And we only asked once.  Which I'm very proud of.



STEVE:  Very cool.  Very cool.



LEO:  We did very well considering we only asked you to vote once.  So you're officially now the best technology and science podcast in 2007; is that right?



STEVE:  I think that's the case.  And...



LEO:  And I think you get some little doohickey and...



STEVE:  I don't know what I'm going to get.



LEO:  You'll get a plaque or something, I'm sure.



STEVE:  Well, Elaine is going to be there with camera, so I�may actually be able to put some photos up on the show�notes.



LEO:  Oh, good.  Elaine is the wonderful woman who transcribes all these Security Nows.  Yeah, we have to say that because she's typing even as we speak.



STEVE:  And she's smiling right now.



LEO:  She's the greatest.



STEVE:  Actually she was laughing so hard, she told me, during the end of the Listener Feedback 24...



LEO:  Oh, yeah, the tattoo, yeah.



STEVE:  ...with the wacky UV tattoo guy that her husband came into her office and said what in the world is so funny?



LEO:  Well, her bread and butter is court transcriptions, or court reporter.  And so I don't think you get a lot of laughs out of that.



STEVE:  No, it's pretty dry.



LEO:  Probably rare that he hears her giggling.  Maybe not, though, who knows.  So this is a listener feedback day, as are all our even podcasts these days, Listener Feedback 25.  And we've got a good set of questions.  No wacky 13th this�time.



STEVE:  No.



LEO:  Speaking of nerds, Steve Gibson and I are here.  We�are ready to nerd out with some of your questions.  Do you want to mention SpinRite real quick before we move onto�that?



STEVE:  Oh, I thought I would give it another vacation since�we're...



LEO:  Steve...



STEVE:  ...on a bit of a tight schedule, and I don't...



LEO:  Steve.



STEVE:  All right.  I don't want to take up...



LEO:  Make it simple.  Yeah, I understand, but if you've got a hard drive in trouble, SpinRite.  GRC.com.  It's the best money you'll ever spend.  It recovers hard drives.  It helps you maintain your hard drive so you don't have these problems.  I've got a guy who was ready to spend, I think, a couple thousand dollars on one of those companies where they take your drive apart and replace the platters.  And I said, whoa, whoa, whoa, you know, it could just be a software problem.  You should try SpinRite first.  And I think it was a software problem because the drive would boot up, but it would say "No NT loader found," right?



STEVE:  Right.



LEO:  And that's where SpinRite can really help you.  And I haven't heard back from him, but I'm sure that he's been very happy with it.  GRC.com.



STEVE:  It probably is worth mentioning something that's been on my mind.  It's not a testimonial, but I should mention that we keep hearing from people who have been brought back from the brink of disaster.  Their computers wouldn't boot, they had lost their stuff, whatever.  I mean, those are pretty much what the testimonials are every week.  But had SpinRite been run on those drives prior to passing off the cliff, then the drives would have never had this problem.  I mean, Greg, in fact, my tech support guy, he says, "You know, Steve, you never mention to Security Now! listeners that it is preventative maintenance.  It's not just data recovery."  And I go, "I know, Greg, but I just don't think people are going to go out and spend $89 because they have extra money."



LEO:  Well, they do if it's a crisis.  But you notice I always say "the world's best drive maintenance and recovery�utility."



STEVE:  Yeah.  So I did want to mention that SpinRite does prevent these kinds of problems.  It is able to, way more often than not, bring a drive back into use that has already passed out of use.  But, boy, if you run it every couple months, it will never get into that trouble in the first place.  I mean, it's really the case.



LEO:  Right.  All right, let's get to our questions, my friend, starting with No. 1.  Numero uno, Keith in New Jersey.  He says:  How do you do credit card transactions?  I just want to know what service allows you to process credit card transactions.  He's talking about your eCommerce solution.  I understand how you were able to take all the required information, including the credit card.  But then what?  Does VeriSign offer a service to charge credit cards?



STEVE:  That's a great question because I remember when I was first researching this I dug around to, like, find the right electronic funds transfer, EFTS, Electronic Funds Transfer Service, or System, that would do that.  I ended up settling on a system called CyberCash that was in the game and had a very nice API.  Essentially, I downloaded a kit from them and had - in this case for Windows, although they supported multiple platforms.  And they had a DLL, a Dynamic Link Library, that I just added to the server.



LEO:  Oh, that's nice.



STEVE:  And then my software would interact with that DLL.  That contained SSL technology, certificates, and all the stuff it needed for connecting to their back-end credit card processing system.  And as it happens, a couple years ago VeriSign bought CyberCash, and the system is called Payflow Pro.  I can't speak for any other facilities because I've never used anything other than Payflow Pro, which used to be CyberCash and is now VeriSign.  One of the reasons is we have never had a single problem with this from day one.  I mean, it...



LEO:  It works.



STEVE:  Yes.  And I was worried when VeriSign bought them.  It was like, oh, no, are they going to change the protocols or make me update something or mess with something that's already working perfectly?  And they have done apparently nothing, at least nothing bad, to it.  I mean, it just - it works beautifully.  And so if we have listeners who have an interest in doing eCommerce, for what it's worth, again, I have no relative comparison except to say that nothing has ever not worked perfectly with the Payflow Pro system, originally from CyberCash and now from VeriSign.  I mean, for what it's worth I can vouch for it absolutely.  And I would only caution people to be very careful about all the other aspects of doing an eCommerce site.  I mean, you really want to protect your users' information and just do everything you can to prevent there from being any sort of way of exploiting the site other than the back-end credit card charging process, which is really pretty much nailed�down.



LEO:  Yeah, I mean, Payflow Pro is for somebody who's rolling their own solution.



STEVE:  Right



LEO:  So, I mean, if you're not a programmer like Steve, you're probably going to go to Yahoo! Stores or something like that and let them do the merchant banking and the transactions and all that, or...



STEVE:  Or just PayPal.



LEO:  Or PayPal, or eBay, or there's lots of other ways to do it.  Because, I mean, this sounds like a pretty low-level solution in the sense that it's for somebody who's writing an eCommerce system or has an eCommerce system he can plug it into.



STEVE:  Yes, that's exactly right.  And I objected, since I have the skill to talk to the back-end credit card processing system directly myself, I didn't want to give anybody else a piece of my action.  A lot of these other services, they're not free.  And Payflow Pro is not free, either.  I pay some small percentage, a transaction fee and a percentage.  But it's not then marked up again by somebody else who's basically using them and putting their own wrapper around it.



LEO:  Yeah, you know, PayPal's fairly expensive.  I'm trying to remember, I think it's - when you do a $2 donation to us, they take 37 cents of it.  So...



STEVE:  Yeah, PayPal itself.



LEO:  Yeah.  It's not insignificant.



STEVE:  Yes.



LEO:  That's the total charges.  It may be PayPal takes some and the credit card company or whatever.  But that's...



STEVE:  As opposed to, like, 2 cents, which would be 1�percent.



LEO:  Right.  Yeah, that's a lot.  Question No. 2, Russell Johnson in MinneSnowta - not MinneSnowta yet, but it's going to be MinneSnowta soon - wonders about the double-edged sword of SSL proxying.  What is your opinion of deploying an SSL proxy, similar to something offered like Finjan?  What are the privacy and legal issues of this technology?  I helped set up a system using this technology in a public school's network.  Also, what disclosures should be made so that users are aware the info they thought was encrypted from the browser to the server is actually being decrypted by the proxy?  A CEO of a large company may be unaware that an IT employee or outside contractor can now access his previously impervious encrypted data, like credit card numbers and passwords.  I know the intention of the software is to prevent using SSL to hide web surfing activity.  But is this going too far?  I wonder if ISPs would employ this kind of technology.  Now, that would scare me.



STEVE:  Yes.  They can't.  Okay.  Just to sort of give our listeners a little bit of background, an SSL proxy means that, rather than your browser connecting to the actual remote web server of a site you are visiting, like BankofAmerica.com, with a secure connection, instead this proxy is intercepting the connection, and then it is turning around and creating the secure connection to the remote site.  The reason this was installed, for example, in this public school's network is they wanted to prevent, specifically to prevent what SSL is for, which is encrypting the communication from endpoint to endpoint.



So essentially what they did was they inserted their own intermediary endpoint so that the user or the student, in this case, in the case of a public high school, or a public school, but if the student is connecting to the proxy server, that's one SSL connection.  And then a second SSL connection is made from the proxy server to the remote website.  The reason this is done is that between those two connections in the proxy server, the encrypted data is decrypted, it's in the clear, and can then be inspected by filtering software.  So the school did this because they wanted to be able to insert web filtering software into, not only normal HTTP connections, where it's easy to do, but also into HTTPS connections.



In order to do that, though, the browsers in the school have to have a certificate from the proxy, and the proxy has to create - it's a function of how transparent the proxy wants to be.  The proxy has to essentially create certificates on the fly that apparently belong to the third-party remote server, and it signs them.  Normally, as we know, server certificates are signed by trust certificate authorities - Equifax, VeriSign, or whoever.  But in order to transparently proxy in the way the school district is, there's no way for a man-in-the-middle attack, which is really what an SSL proxy is, if you think about it.  It's trying to be a man in the middle to decrypt that traffic.



Well, the beauty of SSL with certificates is, as long as the certificates are signed by a trusted certificate authority, nobody else can sign, like, fake certificate with that authority because nobody else has that authority's private key.  The public key allows you to verify the certificate, but you need the private key that would never be released in order to yourself sign it.



So what happens is, within this school network, in order to make a secure connection, all the browsers would have to accept a certificate from the proxy, or just not have HTTPS connections.  But apparently they do.  And in fact this the way SSL proxies work is that you, you know, all of the browsers have a certificate from the proxy, so that essentially means I trust the proxy to do anything it wants.  And in so trusting it, one of the things it wants to do is to decrypt your traffic for inspection.



LEO:  Wow.



STEVE:  So relative to privacy and legal issues, we immediately can see what they would be.  First of all, the assumed privacy of HTTPS is gone because it is being - the traffic is being decrypted at the border, inspected, filtered, logged, I mean, anything...



LEO:  But it's okay if you trust the intermediate.



STEVE:  Correct.  So, for example, the CEO of the large company presumably knows...



LEO:  It's his company.



STEVE:  Yeah, exactly.  It's his company.  Especially if he's the CTO of the large company.



LEO:  He's the one who said it could be all right.



STEVE:  Certainly I would say that it would be worth - and�probably for, like, school district policy, or corporate�policy in a corporate setting, in the policy manual it says you should know that you're using corporate property.  These are company computers.  They are subject to monitoring, logging, surveillance, filtering.  Basically behave yourself.



LEO:  I'd like to point out, though, while that's good policy, it's not required by law.



STEVE:  Right.



LEO:  The law says it's a corporate computer.  They can do anything they want with it.



STEVE:  Right, from the get-go, without having to specifically notify you.



LEO:  Don't have to tell you nothing.  Although I think it's�a very good policy to do so.  I mean, that's just good�citizenship.



STEVE:  Well, especially if some damage were to occur as a consequence of that proxying, like data escaped from the organization's control.



LEO:  Why can't an ISP do that to me?



STEVE:  Well, an ISP could if you accepted a certificate and treated them...



LEO:  They'd have to modify my system.



STEVE:  Exactly.  They would have to add a certificate to your browser.  And, I mean, I'm already nervous about the Hong Kong Post Office doing that.



LEO:  You keep bringing the Hong Kong - now, the truth is, though, many ISPs now give you a CD that has software to install.  Usually it's a PPOE dialer for DSL.  But there's no reason they couldn't be, I mean, they modify IE, and they often say "Provided by Verizon."



STEVE:  And they convert it to their home page and do all that.  But you're right, Leo, I mean, from a technical standpoint they would not be prevented from doing this.  And�this is why every time we talk about SSL and anti-phishing, I talk about looking up the chain of trust because what you would see is you thought you were on eBay, https://www.ebay.com, and you thought you were on a secure eBay page.  If this were being done, you would right-click on your browser's page, and you would see eBay, that the eBay certificate had been signed by Cox.net.  Now...



LEO:  Ah, okay.  So it'd still be an eBay certificate, but it would be signed by your Internet service provider or your boss or the school district.  It would be clear that it wasn't eBay's.



STEVE:  Correct.



LEO:  Okay.  So there is a way to tell.  There's no way they can hide that.



STEVE:  Right.  And in fact, well, for users who are smart enough and aware enough to perform this test.  I mean, I think it is the case - and this is a point I was going to mention last week when we were talking about the problem of phishing with OpenID service.  In general I think we're going to see motion towards preventing phishing attacks in the future.  We've already seen the green field in your URL that some browsers will now provide if you have an extended authentication certificate which, you know, you have to pay more money for, which bugs me.  But we're beginning to see this.  I imagine a system where web browsers preferentially connected over SSL if it was available.  So even though you go http://eBay.com, imagine that the web browser also tries to make an SSL connection, and does so, and prefers it over the non-secure connection if it's available.



It used to be the case that SSL was very expensive in terms of computing to establish due to the computation overhead of secure sockets and the public key crypto that has to be done once during the connection.  But machines have gotten so powerful now, and servers are so powerful, that it just wasn't - it's still the case that SSL is, you know, doing a secure connection is a little more computationally burdensome, but not so that it's significant in this day and�age.



So I would say the other reason an ISP would be not motivated to insert their own certificate is it would really open them up to liability if anything ever happened and it was found that they were inserting themselves in secure connections without really clear, making it obvious that they were doing so.  Like, for example, adding their own line to every secure page that's displayed, saying this page has been filtered by your ISP.  And if they did that, who would use these people?



LEO:  Yeah.  For your protection.  Filtered for your�protection.



STEVE:  So it's exactly like the old spyware argument.  It's like, oh, well, we told our people that we were installing this new search system on their browsers.  Like, no, you didn't.  And if you did, they would hate you, so...



LEO:  So don't.



STEVE:  Right.



LEO:  Eric, anonymously somewhere near the Hong Kong Post�Office...



STEVE:  That's actually what he said in his posting, Leo.  I didn't make that up.  He was being funny.



LEO:  Is there any way to use web-based email to send email while remaining completely anonymous?  I tried using TOR, but every web-based email I used asked me to turn on cookies or Java.  This, as we know, can defeat TOR and give away your local public IP.  I suppose that's why they require cookies and Java?



STEVE:  Well, now, it's an interesting question because it's�the case that your computer can only give away the information it has.  And if you're behind a residential or local NAT router of some kind, you always certainly have a private IP, not a public IP.  That is, your computer is 192.168. something or other, or 10., or 172. something.  So it might be that your computer doesn't know what your true local public IP is.  It only has your private IP.  So once that's the case, and you're running a TOR client on your machine so that your traffic is encrypted to the first TOR node, the second TOR node, and the third TOR node, after which it goes out, then you really are anonymous.  That is, even a web-based email service that was putting the client IP in the email headers, as we've talked about before, as far as I know they all do except Google.  For whatever reason Google Mail doesn't.  It uses probably something that they can decrypt into that, but at least it's not there; whereas Hotmail and Yahoo! Mail, the last time I looked, both were putting the client IP in there.



Still, what those web-based systems would see as the client would be the IP of the last TOR node in the chain.  So again, your browser, through which you are using this web-based email through TOR, it can't give away what it doesn't know.  And it doesn't know your local public IP.  So in fact I think you could be, if you're careful, you could be anonymous using TOR, as long as your local machine did not have your public IP, as long as you were behind a NAT router that was giving your machine a private 192.168 that absolutely does not identify you on the Internet.



LEO:  There are, I should point out, web-based email services designed around privacy.  Phil Zimmermann, the creator of PGP, worked with a company called HushMail.  And�Hush Mail uses PGP encryption and presumably has lots of�other privacy protections.  They have secure free email.��They also have - by the way, they do certificates now, I see.  That's something new.  Something to look into,�HushMail.com.



[Talking simultaneously]



STEVE:  And it's a very good service, and well respected.



LEO:  Yeah.  I think they're absolutely reliable in that regard.  Moving on to our next question.  David Farrell in London raises another point about TOR, The Onion Router, which we again underscore is used for privacy, for anonymity, not for encryption or security.  Dear Steve and Leo, I'm an avid listener of Security Now! and the other netcasts.  I benefit greatly from the insight you have to offer, so thanks.  You're welcome, David, thanks for the kind words.  One thought that I kept having as you two explored some of the issues of TOR recently was that it seems that using TOR is in fact less secure than normal browsing if you're performing ordinary web surfing.  And here's what he means.



Without TOR I'm trackable by IP address, of course.  But my data, assuming secure WiFi or LAN to router, goes from my PC through my ISP's machine and then is routed to the actual page I'm visiting.  The servers with access to my data, such as emails, passwords, and the like, all belong to web hosting companies - well, okay - in whom we place some degree of trust.  I assume that Be Broadband or BT or NTL will not be sniffing my HTTP stream for username/password form posts.  But contrast that with the use of TOR, especially now that we're seeing that there are TOR servers owned by governmental agencies, the Hong Kong Post - oh, no.  Sure, I'm now no longer trackable by IP address, but I place a significant degree of trust in the random person whose TOR node I'm using.  As evidenced by the comments in the last show, it is possible and not uncommon for there to be a sniffer at the TOR node.  So assuming that I'm engaging in normal web browsing without SSL or a VPN connection, it seems to me the risks of data sniffing vastly outweigh the benefits of anonymity.  What do you guys think?



STEVE:  I think he raises a really good point.  Essentially, clearly there's this cluster of interest around TOR's exit traffic because people are doing things through TOR that require anonymity.  So you might argue that TOR is drawing people to itself, that is, spies or security researchers or governments or whatever, who are using TOR as potential high-value sources for questionable web traffic.  And David's point is that, by contrast, when he's not using TOR, his data goes to his ISP and immediately scatters to the winds.  It's going, you know, there's no central, except for the ISP machine where his data does egress onto the Internet, there's no central concentration of his data as there is in the case of a TOR node.  Nor, and I think more importantly, is there any reason for someone to suspect that that data might be interesting to them.  Whereas the data exiting TOR nodes, it's probably a little more risqu�.



LEO:  Yeah.  Well, again, let's emphasize, it's for anonymity, not security.  And it's good to know that.



STEVE:  Right, and people who are wanting anonymity, I would argue - and I know you would, too, Leo - that absolutely that's a right.  It's something that the Internet provides, and it's something worth having.  So it's not the case that people who want to be anonymous are doing bad things.  But analysis of traffic has shown that TOR tends to attract that, too.



LEO:  Joe Graf, Sacramento, California.  He's got an idea for making your feedback form screen reader friendly.  We talked about this a couple episodes ago, a blind listener said, I understand what you're doing to prevent bots, but it makes it hard for me to see with my screen reader.



STEVE:  Right.



LEO:  Steve, all you have to do is add some alt text to the images.  So just use the alt tag in your images to something that will make sense to...



STEVE:  I know, Leo.



LEO:  ...the user when the screen readers read it.  Also, if you want to be XHTML compliant, you have to have alt text anyway.  Yeah, of course, alt text makes it accessible.



STEVE:  And the bots love it.



LEO:  The bot can read it just as any screen reader.  I think I mentioned that when we were talking.  I think I said you can't use an alt text.  So that's the problem is anything that a screen reader can read, a bot can read.



STEVE:  Exactly.  And as you said, that's the problem.  And I just wanted to close the loop with Joe and for any other users who are thinking that that would work.  The problem is that that's text in the HTML, which is exactly what the bots are out there sniffing for.  So, I mean, much as I have absolutely no interest or intent to make things difficult for visually impaired users of our forum, and in fact we enumerated the fields on the form in order with Leo typing the tab key so that we could let people know who were listening how to fill out the form and do so successfully.



LEO:  I think that's a good way to do it.  That's your cheat sheet.  No robots listen, as far as we know, no robots listen to Security Now!.  Let us know if you're a robot and you're listening.



Laura Cooksey in - is Laura next?  I want to make sure I didn't skip anybody.  Yeah, Laura Cooksey in Burke, VA, a suburb of Washington, D.C., says:  I've used Steve's free Unplug N' Pray widget to disable the Universal Plug and Play service on all my computers.  Also - I like you, Laura - disabled UPnP on my Linksys WRT54G router.  However, Microsoft strongly recommends that UPnP be turned on in routers used with Xbox Live to ensure best performance in multiplayer games.  Since I've disabled UPnP on my computers, is it safe to enable UPnP in my router full-time, or should I only enable it when I'm planning to game and then disable it when I'm done?  And while we're talking about that, maybe I could ask you about UPnP2, which Microsoft says solves the security issues of Universal Plug and Play.



STEVE:  I have not yet looked at UPnP2, but I definitely�will.



LEO:  That's what their Windows Home Server uses.  And since a lot of people I think are going to use Windows Home Server as a router and a bridge to the Internet, I think we should look into this.



STEVE:  Oh, I absolutely will for sure.  Laura's question was great because the answer is, well, first of all, no, that it is not safe to enable UPnP in the router.  And in fact, if you had to disable UPnP facility anywhere in your network, Laura, the one place you want to disable it is the router.  You could even leave it turned on on all the machines that are behind the router.  The reason I did Unplug N' Pray widget was that, as was the case with probably every server Microsoft ever created - and of course Universal Plug and Play service is a server, meaning that it had an open port.  So anybody not behind a router had this open port exposed to the Internet, and there was a buffer overflow that allowed people to take over your machines remotely.  So at the time I immediately created Unplug N' Pray just to turn it off because also at the time almost no one needed it.



Now, for example, we're seeing the case that, with the Xbox, it would like to have Universal Plug and Play enabled on the router so that it's able to essentially open incoming ports back through the router to your LAN.  Thus the danger of having Universal Plug and Play first edition, that is, v1 of Universal Plug and Play, enabled on your router is that, even with the services disabled, your Windows Universal Plug and Play service disabled, it's still possible, just using some UDP and TCP traffic that any trojan could easily generate, it's still possible for them to query your LAN, find any Universal Plug and Play-equipped devices, determine it's a gateway, i.e., your router, and then talk to it behind your back in order to enable incoming unsolicited traffic, which is exactly why we've got the router there as one of the substantial security benefits, for example, if Windows, even in a vulnerable state, were behind the router, that Universal Plug and Play vulnerability would have never been a problem.  It was only for people whose machines were directly on the Internet, which even now just saying that just sort of makes me shudder because having a NAT router is�just such good security.  But if you enable Universal Plug and Play on a router, and something did get into your machine that could talk to the router, then you're in�trouble.



Now, the good news is - I did some research on this - there are only two ports that the Xbox actually has to have open.  Microsoft documents this in a Knowledge Base article, 908874.  And so if you just go to Microsoft.com and put in KB - for knowledge base - 908874, you can go there.  But I can also tell you what it is because it's very simple.



The Xbox Live system needs the UDP port 88 and both UDP and TC ports 3074 mapped into your network.  So what you can do is - and obviously Laura is listening to this and is very tech savvy or security savvy, you would like to give your Xbox a static IP within your LAN.  Normally when you turn a computer on it gets the next address available, 192.168.0.1, .0.2., .0.3, .0.4, and just sort of goes up that way.  What you'd like to do, though, is you'd like your Xbox to always receive the same IP so that it's not floating around, its IP is not changing.  That's because you want to forward those ports I just named, UDP 88 and TCP and UDP 3074, you'd like to forward them to that fixed IP where the Xbox will always�reside.



All routers now allow you to define a fixed IP based on the MAC address of the LAN adapter on the network.  So you first look at the client list to find your Xbox, and it'll be listed there based on its IP.  Then you can figure DHCP to always give that MAC address the same IP.  You probably want to pull it up out of your normal range, like 192.168.0.40 or something.  Doesn't want to be too high because some NAT routers won't allow the numbers to go all the way up to 255.  But 40 would be safe unless you've got 42 computers in your LAN, and I think few users probably do.  So that would always give the Xbox the same IP.



Then you configure what's called "static port forwarding" to statically map those ports to the Xbox.  The beauty of this is that you do not need Universal Plug and Play enabled.  Essentially you've done what the Xbox would have done anyway with Universal Plug and Play, but you've done so by manually configuring it rather than having it automatically configured.  And it's the automatic configuration that is so worrisome with Universal Plug and Play.  And in that case you've got the highest level of connectivity for your Xbox.  Microsoft uses some terms; there's, like, three degrees of connectivity.  There's moderate and strict and something else.  I think it's open.  And you get the open degree of connectivity, which means anybody else is able to connect into you, even if they're behind a NAT router which has got strict connectivity because they haven't gone through what you have to get yourself configured.



LEO:  So you've just described something called port forwarding.  And basically UPnP makes it easy for people who don't want to go through this trouble or understand it to get this kind of connectivity.  But the risk is that a bad guy can get this kind of connectivity, too.



STEVE:  Exactly.



LEO:  So do it by hand.  Learn - and obviously Laura is smart enough to know this - learn how to do it by hand.  It's not that complicated once you...



STEVE:  And then she can tell all of her Xbox friends and spread the word.  Because it won't introduce significant insecurity because those ports, even though they're now open, they're only going to go to that IP address where you've put your Xbox.  So nothing else can get it.  And we hope that the Xbox doesn't have any unknown vulnerabilities that would allow people to crawl into it.



LEO:  You're relying on Xbox Live being secure and the Xbox being secure.  But, you know, you've got to do that.



STEVE:  Got to trust somebody, Leo.



LEO:  Got to trust somebody, I don't know who.  Kalman Dee in Australia's capital, Canberra...



STEVE:  And we now know the capital of Australia.



LEO:  ...has monkeys on the brain.  Leo mentioned that an infinite number of monkeys typing for an infinite time would produce, not just a work of Shakespeare, all the works of Shakespeare.  I thought this odd assumption over.  I think, if there are an infinite number of monkeys, they wouldn't need infinite time.  One of them - well, I'm just quoting the old saw.  One of them out of the infinite number would type the work up in a finite time, in a few hours, depending on his typing speed.  If there were only one monkey, he would need infinite time.  You're right  So somewhere in the middle of the allocated infinite time the monkey would type up the work, i.e., it would actually - it would be a finite 

time.  So he could stop and get on with his life.  The old paradigm could be modified to "one or more monkeys typing for an unknowably long but finite period of time would produce a work of Shakespeare."  I misstated it.  It's actually an infinite number of monkeys typing for an infinite number of time would produce all written works of all kinds.  Plus a lot of gibberish.



STEVE:  Yeah, I liked...



LEO:  Got a good point, though.



STEVE:  I liked Kalman's, well, I liked this also from the standpoint of we're often dealing, as we talk about security, with really big numbers and issues of, oh, it's unbreakable; or, oh, it'll only take a few minutes to break it.  Or we've got this many bits gives us this much crypto protection and all that.  So we're dealing with sort of scales of size and things less than infinity.  And so are his monkeys.



LEO:  Well, that's the thing about monkeys.  That's the thing about infinity.  Infinity is a special number.



STEVE:  Oh, it's big, Leo.



LEO:  It's not just a really big number, it's infinity.  So infinity times infinity is actually no bigger than infinity by itself.  Or is it?



STEVE:  I don't know.  There are classes of infinity, I think.  There are mathematicians who, like, spend their days thinking about this.



LEO:  Exceeds my meager brain capacity.



STEVE:  Fortunately we don't have to, no.



LEO:  Adam in Ottumwa, Iowa says:  I've been dutifully listening along with Security Now! since its inception.  Yay.  112 episodes ago.  I was thinking about the recent episodes where you and Leo refer to saving the browser's state when hosting eCommerce sites.  My question is, how could this work with Safari and private browsing?  I haven't used this feature, don't claim to know anything about it; but it's my understanding it does not save any history cookies, session data whatsoever.  Is this really true?  Wouldn't you have problems with private browsing and eCommerce sites?  Well, that was the whole point of what you were doing is it bypasses this issue.



STEVE:  Well, it didn't depend upon that.  I did not know what Safari's private browsing was until I got this posting and took a look around.  And I think it is extremely cool, Leo.  It's right there on the Safari main menu.  And you turn on private browsing, and it pops up a notice warning you about all the things that are deliberately not going to save your state.



LEO:  When private browsing is turned on, web pages are not added to the history.  Items are automatically removed from the downloads window.  Information isn't saved for autofill.  Searches are not added to the pop-up menu.  Until you close the window, you still can click the back and forward buttons to return to pages you've opened.  And that's where it stops.  But just to go on, no cookies are saved; no state is�saved.



STEVE:  Isn't that cool?  I didn't even know that was there.  And it's funny because, as I was doing some research, I found some blogs that refer to it as "porn mode."



LEO:  Yeah.  That's what it's for, of course.  Everybody knows that.  Well, what else are you trying to hide?



STEVE:  Because, you know, so much effort has gone into eliminating the state of where people surf, with all kinds of third-party tools.  And I thought, wow, this is a cool feature for a browser to have, and all browsers ought to have it.



LEO:  I think IE7 has something similar.  It basically clears history when you close it.  The point is, your system was designed specifically to get around that by not using�cookies.



STEVE:  Yes.  And in fact my system would work perfectly, even with private browsing enabled in Safari and any other browser, because essentially it's the page itself, the page the user receives carries the state information, not cookies or URLs or history or any other mechanism.  So when you submit the form, that page that contained the data, a piece of it goes back with the form to the server.  So it is the case that at least GRC's eCommerce system functions without scripting or cookies of any sort because the actual page is where that state is saved.  But I just, for users who hadn't run across that private browsing feature, I wanted to put this question in because it's like, hey, I'm glad to know that's there.



LEO:  Yeah, that is a nice feature, yeah.  I've been getting a lot of emails saying, "Steve claimed he invented this, and it's been going on for years."  I don't think you - we said this last time, but I just want to reiterate.  You didn't claim you invented it.



STEVE:  No.  I just came up with the solution that worked for me.



LEO:  Independently you came up with that solution.  But of course you're not the only one who thought of it, and you weren't even the first one who thought of it.  And I don't think you claimed that.



Chris Noble of Wellington, New Zealand gets the Gold Star Award.  He writes:  Nice work putting some hidden fields into your feedback form to trip up the bots, Steve.  However, rather than actually specifying type=hidden in the input tag, which bots can easily see and of course could be smart enough to ignore, you could do this via CSS, removing the "hidden" alert from inside the form.  In the input tag, use something like class="abc", and then in your stylesheet include .abc {visibility:hidden; display:none;}.  Still not bulletproof - in fact it's not because the bot also sees the CSS, but okay.  At least it's one step harder for a bot to figure out it's a hidden field that should be left alone.  I think most spiders and bots ignore style info.  They may well dip into these - you have to include the CSS if you don't put it in line.  And they could load that CSS and look at it.  So you're right, depends how sophisticated they want to be.



STEVE:  Yeah, I just liked it because it sort of fits my model of something simple that's providing some additional resistance to bots taking advantage of our technology.  And while it's not galactically powerful, it's like, okay, I like that because having the hidden tag right there couldn't make it any more obvious to a bot that this is not a field that a user would fill in.  And if you didn't have it, you might assume that the bot writer didn't ever consider that they ought to parse the CSS file and then have to do a match-up of CSS class...



LEO:  Right, makes it a little more complicated, yeah.



STEVE:  Yeah, I mean, it's substantially more complicated.  So it's like, yeah, I gave him the gold star.



LEO:  Right.  Gold star.  Clever.  Andy in Iowa - another Iowan - had a common question about SpinRite and RAID:  I love SpinRite.  I love RAID.  I'd like to use SpinRite on RAID.  Is that okay?



STEVE:  We get the question a lot.  And so I don't want to take a lot of time about this, but I want to explain that there are, in our mind, sort of two types of RAID controllers, what we call "thin RAID" and full-on industrial strength "thick RAID," the distinction being that a thick RAID controller is a controller with a coprocessor, probably has got some caching memory on it, and it's really decoupled the drives in the RAID array from the machine.  So the machine dumps a bunch of data on the controller, which the controller caches.  And then the controller independently turns around and writes that data in so-called "lazy writing" to the drives of the RAID array.



Now, this is as distinct from motherboards that now often will have a RAID controller on them, but it's a little Promise Technology chip.  And all it's really doing is basically allowing that to be a bootable RAID.  So there's some BIOS support that allows a couple drives to be booted.  And then you still need a software driver in your OS in order to essentially implement the RAID in software.



LEO:  People often think that these motherboard RAIDs are hardware RAIDs.  They're not.  They're software RAIDs.



STEVE:  Yes, they are.  They're just sort of hardware assists that just gets the RAID and allows it to be bootable.  But once it gets going, the OS has a driver which does this in software.  So, relative to SpinRite, it is generally okay to run SpinRite on a RAID 0, which is...



LEO:  A hardware RAID.  Or even a BIOS RAID.



STEVE:  No, in fact you would not want to run it on a so-called thick RAID controller ever because, well, at least not on the controller.  That is, what we tell people to do is just temporarily take the drive off of the RAID...



LEO:  Ah, do individual drives.



STEVE:  Exactly.  Stick it onto a regular motherboard connection, which you probably have right there on the motherboard, and SpinRite will see it and run on it just�fine.



LEO:  And that works because you don't need a file system; you don't need to know that the files are all there.  You're looking at such a low level, you're not looking at how it's written or anything like that.



STEVE:  At just the raw physical sector level, right.  And so we won't break - SpinRite will never break the RAID.  It won't cause it to be nonfunctional.  It doesn't matter if you've got RAID 5 or 6 or 27 or whatever you're using.  SpinRite will work on it just fine as long as it's talking just to the bare drive, not through the controller.  But in the case of the thin RAID, because when you're running SpinRite there's no operating system with its own software drivers, it will see the drives separately in the normal case.  However, you still, in a mirroring configuration where you are writing to both drives - but you're only reading from one typically in a mirror.  You're not redundantly reading from the drives.  So the point is, it does not make sense to run SpinRite on mirrored drives behind a thin RAID controller.  Even there you would want to unplug them from that connector and plug them into a regular motherboard controller.



But in the case of striping, where you've RAIDed them to expand the size - so, for example, you've got two 100-gig drives, and you're running in RAID 0, which is where essentially you've created a virtual 200-gig drive, there you could run SpinRite in place with the drives just like they are because essentially the queries are being split between drives, but there's no redundancy of data.  It's the redundancy of data, or in the case of a thick RAID it's the caching, which is sort of decoupling SpinRite from the drive.  And that's what you want to avoid.  You want SpinRite to actually have the full and undivided attention of the drive.



LEO:  Makes sense.  And actually I'm glad you addressed this notion of software RAID because I've said it for a long time, but nobody believes me.  You they believe.



Eliezer Martinez, listening from Puerto Rico, wonders about OpenDNS.  He says:  I recently started using OpenDNS because it supposedly speeds up the loading of pages.  Seems to, he says, mostly because they block known phishing sites.  After listening to your latest feedback episode in which you explain the pros and mostly the cons of using TOR, it made me question whether OpenDNS is worth using.  Maybe I'm paranoid - thank you, Steve - but I stopped using it in fear that sensitive information like Internet banking transactions could be monitored by the OpenDNS people.  What are your thoughts about it?  Am I mixing up two different things, or should the same precautions be taken when redirecting web traffic through a third party with OpenDNS?



STEVE:  Well, that's a really great question.  OpenDNS, of�course, is essentially an independent domain name server�system.  And it is popular with many security-conscious users.



LEO:  I use it all the time.



STEVE:  Yes.  The idea...



LEO:  I put it on my router, so every computer on my system uses OpenDNS.



STEVE:  Exactly.  So the idea being that, first of all, it is generally high performance.  Often it's higher performance than your ISP's own DNS servers, that sort of tend to be unwanted stepchildren of ISPs.  Just like, oh, DNS is not a very sexy thing for them to be offering, so they sometimes don't get faster servers, or they're overloaded.  And the idea, of course, is that any time we're going out on the Internet and surfing somewhere, we're using a URL, generally with a domain name.



So, for example, eBay.com.  The first time you use eBay.com, and even periodically, your system needs to go and have that eBay.com converted into the actual Internet IP address.  That, as we know, is what DNS does.  So if your ISP's servers, your DNS servers, which would be the default when you set up an account with your ISP, if those servers are slow, then it takes longer for you to get to eBay.com, and potentially everything else.  So, I mean, the speed of DNS is sort of a not-often-discussed but very important aspect of the overall performance you feel in doing things on the Internet.  So OpenDNS has very fast and often faster servers than your ISP.  So your browser will get the IP that it's looking for more quickly using the OpenDNS servers.



LEO:  But what about the security issues?



STEVE:  Well, the security is a concern from a standpoint of there have been problems with so-called "DNS poisoning," that is, if you were going to eBay.com, your browser is going to inherently trust the information that it gets from DNS.  So if the DNS server lied about Microsoft's IP when you were going to Microsoft.com, your browser would go to the wrong IP.  Now, once again, secure sockets solves this problem because SSL connections cannot be spoofed and fooled.  But lots of people would just go to Microsoft, you know, http://microsoft.com, not the secure version.  So it would be possible to spoof Microsoft and really confuse someone and allow them to be misled because even their web browser would show www.microsoft.com.  Oftentimes phishing sites will obscure the URL and use, like, hex notation or decimal notation for URLs, or some fancy way of obscuring what's actually up in the URL, assuming that most people don't glance up there to verify that they're at Microsoft.com.  The potential potency of DNS poisoning or some sort of DNS man-in-the-middle attack is that your browser would think it was really at Microsoft.com even though it wasn't.



But aside from security, the other issue here is privacy.  And we're going to be talking about this in our - explicitly more in our episode about third parties because here again we have a third-party phenomenon.  There's us, and there's eBay or Microsoft, and there's our DNS server.  The DNS server does know every site we visit because we're having to ask the DNS server for the IP address of every site we visit.  So it's the case that the DNS server really has nothing but our IP address.  On the other hand, that's all any other third party generally has about us, although it's a little more potent in the OpenID case because we're authenticating with them, so presumably there's some sort of an account relationship there where there isn't one with a DNS server.



But again, there is this third-party phenomenon that is an issue when you're using OpenDNS, although the presumption is these are good guys; they are not tracking people.  They're even going further by - and this is what he talked about blocking phishing sites.  They work not to carry the domain names of bad sites so that your browser can't go to a bad site even if it wanted to.  It's trying to look up that DNS name which is deliberately not carried by the OpenDNS servers.  It's sort of like - it's very much like what people, some do, as we've talked about with the hosts file.  In the hosts file we're blocking DNS queries locally by preventing the query from ever leaving our machine.  Instead, the hosts file provides typically just 127.0.0.1 in order to prevent our browser from going outside of our machine.  OpenDNS does the same sort of thing, but gives you the advantage of sort of centralized monitoring and management of that.



LEO:  And now, Steve, the last question.



STEVE:  I'm ready.



LEO:  Can you still hear me?



STEVE:  I'm ready.



LEO:  You ready?  This is going to be a tough one.  No, I don't know.  Steve and Leo, my question is about utilizing PayPal's virtual debit card.  Prior to downloading the software you're asked to verify your sys- this is the card that gives you a new number every time you use it.



STEVE:  Yeah, it's very cool.



LEO:  Yeah.  I have a debit card with them, but I'm really tempted to use this system.  Prior to downloading the software, you're asked to verify your system requirements.  If everything checks out, you can then download and install the software.  As I clicked on the "Download Now" button, my system, which is guarded by HostMon, a host file manager - we were just talking about hosts files - blocked the site, and I was redirected to the default safe site.  I was able to discover that the PayPal download link actually points to a DoubleClick.net site.  Huh?  What is the purpose for this?  Is it safe?  Should I remove DoubleClick.net from my host file manager and disregard future alarms?  Wow.  Is that an ad that's on there?  What's going on?



STEVE:  No, it's very disturbing.  I was sad to hear this.  What it means is that PayPal has some sort of relationship with DoubleClick, and that DoubleClick is essentially redirecting people to the actual download.  So PayPal has a link to DoubleClick.  And in the URL tail is the URL that PayPal wants.  So essentially it's a way of allowing DoubleClick to play cookie games with people's web browsers.



LEO:  Oh, that makes me mad.  Have you verified that they're doing this?



STEVE:  No, I have not verified.  And I will by the next show.  I'll close this loop to make sure...



LEO:  That is infuriating.



STEVE:  Isn't that really annoying?



LEO:  I hope that's not true.



STEVE:  Yeah, well, from what he's described, that's exactly what he's describing is that, in downloading the software, his browser is being routed through DoubleClick.net, which creates a first-party relationship with DoubleClick.net, allowing them to play cookie games with his browser, knowing that he's a PayPal user, knowing that he's downloading their virtual debit card.  And then DoubleClick.net is then bouncing them back to PayPal in order for him to get his downloaded software.  And his host file manager blocked that nonsense because it's got DoubleClick.net nulled out, essentially, so that his system...



LEO:  Rightly so.



STEVE:  Absolutely rightly so.  So I wanted to tell our listener, who I guess was anonymous, that he absolutely probably wants to keep HostMon and his host file manager working just like it is because it's doing the right thing.  And if what we assume is true, PayPal is up to some shenanigans that are compromising his privacy.



LEO:  Well, we'll look into it.  I don't want to hang PayPal yet.  We should find - we'll figure this out.



STEVE:  Yes.  I will verify to be sure, and it'll be number one in next week's errata.



LEO:  Okay.  And that was Sidney in Jacksonville, Florida.



STEVE:  Ah, great.  Oh, yeah, there it is.



LEO:  Very interesting.  Does DoubleClick provide a downloading bandwidth service or something?



STEVE:  No no no.  See, the idea is, all they have to do, if PayPal sends his browser to them and with PayPal's website in the URL tail, that allows DoubleClick to receive the link, to find out where it came from, play first-party cookie games with the browser, and then redirect the user back to the data in the URL tail, which will cause the browser to download from PayPal, but having made a little quick visit through DoubleClick in the process, which is really annoying.  Anyway, we don't know that for sure yet, folks.  It'll be top of the errata list in next week's Security Now!.



LEO:  I'll be sure to tune in.  We hope you all tune in.  And remember, you can get Security Now! in a 16KB version at Steve's site, GRC.com/securitynow.  That's where the show notes live.  That's where Elaine's great transcriptions of each and every show are.  And of course Steve's got a security form there where you can post your questions so you can get into the next episode of Security Now!.  Or actually the next, well, you might be in the next episode or the next question-and-answer episode.  We do them every other episode.  And that's where you can also get SpinRite, everybody's favorite disk maintenance and recovery utility.  Maintenance and recovery utility.



STEVE:  It does that, too.



LEO:  And of course all his free, useful security tools like Unplug M' Pray, Shoot The Messenger, DCOMbobulator, and ShieldsUP!, which is now at, what, over 50 million uses.



STEVE:  Oh, it's 54 or 55.  And in fact, Leo, I can confirm and announce that next week's podcast will be discussing a new fun free thing that GRC will be unveiling.



LEO:  Well, ain't you the man.



STEVE:  It'll be neat.



LEO:  That's great.  Thank you, Steve, for all that you do.  And thank you all for listening to Security Now!.  We'll see you next week.  Bye bye, Steve.



STEVE:  Bye, Leo.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.






GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#113

DATE:		October 11, 2007

TITLE:		Roaming Authentication

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-113.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  In this first of a two-part series, Steve and Leo discuss Steve's recent design of a secure roaming authentication solution for GRC's employees.  Steve begins to describe the lightweight super-secure system he designed  where even an attacker with "perfect knowledge" of an employee's logon will be unable to gain access to protected resources.



INTRO:  Netcasts you love, from people you trust.  This is TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 113 for October 11, 2007:  Roaming Authentication.



It's time for Security Now!, still the best science and technology podcast in the world - until this time next year, I guess.  Steve Gibson, hello.



STEVE GIBSON:  Thanks to our listeners, who helped us become the People's Choice Best Science & Technology Podcast.  It was really fun, in fact, was it two weeks ago I guess that I was out at Ontario.  Oh, no, it was a week ago.  And it was really great.  It's fun, Leo, to just sort of hang out with all of the podcast people...



LEO:  It is.



STEVE:  ...and hobnob.



LEO:  That's the best part of PME, yeah.  Just hang out.  And so tell me what happened.  So there was the awards party.



STEVE:  Well, yeah.  There was the awards party at the end of the first day.  And I have to say I was flattered by the fact that my award - our award, I should say - was at the end of sort of a long list.  Probably there were about 20 of them for - and sort of I think it was probably in the same order as they showed up on the web page.  So, you know, we were the...



LEO:  You were the last.



STEVE:  Yeah, we were down at the bottom of the page.  And we were similarly, on the program, we were down toward the end.  Well, I had never heard of most of the podcasts that won.  And I have a feeling that most people had not heard of most of the other podcasts.



LEO:  Yeah, there's a lot of podcasts.



STEVE:  There's a lot of podcasts.  And, you know, they sort of tend to be obscure.  And I think, you know, the TWiT family is a strong movement in pod land.  And so here were all the people, after the exhibits and the various tracks and sessions and conferences and educational things shut down, all the people sort of hanging around the steam trays, you know, gathering for this event.  And when the Science & Technology category was announced, and Security Now! was mentioned, there was a roomful of applause.



LEO:  Oh, yeah.  People know you, sure.



STEVE:  Well, and I mean, people know us, and they know this podcast, frankly, to I think a much greater degree because of the penetration and the fact that we were in our third year and, you know, blah blah blah.  But anyway, it was really neat.  So I was glad to do it.  I don't know, though, next year it's going to be in Las Vegas.  And that's...



LEO:  Yeah, I heard they were moving it.



STEVE:  Yeah.  And I'll be interested to see or to hear whether there's a strong attendance there.



LEO:  I think there'd probably be a bigger attendance.  It's not as easy for you, but it's a lot easier for most people.  Getting to Ontario is not an easy thing to do.



STEVE:  Well, and of course Las Vegas subsidizes their airfare, so that the flights you get to Las Vegas are very inexpensive.



LEO:  Yeah.  No, I understand why he's doing it.  And there's another event that I'm going to next month called Blog World that is in Las Vegas.  And I think that that's - it's just a more natural place.  I mean, one of the problems I had was getting to Ontario after a day in Vancouver, then having to get back up here; and it just was very difficult to schedule it, so.



STEVE:  Right.



LEO:  Well, anyway, congratulations.  I'm glad you won.  And it sounds like it was a great event.



STEVE:  It was absolutely worth doing.  And again, I thank our listeners.  Actually, when I went up to the front to accept the award, that's what I said.  I said, you know, I owe this to our listeners who made this happen for us when we found out this was happening, so.



LEO:  They came through fast.



STEVE:  They did.



LEO:  Yeah.  Thank you, listeners.  Well, congratulations.  Now, this week we're going to do something called, what is it, roaming...



STEVE:  Roaming authentication.



LEO:  Roman authentication.  Is this authentication you would get in Rome?



STEVE:  Well, it's interesting.  It's something we've never done before.  But there will be some opportunities in the next year or so for me to include our listeners in my own development of some new technologies.  And we know that we spoke a couple weeks ago about GRC's eCommerce system.  I sort of gave people, our listeners, a look under the covers of the way I solved problems for GRC.  I'm still in this mode of sort of nailing down a bunch of loose ends.  And one of the things that I needed to provide Sue and Greg, my two employees, was the ability to connect to our eCommerce system in a secure fashion when they were away from home.



LEO:  So a VPN, right?



STEVE:  Well, no, as a matter of fact.  And for a number of reasons.  But this will probably be a two-part series because it's - I think it'll be interesting, and it also allows us to leverage a lot of the things that we've been talking about.  You know, we tend to talk about snippets of technology here and there, how these fundamental things work.  We've never had an opportunity to look at using them to solve, like, a real-world problem, which is what I have done.  And in the process, I came up with some interesting solutions that'll be fun to share with our listeners.  So this will be roaming authentication, which will be part one of I think it's going to be a two-part podcast, which we'll finish up week after next, after next week's Q&A.



LEO:  Excellent, excellent.  Before we get to that, do you have any errata?



STEVE:  Oh, yeah.  We've got some errata.  One really funky weird thing, I had to mention it because we're a show about security.  Our friend Mark Thompson of AnalogX has about 60 routers.  That's six zero.  He's been literally collecting them from all over the place because for a project he was working on for another company...



LEO:  [Indiscernible].



STEVE:  He was, yes, exactly, for testing various types - he was developing some, sorry to say, some Universal Plug and Play technology.  It turns out that lots of routers don't do UPnP correctly.  And also doing some NAT penetration work for some peer-to-peer stuff.



LEO:  Oh, excellent.



STEVE:  So consequently he has all these routers.  Well, he was wrapping up some work, and he discovered a bizarre router, which is bizarre unfortunately in a worrisome fashion.



LEO:  Uh-oh.



STEVE:  This is a router from a company called Hawking, which I've actually heard of.  In fact, I use their KVM at Level 3.  It's a very nice KVM.



LEO:  I've used their antennas, actually, Hawking antennas.



STEVE:  Yes.  So anyway, this router model is the H2WR54G.  Now, the hardware version is rev. A.  The boot code is rev. 1.0.  And the runtime is version 1.08.  This will be important for anyone who has one of these routers for the following reason.  Mark was working with the router and doing some characterization.  He's got this cool Wi-Fi signal spectrum analyzer to show the power levels and spectrums and so forth.  And he was going through, turning off the Wi-Fi on routers.  And he switched off the Wi-Fi on the Hawking router using the regular administrative interface.  And it didn't turn off.  And he thought, okay, wait a minute, what's going on here.  So he disconnected the other routers' power and made sure that this was the router he was talking to.  And he turned the Wi-Fi back on.  He had it set up with WPA security, and it was working normally.  He disabled the Wi-Fi on the router.  Well, the SSID changed to Venus...



LEO:  What?  By itself?



STEVE:  And it shut down security, but not the Wi-Fi.  The router opened wide open...



LEO:  Oh, that's a hack.



STEVE:  ...with no security.  I mean, this is, you know, from the manufacturer.



LEO:  Somebody got into the firmware.  I mean, that's what you would do.  You would make it a known SSID, and you'd turn off all security.



STEVE:  Well, and the other thing is that apparently two other routers, one from StarTech and one from Edimax, they look similar.  Mark didn't test them specifically, but he's gotten very familiar with his 60 routers.  And the Hawking router, the StarTech, and the Edimax all look the same from a management interface web browser page sort of standpoint.  So I just wanted to raise a flag for any listeners who might have, again, this is the H2WR54G.  This was hardware rev. A, boot code 1.0, and runtime version 1.08.  I don't know that those are the latest.  You'll want to, if you have this router, just be aware that you don't want to turn off the Wi-Fi even if you're not using it.  Maybe, you know, you want to wrap it in aluminum foil and put it in a steel box.



LEO:  Well, unplugging it would probably be enough.



STEVE:  Well, yeah.  But you might still want to have a router, but you don't want a wireless router.



LEO:  So anyway, so this got triggered by attempting to turn off the Wi-Fi.  That's when it happened.



STEVE:  Yes.  And what it did was, you know, he went back and forth, and he verified it, he made sure - what it did was it turned off security, left the Wi-Fi on, and switched the SSID from what he had programmed to Venus.



LEO:  Wow.  That is wild.



STEVE:  So that's just so bizarre that I wanted to share it with our listeners.



LEO:  Yeah.  Did he ever contact Hawking about it?



STEVE:  No.  You know Mark, he's on to his next thing immediately.  But, you know, he immediately phoned me and said, you're not going to believe what I just found.



LEO:  That's a really weird - and this was out of the box fresh.  I mean, it wasn't like he might have got it hacked by somebody.



STEVE:  Nope.  It was out of the box.



LEO:  Weird.  Weird.



STEVE:  Next news items is there is on its way Windows XP Service Pack 3.



LEO:  Yes.



STEVE:  It's in beta now.  It's got a whole bunch of fixes, something like 1,057 or something fixes, which...



LEO:  Holy cow.



STEVE:  ...is really welcome because I don't know if you've set up XP recently, Leo.  But if you put the...



LEO:  A lot of hotfixes.



STEVE:  Oh, my god.  I mean, you put in Service Pack 2, and that brings it down to, like, 84 or 85 patches.  And you've got to do it, like, five times.  You've got to patch because the patches have patches.  And so, you know, you don't get the patch's patched patch until you've got the patch patch in.  And then it realizes, oh, there's a security problem with the patch patch.  And so it's got to patch that.  So that'll be so nice to have a Service Pack 3 that brings XP a lot more up to where we are today.



LEO:  Paul and I will be talking about this tomorrow on Windows Weekly.  But it's my sense that it's just all the hotfixes rolled up.  There's nothing else in it.



STEVE:  Yeah, I've heard that there's a couple things that are - one blurb that seemed to be well informed said that they have backported a couple things from Vista, but nothing major.



LEO:  Oh, yeah, you'll be able use the IE7 in a protected mode, I think.  Yeah, I think there were a few things.  I remember that.



STEVE:  That would be good to have.



LEO:  Yeah, yeah.



STEVE:  Also I think they did something with their networking came back from Vista, and also some kernel mode security stuff, like the crypto package was apparently enhanced from Vista.  So it's nice that the OS we actually all want to use, that is to say XP, is getting some benefit from the OS that some of us have no choice but to use, which is to say Vista.



LEO:  I shiver a little bit when I hear about Vista's networking coming back to XP because probably the most common question I'm getting these days is people who have moved to Vista, and then all of a sudden all their sharing and stuff stops working because Vista does everything so differently.  It has that new control panel, and it's just strange the way Vista works.  And I guess it'll all work that way now.



STEVE:  Well, it can't.  But certainly there would never be...



[Talking simultaneously]



STEVE:  They would never break XP by backporting something bad from Vista.  I mean, Microsoft just won't do that.  So...



LEO:  Well, it's not that it's bad.  It's actually probably good.  It's more secure.  But it causes all sorts of problems with...



STEVE:  Oh, but Leo, but if it breaks existing XP things, that would be a catastrophe.



LEO:  That's not - well, now, true, yeah, right.



STEVE:  Okay.  Lastly, our friend at VeriSign Labs, the PIP guy, Gary Krall - and for Elaine's sake that's spelled K-r-a-l-l - he dropped us a note immediately after our last episode.  You may remember we did the dark side of OpenID.  And the subject of his note was, "Yes, I was listening."  Because of course, you know, they're an OpenID provider that we've talked about extensively that is able to do both cell phone texting verification and also to use the PayPal and VeriSign's own hardware tokens, which is very cool.  And I'm going to read his letter.  I invited him to be on the show, but he said, well, they don't let us get out of the lab very much.  But he did want to bring these things to our attention.  First of all, most importantly, he said, "We do not recycle userIDs for the exact reason you state in your podcast.  If we released an OpenID identity that another user, that someone had had, then another user could masquerade as that previous user."



LEO:  Right.



STEVE:  "Once created, the account is then frozen and never released."  So this is, again, another benefit for using these guys.  If it's true, and I don't know that it's true, that any OpenID providers are recycling userIDs, remember there was some anti-OpenID blogs that I ran across that claimed that some large OpenID identity providers were recycling IDs, that's a very bad idea.



LEO:  Bad ID.



STEVE:  Very bad ID.  These guys do not, you know, VeriSign Labs does not do that.  Then his second point was just, "I'm curious to know if you've tried our SeatBelt product."  And of course we know Leo...



LEO:  I have it.  I'm using it.



STEVE:  You have it.



LEO:  Yeah.



STEVE:  "Because in addition to supporting our OpenID provider, we also support eight others."  Which I did not know.  He said two in Korea, one in Germany.  He says, "The UI has been translated into Korean, German, and French for use on those systems."  And he says, "If you go to a relying party, that is, someone that you are wanting to authenticate to, and you are not logged into the PIP, we detect this when the request comes into us.  And when the redirect hits us, we display a very nondescript page with no external linking, et cetera, that says you are not logged in.  And in order to prevent phishing attacks, we require that the user must be first signed into the PIP before they sign into an OpenID-relying party."  And he said, "To Leo's point, this allows us to ensure that the user has logged in securely with us for, in addition to having SSL throughout the site, we're also green bar-enabled," as Gary put it, supporting their extended verification certificate.  And he says, "Now, how does SeatBelt come into play?  When you have it installed, we'll detect if you're signed into the PIP or not.  When you bring focus to a text-edit field on an OpenID-relying party site, we bring up a blind which tells the user that they're not logged in, and clicking on the button will cause them to be taken to the log-in page of the PIP.  Once the user has signed in, which if they have their token bound to gives them even higher level of authentication, we'll redirect the browser back to the relying party site, and we'll populate the OpenID URL of the user into the text edit as a form-filling function."  Sort of automatically fills that in for you.  So...



LEO:  Now, if you have SeatBelt installed, which is a Firefox extension, you don't even have to go through that process.  I just went to a participating site.  It sees the Firefox plug-in and says, do you want to use OpenID?  I see you're leolaporte.verisign.com.  I click okay, I'm logged in.



STEVE:  Yes.



LEO:  And that's the beauty of SeatBelt.  It's just automatic.  Once you've logged into SeatBelt.



STEVE:  Yes.  And so I wanted to make the point that this really does solve a lot of the phishing concerns.  Certainly everything is done with SSL, and these guys are never recycling OpenID userIDs.  So, you know, those concerns that we brought up from looking at the dark side of OpenID have been dealt with by the VeriSign Labs guys.



LEO:  Excellent.  Excellent.  That's great.



STEVE:  And I have one fun and interesting new twist on some SpinRite story from a listener, Andrew Baker.  His subject was a little premature.  He said "SpinRite Halloween Success Story."



LEO:  Halloween?  Not yet.



STEVE:  He said, "Hi, Steve.  I have an interesting SpinRite story.  I live right around the corner from you in Lake Forest, California.  I have my own eBay consignment business, and I keep all my inventory at a local storage unit.  I was about to throw out some trash, and the storage people stopped me to examine the trash for any electronics because someone earlier threw away 'three old computers.'"



LEO:  Wow.



STEVE:  "In a bit of a curious state, I asked if I could see them because, if they worked, I could find them a home and would be happy to give them a finder's fee.  They proceeded to show me three Pentium 4 shuttle-like PC machines, all with sticky notes on them saying 'bad drive.'"



LEO:  Oh, man.  I see where this is going.



STEVE:  He says, "This is where the interesting part comes in.  After paying the storage unit employee 50 bucks for all three questionable machines, I took them home and whipped out SpinRite.  SpinRite fixed the drives and recovered the whole machine in every case," he says, "although I was locked out without a Windows admin password.  So I started typing in random common passwords.  After the second try, I got in.  It was their username."



LEO:  Oh, dear.



STEVE:  "I thought it was comical..



LEO:  Whoever was running this is an idiot.



STEVE:  He said, "I thought it was comical that SpinRite helped me get the discarded computer working, and how then I was able to circumvent the password so easily.  I'm an honest person, so I just wiped the drive.  In any case, it shows how SpinRite works well.  So don't let your non-working machine get into the wrong hands."



LEO:  There you go.  Good advice.  Wow.  And they threw it out.



STEVE:  Yup.  They just said, well, these are bad, so I'm going to throw them away.  And it turns out, I mean, just run SpinRite on them, and not only are they back, but of course all their data was then available.  So it was good that Andrew is an honest guy and just wiped the drives.



LEO:  Wow.  All right.  You've got - here's the problem.  Here's the situation.  You've got employees offsite.  And they need to log into the system.



STEVE:  Yes, exactly.



LEO:  Now, normally a business will set up a VPN to do that.  Right?



STEVE:  Well, yes.  A lot of businesses will use a VPN when they've got users roaming, and they want to give them access to their corporate network.



LEO:  It's kind of a heavyweight solution.



STEVE:  Well, and it turns out it's problematical.  I was at dinner a couple weeks ago, and it just happened that, out of the blue, two of the gals that were part of this group commented that they've been unable to connect to their corporate networks through their VPN.  One happened to be at a hospital, and the hospital's network was hostile, apparently, to her doing that.  And the other one was just,  you know, somewhere where they were unable to connect.  And so I wanted a robust solution.  I've seen problems, for example, even with OpenID.  OpenID is a routing-based approach.  And if the network you're in happens to have the same address space as the network you want to connect to, there's no way for OpenID to know whether the packets are intending to stay local or be routed over the VPN.



So it turns out, I mean, I've got some experience with OpenID, and I run across all kinds of problems where, nice as it is, there are situations which it's unable to deal with.  But mostly I didn't need to give Greg and Sue access to our corporate network.  And in fact I'd rather not from a security standpoint.  That's almost too much power because, well, again, from a security standpoint you never want to enable more access than is necessary.  And, for example, the way our system operates, web access is all they need.  The way we're set up now is that our corporate network knows my network range where I am in my office at home.  And it also knows Sue's router IP and Greg's router IP.  Which even though they use DHCP, and technically the IP can change, if you don't ever turn off your router, that router tends to hold the IP from your provider.



So the way our security functions now is very strong.  Only connections from my network or Sue's IP or Greg's IP have the ability to bring up any of the management pages of our eCommerce system.  So literally, we know from having talked about spoofing in the past, there's no way to spoof an IP of a TCP connection because you have to have a valid return address in order to accomplish this three-way handshaking in order to create a TCP connection.  So given a situation where you've got fixed IPs, it's pretty easy to create strong security.  You tell your firewall, allow connections in from, you know, TCP connections from this IP.



Now, when their IPs change, for example, sometimes Greg will turn off his router to let it cool off or whatever, or if he's away for a long time or there's a power outage or something, it is possible to lose the IP.  But they just give me a call, or they send me a piece of email, and their email will contain the IP of their client at this time, which will be their router's IP.  And I just edit a registry entry in our server, in our corporate server array, and they're reauthorized.  So I've solved the problem in a strong way, as long as they stay home.  But Sue would like to take a vacation every so often.



LEO:  Yeah, right.



STEVE:  And she has a need, when she's away from home, like she's on vacation, to have access to the management interface on our eCommerce system.  For example, customers often will say, hey, I'm away from home.  I'm on the East Coast; I live on the West Coast.  I desperately need access to my copy of SpinRite, but I don't have it.  I didn't bring it with me, and I don't have my receipt that has our transaction ID.  Could you look it up for me?  So, and we have all kinds of ability to do that, but only if Sue has access to the management interface for our eCommerce system, which is tied, currently tied to her IP.  So inherently, if she's out roaming around, she has no such access.



So I did look at, okay, you know, how about a VPN to her base station?  That is, allow a VPN connection from wherever she is to her machine at home.  Well, that requires that she keep the machine at home on during a week's vacation, for example.  And that's not an insurmountable problem.  But again, we still have the problem with current VPN technology being problematical.  And just to clarify, the reason that could work is if she were to VPN to home, then go from there back out onto the Internet to GRC's network.  GRC would see this connection as originating from her residential IP and would then authenticate.  So, I mean, it's sort of the solution.  And I looked at it for a while, but I decided, you know, that's not what I want to do.  I want to come up with something that is absolutely robust, and at the same time absolutely secure.



So the next thing I looked at was client certificates.  That's a technology, again, that we've talked about before.  We've talked about the normal case where a browser has sort of generic certificates that it uses for establishing SSL encrypted connections to servers.  And we've talked about this, the large and the growing number, in fact sort of a worrisome number, of certificate authorities that are now being trusted by our browsers.  And the idea there is that the web server uses a certificate to authenticate itself to the browser.  Well, it's possible to give the client, that is, the web browser, a certificate, and sort of have it present its certificate to the web server as part of its connection.  So I looked at that for a couple days.  And I decided, you know, that's got problems, too.  It's a bit of a pain to administer.  Maybe if we were a big, huge organization, and we wanted to have a certificate server that was going to be managing certificates and have people coming and going, I could see that it would make sense.  But it just sort of seemed like overkill for us.  So I was looking for something that would be simpler to use.



So I fell back to the idea of using some cookies.  Now, cookies are generally considered not secure, and for one reason is that they're sort of a stock-in-trade with browsers and servers.  It turns out, though, that it is quite possible to use cookies in a secure fashion.  There's an argument that you give to a cookie which is secure.  It was originally defined by Netscape, and all browsers honor this.  The idea is that, if you flag a cookie with a secure tag, the browser will only offer it to the matching server if the connection has been secured, that is, over an SSL connection.



So just to remind our listeners how cookies function, the idea is that a web server is able to issue a browser a cookie.  And it does so by - essentially to the web server's domain name, such that any time the web browser is asking for resources from that server, if it has matching cookies, any cookies that match the domain of the server, the browser offers them back just as part of its identification process.  So it allows the server to track the user as they move through the website by basically giving them a tag so that they're able to know that this is the person on the site.



So my thinking was, okay, falling back to this notion of secure authentication, I wanted to essentially have a multifactor authentication solution where we would have something that the user had and something that the user knew.  So I wanted to basically authenticate the laptop that Sue or Greg, or myself for that matter, would be roaming with.  And so the way to do that was to give the laptop a cookie which could not be sniffed.  I was originally concerned about, well, what if they had a nonsecure connection to GRC, like looking at non-secured pages, would that disclose the cookie?  Because I wanted to absolutely make this non-sniffable for security's sake.  Well, that's where tagging the cookie with the secure flag comes in.  No browser will disclose a secure tagged cookie.  Which is very handy for this sort of purpose.



LEO:  Well, wait a minute.  It has to disclose it to somebody.  It'll disclose it only to the originating site?



STEVE:  Well, it won't - you're right.  I'm sorry, I didn't explain that well.  It will never send the cookie back to the web server, even the issuing web server, unless it's over an SSL connection.



LEO:  Oh, okay, I got it.  Yeah, because the normal cookie policy is only send cookies back to the originating cookie setter.



STEVE:  Exactly.



LEO:  So this adds the SSL to it.



STEVE:  Yes, exactly.  If the server tags the cookie as secure, then that informs the browser never to send a cookie back unless it's over a secure connection with that server.  So essentially what this makes the cookie is non-snoopable, non-sniffable.  You do not need to worry, then, that somebody who was monitoring your traffic and sniffing the traffic would ever be able to get access to the cookie.  SSL is a good, strong, man-in-the-middle snooping-proof technology when, you know, when it's being used correctly.  And we've talked about SSL proxying and the need for a proxy to have a certificate on the client in order to have permission to decrypt the session and then reencrypt it.  So, you know, of course none of that would be in place.  So it means that just using the cookie and flagging it as secure gives us a strong means for authenticating that machine.



So in terms of the mechanics of this, the way I have it set up is - so the question is, how do you plant the cookie on this laptop?  The only way that the laptop can receive this cookie is if it is at the recognized management IP address.  So, for example, Sue has to have her laptop at home.  And when she uses the laptop to go to these secure management interface pages at GRC, the server recognizes that it is getting a connection from her home IP, and that the request for the management interface did not have this cookie present.  So if the cookie's not present, it intercepts the request with a screen that comes up and says, hey, wait a second, this machine has neither been authorized nor deauthorized for future roaming access.  Meaning that we haven't told GRC one way or the other whether this machine should have roaming access in the future.  Meaning that this cookie's not present either saying yea or nay to, if this machine is not at the management IP in the future, should it be a candidate for access to our network?



So the idea is that, for example, if a visitor brought their machine to one of my employees' homes, and for some reason Sue used it to access GRC, it would see that this machine was contacting GRC from an authorized IP, that is, one of our known network IPs, which normally gives authorization, but that this machine does not have this special GRC roaming permission cookie.  So an intercept page comes up and says, do you want this machine to have future roaming access?  Well, if this was not her laptop she would say no.  That gives it a cookie that is similarly a secure version of this cookie whose value carried in the cookie says this machine is not - if this machine ever attempts to access GRC from another IP outside the authenticated IP, don't give it access.  So that's just a clean way, basically, of identifying any machines which are ever at the authenticated IP address, to identify whether or not they should be able to have roaming access if they are subsequently not at an authenticated IP.



LEO:  So it has to be a machine that you've seen before and from an IP address you've seen before.



STEVE:  Well, actually, yes.  A machine you've seen before, which once was at - it was physically located at one of our authenticated IPs, and the person said, that is, Greg or Sue or I, yes, I want to give this machine future roaming access.



LEO:  Ah, okay.



STEVE:  So that allows the machine to carry this cookie, which is flagged as secure, which will never be exposed.  And any time they're out roaming around then and establish a secure connection to GRC, that cookie resident on their machine will be sent back as part of the query to allow them to access GRC.



LEO:  And you can say that this cookie will never expire?



STEVE:  Yes.  In fact, it is, it is a non-expiring cookie.  It is - I think I expire a non-expiring cookie in, like, the year 2047 or something.



LEO:  By then, who cares?



STEVE:  Exactly.  We'll have a whole different authentication technology by then.  So, okay.  So we've solved part one of this problem.  We've basically, you know, the three of us have laptops.  By using our laptop at our home base and going to the secure pages on GRC, we are presented with a dialogue saying, do you want to allow this machine in the future, if it's roaming outside of these authorized IP ranges, to have secure access to GRC?  We say yes.  That gives it a cookie, a non-expiring cookie, tagged as secure.  So essentially this identifies a few machines that, if they connect to GRC not from an authorized IP range, that they're candidates for having access to the privileged management interface.



Now the problem is, how do I prove that this is Sue or Greg or myself that is using the laptop?  Because essentially we've verified that this machine is authenticated.  But again, you know, I want this to be as secure as possible.  How do I prove that this is Sue or Greg or myself?  Well, the next thing that you would expect is to use a password.  And certainly many people have gone to websites where you're prompted with a dialogue box that pops up and says, you know, please enter your username and password for access to this site.  I could do that, except that we have the problem of keyboard sniffing.  We know that anything that they type into the keyboard could be captured.  Now, we certainly hope that our machines are virus-free, that there's no malware or trojan on them.  But we have seen situations, for example, in fact I've told a story in the past where Sue got the web searching, the CoolWebSearch, that's...



LEO:  Ugh, yeah.



STEVE:  Yes, yes, it was CoolWebSearch on her machine.  You know, she innocently went to some website that installed it on her version of IE, and it created a huge catastrophe.  I mean, not that it was any big problem for us, and we were able to get it off.  But in removing it, it broke her connectivity.  And, I mean, it was your typical malware nightmare scenario.  So we do know that it's theoretically possible for something bad to get onto our computers.  And we also know that something that's going to log keystrokes will be paying attention when it's logging keystrokes to a secure site.  It's like, whoa, you know, this is high value potentially.  So let's log the keystrokes and the URL and go email them off to somewhere in Russia, Lithuania, or China or somewhere.  And we'll let the evil ones who receive this figure out what they want to do about it.  So there's no way that I'm going to allow anyone to be vulnerable to known problems.  And certainly keystroke logging is a known problem.



So then I was thinking, okay, well, we've been talking about authentication a lot.  We've been talking about the VeriSign and the PayPal dongles and using that.  I've never managed to get access yet to the API from VeriSign.  And I sort of, for GRC's purposes, I...



LEO:  That's kind of overkill anyway; right?



STEVE:  Well, maybe.  I shy away from depending upon any third party.  I have an acronym that I've used.  I shared it with you, Leo.  TNO is Trust No One.



LEO:  Yeah, right.



STEVE:  And I like it because I just - I didn't want to rely on any third party for any reason.  I mean, these are the keys to the kingdom.  These are GRC's most precious jewels.  And I just, you know, I want control over this.  So I thought, okay, I need to come up with something where even if everything bad that could possibly happen is happening, we are still secure.  Meaning that, even if there was keystroke logging software installed on one of these machines, that monitoring the keystrokes is not a problem.  So I thought, okay.  That means some sort of a one-time something or other.



So my first idea was to present us, the three of us, any of the three of us, when we want to establish a session to this management interface, to present us with some sort of a puzzle, something that we know how to solve that involves data that we're given where, like, for example, we're given a jumble of numbers and letters.  And there's a rule for how we take these and reorder them or sort them or add up the digits and do the alphabetic things in reverse order or something.  I mean, the idea being something we know that, when presented with a puzzle, we uniquely have the ability to solve it.



And I thought, well, that way the server would present us with a puzzle.  And we would demonstrate we have the unique GRC knowledge of how to solve this puzzle by entering in the result.  We would never be given the same puzzle twice, so we would never be entering the same result.  So even if something were watching us, then repeating that action, which of course is the danger with a keystroke logger, repeating that action would not work a second time.  And my idea was that, after we once solved the puzzle, then we would be given a session key, that is, a session cookie, essentially.  So we have the static cookie which - and it's the presence of the static cookie saying this machine has been given permission to have roaming - potentially have roaming access.  And the presence of that static cookie would then present the puzzle.  If solved, we would then get a session cookie which, as long as the web browser is open or, for example, maybe as long we do something within an hour, that keeps the session alive.  Otherwise it expires.  And if we try to use again the GRC management interface, we'd be presented with another puzzle to verify that, you know, we are still a GRC employee.



Well, I thought about that for days.  And I could not come up with anything that worked for me.  I could not come up with any sort of a puzzle where, if you saw the puzzle, and you saw the result, it wasn't obvious how you got there.  That is, again, you have to presume perfect knowledge on the part of the attacker, that is, that the attacker will have something that is able to capture the web page and capture the keystrokes that result, and basically have the same information that we have.  And, you know, looking at this and doodling on paper for a couple of days, I could not come up with something where, I mean, I had to admit to myself, okay, if someone said what's the relationship between these two things, especially if you had several instances of that, if this malware was installed, and it was keeping track of this, where you look at three puzzles and the respective answers, where you couldn't easily yourself reverse engineer what the secret was.



LEO:  Well, I think you wouldn't get a job at Microsoft.



STEVE:  How so?



LEO:  Well, because they do those puzzles.  That's what they do in the interview.  They sit down and say, how much water is there in the world, in gallons?  Actually they don't care what the answer is.  They want to see your process.  So they probably would watch your process right up to this point and say, you're great, but then you couldn't come up with the last piece of the puzzle.



STEVE:  Well, I did, Leo.



LEO:  Oh, you see, you would get the job then.



STEVE:  I came up with something.



LEO:  But you're not going to share it with us, are you.



STEVE:  No.  We're here 50 minutes in, and...



LEO:  I knew it.



STEVE:  I'm going to leave our listeners with a cliffhanger.  I have something that I really like a lot, which is it's very cool, and it's a slick system.  I've even made the - I've implemented it.  I've written the software.  I have a whole crypto system.  And I'm making it all available to the industry for free.



LEO:  But not yet.



STEVE:  In two weeks we're going to find out about this cool solution I came up with for authentication, which is practicable, which is usable for us.  I'm going to use it in a future product of GRC's.  And I'm hoping that making it available and open and explaining how it works to our audience will encourage other people to use it.  We will be talking about it in two weeks.  And we'll let our listeners wait to learn about it.



LEO:  Aren't you coy.  See, I knew this all along.  I was just leading you on.  If you are a Security Now! fan, you can go back in time through all 112 shows, transcripts, notes, and a lot more at Steve's site, GRC.com/securitynow.  He also has 16KB versions for the bandwidth impaired, makes it easy to download.  And our license encourages you to distribute this, send it to your friends, make sure everybody hears and gets the important security news that we cover in this show each and every week.  The best science and technology podcast in the world.



STEVE:  [Trumpeting].



LEO:  [Trumpeting].  GRC.com is also a good site to go to for [SpinRite], Steve's fantastic hard drive recovery and maintenance utility; for all of his free stuff.  He gives away so much free security stuff, including ShieldsUP!.  Did I say ShieldsUP!?  I meant SpinRite in the last thing.  Now I'm talking about ShieldsUP!, which is a tester for your firewall or your router.  He also does, oh, so many other great programs.  And it sounds like he's got something new up his sleeve.  GRC.com.



STEVE:  I think our listeners are really going to get a kick out of this.  I came up with a very nice solution that is, you know, it answers my need absolutely, provides absolute, I mean, flawless security.  It allows somebody to literally be looking over the shoulder of my employees and myself, to be monitoring our connection, and it won't help them at all.



LEO:  See, I like what - I enjoy following your thought process because you really do think out of the box.  And while most people would just cobble together something existing, you like to do it from scratch.  And so there's a lot of interesting ideas in there about ways to do these things.  You really think about it, which is really neat.  So we'll find out more about that.  Actually next week we've got a mailbag episode for 114.  And then for 115 we will find out more about Roman [sic] authentication.



STEVE:  Right-o.



LEO:  I like it.  Thank you, Steve.  We'll see you next time.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#114

DATE:		October 18, 2007

TITLE:		Listener Feedback #26

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-114.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve and Leo discuss questions asked by listeners of their previous episodes.  They tie up loose ends, explore a wide range of topics that are too small to fill their own episode, clarify any confusion from previous  installments, and present real world "application notes" for any of the security technologies and issues they have previously discussed.



INTRO:  Netcasts you love, from people you trust.  This is TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 114 for October 18, 2007:  Your questions, Steve's answers.



Time for Security Now!, ladies and gentlemen, our Podcast of the Year in Science and Technology...



STEVE GIBSON:  [Trumpeting]



LEO:  ...with your host, Steve Gibson.  Mr. Fanfare, Steve Gibson.  Hey, Steve.



STEVE:  Hey, Leo.  Somebody saw the, I guess a streaming copy of me accepting the award at the Expo.



LEO:  Oh, I'll have to find it.



STEVE:  And they wrote a note saying, hey, it was really great to see you accepting the award.  And, you know, I did, you know, my acceptance was tantamount to simply thanking our listeners for making it happen, since they did.



LEO:  They made it happen.



STEVE:  Yeah.



LEO:  Well, we're glad that you won.  And I always - I'm going to, from now on, for the next 52 shows we're going to acknowledge that.



STEVE:  [Trumpeting]



LEO:  Use it all we can.  Today it's a Q&A episode, which means we've got some great questions from you, the listeners, and some...



STEVE:  Really, really good questions this week.



LEO:  Oh, good.



STEVE:  I think this is going to be an exceptionally good Q&A.  I had some time to do some research into some great questions that were asked.  And so this is, I think - I'm excited about this week's episode.



LEO:  Excellent.  Let's get to any errata from previous weeks before we get going here.



STEVE:  I have one big piece of errata.  A surprising number of people wrote to ask, not only in the feedback form, and I wanted to remind people about GRC.com/feedback, where they're able to communicate to us their wishes and desires and show ideas and questions and comments and great ideas.  In fact, we have - the last Q&A, number 12, is this week's winner of the Brilliant Idea Award.



LEO:  We're going to do one of those every week now, huh?



STEVE:  Well, whenever there is one, you know.  We don't always have brilliant ones.  But this one was just like, oh, yes, of course.



LEO:  Of course.



STEVE:  But so I just wanted to remind people of GRC.com/feedback.  The thing that we were reminded of, I was reminded of, not only here but even in our newsgroups, people were saying, hey, Steve, you promised to track down that question that a listener had, I think it was in Episode 112, which would have been of course two weeks ago, where someone said that in trying to download the virtual debit card software from PayPal, the link was broken for them.  And they later tracked it down to the fact that they were using a hosts file to block their computer's access to DoubleClick.



LEO:  Oh, yeah.  And why was DoubleClick involved in the transaction at all?



STEVE:  Exactly.  Well, and so people have said, hey, you said you were going to check back on that and let us know.  Okay, well, I did.  And it's as bad as it could possibly be.



LEO:  Oh, no.  Oh, no.  Oh, no.  Now, who did you go to to find this out?



STEVE:  I just went to the website and did a little skullduggery.  On our show notes page for this week's episode, for Episode 114, which is going to be chockful of links and goodies of all kinds, I've got a picture showing where I'm hovering my cursor over the download button.  And you can see the URL which Firefox shows in the status line at the bottom of the screen, that this is actually a DoubleClick.net URL.  So, and I want to explain the implications of this in detail.  So we're going to do a whole show about it.  Number 117 is going to be PayPal and DoubleClick.



LEO:  I suppose we should try to get somebody from PayPal to come on and explain themselves.



STEVE:  We can try.  And, you know, I've tried to use PayPal's tech support or product support in the past, and it's virtually nonexistent.



LEO:  Well, we can approach them as the press.



STEVE:  We'll do whatever we can.  But, yeah.



LEO:  I'll make a note of that.  I'll see if we can get somebody from PayPal.  Because I want to give them a fair chance to respond.



STEVE:  We certainly should hear their side.  Because I want to explain what it means when you redirect a web browser through another site because of the - I'm going to describe exactly the way information flows and, I mean, really, how frankly unconscionable this is.  I'm noticing it also, for example, when I click on links sometimes in Google, I get an almost blank page with a little link up in the upper left-hand corner that says "Click on this if you're seeing this."  And it's because I'm running with browser security cranked up, and a redirect through - I don't remember what the link is.  It's like Mediaplex or something.  It's another tracking service, and I'm being tracked when I'm clicking on just a search link, not even an ads link or Google ads or anything, it's just a search link.  And it's like, oh, well, yeah, we just wanted to keep track of you, Steve.  So anyway, I want to really talk about this in detail because it's something which is certainly a privacy concern, and...



LEO:  Yeah, no kidding.



STEVE:  ...really, really troublesome when a company that you have an account relationship with, like PayPal, is apparently allowing - well, anyway, we'll go into it in Episode 117.  And we'll make a concerted effort to see if we can get someone from PayPal to defend themselves.



LEO:  Yeah.  Wow, that's really a surprise.  I want to mention before - there's another news story that I think is quite interesting, just broke today.  You probably haven't had time to see it.  But Apple has announced that they're going to allow third-party applications on the iPhone.



STEVE:  Oh, good.



LEO:  Hallelujah.  In February.  But here's the reason I'm mentioning it on Security Now!.  Steve Jobs has a post on Apple.com/hotnews.  He says it's going to take till February because they're going to release an SDK, which means that anybody will be allowed to develop, anyway.  I don't know how Apple will certify, and I guess that's what he's going to address here.  Because he says, we're trying to do two diametrically opposed things at once:  provide an advanced and open platform to developers; while at the same time protect iPhone users from viruses, malware, privacy attacks, et cetera.  This is no easy task.  He says, some claim that viruses and malware are not a problem on mobile phones.  This is simply not true.  There have been serious viruses on other mobile phones already, including some that silently spread from phone to phone over the cell network.  As our phones become more powerful, these malicious programs will become more dangerous.  And he says the iPhone is a highly visible target, and so he wants to make sure.  I think that that's, you know, in retrospect, I've been disappointed with how slowly Apple has put third-party apps on the iPhone.  I mean, it's something we expect.



STEVE:  Well, now, there were already some hacks that were out.



LEO:  Yeah.  But you saw Apple's response, which was to delete the - to make it impossible to put third-party apps on, delete any third-party apps you installed.  And if you'd gone farther and unlocked your phone, they bricked it.  This says basically, you know, there will be a legitimate channel for putting third-party apps on the phone.



STEVE:  I'm not an iPhone user because I'm over on the Verizon/Sprint side with a CDMA link because I like to use the EVDO for wireless broadband, which is about four times, no, maybe even more, more like five times faster than the Edge network that AT&T and Cingular offer.



LEO:  But also I suspect because you like your third-party apps.



STEVE:  Well, I do have an iPod Touch because I just had to have - I had to play around with that cool touch screen interface and the latest iPod.  I'm a media guy, so I like to create video clips and carry them around.  The problem is, there's no possibility for me to enter my WPA key...



LEO:  Oh, yeah.  Good point.



STEVE:  ...through, I mean, I would like to also be able to use it a cute little Wi-Fi web browser on...



LEO:  You can on the iPhone.  You can use WPA.



STEVE:  Well, no, I mean, the iPod Touch has it.  But I can't enter my key.  Have you seen my key?



LEO:  Oh, that's right, because there's no keyboard on the iTouch.



STEVE:  Well, no, there's a keyboard.



LEO:  There is?



STEVE:  Oh, yeah.



LEO:  It's just too long for you to enter accurately?  Oh, yeah, because they show stars the whole time.



STEVE:  Exactly.  They show stars, and they want you to put it in twice.



LEO:  Yeah, no, you're right.



STEVE:  And there's no...



LEO:  And there's no cut-and-paste.



STEVE:  Exactly.



LEO:  Yeah.  That's a good point.



STEVE:  So I'm hoping that, if some third-party apps come out, there'll be something like a Notepad or something that'll give me some copy-and-paste functionality on the iPod Touch.  Then I'd be able somehow to, like, dock it and move the key from iTunes into Notepad into the iPhone, then do a copy-and-paste to get it into my WPA because, you know, I use one of my own passwords from GRC.com/passwords.  And there's no way I could type that in.



LEO:  Well, that's frankly why I use simpler, shorter passwords, to be honest with you.



STEVE:  Well, I'm just pissed off.  It's like, that's wrong that you can't - there's no way to, like - there's just no way to shoehorn a long string into that iPod Touch at the moment.



LEO:  But surely you approve of his notion.  And by the way, when he said third-party apps on the iPhone, iTouch, too.  Does include the iTouch.



STEVE:  Yay.  Okay, good.



LEO:  But surely you approve of his point of view that we want to make sure it's secure.  And I think that in a way that's admirable that they're going to do it before, upfront, as opposed to the way everybody else does it now, which is as an afterthought, security.



STEVE:  Well, I mean, he would have to - he.  They, Apple, would have to come up with something like a Java environment where the apps are running in a completely sandboxed environment.  I mean, unfortunately he's talking about a medium that viruses and malware would love to exploit.  I mean, connectivity is the way malware and viruses thrive.  And, yeah, what he's talking about doing is extremely difficult.  So it's a good thing to say, and I'm glad they have this goal.  But I think people who install third-party apps are going to have to - let's hope that they design it in such a way that there's all kind of hoops you have to jump through to manually install the app so that things like worms are not able to slip in through some back door.



LEO:  You know what he points out in the same release, he said, look, the way Nokia is doing it is you can only install an app if it's digitally signed and approved with a real certification.  I don't know if it's approved by Nokia, but digitally signed, demonstrably, something like that.  And that makes - that would be a doable - let me see.  Let me read what he says.



STEVE:  You just go to the Hong Kong Post Office and get...



LEO:  Well, traced back to a known developer is what he's saying.



STEVE:  Oh, okay.  So that would mean that developers would have to register with Apple in order to have the right to sign code that would then be obviously revocable if they didn't do the right thing and so forth.  So people would grumble that that was creating a bar to entry.  But, yes, I'm sorry, it's going to have to be - something's going to have to be done in order to keep this from just getting out of control.



LEO:  My suspicion is he's setting it up that they'll sell it in the iTunes store only, and you'll have to go through Apple's certification process to get it in the iTunes store.



STEVE:  Oh, okay.  I'll buy Notepad that way, yeah.



LEO:  I think in a way that's a good solution.



STEVE:  Anything in order to get my WPA key in my iPod, into my iPod Touch.



LEO:  Duly noted.  We need Steve's WPA.  Before we go on, do you have any SpinRite email, any...



STEVE:  I do, I have a fun short story from a guy named Stewart Leathwood, who said, "You're going to love this!"  And he said, "I work as a network support professional for a small government organization."  He says, "Because of our size, every penny is precious.  We purchased SpinRite to repair some PC hard drives, which it did famously.  But the story I want to relate to you is more unusual."  In fact, the reason I chose this is we were recently, I guess it was like in - it was two weeks ago I was answering a question about RAID and SpinRite.  And he says, "We have 1.4 terabyte Snap Server network-attached storage device we use for one-site backups.  Someone unplugged it, and the RAID array became corrupt and the disks unreadable.  So I decided, what the heck, let SpinRite take a crack at them.  I installed the IDE drives that needed repair in a PC and ran SpinRite on the corrupt ones.  It took hours, and one took days to process."  He says, "It fixed each one in turn, and I was able to rebuild the RAID array perfectly.  Thanks for saving our bacon.  SpinRite more than paid for itself."



LEO:  Wow, that's...



STEVE:  So SpinRite on a RAID array, yup.



LEO:  That just proves you can do it.



STEVE:  Yup, exactly.



LEO:  So, let's see.  I have in my hand, Mr. Gibson, 12 fantastic questions.  Are you ready to answer them?



STEVE:  They are good ones this week.



LEO:  All right.  You picked them, so you ought to know.  We should say that.  I don't pick these questions.  I'm not trying to stump Steve.  These are - and nor is Steve trying to softball himself.  These are questions that are interesting, that seem to be commonly asked.



STEVE:  Well, and they are, and many of them send me off to go do some research.  I mean, there are questions I don't have answers to.  So I go, oh, that's really interesting, I had never heard about that, and off I go.



LEO:  That's why I love doing the podcasts, and I love doing the radio show.  This is the best way I've found to keep up to date on what's going on.  Mike Vona of Carolina, Rhode Island.  I don't think there's a Carolina in Rhode Island, but...



STEVE:  That's where he said he was.



LEO:  I believe you.  Maybe there is.  I grew up there.  Gee, that's a small state.  It's not like there's hidden towns.  But anyway, wonders about UPnP and MS Home Server.  That's the new Microsoft Home Server.  I've been listening since Episode 1, and I, like many, can't get enough, says Mike.  I recently started listening to Windows Weekly.  I'm enjoying that, as well.  My question stems from a recent episode of Windows Weekly, Episode 31.  But he wants to ask you because UPnP comes up so often.  In this episode Paul and I were talking about Microsoft's Home Server, and that it now uses UPnP.  In fact, to work it needs UPnP turned on in the router.  In fact, I've seen, Steve, just parenthetically, a number of articles saying is Windows Home Server really secure?  Are we going to let, you know, this seems a little risky.



STEVE:  Oh, yeah.



LEO:  Mike says, I'll cave in to this.  I know Microsoft has had their way about them, that it either is their way or  the hard way.  But couldn't you enable UPnP while the server is configuring what it needs, and turn it back off?  Once something in the router is set via UPnP, is it not permanent, even if the router restarts and power cycles?  Okay, this is actually a general question, not just having to do with WHS here.



STEVE:  Right, although, well, okay.  There's a couple things.  First of all, one of the most distressing things about Universal Plug and Play for router control is that most user interfaces do not show any of the configuration which has been done through the Universal Plug and Play interface.  To give our listeners a little bit of background - although I harp on this all the time because it just scares me to death, and I'll just bet you we're waiting to see some real abuse of this pop up.  The idea is that the router presents a server to the internal network.  And the way Universal Plug and Play protocol is designed, it's possible for any computer on the local area network to send a broadcast out saying, hey there, I know about Universal Plug and Play.  Who wants to play?  And all the devices that are supporting Universal Plug and Play get the IP address of the machine that sent out this broadcast question.  And they say, hey, I know about Universal Plug and Play.  Hey, I know about Universal Plug and Play.  And so essentially it allows the network to discover itself.  It's handy because one of these days Sears is going to be offering a Universal Plug and Play refrigerator, and you plug it into your network or just raise the antenna in the back.  And it'll be part of your network.  And so the concept is that it's a self-configuring network.  My concern is, when your neighbor is able to hack into your refrigerator...



LEO:  Put some malware on it.



STEVE:  ...that can be a problem because Universal Plug and Play in the first incantation - which is all we have so far, although I have heard that there is a second generation on the way that apparently adds security.  But in the first incantation there is none.  So there is no way to prevent malware from having access to, in this case, literally the entire configuration of your router.  It can do anything it wants to with your router with Universal Plug and Play turned on.  And because the configuration changes made, like creating static port mappings back from the outside into your network, do not show up in the user interface, you could be a responsible administrator of your router, look to see on those administrative web pages that the router publishes what's going on, and see nothing, even while there is static port mappings that have been created by the Universal Plug and Play interface coming back into your network.  So it's a concern.



Now, the good news is, and the reason I wanted to specifically address this question relative to the Microsoft Home Server, is in fact it only needs, that is, Microsoft's Home Server only needs three ports mapped through the router, and in fact may be able to get away with only two.  That is, it is a web server, so it needs port 80 and port 443 mapped through.  It also needs what they call a "Remote Desktop Proxy" port.  Now, Remote Desktop, as we've talked about it in the past, normally runs over port 3389.  But in this case the Home Server runs a proxy for that, meaning that it's receiving these requests for the outside and then is relaying them internally to within your network to other machines, for example, or the Home Server itself, that may have, in fact has to have Remote Desktop running on port 3389.  But the proxy runs on 4125.



So you do not need Universal Plug and Play enabled at all.  And again, you know, for all the reasons I've just finished talking about, I strongly recommend that people don't enable Universal Plug and Play.  However, you can manually administer that port mapping.  Simply send ports 80, 443, and 4125 to the IP of your Home Server running on your network, and you're good to go, with the strong caveat that here once again we are exposing Microsoft servers, that is, Microsoft services, to the public Internet.  And I don't think there's ever been a Microsoft service that didn't have horrible security vulnerabilities, at least initially.  I mean, even their web servers, their commercial web servers, IIS had horrible problems with them.  And all of the services that Microsoft has traditionally exposed through Windows have had problems, which is why only after we got the firewall running in Windows Service Pack 2 of XP did all these problems quiet down because now they were - those services were hidden behind a firewall.



Well, what we have to do, and if we're going to expose this Home Server to make it available on the Internet, is break that rule and make those services available.  So it's something to be aware of.  But at least you don't have to have Universal Plug and Play enabled if you do want to use Windows Home Server.



LEO:  And did you - I'm sorry if I missed it, but did you answer the question, with UPnP, if you enable it during configuration, can you then disable it and have all those ports now be open that UPnP is opening?  Or does disabling it turn off all the ports that it's configured?



STEVE:  Disabling, well, again, this does vary with routers because unfortunately one of the things that Mark Thompson, my buddy over at AnalogX, found out - remember he had 60 routers that he was messing around with recently...



LEO:  One of which renamed itself to Nadine or something, but that's...



STEVE:  Venus.



LEO:  Venus.  That's another story.



STEVE:  Yes.  He has discovered a huge variation in the behavior of Universal Plug and Play implementations.



LEO:  I see, I see.



STEVE:  Part of it is that it's not a mature, well, there hasn't been time to mature the implementations.  it's a new spec.  A lot of routers rushed into having, oh, yes, we support Universal Plug and Play, too.  So there's a huge variation in behavior.  So it's impossible to say this is what Universal Plug and Play does.  And specifically things like, what if I disabled it once some mappings have been made, do they remain, that's nowhere in the spec.  Nothing talks about how the router should even behave in that case.



LEO:  So it's unknown.



STEVE:  Exactly, it's undefined.  So you could try it and see how it works.  What will typically happen, however, is you disable the interface, and those mappings will remain until you reboot or recycle the power on the router, in which case then they are lost because they're not typically written into the firmware in the same way that your static configuration changes are.



LEO:  Although I should point out that some routers, like my D-Link, you can save the configuration.  And probably that would be the way to do is save it, and then when you reboot you can reload the configuration.



STEVE:  Can you save the Universal Plug and Play configuration?



LEO:  Well, I mean, it says you could save - I presume it would save port forwarding that you'd done and that kind of thing.  That's a good question.  I don't know.



STEVE:  Yeah, I think probably not.



LEO:  Oh, it wouldn't, okay.



STEVE:  Because it is regarded as sort of a software, sort of a dynamic, you know, the application opens the ports while it needs it.  One would hope, for example, that when you shut down Windows Home Server, it would know to turn that forwarding off.



LEO:  Oh, yeah, right.



STEVE:  So, uh-huh, so that it closes the router down again.  It's just a bad thing.



LEO:  Yeah, yeah.  Well, and this is the problem.  What's happening is people are being asked to do things that sysadmins did only a few years ago.  You're running a network.  All of a sudden you're doing very high-end network configuration stuff.  And a sysadmin would lock it down and do it all by hand.  But in order to make this stuff user-friendly so that any nitwit can have a home server, they're doing things like plug and play, Universal Plug and Play.  But then, of course, that's not the safe way to do it.  So I see the issue.  They want to make it accessible.  But there are some things maybe that shouldn't be accessible.



STEVE:  Well, and it would be one thing if Microsoft had a perfect security record.  Dot dot dot.



LEO:  I have to say they're getting better.  We haven't had any major issues with Vista in a year.



STEVE:  Because the firewall is always on.  I mean, no one even knows if Vista's services are vulnerable because there's no point in poking at them because they're hidden behind a firewall.  I mean, it really is the firewall...



LEO:  Boy, that was simple.



STEVE:  The moment that got turned on by default, everything changed.



LEO:  It was so simple.  Something we should have done years ago.



STEVE:  I asked them to, but...



LEO:  Justin Van Viersen from Perth in Western Australia wonders about supernodes in Skype:  I'm presuming that, when you forward a port through your NAT router to Skype, you are opening up Skype to become a supernode.  Is this correct?



STEVE:  Okay.  What Skype supernodes are is it's the way Skype deals with its inability with some NAT routers to establish a direct connection.  For example, I have a very bizarro, nonstandard NAT facility at my end of our connection, Leo.  So I've had to establish a static port forwarding through my NAT router, which is exactly what we were just talking about in the case of Windows Home Network Server, in order for you and I to create a direct link between our machines so that we get this really nice, high-quality Skype connection.  Without that, what can happen is that we know that NAT routers are able to initiate connections outbound.  That's the whole point.  In order for Skype to work, we need two people, both behind a NAT router, need some way to link through their NAT routers.  When that's not possible, Skype finds some other Skype user somewhere out on the Internet and says, okay, we're going to make you a relay, that is, a so-called supernode.  In which case, both of these users behind NAT routers that are unable to establish a direct connection, they both call out and establish connections to this third party, to this so-called "supernode."  And it acts as the relay for their traffic.  Well, many people consider this objectionable, and I certainly don't blame them.  It was one of the very controversial and annoying things about using Skype.



LEO:  Well, Skype is peer-to-peer technology, and that's how it does it.  I mean...



STEVE:  Exactly.  The good news is, because of concerns, ever since v3.0 the Windows version of Skype has a registry editable setting that disables its use as a supernode.  So it is possible to tell your Windows version of Skype, under no circumstances are you allowed to be a traffic relay.



LEO:  Now, let me ask you a question because it's my understanding, as you said, supernodes are really used to provide NAT traversal.  In order to be a supernode you have to be on an open IP, a public IP.  You can't be behind a router; right?



STEVE:  That's probably the case.  And I think that's why Justin's question was...



LEO:  It doesn't really come up.  You don't even have to do this registry modification if you have a router; right?



STEVE:  If you're behind a router, then, oh, I'm trying to remember whether...



LEO:  It's my understanding - and you know what, Skype is not very clear about this.  But it's my understanding that you have to be on an open IP address, unprotected IP address.  You can't be behind...



STEVE:  I don't - I'm not sure that's the case because many NAT routers do behave themselves.  And as long as the - and, you know, we've talked about NAT traversal before.  There is some behavior in a NAT router where its natting is predictable.  And so it could certainly be the case that even somebody, even a supernode behind or a version of Skype behind a well-behaving, easily traversable NAT router, it could accept incoming connections from people behind two non-NAT-compatible routers.



LEO:  But remember, they're looking - what Skype, the Skype network looks for is - it's a small set of supernodes.  They're not - not everybody becomes a supernode.  And according to the research I've read, generally it's somebody who has a lot of bandwidth, although it doesn't take a lot of bandwidth to be a supernode, surprisingly, because you're really - you're not transmitting the data; right?  You're just providing a handshake.



STEVE:  No, you're relaying all of the actual conversation data.  Because that's what you have to do.  The Skype server itself is able to perform NAT traversal handshaking in order to negotiate a connection between well-behaving NAT routers.  You're actually the supernode.  And, see, that's why the connection quality drops so badly is suddenly your jitter goes up, your latency goes up, because all of your actual conversation traffic is being relayed through the supernode, and it can be a lot of bandwidth.



LEO:  But remember, they're using a lot of supernodes to distribute this.



STEVE:  Yes.



LEO:  So you're not taking a whole call necessarily.



STEVE:  The other thing anecdotally I've heard is that, if you disable the setting for starting Skype up at boot, that also disqualifies you as a supernode.  Which I...



LEO:  Because they want you to be on Skype all the time for it to work.



STEVE:  Well, exactly.  They want to assume - they want to know that your Skype is going to be generally available for supernode status.  So again, I don't know this for sure, but anecdotally the reports of people that have looked at this closely say that, if you just turn off the autostart in Skype, that that'll do the job, too.  But certainly if you're under Windows and you're using a Skype from v3.0 on, it's possible to disable that.  I've got the information on the show notes for this episode.  So anybody who - and I would recommend, unless you enjoy the idea of having other conversations relayed through your bandwidth, you may very well want to disable, especially our listeners who are privacy and security aware, may want to disable their handling of other people's conversations.



LEO:  I have to send you a link to a study of Skype.  See, apparently Skype doesn't really document this.  They don't want anybody to know their secret sauce.  A study done by a guy at Google, couple of guys at Google and a guy at Cornell, basically an experimental study of how Skype works.  And they talk a little bit about bandwidth consumption as a supernode and so forth.  It's a little dated.  It's from 2005.  But I think it probably gives you a good idea.  See, nobody knows, so you just kind of have to test it.  And they did a long-term test of how Skype worked.



STEVE:  Well, and one of the differences between Google and Skype is that Google will itself relay its users' traffic, and there is no notion of, with Google Talk, of a third-party supernode being asked to carry other people's traffic.  Google's server does that itself.



LEO:  Well, these guys point out the Skype founders came from Kazaa.  That was their previous product.  They understand peer-to-peer.  And Skype was really designed from the ground up to be a peer-to-peer Voice over Internet.



STEVE:  Yeah, and it's free.



LEO:  That's why it works.  That's why it works.  So we now - what we do, and your recommendation is, use a dedicated port.  Will that prohibit us going through a supernode?  Will that just give us a direct connection?



STEVE:  Well, and see, that's exactly what Justin was asking.  He says, when you forward a port through a NAT router, the way you do that is you say I'm going to forward this port from the outside in.  And then you tell Skype to listen on that specific port.  And so that would clearly enable it to be a supernode because it would mean that anybody could connect to it.



LEO:  It's now public, right.



STEVE:  Yes.  And since you've configured your Skype client to operate in this fashion it's certainly able to disclose its configuration to Skype Central and open you up for being a supernode.  So again, I don't know that that's the case.



LEO:  So maybe I should turn that off.



STEVE:  Well, the other thing, Leo, is I'm betting - well, first of all, I don't run Skype at startup.



LEO:  Nor do I.  I turn it off unless we're doing this.



STEVE:  Yes.  And so if it's true, and this was a - there was a study done by the guys at University of Waterloo in Canada that said - the CS department did some real looking at this.  And they said when Skype is not running on startup, it does not adopt supernode status.  So that's an easy thing to do.  And again, in Windows we've got a registry tweak that will disable it for sure.  But certainly it's the case, and this is why Justin asked the question, that if you did do static port mapping, anybody could connect to you incoming, and it would sure seem like it would qualify you otherwise for supernode status.



LEO:  Here's a quote from 2003 from Nicholas Zennstrom, one of the principals behind Skype and also of Kazaa.  And he said, without being too technical, each Skype client is always connected to a supernode.  That surprises me.  Any Skype client could become a supernode.  The supernode is acting as a hub.  Supernodes are always on routable, open IP addresses.  When a call is set up, the established TCP connection with the supernode is used to signal that a call is coming.  Dependent on the firewall status of the client, the data stream is set up either as UDP, if the firewall allows, or in worst cases as outgoing TCP, which is almost always allowed.  And we've talked about why UDP is better than TCP for this kind of stuff.  If both clients are only allowed to do outgoing TCP calls, they're routed through another peer.  I don't know if that says anything or not.  They don't talk a lot about how it works, that's the funny part.



STEVE:  Well, and right off the bat, the first statement the guy made is wrong because you and I, I mean, I've looked at our traffic.  I've run a packet sniffer on our connection.  And there is...



LEO:  There's no supernode there.



STEVE:  There is absolutely nothing.



LEO:  There might have been for signaling, though.  He's saying, remember, every VoIP call has two parts.  There's the data carriage, but there's also the ring, the signal.  And they might use a supernode for signaling.



STEVE:  Except that Skype Central is the one that manages presence, as it's called, does the presence management for all their...



LEO:  We knew that because, when Skype was down, so were we.



STEVE:  Exactly.  It's not like lots of little supernodes kept the job going, so.



LEO:  Maybe he was being disingenuous.  Finn, located somewhere in Sweden, asks about Amazon's S3 service and Jungle Disk.  S3's amazing.  That's Leo saying that.  I finally decided to check out some offsite backup solutions for documents, pictures, et cetera.  Amazon's S3 seemed like a good, well-known option for long-term storage.  I chose Jungle Disk as a front-end GUI and backup software.  Security-wise it all seems pretty good.  The authentication to Amazon uses SSL.  And when backing up, all files are encrypted on the fly with AES 256-bit encryption.  But the question one has to ask, is this really safe?  In an end-to-end connection manner I frankly don't care as long as the files are stored okay.  But the issue for me is trust.  What's your take on trusting a company with your precious documents in the long run?



STEVE:  Well, first of all, Leo, tell us about Amazon S3.



LEO:  It's a really neat service, a storage service that Amazon inaugurated a couple of years ago.  It's just pennies a gigabyte.  It's very affordable.  You can find out about it by going to Amazon.com/s3.  S3 stands for Simple Storage Service.  It was originally, I think, intended for developers.  But anybody can use it with the right interface.  I use it for storing - exactly how Finn is using it, as a backup solution.  15 cents per gigabyte per month.  Data transfer is 10 cents per gigabyte.  But it goes down the more you use it, obviously.  There are a lot of people developing for it.  And, you know, a lot of developers use it.  For instance, I'll give you an example, Pownce.  Leah Culver, who developed the great Pownce system, which is kind of a Twitter-style microblog, uses S3 for all her database storage.  It's reliable.  It's fast.  Because it's Amazon they've got a lot of servers running.  It's asynchronous, and it's relatively cheap for that kind of storage.  So, and then Jungle Disk is just a GUI interface for it.



STEVE:  Well, actually Jungle Disk has something in addition to that that I like.  First of all, everything you just said I completely agree with.  We've got an episode scheduled before the end of the year on this issue, on Amazon S3 and Jungle Disk.



LEO:  Oh, good.  Oh, great.



STEVE:  Because I want to really understand, and I don't yet from looking at the data that I've seen, if it qualifies as what I call TNO.  You know, that's one of my favorite new acronyms.  TNO stands for Trust No One.  There are different reports from Amazon's tech support about whether or not they can perform lost key recovery.  So the question is, I mean, I absolutely love the idea of very inexpensive off-site storage.  And in fact, if I determine - and one of the reasons I want to do the research and share it with our listeners is, if I determine that this is true TNO, then I will absolutely sign up and subscribe.  I mean, the pricing seems very reasonable.  I would love this as a means for, like, moving all of my source code and project work and, you know, basically the crown jewels off-site.  The other thing you get is you get, because it's centralized and it's Internet based, then if I'm roaming around with my laptop, I have access to that archive which is centrally located and is distributed and backed up and secure and all the good things you want in a robust off-site backup.  But I want to absolutely know that no one can be sniffing on my data.  Not only do I need a secure connection, which I'm sure is part of this, I know that already, that I verified.  But I want to know that Amazon under no circumstances has the keys to decrypt the data that they're storing for me.  This needs to be absolutely opaque from their standpoint so that there's no way for them to perform key recovery.  I need to take responsibility for making sure I don't lose my keys.  And if I do, I've got to be up the creek.



LEO:  Well, here's my question.  Is Amazon doing the encryption, or Jungle Disk?  If Jungle Disk, which is not from Amazon, it's a third-party client, encrypts the data first, then uploads it, and that's my impression of how Jungle Disk works, using an AWS, it says - oh, I see.  You can use an AWS secret key, which Amazon would know, or using your custom encryption key.



STEVE:  Yeah.  And we need to understand what that's about. There's some dialogue in their forums where they talk about, I mean, which is encouraging, where they talk about if you were to change your key, then you wouldn't be able to read any data that you had stored before.



LEO:  Just like any encryption key; right?



STEVE:  Well, but they have this notion, which I really like, of previous keys.  So apparently you're able to update your key, and you move the current key into an old key repository.  And if it sees that it's unable to decrypt the data stored with your current key, it checks your previous keys and sees whether any of them are able to read the data.  So it's really positive looking.  But the one thing I wanted to mention about Jungle Disk, just our listeners know - although, again, I haven't yet vetted them, I need to do this, and I'm going to - is that it creates - and I should also mention it's only $20 at the moment, and it's available in all three major platforms:  Windows, Mac, and Linux.  They even provide you with open source, their own open source that allows you to browse and download your software, I mean, they're really opening the kimono and saying, look, this is how we're doing this.  We're hiding nothing.



But the coolest feature from my standpoint is it looks like a local drive.  And what that means is I'm able to still use something like my own favorite backup program, it's called FileBack PC.  And what I like about it is that it's incredibly sophisticated in terms of the rules I give it, in terms of, like, versioning.  I can tell it that I want 25 back copies of source files, that is, anything .ASM, you know, for Assembly language.  But I want no more than five of them kept per hour, and no more than ten a day.  And this thing manages all that for me.  And so, if literally, if it turns out that Amazon's S3 service, coupled with this very reasonably priced Jungle Disk, works and is secure, then I could literally tell FileBack PC that the Q drive is where it's supposed to maintain its archive, and all of this would be done offsite for me transparently.  So...



LEO:  This is done using WebDAV.  And frankly there are many WebDAV interfaces to S3.  So if you wanted to roll your own using TrueCrypt and WebDAV, it wouldn't be such a difficult thing to do, either.  So if you don't trust Jungle Disk, do it yourself.  I mean, Jungle Disk isn't open source, so you can't be sure what they're doing with that key, I guess.



STEVE:  They really seem like good guys.



LEO:  They do seem - everybody's using it now.  But again, Jungle Disk isn't required for S3.  S3 is just a service.  Jungle Disk is a commercial interface to that service.  But you can roll your own, absolutely.



STEVE:  Exactly.  And in fact S3 is sort of a UI-less service.  It's a backend data storage facility.  Although apparently there is some key management that they do.  I just need to understand what it all is.  And we're going to do a show to describe it in detail so we'll know how secure it can be.



LEO:  You have to get - to use S3 you have to get an Amazon Web Services key.  And that's a simple application process.  And if you just use that, obviously they can recover that.  So that's like a password, basically.  So, yeah, I think, you know, I'm looking at a page, Elastic8.com, where they have free tools for Amazon S3.  And it's a couple of pages' worth.  There's a ton of good choices.  It's just that Jungle Disk is so easy.  That's why...



STEVE:  Well, I mean, I just love the idea that it looks like a virtual drive.  There may be other solutions that do.  But again, the guy that asked the question, Finn in Sweden, he aimed me in that direction.  It's like, hey, you know, this would be very cool because it looks like a virtual drive, which means my existing backup tool could be told, not only keep a copy on my central RAID array and keep a copy remotely on our Level 3 servers where I do now, but also stick it off in Amazon.  As long as it's really encrypted and they can't get to it, I'm really comfortable doing that.



LEO:  Brad Fitzpatrick wrote, and I use this actually for our web server, a Perl script that encrypts and then backs up automatically as a cron job to S3.  And that's what I use for my backup.  And that's really a great, I mean, that's - if you're running a web server, that's the kind of thing you want.  Just kind of happens every day automatically.



STEVE:  Nice.



LEO:  Yeah, very cool.  You do have to make sure you delete some of the older backups, or you really fill it up fast.



Chris Noble in Wellington, New Zealand wonders about a specific authentication scheme.  Are you ready?  In Episode 113 - yes?



STEVE:  Yes.



LEO:  You are ready?



STEVE:  I'm ready.



LEO:  I don't want to go too far unless you're ready.



STEVE:  I was born ready, Leo.



LEO:  I heard that.  In Episode 113 you mentioned the risks of having a keylogger on one of your staff members' laptops - we were talking about remote authentication and how to do that right - thus making a password login via the keyboard potentially risky.  What about a solution like that used by F5 Networks for their FirePass remote access solution?  It's a little graphical virtual keyboard on a login page.  You don't use your keyboard.  You click the letters on the screen to enter a username and password.  The key thing is - no pun intended - the keyboard randomly jumps around the screen after each mouse click.  Oh, this sounds so annoying.



STEVE:  So you're chasing it around.



LEO:  Oh, Jesus, it's annoying.  So that not even a mouse logger can log the pixel position of the click on the screen for use again later.  This sounds like a good way to do it.  In a way, this is providing a one-time unique entry process - it's a good point - for something the user knows, as opposed to the same entry process via password text in a form, a field in a form.  I'm interested in your comments on this form of logging in since it doesn't use a keyboard.  It is immune to keyloggers; right?  And it's also used by the company I work for to gain remote access.  How interesting.  Boy, that's secure.



STEVE:  Well, it's an interesting idea, and I wanted to bring it up because this relates to the topic we're right in the middle of discussing which we opened last week and we're going to finish with next week, and that is the simple but straightforward and very secure approach I developed for allowing GRC employees to have secure roaming access to GRC.  And some of the questions at the end of this show are specifically about that, sort of as a lead-in to next week.



But the problem here - first of all, this is better than, for example, an onscreen keyboard that did not jump around.  But the test is having somebody know absolutely everything about what you're doing.  That is, it does sound like the password that the person is clicking on is the same every time.  And that's the weakness of this system.  Even though the keyboard's jumping around, the presumption is, I mean, the high bar that we set is an attacker would have full information of what you're doing.  And that would mean they would be able to see the screen and figure out what it was you were clicking on, and then reverse-engineer the password so that they'd be able to click on the same password, even though it would be occurring in different locations on the screen.



So, yes, this is better, certainly, than having a static onscreen keyboard.  And obviously someone is concerned about the mouse click positions being recorded.  That's what this is designed to bypass.  But it still suffers from the weakness that the same password text is being entered each time.  And that weakness is something that can be avoided.  And that's the topic for next week's Security Now! episode.



LEO:  Ah ha.  Iain Cheyne in London was shocked - shocked, I tell you - to learn of the importance of the Firefox Master Password.  Did we talk about that?



STEVE:  I don't think so.



LEO:  He said, I had no idea - I use it.  Now I'm worried.  I use it.  I had no idea about this potential problem with Firefox.  You should tell people about it.  He now quotes a page at Ghacks.net.  Make sure you set a master password, it says, in Firefox.  I presume you have read this page and have something to say about it, Mr. Gibson.



STEVE:  Indeed I have, my friend.



LEO:  So let me just mention, the Master Password at Firefox I use because Firefox will remember passwords for you.  And you can say, on that page where you turn that on, use a Master Password.  And unless you enter the Master Password, nobody can then log into those pages without it.



STEVE:  Actually it's a little bit worse than that, and that was what Iain wanted to bring up, and the reason I wanted to share it with our listeners, is to make sure that people are aware that, if you use Firefox's remember-this-password or username and password for the site feature, if you use that, anyone can come to your copy of Firefox and click on Tools and then Options, and then click on Show Passwords, and Show Passwords again.  You are then prompted with an "Are you sure?" dialogue box.  If you click Yes, it then shows you, in the clear, the website URL, your username and password, right there in the dialogue box for anyone to look at.



LEO:  Well, there you go.



STEVE:  And of course he makes the point that, if you reveal all your passwords to someone, or, that is, inadvertently do so, they could look at, oh, look, it's always the same.  Shame on you.  Or it's like, oh, look, here's how they're coming up with passwords.  I mean, they could reverse engineer your password scheme if you had taken our advice from, I don't know, Episode 2 of Security Now!, whenever it was we were way back then talking about a personal password policy or procedure or whatever, protocol, in order to figure this out.  So I thought it was worth bringing up.  What Iain was saying was that it is, for the privacy of your passwords, you really need to set that Master Password on Firefox, or anyone who comes along can see what your passwords are.



LEO:  And in fact I'm looking at it right now, and I see - because I turn it on, I had to enter it twice before I could see the passwords.  And that's good.  In fact, it's a little bit of a pain.  You might be tempted to turn it off because every time you launch Firefox you have to enter that password.  But I think that's a good thing.  So that's good to know.  All right.  Good thing to mention.  I should mention that...



STEVE:  Yeah, and in fact I think that it is exactly for that reason, the fact that you launch Firefox, you've given Firefox the ability to log you into websites.  You definitely want Firefox to harass you for the password to prove that it's you sitting in front of it.



LEO:  Because I do.  I mean, I let it log into everything, all my secure sites, my banking, everything.



STEVE:  But it doesn't know it's you.



LEO:  Not unless I tell it.  Nathan in Huntsville, Alabama wonders about online password storage:  I've been very interested in a password management solution for a while now.  I even started building my own server-side program so that I could access my passwords everywhere.  Oh, boy.  But instead of reinventing the wheel, I thought I'd look around the tubes, see what I can find.  I found something pretty interesting.  It's called Passlet, Passlet.com.  As far as I can tell, all the data between the browser and server is encrypted, as well as the data being stored.  As a user I'm encrypting that data on my end, then sending it to them.  The only problem I could see would be a hack into the server, a change of Java code.  I'm just wondering what your thoughts on this might be.  Passlet, is it safe?



STEVE:  Well, it's an interesting idea.  It looks to me like these guys have done a good job.  They have an FAQ where they understand the risks.  One concern is that they're using JavaScript running in the browser in order to perform the encryption.  It's like, well, his concern was could someone hack their server to change the JavaScript so that the code you're running essentially on your client is no longer doing what they intended it to be doing.  And so, yes, that's definitely a vulnerability.  So but otherwise they're encrypting on your browser, on your client, so that all of their storage is encrypted.  And it's encrypted through the connection, although it also insists on being an SSL-secured connection.  So that looks pretty strong.  These guys look like they're doing a good job.



Now, one thing that they're not doing is they're not protecting, that I could see, from the possibility of a keystroke logger on people's machines.  And for what it's worth, Leo, I actually, in the email that I read from our listeners, I hear a surprising number of confessions from people who have found keystroke loggers on their machines.  It seems to me this really is a problem.



LEO:  Well, it's one of the things, one of the three or four things spyware often does, or adware or whatever malware often does.



STEVE:  Malware, yes.



LEO:  Hmm.



STEVE:  So there are a number of web-based services that are doing this kind of work.  I, and we're going to talk about it next week, have a solution for the keystroke logger problem.  And in fact I've already written to the Passlet guys and said, hey, guys, I've got this solved, I'm making all the code public, and the whole system is public.  Maybe you want to take a look at it as a way of further strengthening the login to your facility.  Because, of course, anyone who then logs in has access to all of the keys to the kingdom.  And you want to make sure that that, you know, any time we consolidate all of our information in one place, just like using Firefox to store our web page login, we're consolidating all that in one place, we really have to make sure that the entry to that is as secure as it can be.



LEO:  You know, I should ask you as a follow-on, I use a thing from Zarate.org called SuperGenPass.  And what it is, it's a JavaScript bookmark that sits on your browser toolbar, and it does a hash of a master password which you give it.  And you can either give it to it and have it store it, or for more security you can type it in each time.  And then it will hash together your master password with the site's domain name to create a unique password for that site.  And it's a good password.  It's long, and it's got all sorts of a goobledy gobbledy gook in it.  I wouldn't try to remember it.



STEVE:  We know that's what a good password is.



LEO:  But the beauty of it is you don't have to remember it or even store it anywhere because you can generate it again as long as you remember your master password.



STEVE:  I think that's a very good solution, Leo.



LEO:  I use that, not for my banking, but I use that for semi- you know, sites like The New York Times or whatever.  And that seems to work pretty well.  Google "SuperGenPass," one word, and you can find that easily.



Nathan in - oh, I already did that one.  That's the Passlet one.  Let's go on to Kerry Merritt, who wonders about VME encryption:  Have you guys heard of VME, victory marvelous encryption?  I just made that up.  I would just like your opinion on it.  Their site is Meganet.com.  They claim a million-bit key using a matrix created by a secret file, and then the program can be set to use a configuration file to change the type of matrix that is created.  If you could, would you give us a quick thumbs-up or thumbs-down on it?  I have it, and the configuration tool they have offered all kinds of stuff like a million dollars to anyone who breaks it.  I always get worried when somebody offers a million dollars to anybody who breaks something.



STEVE:  Well, Meganet.  So I go over to www.meganet.com.  And they've got seals and certificates from the various government agencies and all kinds of FIPS qualifications and certifications and all this.  And I go, okay, what?  And one of them was a mention about a patent.  So I thought, oh, that sounds interesting.  So I click on that link and go over to a patent site.  Filed almost exactly 10 years ago, on October 24th in '97, so in a couple weeks it'll be 10 years ago.  And the patent was granted on April 17th of 2001.  Would have been maybe more fitting if it was granted on April 1st.  But it's an honest-to-God patent.  It's Patent No. 6219421.  And the patent, the abstract at the beginning of the patent, this is worth sharing with our listeners, says a data security method and apparatus that provides an exceptional degree of security at low computational cost.  The data security arrangement differs from known data security measures in several fundamental aspects.  Most notably, the content of the message is not sent with the encrypted data.  Rather, the encrypted data consists of pointers to locations within a virtual matrix...



LEO:  Oh, how weird.



STEVE:  ...in a large, arbitrarily large, continuously changing array of values.  The encryption technique is therefore referred to as Virtual Matrix Encryption.



LEO:  That's the VME.



STEVE:  There you go.  Furthermore, the data security arrangement uses a very large key of one million bits or more, which creates a level of security much higher than any other existing method.  The key is not transferred, but is instead created from a file of any size that is available on both the computer used to send a secure message and a computer used to receive a secure message.  The term "virtual key cryptographic" is used herein to refer to techniques in which a key is recreated at a remote location from an electronic file without any transmission of the key itself.  The file may be a system file, a file downloaded from the Internet, et cetera.  A smaller transaction-specific key, e.g., a 2,048-bit key, is sent end to end and is used in conjunction with the very large key to avoid a security hazard in instances where the same file is used repeatedly to create the very large key.  So, you know, decoding this, it sounds like you refer to some third-party file somewhere.  From that file you somehow create this virtual matrix.  And then the act of encrypting is finding strings in this virtual matrix.  And then you only send pointers to the strings, rather than pieces of the file, and that's how this thing works.



LEO:  Like a code book, but it's generated anew each time, kind of.



STEVE:  Yes.  Now, the problem is, we don't need new encryption.  And that's sort of where I immediately fall back to is, wait a minute, this problem has been solved.  We have solved the encryption problem in an absolutely robust way.  But, and I just sort of had this weird sort of queasy feeling about, you know, this doesn't sound like it really makes that much sense.  I mean, it sounds like there's - if you use real cryptography, this thing would not stand up at all.  Well, so I did a little bit of web searching, and not much, in fact.  I put "virtual matrix encryption" into Google.  And the first link that came up was by our friend Bruce Schneier, who is actually a cryptographer, who is the author of Blowfish, a still state-of-the-art, robust, never has been a weakness found in it, cipher.  He wrote in February 18th of 2003 the following, which is just a perfect synopsis of sort of this notion of let's just have noncryptographers invent virtual matrix encryption.



So on February 18th, 2003 he says, "Back in 1999" - so four years before this - "I wrote an essay about cryptographic snake oil and the common warning signs.  Meganet's Virtual Matrix Encryption (VME) was a shining example.  It's now four years later, and they're still around, peddling the same pseudomathematical nonsense, albeit with a more professional-looking website.  I get at least one query a month about these guys.  And recently they convinced a reporter to write an article that echoes their nonsensical claims.  It's time to doghouse these bozos once and for all.



"First, an aside.  If you're a new reader, or someone who doesn't know about cryptography, this is going to seem harsh.  You might think, how does he know that this is nonsense?  If it's so bad, why can't he break it?  That's actually backwards.  In the world of cryptography, we assume something is broken until we have evidence to the contrary.  And I mean evidence, not proof.  Everything Meganet writes clearly indicates that they haven't the faintest idea about how modern cryptography works.  It's as if you went to a doctor who talked about bloodletting and humors and magical healing properties of pyramids.  Sure, it's possible that he's right.  But you're going to switch doctors.  Two essays of mine, one on snake oil and the other on amateur cipher designers, will help put this into context."  And he goes on.  So that's our answer to Kerry Merritt, who...



LEO:  He's not saying it doesn't work.  He's just saying it's not needed.  There's good public key cryptography out there now that works.



STEVE:  Well, and there's public key, there's symmetric key, I mean, my position is this problem has been solved.  The last thing - we have Rijndael.  We have RSA.  All of this stuff is now in the public domain.  Their patents have expired, as opposed to just having been issued in 2001.  And they solved the problem in a way that absolutely makes sense.  So it's very likely that this technology can be cracked because it's not based on sound crypto science and technology.  It's based on some guy saying, oh, let's see, I'm going to use a million-bit key.  Whoa, that's a lot more bits than 128.  So it must be more secure.  No, not necessarily.



LEO:  Right, right, yeah.  All right, so just it's unnecessary.



STEVE:  Yeah.  But...



LEO:  Bruce makes a good point, that it's not like you need it.  And why should you trust an amateur cryptographer?  What's not known is how reliable this alternate system is, really.



STEVE:  And I love crypto.  And the last thing I'm going to do is go and invent my own bit-scrambling routine.  It's like, no, thank you, that's been - that problem has been solved.



LEO:  Right.  Although I have to say Neal Stephenson did invent a very clever crypto scheme using a deck of cards in "Cryptonomicon."  And I think Bruce may have had something to do with it, or was involved in it, or passed judgment on it.



STEVE:  I think I remember that he was consulted, yeah.



LEO:  So, I mean, it's fun to do it.  It's a great hobby.  But if you're going to trust your business data to it, it might be good to use well-known and established technologies.



STEVE:  I think even - I would phrase that more strongly, Leo.



LEO:  Okay.  Ryan Sullivan asks a, quote, "random question" from New York:  I'm trying to write a PIN number-generating program.  I'm having a slight issue when it comes to generating a completely random number.  I know that software cannot be completely random.  The issue really is that, when I run the program, the first number to be generated is always the same.  He's new to programming, I think.  The second is always the same.  While the numbers are random, they come up in the same random order every time.  It's called "pseudorandom."  I'm currently using the Random function in the programming language.



STEVE:  Actually I have to interrupt.  I would say I would call that "not random."



LEO:  Yeah, that would be exactly not random.  I've spent a few hours trying different combinations of adding or multiplying two or more random numbers together.  I cannot seem to figure out how to at least have the numbers come up in a different random order each time.  He needs to read his programming book a little better.  Is there some mathematical equation or algorithm that can give me somewhat random outcome, or at least more random than I'm currently getting?  Everybody who learns to program does this once.  I'm not laughing...



STEVE:  Oh, sure.  Absolutely that's the case.  Now, the fact is the pseudorandom number generators which are available in most programming languages, ones like Ryan is probably seeing where it's giving him the same sequence of pseudorandom numbers, they generally use a technique which is extremely poor, which is called "linear congruential pseudorandom number generation."  Essentially you multiply the current number by some constant, and then you add a different constant to get you the next one.  Essentially, this generates a sequence of numbers which is really low in entropy because, again, you're multiplying by something and you're adding something.  It's just not going to give you...



LEO:  Really?  That's how they're generating?  That's not random at all.



STEVE:  That's all they do.  Now, the good news is there's a function in most of these languages that I'm sure you're aware of, Leo, called "randomize," which you can call once at the beginning of your program.  And it will generally pick a random seed, well, I mean, that's what it does.  It prevents this problem of your program being entirely deterministic in the sequence of "random" numbers it generates.  However, as it happens, I just finished writing an extremely good source of extremely random numbers as part of the solution to this roaming authentication problem, which I'll be talking about next week.  And I'm making all of the code freely available on GRC.  So, Ryan, if you listen to this, if you hear this, and you're willing to wait one week, you can just get this code from me, call it from your program, and believe me, you will never get the same number twice.



LEO:  Usually there's a seed to the random number generator that your programming language comes with.  You seed it first.  And if you choose something kind of random to do that...



STEVE:  Well, for example, you could ask for a high-resolution time of day from your system.



LEO:  Yeah, ticks, the ticks.



STEVE:  Exactly.  And use that to start things off.



LEO:  But you'll get a random first number, but the problem is the sequence will not be random after that.



STEVE:  Exactly.  You will start with, at a different point in, basically, in a relatively short loop that this multiply and add, this so-called linear congruential algorithm gives.  Most languages just do that because they're really not cryptographically random.  But again, I've got some free code I'm making available because I had to solve the same problem myself just recently.  And it generates extremely good random numbers.  In fact, we had the randomness of the Perfect Passwords Page tested by some crypto guys, and it was way up at the top, at the high end of the scale in a competition with a bunch of other random, high-quality random number generators.



LEO:  Where did you get that algorithm?  How did you come up with that?  Was it out of a book or...



STEVE:  No, I just made it up.



LEO:  You just said, this should work.



STEVE:  Well, no.  The beauty is, if you have a good cipher, essentially a good cipher like Rijndael, which is what I used, I used Rijndael encryption with a 256-bit key, which is the longest key it's able to give.  By definition, if you put anything in one end, like just a counter, 1-2-3-4-5, into one side of a good cipher, what comes out is absolutely pseudorandom.  I mean, it is highly random, so that you are unable to predict what's going to come out next, even if what goes in is absolutely as predictable as a counter.



LEO:  Isn't that interesting.



STEVE:  And that's what I did, and it works.



LEO:  So, Ryan, sounds like he's probably learning to program, and that's something that - don't feel bad.  Everybody does the first time.



STEVE:  Hey, I've been there, too, absolutely.



LEO:  I have no idea how you'd write a real random number generator.  I'm really interested to see how we do this next time.  This'll be the next episode?



STEVE:  Yup, next week.



LEO:  Can't wait.  An anonymous listener worries about replying upon browser cookie security.  Let me explain.



STEVE:  Oh, relying upon.



LEO:  Relying.  Okay, that makes more sense.  All right.  I have a question pertaining to the last episode of Security Now!.  That was 113, I believe.  Any cookie set on a system by legitimate.webserverA.com, let's say, is supposed to be displayed back to that company and only to that company.  In other words, any illegitimate webserverX.com has no way to read that cookie.  Well, what happens if at some point the browser mechanism is somewhat faulty, maybe a bug strikes, and the cookie does get read by some otherwise unauthorized website?  In other words, theoretically a browser is not going to offer a cookie back to a non-matching domain.  What happens, though, if some site by, say, using JavaScript is somehow able to read the browser cookie anyways?  Is that something to worry about?



STEVE:  Well, it's a good question.  And of course it's a function of what the cookie stores.  This was triggered by my discussion last week of this idea of a master enabling permanent cookie and then a second cookie which would be a session-only cookie that would be given to a roaming user after they had securely authenticated themselves to the server.  But in general cookies have no meaning to other web servers.  That is, most cookies are, although they don't have to be, are what's called an "opaque token."  There's some random-looking gibberish, probably something that's been encrypted, which is stored as an ASCII text string in the cookie as the cookie's data, so that this opaque token has meaning only to the issuing site when it receives it back.  So if some malicious website did have access to the cookie - and again, this is something which certainly browsers are struggling to avoid because cookies have become such an intrinsic part of web security these days, you certainly hope that a browser is not going to indiscriminately disclose cookies to non-authorized domains.  But even if it did happen that it was disclosed, if you actually look at the content of most of your cookies, you'll see that they just look like...



LEO:  Gobbledy-gook.



STEVE:  ...absolute gibberish that would have no meaning whatsoever to a site that didn't know how to decrypt it or interpret what data was stored in the cookie.



LEO:  So it's a pretty unlikely combination of flaws.  First the browser has to be broken, and the cookie has to be something that makes sense and has to turn out to be something useful instead of the last date of your visit.



STEVE:  Well, yes.  And, for example, a web server that receives it, it's just going to ignore it.  It's going to say, wait a minute, this is not a cookie I understand.  It's not like it's a smart web server or a malicious web server that knows it's going to be leaking cookies from some broken browser that's going to ever have been to some other website to have acquired a cookie that would be of interest to it.  So again, it's, like, way out there.



LEO:  It'd be pretty unlikely.  Now on to our next question, also about cookies.  I've been listening to your Security Now! Episode 113.  I had a couple of questions about the permanent cookie you're talking about.  First of all, is this cookie placed inside the to-be-trusted computer's web browser, or is it placed somewhere else on the computer?  If it's placed inside the browser, how do you make sure it doesn't get deleted by accident or by the user, say when he's cleaning the browser's cache or other browsing traces?  And if it's not placed in the browser, but somewhere on the computer, where would that be, and how would the server be able to locate and see that cookie?  Is this entire cookie system designed to work only with Internet Explorer, or is it going to work with Opera and Firefox or Safari?  Tell me, Steve.  He's really worried.



STEVE:  Well, the idea was that I wanted to use this permanent cookie to potentially enable a machine to connect to GRC when it's not at one of the known secure IP networks.  That is, the server at GRC knows my own network, and it knows the IP of Sue's NAT router and the IP of Greg's NAT router.  And those NAT routers tend, even though they're using DHCP, tend to hold those IPs static unless they unplug their NAT router or reboot it or leave it offline for some period of time.  So that's been the way we've authenticated so far.  If their IP changes, then they simply let me know.  They send me a piece of email that has their new IP in their email headers, and I add that, or I change the old IP in the registry, and they're back up and running and up to speed.  So the idea is, only if their laptop is at one of those IPs is it able to receive this master cookie.



So to the first question, if that master cookie were deleted, they clean the browser's cache, delete their cookies, well, all they have to do is reconnect their laptop back to their home network, which would give it the public IP that's been authorized.  And the moment they try to use our management interface, the server will see that their browser has not given them the master cookie back, either saying this machine is either authorized or not authorized.  And so they get an intercept screen saying, wait a minute, please let me know whether this machine should be authorized for roaming authentication whenever it's not at one of these authorized IPs.  And it is just a standard browser cookie.  It's not stored elsewhere in the machine.  It's just there in the browser.  It's meant as one of several sort of interlocking requirements for them to be prompted to solve this puzzle or this secret, something which is not going to be easily or even possibly cracked by somebody with full information about their logon.  And that's what we're going to talk about next week.



LEO:  Okay.  Victor, lurking somewhere in the U.K., had a question about roaming - Roman [sic] authentication.  That was our last episode.



STEVE:  Right.



LEO:  I just love that name.  You talked a lot about your new roaming authentication, but there are a couple of things that occurred to me.  If a laptop already has malware, can't this malware just steal your, quote, "secret cookie"?  I mean, after you've successfully logged into the system, a thief can use your session cookie and spoof an IP address it's coming from.  And if this were all done on a hotel's private Ethernet, he doesn't even need to spoof the IP address because it all looks like it's coming from the same place.



STEVE:  Well, he's certainly correct that if - let's see.  If we were logged in, if a thief were on the same network, then they would be - then we would see that they were on the same IP.  They would have to have malware on the laptop which was able to recognize what was going on and get both the static cookie, which authorizes the transaction to create a session cookie, and the session cookie, which would be initiated only when the laptop's user authenticated uniquely each time.  And they'd have to then have a way of returning both of those cookies with any transactions and know the nonpublic and the, well, the nonpublic URL for this backend management system, which is also heavily encrypted.  And they'd have to be able to do all that over, even though we were using SSL connections for the transaction.



So if the user - if this attacker were not also on the same Ethernet, there is no way to spoof the IP.  I've mentioned, I think it was last week, that TCP connections are spoof-proof because you have to have this three-way packet transferal in order to establish a connection.  And the session cookie does have encrypted into it, that is, the contents of the session cookie, the authorized IP that the user was located at when they solved this puzzle that we'll be talking about next week.  So it's not possible to spoof it.  So if you had malware, if you captured both cookies, and you were on the same network so that you saw the same public IP, and you knew the nonpublic cryptographically strong URLs we're using, then yes, you could pretend to be one of our users.  But it would take all of that in order to make it happen.  Which essentially means you have to be one of our users.



LEO:  Yeah.  That's interesting.  There is a way to do it.  I'm actually kind of surprised.



STEVE:  Yeah.  I mean, there is this practice now that there's been some discussion of called "sidejacking," the idea being that some sites do not maintain a secure connection after the user logs on.  For example, Google, we've talked about Gmail, Google Mail.  It will make you use a secure connection while you're providing your username and password for logon.  But unless you use a secure URL when you go to mail.google.com, it will drop you back to a nonsecure connection.  The problem is that it continues to maintain state using a cookie.  And that cookie is going through the clear.  So, for example, in a scenario, in an open Wi-Fi situation, for example, where you are not using secure browser connections, the practice of sidejacking can occur where, even if they did not get your username and password because that had been secured by an SSL connection, once you've established that, if the cookie is not flagged as secure, and you drop back to a non-SSL connection - and in fact in this case the cookie could not be marked as secure because the server still needs access to the cookie when you're over a non-SSL connection - somebody could watch one of your Gmail transactions, every one of which would contain the cookie, and simply masquerade as you.  They would grab your cookie, start using your cookie, and essentially commandeer your session.  And that's sidejacking, which is a problem for cookie-based state management in transactions which are supposed to be secure.



LEO:  It's kind of like a man in the middle, though.  Why do they call it sidejacking?



STEVE:  Well, because you're not in the middle, you're on the side.  You're not actually needing to filter and intercept the user's traffic.  You're able to sniff it and just watch it go by and see, oh, look, this guy's doing Gmail on port 80, nonsecure.  There goes the cookie for his Gmail session.  I'm going to grab it.



LEO:  You don't intercept it, you just watch it go by and make a copy, basically.



STEVE:  Exactly.



LEO:  Yeah.  So a man in the middle, you'd intercept it and send something else to the server.



STEVE:  And so, for example, this is the reason why the GRC session management, the management interface, absolutely never falls away from being over an SSL connection.  It will not accept any of this happening unless we have a secure connection with our server.  And that's maintained all the time.



LEO:  Right.  Brian Polak of St. Louis, Missouri receives the Security Now! Brilliant Idea Award for the week.  I hope we can do this every time.



STEVE:  Yeah, this was a - he makes a great point.  It's simple, and it is just - it's so neat, I absolutely wanted to share it with our listeners.



LEO:  Thanks for alerting me to the PayPal security key, writes Brian.  It makes me feel a lot better about using PayPal.  And in answer to the previous questions you've said to just combine the token value with your password on the first login page.  I don't think that's a good idea, he says.  As we know, if you do not provide it with the password, PayPal prompts you for it in the next screen - which generally is how I do it just because I'm lazy.  I use this feature as an extra check to make sure I'm not being phished.  If I ever try to log on and am not asked for the token value, I know right away something is potentially wrong.  Oh, that's a good point.



STEVE:  Isn't that?  That is the brilliant idea of the week.



LEO:  If it does happen to be a phishing site, I know I've not given them enough to log in, and I can go to PayPal and change my password if necessary.  The minor inconvenience this adds to my login is well worth it for the security benefit it provides.  As you pointed out, you're safe from phishing in the sense that that number is only good for 30 seconds, so the chances are that even if they get that login, they can't use it.  Nevertheless, this will let you know you're not on a valid site.



STEVE:  Well, yeah.  I like it from - just from a standpoint of feedback.  I have been putting the PayPal password and my six-digit, one-time output from my token in all at once.  And but I'm also very aware of the problem of phishing.  I'm always right-clicking on the page and checking the properties and checking the certificate chain because this is such a potential problem, although as you say, Leo, much  mitigated once you've got a hardware token protecting your login.  Still, I just like the idea.  I think he makes a very good point that no phishing site would know to prompt your account for your token.  They would just ask for your username and password and hope that you're going to give it to them.  If they don't prompt you for that, then that raises an immediate flag.  And so I just thought that was a very great observation.



LEO:  Bank of America has implemented something finally.  They still use that lame SiteKey.  But I think I'm now starting to feel a little bit better about the overall protection because what they do is they put a permanent cookie on your machine, kind of like what you do.  And if they don't see that permanent cookie they say, ah, you're logging in from a different machine, or the cookie was deleted or whatever.  We're going to need some more information.  And normally they ask you a secret question.  But, and I've turned this feature on, you can also have them send a key to your cell phone.  You have to validate the cell phone with them ahead of time in an authenticated session so that they know it's really you.  But from now on, if somebody tries to log on to my bank account from a machine that's never logged into that account before and doesn't have that permanent cookie, it'll say, okay, we're going to send the security number to your cell phone, enter it here.  So it's very much like that token system, only it's using the cell phone, something I almost always have with me.  You can set up multiple phones, so if you have multiple numbers, or my spouse, for instance, Jennifer has a separate number, so she can use it, too.  I think this is a good solution.



STEVE:  Yes.  I'm really glad that we're seeing this kind of more robust authentication evolving.  You know I'm just an authentication fanatic at this point.  I mean, I really - it's why we've been talking about OpenID, we've talked about the security tokens, and it's why next week I'm going to share with our listeners the solution I came up with for allowing myself and my employees to securely log in to GRC with so much security that even somebody who had absolutely full knowledge of that transaction, everything that the user sees and everything that they type in in response, cannot do it again.



LEO:  Woohoo.  That's next episode of Security Now!  Yay.  Don't forget that you can get 16KB versions of this for the bandwidth impaired, transcripts for those who like to read along with Steve, and show notes.  And in this case there is a number of links you might want to check out at GRC.com/securitynow.



While you're at GRC, don't forget to check out Steve's many free security programs for your download and use, including the ShieldsUP! test that everybody should run when they get a new router or firewall online.  And of course the fantastic SpinRite, my favorite disk recovery and maintenance utility, a must-have.  If you've got a hard drive, you should have SpinRite.  It's all at GRC.com.  Steve, next week the conclusion of our Roman authentication.



STEVE:  Right-o.  We'll have a different title for the episode, which we will reveal next week.



LEO:  Maybe Persian authentication?  I don't know.  Thank you, Steve.  We'll see you next time.



STEVE:  Thanks, Leo.



Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/.




GIBSON RESEARCH CORPORATION	http://www.GRC.com/



SERIES:		Security Now!

EPISODE:	#115

DATE:		October 25, 2007

TITLE:		Perfect Paper Passwords

SPEAKERS:	Steve Gibson & Leo Laporte

SOURCE FILE:	http://media.GRC.com/sn/SN-115.mp3

FILE ARCHIVE:	http://www.GRC.com/securitynow.htm 



DESCRIPTION:  Steve reveals and fully describes the unique, simple, clean and super-secure one-time password solution he came up with for providing roaming authentication for GRC's employees.  He also describes his own freely available software implementation of the "PPP" system, as well as several other recently created open source implementations.



INTRO:  Netcasts you love, from people you trust.  This is TWiT.



LEO LAPORTE:  Bandwidth for Security Now! is provided by AOL Radio at AOL.com/podcasting.



This is Security Now! with Steve Gibson, Episode 115 for October 25, 2007:  Perfect Paper Passwords.



It's time for Security Now! with everybody's favorite security guy, our guru, our Man About Security, Mr. Steve Gibson.  And Steve, I have to ask you, with all the fires down in the Southland, I'm worried about you.  Are you okay down there in Irvine?



STEVE GIBSON:   Well, the good news, yeah, the good news is I'm really close to the water.  So I can jump in if I need to.



LEO:  I don't know if that was much reassurance for the folks in Malibu, but I'm glad to hear it.  So the fires aren't near you?  They're not in your area?



STEVE:  They're not near me, but I've been wondering about Elaine, who's...



LEO:  Oh, that's right, she's in the grasslands there.



STEVE:  I think she is.  I just came back from a quick run to Starbucks to refill my trusty Starbucks thermos, and I noted that our mail delivery guy was wearing a white surgical mask over his face.



LEO:  Oh, it's a little smoky out there.



STEVE:  So he's a public servant and out in the air all day.  But, I mean, it is definitely weird.  It felt on Sunday sort of like the end of the world.  It was so dark in the middle of the day.  And in fact even today I was able to look at the sun for the first several hours of it coming up, I mean up above the horizon, it was a dark red ball because there's just so much smoke in the air.  And I had heard earlier that it was half a million people.  Apparently now it's more like 800 and some plus thousand people have been evacuated from their homes.



LEO:  That's just awful.  Just terrible.



STEVE:  And I guess we have - I heard another 15,000 National Guard are coming in to guard the homes and streets of areas that have been shut down because of course you don't want looting and bad guys to come back in.  So, I mean, it's just phenomenal that in this day and age nature and - I guess in one case it was sparked by arson.  But in many other cases they were accidental sparking events, construction workers or people with a blowtorch or something, where aided by the winds these things got out of control.



LEO:  Well, our best wishes to all of our listeners in the Southern California area.  And stay safe and good luck getting through this tough time.



STEVE:  It's so sad when you see the fires coming right up behind brand new housing complexes, nice, beautiful new homes.  And it's like, oh, my goodness, they're not going to be here for long.



LEO:  Nature has a funny way of reminding us who's in charge really.  Once in a while she just says, oh, and by the way, you might remember me.



STEVE:  Before you get too cocky.



LEO:  Yeah, exactly.  So today we're going to - what are we going to talk about?  Actually I don't know.  Are we going to do the Perfect Password?



STEVE:  Well, yes.  What we're going to do is we're going to do the long-awaited, for me, actually, second half of the podcast topic we began two weeks ago.  It's been called "Roman authentication."



LEO:  Roman authentication.



STEVE:  It's actually roaming authentication.  We touched on it a little bit with the Q&A last week.  And this week I'm going to explain the path I took and the solution I came up with for the need to give my employees really, really secure, I mean bulletproof security for their roaming authentication.  And I've actually had the system up and running and even public, but not announced really publicly.  It's really caught on.  We've got a number of companies have written indicating that they're going to be using it themselves.



LEO:  Really.



STEVE:  Two open source projects even have code published that creates a compatible implementation with mine.  And in fact it's possible now to log on remotely to Macs using what I call Perfect Paper Passwords, PPP.  A PAM, a Pluggable Authentication Module, has been created.  So anyway, we'll tell our users, or I mean our listeners, all about this really cool solution.



LEO:  So if you want to catch up a little bit, go back to 113, a couple of episodes ago, where Steve posed the problem that he was facing.  It might help if you listen to that first, I would guess.



STEVE:  Well, and I'll give us a little quick recount of that just to bring everyone current when we start talking about this.  I have a couple of little errata things.  I did want to mention that - it's funny, Leo, I was listening to TWiT, or maybe it was your Windows Weekly with Paul, I'm not sure which.  But you happened to mention that you had the next generation of the Sony eBook Reader.



LEO:  Yes, yes.



STEVE:  I bought mine the second day it was out, having read that it had an improved screen.



LEO:  And it does.



STEVE:  It really does.  Actually on the show notes for this week I have a side-by-side photograph that I took of the first generation and the second generation, the Sony eBook Reader.  The first one was the PRS-500.  This next generation is the PRS-505.  And it's got whiter whites, essentially.  The blacks are as black as they were.  But they managed to make the screen - improve the contrast by making the whites whiter.  Although I've got to say, and you did mention this, but I wanted to - that is, on the podcast where you were referring to the new one.  They say they sped up the page change?



LEO:  I don't notice it, no.



STEVE:  Well, what they've done is, I mean, it, like, twists your eyeballs in their sockets.



LEO:  I never liked the page change.  You get used to it.



STEVE:  I guess.  I'm not used to this one.



LEO:  Is it worse, you think?



STEVE:  Oh, yeah.  It's a different technology.



LEO:  See, I'm at a disadvantage because I lost my 500.  And so I can't do a head-to-head comparison.  And I wasn't even sure that the screen was - it felt better, but I wasn't even sure it's better.  But the page turn, because it's an electrostatic screen it has to refresh the whole screen - essentially, like, shake it like an Etch-A-Sketch and then redraw it.  And it gives you a flicker and a flash.



STEVE:  Oh, they've done something wacky now.  I mean, it almost looks like it sucks the centers out of the letters, leaving the outlines behind.  Then they sort of twitter, and then they all upside down invert a couple - I mean, it's just like a major - like I said, it just twists your eyeballs in their sockets.  It's bizarre looking.  In fact, I'm considering setting up a camera and doing some page changes...



LEO:  Slow it down, yeah.



STEVE:  No, just so I can show...



LEO:  Well, I'd like to see it in slow motion to see what it's doing.



STEVE:  That's a very good point.  I've wondered, too, because it happens quick enough that you really can't see it.  But now, I mean, there's different changing technology in this one.  And it's like, ooh, boy, I mean, it really gets you.



LEO:  See, I didn't notice that.  It felt slightly faster.  But it's still annoying.  You know what I do is, as I'm reading, I try to time my page turns because I know it's - if you press the button, there's a slight pause, and then it flickers, and then it goes to the next page.  So I try to time it just before I get to the end of the sentence.  Sometimes I miss and have to go back because I missed the last few words.



STEVE:  I have caught myself, on the first generation I was doing the same thing, Leo.  The other thing I discovered, and this was sort of a mistake, is I notice now that the Night's Dawn trilogy is available.  That's Peter F. Hamilton's monster, I mean, to call it a "tome" doesn't even do it justice.



LEO:  Is that on the Sony CONNECT site?



STEVE:  It is.



LEO:  Oh, baby.



STEVE:  But beware.  I think it's a 19MB download.



LEO:  What?  It's that long?



STEVE:  They put all three books into one file.



LEO:  Oh, dear.



STEVE:  And it completely chokes the Reader when you attempt, I mean, if you touch it you think - I thought it had locked up completely.  It took maybe two hours for the Reader to come back online after I touched it to the Night's Dawn trilogy.  It is 7,536 pages long in medium font size.



LEO:  So it sounds like you don't recommend doing it this way.  Once you open it, is it okay?  I mean, can you go through the pages?



STEVE:  No.  You cannot go away and come back because what it does is I think it must do a pagination of the book.  And oh my god.  So I'm on the first page, and I'm going to read a few pages just to sort of experience it.  Then I'm going to say, okay, well, I'm not serious about reading this thing.  But so this still - the reason I mention this is I want to explain to people that this has all the feel of still sort of a first generation.  Even though we're at second generation, they're just not there yet.  The other thing is, since I've had it for about three weeks I've been meaning to talk about, but I keep forgetting on the podcast.  During two weeks of it just sitting there, it completely drained its battery.



LEO:  Well, two weeks is a long time.



STEVE:  No.  Two weeks of something not being turned on?  It's not like it was on.  It was off for two weeks.  And when I turned it on in order to check the page count because I wanted to mention that, I immediately got this warning symbol came up and said "Battery Low."  And it's like, oh  my god, I mean, it was full two weeks ago, and I haven't done anything with it.  So it's just - it's wrong that something is running inside this thing and burning up power.  There ought to be a really off switch that makes it, I mean, literally disconnects the battery so that it can sit there for six months.



LEO:  Now, on the bright side it does charge via USB port.  You don't need that special charger anymore.  In fact, doesn't even come with it.



STEVE:  It no longer comes with a charger.



LEO:  That's easy.



STEVE:  It no longer has that standup stand that the first generation had.  It is also a full USB drive, USB profile.  So you're able to plug it into a system and see it as a drive.  And in fact you can, for example, transfer PDFs and text files and other things to it, rather than having to route everything through Sony's equivalent of iTunes.



LEO:  And I've done that on a Mac.  And that's really handy because there's no Sony CONNECT for the Mac.  So that's a very handy way to get stuff onto there.



STEVE:  And it now has an SD card slot, which is nice.



LEO:  No, I think it had SD before, didn't it?



STEVE:  No, it was only Sony's proprietary, you know...



LEO:  Not that you need more memory.



STEVE:  Right.



LEO:  I mean, it comes with, what, 180, 192 megabytes now.



STEVE:  Yeah, if you were crazy enough to need - wanting to be listening to music, certainly music takes up a lot of space.  And of course it does burn up your battery a lot...



LEO:  Do you still listen to music?  You were doing that for a while.



STEVE:  No, I don't listen.  I did it as an experiment on the first-generation Reader just to see.  And it's like, yeah, okay.



LEO:  Listen to your iPod.



STEVE:  Exactly.  And I really like the idea that when you're actually reading with the book the battery lasts for so long.



LEO:  That's what I want, yeah.



STEVE:  And in fact it did seem to recharge way faster than usual after I got the warning sign.  So maybe it actually wasn't that the battery was way down.  Maybe it just needed a little hit of power or something.  I don't know what was going on.



LEO:  Now, fill me in on this.  And I did a full review; it's going to appear on the Daily Giz Whiz.  And at the time I wasn't sure.  I don't remember a Jump to Page feature in the original.  And now you can, in fact, go to a specific page.



STEVE:  They changed that.  In fact, they moved the buttons from along the bottom to up along the side, which really makes sense now because the UI has the various items numbered on the side.  Now you've got buttons right next to them.



LEO:  Next to them, yeah.



STEVE:  Actually the original one had an annoying feature where the buttons along the bottom jumped you to that percentage.  So if you...



LEO:  Right.  And you hit it by accident all the time.



STEVE:  Yes.  I did it all the time by mistake.



LEO:  And I couldn't find a way to jump back.



STEVE:  Well, there is, yes, you were able to use that back mode in order to go to where you were.



LEO:  Oh, okay.



STEVE:  So "Back" did work.  However, one of the things that sometimes happened also is I would leave it on by mistake.  And then just because the buttons were on the face of it they would kind of get themselves pushed without intending to.  So when I came back to the book it would be on and completely in some lost zone.  I mean, I had no idea where I was.



LEO:  But now you can jump to a specific page, too, which really, to me, helps.



STEVE:  Yes, you're able to dial by page, you know, 365, and it'll go to that page.



LEO:  You couldn't do that before, could you?



STEVE:  No, there was no direct page access.  You could only go by tens of percentages and then painfully step forward or backward.  I guess I'm saying, you know, everything we're talking about says, whoa, this thing has a ways to go.  But again, as a reader, it's a nice reader.  And I did want to also mention, just while we're on the topic, the Amazon Kindle is apparently just days away from being released.  The Kindle is Amazon's eBook reader.  I guess it's no big stretch that a major bookseller like Amazon would want to say, hey, we want to be in the eBook business.  They bought, it was Mobipocket, I think it is, which was the very first eBook source that I was using back in my earlier Palm eBook days.  Maybe it's not Mobipocket.  Mobisomething.  Anyway, the thing about the Kindle that's interesting is that it is also a cellular modem built in.  It's on the Sprint EVDO network, so way fast.  And so...



LEO:  Do you have to have a Sprint account, though?



STEVE:  My guess is that you get one as part of it.  I mean, as I understand it, the way EVDO being on Sprint works is it would have to have a Sprint phone number.  But you would also have an account in order to buy books through Amazon.  So my guess is that part of the registration process, setting up with Amazon, would be you create an account, and then you buy the books.  And I'm guessing, but I'm pretty sure that Amazon would cover the cost of downloads.  So you're not seeing any Sprint usage billing.  Amazon's done some deal with Sprint where, yes, you do have a Sprint phone, technically, but it's just a cell modem, and you're not going to be using it much because it's only for downloading books.  But it's cool because for someone like my mom, for example, who's really not going to be docking her eBook reader onto her Mac in order to do all this, that just sort of - she wouldn't want to go through all that.  The idea would be, of course, that it's a web browser, has an interface to Amazon's UI, and the entire process of searching for books and purchasing books you do with this reader, and you need no docking, no computer.  So wherever you are you could buy books, and they'd just magically appear in there, courtesy of the Sprint cell modem.



LEO:  Well, that's neat.



STEVE:  Yeah.



LEO:  Yeah, I guess I'll get one of them, too.  Although I have to say the 505 is now close enough that I feel pretty comfortable with it.  I'm reading a lot with it.  I've been reading a lot for the last - got it three or four days ago.  I've been very happy with it.  I mean, it's not quite - I want paper white with black text.  But it's close.



STEVE:  It actually is enough better that I'm no longer finding myself annoyed.



LEO:  I wish the scaling were infinitely variable, too.  Because some books you only have small and medium.  It's hard for me to read the small or even sometimes the medium text.  I like it the large text.



STEVE:  Yeah, but large is really large.



LEO:  It's large.  And I wish there were kind of a way to kind of slide, have a slider that I could go...



STEVE:  I agree.  I think that...



LEO:  Because it's a PDF.  It should be able to do that.



STEVE:  Well, it's got a clearly rescaleable technology built into it.



LEO:  Right.



STEVE:  So you're right, it definitely could do that.  And that would be nice.



LEO:  And for people with really low vision you could get even bigger, and that would be nice.  That's the real benefit of this.  I'm too embarrassed to buy large-text books, large-type books.  But this way it can grow with my failing eyesight, so to speak.  Anyway, enough of the eBook update.  But I think, you know, we're interested in it, and I hope others are, as well.



STEVE:  We've got a lot of good feedback in all of the times that we've talked about eBooks.  I know that there's certainly a cross-section of our listeners who are interested in this evolving technology.



LEO:  If you listened to TWiT you probably heard Jerry Pournelle talk about the fact that, to him, the iPhone was very close to being the eBook reader.  And that's an interesting point of view.  It really is a very good screen.



STEVE:  Well, and his point is that there you're repurposing something that you already own.



LEO:  Right.



STEVE:  That's what Jerry was talking about was that, hey, I've already got an iPhone in my pocket.  So wouldn't it be nice if I'm stuck in line or I'm in an airport or something that I could read a book that I'm wanting to read anyway on the device I already have.



LEO:  And I have to say the text is much more legible on it.  I can read a much smaller typeface on it very easily.  So...



STEVE:  Well, and contrast has a lot to do - I don't know if you've messed with that.  But contrast has a huge amount to do with the size the text has to be.  As contrast is reduced, you really need a larger font in order to make up for that.



LEO:  Ah, that explains it.  Yeah, because I don't normally - I'm not normally that blind.  But I cannot - the small type, I just cannot read it.  On the other hand, I'm reading smaller type on my iPhone, no problem at all.



STEVE:  And I've noticed that if I've got the Sony Reader under bright light, I can read on the small font...



LEO:  Oh, yeah, it's much better, yeah.



STEVE:  ...with no trouble.  But not if it's dimmer, so.



LEO:  I suspect what you're going to see is, you know, Apple's announced the availability of third-party applications soon.  And, well, starting in February they're going to tell people how to do it anyway.  And so I imagine by June of next year you'll be able to buy them.  And I bet you that'd be one of the first things you'd see is an eBook reader.  Just makes sense from Apple's point of view.  They could add it to the store, be an easy thing to do.



STEVE:  And as I understand it, anything that the iPhone gets, the iPod Touch gets.



LEO:  Yes, good point.



STEVE:  That's my sweet spot because I really - I think the iPod Touch is nice, if I could only get my WPA key into that darn thing.  I think what I'm going to do, we actually had a lot of readers, I mean a lot of listeners, who suggested various solutions.  Some have actually managed to enter a GRC-style Wi-Fi Perfect Passwords from the GRC.com/passwords page...



LEO:  How?



STEVE:  ...into their iPhone or their iPod Touch.  They get the thing, copy it to a text file, break it into four-character-long sequences, so they can kind of do them four at a time...



LEO:  That's ridiculous.  I'm sorry.



STEVE:  And they said, yes, it took me seven tries, or yes, it took me 20 minutes.



LEO:  Forget it.



STEVE:  But I was able to get it typed in correctly.  And I'm just thinking, okay, that's wrong.  I want copy and paste.



LEO:  Copy and paste.  Although I have to say I was playing with the Blackberry because I was thinking, after you said that, I was thinking about that.  And the Blackberry not only does have copy and paste, but it doesn't hide the key as you're entering it.  Because the new Blackberry has Wi-Fi built in.  And it's much easier to type it with that keyboard.  You could probably do a pretty good job of it with the Blackberry, even if you didn't have cut and paste, but of course you do.



STEVE:  Well, you know, I'm a Treo user.  So I'm a fan of a physical keyboard with actual buttons on it.  I just, you know, everyone says, eh, well, you know, the iPod Touch works, and it survives without needing a physical keyboard.  But it's like, eh, I wish it had Bluetooth.  Then I could Bluetooth to a real keyboard, and then I could type it in with no trouble at all.



LEO:  Oh, wouldn't that be clever.



STEVE:  But no.



LEO:  Well, we'll see an ecosystem around it.  I mean, it's brand new product.  And I think that just as there's an ecosystem around the iPod, there'll be an ecosystem around the Touch.  And the iPhone.  Do you have any addenda, errata, corrections you'd like to pass along?



STEVE:  I don't, although in my eternal quest for interesting SpinRite stories I do have one.  I'm not sure what to call this one.  We'll have to consider maybe cutting this out of the podcast because I would want to call this one, "SpinRite Got Me Laid."



LEO:  Oh, my goodness.  Let's see, "...Made My Love Life Better."  How about that?



STEVE:  Okay, it definitely did.  This is from Mike.



LEO:  if this is true, this is the best endorsement you've ever had.



STEVE:  This is Mike in Tucson, Arizona.  Actually he wrote today.  He said, "I wanted to share this SpinRite success story with you."



LEO:  Oh, man.



STEVE:  This gives a new meaning to the word "success."  He said, "I met a girl online, and we chatted many times before finally meeting.  Just before we met, her son's laptop would no longer boot, and she asked if I could help.  So I purchased a copy of SpinRite...."   So he purchased a copy of SpinRite for his first date.  And he says...



LEO:  Now, that's a nerd.



STEVE:  "...for our first date the next night.  Even...."  Now, get this.  He says, "Even though I didn't think the date went that well, she trusted me enough to let me take the laptop home to work on.  It was dead anyway.  Later that night I ran SpinRite.  And sure enough, it fixed the problems, allowing the laptop to boot without trouble. So the next day I proudly took the fixed laptop to meet her.  She was so...."



LEO:  Let's leave it at that.



STEVE:  "She was so happy and thrilled that, well, two months later we're still dating and having a wonderful time.  Thank you, SpinRite, and thank you, Steve."



LEO:  It's good for your love life, ladies and gentlemen.  Wow, is that a ringing endorsement.  That's hysterical.



STEVE:  So thank you, Mike.  I really appreciate you sharing the story.



LEO:  So let's take a look at the Part 2 of - you know why I call it "Roman authentication"?  Because there's a device in the gym called a "Roman chair."  Have you ever used the Roman chair, Steve?



STEVE:  I haven't.



LEO:  It is the most - it's clearly a device invented by the Romans, probably to torture Christians.  I don't know.  You get your legs in there, and you hinge over at the waist, down to the ground and up again.  It's like backwards sit-ups.  And just for some reason Roman authentication reminds me of my Roman chair.  It's actually a fun exercise.  Now, you're talking about roaming authentication.  And again, if you heard 113, you know this was Steve trying to solve a problem with getting his employees online when they were out of the office.  Why don't you recap what we talked about?



STEVE:  Right.  The idea, well, where we left off - and the goal of this is to allow - and it's the kind of thing we've talked about a lot before.  We've talked about multifactor authentication.  I wanted a means that would allow Sue or Greg when they were not at their home base location, that is to say, with a laptop, to be able to access pages at GRC on the GRC server which are highly privileged.  Basically the back end, for example, of our eCommerce system, which would allow Sue to issue refunds, to find people's replaced or lost SpinRite serial numbers and purchase information in order to email people the ability to redownload SpinRite if they're away from home, basically to do all the things that she's able to do when she's authenticated just by virtue of being at her home IP, which is authorized, but from a different IP.



So I did this in a couple stages.  The idea is that, when she's at home, and she accesses GRC from her laptop, it notices that she's at her residential IP.  And if she isn't already carrying, that is, if that laptop isn't already carrying an authorization cookie, it says, hey, do you want to authorize this machine for roaming authentication when you're not at your home IP?  So if a friend came over and for some strange reason she accessed GRC's privileged pages from a friend's machine, it would pop that up, and she would say, no, I don't want to give this roaming authentication.  I mean, that seems unlikely, but it's built in.  So that question would come up.  And on her laptop she would say, yes, she does.  And in fact she would even say that on her desktop machine because from time to time the IP might change on her cable modem that is provided by DHCP on the cable modem, in which case she would need to be able to still access with a different IP because then it would think, with her IP changing, that she was no longer at home.



Now when she's out at Starbucks, for example, roaming, and she attempts to access these privileged pages at GRC, the server will see that a request is coming in for a privileged page.  It'll notice that with that request is this permanent authorizing cookie, which will only be sent over an SSL secure encrypted connection.  So that's protected from anyone snooping on the data track.  If she were accessing GRC's nonsecure pages, that cookie would not be offered by the browser.  So in seeing her do this, she is prompted through some mechanism to prove who she is because in a multifactor authentication mode we want, as we've talked about before, we want there to be several different things which are being used together to prove the identity of someone.  So the fact that she's using a laptop carrying this secured cookie, which could only have been issued when she was at her known authenticated IP, that demonstrates that this laptop was once there.  So this is something she has, that is, her laptop, that is allowing one stage of this authentication.  She needs to enter also a secret password, that is, a nonchanging secret password to say this is - not only is this request coming from the laptop, but it's also coming from me, somebody who knows my own secret passphrase.



Now, the problem with relying on only those two things is it would be subject to some sort of recording attack, that is, a replay attack where a keystroke monitor were monitoring her entering in this passphrase, that being something that isn't changing every time.  So that's where we left off with Episode 113.  I wanted to come up with some means, some way, another factor of multifactor authentication which would prevent even somebody with perfect information about the log-on process, that is, somebody with a camera, somebody recording keystrokes, somebody recording mouse clicks, I mean, in a mode where there's perfect knowledge of what I and my employees do to log in.



LEO:  Even a keystroke logger would be thwarted by this.



STEVE:  Yes.  Perfect knowledge, full knowledge of what they're doing to log in.  And that party still could not duplicate what they do.  So my first thought was, okay, some sort of a puzzle.  And I did talk about this in Episode 113 two weeks ago, the idea being that the server would challenge them with something on the screen, like jumbling up numbers and letters, and only a GRC employee would have the magic incantation, like know for example that you sum the digits until you get to a single one, you reverse, and then you interpose that in between the alphanumerics, and you sort the alphabetic in reverse XYZ order or something.



And so I thought about it for a couple days, trying to come up with something where it would be knowledge which would not be obvious.  And the problem is that I want - I don't want to have any compromise in security.  So I wanted to come up with something where somebody looking at the answer and looking at the challenge would not be able to reverse engineer it.  And I couldn't.  I just, you know, I looked at it and I thought, you know, if I say, oh, this is really hard, no one's going to get it, it's like I'm cheating.  And I can't allow that in this case.



So I thought, okay.  We need essentially something that they have.  We want to prove that they have something separate from the computer because, again, laptops are being stolen all the time.  So it's got to be separate from the computer.  Now, we've talked about, of course, the PayPal, VeriSign, RSA-style crypto dongles.  Except that all of those require that you use a back-end service.  And I didn't want to be going to VeriSign or any third party for verification.  Not that I couldn't, but first of all, VeriSign hasn't ever followed through on their suggestion that they'd be willing to show me how to do that or give me access to their back end.  So it's like, okay, well, I don't have access to that, and I didn't want to depend upon it.  So it's like, what could they carry that would comprehensively prove that they, and they alone, have this.



So I started with this idea that we had glanced on, we'd sort of heard of other companies doing this same sort of thing.  And I just said, okay, let me think about this more because I hadn't thought about it.  And that's the idea of some sort of a printed sheet, some sort of a - something printed.



LEO:  So they carry it with them.



STEVE:  They would carry it with them.  It would be in Sue's purse or in hers or Greg's wallet, or mine in my case.  And in fact next time I see you in Vancouver, Leo, I'm going to show this to you because it's all done and working.  And so the idea is something that is carried with you.  So I thought, okay, let's - and we know how pseudorandomness works.  We know, for example, that you could have a cryptographic key, and you could put in a counter into a cipher that's driven by the key, and out will come random-looking but deterministic data.  And, for example, that's how the new Perfect Passwords page at GRC works.  You may remember that I was using a weak random number generator before, not knowing that it was weak.  It was from RSA.  I would have thought that it would have been good.  But it turns out an analysis of lots of its output demonstrated its entropy was not as high as it could be.  So I redesigned one myself using the Rijndael cipher, basically using a counter as input to it.  And what comes out is fantastically random.  So it solved that problem.  So if we have a key, and we just run a counter into a cipher, a good cipher, what comes out the other end is really high-entropy random junk.



So first I thought, okay, so say that we take this random junk, and we just print it on an 8.5 by 11 page.  So we have this huge grid of junk.  And so I thought, okay, well, it would be easy to prove that I had that page because every one of them would be different.  And so, for example, I thought, okay, say that I just picked a random character in this massive grid of gunk and typed in five or six of them in a certain direction.  I could even go in any direction I wanted.  I could go up, down, left, right, diagonally up to the left, up to the right, down to the left, down to the right, sort of in any direction.  And so I just choose a random spot and type in a series of characters that are on the page.



Well, then the authentication mechanism would be that it would have - the server would know the same key that was used to generate the page originally.  It would in memory create a facsimile of that page.  And then it would look at the first character I typed, scan this page to find an instance of that first character, and then look at the second one and see if there's a second character in any of the eight locations around that first one.  That would give it a starting direction.  And then it would march in that direction to see if it was able to match all the characters I had typed.  And if it failed, it would then continue scanning for another instance of that first character and perform the same search until it determined whether I had typed an X number character-long string that appeared on that page.  And it's like, okay, well, that would work.  How's that?



Well, the problem is that we would not know for sure that we had never entered that particular sequence before.  That is, humans tend to be repetitive.  Something would have drawn our eye to a certain spot, a certain character we like, a certain reason for going in a certain direction.  And there's a chance that at some point in the future, unintentionally, we would choose the same string.  Or, if not the same string, maybe even we would hit on the same substring.  So, for example, if we were typing in six-character chunks from this blizzard of randomness, if we typed in five of them by starting one over and then typed six, well, then, again the challenge is perfect information.  Somebody who is able to acquire everything we do cannot gain anything from that.



Well, if we happen to repeat five out of the six characters, just by starting one character off, then that would mean that there would only be a very small set of tests that needed to be done, basically use all those five and test every sixth character, making it very vulnerable to a simple brute force attack.  So I said, okay, that won't work.  We can't just use - we can't basically allow the user to choose where they start.  So then I thought, okay, well, how about if we have like a coordinate system, and the server says start in a certain location and go in a certain direction.  And then next time you're prompted it gives you a different coordinate.  Well, it's like, okay, that would work.  Except that again we have this problem of reuse.



Essentially I came to the conclusion pretty quickly that there is no safe way to ever allow re-use of any of the data on the page, even sort of like substring re-use.  I couldn't even start, deliberately start a couple characters over and have any of the characters I'd typed in before overlap the characters I was typing in now.



LEO:  Because that would weaken it.  It would make it easier to guess.



STEVE:  Exactly, because it would fundamentally weaken the whole notion of proving that I'm the one who has this because it would open it to various sorts of brute-force attacks.  So I settled into, okay, we need a system where the user will under no circumstances ever be asked to enter the same string a second time.  And I ought to mention that, first of all, just so people don't get confused, I'm fully aware that I haven't invented one-time password systems.  FreeBSD has something called OPIE, which generates...



LEO:  Opie?



STEVE:  Opie, exactly.  I think it stands for One-time Passwords something Everywhere, OPIE [One-time Passwords in Everything].  And it works by drawing six words from a - six typically four-character, but sometimes fewer, words from a dictionary of 2048.  And you string those together.  Oh, and also I've even seen some commercial implementations of systems that I've just rejected for the reasons I rejected them.  I mean, they're...



LEO:  Well, OPIE reuses content, so there's one reason not to use OPIE; right?



STEVE:  That's a problem.  Although one would hope that it doesn't reuse the same set of words.  But there are some commercial one-time password systems where the design of their grid is such that you could be led into typing in some characters that were a substring of what you had typed in before.  And that's just not acceptable.



So then I had this notion, okay, if the rule is - and it has to be - we can never ask the user to enter anything they ever did before, then what we wind up with is a sheet of, essentially, columns of characters by rows of characters where you have, for example, columns A, B, C, D, E, F, G, all the way through whatever, and then rows.  And in fact the first one I designed was - it was huge.  It was 8.5 by 11.  And it was A through P.  And it had 50 lines.  So let's see [counting 1 through 15], so it's 16 rows by 50 lines of substrings.  So a ton of them.  So it's like, okay, well, we're getting there.  So then it was, okay, how do I design these strings?  Well, I like the idea very much of their being as short as possible.  That is, I wanted not to have to type something that looks like one of those Windows XP license keys, you know those insane things that are five groups of five with letters and characters, because that's just a pain.  And there's a high chance of getting typos.  In fact, I have an older friend of mine, this might as well have been DRM because it was just impossible for him to type these security keys in every time because they're just too long, and there's too much opportunity for making a mistake.  So I wanted them very short.



Well, having them short and not having them be insecure meant that I needed a larger character set.  That is to say, for example, all these tokens we've been talking about, they're all six-digit tokens, meaning that they can go from 000000 to 999999.  In other words, there's exactly one million possible combinations that the PayPal token, the VeriSign token, the RSA token, they all use six digits.  And so each character can have 10 different combinations.  It's 6 to the 10 - I mean, sorry, 10 to the 6th, 10 to the 6th power, or a million possible combinations.  Obviously, 000000 to 999999.



So what I decided was I wanted a larger alphabet.  That is, I wanted more possible characters in every position.  And we need pretty much, for practical purposes, or certainly ease of implementation, it's nicer if you have a power of two.  That is to say, for example, if we used hex characters, then we would have four bits per character, and we'd be A through F and 0 through 9, which is the hexadecimal character set.  I wanted more than that.  32 characters would give us five bits, five binary bits of value per character.  But 64 gives us six bits.



So what I designed was a 64-character alphabet that is case sensitive.  So, for example, we've got uppercase A through Z that gives us 26 characters.  Lowercase A through Z gives us another 26.  So we have 52.  And then we only need an additional 12 in order - no, wait.  52, yeah, an additional 12 to get us to 64.  Except that the problem with that is in many typefaces there are - it's easy to confuse, for example, lowercase L with the numeral 1, or uppercase O, alphabetic O, with the numeral 0.  So then I went through and I eliminated anything that was visually confusing.  So, for example, there is no uppercase O or 0, even though I could have allowed one of them and have the system be smart enough to know what the user meant.  Just the fact that there were confusing possibilities, that would create some anxiety on the part of the user of this system.  It's like, well, wait a minute, is this an O or a 0?



LEO:  Yeah, I think that's very nice because same thing with 1 and lowercase L; right?  I mean, it's always bugged me.



STEVE:  Yes.  And there's a whole bunch of them, it turns out.  And then, as I eliminated those, the alphabetic portion got shorter.  But that meant I needed other special characters.  So, that is, I couldn't just use numeric, you know, I already eliminated 0 and 1.  So then I had 2, 3, 4, 5, 6, 7, 8, 9.  Well, those are very distinct.  But I needed - now I think I needed another 16 or 17 characters.  So I used exclamation point, at sign, pound sign.  I decided to stay away from dollar sign just because it sort of seemed, well, I wasn't sure that every keyboard would have a dollar sign because in an international keyboard there might be some other symbol.  So I carefully chose an alphabet of 64 characters such that they're very clear visually.  So when you see them there's no confusion.



Now, since each character in this scheme gives you six bits, you don't need many of them.  In fact, these cool things are only four characters long.  So there, for example, uppercase X, uppercase M, uppercase E, and then the numeral 8.  Just four characters long.  Now, the first reaction might be, wait a minute, that's not enough.  It's not enough characters.  Well, each one gives us six bits of value.  So four of them gives us 24 bits.  Well, 2 to the 24...



LEO:  How come they don't, just out of curiosity, give you eight bits of value?



STEVE:  Oh, because in order to get eight bits of value we would have to have a character set of 256 different characters.



LEO:  Oh, I see.  So that's because you've eliminated some of those characters you only get six bits.



STEVE:  Well, because ASCII, you know, printable, there aren't that many really distinctive printable characters.



LEO:  I get it.  I get it.



STEVE:  Yeah.  So each character gives us six bits.  But if we use four of them, only four gives us 24 bits of data.  Well, 24 bits is 2 to the 24, which is 16.77 million possibilities.



LEO:  Right, right.



STEVE:  So consider that the PayPal, VeriSign, RSA tokens, those are only a million possibilities.



LEO:  Because it's just digits.  So by giving it some of these characters, you've really improved it quite a bit.



STEVE:  16.7 times more secure, Leo.



LEO:  Yeah, yeah, yeah.



STEVE:  So any given token, for example, a value coming up on the RSA or PayPal token, there's a one in a million chance of randomly guessing what it's going to be showing.  In this scheme there's only a one, less than one in 16.77 million, almost 17 million, chance of randomly guessing.  And what's actually sort of fun about this is they really look like little crypto things.



LEO:  Yeah.  Well, it's easy to remember, frankly.  The human brain can do those four letters or combination of four letters and numbers much easier.



STEVE:  Well, actually they are not easy to remember because they're not words.



LEO:  No, but that's easier than 10 digits.



STEVE:  Oh.  What it's easy to do, it's easy to transcribe it.  And that was the whole point is you wanted to be able to look at it and type, look at your card where this was printed and then enter it into the screen in order to prove that you are who you say you are.  So the way the system works - and this is on GRC.com, all up and running sort of in a demo mode at GRC.com/ppp.  You can just put in GRC.com/ppp.  The system will force you to be over an SSL connection.  So it'll bounce you to, starting with HTTPS, so https://www.grc.com/ppp.htm.  That's the formal URL.  But if you're just, you know, just put in GRC.com/ppp and it'll take you to the same page.  You can then enter in a passphrase which is only here for the purpose of a demo because a passphrase is not secure.  That is, the only possible attack, the only known possible attack on this system is a weak passphrase.  So no actual implementation uses passphrases.



LEO:  Because they just generate a random 64-bit or 64-character string, or...



STEVE:  Ah, no, even better.  The actual key that drives this, I took the strongest version of Rijndael, the AES encryption.  The strongest version uses a 256-bit key.  I then added an additional 128 bits, which is added to the value of a counter.  So you take the value of a counter, which always starts at zero.  You add a 128-bit value to that, which is part of the master key.  And then the other 256 bits is the key for the Rijndael cipher.  So the 128 bits from the counter, added to the 128 bits from what I call the "sequence key," that goes into the Rijndael cipher, and out comes a random, that is to say a pseudorandom, very high-quality pseudorandom 128 bits.  That is then taken in chunks of 24 bits.  So each chunk of 24 bits is then converted into one of these four-character, what I call a "passcode," and then printed out on what I call a "passcard," which is one of these cards.  So because 24 does not divide evenly into 128, you end up getting five and a third passcodes for every 128-bit cipher.  So you generate the first five.  Then you take the last byte of that one, you increment the counter, and generate another 128 bits that allows you to - and you take the first two bytes of that one in order to generate the sixth passcode.



Anyway, all the math is done.  All of it is documented on the site in a series of pages that explains how this works.  And I have pictures and diagrams of the whole crypto system which are good enough that two implementations have been written from my documentation to implement this.  Now, from day one I produced all the code.  There's a DLL, a Windows format DLL.  It is - I think it's 16K that is the entire crypto system for this Perfect Paper Passwords system.  It's got a series of functions which you're able to call, that is, anyone who wanted to implement this for themselves could simply call the Windows DLL, and it does all the crypto for you.  And basically you give it a buffer of empty space, and you say give me X number of passcodes starting with this one, and the crypto system does that.  And you also give it this, what I call the "sequence key."  Remember that I was saying that we had 128 bits plus 256 bits.  So the whole thing is driven by a 384-bit master key.  Basically there's that many.  I think it's something like 10 to the 38.  I mean, it's a phenomenal number of possible sequences because of the way I designed this.  So, for example, if you were to create an account somewhere where you wanted to authenticate yourself, that authentication server would randomly generate a secret 384-bit sequence key.  And that sets the sequence for all time of these passcodes which are generated.  And then you'd say, okay, I want to carry - oh, I forgot to mention that at one point in this, remember I had an 8.5 by 11 sheet of these.



LEO:  Right.



STEVE:  Well, I realized that in any normal use that would probably last you about three years.  You know, it's ridiculous.



LEO:  How many was it?



STEVE:  Let's see, it was 15, I think I had 16 - let's see [counting].



LEO:  Like 32 or something?



STEVE:  Yeah, 16 by 50.  So...



LEO:  800.  That's plenty.



STEVE:  Yes, exactly.  And then I thought, okay, well, how many are you going to use per day, and how many days do you want this?  So anyway, what I realized was convenience trumped longevity.  And so I came up with a design for a credit card-size card, which is what I call the "passcard."  And it prints out at exactly credit card size, and three of them.  On the GRC site, anyone who's curious can go there, you put in a passphrase, you tell it which card number you want to start with, and you start with number one.  And so, for example, the system will give you that card and the next two.  It prints them close to each other, so you could either cut them out individually, if you only wanted to carry one around in your wallet; or what I'm doing is I realized it would be cool if you just cut out all three together and then you fold the two in so that basically it's back to a credit card size, but you've got essentially three of what I call these little passcards.



LEO:  Is this basically a one-time pad?



STEVE:  Well, it certainly - yeah.  I would say it's a one-time pad.  Now...



LEO:  Because you're only going to use this code once, and then you cross it out.



STEVE:  And that's the key, yes.  The server - so when you create an account it resets your passcode number to zero or to one, the first one.  Actually the passcodes are zero-based, so it resets to zero.  And it comes up with a random sequence key that is secret.  You then say, okay, give me the first three cards, or however many, depending upon what the implementation wants to do.  You could just ask for one at a time or whatever.  So it generates the first 70 passcodes.  In this redesigned smaller card I've only got columns A through G, which is seven columns, by 10 lines, which is 70 codes.  Even then that's going to last you a long time.  Every time you authenticate, for example, come up to a screen that says, okay, prove that you're Steve.  I've already told it my username and my passphrase to tell it that I know something that means that somebody couldn't discover the card in my wallet and, like, Xerox it, for example.  You still need to have multiple factors of authentication, even with a system like this, because you need to guard against inadvertent disclosure of this information.  Now, remember that Bruce Schneier really believes that it makes much more sense to carry around something like this than it does to try to memorize a weak password.



LEO:  Right, right.



STEVE:  He says users are already very good at protecting...



LEO:  Physical things.



STEVE:  ...physical things, bits of things written down on paper.



LEO:  Credit cards and, yeah, right.



STEVE:  Exactly.  And so my idea was you would just slip this in your wallet behind a credit card, and that's where it would be.  And you're generally pretty good about keeping track of that kind of thing.  But you want to make sure that someone who knows you are doing this couldn't sneak up and get to your wallet when it was hanging in your coat pocket on a coat hanger and, for example, copy some of these down or Xerox it or something.  So you still need - you need something other than this that only you know, which is secret, so that this gives you protection against that being lost.



It'd be similar to someone, for example, pushing your PayPal token, reading out the numbers, and then running over to their office and logging in as you.  You still want your log-in information to remain private.  But so the idea is the server knows where you are in the sequence.  If you use, like, the first five passcodes, then it knows you're on number six.  And so in my implementation for GRC it says, "Please type in passcode 1E on card 1."  And it's because there's no reduction in security in it asking you for the code it wants.  That is, you might have a system where you're supposed to just keep track of where it is.  But I think it makes more sense to have the server prompt you for the one it wants.  And since never ever ever will it ever ask you for that again, in my implementation I'm just crossing them off.  If I have a pen with me I'll just scratch it out because it makes it that much easier for me to see the next one.  And if somebody were hacking my log-in and were guessing passcodes, then there might be some possibility that I would want to know if I was being prompted for one further along the sequence than I expected.  So that would also give you some indication of somebody potentially doing something nefarious behind your back.



One of the other cool things is, since the system runs forward forever, and you're never being asked about any prior codes, not only can you scratch them out, but if you think that a card may have been compromised, you can simply tell the system, advance me to the next card.  I want to obsolete this card.  Or say it's getting kind of ratty or tattered, or you use it so infrequently that it's fading out, for example, or you printed it on an inkjet printer and the ink is bleeding, or it got wet or something and the ink bled, there's nothing wrong with saying just cancel these cards, print out from cards I've never seen before forward, in which case you're starting further on in this virtually limitless forward-moving sequence of passcodes.  And in moving this pointer forward you've obsoleted all the passcodes that have come before, and then you're standing there moving forward into the future.



So essentially it's a clean and elegant one-time password, or one-time pad system, as you mentioned, Leo.  It uses very short tokens, which are cool looking because it uses them from a large alphabet that looks sort of spy-like, you know, capital G, lowercase G, 2, lowercase V.  I'm actually reading from some that are onscreen right here.  And anyway, I encourage our listeners to go take a look at it, at GRC.com/ppp.  Several people in our newsgroups thought it was a cool idea.  There is an open source implementation written in C.  My code is all in Assembler.  The DLL that implements the whole crypto system is 17K.  And then...



LEO:  Wow.  For you that's huge.



STEVE:  Well, actually 4K of that is an Authenticode signature because I wanted to Authenticode sign it.



LEO:  [Indiscernible].



STEVE:  Yes, but that's the full Rijndael cipher.  It's written in Assembler.  It's an Assembler implementation of the SHA-384 hash because I used the SHA-384 both for using these passphrases to generate the 384-bit master sequence key, but also the system is able to generate master sequence keys by using a whole bunch of machine-specific and highly volatile information, like the number of clock cycles the processor has had since it was last reset, since its last hardware reset, in order to allow it to be used.  Essentially, this DLL could be the heart of anyone's implementation of a secure one-time passcode PPP crypto system, or authentication system.  And one of our newsgroup members has written a full implementation which is completely compatible with sort of the reference implementation.  That is to say it generates, given the same 384-bit master sequence key, it generates exactly the same passcode sequence as mine does.



LEO:  Fascinating.  I love it that people have taken this up and started doing their own.



STEVE:  Well, in fact we've heard from a bunch of companies who have said, hey, this is really great.  We're going to protect our database with this system.



LEO:  Wow, that's great.



STEVE:  I mean, it really is secure.  It can handle any number of users.  The passcodes go forever.  And if somebody at some point got tired of printing out, oh, I'm up to Card No. 492, you could also reset yourself at any time.  You would never go back to the same master key and the beginning

passcode.  But since you've got 384 bits' worth of them, you just do another random master sequence key and reset the zero so you restart at the first card any time that you want to.  So it just ended up being, I mean, it's what we're using.  A bunch of other companies are using it.  As I mentioned, there's an implementation as a Pluggable Authentication Module that allows people right now, there's a guy who did it, is using it to log in remotely to his Mac using this Perfect Paper Password system for...



LEO:  Really.  How does he get the Mac to know what the password should be?



STEVE:  I haven't looked at his implementation, but he...



LEO:  He must have written a server version of it, too; yes?



STEVE:  Well, there is something called this PAM.  This Pluggable Authentication Module is a standard, and the Mac OS X supports the PAM standard.



LEO:  Oh, okay.



STEVE:  So he's done that, and he's plugged it into his Mac OS X in order to allow him to use the system for secure log-on.



LEO:  See, many of us are going to start wanting to use this because Leopard, which comes out tomorrow, has built into it this get Back to My Mac feature where you use .Mac to log in to any Mac that's online.  And so this will be very important to have a secure log-in through this system.  So I'm not sure how secure their built-in system is, but this might be a nice thing to look at adding on top of it using PAM.



STEVE:  Well, again...



LEO:  So PAM would know automatically that you - how would you modify the PAM to know what your passwords are going to be?



STEVE:  I can't answer the questions, Leo.  I don't know anything about PAM or, I mean, I know about this system which he implemented, but I don't know about...



LEO:  So somebody's written a plug-in, and that's what you have to find.



STEVE:  Well, no, I mean, we're linking to it.  And so, yeah...



LEO:  So just go to GRC.com.



STEVE:  Yes.  On the PPP pages at GRC.com we've got the full documentation of this, a sample that allows people to print cards, see what they look like.  And I've been trying to say also that not only do I have the DLL, I have an EXE.  The EXE is 11K.  What it does is it just exercises the DLL.  So it's a command line version of the entire PPP system.  Because, for example, people who wanted to implement this for, like, securing authentication to their own websites, if they had PHP or Perl and didn't want to be calling into the DLL, it's very easy in any of these languages to shell out to, essentially to an executable.  So you're able to pass the parameters to the EXE, and it will do all of the Perfect Paper Password crypto and give you back the results.



LEO:  Perfect.



STEVE:  So, yeah, it's just - again, I don't want people to be saying, oh, Gibson thinks he's invented something really amazing, and this is just one-time passwords, been there, done that.  It's like, okay, yes, except that there are some cool aspects of this.  I just, basically I did my own GRC-style implementation because I wanted to.  And it uses strong crypto.  It's got a lot of neat features that makes it very comfortable and easy to use.  It's what we're using to provide us with secure roaming authentication, and it will be part of the authentication system in a forthcoming GRC product, as well.



LEO:  Oh, okay.



STEVE:  You betcha.



LEO:  And unlike a one-time pad, for a one-time pad to work you have to make two copies, and there has to be a physical transmission of one of the pads.  This doesn't require that.  It's algorithmic.



STEVE:  This, exactly, it uses very strong pseudorandom sequence generation driven by a really long key, a 384-bit key.  So that cannot be brute-forced.  Earlier on I mentioned that I am formally discouraging the use of a passphrase to generate the key.  I'm only doing that at GRC to allow people to...



LEO:  To play with it, yeah.



STEVE:  Exactly, to play with it.  Because the only attack that would be known on this system would be to use a weak key, that is, a weak passphrase, and do brute-forcing of a passphrase to hash that through the SHA-384 to generate a key and then try to find somebody's passcode sequence by brute-forcing it.  I mean, even that would be a lot of work.  But that's the only weakness, which is why any real implementation will simply generate a 384-bit key at random, and then the only way it surfaces is through this sequence of passcodes.  And there's just no way to reverse engineer that back to the key.



LEO:  So there is still a handoff, though.  There has to be something that is mutually understood, which is this initial key; yes?



STEVE:  No.  The user never gets the key.  The only thing they get is...



LEO:  Is the paper.



STEVE:  Exactly.  When they've authenticated themselves to the server and proven that they are who they say they are, then they can request that these passcode pages - well, yeah, passcode pages...



LEO:  Be generated, yeah.



STEVE:  ...are presented on their web browser over an SSL connection.  And then they print them, and then that's what they carry with them subsequently.



LEO:  So that's what - and SSL is nice because there is that transmission, but that transmission is done over a known secure channel.



STEVE:  Right, to a known computer.  For example...



LEO:  Oh, that's right, they have to be authenticated first, yeah.



STEVE:  Yes, they've got to be authenticated.  And I do not, again, for the sake of heightened security in my own implementation, I do not allow a roaming laptop to receive those passcards.



LEO:  Ah.  You've got to print it locally first.



STEVE:  You have to print it locally.  And that's one of the other nice things about crossing them out is that it's very easy to see when you're nearing the end of your passcard, to remind yourself, oops, I'd better print some more.  But again, you're always able to print them.  And that's one of the things I like about this system is that the approach is it's a web-friendly solution.  No one's having to mail you these passcards in advance.  Any time you want more, you say I want more.  And it says, okay, here's your next...



LEO:  So now that you've - okay.  So if you're using the passcard, you can get it from a laptop now.



STEVE:  Correct.  I'm now - Sue, Greg, and I...



LEO:  So you've now been authenticated to such a degree that you trust the laptop to print another set of cards.



STEVE:  Oh, no, no.



LEO:  You still have to go home to get the cards.



STEVE:  Again, in my situation, because I do have this notion...



LEO:  They come home all the time.



STEVE:  I do have this notion of a home IP versus a roaming IP.  In my particular implementation I just decided, let's just not allow them to see passcards when they're on the road.  You've got to be home.  And in fact that's one reason it's nice to sort of print all three of these in a big chain is then you've got 30 rows by seven columns.  You've got 210 passcodes.  They're going to last for a year.  So I don't think I see anybody using these things up very fast.



LEO:  I'm very interested in - we're going to do a question-and-answer session next week, but maybe the week following we can talk about using this, or if you needed to use this, for Back to My Mac, which is something that I think is going to be a very cool feature of Leopard - we haven't seen it yet, we'll see it tomorrow - which allows you to, as long as your Macs are Leopard-based, to find any of your Macs that are connected to .Mac and get to them, display them.  It's remote access, basically, built into the Mac.  It uses - it says in quote - and this is the only problem is it says it uses password-protection and advanced data encryption, but it doesn't give much detail on that.  I'd be very curious.



STEVE:  My guess is, Leo, it will not use one-time passwords.  And that's absolutely what you want.



LEO:  Right.



STEVE:  And so if this allows you to - if Back to My Mac can accept a PAM plug-in, then I wouldn't be at all surprised if we can make this work.  And if not, maybe we'll have some people who can implement it.



LEO:  Love to find out, yeah.



STEVE:  My guess is, I mean, I'm excited that this has already taken off beyond GRC.  And we'll see where it goes.



LEO:  Well, I use SSH all the time, for instance, to access my web servers.  And it's always the same passphrase.  I'd love to use this.  And I'm sure this is an easy thing to implement with SSH.



STEVE:  Well, in fact that is exactly what the guy who posted on GRC is doing.  He's using SSH.  And after he provides his username and password, he is then prompted for his passcode from the Perfect Paper Passwords.



LEO:  And it's a one-time only, you cross it off...



STEVE:  And you never use it again.



LEO:  And because I am - I use these things on hotel networks and so forth.  I mean, it's SSL, so I don't worry too much.  But it would be nice to have that little extra bit of...



STEVE:  And it's fun.  It is.  And you feel like a little - sort of like a spy.  Ooh, I've got to type in :ZEY.



LEO:  And I can have that in my wallet, and it's perfect.  Maybe laminate it, that'd be great.  Oh, no, you can't laminate it because you've got to cross it off, okay.



STEVE:  Well, you could.  But, yeah, it's just - and if they get worn and tattered you just print yourself another.  Now, you were also talking, Leo, about the inconvenience of what if my PayPal token is at home, I need to log in at work?



LEO:  Right, right.



STEVE:  Well, now, this is a double-edged sword because of course the fact that it's a physical thing means that you would know if it were stolen.  You might know if someone looked at it or borrowed it.



LEO:  You have to have it for it to work, right.



STEVE:  But the flipside is you are able to print two copies of your Perfect Paper Passwords, if you deliberately wanted to put one in a secure location at the office.



LEO:  Good point.



STEVE:  So that you would know - so that if you - but again, this thing is so convenient, who doesn't have their wallet with them?



LEO:  Right.  Well, that's why I like the cell phone method that my bank uses because I always have my cell phone with me, as opposed to the dongle, which I don't always have with me.



STEVE:  Right.



LEO:  What a great idea, Steve.  I think this is great.  And what I'm really impressed with is that now it's kind of widely, starting to be widely adopted by others who are implementing it in different fashions.  This is great.



STEVE:  Yeah, again, I'm not claiming that this is some miracle.  But it's just a very clean, well thought out, sort of like soup to nuts.  In the download .zip I even provide all of the HTML templates and the CSS templates that my site uses that people can see, even though people could grab them themselves just by sucking them off my server, they're there, saying look, I've done all the work.  It is easy to print these cards, and they work.



LEO:  Steve, you're getting perilously close to open source, dude.  Just a matter of time.  Steve, it's just - I tell you, what I like about Steve is, not only is he a theoretician, but he's practical, too.  It's security applied as well as theoretical.  And that is what really makes this podcast, I think, especially useful.  Steve, great job.  Fascinating stuff.  And I can't wait to try implementing it in different ways.  I'd love to get an SSH and maybe a PAM module and everything.



STEVE:  We'll get there.



LEO:  Next week, your questions, Steve's answers.  And of course more security information, as always.  Steve Gibson, a pleasure talking to you.  If you want to know more, go to GRC.com.  If you go to GRC.com/securitynow you'll find transcripts of this.  You'll find Steve's show notes, including the .zip file with all this information.  You also get a 16KB version, if you like, for the bandwidth-impaired, of this podcast.  Steve provides that all for free at GRC.com, along with dozens of really useful free security utilities like ShieldsUP, Shoot The Messenger, DCOMbobulator, Unplug N' Pray, and on and on and on.  Well, and this is one of them, in a way, really.  I mean, it's not a download, but you can generate a little Perfect Password page for yourself.



STEVE:  Well, you can see what it looks like.  And I'm hoping that by putting this demo together I will encourage people to adopt it because we need strong authentication, and this is a very strong, secure solution.



LEO:  You bet.  One other thing we need, we need disk recovery and maintenance utilities like SpinRite.  If you've got a disk drive, you need SpinRite.  GRC.com.  Steve, we'll see you next time.  Thanks for joining us on Security Now!.





Copyright (c) 2007 by Steve Gibson and Leo Laporte.  SOME RIGHTS RESERVED.  This work is licensed for the good of the Internet Community under the Creative Commons License v2.5.  See the following Web page for details: http://creativecommons.org/licenses/by-nc-sa/2.5/




